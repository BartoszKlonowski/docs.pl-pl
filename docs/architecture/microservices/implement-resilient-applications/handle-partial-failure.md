---
title: Obsługa częściowych niepowodzeń
description: Dowiedz się, jak bezpiecznie obsługiwać częściowe błędy. Mikrousługa może nie być w pełni funkcjonalna, ale nadal może być w stanie wykonać kilka przydatnych zadań.
ms.date: 10/16/2018
ms.openlocfilehash: f00e5349df74b543deb6ac941c751cb130b3837c
ms.sourcegitcommit: 22be09204266253d45ece46f51cc6f080f2b3fd6
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/07/2019
ms.locfileid: "73732959"
---
# <a name="handle-partial-failure"></a><span data-ttu-id="f6f25-104">Błąd częściowej obsługi</span><span class="sxs-lookup"><span data-stu-id="f6f25-104">Handle partial failure</span></span>

<span data-ttu-id="f6f25-105">W systemach rozproszonych, takich jak aplikacje oparte na mikrousługach, istnieje kiedykolwiek ryzyko częściowej awarii.</span><span class="sxs-lookup"><span data-stu-id="f6f25-105">In distributed systems like microservices-based applications, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="f6f25-106">Na przykład jedna mikrousługa/kontener może kończyć się niepowodzeniem lub może nie być dostępna do odpowiedzi przez krótki czas lub może ulec awarii Pojedyncza maszyna wirtualna lub serwer.</span><span class="sxs-lookup"><span data-stu-id="f6f25-106">For instance, a single microservice/container can fail or might not be available to respond for a short time, or a single VM or server can crash.</span></span> <span data-ttu-id="f6f25-107">Ponieważ klienci i usługi są oddzielnymi procesami, usługa może nie być w stanie odpowiedzieć na żądanie klienta w odpowiednim czasie.</span><span class="sxs-lookup"><span data-stu-id="f6f25-107">Since clients and services are separate processes, a service might not be able to respond in a timely way to a client’s request.</span></span> <span data-ttu-id="f6f25-108">Usługa może być przeciążona i odpowiadać na żądania lub może po prostu nie być dostępna przez krótki czas ze względu na problemy z siecią.</span><span class="sxs-lookup"><span data-stu-id="f6f25-108">The service might be overloaded and responding very slowly to requests or might simply not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="f6f25-109">Rozważmy na przykład stronę szczegóły zamówienia z przykładowej aplikacji eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="f6f25-109">For example, consider the Order details page from the eShopOnContainers sample application.</span></span> <span data-ttu-id="f6f25-110">Jeśli mikrousługa porządkowania nie odpowiada, gdy użytkownik próbuje przesłać zamówienie, nieprawidłową implementację procesu klienta (aplikacji sieci Web MVC) — na przykład, jeśli kod klienta był używany synchronicznie zdalnych wywołań procedury bez limitu czasu — blokuje wątki w nieskończoność oczekiwanie na odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="f6f25-110">If the ordering microservice is unresponsive when the user tries to submit an order, a bad implementation of the client process (the MVC web application)—for example, if the client code were to use synchronous RPCs with no timeout—would block threads indefinitely waiting for a response.</span></span> <span data-ttu-id="f6f25-111">Oprócz tworzenia nieprawidłowego środowiska użytkownika, każde nieodpowiadające na siebie oczekiwania zużywa lub blokuje wątek, a wątki są niezwykle cenne w wysoce skalowalnych aplikacjach.</span><span class="sxs-lookup"><span data-stu-id="f6f25-111">Besides creating a bad user experience, every unresponsive wait consumes or blocks a thread, and threads are extremely valuable in highly scalable applications.</span></span> <span data-ttu-id="f6f25-112">Jeśli istnieje wiele zablokowanych wątków, na koniec środowisko uruchomieniowe aplikacji może zostać uruchomione z wątków.</span><span class="sxs-lookup"><span data-stu-id="f6f25-112">If there are many blocked threads, eventually the application’s runtime can run out of threads.</span></span> <span data-ttu-id="f6f25-113">W takim przypadku aplikacja może stać się globalnie nieodpowiadająca, a nie tylko częściowo nieodpowiadająca, jak pokazano na rysunku 8-1.</span><span class="sxs-lookup"><span data-stu-id="f6f25-113">In that case, the application can become globally unresponsive instead of just partially unresponsive, as shown in Figure 8-1.</span></span>

![Diagram przedstawiający częściowe błędy.](./media/handle-partial-failure/partial-failures-diagram.png)

<span data-ttu-id="f6f25-115">**Rysunek 8-1**.</span><span class="sxs-lookup"><span data-stu-id="f6f25-115">**Figure 8-1**.</span></span> <span data-ttu-id="f6f25-116">Częściowe błędy spowodowane zależnościami, które wpływają na dostępność wątku usługi</span><span class="sxs-lookup"><span data-stu-id="f6f25-116">Partial failures because of dependencies that impact service thread availability</span></span>

<span data-ttu-id="f6f25-117">W przypadku aplikacji opartych na mikrousługach można wzmocnić wszystkie częściowe awarie, zwłaszcza jeśli większość wewnętrznych interakcji mikrousług opiera się na synchronicznych wywołaniach HTTP (które są uznawane za antywzorców).</span><span class="sxs-lookup"><span data-stu-id="f6f25-117">In a large microservices-based application, any partial failure can be amplified, especially if most of the internal microservices interaction is based on synchronous HTTP calls (which is considered an anti-pattern).</span></span> <span data-ttu-id="f6f25-118">Pomyśl o systemie, który odbiera miliony wywołań przychodzących dziennie.</span><span class="sxs-lookup"><span data-stu-id="f6f25-118">Think about a system that receives millions of incoming calls per day.</span></span> <span data-ttu-id="f6f25-119">Jeśli system ma zły projekt oparty na długich łańcuchach synchronicznych wywołań HTTP, te wywołania przychodzące mogą spowodować powstanie więcej milionów wywołań wychodzących (Przypuśćmy współczynnik 1:4) do dziesiątek wewnętrznych mikrousług jako zależności synchroniczne.</span><span class="sxs-lookup"><span data-stu-id="f6f25-119">If your system has a bad design that's based on long chains of synchronous HTTP calls, these incoming calls might result in many more millions of outgoing calls (let’s suppose a ratio of 1:4) to dozens of internal microservices as synchronous dependencies.</span></span> <span data-ttu-id="f6f25-120">Ta sytuacja jest pokazana na rysunku 8-2, szczególnie zależność \#3, która uruchamia łańcuch, wywołując #4 zależności.</span><span class="sxs-lookup"><span data-stu-id="f6f25-120">This situation is shown in Figure 8-2, especially dependency \#3, that starts a chain, calling dependency #4.</span></span> <span data-ttu-id="f6f25-121">które wywołania #5.</span><span class="sxs-lookup"><span data-stu-id="f6f25-121">which the calls #5.</span></span>

![Diagram przedstawiający wiele rozproszonych zależności.](./media/handle-partial-failure/multiple-distributed-dependencies.png)

<span data-ttu-id="f6f25-123">**Rysunek 8-2**.</span><span class="sxs-lookup"><span data-stu-id="f6f25-123">**Figure 8-2**.</span></span> <span data-ttu-id="f6f25-124">Wpływ nieprawidłowego projektowania z długimi łańcuchami żądań HTTP</span><span class="sxs-lookup"><span data-stu-id="f6f25-124">The impact of having an incorrect design featuring long chains of HTTP requests</span></span>

<span data-ttu-id="f6f25-125">Przejściowy błąd jest gwarantowany w systemie rozproszonym i opartym na chmurze, nawet jeśli każda z tych zależności ma doskonałą dostępność.</span><span class="sxs-lookup"><span data-stu-id="f6f25-125">Intermittent failure is guaranteed in a distributed and cloud-based system, even if every dependency itself has excellent availability.</span></span> <span data-ttu-id="f6f25-126">Jest to fakt, że należy wziąć pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="f6f25-126">It's a fact you need to consider.</span></span>

<span data-ttu-id="f6f25-127">Jeśli nie projektujesz i implementujmy techniki w celu zapewnienia odporności na uszkodzenia, to nawet małe przestoje mogą być wzmocnione.</span><span class="sxs-lookup"><span data-stu-id="f6f25-127">If you do not design and implement techniques to ensure fault tolerance, even small downtimes can be amplified.</span></span> <span data-ttu-id="f6f25-128">Na przykład 50 zależności z 99,99% dostępności spowodują kilka godzin przestoju każdego miesiąca z powodu tego efektu programu Ripple.</span><span class="sxs-lookup"><span data-stu-id="f6f25-128">As an example, 50 dependencies each with 99.99% of availability would result in several hours of downtime each month because of this ripple effect.</span></span> <span data-ttu-id="f6f25-129">Gdy zależność mikrousług kończy się niepowodzeniem podczas obsługi dużej liczby żądań, ten błąd może szybko zaszeregować wszystkie dostępne wątki żądań w poszczególnych usługach i spowodować awarię całej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f6f25-129">When a microservice dependency fails while handling a high volume of requests, that failure can quickly saturate all available request threads in each service and crash the whole application.</span></span>

![Diagram przedstawiający częściowe niepowodzenie wzmocnić w mikrousługach.](./media/handle-partial-failure/partial-failure-amplified-microservices.png)

<span data-ttu-id="f6f25-131">**Rysunek 8-3**.</span><span class="sxs-lookup"><span data-stu-id="f6f25-131">**Figure 8-3**.</span></span> <span data-ttu-id="f6f25-132">Częściowe niepowodzenie wzmacniane przez mikrousługi z długimi łańcuchami synchronicznych wywołań HTTP</span><span class="sxs-lookup"><span data-stu-id="f6f25-132">Partial failure amplified by microservices with long chains of synchronous HTTP calls</span></span>

<span data-ttu-id="f6f25-133">Aby zminimalizować ten problem, w sekcji [asynchronicznej integracji mikrousług Wymuś autonomię mikrousługi](../architect-microservice-container-applications/communication-in-microservice-architecture.md#asynchronous-microservice-integration-enforces-microservices-autonomy), w tym przewodniku zachęcamy do korzystania z komunikacji asynchronicznej przez mikrousługi wewnętrzne.</span><span class="sxs-lookup"><span data-stu-id="f6f25-133">To minimize this problem, in the section [Asynchronous microservice integration enforce microservice’s autonomy](../architect-microservice-container-applications/communication-in-microservice-architecture.md#asynchronous-microservice-integration-enforces-microservices-autonomy), this guide encourages you to use asynchronous communication across the internal microservices.</span></span>

<span data-ttu-id="f6f25-134">Ponadto istotne jest, aby zaprojektować mikrousługi i aplikacje klienckie w celu obsługi częściowych błędów — czyli do tworzenia odpornych mikrousług i aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="f6f25-134">In addition, it's essential that you design your microservices and client applications to handle partial failures—that is, to build resilient microservices and client applications.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="f6f25-135">[Poprzedni](index.md)
>[Następny](partial-failure-strategies.md)</span><span class="sxs-lookup"><span data-stu-id="f6f25-135">[Previous](index.md)
[Next](partial-failure-strategies.md)</span></span>
