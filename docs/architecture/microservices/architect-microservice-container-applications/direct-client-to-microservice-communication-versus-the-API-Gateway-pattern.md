---
title: Wzorzec bramy interfejsu API w porównaniu z bezpośrednią komunikacją klient-do-mikrousług
description: Zapoznaj się z różnicami i wykorzystaniem wzorca usługi API Gateway oraz bezpośredniej komunikacji klient-do-mikrousług.
ms.date: 01/07/2019
ms.openlocfilehash: 90761605dde197e44658e3ba0b0a3a2c06b5942c
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/24/2020
ms.locfileid: "91152705"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="c0d42-103">Wzorzec bramy interfejsu API w porównaniu z bezpośrednią komunikacją klient-do-mikrousług</span><span class="sxs-lookup"><span data-stu-id="c0d42-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="c0d42-104">W architekturze mikrousług każda mikrousługa udostępnia zestaw (zazwyczaj) szczegółowych punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="c0d42-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="c0d42-105">Ten fakt może mieć wpływ na komunikację między klientem i mikrousługą, zgodnie z opisem w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="c0d42-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="c0d42-106">Bezpośrednia komunikacja klient-usługa</span><span class="sxs-lookup"><span data-stu-id="c0d42-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="c0d42-107">Możliwym podejściem jest użycie bezpośredniej architektury komunikacji klient-mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="c0d42-108">W tym podejściu aplikacja kliencka może wprowadzać żądania bezpośrednio do niektórych mikrousług, jak pokazano na rysunku 4-12.</span><span class="sxs-lookup"><span data-stu-id="c0d42-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagram przedstawiający architekturę komunikacji klient-mikrousług.](./media/direct-client-to-microservice-communication.png)

<span data-ttu-id="c0d42-110">**Rysunek 4-12**.</span><span class="sxs-lookup"><span data-stu-id="c0d42-110">**Figure 4-12**.</span></span> <span data-ttu-id="c0d42-111">Korzystanie z bezpośredniej architektury komunikacji klient-mikrousług</span><span class="sxs-lookup"><span data-stu-id="c0d42-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="c0d42-112">W tym podejściu każda mikrousługa ma publiczny punkt końcowy, czasami z innym portem TCP dla każdej mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="c0d42-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="c0d42-113">Przykładem adresu URL dla określonej usługi może być następujący adres URL na platformie Azure:</span><span class="sxs-lookup"><span data-stu-id="c0d42-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

`http://eshoponcontainers.westus.cloudapp.azure.com:88/`

<span data-ttu-id="c0d42-114">W środowisku produkcyjnym opartym na klastrze ten adres URL będzie mapowany do modułu równoważenia obciążenia używanego w klastrze, co z kolei dystrybuuje żądania dla mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="c0d42-115">W środowiskach produkcyjnych można korzystać z kontrolera dostarczania aplikacji (ADC), takiego jak [platforma Azure Application Gateway](/azure/application-gateway/application-gateway-introduction) między mikrousługami i Internetem.</span><span class="sxs-lookup"><span data-stu-id="c0d42-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="c0d42-116">Działa to jako przezroczysta warstwa, która nie tylko realizuje Równoważenie obciążenia, ale zabezpiecza usługi przez umożliwienie zakończenia protokołu SSL.</span><span class="sxs-lookup"><span data-stu-id="c0d42-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="c0d42-117">Poprawia to obciążenie hostów przez Przeciążenie zakończenia protokołu SSL intensywnie korzystających z procesora CPU i innych obowiązków routingu do Application Gateway platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="c0d42-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="c0d42-118">W każdym przypadku moduł równoważenia obciążenia i ADC jest przezroczysty z punktu widzenia architektury aplikacji logicznej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="c0d42-119">Bezpośrednia architektura komunikacji między klientem a mikrousługą może być wystarczająca dla małych aplikacji opartych na mikrousługach, zwłaszcza jeśli aplikacja kliencka jest aplikacją sieci Web po stronie serwera, taką jak aplikacja ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="c0d42-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="c0d42-120">Jednak podczas kompilowania dużych i złożonych aplikacji opartych na mikrousługach (na przykład w przypadku obsługi dziesiątek typów mikrousług), a zwłaszcza gdy aplikacje klienckie to zdalne aplikacje mobilne lub aplikacje sieci Web SPA, takie podejście nadaje kilka problemów.</span><span class="sxs-lookup"><span data-stu-id="c0d42-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="c0d42-121">Podczas tworzenia dużej aplikacji na podstawie mikrousług należy wziąć pod uwagę następujące zagadnienia:</span><span class="sxs-lookup"><span data-stu-id="c0d42-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="c0d42-122">*Jak aplikacje klienckie zmniejszają liczbę żądań do zaplecza i zmniejszają komunikację w wielu mikrousługach?*</span><span class="sxs-lookup"><span data-stu-id="c0d42-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="c0d42-123">Korzystanie z wielu mikrousług w celu utworzenia jednego ekranu interfejsu użytkownika powoduje zwiększenie liczby rund w Internecie.</span><span class="sxs-lookup"><span data-stu-id="c0d42-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="c0d42-124">Zwiększa to opóźnienia i złożoność po stronie interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="c0d42-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="c0d42-125">Najlepiej, gdy odpowiedzi powinny być efektywnie agregowane po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="c0d42-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="c0d42-126">Zmniejsza to opóźnienia, ponieważ wiele fragmentów danych jest ponownie równoległych, a niektóre interfejsu użytkownika mogą wyświetlać dane zaraz po ich przygotowaniu.</span><span class="sxs-lookup"><span data-stu-id="c0d42-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="c0d42-127">*Jak można obsłużyć problemy z przecinaniem, takie jak autoryzacja, przekształcenia danych i dynamiczne wysyłanie żądań?*</span><span class="sxs-lookup"><span data-stu-id="c0d42-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="c0d42-128">Zaimplementowanie zagadnień związanych z zabezpieczeniami i rozwojem, takich jak zabezpieczenia i autoryzacja dla każdej mikrousługi, może wymagać znacznego nakładu pracy.</span><span class="sxs-lookup"><span data-stu-id="c0d42-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="c0d42-129">Możliwym podejściem jest posiadanie tych usług na hoście platformy Docker lub w klastrze wewnętrznym, aby ograniczyć bezpośredni dostęp do nich z zewnątrz i aby zaimplementować te zagadnienia związane z wycinaniem w scentralizowanym miejscu, takim jak Brama interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="c0d42-130">*Jak aplikacje klienckie komunikują się z usługami korzystającymi z nieprzyjaznych dla Internetu protokołów?*</span><span class="sxs-lookup"><span data-stu-id="c0d42-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="c0d42-131">Protokoły używane na stronie serwera (takie jak AMQP lub protokoły binarne) nie są zwykle obsługiwane w aplikacjach klienckich.</span><span class="sxs-lookup"><span data-stu-id="c0d42-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="c0d42-132">W związku z tym żądania muszą być wykonywane za pośrednictwem protokołów, takich jak HTTP/HTTPS, a następnie tłumaczone na inne protokoły.</span><span class="sxs-lookup"><span data-stu-id="c0d42-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="c0d42-133">Podejście typu *man-in-the-Middle* może pomóc w takiej sytuacji.</span><span class="sxs-lookup"><span data-stu-id="c0d42-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="c0d42-134">*Jak można kształtować elewację szczególnie utworzoną dla aplikacji mobilnych?*</span><span class="sxs-lookup"><span data-stu-id="c0d42-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="c0d42-135">Interfejs API wielu mikrousług może być niewłaściwie zaprojektowany dla potrzeb różnych aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="c0d42-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="c0d42-136">Na przykład wymagania aplikacji mobilnej mogą być inne niż potrzeby aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="c0d42-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="c0d42-137">W przypadku aplikacji mobilnych może być konieczne jeszcze bardziej zoptymalizowanie, aby odpowiedzi na dane mogły być bardziej wydajne.</span><span class="sxs-lookup"><span data-stu-id="c0d42-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="c0d42-138">Można to zrobić poprzez agregowanie danych z wielu mikrousług i zwracanie jednego zestawu danych, a czasem eliminuje wszelkie dane w odpowiedzi, które nie są potrzebne w przypadku aplikacji mobilnej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="c0d42-139">Oczywiście można skompresować te dane.</span><span class="sxs-lookup"><span data-stu-id="c0d42-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="c0d42-140">Ponownie elewacja lub interfejs API w ramach aplikacji mobilnej i mikrousług może być wygodny dla tego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="c0d42-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="c0d42-141">Dlaczego warto rozważyć użycie bram interfejsu API zamiast bezpośredniej komunikacji klient-usługa</span><span class="sxs-lookup"><span data-stu-id="c0d42-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="c0d42-142">W architekturze mikrousług aplikacje klienckie zazwyczaj wymagają użycia funkcji z więcej niż jednej mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="c0d42-143">Jeśli zużycie jest wykonywane bezpośrednio, klient musi obsłużyć wiele wywołań punktów końcowych mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="c0d42-144">Co się stanie po rozwojem i wprowadzeniu nowych mikrousług lub zaktualizowaniu istniejących mikrousług?</span><span class="sxs-lookup"><span data-stu-id="c0d42-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="c0d42-145">Jeśli aplikacja ma wiele mikrousług, obsługa tak wielu punktów końcowych z aplikacji klienckich może być okropnej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="c0d42-146">Ze względu na to, że aplikacja kliencka będzie dołączona do tych wewnętrznych punktów końcowych, rozwój mikrousług w przyszłości może mieć duży wpływ na aplikacje klienckie.</span><span class="sxs-lookup"><span data-stu-id="c0d42-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="c0d42-147">W związku z tym, że posiadanie poziomu pośredniego lub warstwy pośredni (brama) może być bardzo wygodne w przypadku aplikacji opartych na mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="c0d42-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="c0d42-148">Jeśli nie masz bram interfejsu API, aplikacje klienckie muszą wysyłać żądania bezpośrednio do mikrousług i zgłaszać problemy, takie jak następujące problemy:</span><span class="sxs-lookup"><span data-stu-id="c0d42-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="c0d42-149">**Sprzęganie**: bez wzorca interfejsu API, aplikacje klienckie są połączone z mikrousługami wewnętrznymi.</span><span class="sxs-lookup"><span data-stu-id="c0d42-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="c0d42-150">Aplikacje klienckie muszą wiedzieć, jak wiele obszarów aplikacji jest rozłożonych na mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="c0d42-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="c0d42-151">Podczas rozwoju i refaktoryzacji wewnętrznych mikrousług te działania mają wpływ na konserwację, ponieważ powodują istotne zmiany w aplikacjach klienckich z powodu bezpośredniego odniesienia do mikrousług wewnętrznych z aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="c0d42-151">When evolving and refactoring the internal microservices, those actions impact maintenance because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="c0d42-152">Aplikacje klienckie należy często aktualizować, dzięki czemu rozwiązanie jest trudniejsze do roztworzenia.</span><span class="sxs-lookup"><span data-stu-id="c0d42-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="c0d42-153">**Zbyt wiele rund**: pojedyncza strona/ekran w aplikacji klienckiej może wymagać kilku wywołań do wielu usług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="c0d42-154">Może to prowadzić do wielu operacji sieciowych między klientem a serwerem, co zwiększa znaczne opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="c0d42-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="c0d42-155">Agregacja obsługiwana na poziomie pośrednim może poprawić wydajność i środowisko użytkownika dla aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="c0d42-156">**Problemy z zabezpieczeniami**: bez bramy wszystkie mikrousługi muszą być narażone na "zewnętrzny świat", co sprawia, że obszar ataku jest większy niż w przypadku ukrycia wewnętrznych mikrousług, które nie są bezpośrednio używane przez aplikacje klienckie.</span><span class="sxs-lookup"><span data-stu-id="c0d42-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="c0d42-157">Im mniejsza jest powierzchnia narażona na ataki, tym bezpieczniejsze może być aplikacja.</span><span class="sxs-lookup"><span data-stu-id="c0d42-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="c0d42-158">**Zagadnienia dotyczące krzyżowego wycinania**: Każda publicznie opublikowana mikrousługa musi obsługiwać takie kwestie, jak autoryzacja i SSL.</span><span class="sxs-lookup"><span data-stu-id="c0d42-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization and SSL.</span></span> <span data-ttu-id="c0d42-159">W wielu sytuacjach te problemy mogą być obsługiwane w jednej warstwie, dzięki czemu wewnętrzne mikrousługi są uproszczone.</span><span class="sxs-lookup"><span data-stu-id="c0d42-159">In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="c0d42-160">Co to jest wzorzec bramy interfejsu API?</span><span class="sxs-lookup"><span data-stu-id="c0d42-160">What is the API Gateway pattern?</span></span>

<span data-ttu-id="c0d42-161">Podczas projektowania i kompilowania dużych lub złożonych aplikacji opartych na mikrousługach z wieloma aplikacjami klienckimi dobrym podejściem do rozważenia może być [brama interfejsu API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="c0d42-161">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="c0d42-162">Jest to usługa, która zapewnia pojedynczy punkt wejścia dla niektórych grup mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-162">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="c0d42-163">Jest to podobne do [wzorca zaufana fasady](https://en.wikipedia.org/wiki/Facade_pattern) z projektu zorientowanego obiektowo, ale w tym przypadku jest częścią systemu rozproszonego.</span><span class="sxs-lookup"><span data-stu-id="c0d42-163">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="c0d42-164">Wzorzec bramy interfejsu API jest również czasami znany jako "zaplecze dla frontonu" ([BFF](https://samnewman.io/patterns/architectural/bff/)), ponieważ można go skompilować przy użyciu aplikacji klienta.</span><span class="sxs-lookup"><span data-stu-id="c0d42-164">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="c0d42-165">W związku z tym Brama interfejsu API znajduje się między aplikacjami klienta i mikrousługami.</span><span class="sxs-lookup"><span data-stu-id="c0d42-165">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="c0d42-166">Działa jako zwrotny serwer proxy, żądania routingu od klientów do usług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-166">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="c0d42-167">Może również udostępniać dodatkowe funkcje, takie jak uwierzytelnianie, kończenie połączeń SSL i pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-167">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="c0d42-168">Rysunek 4-13 pokazuje, jak niestandardowa Brama interfejsu API może pasować do uproszczonej architektury opartej na mikrousługach i zaledwie kilku mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-168">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagram przedstawiający bramę interfejsu API zaimplementowaną jako usługa niestandardowa.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/custom-service-api-gateway.png)

<span data-ttu-id="c0d42-170">**Rysunek 4-13**.</span><span class="sxs-lookup"><span data-stu-id="c0d42-170">**Figure 4-13**.</span></span> <span data-ttu-id="c0d42-171">Korzystanie z bramy interfejsu API wdrożonej jako usługa niestandardowa</span><span class="sxs-lookup"><span data-stu-id="c0d42-171">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="c0d42-172">Aplikacje nawiązują połączenie z jednym punktem końcowym, który jest skonfigurowany do przesyłania żądań do poszczególnych mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-172">Apps connect to a single endpoint, the API Gateway, that's configured to forward requests to individual microservices.</span></span> <span data-ttu-id="c0d42-173">W tym przykładzie Brama interfejsu API zostanie zaimplementowana jako niestandardowa ASP.NET Core usługi WebHost działającej jako kontener.</span><span class="sxs-lookup"><span data-stu-id="c0d42-173">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="c0d42-174">Ważne jest, aby podkreślić, że na tym diagramie jest używana jedna niestandardowa Usługa bramy API z wieloma aplikacjami klienckimi.</span><span class="sxs-lookup"><span data-stu-id="c0d42-174">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="c0d42-175">Ten fakt może być ważnym ryzykiem, ponieważ usługa bramy interfejsu API będzie rośnie i rozwijana na podstawie wielu różnych wymagań aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="c0d42-175">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="c0d42-176">Na koniec będzie bloated z powodu tych różnych potrzeb i efektywnie może być podobny do monolitycznej aplikacji lub monolitycznej usługi.</span><span class="sxs-lookup"><span data-stu-id="c0d42-176">Eventually, it will be bloated because of those different needs and effectively it could be similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="c0d42-177">Z tego względu zdecydowanie zaleca się poddzielenie bramy interfejsu API w wielu usługach lub wielu mniejszych bramach interfejsu API, a na przykład jeden typ czynnika na aplikację klienta.</span><span class="sxs-lookup"><span data-stu-id="c0d42-177">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="c0d42-178">Należy zachować ostrożność podczas implementowania wzorca interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-178">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="c0d42-179">Zwykle nie jest dobrym pomysłem na agregowanie wszystkich mikrousług wewnętrznych aplikacji przez pojedynczą bramę interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-179">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="c0d42-180">Jeśli tak, działa jako agregator monolityczny lub Koordynator i narusza autonomię mikrousług przez Sprzęganie wszystkich mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-180">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="c0d42-181">W związku z tym bramy interfejsu API powinny być segregowane na podstawie granic firmy i aplikacji klienckich, a nie działają jako pojedyncze agregatory dla wszystkich mikrousług wewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="c0d42-181">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="c0d42-182">Podczas dzielenia warstwy bramy interfejsu API na wiele bram interfejsu API, jeśli aplikacja ma wiele aplikacji klienckich, które mogą być głównym obszarem wystawcy podczas identyfikowania wielu typów bram interfejsu API, dzięki czemu można mieć inną fasadę dla potrzeb każdej aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-182">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="c0d42-183">Ten przypadek jest wzorcem o nazwie "zaplecze dla frontonu" ([BFF](https://samnewman.io/patterns/architectural/bff/)), gdzie każda Brama interfejsu API może zapewnić inny interfejs API dostosowany do każdego typu aplikacji klienta, prawdopodobnie nawet w oparciu o współczynnik formularza klienta przez zaimplementowanie określonego kodu karty, który jest zgodny z wieloma mikrousługami wewnętrznymi, jak pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="c0d42-183">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagram przedstawiający wiele niestandardowych bram interfejsu API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/multiple-custom-api-gateways.png)

<span data-ttu-id="c0d42-185">**Rysunek 4 — 13.1**.</span><span class="sxs-lookup"><span data-stu-id="c0d42-185">**Figure 4-13.1**.</span></span> <span data-ttu-id="c0d42-186">Używanie wielu niestandardowych bram interfejsu API</span><span class="sxs-lookup"><span data-stu-id="c0d42-186">Using multiple custom API Gateways</span></span>

<span data-ttu-id="c0d42-187">Rysunek 4.13.1 zawiera bramy interfejsu API, które są segregowane według typu klienta; jeden dla klientów mobilnych i jeden dla klientów sieci Web.</span><span class="sxs-lookup"><span data-stu-id="c0d42-187">Figure 4-13.1 shows API Gateways that are segregated by client type; one for mobile clients and one for web clients.</span></span> <span data-ttu-id="c0d42-188">Tradycyjna aplikacja internetowa łączy się z mikrousługą MVC korzystającą z bramy internetowego interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-188">A traditional web app connects to an MVC microservice that uses the web API Gateway.</span></span> <span data-ttu-id="c0d42-189">W przykładzie przedstawiono uproszczoną architekturę z wieloma szczegółowymi bramami interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-189">The example depicts a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="c0d42-190">W takim przypadku granice zidentyfikowane dla każdej bramy interfejsu API są oparte wyłącznie na wzorcu zaplecza dla frontonu ([BFF](https://samnewman.io/patterns/architectural/bff/)), dlatego są oparte tylko na interfejsie API, który jest wymagany dla aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-190">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="c0d42-191">Jednak w większych aplikacjach należy również utworzyć dodatkowe bramy interfejsu API oparte na granicach firmy jako drugi przestawkę projektowania.</span><span class="sxs-lookup"><span data-stu-id="c0d42-191">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="c0d42-192">Główne funkcje w wzorcu bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="c0d42-192">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="c0d42-193">Brama interfejsu API może oferować wiele funkcji.</span><span class="sxs-lookup"><span data-stu-id="c0d42-193">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="c0d42-194">W zależności od produktu może on oferować bogatsze lub prostsze funkcje, jednak najważniejsze i podstawowe funkcje dla każdej bramy interfejsu API są następujące:</span><span class="sxs-lookup"><span data-stu-id="c0d42-194">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="c0d42-195">**Zwrotny serwer proxy lub Routing bramy.**</span><span class="sxs-lookup"><span data-stu-id="c0d42-195">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="c0d42-196">Brama interfejsu API oferuje zwrotny serwer proxy do przekierowywania lub kierowania żądań (Routing warstwy 7, zazwyczaj żądania HTTP) do punktów końcowych mikrousług wewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="c0d42-196">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="c0d42-197">Brama zawiera pojedynczy punkt końcowy lub adres URL dla aplikacji klienckich, a następnie wewnętrznie mapuje żądania do grupy mikrousług wewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="c0d42-197">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="c0d42-198">Ta funkcja routingu ułatwia oddzielenie aplikacji klienckich od mikrousług, ale jest również wygodne podczas modernizacji interfejsu API monolitycznej przez umieszczenie bramy interfejsu API między monolitycznym interfejsem API i aplikacjami klienckim, a następnie dodanie nowych interfejsów API jako nowych mikrousług przy użyciu starszego monolitycznego interfejsu API, dopóki nie zostanie on podzielony na wiele mikrousług w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="c0d42-198">This routing feature helps to decouple the client apps from the microservices but it's also convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="c0d42-199">Ze względu na bramę interfejsu API aplikacje klienckie nie będą wyszukiwane, jeśli używane interfejsy API są implementowane jako mikrousługi wewnętrzne lub monolityczny interfejs API, a co ważniejsze, podczas rozwijania i refaktoryzacji monolitycznego interfejsu API do mikrousług, dzięki routingu bramy interfejsu API nie będą miały wpływu na żadną zmianę identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="c0d42-199">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="c0d42-200">Aby uzyskać więcej informacji, zobacz [wzorzec routingu bramy](/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="c0d42-200">For more information, see [Gateway routing pattern](/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="c0d42-201">**Żąda agregacji.**</span><span class="sxs-lookup"><span data-stu-id="c0d42-201">**Requests aggregation.**</span></span> <span data-ttu-id="c0d42-202">W ramach wzorca bramy można agregować wiele żądań klientów (zazwyczaj żądania HTTP) ukierunkowane na wiele mikrousług wewnętrznych na jedno żądanie klienta.</span><span class="sxs-lookup"><span data-stu-id="c0d42-202">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="c0d42-203">Ten wzorzec jest szczególnie wygodniejszy, gdy strona/ekran klienta potrzebuje informacji z kilku mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-203">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="c0d42-204">W tym podejściu aplikacja kliencka wysyła pojedyncze żądanie do bramy interfejsu API, która rozsyła kilka żądań do wewnętrznych mikrousług, a następnie agreguje wyniki i wysyła wszystko z powrotem do aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="c0d42-204">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="c0d42-205">Główną korzyścią i celem tego wzorca projektowego jest zredukowanie chattiness między aplikacjami klienckimi i interfejsem API zaplecza, co jest szczególnie ważne w przypadku aplikacji zdalnych z centrum danych, w których na żywo znajdują się mikrousługi, takie jak aplikacje mobilne lub żądania odbierane z aplikacji SPA w przeglądarkach zdalnych klienta.</span><span class="sxs-lookup"><span data-stu-id="c0d42-205">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from JavaScript in client remote browsers.</span></span> <span data-ttu-id="c0d42-206">W przypadku zwykłych aplikacji sieci Web, które wykonują żądania w środowisku serwera (na przykład w aplikacji sieci Web ASP.NET Core MVC), ten wzorzec nie jest tak ważny, ponieważ opóźnienie jest bardzo mniejsze niż w przypadku zdalnych aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="c0d42-206">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="c0d42-207">W zależności od używanego produktu bramy API może być możliwe przeprowadzenie tego agregacji.</span><span class="sxs-lookup"><span data-stu-id="c0d42-207">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="c0d42-208">Jednak w wielu przypadkach bardziej elastyczne jest tworzenie mikrousług agregacji w zakresie bramy interfejsu API, dlatego należy zdefiniować agregację w kodzie (czyli kodzie C#):</span><span class="sxs-lookup"><span data-stu-id="c0d42-208">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="c0d42-209">Aby uzyskać więcej informacji, zobacz [wzorzec agregacji bramy](/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="c0d42-209">For more information, see [Gateway aggregation pattern](/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="c0d42-210">**Problemy z wycinaniem lub odciążanie bramy.**</span><span class="sxs-lookup"><span data-stu-id="c0d42-210">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="c0d42-211">W zależności od funkcji oferowanych przez każdy produkt bramy interfejsu API można odciążyć funkcje z poszczególnych mikrousług do bramy, co upraszcza implementację każdej mikrousługi przez konsolidowanie zagadnień związanych z przecinaniem do jednej warstwy.</span><span class="sxs-lookup"><span data-stu-id="c0d42-211">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="c0d42-212">Jest to szczególnie wygodne w przypadku wyspecjalizowanych funkcji, które mogą być skomplikowane do prawidłowego wdrożenia w każdej wewnętrznej mikrousług, takiej jak następujące:</span><span class="sxs-lookup"><span data-stu-id="c0d42-212">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="c0d42-213">Uwierzytelnianie i autoryzacja</span><span class="sxs-lookup"><span data-stu-id="c0d42-213">Authentication and authorization</span></span>
- <span data-ttu-id="c0d42-214">Integracja odnajdowania usług</span><span class="sxs-lookup"><span data-stu-id="c0d42-214">Service discovery integration</span></span>
- <span data-ttu-id="c0d42-215">Buforowanie odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="c0d42-215">Response caching</span></span>
- <span data-ttu-id="c0d42-216">Zasady ponawiania, wyłącznik i jakość usług (QoS)</span><span class="sxs-lookup"><span data-stu-id="c0d42-216">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="c0d42-217">Ograniczanie i ograniczanie szybkości</span><span class="sxs-lookup"><span data-stu-id="c0d42-217">Rate limiting and throttling</span></span>
- <span data-ttu-id="c0d42-218">Równoważenie obciążenia</span><span class="sxs-lookup"><span data-stu-id="c0d42-218">Load balancing</span></span>
- <span data-ttu-id="c0d42-219">Rejestrowanie, śledzenie, korelacja</span><span class="sxs-lookup"><span data-stu-id="c0d42-219">Logging, tracing, correlation</span></span>
- <span data-ttu-id="c0d42-220">Nagłówki, ciągi zapytań i przekształcenia oświadczeń</span><span class="sxs-lookup"><span data-stu-id="c0d42-220">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="c0d42-221">Listy dozwolonych IP</span><span class="sxs-lookup"><span data-stu-id="c0d42-221">IP whitelisting</span></span>

<span data-ttu-id="c0d42-222">Aby uzyskać więcej informacji, zobacz [wzorzec odciążania bramy](/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="c0d42-222">For more information, see [Gateway offloading pattern](/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="c0d42-223">Korzystanie z produktów z funkcjami bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="c0d42-223">Using products with API Gateway features</span></span>

<span data-ttu-id="c0d42-224">W zależności od implementacji można uzyskać wiele dodatkowych zagadnień związanych z obcinaniem, które są oferowane przez bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-224">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="c0d42-225">Będziemy tutaj eksplorować następujące informacje:</span><span class="sxs-lookup"><span data-stu-id="c0d42-225">We'll explore here:</span></span>

- [<span data-ttu-id="c0d42-226">Usługa Azure API Management</span><span class="sxs-lookup"><span data-stu-id="c0d42-226">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="c0d42-227">Ocelot</span><span class="sxs-lookup"><span data-stu-id="c0d42-227">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="c0d42-228">Usługa Azure API Management</span><span class="sxs-lookup"><span data-stu-id="c0d42-228">Azure API Management</span></span>

<span data-ttu-id="c0d42-229">[API Management platformy Azure](https://azure.microsoft.com/services/api-management/) (jak pokazano na rysunku 4-14) nie tylko rozwiązuje potrzeby bramy interfejsu API, ale udostępnia funkcje, takie jak gromadzenie szczegółowych informacji z interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="c0d42-230">W przypadku korzystania z rozwiązania do zarządzania INTERFEJSami API Brama interfejsu API jest tylko składnikiem tego pełnego rozwiązania do zarządzania interfejsem API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-230">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Diagram przedstawiający sposób używania platformy Azure API Management jako bramy interfejsu API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/api-gateway-azure-api-management.png)

<span data-ttu-id="c0d42-232">**Rysunek 4-14**.</span><span class="sxs-lookup"><span data-stu-id="c0d42-232">**Figure 4-14**.</span></span> <span data-ttu-id="c0d42-233">Korzystanie z API Management platformy Azure dla bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="c0d42-233">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="c0d42-234">Usługa Azure API Management rozwiązuje zarówno bramę interfejsu API, jak i potrzeby związane z zarządzaniem, takie jak rejestrowanie, zabezpieczenia, pomiary itp. W tym przypadku, gdy korzystasz z produktu, takiego jak Azure API Management, oznacza to, że użytkownik może mieć pojedynczą bramę interfejsu API, ponieważ nie jest to ryzykowne, ponieważ tego rodzaju bramy interfejsu API są "cieńsze", co oznacza, że nie zaimplementowano niestandardowego kodu w języku C#, który może się rozwijać do składnika monolitycznego.</span><span class="sxs-lookup"><span data-stu-id="c0d42-234">Azure API Management solves both your API Gateway and Management needs like logging, security, metering, etc. In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span>

<span data-ttu-id="c0d42-235">Produkty bramy interfejsu API zwykle działają podobnie jak zwrotny serwer proxy dla komunikacji przychodzącej, gdzie można również filtrować interfejsy API z wewnętrznych mikrousług i stosować autoryzację do opublikowanych interfejsów API w tej pojedynczej warstwie.</span><span class="sxs-lookup"><span data-stu-id="c0d42-235">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="c0d42-236">Szczegółowe informacje dostępne w systemie API Management pomagają w zrozumieniu sposobu używania interfejsów API i sposobu ich wykonywania.</span><span class="sxs-lookup"><span data-stu-id="c0d42-236">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="c0d42-237">Służą one do wyświetlania raportów analizy niemal w czasie rzeczywistym i identyfikowania trendów, które mogą mieć wpływ na Twoją firmę.</span><span class="sxs-lookup"><span data-stu-id="c0d42-237">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="c0d42-238">Ponadto możesz mieć dzienniki dotyczące aktywności żądań i odpowiedzi w celu dalszej analizy w trybie online i offline.</span><span class="sxs-lookup"><span data-stu-id="c0d42-238">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="c0d42-239">Za pomocą usługi Azure API Management można zabezpieczyć interfejsy API przy użyciu klucza, tokenu i filtrowania adresów IP.</span><span class="sxs-lookup"><span data-stu-id="c0d42-239">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="c0d42-240">Te funkcje pozwalają wymuszać elastyczne i szczegółowe limity przydziałów, modyfikować kształt i zachowanie interfejsów API przy użyciu zasad oraz zwiększyć wydajność z buforowaniem odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="c0d42-240">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="c0d42-241">W tym przewodniku i aplikacji przykładowej odniesienia (eShopOnContainers) architektura jest ograniczona do prostszej i niestandardowej architektury kontenerów, która umożliwia skoncentrowanie się na zwykłych kontenerach bez używania produktów PaaS, takich jak Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="c0d42-241">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="c0d42-242">Jednak w przypadku dużych aplikacji opartych na mikrousługach wdrożonych w Microsoft Azure zachęcamy do ocenienia API Management platformy Azure jako podstawy dla bram interfejsu API w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="c0d42-242">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="c0d42-243">Ocelot</span><span class="sxs-lookup"><span data-stu-id="c0d42-243">Ocelot</span></span>

<span data-ttu-id="c0d42-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) to uproszczona Brama interfejsu API, zalecana dla uproszczenia podejścia.</span><span class="sxs-lookup"><span data-stu-id="c0d42-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="c0d42-245">Ocelot to brama interfejsu API typu open source oparta na platformie .NET Core, szczególnie dla architektury mikrousług, które potrzebują ujednoliconych punktów wejścia w ich systemach.</span><span class="sxs-lookup"><span data-stu-id="c0d42-245">Ocelot is an Open Source .NET Core-based API Gateway especially made for microservices architectures that need unified points of entry into their systems.</span></span> <span data-ttu-id="c0d42-246">Jest ona uproszczona, szybka i skalowalna oraz oferuje Routing i uwierzytelnianie między wieloma innymi funkcjami.</span><span class="sxs-lookup"><span data-stu-id="c0d42-246">It's lightweight, fast, and scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="c0d42-247">Głównym powodem wyboru Ocelot [aplikacji referencyjnej eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers) jest fakt, że Ocelot jest bramą interfejsu API platformy .NET Core, którą można wdrożyć w tym samym środowisku wdrażania aplikacji, w którym są wdrażane mikrousługi/kontenery, takie jak Host platformy Docker, Kubernetes itp. I ponieważ jest ona oparta na platformie .NET Core, to na wielu platformach można wdrożyć w systemie Linux lub Windows.</span><span class="sxs-lookup"><span data-stu-id="c0d42-247">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="c0d42-248">Poprzednie diagramy pokazujące niestandardowe bramy interfejsu API działające w kontenerach są precyzyjnie, jak można także uruchomić Ocelot w aplikacji opartej na kontenerach i mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="c0d42-248">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="c0d42-249">Ponadto istnieje wiele innych produktów na rynku oferujących funkcje bram interfejsu API, takie jak Apigee, Hongkong, MuleSoft, WSO2 i inne produkty, takie jak konsolidator i Istio dla funkcji kontrolera usług transferu danych w sieci.</span><span class="sxs-lookup"><span data-stu-id="c0d42-249">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="c0d42-250">Po wstępnym rozpoczęciu architektury i wzorców sekcjach w następnych sekcjach opisano sposób implementacji bram interfejsu API w programie [Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="c0d42-250">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="c0d42-251">Wady wzorca interfejsu API</span><span class="sxs-lookup"><span data-stu-id="c0d42-251">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="c0d42-252">Najważniejszym wadą jest to, że po zaimplementowaniu bramy interfejsu API przyłączasz ją do warstwy wewnętrznej mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-252">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="c0d42-253">Sprzęganie takie może spowodować poważne problemy dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c0d42-253">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="c0d42-254">Blogu clemensay, architekt w zespole Azure Service Bus, odnosi się do tego potencjalnego trudności jako "nowe ESB" w sesji "[Obsługa i mikrousługi](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" w lokalizacji goto 2016.</span><span class="sxs-lookup"><span data-stu-id="c0d42-254">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="c0d42-255">Za pomocą bramy interfejsu API mikrousług tworzy dodatkowe możliwe single point of failure.</span><span class="sxs-lookup"><span data-stu-id="c0d42-255">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="c0d42-256">Brama interfejsu API może wprowadzić zwiększony czas odpowiedzi ze względu na dodatkowe połączenie sieciowe.</span><span class="sxs-lookup"><span data-stu-id="c0d42-256">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="c0d42-257">Jednak takie dodatkowe wywołanie zwykle ma mniej wpływu niż interfejs klienta, który jest zbyt rozmawiany bezpośrednio z mikrousług wewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="c0d42-257">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="c0d42-258">W przypadku poprawnego skalowania bramy interfejsu API może stać się wąskim gardłem.</span><span class="sxs-lookup"><span data-stu-id="c0d42-258">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="c0d42-259">Brama interfejsu API wymaga dodatkowego kosztu rozwoju i przyszłej konserwacji, jeśli obejmuje logikę niestandardową i agregację danych.</span><span class="sxs-lookup"><span data-stu-id="c0d42-259">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="c0d42-260">Deweloperzy muszą zaktualizować bramę interfejsu API, aby uwidocznić poszczególne punkty końcowe mikrousług.</span><span class="sxs-lookup"><span data-stu-id="c0d42-260">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="c0d42-261">Ponadto zmiany implementacji w wewnętrznych mikrousługach mogą spowodować zmiany kodu na poziomie bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c0d42-261">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="c0d42-262">Jeśli jednak Brama interfejsu API właśnie stosuje zabezpieczenia, rejestrowanie i przechowywanie wersji (tak jak w przypadku korzystania z usługi Azure API Management), ten dodatkowy koszt programistyczny może nie mieć zastosowania.</span><span class="sxs-lookup"><span data-stu-id="c0d42-262">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="c0d42-263">Jeśli Brama interfejsu API jest opracowana przez jednego zespołu, może to być wąskie gardło.</span><span class="sxs-lookup"><span data-stu-id="c0d42-263">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="c0d42-264">Jest to kolejny powód, dla którego lepszym rozwiązaniem jest posiadanie kilku bram interfejsów API z ograniczeniami, które reagują na różne potrzeby klientów.</span><span class="sxs-lookup"><span data-stu-id="c0d42-264">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="c0d42-265">Bramę interfejsu API można również podzielić wewnętrznie na wiele obszarów lub warstw, które są własnością różnych zespołów pracujących nad mikrousługami wewnętrznymi.</span><span class="sxs-lookup"><span data-stu-id="c0d42-265">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="c0d42-266">Zasoby dodatkowe</span><span class="sxs-lookup"><span data-stu-id="c0d42-266">Additional resources</span></span>

- <span data-ttu-id="c0d42-267">**Krzysztof Richardson. Wzorzec: Brama interfejsu API/zaplecze dla frontonu** </span><span class="sxs-lookup"><span data-stu-id="c0d42-267">**Chris Richardson. Pattern: API Gateway / Backend for Front-End** </span></span>\
  <https://microservices.io/patterns/apigateway.html>

- <span data-ttu-id="c0d42-268">**Wzorzec bramy interfejsu API** </span><span class="sxs-lookup"><span data-stu-id="c0d42-268">**API Gateway pattern** </span></span>\
  <https://docs.microsoft.com/azure/architecture/microservices/gateway>

- <span data-ttu-id="c0d42-269">**Wzorzec agregacji i kompozycji** </span><span class="sxs-lookup"><span data-stu-id="c0d42-269">**Aggregation and composition pattern** </span></span>\
  <https://microservices.io/patterns/data/api-composition.html>

- <span data-ttu-id="c0d42-270">**API Management platformy Azure** </span><span class="sxs-lookup"><span data-stu-id="c0d42-270">**Azure API Management** </span></span>\
  <https://azure.microsoft.com/services/api-management/>

- <span data-ttu-id="c0d42-271">**UDI Dahan. Składowe zorientowane na usługę** </span><span class="sxs-lookup"><span data-stu-id="c0d42-271">**Udi Dahan. Service Oriented Composition** </span></span>\
  <https://udidahan.com/2014/07/30/service-oriented-composition-with-video/>

- <span data-ttu-id="c0d42-272">**Blogu Clemensa. Obsługa komunikatów i mikrousług w programie GOTO 2016 (wideo)** </span><span class="sxs-lookup"><span data-stu-id="c0d42-272">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** </span></span>\
  <https://www.youtube.com/watch?v=rXi5CLjIQ9k>

- <span data-ttu-id="c0d42-273">**Brama interfejsu API w usłudze Nutshell** (seria samouczków bramy interfejsu API ASP.NET Core) </span><span class="sxs-lookup"><span data-stu-id="c0d42-273">**API Gateway in a Nutshell** (ASP.NET Core API Gateway Tutorial Series) </span></span>\
  <https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html>

>[!div class="step-by-step"]
><span data-ttu-id="c0d42-274">[Poprzedni](identify-microservice-domain-model-boundaries.md) 
> [Dalej](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="c0d42-274">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>
