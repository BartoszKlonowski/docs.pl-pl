---
title: Identyfikowanie ograniczeń modelu domeny dla poszczególnych mikrousług
description: Eksploruj istotę partycjonowania dużej aplikacji na mikrousługi w celu uzyskania architektury dźwięku.
ms.date: 09/20/2018
ms.openlocfilehash: 9c433066dd8e93dbb09b15e58c9c85617775723d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/14/2020
ms.locfileid: "71834413"
---
# <a name="identify-domain-model-boundaries-for-each-microservice"></a><span data-ttu-id="42426-103">Identyfikowanie granic modelu domeny dla każdej mikrousługi</span><span class="sxs-lookup"><span data-stu-id="42426-103">Identify domain-model boundaries for each microservice</span></span>

<span data-ttu-id="42426-104">Celem podczas identyfikowania granic modelu i rozmiar dla każdej mikrousługi nie jest, aby uzyskać do najbardziej szczegółowe separacji możliwe, mimo że należy dążyć do małych mikrousług, jeśli to możliwe.</span><span class="sxs-lookup"><span data-stu-id="42426-104">The goal when identifying model boundaries and size for each microservice isn't to get to the most granular separation possible, although you should tend toward small microservices if possible.</span></span> <span data-ttu-id="42426-105">Zamiast tego twoim celem powinno być dotarcie do najbardziej znaczącej separacji opartej na wiedzy o domenie.</span><span class="sxs-lookup"><span data-stu-id="42426-105">Instead, your goal should be to get to the most meaningful separation guided by your domain knowledge.</span></span> <span data-ttu-id="42426-106">Nacisk nie kładzie się na rozmiar, ale na możliwości biznesowe.</span><span class="sxs-lookup"><span data-stu-id="42426-106">The emphasis isn't on the size, but instead on business capabilities.</span></span> <span data-ttu-id="42426-107">Ponadto jeśli istnieje spójność jest potrzebna dla określonego obszaru aplikacji na podstawie dużej liczby zależności, co wskazuje na potrzebę pojedynczej mikrousługi, zbyt.</span><span class="sxs-lookup"><span data-stu-id="42426-107">In addition, if there's clear cohesion needed for a certain area of the application based on a high number of dependencies, that indicates the need for a single microservice, too.</span></span> <span data-ttu-id="42426-108">Spójność jest sposobem, aby określić, jak rozdzielić lub grupować mikrousług.</span><span class="sxs-lookup"><span data-stu-id="42426-108">Cohesion is a way to identify how to break apart or group together microservices.</span></span> <span data-ttu-id="42426-109">Ostatecznie podczas uzyskiwania większej wiedzy na temat domeny, należy dostosować rozmiar mikrousługi, iteracyjne.</span><span class="sxs-lookup"><span data-stu-id="42426-109">Ultimately, while you gain more knowledge about the domain, you should adapt the size of your microservice, iteratively.</span></span> <span data-ttu-id="42426-110">Znalezienie odpowiedniego rozmiaru nie jest procesem jednorazowym.</span><span class="sxs-lookup"><span data-stu-id="42426-110">Finding the right size isn't a one-shot process.</span></span>

<span data-ttu-id="42426-111">[Sam Newman](https://samnewman.io/), uznany promotor mikrousług i autor książki [Building Microservices](https://samnewman.io/books/building_microservices/), podkreśla, że należy zaprojektować mikrousług na podstawie wzorca ograniczonego kontekstu (BC) (część projektu opartego na domenie), jak wprowadzono wcześniej.</span><span class="sxs-lookup"><span data-stu-id="42426-111">[Sam Newman](https://samnewman.io/), a recognized promoter of microservices and author of the book [Building Microservices](https://samnewman.io/books/building_microservices/), highlights that you should design your microservices based on the Bounded Context (BC) pattern (part of domain-driven design), as introduced earlier.</span></span> <span data-ttu-id="42426-112">Czasami bc może składać się z kilku usług fizycznych, ale nie odwrotnie.</span><span class="sxs-lookup"><span data-stu-id="42426-112">Sometimes, a BC could be composed of several physical services, but not vice versa.</span></span>

<span data-ttu-id="42426-113">Model domeny z określonymi jednostkami domeny ma zastosowanie w obrębie konkretnego bc lub mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="42426-113">A domain model with specific domain entities applies within a concrete BC or microservice.</span></span> <span data-ttu-id="42426-114">Bc ogranicza możliwość stosowania modelu domeny i daje członkom zespołu deweloperów jasne i wspólne zrozumienie tego, co musi być spójność i co może być rozwijany niezależnie.</span><span class="sxs-lookup"><span data-stu-id="42426-114">A BC delimits the applicability of a domain model and gives developer team members a clear and shared understanding of what must be cohesive and what can be developed independently.</span></span> <span data-ttu-id="42426-115">Są to te same cele dla mikrousług.</span><span class="sxs-lookup"><span data-stu-id="42426-115">These are the same goals for microservices.</span></span>

<span data-ttu-id="42426-116">Innym narzędziem, które informuje o wyborze projektu jest [prawo Conwaya,](https://en.wikipedia.org/wiki/Conway%27s_law)które stanowi, że aplikacja będzie odzwierciedlać granice społeczne organizacji, która go wyprodukowała.</span><span class="sxs-lookup"><span data-stu-id="42426-116">Another tool that informs your design choice is [Conway's law](https://en.wikipedia.org/wiki/Conway%27s_law), which states that an application will reflect the social boundaries of the organization that produced it.</span></span> <span data-ttu-id="42426-117">Ale czasami jest odwrotnie - organizacja firmy jest tworzona przez oprogramowanie.</span><span class="sxs-lookup"><span data-stu-id="42426-117">But sometimes the opposite is true -the company's organization is formed by the software.</span></span> <span data-ttu-id="42426-118">Być może trzeba odwrócić prawo Conway i budować granice tak, jak chcesz, aby firma została zorganizowana, opierając się w kierunku doradztwa procesowego.</span><span class="sxs-lookup"><span data-stu-id="42426-118">You might need to reverse Conway's law and build the boundaries the way you want the company to be organized, leaning toward business process consulting.</span></span>

<span data-ttu-id="42426-119">Aby zidentyfikować ograniczone konteksty, można użyć wzorca DDD o nazwie [wzorzec mapowania kontekstu](https://www.infoq.com/articles/ddd-contextmapping).</span><span class="sxs-lookup"><span data-stu-id="42426-119">To identify bounded contexts, you can use a DDD pattern called the [Context Mapping pattern](https://www.infoq.com/articles/ddd-contextmapping).</span></span> <span data-ttu-id="42426-120">Za pomocą mapowania kontekstu można zidentyfikować różne konteksty w aplikacji i ich granice.</span><span class="sxs-lookup"><span data-stu-id="42426-120">With Context Mapping, you identify the various contexts in the application and their boundaries.</span></span> <span data-ttu-id="42426-121">Często ma inny kontekst i granicę dla każdego małego podsystemu, na przykład.</span><span class="sxs-lookup"><span data-stu-id="42426-121">It's common to have a different context and boundary for each small subsystem, for instance.</span></span> <span data-ttu-id="42426-122">Mapa kontekstowa jest sposobem definiowania i jawnego określania tych granic między domenami.</span><span class="sxs-lookup"><span data-stu-id="42426-122">The Context Map is a way to define and make explicit those boundaries between domains.</span></span> <span data-ttu-id="42426-123">Bc jest autonomiczny i zawiera szczegóły pojedynczej domeny - szczegóły, takie jak jednostki domeny- i definiuje umowy integracji z innymi bc.</span><span class="sxs-lookup"><span data-stu-id="42426-123">A BC is autonomous and includes the details of a single domain -details like the domain entities- and defines integration contracts with other BCs.</span></span> <span data-ttu-id="42426-124">Jest to podobne do definicji mikrousługi: jest autonomiczny, implementuje niektóre możliwości domeny i musi zapewnić interfejsy.</span><span class="sxs-lookup"><span data-stu-id="42426-124">This is similar to the definition of a microservice: it's autonomous, it implements certain domain capability, and it must provide interfaces.</span></span> <span data-ttu-id="42426-125">Dlatego mapowanie kontekstu i wzorzec kontekstu ograniczone są dobre podejścia do identyfikowania granic modelu domeny mikrousług.</span><span class="sxs-lookup"><span data-stu-id="42426-125">This is why Context Mapping and the Bounded Context pattern are good approaches for identifying the domain model boundaries of your microservices.</span></span>

<span data-ttu-id="42426-126">Podczas projektowania dużej aplikacji zobaczysz, jak można pofragmentować jej model domeny — ekspert domeny z domeny katalogu będzie na przykład nazywał jednostki w domenach wykazu i zapasów niż ekspert domeny wysyłkowej.</span><span class="sxs-lookup"><span data-stu-id="42426-126">When designing a large application, you'll see how its domain model can be fragmented - a domain expert from the catalog domain will name entities differently in the catalog and inventory domains than a shipping domain expert, for instance.</span></span> <span data-ttu-id="42426-127">Lub jednostka domeny użytkownika może być różny pod względem wielkości i liczby atrybutów w kontaktach z ekspertem CRM, który chce przechowywać każdy szczegół o kliencie niż dla eksperta domeny zamawiania, który potrzebuje tylko częściowe dane o kliencie.</span><span class="sxs-lookup"><span data-stu-id="42426-127">Or the user domain entity might be different in size and number of attributes when dealing with a CRM expert who wants to store every detail about the customer than for an ordering domain expert who just needs partial data about the customer.</span></span> <span data-ttu-id="42426-128">Bardzo trudno jest rozróżnić wszystkie terminy domen we wszystkich domenach związanych z dużą aplikacją.</span><span class="sxs-lookup"><span data-stu-id="42426-128">It's very hard to disambiguate all domain terms across all the domains related to a large application.</span></span> <span data-ttu-id="42426-129">Ale najważniejsze jest to, że nie powinieneś próbować jednoczyć terminów.</span><span class="sxs-lookup"><span data-stu-id="42426-129">But the most important thing is that you shouldn't try to unify the terms.</span></span> <span data-ttu-id="42426-130">Zamiast tego zaakceptuj różnice i bogactwo zapewniane przez każdą domenę.</span><span class="sxs-lookup"><span data-stu-id="42426-130">Instead, accept the differences and richness provided by each domain.</span></span> <span data-ttu-id="42426-131">Jeśli spróbujesz mieć ujednoliconą bazę danych dla całej aplikacji, próby jednolitego słownictwa będą niewygodne i nie będą brzmieć dobrze dla żadnego z wielu ekspertów domeny.</span><span class="sxs-lookup"><span data-stu-id="42426-131">If you try to have a unified database for the whole application, attempts at a unified vocabulary will be awkward and won't sound right to any of the multiple domain experts.</span></span> <span data-ttu-id="42426-132">W związku z tym kontrolerów domeny (zaimplementowane jako mikrousług) pomoże Ci wyjaśnić, gdzie można użyć niektórych terminów domeny i gdzie trzeba podzielić system i utworzyć dodatkowe kontrolery bcs z różnych domen.</span><span class="sxs-lookup"><span data-stu-id="42426-132">Therefore, BCs (implemented as microservices) will help you to clarify where you can use certain domain terms and where you'll need to split the system and create additional BCs with different domains.</span></span>

<span data-ttu-id="42426-133">Będziesz wiedzieć, że masz odpowiednie granice i rozmiary każdego bc i modelu domeny, jeśli masz kilka silnych relacji między modelami domeny i zwykle nie trzeba scalać informacje z wielu modeli domenpodczas wykonywania typowych operacji aplikacji .</span><span class="sxs-lookup"><span data-stu-id="42426-133">You'll know that you got the right boundaries and sizes of each BC and domain model if you have few strong relationships between domain models, and you do not usually need to merge information from multiple domain models when performing typical application operations.</span></span>

<span data-ttu-id="42426-134">Być może najlepszą odpowiedzią na pytanie, jak duży powinien być model domeny dla każdej mikrousługi, jest następujący: powinien mieć autonomiczny bc, tak izolowany, jak to możliwe, który umożliwia pracę bez konieczności ciągłego przełączania się do innych kontekstów (inne modeli mikrousług).</span><span class="sxs-lookup"><span data-stu-id="42426-134">Perhaps the best answer to the question of how large a domain model for each microservice should be is the following: it should have an autonomous BC, as isolated as possible, that enables you to work without having to constantly switch to other contexts (other microservice's models).</span></span> <span data-ttu-id="42426-135">Na rysunku 4-10, można zobaczyć, jak wiele mikrousług (wiele kontrolerów bcs) każdy ma swój własny model i jak ich jednostki mogą być zdefiniowane, w zależności od określonych wymagań dla każdej z domen zidentyfikowanych w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="42426-135">In Figure 4-10, you can see how multiple microservices (multiple BCs) each has their own model and how their entities can be defined, depending on the specific requirements for each of the identified domains in your application.</span></span>

![Diagram przedstawiający jednostki w kilku granicach modelu.](./media/identify-microservice-domain-model-boundaries/identify-entities-microservice-model-boundries.png)

<span data-ttu-id="42426-137">**Rysunek 4-10**.</span><span class="sxs-lookup"><span data-stu-id="42426-137">**Figure 4-10**.</span></span> <span data-ttu-id="42426-138">Identyfikowanie jednostek i granic modelu mikrousług</span><span class="sxs-lookup"><span data-stu-id="42426-138">Identifying entities and microservice model boundaries</span></span>

<span data-ttu-id="42426-139">Rysunek 4–10 przedstawia przykładowy scenariusz związany z systemem zarządzania konferencjami online.</span><span class="sxs-lookup"><span data-stu-id="42426-139">Figure 4-10 illustrates a sample scenario related to an online conference management system.</span></span> <span data-ttu-id="42426-140">Ta sama jednostka jest wyświetlana jako "Użytkownicy", "Kupujący", "Płatnicy" i "Klienci" w zależności od ograniczonego kontekstu.</span><span class="sxs-lookup"><span data-stu-id="42426-140">The same entity appears as "Users", "Buyers", "Payers", and "Customers" depending on the bounded context.</span></span> <span data-ttu-id="42426-141">Zidentyfikowano kilka kontrolerów bcs, które mogą być implementowane jako mikrousług, na podstawie domen, które eksperci domeny zdefiniowane dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="42426-141">You've identified several BCs that could be implemented as microservices, based on domains that domain experts defined for you.</span></span> <span data-ttu-id="42426-142">Jak widać istnieją jednostki, które są obecne tylko w jednym modelu mikrousługi, takich jak płatności w mikrousługi płatności.</span><span class="sxs-lookup"><span data-stu-id="42426-142">As you can see, there are entities that are present just in a single microservice model, like Payments in the Payment microservice.</span></span> <span data-ttu-id="42426-143">Będą one łatwe do wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="42426-143">Those will be easy to implement.</span></span>

<span data-ttu-id="42426-144">Jednak może również mieć jednostki, które mają inny kształt, ale mają tę samą tożsamość w wielu modelach domeny z wielu mikrousług.</span><span class="sxs-lookup"><span data-stu-id="42426-144">However, you might also have entities that have a different shape but share the same identity across the multiple domain models from the multiple microservices.</span></span> <span data-ttu-id="42426-145">Na przykład User jednostka jest identyfikowana w mikrousługi zarządzania konferencjami.</span><span class="sxs-lookup"><span data-stu-id="42426-145">For example, the User entity is identified in the Conferences Management microservice.</span></span> <span data-ttu-id="42426-146">Ten sam użytkownik, o tej samej tożsamości, jest jednym o nazwie Kupujący w mikrousługi zamawiania lub jeden o nazwie Płatnik w mikrousługi płatności, a nawet jeden o nazwie Klienta w mikrousłudze obsługi klienta.</span><span class="sxs-lookup"><span data-stu-id="42426-146">That same user, with the same identity, is the one named Buyers in the Ordering microservice, or the one named Payer in the Payment microservice, and even the one named Customer in the Customer Service microservice.</span></span> <span data-ttu-id="42426-147">Dzieje się tak, ponieważ w zależności od [wszechobecnego języka,](https://martinfowler.com/bliki/UbiquitousLanguage.html) z których korzysta każdy ekspert domeny, użytkownik może mieć inną perspektywę nawet z różnymi atrybutami.</span><span class="sxs-lookup"><span data-stu-id="42426-147">This is because, depending on the [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) that each domain expert is using, a user might have a different perspective even with different attributes.</span></span> <span data-ttu-id="42426-148">Jednostka użytkownika w modelu mikrousługi o nazwie Conferences Management może mieć większość swoich atrybutów danych osobowych.</span><span class="sxs-lookup"><span data-stu-id="42426-148">The user entity in the microservice model named Conferences Management might have most of its personal data attributes.</span></span> <span data-ttu-id="42426-149">Jednak ten sam użytkownik w kształcie płatnika w mikrousługi Płatności lub w kształcie Klienta w mikrousług obsługi klienta może nie potrzebować tej samej listy atrybutów.</span><span class="sxs-lookup"><span data-stu-id="42426-149">However, that same user in the shape of Payer in the microservice Payment or in the shape of Customer in the microservice Customer Service might not need the same list of attributes.</span></span>

<span data-ttu-id="42426-150">Podobne podejście przedstawiono na rysunku 4-11.</span><span class="sxs-lookup"><span data-stu-id="42426-150">A similar approach is illustrated in Figure 4-11.</span></span>

![Diagram przedstawiający sposób rozkładu modelu danych na wiele modeli domen.](./media/identify-microservice-domain-model-boundaries/decompose-traditional-data-models.png)

<span data-ttu-id="42426-152">**Rysunek 4-11**.</span><span class="sxs-lookup"><span data-stu-id="42426-152">**Figure 4-11**.</span></span> <span data-ttu-id="42426-153">Rozkładanie tradycyjnych modeli danych na wiele modeli domen</span><span class="sxs-lookup"><span data-stu-id="42426-153">Decomposing traditional data models into multiple domain models</span></span>

<span data-ttu-id="42426-154">Podczas rozkładu tradycyjnego modelu danych między kontekstami ograniczonymi, można mieć różne jednostki, które mają tę samą tożsamość (kupujący jest również użytkownikiem) z różnymi atrybutami w każdym kontekście ograniczonym.</span><span class="sxs-lookup"><span data-stu-id="42426-154">When decomposing a traditional data model between bounded contexts, you can have different entities that share the same identity (a buyer is also a user) with different attributes in each bounded context.</span></span> <span data-ttu-id="42426-155">Można zobaczyć, jak użytkownik jest obecny w modelu mikrousługi Zarządzanie konferencjami jako user jednostki i jest również obecny w postaci jednostki Kupujący w mikrousługi cen, z alternatywnych atrybutów lub szczegółów dotyczących użytkownika, gdy jest to rzeczywiście nabywcy.</span><span class="sxs-lookup"><span data-stu-id="42426-155">You can see how the user is present in the Conferences Management microservice model as the User entity and is also present in the form of the Buyer entity in the Pricing microservice, with alternate attributes or details about the user when it's actually a buyer.</span></span> <span data-ttu-id="42426-156">Każda mikrousługa lub BC może nie potrzebować wszystkich danych związanych z user jednostki, tylko część z nich, w zależności od problemu do rozwiązania lub kontekstu.</span><span class="sxs-lookup"><span data-stu-id="42426-156">Each microservice or BC might not need all the data related to a User entity, just part of it, depending on the problem to solve or the context.</span></span> <span data-ttu-id="42426-157">Na przykład w modelu mikrousługi cen nie trzeba adres lub nazwę użytkownika, tylko identyfikator (jako tożsamość) i stan, które będą miały wpływ na rabaty podczas wyceny miejsc na kupującego.</span><span class="sxs-lookup"><span data-stu-id="42426-157">For instance, in the Pricing microservice model, you do not need the address or the name of the user, just the ID (as identity) and Status, which will have an impact on discounts when pricing the seats per buyer.</span></span>

<span data-ttu-id="42426-158">Encja Seat ma taką samą nazwę, ale różne atrybuty w każdym modelu domeny.</span><span class="sxs-lookup"><span data-stu-id="42426-158">The Seat entity has the same name but different attributes in each domain model.</span></span> <span data-ttu-id="42426-159">Seat udostępnia jednak tożsamość na podstawie tego samego identyfikatora, tak jak ma to miejsce w przypadku Użytkownika i Kupującego.</span><span class="sxs-lookup"><span data-stu-id="42426-159">However, Seat shares identity based on the same ID, as happens with User and Buyer.</span></span>

<span data-ttu-id="42426-160">Zasadniczo istnieje wspólna koncepcja użytkownika, która istnieje w wielu usługach (domenach), które współużytkują tożsamość tego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="42426-160">Basically, there's a shared concept of a user that exists in multiple services (domains), which all share the identity of that user.</span></span> <span data-ttu-id="42426-161">Jednak w każdym modelu domeny mogą istnieć dodatkowe lub różne szczegóły dotyczące encji użytkownika.</span><span class="sxs-lookup"><span data-stu-id="42426-161">But in each domain model there might be additional or different details about the user entity.</span></span> <span data-ttu-id="42426-162">W związku z tym musi istnieć sposób mapowania jednostki użytkownika z jednej domeny (mikrousługi) do innej.</span><span class="sxs-lookup"><span data-stu-id="42426-162">Therefore, there needs to be a way to map a user entity from one domain (microservice) to another.</span></span>

<span data-ttu-id="42426-163">Istnieje kilka korzyści, aby nie udostępniać tej samej jednostki użytkownika z taką samą liczbą atrybutów w różnych domenach.</span><span class="sxs-lookup"><span data-stu-id="42426-163">There are several benefits to not sharing the same user entity with the same number of attributes across domains.</span></span> <span data-ttu-id="42426-164">Jedną z zalet jest zmniejszenie powielania, dzięki czemu modele mikrousług nie mają żadnych danych, które nie są potrzebne.</span><span class="sxs-lookup"><span data-stu-id="42426-164">One benefit is to reduce duplication, so that microservice models do not have any data that they do not need.</span></span> <span data-ttu-id="42426-165">Inną korzyścią jest posiadanie mikrousługi wzorcowej, która jest właścicielem określonego typu danych na jednostkę, dzięki czemu aktualizacje i zapytania dla tego typu danych są napędzane tylko przez tę mikrousługę.</span><span class="sxs-lookup"><span data-stu-id="42426-165">Another benefit is having a master microservice that owns a certain type of data per entity so that updates and queries for that type of data are driven only by that microservice.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="42426-166">[Poprzedni](distributed-data-management.md)
>[następny](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span><span class="sxs-lookup"><span data-stu-id="42426-166">[Previous](distributed-data-management.md)
[Next](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span></span>
