---
title: Konfiguracja scentralizowana
description: Scentralizowana konfiguracja aplikacji natywnych w chmurze przy użyciu usługi Azure App Configuration i magazynu AzureKey.
ms.date: 04/19/2020
ms.openlocfilehash: 53bdc03370b04af4d830fe7abbd8aebad81e9650
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895654"
---
# <a name="centralized-configuration"></a><span data-ttu-id="af99c-103">Konfiguracja scentralizowana</span><span class="sxs-lookup"><span data-stu-id="af99c-103">Centralized configuration</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="af99c-104">W przeciwieństwie do aplikacji monolitycznej, w której wszystko działa w ramach jednego wystąpienia, aplikacja natywna w chmurze składa się z niezależnych usług dystrybuowanych na maszynach wirtualnych, kontenerach i regionach geograficznych.</span><span class="sxs-lookup"><span data-stu-id="af99c-104">Unlike a monolithic app in which everything runs within a single instance, a cloud-native application consists of independent services distributed across virtual machines, containers, and geographic regions.</span></span> <span data-ttu-id="af99c-105">Zarządzanie ustawieniami konfiguracji dla dziesiątek usług zależnych może być trudne.</span><span class="sxs-lookup"><span data-stu-id="af99c-105">Managing configuration settings for dozens of interdependent services can be challenging.</span></span> <span data-ttu-id="af99c-106">Duplikowanie kopii ustawień konfiguracji w różnych lokalizacjach jest podatne na błędy i trudne do zarządzania.</span><span class="sxs-lookup"><span data-stu-id="af99c-106">Duplicate copies of configuration settings across different locations is error prone and difficult to manage.</span></span> <span data-ttu-id="af99c-107">Scentralizowana konfiguracja jest wymaganiem krytycznym dla rozproszonych aplikacji natywnych w chmurze.</span><span class="sxs-lookup"><span data-stu-id="af99c-107">Centralized configuration is a critical requirement for distributed cloud-native applications.</span></span>

<span data-ttu-id="af99c-108">Zgodnie z opisem w [rozdziale 1](introduction.md)rekomendacje dotyczące aplikacji 12-Factor wymagają ścisłego rozdzielenia kodu i konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="af99c-108">As discussed in [Chapter 1](introduction.md), the Twelve-Factor App recommendations require strict separation between code and configuration.</span></span> <span data-ttu-id="af99c-109">Konfiguracja musi być przechowywana zewnętrznie z aplikacji i w razie konieczności.</span><span class="sxs-lookup"><span data-stu-id="af99c-109">Configuration must be stored externally from the application and read-in as needed.</span></span> <span data-ttu-id="af99c-110">Przechowywanie wartości konfiguracyjnych jako stałych lub wartości literałów w kodzie jest naruszeniem.</span><span class="sxs-lookup"><span data-stu-id="af99c-110">Storing configuration values as constants or literal values in code is a violation.</span></span> <span data-ttu-id="af99c-111">Te same wartości konfiguracyjne są często używane przez wiele usług w tej samej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="af99c-111">The same configuration values are often be used by many services in the same application.</span></span> <span data-ttu-id="af99c-112">Ponadto musimy obsługiwać te same wartości w wielu środowiskach, takich jak programowanie, testowanie i produkcja.</span><span class="sxs-lookup"><span data-stu-id="af99c-112">Additionally, we must support the same values across multiple environments, such as dev, testing, and production.</span></span> <span data-ttu-id="af99c-113">Najlepszym rozwiązaniem jest przechowywanie ich w scentralizowanym magazynie konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="af99c-113">The best practice is store them in a centralized configuration store.</span></span>

<span data-ttu-id="af99c-114">W chmurze platformy Azure prezentowane są kilka doskonałych opcji.</span><span class="sxs-lookup"><span data-stu-id="af99c-114">The Azure cloud presents several great options.</span></span>

## <a name="azure-app-configuration"></a><span data-ttu-id="af99c-115">Azure App Configuration</span><span class="sxs-lookup"><span data-stu-id="af99c-115">Azure App Configuration</span></span>

<span data-ttu-id="af99c-116">[Konfiguracja aplikacji platformy Azure](https://docs.microsoft.com/azure/azure-app-configuration/overview) to w pełni zarządzana usługa platformy Azure, która przechowuje ustawienia konfiguracji inne niż tajne w bezpiecznej, scentralizowanej lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="af99c-116">[Azure App Configuration](https://docs.microsoft.com/azure/azure-app-configuration/overview) is a fully managed Azure service that stores non-secret configuration settings in a secure, centralized location.</span></span> <span data-ttu-id="af99c-117">Przechowywane wartości mogą być współużytkowane przez wiele usług i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="af99c-117">Stored values can be shared among multiple services and applications.</span></span>

<span data-ttu-id="af99c-118">Usługa jest prosta do użycia i oferuje kilka korzyści:</span><span class="sxs-lookup"><span data-stu-id="af99c-118">The service is simple to use and provides several benefits:</span></span>

- <span data-ttu-id="af99c-119">Elastyczne reprezentacje klucza/wartości i mapowania</span><span class="sxs-lookup"><span data-stu-id="af99c-119">Flexible key/value representations and mappings</span></span>
- <span data-ttu-id="af99c-120">Tagowanie przy użyciu etykiet platformy Azure</span><span class="sxs-lookup"><span data-stu-id="af99c-120">Tagging with Azure labels</span></span>
- <span data-ttu-id="af99c-121">Dedykowany interfejs użytkownika do zarządzania</span><span class="sxs-lookup"><span data-stu-id="af99c-121">Dedicated UI for management</span></span>
- <span data-ttu-id="af99c-122">Szyfrowanie informacji poufnych</span><span class="sxs-lookup"><span data-stu-id="af99c-122">Encryption of sensitive information</span></span>
- <span data-ttu-id="af99c-123">Wykonywanie zapytań i pobieranie wsadowe</span><span class="sxs-lookup"><span data-stu-id="af99c-123">Querying and batch retrieval</span></span>

<span data-ttu-id="af99c-124">Konfiguracja aplikacji platformy Azure zachowuje zmiany wprowadzone w ustawieniach klucz-wartość przez siedem dni.</span><span class="sxs-lookup"><span data-stu-id="af99c-124">Azure App Configuration maintains changes made to key-value settings for seven days.</span></span> <span data-ttu-id="af99c-125">Funkcja migawek do momentu umożliwia odtworzenie historii ustawienia, a nawet wycofanie dla niepowodzenia wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="af99c-125">The point-in-time snapshot feature enables you to reconstruct the history of a setting and even rollback for a failed deployment.</span></span>

<span data-ttu-id="af99c-126">Konfiguracja aplikacji automatycznie buforuje każde ustawienie, aby uniknąć nadmiernych wywołań do magazynu konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="af99c-126">App Configuration automatically caches each setting to avoid excessive calls to the configuration store.</span></span> <span data-ttu-id="af99c-127">Operacja odświeżania czeka, aż wygaśnie wartość ustawienia w celu zaktualizowania tego ustawienia, nawet w przypadku zmiany jego wartości w magazynie konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="af99c-127">The refresh operation waits until the cached value of a setting expires to update that setting, even when its value changes in the configuration store.</span></span> <span data-ttu-id="af99c-128">Domyślny czas wygaśnięcia pamięci podręcznej wynosi 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="af99c-128">The default cache expiration time is 30 seconds.</span></span> <span data-ttu-id="af99c-129">Można przesłonić czas wygaśnięcia.</span><span class="sxs-lookup"><span data-stu-id="af99c-129">You can override the expiration time.</span></span>

<span data-ttu-id="af99c-130">Konfiguracja aplikacji szyfruje wszystkie wartości konfiguracji podczas przesyłania i przechowywania.</span><span class="sxs-lookup"><span data-stu-id="af99c-130">App Configuration encrypts all configuration values in transit and at rest.</span></span> <span data-ttu-id="af99c-131">Nazwy kluczy i etykiety są używane jako indeksy do pobierania danych konfiguracji i nie są szyfrowane.</span><span class="sxs-lookup"><span data-stu-id="af99c-131">Key names and labels are used as indexes for retrieving configuration data and aren't encrypted.</span></span>

<span data-ttu-id="af99c-132">Mimo że konfiguracja aplikacji zapewnia zabezpieczenia z ograniczeniami, Azure Key Vault jest nadal najlepszym miejscem do przechowywania wpisów tajnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="af99c-132">Although App Configuration provides hardened security, Azure Key Vault is still the best place for storing application secrets.</span></span> <span data-ttu-id="af99c-133">Key Vault zapewnia szyfrowanie na poziomie sprzętu, szczegółowe zasady dostępu oraz operacje zarządzania, takie jak rotacja certyfikatów.</span><span class="sxs-lookup"><span data-stu-id="af99c-133">Key Vault provides hardware-level encryption, granular access policies, and management operations such as certificate rotation.</span></span> <span data-ttu-id="af99c-134">Można utworzyć wartości konfiguracji aplikacji, które odwołują się do wpisów tajnych przechowywanych w Key Vault.</span><span class="sxs-lookup"><span data-stu-id="af99c-134">You can create App Configuration values that reference secrets stored in a Key Vault.</span></span>

## <a name="azure-key-vault"></a><span data-ttu-id="af99c-135">W usłudze Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="af99c-135">Azure Key Vault</span></span>

<span data-ttu-id="af99c-136">Key Vault to usługa zarządzana w celu bezpiecznego przechowywania i uzyskiwania dostępu do wpisów tajnych.</span><span class="sxs-lookup"><span data-stu-id="af99c-136">Key Vault is a managed service for securely storing and accessing secrets.</span></span> <span data-ttu-id="af99c-137">Wpis tajny to dowolny zasób, do którego dostęp powinien być ściśle kontrolowany. Przykładowe wpisy tajne to klucze interfejsu API, hasła i certyfikaty.</span><span class="sxs-lookup"><span data-stu-id="af99c-137">A secret is anything that you want to tightly control access to, such as API keys, passwords, or certificates.</span></span> <span data-ttu-id="af99c-138">Magazyn jest logiczną grupą kluczy tajnych.</span><span class="sxs-lookup"><span data-stu-id="af99c-138">A vault is a logical group of secrets.</span></span>

<span data-ttu-id="af99c-139">Usługa Key Vault znacznie ogranicza prawdopodobieństwo przypadkowego ujawnienia wpisów tajnych.</span><span class="sxs-lookup"><span data-stu-id="af99c-139">Key Vault greatly reduces the chances that secrets may be accidentally leaked.</span></span> <span data-ttu-id="af99c-140">Korzystając z usługi Key Vault, deweloperzy aplikacji nie muszą już przechowywać informacji zabezpieczeń w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="af99c-140">When using Key Vault, application developers no longer need to store security information in their application.</span></span> <span data-ttu-id="af99c-141">To rozwiązanie eliminuje konieczność przechowywania tych informacji w kodzie.</span><span class="sxs-lookup"><span data-stu-id="af99c-141">This practice eliminates the need to store this information inside your code.</span></span> <span data-ttu-id="af99c-142">Na przykład aplikacja może potrzebować połączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="af99c-142">For example, an application may need to connect to a database.</span></span> <span data-ttu-id="af99c-143">Zamiast przechowywać parametry połączenia w kodzie aplikacji można je przechowywać bezpiecznie w usłudze Key Vault.</span><span class="sxs-lookup"><span data-stu-id="af99c-143">Instead of storing the connection string in the app's code, you can store it securely in Key Vault.</span></span>

<span data-ttu-id="af99c-144">Twoje aplikacje mogą bezpiecznie uzyskiwać dostęp do potrzebnych informacji za pomocą identyfikatorów URI.</span><span class="sxs-lookup"><span data-stu-id="af99c-144">Your applications can securely access the information they need by using URIs.</span></span> <span data-ttu-id="af99c-145">Te identyfikatory URI umożliwiają aplikacjom pobranie określonych wersji wpisu tajnego.</span><span class="sxs-lookup"><span data-stu-id="af99c-145">These URIs allow the applications to retrieve specific versions of a secret.</span></span> <span data-ttu-id="af99c-146">Nie ma potrzeby pisania niestandardowego kodu w celu ochrony informacji poufnych przechowywanych w Key Vault.</span><span class="sxs-lookup"><span data-stu-id="af99c-146">There's no need to write custom code to protect any of the secret information stored in Key Vault.</span></span>

<span data-ttu-id="af99c-147">Dostęp do Key Vault wymaga właściwego uwierzytelniania i autoryzacji wywołującego.</span><span class="sxs-lookup"><span data-stu-id="af99c-147">Access to Key Vault requires proper caller authentication and authorization.</span></span> <span data-ttu-id="af99c-148">Zazwyczaj każda mikrousługa w chmurze używa kombinacji ClientId/ClientSecret.</span><span class="sxs-lookup"><span data-stu-id="af99c-148">Typically, each cloud-native microservice uses a ClientId/ClientSecret combination.</span></span> <span data-ttu-id="af99c-149">Ważne jest, aby zachować te poświadczenia poza kontrolą źródła.</span><span class="sxs-lookup"><span data-stu-id="af99c-149">It's important to keep these credentials outside source control.</span></span> <span data-ttu-id="af99c-150">Najlepszym rozwiązaniem jest ustawienie ich w środowisku aplikacji.</span><span class="sxs-lookup"><span data-stu-id="af99c-150">A best practice is to set them in  the application's environment.</span></span> <span data-ttu-id="af99c-151">Bezpośredni dostęp do Key Vault z AKS można osiągnąć przy użyciu [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span><span class="sxs-lookup"><span data-stu-id="af99c-151">Direct access to Key Vault from AKS can be achieved using [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span></span>

## <a name="configuration-in-eshop"></a><span data-ttu-id="af99c-152">Konfiguracja w eShop</span><span class="sxs-lookup"><span data-stu-id="af99c-152">Configuration in eShop</span></span>

<span data-ttu-id="af99c-153">Aplikacja eShopOnContainers obejmuje lokalne pliki ustawień aplikacji z każdą mikrousługą.</span><span class="sxs-lookup"><span data-stu-id="af99c-153">The eShopOnContainers application includes local application settings files with each microservice.</span></span> <span data-ttu-id="af99c-154">Te pliki są sprawdzane w kontroli źródła, ale nie zawierają wpisów tajnych, takich jak parametry połączenia lub klucze interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="af99c-154">These files are checked into source control, but don't include production secrets such as connection strings or API keys.</span></span> <span data-ttu-id="af99c-155">W środowisku produkcyjnym poszczególne ustawienia mogą zostać zastąpione zmiennymi środowiskowymi dla poszczególnych usług.</span><span class="sxs-lookup"><span data-stu-id="af99c-155">In production, individual settings may be overwritten with per-service environment variables.</span></span> <span data-ttu-id="af99c-156">Wprowadzanie wpisów tajnych w zmiennych środowiskowych jest powszechną metodą obsługi hostowanych aplikacji, ale nie zapewnia centralnego magazynu konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="af99c-156">Injecting secrets in environment variables is a common practice for hosted applications, but doesn't provide a central configuration store.</span></span> <span data-ttu-id="af99c-157">Aby zapewnić obsługę scentralizowanego zarządzania ustawieniami konfiguracji, każda mikrousługa zawiera ustawienie umożliwiające przełączenie między użyciem ustawień lokalnych lub Azure Key Vault ustawień.</span><span class="sxs-lookup"><span data-stu-id="af99c-157">To support centralized management of configuration settings, each microservice includes a setting to toggle between its use of local settings or Azure Key Vault settings.</span></span>

## <a name="references"></a><span data-ttu-id="af99c-158">Odwołania</span><span class="sxs-lookup"><span data-stu-id="af99c-158">References</span></span>

- [<span data-ttu-id="af99c-159">Architektura eShopOnContainers</span><span class="sxs-lookup"><span data-stu-id="af99c-159">The eShopOnContainers Architecture</span></span>](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Architecture)
- [<span data-ttu-id="af99c-160">Organizowanie aplikacji mikrousług i aplikacji z wieloma kontenerami w celu zapewnienia wysokiej skalowalności i dostępności</span><span class="sxs-lookup"><span data-stu-id="af99c-160">Orchestrating microservices and multi-container applications for high scalability and availability</span></span>](https://docs.microsoft.com/dotnet/architecture/microservices/architect-microservice-container-applications/scalable-available-multi-container-microservice-applications)
- [<span data-ttu-id="af99c-161">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="af99c-161">Azure API Management</span></span>](https://docs.microsoft.com/azure/api-management/api-management-key-concepts)
- [<span data-ttu-id="af99c-162">Przegląd Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="af99c-162">Azure SQL Database Overview</span></span>](https://docs.microsoft.com/azure/sql-database/sql-database-technical-overview)
- [<span data-ttu-id="af99c-163">Azure Cache for Redis</span><span class="sxs-lookup"><span data-stu-id="af99c-163">Azure Cache for Redis</span></span>](https://azure.microsoft.com/services/cache/)
- [<span data-ttu-id="af99c-164">Interfejs API usługi Azure Cosmos DB dla bazy danych MongoDB</span><span class="sxs-lookup"><span data-stu-id="af99c-164">Azure Cosmos DB's API for MongoDB</span></span>](https://docs.microsoft.com/azure/cosmos-db/mongodb-introduction)
- [<span data-ttu-id="af99c-165">Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="af99c-165">Azure Service Bus</span></span>](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview)
- [<span data-ttu-id="af99c-166">Omówienie usługi Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="af99c-166">Azure Monitor overview</span></span>](https://docs.microsoft.com/azure/azure-monitor/overview)
- <span data-ttu-id="af99c-167">[eShopOnContainers: Utwórz klaster Kubernetes w AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span><span class="sxs-lookup"><span data-stu-id="af99c-167">[eShopOnContainers: Create Kubernetes cluster in AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span></span>
- [<span data-ttu-id="af99c-168">eShopOnContainers: Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="af99c-168">eShopOnContainers: Azure Dev Spaces</span></span>](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Azure-Dev-Spaces)
- [<span data-ttu-id="af99c-169">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="af99c-169">Azure Dev Spaces</span></span>](https://docs.microsoft.com/azure/dev-spaces/about)

>[!div class="step-by-step"]
><span data-ttu-id="af99c-170">[Poprzedni](deploy-eshoponcontainers-azure.md)
>[Następny](scale-applications.md)</span><span class="sxs-lookup"><span data-stu-id="af99c-170">[Previous](deploy-eshoponcontainers-azure.md)
[Next](scale-applications.md)</span></span>
