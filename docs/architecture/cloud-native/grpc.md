---
title: grpc
description: Dowiedz się więcej o gRPC, jego roli w aplikacjach natywnych dla chmury i o tym, czym różni się od komunikacji HTTP RESTful.
author: robvet
ms.date: 03/31/2020
ms.openlocfilehash: 28a07ad5ec105d3fc5b65e4cf0ac0cd85eb16627
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/01/2020
ms.locfileid: "80524174"
---
# <a name="grpc"></a><span data-ttu-id="5466b-103">grpc</span><span class="sxs-lookup"><span data-stu-id="5466b-103">gRPC</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="5466b-104">Do tej pory w tej książce skupiliśmy się na komunikacji opartej na [REST.](https://docs.microsoft.com/azure/architecture/best-practices/api-design)</span><span class="sxs-lookup"><span data-stu-id="5466b-104">So far in this book, we've focused on [REST-based](https://docs.microsoft.com/azure/architecture/best-practices/api-design) communication.</span></span> <span data-ttu-id="5466b-105">Widzieliśmy, że REST jest elastyczny styl architektoniczny, który definiuje operacji opartych na CRUD względem zasobów jednostki.</span><span class="sxs-lookup"><span data-stu-id="5466b-105">We've seen that REST is a flexible architectural style that defines CRUD-based operations against entity resources.</span></span> <span data-ttu-id="5466b-106">Klienci współdziałają z zasobami w interfejsie HTTP za pomocą modelu komunikacji żądanie/odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="5466b-106">Clients interact with resources across HTTP with a request/response communication model.</span></span> <span data-ttu-id="5466b-107">Podczas gdy REST jest szeroko wdrażany, nowsza technologia komunikacyjna, gRPC, nabrała ogromnego rozpędu w całej społeczności natywnej chmury.</span><span class="sxs-lookup"><span data-stu-id="5466b-107">While REST is widely implemented, a newer communication technology, gRPC, has gained tremendous momentum across the cloud-native community.</span></span>

## <a name="what-is-grpc"></a><span data-ttu-id="5466b-108">Co to jest gRPC?</span><span class="sxs-lookup"><span data-stu-id="5466b-108">What is gRPC?</span></span>

<span data-ttu-id="5466b-109">gRPC to nowoczesna, wysokowydajna struktura, która rozwija odwieczny protokół [zdalnego wywołania procedury (RPC).](https://en.wikipedia.org/wiki/Remote_procedure_call)</span><span class="sxs-lookup"><span data-stu-id="5466b-109">gRPC is a modern, high-performance framework that evolves the age-old [remote procedure call (RPC)](https://en.wikipedia.org/wiki/Remote_procedure_call) protocol.</span></span> <span data-ttu-id="5466b-110">Na poziomie aplikacji gRPC usprawnia komunikację między klientami a usługami zaplecza.</span><span class="sxs-lookup"><span data-stu-id="5466b-110">At the application level, gRPC streamlines messaging between clients and back-end services.</span></span> <span data-ttu-id="5466b-111">Pochodzący z Google gRPC jest open source i częścią ekosystemu [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) ofert natywnych dla chmury.</span><span class="sxs-lookup"><span data-stu-id="5466b-111">Originating from Google, gRPC is open source and part of the  [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) ecosystem of cloud-native offerings.</span></span> <span data-ttu-id="5466b-112">CNCF uważa gRPC za [projekt inkubujący.](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc)</span><span class="sxs-lookup"><span data-stu-id="5466b-112">CNCF considers gRPC an [incubating project](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span></span> <span data-ttu-id="5466b-113">Inkubacja oznacza, że użytkownicy końcowi korzystają z tej technologii w zastosowaniach produkcyjnych, a projekt ma zdrową liczbę uczestników.</span><span class="sxs-lookup"><span data-stu-id="5466b-113">Incubating means end users are using the technology in production applications, and the project has a healthy number of contributors.</span></span>

<span data-ttu-id="5466b-114">Typowa aplikacja kliencka gRPC udostępni lokalną funkcję w procesie, która implementuje operację biznesową.</span><span class="sxs-lookup"><span data-stu-id="5466b-114">A typical gRPC client app will expose a local, in-process function that implements a business operation.</span></span> <span data-ttu-id="5466b-115">W obszarze obejmuje tej funkcji lokalnej wywołuje inną funkcję na komputerze zdalnym.</span><span class="sxs-lookup"><span data-stu-id="5466b-115">Under the covers, that local function invokes another function on a remote machine.</span></span> <span data-ttu-id="5466b-116">To, co wydaje się być wywołaniem lokalnym, zasadniczo staje się przezroczystym wywołaniem poza procesem usługi zdalnej.</span><span class="sxs-lookup"><span data-stu-id="5466b-116">What appears to be a local call essentially becomes a transparent out-of-process call to a remote service.</span></span> <span data-ttu-id="5466b-117">Instalacja wodno-kanalizacyjna RPC streszcza komunikację sieciową typu point-to-point, serializację i wykonywanie między komputerami.</span><span class="sxs-lookup"><span data-stu-id="5466b-117">The RPC plumbing abstracts the point-to-point networking communication, serialization, and execution between computers.</span></span>

<span data-ttu-id="5466b-118">W aplikacjach natywnych dla chmury deweloperzy często pracują w różnych językach programowania, strukturach i technologiach.</span><span class="sxs-lookup"><span data-stu-id="5466b-118">In cloud-native applications, developers often work across programming languages, frameworks, and technologies.</span></span> <span data-ttu-id="5466b-119">Ta *interoperacyjność* komplikuje kontrakty komunikatów i instalację wodno-kanalizacyjną wymaganą do komunikacji między platformami.</span><span class="sxs-lookup"><span data-stu-id="5466b-119">This *interoperability* complicates message contracts and the plumbing required for cross-platform communication.</span></span>  <span data-ttu-id="5466b-120">gRPC zapewnia "jednolitą warstwę poziomą", która streszcza te obawy.</span><span class="sxs-lookup"><span data-stu-id="5466b-120">gRPC provides a "uniform horizontal layer" that abstracts these concerns.</span></span> <span data-ttu-id="5466b-121">Kod programistów na ich natywnej platformie koncentruje się na funkcjonalności biznesowej, podczas gdy gRPC obsługuje instalację wodno-kanalizacyjną komunikacji.</span><span class="sxs-lookup"><span data-stu-id="5466b-121">Developers code in their native platform focused on business functionality, while gRPC handles communication plumbing.</span></span>

<span data-ttu-id="5466b-122">gRPC oferuje kompleksowe wsparcie w większości popularnych stosów deweloperskich, w tym Java, JavaScript, C#, Go, Swift i NodeJS.</span><span class="sxs-lookup"><span data-stu-id="5466b-122">gRPC offers comprehensive support across most popular development stacks, including Java, JavaScript, C#, Go, Swift, and NodeJS.</span></span>

## <a name="grpc-benefits"></a><span data-ttu-id="5466b-123">Korzyści gRPC</span><span class="sxs-lookup"><span data-stu-id="5466b-123">gRPC Benefits</span></span>

<span data-ttu-id="5466b-124">GRPC używa protokołu HTTP/2 dla swojego protokołu transportu.</span><span class="sxs-lookup"><span data-stu-id="5466b-124">gRPC uses HTTP/2 for its transport protocol.</span></span> <span data-ttu-id="5466b-125">Chociaż jest kompatybilny z protokołem HTTP 1.1, HTTP/2 oferuje wiele zaawansowanych funkcji:</span><span class="sxs-lookup"><span data-stu-id="5466b-125">While compatible with HTTP 1.1, HTTP/2 features many advanced capabilities:</span></span>

- <span data-ttu-id="5466b-126">Protokół binarny do transportu danych — w przeciwieństwie do PROTOKOŁU HTTP 1.1, który wysyła dane jako tekst bezwyzowy.</span><span class="sxs-lookup"><span data-stu-id="5466b-126">A binary protocol for data transport - unlike HTTP 1.1, which sends data as clear text.</span></span>
- <span data-ttu-id="5466b-127">Obsługa multipleksowania dla wysyłania wielu równoległych żądań za pośrednictwem tego samego połączenia — HTTP 1.1 ogranicza przetwarzanie do jednej wiadomości żądania/odpowiedzi naraz.</span><span class="sxs-lookup"><span data-stu-id="5466b-127">Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1 limits processing to one request/response message at a time.</span></span>
- <span data-ttu-id="5466b-128">Dwukierunkowa komunikacja pełnodupleksowa do jednoczesnego wysyłania żądań klientów i odpowiedzi serwera.</span><span class="sxs-lookup"><span data-stu-id="5466b-128">Bidirectional full-duplex communication for sending both client requests and server responses simultaneously.</span></span>
- <span data-ttu-id="5466b-129">Wbudowane przesyłanie strumieniowe umożliwiające żądania i odpowiedzi na asynchronicznie strumienia dużych zestawów danych.</span><span class="sxs-lookup"><span data-stu-id="5466b-129">Built-in streaming enabling requests and responses to asynchronously stream large data sets.</span></span>

<span data-ttu-id="5466b-130">gRPC jest lekki i bardzo wydajny.</span><span class="sxs-lookup"><span data-stu-id="5466b-130">gRPC is lightweight and highly performant.</span></span> <span data-ttu-id="5466b-131">Może być nawet 8 razy szybszy niż serializacja JSON z wiadomościami o 60-80% mniejszymi.</span><span class="sxs-lookup"><span data-stu-id="5466b-131">It can be up to 8x faster than JSON serialization with messages 60-80% smaller.</span></span> <span data-ttu-id="5466b-132">W żargonie Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) wydajność gRPC przekracza szybkość i wydajność wysoce zoptymalizowanych [powiązań NetTCP](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span><span class="sxs-lookup"><span data-stu-id="5466b-132">In Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) parlance, gRPC performance exceeds the speed and efficiency of the highly optimized [NetTCP bindings](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span></span> <span data-ttu-id="5466b-133">W przeciwieństwie do NetTCP, który faworyzuje stos Microsoft, gRPC jest wieloplatformowy.</span><span class="sxs-lookup"><span data-stu-id="5466b-133">Unlike NetTCP, which favors the Microsoft stack, gRPC is cross-platform.</span></span>

## <a name="protocol-buffers"></a><span data-ttu-id="5466b-134">Bufory protokołu</span><span class="sxs-lookup"><span data-stu-id="5466b-134">Protocol Buffers</span></span>

<span data-ttu-id="5466b-135">gRPC obejmuje technologię open source o nazwie [Bufory protokołów.](https://developers.google.com/protocol-buffers/docs/overview)</span><span class="sxs-lookup"><span data-stu-id="5466b-135">gRPC embraces an open-source technology called [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview).</span></span> <span data-ttu-id="5466b-136">Zapewniają one wysoce wydajny i neutralny dla platformy format serializacji do serializacji wiadomości strukturalnych, które usługi wysyłają do siebie nawzajem.</span><span class="sxs-lookup"><span data-stu-id="5466b-136">They provide a highly efficient and platform-neutral serialization format for serializing structured messages that services send to each other.</span></span> <span data-ttu-id="5466b-137">Za pomocą języka definicji interfejsu między platformami (IDL), deweloperzy zdefiniować umowę serwisową dla każdej mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="5466b-137">Using a cross-platform Interface Definition Language (IDL), developers define a service contract for each microservice.</span></span> <span data-ttu-id="5466b-138">Umowa, zaimplementowana jako `.proto` plik tekstowy, opisuje metody, dane wejściowe i wyjściowe dla każdej usługi.</span><span class="sxs-lookup"><span data-stu-id="5466b-138">The contract, implemented as a text-based `.proto` file, describes the methods, inputs, and outputs for each service.</span></span> <span data-ttu-id="5466b-139">Ten sam plik umowy może być używany dla klientów gRPC i usług zbudowanych na różnych platformach programisty.</span><span class="sxs-lookup"><span data-stu-id="5466b-139">The same contract file can be used for gRPC clients and services built on different development platforms.</span></span>

<span data-ttu-id="5466b-140">Za pomocą pliku proto, kompilator `protoc`Protobuf, generuje zarówno kod klienta i usługi dla platformy docelowej.</span><span class="sxs-lookup"><span data-stu-id="5466b-140">Using the proto file, the Protobuf compiler, `protoc`, generates both client and service code for your target platform.</span></span> <span data-ttu-id="5466b-141">Kod zawiera następujące składniki:</span><span class="sxs-lookup"><span data-stu-id="5466b-141">The code includes the following components:</span></span>

- <span data-ttu-id="5466b-142">Silnie typizowane obiekty, współużytkowane przez klienta i usługi, które reprezentują operacje usługi i elementy danych dla wiadomości.</span><span class="sxs-lookup"><span data-stu-id="5466b-142">Strongly-typed objects, shared by the client and service, that represent the service operations and data elements for a message.</span></span>
- <span data-ttu-id="5466b-143">Silnie typizowana klasa podstawowa z wymaganą siecią wodno-kanalizacyjną, którą może dziedziczyć i rozszerzać zdalna usługa gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-143">A strongly-typed base class with the required network plumbing that the remote gRPC service can inherit and extend.</span></span>
- <span data-ttu-id="5466b-144">Wycinek klienta, który zawiera wymagane instalacji wodno-kanalizacyjnej do wywołania zdalnej usługi gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-144">A client stub that contains the required plumbing to invoke the remote gRPC service.</span></span>

<span data-ttu-id="5466b-145">W czasie wykonywania każda wiadomość jest serializowana jako standardowa reprezentacja Protobuf i wymieniana między klientem a usługą zdalną.</span><span class="sxs-lookup"><span data-stu-id="5466b-145">At runtime, each message is serialized as a standard Protobuf representation and exchanged between the client and remote service.</span></span> <span data-ttu-id="5466b-146">W przeciwieństwie do JSON lub XML, protobuf wiadomości są serializowane jako skompilowane bajtów binarnych.</span><span class="sxs-lookup"><span data-stu-id="5466b-146">Unlike JSON or XML, Protobuf messages are serialized as compiled binary bytes.</span></span>

<span data-ttu-id="5466b-147">Książka, [gRPC dla WCF Developers](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), dostępna w witrynie Microsoft Architecture, zapewnia szczegółowe pokrycie gRPC i buforów protokołów.</span><span class="sxs-lookup"><span data-stu-id="5466b-147">The book, [gRPC for WCF Developers](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), available from the Microsoft Architecture site, provides in-depth coverage of gRPC and Protocol Buffers.</span></span>

## <a name="grpc-support-in-net"></a><span data-ttu-id="5466b-148">Obsługa gRPC w .NET</span><span class="sxs-lookup"><span data-stu-id="5466b-148">gRPC support in .NET</span></span>

<span data-ttu-id="5466b-149">GRPC jest zintegrowany z .NET Core 3.0 SDK lub nowszym.</span><span class="sxs-lookup"><span data-stu-id="5466b-149">gRPC is integrated into .NET Core 3.0 SDK or later.</span></span> <span data-ttu-id="5466b-150">Obsługują go następujące narzędzia:</span><span class="sxs-lookup"><span data-stu-id="5466b-150">The following tools support it:</span></span>

- <span data-ttu-id="5466b-151">Visual Studio 2019, wersja 16.3 lub nowsza, z zainstalowanym obciążeniem tworzenia sieci Web.</span><span class="sxs-lookup"><span data-stu-id="5466b-151">Visual Studio 2019, version 16.3 or later, with the web development workload installed.</span></span>
- <span data-ttu-id="5466b-152">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="5466b-152">Visual Studio Code</span></span>
- <span data-ttu-id="5466b-153">dotnet CLI</span><span class="sxs-lookup"><span data-stu-id="5466b-153">the dotnet CLI</span></span>

<span data-ttu-id="5466b-154">Zestaw SDK zawiera narzędzia do routingu punktów końcowych, wbudowanego ioC i rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="5466b-154">The SDK includes tooling for endpoint routing, built-in IoC, and logging.</span></span> <span data-ttu-id="5466b-155">Serwer internetowy Kestrel typu open source obsługuje połączenia HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="5466b-155">The open-source Kestrel web server supports HTTP/2 connections.</span></span> <span data-ttu-id="5466b-156">Rysunek 4-20 przedstawia szablon programu Visual Studio 2019, który szkielet projektu dla usługi gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-156">Figure 4-20 shows a Visual Studio 2019 template that scaffolds a skeleton project for a gRPC service.</span></span> <span data-ttu-id="5466b-157">Zwróć uwagę, jak program .NET Core w pełni obsługuje systemy Windows, Linux i macOS.</span><span class="sxs-lookup"><span data-stu-id="5466b-157">Note how .NET Core fully supports Windows, Linux, and macOS.</span></span>

![Obsługa gRPC w programie Visual Studio 2019](./media/visual-studio-2019-grpc-template.png)

<span data-ttu-id="5466b-159">**Rysunek 4-20**.</span><span class="sxs-lookup"><span data-stu-id="5466b-159">**Figure 4-20**.</span></span> <span data-ttu-id="5466b-160">Obsługa gRPC w programie Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="5466b-160">gRPC support in Visual Studio 2019</span></span>
  
<span data-ttu-id="5466b-161">Rysunek 4-21 przedstawia usługę szkieletu gRPC wygenerowaną z wbudowanych szkieletów zawartych w programie Visual Studio 2019.</span><span class="sxs-lookup"><span data-stu-id="5466b-161">Figure 4-21 shows the skeleton gRPC service generated from the built-in scaffolding included in Visual Studio 2019.</span></span>  

![Projekt gRPC w programie Visual Studio 2019](./media/grpc-project.png  )

<span data-ttu-id="5466b-163">**Rysunek 4-21**.</span><span class="sxs-lookup"><span data-stu-id="5466b-163">**Figure 4-21**.</span></span> <span data-ttu-id="5466b-164">Projekt gRPC w programie Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="5466b-164">gRPC project in Visual Studio 2019</span></span>

<span data-ttu-id="5466b-165">Na poprzednim rysunku zanotuj plik opisu proto i kod usługi.</span><span class="sxs-lookup"><span data-stu-id="5466b-165">In the previous figure, note the proto description file and service code.</span></span> <span data-ttu-id="5466b-166">Jak zobaczysz wkrótce, Visual Studio generuje dodatkową konfigurację w klasie uruchamiania i pliku projektu źródłowego.</span><span class="sxs-lookup"><span data-stu-id="5466b-166">As you'll see shortly, Visual Studio generates additional configuration in both the Startup class and underlying project file.</span></span>

## <a name="grpc-usage"></a><span data-ttu-id="5466b-167">Użycie gRPC</span><span class="sxs-lookup"><span data-stu-id="5466b-167">gRPC usage</span></span>

<span data-ttu-id="5466b-168">Uprzywilejowanie gRPC dla następujących scenariuszy:</span><span class="sxs-lookup"><span data-stu-id="5466b-168">Favor gRPC for the following scenarios:</span></span>

- <span data-ttu-id="5466b-169">Synchroniczne wewnętrznej bazy danych mikrousług do mikrousług komunikacji, gdzie natychmiastowa odpowiedź jest wymagana do kontynuowania przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="5466b-169">Synchronous backend microservice-to-microservice communication where an immediate response is required to continue processing.</span></span>
- <span data-ttu-id="5466b-170">Środowiska polyglota, które muszą obsługiwać mieszane platformy programowania.</span><span class="sxs-lookup"><span data-stu-id="5466b-170">Polyglot environments that need to support mixed programming platforms.</span></span>
- <span data-ttu-id="5466b-171">Małe opóźnienia i wysoka przepustowość komunikacji, gdzie wydajność ma kluczowe znaczenie.</span><span class="sxs-lookup"><span data-stu-id="5466b-171">Low latency and high throughput communication where performance is critical.</span></span>
- <span data-ttu-id="5466b-172">Komunikacja w czasie rzeczywistym typu point-to-point - gRPC może wypychać wiadomości w czasie rzeczywistym bez sondowania i ma doskonałe wsparcie dla dwukierunkowego przesyłania strumieniowego.</span><span class="sxs-lookup"><span data-stu-id="5466b-172">Point-to-point real-time communication - gRPC can push messages in real time without polling and has excellent support for bi-directional streaming.</span></span>
- <span data-ttu-id="5466b-173">Środowiska ograniczone siecią — binarne komunikaty gRPC są zawsze mniejsze niż równoważny tekstowy komunikat JSON.</span><span class="sxs-lookup"><span data-stu-id="5466b-173">Network constrained environments – binary gRPC messages are always smaller than an equivalent text-based JSON message.</span></span>

<span data-ttu-id="5466b-174">W tym czasie, z tego pisania, gRPC jest używany głównie z usługami zaplecza.</span><span class="sxs-lookup"><span data-stu-id="5466b-174">At the time, of this writing, gRPC is primarily used with backend services.</span></span> <span data-ttu-id="5466b-175">Większość nowoczesnych przeglądarek nie może zapewnić poziomu kontroli HTTP/2 wymaganego do obsługi klienta gRPC front-end.</span><span class="sxs-lookup"><span data-stu-id="5466b-175">Most modern browsers can't provide the level of HTTP/2 control required to support a front-end gRPC client.</span></span> <span data-ttu-id="5466b-176">To powiedziawszy, istnieje [wczesna inicjatywa,](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) która umożliwia komunikację gRPC z aplikacji opartych na przeglądarce zbudowanych za pomocą technologii JavaScript lub Blazor WebAssembly.</span><span class="sxs-lookup"><span data-stu-id="5466b-176">That said, there's an [early initiative](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) that enables gRPC communication from browser-based apps built with JavaScript or Blazor WebAssembly technologies.</span></span> <span data-ttu-id="5466b-177">[GRPC-Web for .NET](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) umożliwia ASP.NET aplikacji Core gRPC do obsługi funkcji gRPC w aplikacjach przeglądarki:</span><span class="sxs-lookup"><span data-stu-id="5466b-177">The  [gRPC-Web for .NET](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) enables an ASP.NET Core gRPC app to support gRPC features in browser apps:</span></span>

- <span data-ttu-id="5466b-178">Klienci silnie typizowani generowani przez kod</span><span class="sxs-lookup"><span data-stu-id="5466b-178">Strongly-typed code-generated clients</span></span>
- <span data-ttu-id="5466b-179">Kompaktowe komunikaty Protobuf</span><span class="sxs-lookup"><span data-stu-id="5466b-179">Compact Protobuf messages</span></span>
- <span data-ttu-id="5466b-180">Przesyłanie strumieniowe serwera</span><span class="sxs-lookup"><span data-stu-id="5466b-180">Server streaming</span></span>

## <a name="grpc-implementation"></a><span data-ttu-id="5466b-181">Implementacja gRPC</span><span class="sxs-lookup"><span data-stu-id="5466b-181">gRPC implementation</span></span>

<span data-ttu-id="5466b-182">Architektura referencyjna mikrousług, [eShop on Containers](https://github.com/dotnet-architecture/eShopOnContainers)od firmy Microsoft, pokazuje, jak zaimplementować usługi gRPC w aplikacjach .NET Core.</span><span class="sxs-lookup"><span data-stu-id="5466b-182">The microservice reference architecture, [eShop on Containers](https://github.com/dotnet-architecture/eShopOnContainers), from Microsoft, shows how to implement gRPC services in .NET Core applications.</span></span> <span data-ttu-id="5466b-183">Rysunek 4-22 przedstawia architekturę zaplecza.</span><span class="sxs-lookup"><span data-stu-id="5466b-183">Figure 4-22 presents the back-end architecture.</span></span>

![Architektura zaplecza dla sklepu eShop na kontenerach](./media/eshop-with-aggregators.png)

<span data-ttu-id="5466b-185">**Rysunek 4-22**.</span><span class="sxs-lookup"><span data-stu-id="5466b-185">**Figure 4-22**.</span></span> <span data-ttu-id="5466b-186">Architektura zaplecza dla sklepu eShop na kontenerach</span><span class="sxs-lookup"><span data-stu-id="5466b-186">Backend architecture for eShop on Containers</span></span>

<span data-ttu-id="5466b-187">Na poprzednim rysunku należy zwrócić uwagę, jak sklep internetowy obejmuje [wzorzec wewnętrznej bazy dla frontendów](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF), udostępniając wiele bram interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="5466b-187">In the previous figure, note how eShop embraces the [Backend for Frontends pattern](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) by exposing multiple API gateways.</span></span> <span data-ttu-id="5466b-188">Omówiliśmy wzór BFF wcześniej w tym rozdziale.</span><span class="sxs-lookup"><span data-stu-id="5466b-188">We discussed the BFF pattern earlier in this chapter.</span></span> <span data-ttu-id="5466b-189">Należy zwrócić szczególną uwagę na mikrousługi agregatora (w kolorze szarym), który znajduje się między bramą interfejsu API zakupów sieci Web i wewnętrznej bazy danych zakupy mikrousług.</span><span class="sxs-lookup"><span data-stu-id="5466b-189">Pay close attention to the Aggregator microservice (in gray) that sits between the Web-Shopping API Gateway and backend Shopping microservices.</span></span> <span data-ttu-id="5466b-190">Agregator odbiera pojedyncze żądanie od klienta, wysyła go do różnych mikrousług, agreguje wyniki i wysyła je z powrotem do klienta żądającego.</span><span class="sxs-lookup"><span data-stu-id="5466b-190">The Aggregator receives a single request from a client, dispatches it to various microservices, aggregates the results, and sends them back to the requesting client.</span></span> <span data-ttu-id="5466b-191">Takie operacje zazwyczaj wymagają komunikacji synchroniczowej, aby uzyskać natychmiastową odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="5466b-191">Such operations typically require synchronous communication as to produce an immediate response.</span></span> <span data-ttu-id="5466b-192">W sklepie internetowym wywołania zaplecza z agregatora są wykonywane przy użyciu gRPC, jak pokazano na rysunku 4-23.</span><span class="sxs-lookup"><span data-stu-id="5466b-192">In eShop, backend calls from the Aggregator are performed using gRPC as shown in Figure 4-23.</span></span>

![gRPC w eShop na kontenerach](./media/grpc-implementation.png)

<span data-ttu-id="5466b-194">**Rysunek 4-23**.</span><span class="sxs-lookup"><span data-stu-id="5466b-194">**Figure 4-23**.</span></span> <span data-ttu-id="5466b-195">gRPC w eShop na kontenerach</span><span class="sxs-lookup"><span data-stu-id="5466b-195">gRPC in eShop on Containers</span></span>

<span data-ttu-id="5466b-196">Komunikacja gRPC wymaga zarówno składników klienta, jak i serwera.</span><span class="sxs-lookup"><span data-stu-id="5466b-196">gRPC communication requires both client and server components.</span></span> <span data-ttu-id="5466b-197">Na poprzednim rysunku należy zwrócić uwagę na sposób, w jaki agregator zakupów implementuje klienta gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-197">In the previous figure, note how the Shopping Aggregator implements a gRPC client.</span></span> <span data-ttu-id="5466b-198">Klient wykonuje synchroniczne wywołania gRPC (na czerwono) do mikrousług wewnętrznej bazy danych, z których każda implementuje serwer gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-198">The client makes synchronous gRPC calls (in red) to backend microservices, each of which implement a gRPC server.</span></span> <span data-ttu-id="5466b-199">Zarówno klient, jak i serwer korzystają z wbudowanej instalacji wodno-kanalizacyjnej gRPC z pliku .NET Core 3.0 SDK.</span><span class="sxs-lookup"><span data-stu-id="5466b-199">Both the client and server take advantage of the built-in gRPC plumbing from the .NET Core 3.0 SDK.</span></span> <span data-ttu-id="5466b-200">*Wycinki* po stronie klienta zapewniają instalację wodno-kanalizacyjną do wywoływania zdalnych wywołań gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-200">Client-side *stubs* provide the plumbing to invoke remote gRPC calls.</span></span> <span data-ttu-id="5466b-201">Składniki po stronie serwera zapewniają gRPC instalacji wodno-kanalizacyjne, które klasy usług niestandardowych można dziedziczyć i zużywać.</span><span class="sxs-lookup"><span data-stu-id="5466b-201">Server-side components provide gRPC plumbing that custom service classes can inherit and consume.</span></span>

<span data-ttu-id="5466b-202">Mikrousługi, które udostępniają zarówno restful interfejsu API i gRPC komunikacji wymagają wielu punktów końcowych do zarządzania ruchem.</span><span class="sxs-lookup"><span data-stu-id="5466b-202">Microservices that expose both a RESTful API and gRPC communication require multiple endpoints to manage traffic.</span></span> <span data-ttu-id="5466b-203">Należy otworzyć punkt końcowy, który nasłuchuje ruchu HTTP dla wywołań RESTful i innego dla wywołań gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-203">You would open an endpoint that listens for HTTP traffic for the RESTful calls and another for gRPC calls.</span></span> <span data-ttu-id="5466b-204">Punkt końcowy gRPC musi być skonfigurowany dla protokołu HTTP/2, który jest wymagany do komunikacji gRPC.</span><span class="sxs-lookup"><span data-stu-id="5466b-204">The gRPC endpoint must be configured for the HTTP/2 protocol that is required for gRPC communication.</span></span>

<span data-ttu-id="5466b-205">Podczas gdy staramy się oddzielić mikrousług za pomocą wzorców komunikacji asynchronicznie, niektóre operacje wymagają bezpośrednich wywołań.</span><span class="sxs-lookup"><span data-stu-id="5466b-205">While we strive to decouple microservices with asynchronous communication patterns, some operations require direct calls.</span></span> <span data-ttu-id="5466b-206">gRPC powinien być podstawowym wyborem dla bezpośredniej synchroniczowej komunikacji między mikrousługami.</span><span class="sxs-lookup"><span data-stu-id="5466b-206">gRPC should be the primary choice for direct synchronous communication between microservices.</span></span> <span data-ttu-id="5466b-207">Jego wysokowydajny protokół komunikacyjny, oparty na HTTP/2 i buforach protokołów, sprawia, że jest to doskonały wybór.</span><span class="sxs-lookup"><span data-stu-id="5466b-207">Its high-performance communication protocol, based on HTTP/2 and protocol buffers, make it a perfect choice.</span></span>

## <a name="looking-ahead"></a><span data-ttu-id="5466b-208">Patrzenie w przyszłość</span><span class="sxs-lookup"><span data-stu-id="5466b-208">Looking ahead</span></span>

<span data-ttu-id="5466b-209">Patrząc w przyszłość, gRPC będzie nadal zyskiwać przyczepność dla systemów natywnych dla chmury.</span><span class="sxs-lookup"><span data-stu-id="5466b-209">Looking ahead, gRPC will continue to gain traction for cloud-native systems.</span></span> <span data-ttu-id="5466b-210">Korzyści z wydajności i łatwość rozwoju są atrakcyjne.</span><span class="sxs-lookup"><span data-stu-id="5466b-210">The performance benefits and ease of development are compelling.</span></span> <span data-ttu-id="5466b-211">Jednak REST będzie prawdopodobnie wokół przez długi czas.</span><span class="sxs-lookup"><span data-stu-id="5466b-211">However, REST will likely be around for a long time.</span></span> <span data-ttu-id="5466b-212">Wyróżnia się publicznie narażonych interfejsów API i ze względu na zgodność z powrotem.</span><span class="sxs-lookup"><span data-stu-id="5466b-212">It excels for publicly exposed APIs and for backward compatibility reasons.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="5466b-213">[Poprzedni](service-to-service-communication.md)
>[następny](service-mesh-communication-infrastructure.md)</span><span class="sxs-lookup"><span data-stu-id="5466b-213">[Previous](service-to-service-communication.md)
[Next](service-mesh-communication-infrastructure.md)</span></span>
