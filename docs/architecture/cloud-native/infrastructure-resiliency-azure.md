---
title: Odporność na platformę Azure
description: Tworzenie architektury natywnych aplikacji .NET w chmurze dla platformy Azure | Odporność infrastruktury chmurowej na platformę Azure
author: robvet
ms.date: 05/13/2020
ms.openlocfilehash: 752f1320d9dfa18e52b078763d221a787da15e8e
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/19/2020
ms.locfileid: "83613983"
---
# <a name="azure-platform-resiliency"></a><span data-ttu-id="5c2a5-103">Odporność na platformę Azure</span><span class="sxs-lookup"><span data-stu-id="5c2a5-103">Azure platform resiliency</span></span>

<span data-ttu-id="5c2a5-104">Tworzenie niezawodnej aplikacji w chmurze różni się od tradycyjnego tworzenia aplikacji lokalnych.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-104">Building a reliable application in the cloud is different from traditional on-premises application development.</span></span> <span data-ttu-id="5c2a5-105">Chociaż historycznie zakupiono sprzęt do skalowania w górę, w środowisku chmury można skalować w poziomie. Zamiast próbować uniknąć błędów, celem jest Minimalizacja ich efektów i utrzymywanie stabilności systemu.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-105">While historically you purchased higher-end hardware to scale up, in a cloud environment you scale out. Instead of trying to prevent failures, the goal is to minimize their effects and keep the system stable.</span></span>

<span data-ttu-id="5c2a5-106">Takie jak niezawodne aplikacje w chmurze wyświetlają różne charakterystyki:</span><span class="sxs-lookup"><span data-stu-id="5c2a5-106">That said, reliable cloud applications display distinct characteristics:</span></span>

- <span data-ttu-id="5c2a5-107">Są one odporne, odzyskiwane bezpiecznie z problemów i nadal działają.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-107">They're resilient, recover gracefully from problems, and continue to function.</span></span>
- <span data-ttu-id="5c2a5-108">Są one wysoce dostępne i działają zgodnie z oczekiwaniami w dobrej kondycji bez znaczącego przestoju.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-108">They're highly available (HA) and run as designed in a healthy state with no significant downtime.</span></span>

<span data-ttu-id="5c2a5-109">Zrozumienie, jak te charakterystyki współpracują ze sobą i jak mają wpływ na koszt — są niezbędne do tworzenia niezawodnej aplikacji natywnej dla chmury.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-109">Understanding how these characteristics work together - and how they affect cost - is essential to building a reliable cloud-native application.</span></span> <span data-ttu-id="5c2a5-110">Będziemy następnym zajrzeć się na sposoby tworzenia odporności i dostępności w aplikacjach natywnych w chmurze, korzystając z funkcji z chmury platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-110">We'll next look at ways that you can build resiliency and availability into your cloud-native applications leveraging features from the Azure cloud.</span></span>

## <a name="design-with-resiliency"></a><span data-ttu-id="5c2a5-111">Projektowanie z odpornością</span><span class="sxs-lookup"><span data-stu-id="5c2a5-111">Design with resiliency</span></span>

<span data-ttu-id="5c2a5-112">Mamy sprawność, że aplikacja reaguje na awarie i nadal pozostaje funkcjonalna.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-112">We've said resiliency enables your application to react to failure and still remain functional.</span></span> <span data-ttu-id="5c2a5-113">Dokument oficjalny dokument dotyczący [odporności na platformie Azure](https://azure.microsoft.com/mediahandler/files/resourcefiles/resilience-in-azure-whitepaper/Resilience%20in%20Azure.pdf)zawiera wskazówki dotyczące osiągania odporności na platformę Azure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-113">The whitepaper, [Resilience in Azure whitepaper](https://azure.microsoft.com/mediahandler/files/resourcefiles/resilience-in-azure-whitepaper/Resilience%20in%20Azure.pdf), provides guidance for achieving resilience in the Azure platform.</span></span> <span data-ttu-id="5c2a5-114">Oto kilka najważniejszych zaleceń:</span><span class="sxs-lookup"><span data-stu-id="5c2a5-114">Here are some key recommendations:</span></span>

- <span data-ttu-id="5c2a5-115">*Awaria sprzętowa.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-115">*Hardware failure.*</span></span> <span data-ttu-id="5c2a5-116">Tworzenie nadmiarowości w aplikacji przez wdrożenie składników w różnych domenach błędów.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-116">Build redundancy into the application by deploying components across different fault domains.</span></span> <span data-ttu-id="5c2a5-117">Na przykład upewnij się, że maszyny wirtualne platformy Azure są umieszczone w różnych stojakach przy użyciu zestawów dostępności.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-117">For example, ensure that Azure VMs are placed in different racks by using Availability Sets.</span></span>

- <span data-ttu-id="5c2a5-118">*Błąd centrum danych.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-118">*Datacenter failure.*</span></span> <span data-ttu-id="5c2a5-119">Tworzenie nadmiarowości w aplikacji ze strefami izolacji błędów w centrach danych.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-119">Build redundancy into the application with fault isolation zones across datacenters.</span></span> <span data-ttu-id="5c2a5-120">Na przykład upewnij się, że maszyny wirtualne platformy Azure są umieszczone w różnych odizolowanych centrach danych przy użyciu Strefy dostępności platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-120">For example, ensure that Azure VMs are placed in different fault-isolated datacenters by using Azure Availability Zones.</span></span>

- <span data-ttu-id="5c2a5-121">*Awaria regionalna.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-121">*Regional failure.*</span></span> <span data-ttu-id="5c2a5-122">Replikowanie danych i składników do innego regionu, dzięki czemu aplikacje mogą być szybko odzyskiwane.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-122">Replicate the data and components into another region so that applications can be quickly recovered.</span></span> <span data-ttu-id="5c2a5-123">Na przykład użyj Azure Site Recovery do replikowania maszyn wirtualnych platformy Azure do innego regionu platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-123">For example, use Azure Site Recovery to replicate Azure VMs to another Azure region.</span></span>

- <span data-ttu-id="5c2a5-124">*Duże obciążenie.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-124">*Heavy load.*</span></span> <span data-ttu-id="5c2a5-125">Równoważ obciążenie między wystąpieniami, aby obsłużyć maksymalne użycie.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-125">Load balance across instances to handle spikes in usage.</span></span> <span data-ttu-id="5c2a5-126">Na przykład Umieść co najmniej dwie maszyny wirtualne platformy Azure za modułem równoważenia obciążenia, aby dystrybuować ruch do wszystkich maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-126">For example, put two or more Azure VMs behind a load balancer to distribute traffic to all VMs.</span></span>

- <span data-ttu-id="5c2a5-127">*Przypadkowe usuwanie lub uszkodzenie danych.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-127">*Accidental data deletion or corruption.*</span></span> <span data-ttu-id="5c2a5-128">Utwórz kopię zapasową danych, aby można ją było przywrócić w przypadku usunięcia lub uszkodzenia.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-128">Back up data so it can be restored if there’s any deletion or corruption.</span></span> <span data-ttu-id="5c2a5-129">Na przykład użyj Azure Backup, aby okresowo tworzyć kopie zapasowe maszyn wirtualnych platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-129">For example, use Azure Backup to periodically back up your Azure VMs.</span></span>

## <a name="design-with-redundancy"></a><span data-ttu-id="5c2a5-130">Projektowanie z nadmiarowością</span><span class="sxs-lookup"><span data-stu-id="5c2a5-130">Design with redundancy</span></span>

<span data-ttu-id="5c2a5-131">Awarie różnią się w zakresie wpływu.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-131">Failures vary in scope of impact.</span></span> <span data-ttu-id="5c2a5-132">Awaria sprzętowa, taka jak uszkodzony dysk, może mieć wpływ na pojedynczy węzeł w klastrze.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-132">A hardware failure, such as a failed disk, can affect a single node in a cluster.</span></span> <span data-ttu-id="5c2a5-133">Uszkodzony przełącznik sieciowy może mieć wpływ na cały stojak serwera.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-133">A failed network switch could affect an entire server rack.</span></span> <span data-ttu-id="5c2a5-134">Mniej typowe błędy, takie jak utrata mocy, mogą zakłócać całe centrum danych.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-134">Less common failures, such as loss of power, could disrupt a whole datacenter.</span></span> <span data-ttu-id="5c2a5-135">Rzadko, cały region jest niedostępny.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-135">Rarely, an entire region becomes unavailable.</span></span>

<span data-ttu-id="5c2a5-136">[Nadmiarowość](https://docs.microsoft.com/azure/architecture/guide/design-principles/redundancy) jest jednym ze sposobów zapewnienia odporności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-136">[Redundancy](https://docs.microsoft.com/azure/architecture/guide/design-principles/redundancy) is one way to provide application resilience.</span></span> <span data-ttu-id="5c2a5-137">Dokładny poziom nadmiarowości zależy od wymagań firmy i wpłynie na koszt i złożoność systemu.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-137">The exact level of redundancy needed depends upon your business requirements and will affect both the cost and complexity of your system.</span></span> <span data-ttu-id="5c2a5-138">Na przykład wdrożenie w wielu regionach jest droższe i bardziej skomplikowane niż w przypadku wdrożenia w jednym regionie.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-138">For example, a multi-region deployment is more expensive and more complex to manage than a single-region deployment.</span></span> <span data-ttu-id="5c2a5-139">Aby zarządzać trybem failover i powrotu po awarii, musisz wykonać procedury operacyjne.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-139">You'll need operational procedures to manage failover and failback.</span></span> <span data-ttu-id="5c2a5-140">Dodatkowy koszt i złożoność mogą być usprawiedliwione w niektórych scenariuszach firmy, ale nie w innych.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-140">The additional cost and complexity might be justified for some business scenarios, but not others.</span></span>

<span data-ttu-id="5c2a5-141">Aby zapewnić nadmiarowość, należy zidentyfikować ścieżki krytyczne w aplikacji, a następnie określić, czy istnieje nadmiarowość w każdym punkcie ścieżki?</span><span class="sxs-lookup"><span data-stu-id="5c2a5-141">To architect redundancy, you need to identify the critical paths in your application, and then determine if there's redundancy at each point in the path?</span></span> <span data-ttu-id="5c2a5-142">Jeśli podsystem nie powinien działać, aplikacja przejdzie w tryb failover na coś innego?</span><span class="sxs-lookup"><span data-stu-id="5c2a5-142">If a subsystem should fail, will the application fail over to something else?</span></span> <span data-ttu-id="5c2a5-143">Na koniec należy jasno zrozumieć te funkcje, które są wbudowane w platformę chmury platformy Azure, z których można korzystać w celu spełnienia wymagań dotyczących nadmiarowości.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-143">Finally, you need a clear understanding of those features built into the Azure cloud platform that you can leverage to meet your redundancy requirements.</span></span> <span data-ttu-id="5c2a5-144">Poniżej przedstawiono zalecenia dotyczące tworzenia nadmiarowości:</span><span class="sxs-lookup"><span data-stu-id="5c2a5-144">Here are recommendations for architecting redundancy:</span></span>

- <span data-ttu-id="5c2a5-145">*Wdróż wiele wystąpień usług.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-145">*Deploy multiple instances of services.*</span></span> <span data-ttu-id="5c2a5-146">Jeśli aplikacja zależy od pojedynczego wystąpienia usługi, tworzy single point of failure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-146">If your application depends on a single instance of a service, it creates a single point of failure.</span></span> <span data-ttu-id="5c2a5-147">Obsługa wielu wystąpień pozwala zwiększyć odporność i skalowalność.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-147">Provisioning multiple instances improves both resiliency and scalability.</span></span> <span data-ttu-id="5c2a5-148">W przypadku hostowania w usłudze Azure Kubernetes można deklaratywnie skonfigurować nadmiarowe wystąpienia (zestawy replik) w pliku manifestu Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-148">When hosting in Azure Kubernetes Service, you can declaratively configure redundant instances (replica sets) in the Kubernetes manifest file.</span></span> <span data-ttu-id="5c2a5-149">Wartością liczby replik można zarządzać programowo, w portalu lub funkcją skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-149">The replica count value can be managed programmatically, in the portal, or through autoscaling features.</span></span>

- <span data-ttu-id="5c2a5-150">*Korzystanie z modułu równoważenia obciążenia.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-150">*Leveraging a load balancer.*</span></span> <span data-ttu-id="5c2a5-151">Równoważenie obciążenia dystrybuuje żądania aplikacji do wystąpień usługi w dobrej kondycji i automatycznie usuwa wystąpienia w złej kondycji z obrotu.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-151">Load-balancing distributes your application's requests to healthy service instances and automatically removes unhealthy instances from rotation.</span></span> <span data-ttu-id="5c2a5-152">W przypadku wdrażania w usłudze Kubernetes Równoważenie obciążenia można określić w pliku manifestu Kubernetes w sekcji usługi.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-152">When deploying to Kubernetes, load balancing can be specified in the Kubernetes manifest file in the Services section.</span></span>

- <span data-ttu-id="5c2a5-153">*Planowanie wdrożenia wieloregionowego.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-153">*Plan for multiregion deployment.*</span></span> <span data-ttu-id="5c2a5-154">Jeśli aplikacja zostanie wdrożona w jednym regionie, a ten region staje się niedostępny, aplikacja również stanie się niedostępna.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-154">If you deploy your application to a single region, and that region becomes unavailable, your application will also become unavailable.</span></span> <span data-ttu-id="5c2a5-155">Może to być nieakceptowalne w warunkach umowy dotyczącej poziomu usług aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-155">This may be unacceptable under the terms of your application's service level agreements.</span></span> <span data-ttu-id="5c2a5-156">Zamiast tego warto rozważyć wdrożenie aplikacji i jej usług w wielu regionach.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-156">Instead, consider deploying your application and its services across multiple regions.</span></span> <span data-ttu-id="5c2a5-157">Na przykład klaster usługi Azure Kubernetes Service (AKS) jest wdrażany w jednym regionie.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-157">For example, an Azure Kubernetes Service (AKS) cluster is deployed to a single region.</span></span> <span data-ttu-id="5c2a5-158">Aby chronić system przed awarią regionalną, można wdrożyć aplikację w wielu klastrach AKS w różnych regionach i użyć funkcji [par regionów](https://buildazure.com/2017/01/06/azure-region-pairs-explained/) do koordynowania aktualizacji platformy i określania priorytetów działań związanych z odzyskiwaniem.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-158">To protect your system from a regional failure, you might deploy your application to multiple AKS clusters across different regions and use the [Paired Regions](https://buildazure.com/2017/01/06/azure-region-pairs-explained/) feature to coordinate platform updates and prioritize recovery efforts.</span></span>

- <span data-ttu-id="5c2a5-159">*Włącz [replikację geograficzną](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication).*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-159">*Enable [geo-replication](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication).*</span></span> <span data-ttu-id="5c2a5-160">Replikacja geograficzna dla usług, takich jak Azure SQL Database i Cosmos DB, spowoduje utworzenie replik pomocniczych danych w wielu regionach.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-160">Geo-replication for services such as Azure SQL Database and Cosmos DB will create secondary replicas of your data across multiple regions.</span></span> <span data-ttu-id="5c2a5-161">Podczas gdy obie usługi będą automatycznie replikować dane w tym samym regionie, replikacja geograficzna chroni przed awarią regionalną, umożliwiając przechodzenie w tryb failover do regionu pomocniczego.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-161">While both services will automatically replicate data within the same region, geo-replication protects you against a regional outage by enabling you to fail over to a secondary region.</span></span> <span data-ttu-id="5c2a5-162">Innym najlepszym rozwiązaniem dla centrów replikacji geograficznej wokół przechowywania obrazów kontenerów.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-162">Another best practice for geo-replication centers around storing container images.</span></span> <span data-ttu-id="5c2a5-163">Aby wdrożyć usługę w programie AKS, należy przechowywać i ściągać obraz z repozytorium.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-163">To deploy a service in AKS, you need to store and pull the image from a repository.</span></span> <span data-ttu-id="5c2a5-164">Azure Container Registry integruje się z usługą AKS i umożliwia bezpieczne przechowywanie obrazów kontenerów.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-164">Azure Container Registry integrates with AKS and can securely store container images.</span></span> <span data-ttu-id="5c2a5-165">Aby zwiększyć wydajność i dostępność, należy rozważyć replikację geograficzną obrazów do rejestru w każdym regionie, w którym znajduje się klaster AKS.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-165">To improve performance and availability, consider geo-replicating your images to a registry in each region where you have an AKS cluster.</span></span> <span data-ttu-id="5c2a5-166">Każdy klaster AKS następnie ściąga obrazy kontenerów z rejestru kontenerów lokalnych w jego regionie, jak pokazano na rysunku 6-4:</span><span class="sxs-lookup"><span data-stu-id="5c2a5-166">Each AKS cluster then pulls container images from the local container registry in its region as shown in Figure 6-4:</span></span>

![Zreplikowane zasoby w różnych regionach](./media/replicated-resources.png)

<span data-ttu-id="5c2a5-168">**Rysunek 6-4**.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-168">**Figure 6-4**.</span></span> <span data-ttu-id="5c2a5-169">Zreplikowane zasoby w różnych regionach</span><span class="sxs-lookup"><span data-stu-id="5c2a5-169">Replicated resources across regions</span></span>

- <span data-ttu-id="5c2a5-170">*Zaimplementuj moduł równoważenia obciążenia ruchem DNS.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-170">*Implement a DNS traffic load balancer.*</span></span> <span data-ttu-id="5c2a5-171">Usługa [Azure Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview) zapewnia wysoką dostępność aplikacji o krytycznym znaczeniu przez równoważenie obciążenia na poziomie systemu DNS.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-171">[Azure Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview) provides high-availability for critical applications by load-balancing at the DNS level.</span></span> <span data-ttu-id="5c2a5-172">Może kierować ruch do różnych regionów na podstawie lokalizacji geograficznej, czasu odpowiedzi klastra, a nawet kondycji punktu końcowego aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-172">It can route traffic to different regions based on geography, cluster response time, and even application endpoint health.</span></span> <span data-ttu-id="5c2a5-173">Na przykład usługa Azure Traffic Manager może kierować klientów do najbliższego klastra AKS i wystąpienia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-173">For example, Azure Traffic Manager can direct customers to the closest AKS cluster and application instance.</span></span> <span data-ttu-id="5c2a5-174">Jeśli masz wiele klastrów AKS w różnych regionach, użyj Traffic Manager, aby kontrolować sposób przepływu ruchu do aplikacji uruchamianych w każdym klastrze.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-174">If you have multiple AKS clusters in different regions, use Traffic Manager to control how traffic flows to the applications that run in each cluster.</span></span> <span data-ttu-id="5c2a5-175">Na rysunku 6-5 przedstawiono ten scenariusz.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-175">Figure 6-5 shows this scenario.</span></span>

![AKS i Traffic Manager platformy Azure](./media/aks-traffic-manager.png)

<span data-ttu-id="5c2a5-177">**Rysunek 6-5**.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-177">**Figure 6-5**.</span></span> <span data-ttu-id="5c2a5-178">AKS i Traffic Manager platformy Azure</span><span class="sxs-lookup"><span data-stu-id="5c2a5-178">AKS and Azure Traffic Manager</span></span>

## <a name="design-for-scalability"></a><span data-ttu-id="5c2a5-179">Projektowanie pod kątem skalowalności</span><span class="sxs-lookup"><span data-stu-id="5c2a5-179">Design for scalability</span></span>

<span data-ttu-id="5c2a5-180">Chmura jest w trakcie skalowania.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-180">The cloud thrives on scaling.</span></span> <span data-ttu-id="5c2a5-181">Możliwość zwiększenia/zmniejszenia zasobów systemowych w celu zwiększenia/zmniejszenia obciążenia systemu jest kluczem cechą w chmurze platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-181">The ability to increase/decrease system resources to address increasing/decreasing system load is a key tenet of the Azure cloud.</span></span> <span data-ttu-id="5c2a5-182">Aby efektywnie skalować aplikację, musisz zrozumieć funkcje skalowania każdej usługi platformy Azure, która jest dołączana do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-182">But, to effectively scale an application, you need an understanding of the scaling features of each Azure service that you include in your application.</span></span>  <span data-ttu-id="5c2a5-183">Poniżej przedstawiono zalecenia dotyczące efektywnego implementowania skalowania w systemie.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-183">Here are recommendations for effectively implementing scaling in your system.</span></span>

- <span data-ttu-id="5c2a5-184">*Projektuj do skalowania.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-184">*Design for scaling.*</span></span> <span data-ttu-id="5c2a5-185">Aplikacja musi być przeznaczona do skalowania.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-185">An application must be designed for scaling.</span></span> <span data-ttu-id="5c2a5-186">Aby rozpocząć, usługi powinny być bezstanowe, aby żądania mogły być kierowane do dowolnego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-186">To start, services should be stateless so that requests can be routed to any instance.</span></span> <span data-ttu-id="5c2a5-187">Usługa bezstanowa oznacza również, że dodanie lub usunięcie wystąpienia nie ma negatywnego wpływu na bieżących użytkowników.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-187">Having stateless services also means that adding or removing an instance doesn't adversely impact current users.</span></span>

- <span data-ttu-id="5c2a5-188">*Dzielenie obciążeń*.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-188">*Partition workloads*.</span></span> <span data-ttu-id="5c2a5-189">Tworzenie domen w niezależnych, samodzielnych mikrousługach umożliwia skalowanie niezależnie od innych usług.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-189">Decomposing domains into independent, self-contained microservices enable each service to scale independently of others.</span></span> <span data-ttu-id="5c2a5-190">Zazwyczaj usługi będą mieć różne potrzeby i wymagania dotyczące skalowalności.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-190">Typically, services will have different scalability needs and requirements.</span></span> <span data-ttu-id="5c2a5-191">Partycjonowanie umożliwia skalowanie tylko tego, co musi być skalowane bez niepotrzebnego kosztu skalowania całej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-191">Partitioning enables you to scale only what needs to be scaled without the unnecessary cost of scaling an entire application.</span></span>

- <span data-ttu-id="5c2a5-192">*Preferuj skalowanie w poziomie.* Aplikacje oparte na chmurze preferują skalowanie zasobów w przeciwieństwie do skalowania w górę.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-192">*Favor scale-out.* Cloud-based applications favor scaling out resources as opposed to scaling up.</span></span> <span data-ttu-id="5c2a5-193">Skalowanie w poziomie (nazywane również skalowaniem poziomym) obejmuje dodanie więcej zasobów usługi do istniejącego systemu w celu spełnienia i udostępnienia żądanego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-193">Scaling out (also known as horizontal scaling) involves adding more service resources to an existing system to meet and share a desired level of performance.</span></span> <span data-ttu-id="5c2a5-194">Skalowanie w górę (znane także jako skalowanie w pionie) obejmuje zastępowanie istniejących zasobów bardziej wydajnym sprzętem (więcej rdzeni dysku, pamięci i przetwarzania).</span><span class="sxs-lookup"><span data-stu-id="5c2a5-194">Scaling up (also known as vertical scaling) involves replacing existing resources with more powerful hardware (more disk, memory, and processing cores).</span></span> <span data-ttu-id="5c2a5-195">Skalowanie w górę może być wywoływane automatycznie przy użyciu funkcji skalowania automatycznego dostępnych w niektórych zasobach w chmurze platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-195">Scaling out can be invoked automatically with the autoscaling features available in some Azure cloud resources.</span></span> <span data-ttu-id="5c2a5-196">Skalowanie w poziomie wielu zasobów powoduje również dodanie nadmiarowości do całego systemu.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-196">Scaling out across multiple resources also adds redundancy to the overall system.</span></span> <span data-ttu-id="5c2a5-197">Na koniec skalowanie pojedynczego zasobu jest zwykle droższe niż skalowanie w poziomie wielu mniejszych zasobów.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-197">Finally scaling up a single resource is typically more expensive than scaling out across many smaller resources.</span></span> <span data-ttu-id="5c2a5-198">Rysunek 6-6 przedstawia dwa podejścia:</span><span class="sxs-lookup"><span data-stu-id="5c2a5-198">Figure 6-6 shows the two approaches:</span></span>

![Skalowanie w górę i skalowanie w poziomie](./media/scale-up-scale-out.png)

<span data-ttu-id="5c2a5-200">**Rysunek 6-6.**</span><span class="sxs-lookup"><span data-stu-id="5c2a5-200">**Figure 6-6.**</span></span> <span data-ttu-id="5c2a5-201">Skalowanie w górę i skalowanie w poziomie</span><span class="sxs-lookup"><span data-stu-id="5c2a5-201">Scale up versus scale out</span></span>

- <span data-ttu-id="5c2a5-202">*Skaluj proporcjonalnie.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-202">*Scale proportionally.*</span></span> <span data-ttu-id="5c2a5-203">W przypadku skalowania usługi należy wziąć pod uwagę *zestawy zasobów*.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-203">When scaling a service, think in terms of *resource sets*.</span></span> <span data-ttu-id="5c2a5-204">Jeśli chcesz znacząco skalować określoną usługę, jaki ma wpływ na magazyny danych zaplecza, pamięci podręczne i usługi zależne?</span><span class="sxs-lookup"><span data-stu-id="5c2a5-204">If you were to dramatically scale out a specific service, what impact would that have on back-end data stores, caches and dependent services?</span></span> <span data-ttu-id="5c2a5-205">Niektóre zasoby, takie jak Cosmos DB mogą być skalowane proporcjonalnie, a wiele innych nie.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-205">Some resources such as Cosmos DB can scale out proportionally, while many others can't.</span></span> <span data-ttu-id="5c2a5-206">Chcesz się upewnić, że nie skalujesz zasobu do punktu, w którym będzie on wyczerpać inne skojarzone zasoby.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-206">You want to ensure that you don't scale out a resource to a point where it will exhaust other associated resources.</span></span>

- <span data-ttu-id="5c2a5-207">*Należy unikać koligacji.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-207">*Avoid affinity.*</span></span> <span data-ttu-id="5c2a5-208">Najlepszym rozwiązaniem jest upewnienie się, że węzeł nie wymaga lokalnej koligacji, często nazywanej *sesją programu Sticky Notes*.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-208">A best practice is to ensure a node doesn't require local affinity, often referred to as a *sticky session*.</span></span> <span data-ttu-id="5c2a5-209">Żądanie powinno być możliwe do skierowania do dowolnego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-209">A request should be able to route to any instance.</span></span> <span data-ttu-id="5c2a5-210">Jeśli zachodzi potrzeba utrwalenia stanu, powinien on zostać zapisany w rozproszonej pamięci podręcznej, na przykład w [pamięci podręcznej usługi Azure Redis](https://azure.microsoft.com/services/cache/).</span><span class="sxs-lookup"><span data-stu-id="5c2a5-210">If you need to persist state, it should be saved to a distributed cache, such as [Azure Redis cache](https://azure.microsoft.com/services/cache/).</span></span>

- <span data-ttu-id="5c2a5-211">*Skorzystaj z funkcji skalowania automatycznego platformy.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-211">*Take advantage of platform autoscaling features.*</span></span> <span data-ttu-id="5c2a5-212">Korzystaj z wbudowanych funkcji skalowania automatycznego, jeśli jest to możliwe, a nie mechanizmów niestandardowych lub innych firm.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-212">Use built-in autoscaling features whenever possible, rather than custom or third-party mechanisms.</span></span> <span data-ttu-id="5c2a5-213">Jeśli to możliwe, Użyj reguł skalowania zaplanowanego, aby upewnić się, że zasoby są dostępne bez opóźnień uruchamiania, ale Dodaj aktywne Skalowanie automatyczne do odpowiednich reguł, aby sprostać nieoczekiwanym zmianom popytu.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-213">Where possible, use scheduled scaling rules to ensure that resources are available without a startup delay, but add reactive autoscaling to the rules as appropriate, to cope with unexpected changes in demand.</span></span> <span data-ttu-id="5c2a5-214">Aby uzyskać więcej informacji, zobacz [wskazówki dotyczące skalowania](https://docs.microsoft.com/azure/architecture/best-practices/auto-scaling)automatycznego.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-214">For more information, see [Autoscaling guidance](https://docs.microsoft.com/azure/architecture/best-practices/auto-scaling).</span></span>

- <span data-ttu-id="5c2a5-215">*Agresywne skalowanie w poziomie.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-215">*Scale out aggressively.*</span></span> <span data-ttu-id="5c2a5-216">Ostatecznym celem jest agresywne skalowanie w poziomie, dzięki czemu można szybko zaspokoić natychmiastowe wzrosty ruchu bez utraty firmy.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-216">A final practice would be to scale out aggressively so that you can quickly meet immediate spikes in traffic without losing business.</span></span> <span data-ttu-id="5c2a5-217">A następnie Skaluj w dół (czyli usunąć niepotrzebne wystąpienia), aby zachować stabilność systemu.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-217">And, then scale in (that is, remove unneeded instances) conservatively to keep the system stable.</span></span> <span data-ttu-id="5c2a5-218">Prostym sposobem wdrożenia tego ustawienia jest ustawienie okresu dla chłodzenia, czyli czasu oczekiwania między operacjami skalowania, do pięciu minut w przypadku dodawania zasobów oraz do 15 minut na usuwanie wystąpień.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-218">A simple way to implement this is to set the cool down period, which is the time to wait between scaling operations, to five minutes for adding resources and up to 15 minutes for removing instances.</span></span>

## <a name="built-in-retry-in-services"></a><span data-ttu-id="5c2a5-219">Wbudowane ponawianie próby w usługach</span><span class="sxs-lookup"><span data-stu-id="5c2a5-219">Built-in retry in services</span></span>

<span data-ttu-id="5c2a5-220">Zachęcamy do stosowania najlepszych rozwiązań dotyczących implementowania operacji ponownych prób w poprzedniej sekcji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-220">We encouraged the best practice of implementing programmatic retry operations in an earlier section.</span></span> <span data-ttu-id="5c2a5-221">Należy pamiętać, że wiele usług platformy Azure i odpowiadających im zestawów SDK klienta obejmuje również mechanizm ponawiania prób.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-221">Keep in mind that many Azure services and their corresponding client SDKs also include retry mechanisms.</span></span> <span data-ttu-id="5c2a5-222">Poniższa lista zawiera podsumowanie funkcji ponawiania prób w wielu usługach platformy Azure omówionych w tej książce:</span><span class="sxs-lookup"><span data-stu-id="5c2a5-222">The following list summarizes retry features in the many of the Azure services that are discussed in this book:</span></span>

- <span data-ttu-id="5c2a5-223">*Azure Cosmos DB.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-223">*Azure Cosmos DB.*</span></span> <span data-ttu-id="5c2a5-224"><xref:Microsoft.Azure.Documents.Client.DocumentClient>Klasa z interfejsu API klienta automatycznie ponawia nieudane próby.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-224">The <xref:Microsoft.Azure.Documents.Client.DocumentClient> class from the client API automatically retires failed attempts.</span></span> <span data-ttu-id="5c2a5-225">Liczba ponownych prób i maksymalny czas oczekiwania można skonfigurować.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-225">The number of retries and maximum wait time are configurable.</span></span> <span data-ttu-id="5c2a5-226">Wyjątki zgłoszone przez interfejs API klienta to żądania, które przekraczają zasady ponawiania lub błędy nieprzejściowe.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-226">Exceptions thrown by the client API are either requests that exceed the retry policy or non-transient errors.</span></span>

- <span data-ttu-id="5c2a5-227">*Azure Redis Cache.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-227">*Azure Redis Cache.*</span></span> <span data-ttu-id="5c2a5-228">Klient programu Redis StackExchange używa klasy Menedżera połączeń, która obejmuje ponawianie prób przy nieudanych próbach.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-228">The Redis StackExchange client uses a connection manager class that includes retries on failed attempts.</span></span> <span data-ttu-id="5c2a5-229">Można skonfigurować liczbę ponownych prób, konkretne zasady ponawiania i czas oczekiwania.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-229">The number of retries, specific retry policy and wait time are all configurable.</span></span>

- <span data-ttu-id="5c2a5-230">*Azure Service Bus.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-230">*Azure Service Bus.*</span></span> <span data-ttu-id="5c2a5-231">Klient Service Bus uwidacznia [klasę RetryPolicy](xref:Microsoft.ServiceBus.RetryPolicy) , która może być skonfigurowana z interwałem wycofywania, liczbą ponownych prób i <xref:Microsoft.ServiceBus.RetryExponential.TerminationTimeBuffer%2A> , która określa maksymalny czas trwania operacji.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-231">The Service Bus client exposes a [RetryPolicy class](xref:Microsoft.ServiceBus.RetryPolicy) that can be configured with a back-off interval, retry count, and <xref:Microsoft.ServiceBus.RetryExponential.TerminationTimeBuffer%2A>, which specifies the maximum time an operation can take.</span></span> <span data-ttu-id="5c2a5-232">Domyślną zasadą jest dziewięć Maksymalna liczba ponownych prób z 30-sekundowym okresem wycofywania między kolejnymi próbami.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-232">The default policy is nine maximum retry attempts with a 30-second backoff period between attempts.</span></span>

- <span data-ttu-id="5c2a5-233">*Azure SQL Database.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-233">*Azure SQL Database.*</span></span> <span data-ttu-id="5c2a5-234">W przypadku korzystania z biblioteki [Entity Framework Core](https://docs.microsoft.com/ef/core/miscellaneous/connection-resiliency) podano ponowną pomoc techniczną.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-234">Retry support is provided when using the [Entity Framework Core](https://docs.microsoft.com/ef/core/miscellaneous/connection-resiliency) library.</span></span>

- <span data-ttu-id="5c2a5-235">*Usługa Azure Storage.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-235">*Azure Storage.*</span></span> <span data-ttu-id="5c2a5-236">Biblioteka klienta magazynu obsługuje operacje ponawiania.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-236">The storage client library support retry operations.</span></span> <span data-ttu-id="5c2a5-237">Strategie różnią się w zależności od tabel, obiektów blob i kolejek usługi Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-237">The strategies vary across Azure storage tables, blobs, and queues.</span></span> <span data-ttu-id="5c2a5-238">Ponadto alternatywna ponowna próba jest przełączana między lokacjami podstawowej i pomocniczej usługi magazynu po włączeniu funkcji nadmiarowości geograficznej.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-238">As well, alternate retries switch between primary and secondary storage services locations when the geo-redundancy feature is enabled.</span></span>

- <span data-ttu-id="5c2a5-239">*Event Hubs platformy Azure.*</span><span class="sxs-lookup"><span data-stu-id="5c2a5-239">*Azure Event Hubs.*</span></span> <span data-ttu-id="5c2a5-240">Biblioteka klienta centrum zdarzeń oferuje Właściwość RetryPolicy, która obejmuje konfigurowalną funkcję wykładniczą wycofywania.</span><span class="sxs-lookup"><span data-stu-id="5c2a5-240">The Event Hub client library features a RetryPolicy property, which includes a configurable exponential backoff feature.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="5c2a5-241">[Poprzedni](application-resiliency-patterns.md) 
> [Dalej](resilient-communications.md)</span><span class="sxs-lookup"><span data-stu-id="5c2a5-241">[Previous](application-resiliency-patterns.md)
[Next](resilient-communications.md)</span></span>
