---
title: Usługi przesyłania strumieniowego a powtarzalne pola — gRPC dla deweloperów WCF
description: Porównaj powtarzane pola z usługami przesyłania strumieniowego jako metody przekazywania kolekcji danych przy użyciu gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 0e717df57ba2bb52d63a063072d8a45bf0f7e395
ms.sourcegitcommit: f38e527623883b92010cf4760246203073e12898
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 02/20/2020
ms.locfileid: "77503373"
---
# <a name="grpc-streaming-services-vs-repeated-fields"></a><span data-ttu-id="f6b38-103">gRPC Streaming Services a powtórzone pola</span><span class="sxs-lookup"><span data-stu-id="f6b38-103">gRPC streaming services vs. repeated fields</span></span>

<span data-ttu-id="f6b38-104">usługi gRPC zapewniają dwa sposoby zwracania zestawów danych lub listy obiektów.</span><span class="sxs-lookup"><span data-stu-id="f6b38-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="f6b38-105">Specyfikacja komunikatów buforów protokołu używa słowa kluczowego `repeated` do deklarowania list lub tablic komunikatów w innym komunikacie.</span><span class="sxs-lookup"><span data-stu-id="f6b38-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="f6b38-106">Specyfikacja usługi gRPC używa słowa kluczowego `stream`, aby zadeklarować długotrwałe połączenie trwałe.</span><span class="sxs-lookup"><span data-stu-id="f6b38-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection.</span></span> <span data-ttu-id="f6b38-107">Za pośrednictwem tego połączenia są wysyłane wiele komunikatów i mogą być przetwarzane pojedynczo.</span><span class="sxs-lookup"><span data-stu-id="f6b38-107">Over that connection, multiple messages are sent, and can be processed, individually.</span></span> 

<span data-ttu-id="f6b38-108">Można również użyć funkcji `stream` w przypadku długotrwałych danych czasowych, takich jak powiadomienia lub komunikaty dziennika.</span><span class="sxs-lookup"><span data-stu-id="f6b38-108">You can also use the `stream` feature for long-running temporal data such as notifications or log messages.</span></span> <span data-ttu-id="f6b38-109">Jednak ten rozdział rozważy jego użycie do zwrócenia jednego zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="f6b38-109">But this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="f6b38-110">Którego należy użyć, zależy od następujących czynników:</span><span class="sxs-lookup"><span data-stu-id="f6b38-110">Which you should use depends on factors such as:</span></span>

- <span data-ttu-id="f6b38-111">Całkowity rozmiar zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="f6b38-111">The overall size of the dataset.</span></span>
- <span data-ttu-id="f6b38-112">Czas, jaki zajęło utworzenie zestawu danych na końcu klienta lub serwera.</span><span class="sxs-lookup"><span data-stu-id="f6b38-112">The time it took to create the dataset at either the client or server end.</span></span>
- <span data-ttu-id="f6b38-113">Czy konsument zestawu danych może rozpocząć od razu, jak tylko pierwszy element jest dostępny, lub wymaga kompletny zestaw danych, aby zrobić coś użyteczne.</span><span class="sxs-lookup"><span data-stu-id="f6b38-113">Whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="f6b38-114">Kiedy używać `repeated` pól</span><span class="sxs-lookup"><span data-stu-id="f6b38-114">When to use `repeated` fields</span></span>

<span data-ttu-id="f6b38-115">Dla dowolnego zestawu danych, który jest ograniczony do rozmiaru i który może zostać wygenerowany w całości w krótkim czasie — powiedzmy, poniżej jednej sekundy — należy użyć pola `repeated` w zwykłym komunikacie protobuf.</span><span class="sxs-lookup"><span data-stu-id="f6b38-115">For any dataset that's constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="f6b38-116">Na przykład w systemie handlu elektronicznego, aby utworzyć listę elementów w ramach zamówienia, prawdopodobnie szybko i lista nie będzie bardzo duża.</span><span class="sxs-lookup"><span data-stu-id="f6b38-116">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="f6b38-117">Zwracanie pojedynczej wiadomości z polem `repeated` jest kolejnością większą niż użycie `stream` i powoduje mniejsze obciążenie sieci.</span><span class="sxs-lookup"><span data-stu-id="f6b38-117">Returning a single message with a `repeated` field is an order of magnitude faster than using `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="f6b38-118">Jeśli klient potrzebuje wszystkich danych przed rozpoczęciem przetwarzania, a zestaw danych jest wystarczająco mały, aby utworzyć w pamięci, należy rozważyć użycie pola `repeated`.</span><span class="sxs-lookup"><span data-stu-id="f6b38-118">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field.</span></span> <span data-ttu-id="f6b38-119">Należy wziąć pod uwagę, nawet jeśli Tworzenie zestawu danych w pamięci na serwerze jest wolniejsze.</span><span class="sxs-lookup"><span data-stu-id="f6b38-119">Consider it even if the creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="f6b38-120">Kiedy należy używać metod `stream`</span><span class="sxs-lookup"><span data-stu-id="f6b38-120">When to use `stream` methods</span></span>

<span data-ttu-id="f6b38-121">Gdy obiekty komunikatów w zestawach danych są potencjalnie bardzo duże, najlepszym rozwiązaniem jest przeniesienie ich przy użyciu żądań lub odpowiedzi przesyłania strumieniowego.</span><span class="sxs-lookup"><span data-stu-id="f6b38-121">When the message objects in your datasets are potentially very large, it's best for you transfer them by using streaming requests or responses.</span></span> <span data-ttu-id="f6b38-122">Bardziej wydajne jest konstruowanie dużego obiektu w pamięci, zapisanie go w sieci, a następnie zwolnienie zasobów.</span><span class="sxs-lookup"><span data-stu-id="f6b38-122">It's more efficient to construct a large object in memory, write it to the network, and then free up the resources.</span></span> <span data-ttu-id="f6b38-123">Takie podejście poprawi skalowalność usługi.</span><span class="sxs-lookup"><span data-stu-id="f6b38-123">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="f6b38-124">Podobnie należy wysyłać zestawy danych o nieograniczonej wielkości nad strumieniami, aby uniknąć wyczerpania pamięci podczas konstruowania ich.</span><span class="sxs-lookup"><span data-stu-id="f6b38-124">Similarly, you should send datasets of unconstrained size over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="f6b38-125">W przypadku zestawów danych, w których konsument może osobno przetwarzać każdy element, należy rozważyć użycie strumienia, jeśli oznacza to, że ten postęp może zostać wskazany użytkownikowi.</span><span class="sxs-lookup"><span data-stu-id="f6b38-125">For datasets where the consumer can separately process each item, you should consider using a stream if it means that progress can be indicated to the user.</span></span> <span data-ttu-id="f6b38-126">Użycie strumienia może zwiększyć czas odpowiedzi aplikacji, ale należy zrównoważyć ją względem ogólnej wydajności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f6b38-126">Using a stream can improve the responsiveness of an application, but you should balance it against the overall performance of the application.</span></span>

<span data-ttu-id="f6b38-127">Innym scenariuszem, w którym strumienie mogą być przydatne, jest to, że komunikat jest przetwarzany przez wiele usług.</span><span class="sxs-lookup"><span data-stu-id="f6b38-127">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="f6b38-128">Jeśli każda usługa w łańcuchu zwraca strumień, usługa terminala (czyli Ostatnia z nich w łańcuchu) może rozpocząć Zwracanie komunikatów.</span><span class="sxs-lookup"><span data-stu-id="f6b38-128">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages.</span></span> <span data-ttu-id="f6b38-129">Te komunikaty mogą być przetwarzane i przesyłane z powrotem do pierwotnego obiektu żądającego.</span><span class="sxs-lookup"><span data-stu-id="f6b38-129">These messages can be processed and passed back along the chain to the original requestor.</span></span> <span data-ttu-id="f6b38-130">Obiekt żądający może zwrócić strumień lub agregować wyniki w pojedynczym komunikacie odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="f6b38-130">The requestor can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="f6b38-131">Takie podejście pozwala sobie dobrze na wzorce, takie jak MapReduce.</span><span class="sxs-lookup"><span data-stu-id="f6b38-131">This approach lends itself well to patterns like MapReduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="f6b38-132">[Poprzednie](migrate-duplex-services.md)
>[dalej](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="f6b38-132">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
