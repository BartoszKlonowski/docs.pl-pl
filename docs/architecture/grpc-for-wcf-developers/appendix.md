---
title: Dodatek-gRPC dla deweloperów WCF
description: Omówienie transakcji rozproszonych i ich implementacji w nowoczesnych architekturach mikrousług.
ms.date: 09/02/2019
ms.openlocfilehash: f60899463a13e9f740f6ae63150d18eab3069124
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/24/2020
ms.locfileid: "91165861"
---
# <a name="appendix-a---transactions"></a><span data-ttu-id="62582-103">Dodatek A — transakcje</span><span class="sxs-lookup"><span data-stu-id="62582-103">Appendix A - Transactions</span></span>

<span data-ttu-id="62582-104">Windows Communication Foundation (WCF) obsługuje transakcje rozproszone, umożliwiając wykonywanie operacji niepodzielnych w wielu usługach.</span><span class="sxs-lookup"><span data-stu-id="62582-104">Windows Communication Foundation (WCF) supports distributed transactions, allowing you to perform atomic operations across multiple services.</span></span> <span data-ttu-id="62582-105">Ta funkcja jest oparta na [Distributed Transaction Coordinator firmy Microsoft](/previous-versions/windows/desktop/ms684146(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="62582-105">This functionality is based on the [Microsoft Distributed Transaction Coordinator](/previous-versions/windows/desktop/ms684146(v=vs.85)).</span></span>

<span data-ttu-id="62582-106">W przypadku nowszych mikrousług na poziomie, ten typ zautomatyzowanego przetwarzania transakcji rozproszonych nie jest możliwy.</span><span class="sxs-lookup"><span data-stu-id="62582-106">In the newer microservices landscape, this type of automated distributed transaction processing isn't possible.</span></span> <span data-ttu-id="62582-107">Istnieje zbyt wiele różnych technologii, w tym relacyjne bazy danych, NoSQLe magazyny danych i systemy obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="62582-107">There are too many different technologies involved, including relational databases, NoSQL data stores, and messaging systems.</span></span> <span data-ttu-id="62582-108">Może to być również kombinacja systemów operacyjnych, języków programowania i platform używanych w jednym środowisku.</span><span class="sxs-lookup"><span data-stu-id="62582-108">There might also be a mix of operating systems, programming languages, and frameworks in use in a single environment.</span></span>

<span data-ttu-id="62582-109">Transakcja rozproszona WCF to implementacja tego, co jest znane jako [dwufazowe zatwierdzanie (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span><span class="sxs-lookup"><span data-stu-id="62582-109">WCF distributed transaction is an implementation of what is known as a [two-phase commit (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span></span> <span data-ttu-id="62582-110">Transakcje 2PC można zaimplementować ręcznie przez koordynowanie komunikatów między usługami, tworzenie otwartych transakcji w ramach każdej usługi i wysyłanie komunikatów zatwierdzania lub wycofywania, w zależności od sukcesu lub niepowodzenia.</span><span class="sxs-lookup"><span data-stu-id="62582-110">You can implement 2PC transactions manually by coordinating messages across services, creating open transactions within each service, and sending commit or rollback messages, depending upon success or failure.</span></span> <span data-ttu-id="62582-111">Jednak stopień złożoności związany z zarządzaniem 2PC może wzrosnąć w miarę rozwoju systemów.</span><span class="sxs-lookup"><span data-stu-id="62582-111">However, the complexity involved in managing 2PC can increase exponentially as systems evolve.</span></span> <span data-ttu-id="62582-112">Otwarte transakcje przechowują blokady bazy danych, które mogą negatywnie wpłynąć na wydajność, lub gorszą, powodują zakleszczenie między usługami.</span><span class="sxs-lookup"><span data-stu-id="62582-112">Open transactions hold database locks that can negatively affect performance, or, worse, cause cross-service deadlocks.</span></span>

<span data-ttu-id="62582-113">Jeśli to możliwe, najlepiej jest unikać transakcji rozproszonych.</span><span class="sxs-lookup"><span data-stu-id="62582-113">If possible, it's best to avoid distributed transactions altogether.</span></span> <span data-ttu-id="62582-114">Jeśli dwa elementy danych są tak połączone jak w celu żądania niepodzielnych aktualizacji, należy rozważyć ich obsługę zarówno w ramach tej samej usługi.</span><span class="sxs-lookup"><span data-stu-id="62582-114">If two items of data are so linked as to require atomic updates, consider handling them both with the same service.</span></span> <span data-ttu-id="62582-115">Zastosuj te niepodzielne zmiany za pomocą pojedynczego żądania lub wiadomości do tej usługi.</span><span class="sxs-lookup"><span data-stu-id="62582-115">Apply those atomic changes by using a single request or message to that service.</span></span>

<span data-ttu-id="62582-116">Jeśli to nie jest możliwe, jedną alternatywą jest użycie [wzorca Saga](https://microservices.io/patterns/data/saga.html).</span><span class="sxs-lookup"><span data-stu-id="62582-116">If that isn't possible, then one alternative is to use the [Saga pattern](https://microservices.io/patterns/data/saga.html).</span></span> <span data-ttu-id="62582-117">W Saga aktualizacje są przetwarzane sekwencyjnie; Po pomyślnej aktualizacji każda z nich zostanie wyzwolona.</span><span class="sxs-lookup"><span data-stu-id="62582-117">In a saga, updates are processed sequentially; as each update succeeds, the next one is triggered.</span></span> <span data-ttu-id="62582-118">Te wyzwalacze mogą być propagowane z usługi do usługi lub zarządzane przez koordynatora Saga lub program Orchestrator.</span><span class="sxs-lookup"><span data-stu-id="62582-118">These triggers can be propagated from service to service, or managed by a saga coordinator or orchestrator.</span></span> <span data-ttu-id="62582-119">Jeśli aktualizacja nie powiedzie się w dowolnym momencie w trakcie tego procesu, usługi, które już ukończyły aktualizacje, stosują określoną logikę do odwrócenia.</span><span class="sxs-lookup"><span data-stu-id="62582-119">If an update fails at any point during the process, the services that have already completed their updates apply specific logic to reverse them.</span></span>

<span data-ttu-id="62582-120">Kolejną opcją jest użycie konstrukcji opartej na domenie (DDD) i polecenia/zapytania (CQRS), zgodnie z opisem w [książce elektronicznej mikrousług .NET](../microservices/microservice-ddd-cqrs-patterns/index.md).</span><span class="sxs-lookup"><span data-stu-id="62582-120">Another option is to use Domain Driven Design (DDD) and Command/Query Responsibility Segregation (CQRS), as described in the [.NET Microservices e-book](../microservices/microservice-ddd-cqrs-patterns/index.md).</span></span> <span data-ttu-id="62582-121">W szczególności użycie zdarzeń domeny lub [źródła zdarzeń](https://martinfowler.com/eaaDev/EventSourcing.html) może pomóc w zapewnieniu, że aktualizacje są spójne, jeśli nie zostaną zastosowane natychmiast.</span><span class="sxs-lookup"><span data-stu-id="62582-121">In particular, using domain events or [event sourcing](https://martinfowler.com/eaaDev/EventSourcing.html) can help to ensure that updates are consistently, if not immediately, applied.</span></span>

>[!div class="step-by-step"]
>[<span data-ttu-id="62582-122">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="62582-122">Previous</span></span>](application-performance-management.md)
