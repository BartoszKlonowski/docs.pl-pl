---
title: Dodatek-gRPC dla deweloperów WCF
description: Omówienie transakcji rozproszonych i ich implementacji w nowoczesnych architekturach mikrousług.
author: markrendle
ms.date: 09/02/2019
ms.openlocfilehash: 10c4e77794c5ffe1aa6d5a629ce0b6cdf92f4ada
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/23/2019
ms.locfileid: "71184618"
---
# <a name="appendix-a---transactions"></a><span data-ttu-id="2b446-103">Dodatek A — transakcje</span><span class="sxs-lookup"><span data-stu-id="2b446-103">Appendix A - Transactions</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="2b446-104">Windows Communication Foundation (WCF) obsługiwane transakcje rozproszone, umożliwiając wykonywanie operacji niepodzielnych w wielu usługach.</span><span class="sxs-lookup"><span data-stu-id="2b446-104">Windows Communication Foundation (WCF) supported distributed transactions, allowing atomic operations to be performed across multiple services.</span></span> <span data-ttu-id="2b446-105">Ta funkcja była oparta na [Distributed Transaction Coordinator firmy Microsoft](https://docs.microsoft.com/previous-versions/windows/desktop/ms684146(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2b446-105">This functionality was based on the [Microsoft Distributed Transaction Coordinator](https://docs.microsoft.com/previous-versions/windows/desktop/ms684146(v=vs.85)).</span></span>

<span data-ttu-id="2b446-106">W nowoczesnych mikrousługach, ten typ zautomatyzowanego przetwarzania transakcji rozproszonych nie jest możliwy.</span><span class="sxs-lookup"><span data-stu-id="2b446-106">In the modern microservices landscape, this type of automated distributed transaction processing isn't possible.</span></span> <span data-ttu-id="2b446-107">Istnieje zbyt wiele różnych technologii podczas odtwarzania, w tym relacyjne bazy danych, magazyny danych NoSQL oraz systemy obsługi komunikatów, nie wspominając o kombinacji systemów operacyjnych, języków programowania i struktur, które mogą być używane w jednym środowisku.</span><span class="sxs-lookup"><span data-stu-id="2b446-107">There are too many different technologies at play, including relational databases, NoSQL data stores, and messaging systems, not to mention the mix of operating systems, programming languages and frameworks that may be used in a single environment.</span></span>

<span data-ttu-id="2b446-108">Transakcja rozproszona WCF to implementacja tego, co jest znane jako [zatwierdzanie dwufazowe (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span><span class="sxs-lookup"><span data-stu-id="2b446-108">The WCF distributed transaction is an implementation of what is known as a [two-phase commit (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span></span> <span data-ttu-id="2b446-109">Możliwe jest ręczne wdrożenie transakcji 2PC przez koordynowanie komunikatów między usługami, tworzenie otwartych transakcji w ramach każdej usługi i wysyłanie komunikatów "Commit" lub "wycofywania" w zależności od sukcesu lub niepowodzenia.</span><span class="sxs-lookup"><span data-stu-id="2b446-109">It's possible to implement 2PC transactions manually by coordinating messages across services, creating open transactions within each service and sending "commit" or "rollback" messages depending upon success or failure.</span></span> <span data-ttu-id="2b446-110">Jednak złożoność związaną z zarządzaniem 2PC może wzrosnąć w miarę rozwoju systemów, a otwarte transakcje przechowują blokady bazy danych, które mogą mieć negatywny wpływ na wydajność, a gorszą, powodują zakleszczenia między usługami.</span><span class="sxs-lookup"><span data-stu-id="2b446-110">However, the complexity that is involved in managing 2PC can increase exponentially as systems evolve, and open transactions hold database locks that can negatively impact performance or, worse, cause cross-service deadlocks.</span></span>

<span data-ttu-id="2b446-111">Jeśli to możliwe, najlepiej jest unikać transakcji rozproszonych.</span><span class="sxs-lookup"><span data-stu-id="2b446-111">If possible, it's best to avoid distributed transactions altogether.</span></span> <span data-ttu-id="2b446-112">Jeśli dwa elementy danych są tak połączone jak w celu żądania niepodzielnych aktualizacji, należy rozważyć ich obsługę zarówno w ramach tej samej usługi, jak i zastosować te niepodzielne zmiany za pomocą pojedynczego żądania lub wiadomości do tej usługi.</span><span class="sxs-lookup"><span data-stu-id="2b446-112">If two items of data are so linked as to require atomic updates, consider handling them both with the same service, and applying those atomic changes using a single request or message to that service.</span></span>

<span data-ttu-id="2b446-113">Jeśli to nie jest możliwe, jedną alternatywą jest użycie [wzorca Saga](https://microservices.io/patterns/data/saga.html).</span><span class="sxs-lookup"><span data-stu-id="2b446-113">If that isn't possible, then one alternative is to use the [Saga pattern](https://microservices.io/patterns/data/saga.html).</span></span> <span data-ttu-id="2b446-114">W Saga aktualizacje są przetwarzane sekwencyjnie; ponieważ każda aktualizacja przebiegła pomyślnie, zostanie wyzwolona Następna.</span><span class="sxs-lookup"><span data-stu-id="2b446-114">In a saga, updates are processing sequentially; as each update succeeds the next one is triggered.</span></span> <span data-ttu-id="2b446-115">Te wyzwalacze mogą być propagowane z usługi do usługi lub zarządzane przez koordynatora Saga lub "Orchestrator".</span><span class="sxs-lookup"><span data-stu-id="2b446-115">These triggers can be propagated from service to service, or managed by a saga coordinator or "orchestrator".</span></span> <span data-ttu-id="2b446-116">Jeśli aktualizacja nie powiedzie się w dowolnym momencie w trakcie tego procesu, usługi, które już ukończyły aktualizacje, stosują określoną logikę do odwrócenia.</span><span class="sxs-lookup"><span data-stu-id="2b446-116">If an update fails at any point during the process, the services that have already completed their updates apply specific logic to reverse them.</span></span>

<span data-ttu-id="2b446-117">Kolejną opcją jest użycie konstrukcji opartej na domenie (DDD) i polecenia/zapytania (CQRS), zgodnie z opisem w [książce elektronicznej mikrousług .NET](https://docs.microsoft.com/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/).</span><span class="sxs-lookup"><span data-stu-id="2b446-117">Another option is to use Domain Driven Design (DDD) and Command/Query Responsibility Segregation (CQRS), as described in the [.NET Microservices e-book](https://docs.microsoft.com/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/).</span></span> <span data-ttu-id="2b446-118">W szczególności użycie zdarzeń domeny lub [źródła zdarzeń](https://martinfowler.com/eaaDev/EventSourcing.html) może pomóc w zapewnieniu, że aktualizacje&mdash;są spójne,&mdash;Jeśli nie zostaną natychmiast zastosowane.</span><span class="sxs-lookup"><span data-stu-id="2b446-118">In particular, using domain events or [event sourcing](https://martinfowler.com/eaaDev/EventSourcing.html) can help to ensure that updates are consistently&mdash;if not immediately&mdash;applied.</span></span>

>[!div class="step-by-step"]
>[<span data-ttu-id="2b446-119">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="2b446-119">Previous</span></span>](application-performance-management.md)
