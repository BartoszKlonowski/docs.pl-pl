---
title: Typowe architektury aplikacji internetowych
description: Tworzenie architektury nowoczesnych aplikacji sieci Web przy użyciu ASP.NET Core i platformy Azure | Poznaj typowe architektury aplikacji sieci Web
author: ardalis
ms.author: wiwagn
ms.date: 01/30/2019
ms.openlocfilehash: 8985434467346acc360e9a89c052803f495e87d1
ms.sourcegitcommit: 8b8dd14dde727026fd0b6ead1ec1df2e9d747a48
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/27/2019
ms.locfileid: "71332009"
---
# <a name="common-web-application-architectures"></a><span data-ttu-id="32e2c-103">Typowe architektury aplikacji internetowych</span><span class="sxs-lookup"><span data-stu-id="32e2c-103">Common web application architectures</span></span>

> <span data-ttu-id="32e2c-104">"Jeśli sądzisz, że dobra architektura jest kosztowna, wypróbuj złą architekturę".</span><span class="sxs-lookup"><span data-stu-id="32e2c-104">"If you think good architecture is expensive, try bad architecture."</span></span>  
> <span data-ttu-id="32e2c-105">_-Brian i Joseph Yoder_</span><span class="sxs-lookup"><span data-stu-id="32e2c-105">_- Brian Foote and Joseph Yoder_</span></span>

<span data-ttu-id="32e2c-106">Większość tradycyjnych aplikacji .NET jest wdrażana jako pojedyncze jednostki odpowiadające plikowi wykonywalnemu lub pojedynczej aplikacji sieci Web uruchomionej w ramach jednej domeny AppDomain usług IIS.</span><span class="sxs-lookup"><span data-stu-id="32e2c-106">Most traditional .NET applications are deployed as single units corresponding to an executable or a single web application running within a single IIS appdomain.</span></span> <span data-ttu-id="32e2c-107">Jest to najprostszy model wdrażania i jest bardzo dobrze obsługujący wiele wewnętrznych i mniejszych aplikacji publicznych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-107">This is the simplest deployment model and serves many internal and smaller public applications very well.</span></span> <span data-ttu-id="32e2c-108">Jednak nawet w przypadku tej pojedynczej jednostki wdrożenia większość aplikacji nieuproszczonych korzysta z niektórych logicznych rozbarwień na kilku warstwach.</span><span class="sxs-lookup"><span data-stu-id="32e2c-108">However, even given this single unit of deployment, most non-trivial business applications benefit from some logical separation into several layers.</span></span>

## <a name="what-is-a-monolithic-application"></a><span data-ttu-id="32e2c-109">Co to jest aplikacja monolityczna?</span><span class="sxs-lookup"><span data-stu-id="32e2c-109">What is a monolithic application?</span></span>

<span data-ttu-id="32e2c-110">Aplikacja monolityczna to ta, która jest całkowicie niezależna, w warunkach jego działania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-110">A monolithic application is one that is entirely self-contained, in terms of its behavior.</span></span> <span data-ttu-id="32e2c-111">Może ona współdziałać z innymi usługami lub magazynami danych w trakcie wykonywania operacji, ale jego rdzeń jest uruchamiany w ramach własnego procesu, a cała aplikacja jest zwykle wdrażana jako pojedyncza jednostka.</span><span class="sxs-lookup"><span data-stu-id="32e2c-111">It may interact with other services or data stores in the course of performing its operations, but the core of its behavior runs within its own process and the entire application is typically deployed as a single unit.</span></span> <span data-ttu-id="32e2c-112">Jeśli taka aplikacja musi skalować w poziomie, zazwyczaj cała aplikacja jest duplikowana na wielu serwerach lub maszynach wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-112">If such an application needs to scale horizontally, typically the entire application is duplicated across multiple servers or virtual machines.</span></span>

## <a name="all-in-one-applications"></a><span data-ttu-id="32e2c-113">Wszystkie aplikacje w jednym miejscu</span><span class="sxs-lookup"><span data-stu-id="32e2c-113">All-in-one applications</span></span>

<span data-ttu-id="32e2c-114">Najmniejsza możliwa liczba projektów dla architektury aplikacji to jedna z nich.</span><span class="sxs-lookup"><span data-stu-id="32e2c-114">The smallest possible number of projects for an application architecture is one.</span></span> <span data-ttu-id="32e2c-115">W tej architekturze Cała logika aplikacji jest zawarta w pojedynczym projekcie, skompilowana do jednego zestawu i wdrożona jako pojedyncza jednostka.</span><span class="sxs-lookup"><span data-stu-id="32e2c-115">In this architecture, the entire logic of the application is contained in a single project, compiled to a single assembly, and deployed as a single unit.</span></span>

<span data-ttu-id="32e2c-116">Nowy projekt ASP.NET Core, niezależnie od tego, czy został utworzony w programie Visual Studio, czy z wiersza polecenia, jest uruchamiany jako proste monolitu "All-in-one".</span><span class="sxs-lookup"><span data-stu-id="32e2c-116">A new ASP.NET Core project, whether created in Visual Studio or from the command line, starts out as a simple "all-in-one" monolith.</span></span> <span data-ttu-id="32e2c-117">Zawiera wszystkie zachowania aplikacji, w tym logiki dostępu do prezentacji, biznesowego i danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-117">It contains all of the behavior of the application, including presentation, business, and data access logic.</span></span> <span data-ttu-id="32e2c-118">Rysunek 5-1 przedstawia strukturę plików aplikacji pojedynczego projektu.</span><span class="sxs-lookup"><span data-stu-id="32e2c-118">Figure 5-1 shows the file structure of a single-project app.</span></span>

![Aplikacja ASP.NET Core pojedynczego projektu](./media/image5-1.png)

<span data-ttu-id="32e2c-120">**Rysunek 5-1.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-120">**Figure 5-1.**</span></span> <span data-ttu-id="32e2c-121">Pojedynczy projekt ASP.NET Core aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-121">A single project ASP.NET Core app.</span></span>

<span data-ttu-id="32e2c-122">W scenariuszu pojedynczego projektu rozdzielenie problemów odbywa się za pomocą folderów.</span><span class="sxs-lookup"><span data-stu-id="32e2c-122">In a single project scenario, separation of concerns is achieved through the use of folders.</span></span> <span data-ttu-id="32e2c-123">Szablon domyślny zawiera oddzielne foldery dla obowiązków wzorca MVC dla modeli, widoków i kontrolerów, a także dodatkowe foldery dla danych i usług.</span><span class="sxs-lookup"><span data-stu-id="32e2c-123">The default template includes separate folders for MVC pattern responsibilities of Models, Views, and Controllers, as well as additional folders for Data and Services.</span></span> <span data-ttu-id="32e2c-124">W tym rozmieszczeniu szczegóły prezentacji powinny być ograniczone możliwie jak najwięcej do folderu widoki, a szczegóły implementacji dostępu do danych powinny być ograniczone do klas przechowywanych w folderze danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-124">In this arrangement, presentation details should be limited as much as possible to the Views folder, and data access implementation details should be limited to classes kept in the Data folder.</span></span> <span data-ttu-id="32e2c-125">Logika biznesowa powinna znajdować się w usługach i klasach w folderze modele.</span><span class="sxs-lookup"><span data-stu-id="32e2c-125">Business logic should reside in services and classes within the Models folder.</span></span>

<span data-ttu-id="32e2c-126">Chociaż proste, jednoprojektowe rozwiązanie monolityczne ma pewne wady.</span><span class="sxs-lookup"><span data-stu-id="32e2c-126">Although simple, the single-project monolithic solution has some disadvantages.</span></span> <span data-ttu-id="32e2c-127">Wraz ze wzrostem rozmiaru i złożoności projektu liczba plików i folderów nadal rośnie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-127">As the project's size and complexity grows, the number of files and folders will continue to grow as well.</span></span> <span data-ttu-id="32e2c-128">Problemy związane z interfejsem użytkownika (modele, widoki, kontrolery) znajdują się w wielu folderach, które nie są pogrupowane w kolejności alfabetycznej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-128">User interface (UI) concerns (models, views, controllers) reside in multiple folders, which aren't grouped together alphabetically.</span></span> <span data-ttu-id="32e2c-129">Ten problem występuje tylko wtedy, gdy dodatkowe konstrukcje poziomu interfejsu użytkownika, takie jak filters lub ModelBinders, są dodawane do własnych folderów.</span><span class="sxs-lookup"><span data-stu-id="32e2c-129">This issue only gets worse when additional UI-level constructs, such as Filters or ModelBinders, are added in their own folders.</span></span> <span data-ttu-id="32e2c-130">Logika biznesowa jest rozproszeni między modelami i folderami usług i nie istnieje jasne wskazanie klas, w których foldery powinny być zależne od innych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-130">Business logic is scattered between the Models and Services folders, and there's no clear indication of which classes in which folders should depend on which others.</span></span> <span data-ttu-id="32e2c-131">Brak organizacji na poziomie projektu często prowadzi do [kodu spaghetti](https://deviq.com/spaghetti-code/).</span><span class="sxs-lookup"><span data-stu-id="32e2c-131">This lack of organization at the project level frequently leads to [spaghetti code](https://deviq.com/spaghetti-code/).</span></span>

<span data-ttu-id="32e2c-132">Aby rozwiązać te problemy, aplikacje często są rozłożone na rozwiązania obejmujące wiele projektów, w których każdy projekt jest traktowany jako znajdujący się w określonej _warstwie_ aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-132">To address these issues, applications often evolve into multi-project solutions, where each project is considered to reside in a particular _layer_ of the application.</span></span>

## <a name="what-are-layers"></a><span data-ttu-id="32e2c-133">Co to są warstwy?</span><span class="sxs-lookup"><span data-stu-id="32e2c-133">What are layers?</span></span>

<span data-ttu-id="32e2c-134">W miarę wzrostu złożoności aplikacji jeden ze sposobów zarządzania tą złożonością polega na rozdzieleniu aplikacji zależnie od jej obowiązków lub obaw.</span><span class="sxs-lookup"><span data-stu-id="32e2c-134">As applications grow in complexity, one way to manage that complexity is to break up the application according to its responsibilities or concerns.</span></span> <span data-ttu-id="32e2c-135">Jest to zgodne z regułą separacji i może pomóc w utrzymaniu zorganizowanej bazy kodu w taki sposób, aby deweloperzy mogli łatwo znajdować określone funkcje.</span><span class="sxs-lookup"><span data-stu-id="32e2c-135">This follows the separation of concerns principle, and can help keep a growing codebase organized so that developers can easily find where certain functionality is implemented.</span></span> <span data-ttu-id="32e2c-136">Architektura warstwowa oferuje wiele korzyści poza organizacją kodu, chociaż.</span><span class="sxs-lookup"><span data-stu-id="32e2c-136">Layered architecture offers a number of advantages beyond just code organization, though.</span></span>

<span data-ttu-id="32e2c-137">Organizując kod na warstwy, typowe funkcje niskiego poziomu mogą być ponownie używane w całej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-137">By organizing code into layers, common low-level functionality can be reused throughout the application.</span></span> <span data-ttu-id="32e2c-138">To ponowne użycie jest korzystne, ponieważ oznacza to, że nie trzeba pisać kodu i ponieważ może on umożliwić standaryzację aplikacji w ramach jednej implementacji, zgodnie z zasadą [nie powtarzaj siebie (sucha)](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself) .</span><span class="sxs-lookup"><span data-stu-id="32e2c-138">This reuse is beneficial because it means less code needs to be written and because it can allow the application to standardize on a single implementation, following the [don't repeat yourself (DRY)](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself) principle.</span></span>

<span data-ttu-id="32e2c-139">W przypadku architektury warstwowej aplikacje mogą wymuszać ograniczenia dotyczące tego, które warstwy mogą komunikować się z innymi warstwami.</span><span class="sxs-lookup"><span data-stu-id="32e2c-139">With a layered architecture, applications can enforce restrictions on which layers can communicate with other layers.</span></span> <span data-ttu-id="32e2c-140">Pomaga to w osiągnięciu hermetyzacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-140">This helps to achieve encapsulation.</span></span> <span data-ttu-id="32e2c-141">Po zmianie lub wymianie warstwy należy mieć wpływ tylko na te warstwy, które z nią pracują.</span><span class="sxs-lookup"><span data-stu-id="32e2c-141">When a layer is changed or replaced, only those layers that work with it should be impacted.</span></span> <span data-ttu-id="32e2c-142">Ograniczając warstwy, które są zależne od tego, które warstwy, wpływ zmian można zmniejszyć, tak aby jedna zmiana nie miała wpływu na całą aplikację.</span><span class="sxs-lookup"><span data-stu-id="32e2c-142">By limiting which layers depend on which other layers, the impact of changes can be mitigated so that a single change doesn't impact the entire application.</span></span>

<span data-ttu-id="32e2c-143">Warstwy (i hermetyzacja) znacznie ułatwiają zamianę funkcji w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-143">Layers (and encapsulation) make it much easier to replace functionality within the application.</span></span> <span data-ttu-id="32e2c-144">Na przykład aplikacja może początkowo używać własnej SQL Server bazy danych do trwałości, ale później może zdecydować się na korzystanie z strategii trwałości opartej na chmurze lub jednej za interfejsem API sieci Web.</span><span class="sxs-lookup"><span data-stu-id="32e2c-144">For example, an application might initially use its own SQL Server database for persistence, but later could choose to use a cloud-based persistence strategy, or one behind a web API.</span></span> <span data-ttu-id="32e2c-145">Jeśli aplikacja prawidłowo hermetyzuje swoją implementację trwałości w obrębie warstwy logicznej, SQL Server konkretna warstwa może zostać zastąpiona przez nową, implementując ten sam interfejs publiczny.</span><span class="sxs-lookup"><span data-stu-id="32e2c-145">If the application has properly encapsulated its persistence implementation within a logical layer, that SQL Server specific layer could be replaced by a new one implementing the same public interface.</span></span>

<span data-ttu-id="32e2c-146">Oprócz możliwości zamiany implementacji w odpowiedzi na przyszłe zmiany w wymaganiach, warstwy aplikacji mogą także ułatwić wymianę implementacji na potrzeby testowania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-146">In addition to the potential of swapping out implementations in response to future changes in requirements, application layers can also make it easier to swap out implementations for testing purposes.</span></span> <span data-ttu-id="32e2c-147">Zamiast konieczności pisania testów, które działają względem warstwy danych rzeczywistych lub warstwy interfejsu użytkownika aplikacji, te warstwy mogą zostać zastąpione w czasie testu przy użyciu fałszywych implementacji, które zapewniają znane odpowiedzi na żądania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-147">Instead of having to write tests that operate against the real data layer or UI layer of the application, these layers can be replaced at test time with fake implementations that provide known responses to requests.</span></span> <span data-ttu-id="32e2c-148">Zwykle sprawia to, że testy znacznie ułatwiają pisanie i szybsze wykonywanie w porównaniu z uruchamianiem testów względem rzeczywistej infrastruktury aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-148">This typically makes tests much easier to write and much faster to run when compared to running tests against the application's real infrastructure.</span></span>

<span data-ttu-id="32e2c-149">Warstwami logicznymi jest typowa technika ulepszania organizacji kodu w aplikacjach oprogramowania dla przedsiębiorstw. istnieje kilka sposobów, w których kod może być zorganizowany do warstw.</span><span class="sxs-lookup"><span data-stu-id="32e2c-149">Logical layering is a common technique for improving the organization of code in enterprise software applications, and there are several ways in which code can be organized into layers.</span></span>

> [!NOTE]
 > <span data-ttu-id="32e2c-150">_Warstwy_ reprezentują logiczne separacje w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-150">_Layers_ represent logical separation within the application.</span></span> <span data-ttu-id="32e2c-151">W przypadku, gdy logika aplikacji jest fizycznie dystrybuowana do oddzielnych serwerów lub procesów, te oddzielne elementy docelowe wdrożenia są określane jako _warstwy_.</span><span class="sxs-lookup"><span data-stu-id="32e2c-151">In the event that application logic is physically distributed to separate servers or processes, these separate physical deployment targets are referred to as _tiers_.</span></span> <span data-ttu-id="32e2c-152">Jest to możliwe, i dość często, aby mieć aplikację N-warstwową, która jest wdrażana w jednej warstwie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-152">It's possible, and quite common, to have an N-Layer application that is deployed to a single tier.</span></span>

## <a name="traditional-n-layer-architecture-applications"></a><span data-ttu-id="32e2c-153">Tradycyjne aplikacje architektury "N-Layer"</span><span class="sxs-lookup"><span data-stu-id="32e2c-153">Traditional "N-Layer" architecture applications</span></span>

<span data-ttu-id="32e2c-154">Najbardziej powszechną organizacją logiki aplikacji do warstw przedstawiono na rysunku 5-2.</span><span class="sxs-lookup"><span data-stu-id="32e2c-154">The most common organization of application logic into layers is shown in Figure 5-2.</span></span>

![Typowe warstwy aplikacji](./media/image5-2.png)

<span data-ttu-id="32e2c-156">**Rysunek 5-2.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-156">**Figure 5-2.**</span></span> <span data-ttu-id="32e2c-157">Typowe warstwy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-157">Typical application layers.</span></span>

<span data-ttu-id="32e2c-158">Te warstwy są często skracane jako interfejs użytkownika, LOGIKI biznesowej (warstwa logiki biznesowej) i DAL (warstwa dostępu do danych).</span><span class="sxs-lookup"><span data-stu-id="32e2c-158">These layers are frequently abbreviated as UI, BLL (Business Logic Layer), and DAL (Data Access Layer).</span></span> <span data-ttu-id="32e2c-159">Korzystając z tej architektury, użytkownicy wysyłają żądania za pośrednictwem warstwy interfejsu użytkownika, które współdziałają tylko z LOGIKI biznesowej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-159">Using this architecture, users make requests through the UI layer, which interacts only with the BLL.</span></span> <span data-ttu-id="32e2c-160">LOGIKI biznesowej z kolei może wywoływać DAL dla żądań dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-160">The BLL, in turn, can call the DAL for data access requests.</span></span> <span data-ttu-id="32e2c-161">Warstwa interfejsu użytkownika nie powinna bezpośrednio wykonywać żadnych żądań do DAL, ani nie powinna być współpracująca z trwałością bezpośrednio za pośrednictwem innych metod.</span><span class="sxs-lookup"><span data-stu-id="32e2c-161">The UI layer shouldn't make any requests to the DAL directly, nor should it interact with persistence directly through other means.</span></span> <span data-ttu-id="32e2c-162">Podobnie LOGIKI biznesowej powinna współistnieć z trwałością, przechodząc przez DAL.</span><span class="sxs-lookup"><span data-stu-id="32e2c-162">Likewise, the BLL should only interact with persistence by going through the DAL.</span></span> <span data-ttu-id="32e2c-163">W ten sposób każda warstwa ma własną dobrze znaną odpowiedzialność.</span><span class="sxs-lookup"><span data-stu-id="32e2c-163">In this way, each layer has its own well-known responsibility.</span></span>

<span data-ttu-id="32e2c-164">Jedną z wadą tego tradycyjnego podejścia do warstw jest to, że zależności czasu kompilacji są uruchamiane od góry do dołu.</span><span class="sxs-lookup"><span data-stu-id="32e2c-164">One disadvantage of this traditional layering approach is that compile-time dependencies run from the top to the bottom.</span></span> <span data-ttu-id="32e2c-165">Oznacza to, że warstwa interfejsu użytkownika zależy od LOGIKI biznesowej, która zależy od DAL.</span><span class="sxs-lookup"><span data-stu-id="32e2c-165">That is, the UI layer depends on the BLL, which depends on the DAL.</span></span> <span data-ttu-id="32e2c-166">Oznacza to, że LOGIKI biznesowej, który zwykle zawiera najważniejsze logiki w aplikacji, zależy od szczegółów implementacji dostępu do danych (i często w przypadku istnienia bazy danych).</span><span class="sxs-lookup"><span data-stu-id="32e2c-166">This means that the BLL, which usually holds the most important logic in the application, is dependent on data access implementation details (and often on the existence of a database).</span></span> <span data-ttu-id="32e2c-167">Testowanie logiki biznesowej w takiej architekturze jest często trudne i wymaga testowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-167">Testing business logic in such an architecture is often difficult, requiring a test database.</span></span> <span data-ttu-id="32e2c-168">Zasady Inversion dotyczącej zależności mogą służyć do rozwiązywania tego problemu, jak widać w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-168">The dependency inversion principle can be used to address this issue, as you'll see in the next section.</span></span>

<span data-ttu-id="32e2c-169">Na rysunku 5-3 przedstawiono przykładowe rozwiązanie, które dzieli aplikację na trzy projekty według odpowiedzialności (lub warstwy).</span><span class="sxs-lookup"><span data-stu-id="32e2c-169">Figure 5-3 shows an example solution, breaking the application into three projects by responsibility (or layer).</span></span>

![Prosta aplikacja monolityczna z trzema projektami](./media/image5-3.png)

<span data-ttu-id="32e2c-171">**Rysunek 5-3.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-171">**Figure 5-3.**</span></span> <span data-ttu-id="32e2c-172">Prosta aplikacja monolityczna z trzema projektami.</span><span class="sxs-lookup"><span data-stu-id="32e2c-172">A simple monolithic application with three projects.</span></span>

<span data-ttu-id="32e2c-173">Mimo że ta aplikacja korzysta z kilku projektów do celów organizacyjnych, nadal jest wdrażana jako jedna jednostka, a jej klienci będą korzystać z niej jako pojedynczej aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="32e2c-173">Although this application uses several projects for organizational purposes, it's still deployed as a single unit and its clients will interact with it as a single web app.</span></span> <span data-ttu-id="32e2c-174">Pozwala to na bardzo prosty proces wdrażania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-174">This allows for very simple deployment process.</span></span> <span data-ttu-id="32e2c-175">Rysunek 5-4 pokazuje, jak taka aplikacja może być hostowana przy użyciu platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="32e2c-175">Figure 5-4 shows how such an app might be hosted using Azure.</span></span>

![Proste wdrażanie aplikacji sieci Web platformy Azure](./media/image5-4.png)

<span data-ttu-id="32e2c-177">**Rysunek 5-4.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-177">**Figure 5-4.**</span></span> <span data-ttu-id="32e2c-178">Proste wdrażanie aplikacji sieci Web platformy Azure</span><span class="sxs-lookup"><span data-stu-id="32e2c-178">Simple deployment of Azure Web App</span></span>

<span data-ttu-id="32e2c-179">W miarę wzrostu potrzeb aplikacji mogą być wymagane bardziej złożone i niezawodne rozwiązania wdrożeniowe.</span><span class="sxs-lookup"><span data-stu-id="32e2c-179">As application needs grow, more complex and robust deployment solutions may be required.</span></span> <span data-ttu-id="32e2c-180">Rysunek 5-5 przedstawia przykład bardziej złożonego planu wdrożenia, który obsługuje dodatkowe możliwości.</span><span class="sxs-lookup"><span data-stu-id="32e2c-180">Figure 5-5 shows an example of a more complex deployment plan that supports additional capabilities.</span></span>

![Wdrażanie aplikacji sieci Web w Azure App Service](./media/image5-5.png)

<span data-ttu-id="32e2c-182">**Rysunek 5-5.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-182">**Figure 5-5.**</span></span> <span data-ttu-id="32e2c-183">Wdrażanie aplikacji sieci Web w Azure App Service</span><span class="sxs-lookup"><span data-stu-id="32e2c-183">Deploying a web app to an Azure App Service</span></span>

<span data-ttu-id="32e2c-184">Wewnętrznie organizacja tego projektu w wielu projektach na podstawie odpowiedzialności usprawnia łatwość utrzymania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-184">Internally, this project's organization into multiple projects based on responsibility improves the maintainability of the application.</span></span>

<span data-ttu-id="32e2c-185">Tę jednostkę można skalować w górę lub w dół, aby korzystać z skalowalności na żądanie funkcji opartych na chmurze.</span><span class="sxs-lookup"><span data-stu-id="32e2c-185">This unit can be scaled up or out to take advantage of cloud-based on-demand scalability.</span></span> <span data-ttu-id="32e2c-186">Skalowanie w górę oznacza dodanie dodatkowego procesora CPU, pamięci, miejsca na dysku lub innych zasobów do serwerów obsługujących aplikację.</span><span class="sxs-lookup"><span data-stu-id="32e2c-186">Scaling up means adding additional CPU, memory, disk space, or other resources to the server(s) hosting your app.</span></span> <span data-ttu-id="32e2c-187">Skalowanie w dół oznacza dodanie dodatkowych wystąpień takich serwerów, niezależnie od tego, czy są to serwery fizyczne, maszyny wirtualne czy kontenery.</span><span class="sxs-lookup"><span data-stu-id="32e2c-187">Scaling out means adding additional instances of such servers, whether these are physical servers, virtual machines, or containers.</span></span> <span data-ttu-id="32e2c-188">Gdy aplikacja jest hostowana w wielu wystąpieniach, moduł równoważenia obciążenia jest używany do przypisywania żądań do poszczególnych wystąpień aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-188">When your app is hosted across multiple instances, a load balancer is used to assign requests to individual app instances.</span></span>

<span data-ttu-id="32e2c-189">Najprostszym podejściem do skalowania aplikacji sieci Web na platformie Azure jest ręczne skonfigurowanie skalowania w planie App Service aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-189">The simplest approach to scaling a web application in Azure is to configure scaling manually in the application's App Service Plan.</span></span> <span data-ttu-id="32e2c-190">Rysunek 5-6 przedstawia odpowiedni ekran pulpitu nawigacyjnego platformy Azure, aby skonfigurować liczbę wystąpień obsługujących aplikację.</span><span class="sxs-lookup"><span data-stu-id="32e2c-190">Figure 5-6 shows the appropriate Azure dashboard screen to configure how many instances are serving an app.</span></span>

![Skalowanie planu App Service na platformie Azure](./media/image5-6.png)

<span data-ttu-id="32e2c-192">**Rysunek 5-6.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-192">**Figure 5-6.**</span></span> <span data-ttu-id="32e2c-193">Skalowanie planu App Service na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="32e2c-193">App Service Plan scaling in Azure.</span></span>

## <a name="clean-architecture"></a><span data-ttu-id="32e2c-194">Czysta architektura</span><span class="sxs-lookup"><span data-stu-id="32e2c-194">Clean architecture</span></span>

<span data-ttu-id="32e2c-195">Aplikacje, które są zgodne z zasadą niezależności zależności, a także zasady projektowania opartego na domenie (DDD), mają do nich zastosowanie w podobnej architekturze.</span><span class="sxs-lookup"><span data-stu-id="32e2c-195">Applications that follow the Dependency Inversion Principle as well as the Domain-Driven Design (DDD) principles tend to arrive at a similar architecture.</span></span> <span data-ttu-id="32e2c-196">Ta architektura została przełączona przez wiele nazw w latach.</span><span class="sxs-lookup"><span data-stu-id="32e2c-196">This architecture has gone by many names over the years.</span></span> <span data-ttu-id="32e2c-197">Jedna z pierwszych nazw była architekturą sześciokątną, a po niej porty i karty.</span><span class="sxs-lookup"><span data-stu-id="32e2c-197">One of the first names was Hexagonal Architecture, followed by Ports-and-Adapters.</span></span> <span data-ttu-id="32e2c-198">Niedawno jest to zacytowane jako [Architektura cebuli](https://jeffreypalermo.com/blog/the-onion-architecture-part-1/) lub [czysta architektura](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html).</span><span class="sxs-lookup"><span data-stu-id="32e2c-198">More recently, it's been cited as the [Onion Architecture](https://jeffreypalermo.com/blog/the-onion-architecture-part-1/) or [Clean Architecture](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html).</span></span> <span data-ttu-id="32e2c-199">Ta druga nazwa, czysta architektura, jest używana jako nazwa tej architektury w tej książce elektronicznej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-199">The latter name, Clean Architecture, is used as the name for this architecture in this e-book.</span></span>

> [!NOTE]
> <span data-ttu-id="32e2c-200">Termin czystej architektury można zastosować do aplikacji, które są kompilowane przy użyciu zasad DDD, a także do tych, które nie zostały skompilowane przy użyciu DDD.</span><span class="sxs-lookup"><span data-stu-id="32e2c-200">The term Clean Architecture can be applied to applications that are built using DDD Principles as well as to those that are not built using DDD.</span></span> <span data-ttu-id="32e2c-201">W przypadku dawna kombinacja ta może być określana jako "czysta architektura".</span><span class="sxs-lookup"><span data-stu-id="32e2c-201">In the case of the former, this combination may be referred to as "Clean DDD Architecture".</span></span>

<span data-ttu-id="32e2c-202">Czysty architektura powoduje umieszczenie logiki biznesowej i modelu aplikacji w centrum aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-202">Clean architecture puts the business logic and application model at the center of the application.</span></span> <span data-ttu-id="32e2c-203">Zamiast mieć logikę biznesową zależą od dostępu do danych lub innych problemów związanych z infrastrukturą, ta zależność jest odwrócona: szczegóły infrastruktury i implementacji zależą od rdzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-203">Instead of having business logic depend on data access or other infrastructure concerns, this dependency is inverted: infrastructure and implementation details depend on the Application Core.</span></span> <span data-ttu-id="32e2c-204">Jest to osiągane przez zdefiniowanie abstrakcji lub interfejsów w rdzeń aplikacji, które następnie są implementowane przez typy zdefiniowane w warstwie infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-204">This is achieved by defining abstractions, or interfaces, in the Application Core, which are then implemented by types defined in the Infrastructure layer.</span></span> <span data-ttu-id="32e2c-205">Typowym sposobem wizualizacji tej architektury jest użycie serii okręgów koncentrycznych, podobnie jak w przypadku cebuli.</span><span class="sxs-lookup"><span data-stu-id="32e2c-205">A common way of visualizing this architecture is to use a series of concentric circles, similar to an onion.</span></span> <span data-ttu-id="32e2c-206">Rysunek 5-7 pokazuje przykład tego stylu reprezentacji architektury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-206">Figure 5-7 shows an example of this style of architectural representation.</span></span>

![Czysta architektura; Widok cebuli](./media/image5-7.png)

<span data-ttu-id="32e2c-208">**Rysunek 5-7.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-208">**Figure 5-7.**</span></span> <span data-ttu-id="32e2c-209">Czysta architektura; Widok cebuli</span><span class="sxs-lookup"><span data-stu-id="32e2c-209">Clean Architecture; onion view</span></span>

<span data-ttu-id="32e2c-210">Na tym diagramie zależności przepływu w kierunku najbardziej wewnętrznego okręgu.</span><span class="sxs-lookup"><span data-stu-id="32e2c-210">In this diagram, dependencies flow toward the innermost circle.</span></span> <span data-ttu-id="32e2c-211">Rdzeń aplikacji przyjmuje swoją nazwę z pozycji na początku tego diagramu.</span><span class="sxs-lookup"><span data-stu-id="32e2c-211">The Application Core takes its name from its position at the core of this diagram.</span></span> <span data-ttu-id="32e2c-212">Na diagramie można zobaczyć, że rdzeń aplikacji nie ma żadnych zależności od innych warstw aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-212">And you can see on the diagram that the Application Core has no dependencies on other application layers.</span></span> <span data-ttu-id="32e2c-213">Jednostki i interfejsy aplikacji są w bardzo wyśrodkowane.</span><span class="sxs-lookup"><span data-stu-id="32e2c-213">The application's entities and interfaces are at the very center.</span></span> <span data-ttu-id="32e2c-214">Po prostu poza, ale nadal w rdzeń aplikacji, są usługi domenowe, które zwykle implementują interfejsy zdefiniowane w okręgu wewnętrznym.</span><span class="sxs-lookup"><span data-stu-id="32e2c-214">Just outside, but still in the Application Core, are domain services, which typically implement interfaces defined in the inner circle.</span></span> <span data-ttu-id="32e2c-215">Poza rdzeniem aplikacji zarówno interfejs użytkownika, jak i warstwy infrastruktury zależą od rdzenia aplikacji, ale nie na siebie (koniecznie).</span><span class="sxs-lookup"><span data-stu-id="32e2c-215">Outside of the Application Core, both the UI and the Infrastructure layers depend on the Application Core, but not on one another (necessarily).</span></span>

<span data-ttu-id="32e2c-216">Rysunek 5-8 pokazuje bardziej tradycyjny poziomy diagram warstwowy, który lepiej odzwierciedla zależność między interfejsem użytkownika a innymi warstwami.</span><span class="sxs-lookup"><span data-stu-id="32e2c-216">Figure 5-8 shows a more traditional horizontal layer diagram that better reflects the dependency between the UI and other layers.</span></span>

![Czysta architektura; Widok warstwy poziomej](./media/image5-8.png)

<span data-ttu-id="32e2c-218">**Rysunek 5-8.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-218">**Figure 5-8.**</span></span> <span data-ttu-id="32e2c-219">Czysta architektura; Widok warstwy poziomej</span><span class="sxs-lookup"><span data-stu-id="32e2c-219">Clean Architecture; horizontal layer view</span></span>

<span data-ttu-id="32e2c-220">Należy zauważyć, że pełne strzałki reprezentują zależności czasu kompilacji, natomiast strzałka kreskowana reprezentuje zależność tylko do wykonania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-220">Note that the solid arrows represent compile-time dependencies, while the dashed arrow represents a runtime-only dependency.</span></span> <span data-ttu-id="32e2c-221">W przypadku czystej architektury warstwa interfejsu użytkownika współpracuje z interfejsami zdefiniowanymi w rdzeń aplikacji w czasie kompilacji i najlepiej nie należy wiedzieć o typach implementacji zdefiniowanych w warstwie infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-221">With the clean architecture, the UI layer works with interfaces defined in the Application Core at compile time, and ideally shouldn't know about the implementation types defined in the Infrastructure layer.</span></span> <span data-ttu-id="32e2c-222">Jednak w czasie wykonywania, te typy implementacji są wymagane do wykonania aplikacji, dlatego muszą być obecne i rozłączone do interfejsów podstawowych aplikacji za pomocą iniekcji zależności.</span><span class="sxs-lookup"><span data-stu-id="32e2c-222">At run time, however, these implementation types are required for the app to execute, so they need to be present and wired up to the Application Core interfaces via dependency injection.</span></span>

<span data-ttu-id="32e2c-223">Na rysunku 5-9 przedstawiono bardziej szczegółowy widok architektury aplikacji ASP.NET Core po skompilowaniu tych zaleceń.</span><span class="sxs-lookup"><span data-stu-id="32e2c-223">Figure 5-9 shows a more detailed view of an ASP.NET Core application's architecture when built following these recommendations.</span></span>

![ASP.NET Core diagram architektury po czystej architekturze](./media/image5-9.png)

<span data-ttu-id="32e2c-225">**Rysunek 5-9.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-225">**Figure 5-9.**</span></span> <span data-ttu-id="32e2c-226">ASP.NET Core diagram architektury po czystej architekturze.</span><span class="sxs-lookup"><span data-stu-id="32e2c-226">ASP.NET Core architecture diagram following Clean Architecture.</span></span>

<span data-ttu-id="32e2c-227">Ponieważ podstawowe aplikacje nie zależą od infrastruktury, bardzo proste jest zapisanie zautomatyzowanych testów jednostkowych dla tej warstwy.</span><span class="sxs-lookup"><span data-stu-id="32e2c-227">Because the Application Core doesn't depend on Infrastructure, it's very easy to write automated unit tests for this layer.</span></span> <span data-ttu-id="32e2c-228">Ilustracje 5-10 i 5-11 pokazują, jak testy mieszczą się w tej architekturze.</span><span class="sxs-lookup"><span data-stu-id="32e2c-228">Figures 5-10 and 5-11 show how tests fit into this architecture.</span></span>

![UnitTestCore](./media/image5-10.png)

<span data-ttu-id="32e2c-230">**Rysunek 5-10.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-230">**Figure 5-10.**</span></span> <span data-ttu-id="32e2c-231">Podstawowe testy jednostkowe aplikacji w izolacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-231">Unit testing Application Core in isolation.</span></span>

![IntegrationTests](./media/image5-11.png)

<span data-ttu-id="32e2c-233">**Rysunek 5-11.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-233">**Figure 5-11.**</span></span> <span data-ttu-id="32e2c-234">Integracja polega na testowaniu implementacji infrastruktury z zależnościami zewnętrznymi.</span><span class="sxs-lookup"><span data-stu-id="32e2c-234">Integration testing Infrastructure implementations with external dependencies.</span></span>

<span data-ttu-id="32e2c-235">Ze względu na to, że warstwa interfejsu użytkownika nie ma żadnej bezpośredniej zależności od typów zdefiniowanych w projekcie infrastruktury, można bardzo łatwo zamienić implementacje, aby ułatwić testowanie lub reagowanie na zmieniające się wymagania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-235">Since the UI layer doesn't have any direct dependency on types defined in the Infrastructure project, it's likewise very easy to swap out implementations, either to facilitate testing or in response to changing application requirements.</span></span> <span data-ttu-id="32e2c-236">Wbudowana w ASP.NET Core funkcja i obsługa iniekcji zależności sprawia, że ta architektura jest najlepszym sposobem na strukturę nieuproszczonych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-236">ASP.NET Core's built-in use of and support for dependency injection makes this architecture the most appropriate way to structure non-trivial monolithic applications.</span></span>

<span data-ttu-id="32e2c-237">W przypadku aplikacji monolitycznych wszystkie projekty aplikacji, infrastruktury i interfejsu użytkownika są uruchamiane jako pojedyncze aplikacje.</span><span class="sxs-lookup"><span data-stu-id="32e2c-237">For monolithic applications the Application Core, Infrastructure, and UI projects are all run as a single application.</span></span> <span data-ttu-id="32e2c-238">Architektura aplikacji środowiska uruchomieniowego może wyglądać podobnie do ilustracji 5-12.</span><span class="sxs-lookup"><span data-stu-id="32e2c-238">The runtime application architecture might look something like Figure 5-12.</span></span>

![Architektura ASP.NET Core 2](./media/image5-12.png)

<span data-ttu-id="32e2c-240">**Rysunek 5-12.**</span><span class="sxs-lookup"><span data-stu-id="32e2c-240">**Figure 5-12.**</span></span> <span data-ttu-id="32e2c-241">Przykładowa architektura środowiska uruchomieniowego aplikacji ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="32e2c-241">A sample ASP.NET Core app's runtime architecture.</span></span>

### <a name="organizing-code-in-clean-architecture"></a><span data-ttu-id="32e2c-242">Organizowanie kodu w czystej architekturze</span><span class="sxs-lookup"><span data-stu-id="32e2c-242">Organizing code in Clean Architecture</span></span>

<span data-ttu-id="32e2c-243">W rozwiązaniu czystego architektury każdy projekt ma wyraźne obowiązki.</span><span class="sxs-lookup"><span data-stu-id="32e2c-243">In a Clean Architecture solution, each project has clear responsibilities.</span></span> <span data-ttu-id="32e2c-244">W związku z tym niektóre typy należą do każdego projektu i często znajdują się foldery odpowiadające tym typom w odpowiednim projekcie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-244">As such, certain types belong in each project and you'll frequently find folders corresponding to these types in the appropriate project.</span></span>

<span data-ttu-id="32e2c-245">Rdzeń aplikacji zawiera model biznesowy, który obejmuje jednostki, usługi i interfejsy.</span><span class="sxs-lookup"><span data-stu-id="32e2c-245">The Application Core holds the business model, which includes entities, services, and interfaces.</span></span> <span data-ttu-id="32e2c-246">Te interfejsy obejmują abstrakcje operacji, które będą wykonywane przy użyciu infrastruktury, takiej jak dostęp do danych, dostęp do systemu plików, wywołania sieciowe itp. Czasami usługi lub interfejsy zdefiniowane w tej warstwie muszą współdziałać z typami nienależącymi do jednostki, które nie są zależne od interfejsu użytkownika ani infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-246">These interfaces include abstractions for operations that will be performed using Infrastructure, such as data access, file system access, network calls, etc. Sometimes services or interfaces defined at this layer will need to work with non-entity types that have no dependencies on UI or Infrastructure.</span></span> <span data-ttu-id="32e2c-247">Można je definiować jako proste Transfer danych obiekty (DTO).</span><span class="sxs-lookup"><span data-stu-id="32e2c-247">These can be defined as simple Data Transfer Objects (DTOs).</span></span>

### <a name="application-core-types"></a><span data-ttu-id="32e2c-248">Typy podstawowe aplikacji</span><span class="sxs-lookup"><span data-stu-id="32e2c-248">Application Core types</span></span>

- <span data-ttu-id="32e2c-249">Jednostki (utrwalone klasy modelu biznesowego)</span><span class="sxs-lookup"><span data-stu-id="32e2c-249">Entities (business model classes that are persisted)</span></span>
- <span data-ttu-id="32e2c-250">Interfejsy</span><span class="sxs-lookup"><span data-stu-id="32e2c-250">Interfaces</span></span>
- <span data-ttu-id="32e2c-251">Usługi</span><span class="sxs-lookup"><span data-stu-id="32e2c-251">Services</span></span>
- <span data-ttu-id="32e2c-252">DTO</span><span class="sxs-lookup"><span data-stu-id="32e2c-252">DTOs</span></span>

<span data-ttu-id="32e2c-253">Projekt infrastruktury zazwyczaj obejmuje implementacje dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-253">The Infrastructure project typically includes data access implementations.</span></span> <span data-ttu-id="32e2c-254">W typowej aplikacji sieci Web ASP.NET Core te implementacje obejmują Entity Framework (EF) DbContext, wszystkie EF Core `Migration` obiekty, które zostały zdefiniowane, oraz klasy implementacji dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-254">In a typical ASP.NET Core web application, these implementations include the Entity Framework (EF) DbContext, any EF Core `Migration` objects that have been defined, and data access implementation classes.</span></span> <span data-ttu-id="32e2c-255">Najbardziej typowym sposobem na abstrakcyjny kod implementacji dostępu do danych jest użycie [wzorca projektowego repozytorium](https://deviq.com/repository-pattern/).</span><span class="sxs-lookup"><span data-stu-id="32e2c-255">The most common way to abstract data access implementation code is through the use of the [Repository design pattern](https://deviq.com/repository-pattern/).</span></span>

<span data-ttu-id="32e2c-256">Oprócz implementacji dostępu do danych, projekt infrastruktury powinien zawierać implementacje usług, które muszą wchodzić w skład z obaw związanych z infrastrukturą.</span><span class="sxs-lookup"><span data-stu-id="32e2c-256">In addition to data access implementations, the Infrastructure project should contain implementations of services that must interact with infrastructure concerns.</span></span> <span data-ttu-id="32e2c-257">Te usługi powinny implementować interfejsy zdefiniowane w rdzeniu aplikacji, a więc infrastruktura powinna mieć odwołanie do projektu podstawowego aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-257">These services should implement interfaces defined in the Application Core, and so Infrastructure should have a reference to the Application Core project.</span></span>

### <a name="infrastructure-types"></a><span data-ttu-id="32e2c-258">Typy infrastruktury</span><span class="sxs-lookup"><span data-stu-id="32e2c-258">Infrastructure types</span></span>

- <span data-ttu-id="32e2c-259">Typy EF Core (`DbContext`, `Migration`)</span><span class="sxs-lookup"><span data-stu-id="32e2c-259">EF Core types (`DbContext`, `Migration`)</span></span>
- <span data-ttu-id="32e2c-260">Typy implementacji dostępu do danych (repozytoria)</span><span class="sxs-lookup"><span data-stu-id="32e2c-260">Data access implementation types (Repositories)</span></span>
- <span data-ttu-id="32e2c-261">Usługi specyficzne dla infrastruktury (na przykład `FileLogger` lub) `SmtpNotifier`</span><span class="sxs-lookup"><span data-stu-id="32e2c-261">Infrastructure-specific services (for example, `FileLogger` or `SmtpNotifier`)</span></span>

<span data-ttu-id="32e2c-262">Warstwa interfejsu użytkownika w aplikacji ASP.NET Core MVC jest punktem wejścia dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-262">The user interface layer in an ASP.NET Core MVC application is the entry point for the application.</span></span> <span data-ttu-id="32e2c-263">Ten projekt powinien odwoływać się do projektu podstawowego aplikacji, a jego typy powinny współdziałać z infrastrukturą przez interfejsy zdefiniowane w podstawowym aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-263">This project should reference the Application Core project, and its types should interact with infrastructure strictly through interfaces defined in Application Core.</span></span> <span data-ttu-id="32e2c-264">W warstwie interfejsu użytkownika nie powinny być dozwolone żadne bezpośrednie wystąpienia ani statyczne wywołania do typów warstw infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-264">No direct instantiation of or static calls to the Infrastructure layer types should be allowed in the UI layer.</span></span>

### <a name="ui-layer-types"></a><span data-ttu-id="32e2c-265">Typy warstw interfejsu użytkownika</span><span class="sxs-lookup"><span data-stu-id="32e2c-265">UI layer types</span></span>

- <span data-ttu-id="32e2c-266">Kontrolery</span><span class="sxs-lookup"><span data-stu-id="32e2c-266">Controllers</span></span>
- <span data-ttu-id="32e2c-267">Filtry</span><span class="sxs-lookup"><span data-stu-id="32e2c-267">Filters</span></span>
- <span data-ttu-id="32e2c-268">Widoki</span><span class="sxs-lookup"><span data-stu-id="32e2c-268">Views</span></span>
- <span data-ttu-id="32e2c-269">Modele widoków</span><span class="sxs-lookup"><span data-stu-id="32e2c-269">ViewModels</span></span>
- <span data-ttu-id="32e2c-270">Folderze</span><span class="sxs-lookup"><span data-stu-id="32e2c-270">Startup</span></span>

<span data-ttu-id="32e2c-271">Klasa startowa jest odpowiedzialna za skonfigurowanie aplikacji oraz w celu zapewnienia obsługi typów implementacji w interfejsach, co pozwala na prawidłowe działanie iniekcji zależności w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-271">The Startup class is responsible for configuring the application, and for wiring up implementation types to interfaces, allowing dependency injection to work properly at run time.</span></span>

> [!NOTE]
> <span data-ttu-id="32e2c-272">Aby można było połączyć iniekcję zależności w ConfigureServices w pliku Startup.cs projektu interfejsu użytkownika, projekt może wymagać odniesienia do projektu infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-272">In order to wire up dependency injection in ConfigureServices in the Startup.cs file of the UI project, the project may need to reference the Infrastructure project.</span></span> <span data-ttu-id="32e2c-273">Tę zależność można wyeliminować, najłatwiej przy użyciu niestandardowego kontenera DI.</span><span class="sxs-lookup"><span data-stu-id="32e2c-273">This dependency can be eliminated, most easily by using a custom DI container.</span></span> <span data-ttu-id="32e2c-274">Na potrzeby tego przykładu najprostszym podejściem jest umożliwienie projektowi interfejsu użytkownika odwoływania się do projektu infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-274">For the purposes of this sample, the simplest approach is to allow the UI project to reference the Infrastructure project.</span></span>

## <a name="monolithic-applications-and-containers"></a><span data-ttu-id="32e2c-275">Monolityczne aplikacje i kontenery</span><span class="sxs-lookup"><span data-stu-id="32e2c-275">Monolithic applications and containers</span></span>

<span data-ttu-id="32e2c-276">Można utworzyć pojedynczą i monolityczną aplikację sieci Web lub usługę opartą na wdrożeniu, a następnie wdrożyć ją jako kontener.</span><span class="sxs-lookup"><span data-stu-id="32e2c-276">You can build a single and monolithic-deployment based Web Application or Service and deploy it as a container.</span></span> <span data-ttu-id="32e2c-277">W aplikacji może nie być lity, ale zorganizowany w kilka bibliotek, składników ani warstw.</span><span class="sxs-lookup"><span data-stu-id="32e2c-277">Within the application, it might not be monolithic but organized into several libraries, components, or layers.</span></span> <span data-ttu-id="32e2c-278">Zewnętrznie jest to pojedynczy kontener, taki jak pojedynczy proces, pojedyncza aplikacja internetowa lub jedna usługa.</span><span class="sxs-lookup"><span data-stu-id="32e2c-278">Externally, it's a single container like a single process, single web application, or single service.</span></span>

<span data-ttu-id="32e2c-279">Aby zarządzać tym modelem, należy wdrożyć pojedynczy kontener do reprezentowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-279">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="32e2c-280">Aby skalować, po prostu Dodaj dodatkowe kopie przy użyciu modułu równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="32e2c-280">To scale, just add additional copies with a load balancer in front.</span></span> <span data-ttu-id="32e2c-281">Prostota pochodzi z zarządzania pojedynczym wdrożeniem w jednym kontenerze lub maszynie wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-281">The simplicity comes from managing a single deployment in a single container or VM.</span></span>

![Rysunek 5-13](./media/image5-13.png)

<span data-ttu-id="32e2c-283">W każdym kontenerze można uwzględnić wiele składników/bibliotek lub warstwy wewnętrzne, jak pokazano na rysunku 5-13.</span><span class="sxs-lookup"><span data-stu-id="32e2c-283">You can include multiple components/libraries or internal layers within each container, as illustrated in Figure 5-13.</span></span> <span data-ttu-id="32e2c-284">Jednak zgodnie z zasadą kontenera _"kontener wykonuje jedną czynność i robi to w jednym procesie_", wzorzec monolityczny może stanowić konflikt.</span><span class="sxs-lookup"><span data-stu-id="32e2c-284">But, following the container principle of _"a container does one thing, and does it in one process_", the monolithic pattern might be a conflict.</span></span>

<span data-ttu-id="32e2c-285">Minusem tego podejścia ma miejsce, gdy aplikacja zostanie powiększona, co wymaga jego skalowania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-285">The downside of this approach comes if/when the application grows, requiring it to scale.</span></span> <span data-ttu-id="32e2c-286">Jeśli cała aplikacja jest skalowana, problem nie występuje.</span><span class="sxs-lookup"><span data-stu-id="32e2c-286">If the entire application scales, it's not really a problem.</span></span> <span data-ttu-id="32e2c-287">Jednak w większości przypadków kilka części aplikacji to punkty podlewki wymagające skalowania, a inne składniki są mniej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-287">However, in most cases, a few parts of the application are the choke points requiring scaling, while other components are used less.</span></span>

<span data-ttu-id="32e2c-288">Przy użyciu typowego przykładu handlu elektronicznego, co jest potrzebne do skalowania, to składnik informacji o produkcie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-288">Using the typical eCommerce example, what you likely need to scale is the product information component.</span></span> <span data-ttu-id="32e2c-289">Wielu więcej klientów przegląda produkty od ich zakupu.</span><span class="sxs-lookup"><span data-stu-id="32e2c-289">Many more customers browse products than purchase them.</span></span> <span data-ttu-id="32e2c-290">Więcej klientów korzysta z koszyka niż w przypadku korzystania z potoku płatności.</span><span class="sxs-lookup"><span data-stu-id="32e2c-290">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="32e2c-291">Mniejsza liczba klientów umożliwia dodanie komentarzy lub wyświetlenie ich historii zakupów.</span><span class="sxs-lookup"><span data-stu-id="32e2c-291">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="32e2c-292">Najkorzystniej masz kilku pracowników w jednym regionie, który musi zarządzać kampanią zawartości i kampanii marketingowej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-292">And you likely only have a handful of employees, in a single region, that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="32e2c-293">Poprzez skalowanie projektu monolitycznego cały kod jest wdrażany wiele razy.</span><span class="sxs-lookup"><span data-stu-id="32e2c-293">By scaling the monolithic design, all the code is deployed multiple times.</span></span>

<span data-ttu-id="32e2c-294">Oprócz problemu "Skaluj wszystko" zmiany w pojedynczym składniku wymagają pełnego przetestowania całej aplikacji oraz całkowitego ponownego wdrożenia wszystkich wystąpień.</span><span class="sxs-lookup"><span data-stu-id="32e2c-294">In addition to the "scale everything" problem, changes to a single component require complete retesting of the entire application, and a complete redeployment of all the instances.</span></span>

<span data-ttu-id="32e2c-295">Podejście monolityczne jest wspólne, a wiele organizacji opracowuje w ramach tego podejścia do architektury.</span><span class="sxs-lookup"><span data-stu-id="32e2c-295">The monolithic approach is common, and many organizations are developing with this architectural approach.</span></span> <span data-ttu-id="32e2c-296">Wiele z nich ma wystarczającą ilość wyników, a inne to limity.</span><span class="sxs-lookup"><span data-stu-id="32e2c-296">Many are having good enough results, while others are hitting limits.</span></span> <span data-ttu-id="32e2c-297">Wiele zaprojektowanych aplikacji w tym modelu, ponieważ narzędzia i infrastruktura były zbyt trudne do budowania architektury zorientowanej na usługi (SOA) i nie widzą potrzeb, dopóki aplikacja nie przezwiększyła się.</span><span class="sxs-lookup"><span data-stu-id="32e2c-297">Many designed their applications in this model, because the tools and infrastructure were too difficult to build service-oriented architectures (SOA), and they didn't see the need until the app grew.</span></span> <span data-ttu-id="32e2c-298">Jeśli okaże się, że zbliżasz się do ograniczeń podejścia monolitycznego, Podziel aplikację, aby umożliwić jej lepsze wykorzystanie kontenerów i mikrousług.</span><span class="sxs-lookup"><span data-stu-id="32e2c-298">If you find you're hitting the limits of the monolithic approach, breaking up the app to enable it to better leverage containers and microservices may be the next logical step.</span></span>

![Rysunek 5-14](./media/image5-14.png)

<span data-ttu-id="32e2c-300">Wdrażanie aplikacji monolitycznych w Microsoft Azure można osiągnąć przy użyciu dedykowanych maszyn wirtualnych dla każdego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="32e2c-300">Deploying monolithic applications in Microsoft Azure can be achieved using dedicated VMs for each instance.</span></span> <span data-ttu-id="32e2c-301">Za pomocą [usługi Azure Virtual Machine Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/)można łatwo skalować maszyny wirtualne.</span><span class="sxs-lookup"><span data-stu-id="32e2c-301">Using [Azure Virtual Machine Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), you can easily scale the VMs.</span></span> <span data-ttu-id="32e2c-302">[Usługa Azure App Services](https://azure.microsoft.com/services/app-service/) może uruchamiać aplikacje monolityczne i łatwo skalować wystąpienia bez potrzeby zarządzania maszynami wirtualnymi.</span><span class="sxs-lookup"><span data-stu-id="32e2c-302">[Azure App Services](https://azure.microsoft.com/services/app-service/) can run monolithic applications and easily scale instances without having to manage the VMs.</span></span> <span data-ttu-id="32e2c-303">Usługa Azure App Services może również uruchamiać pojedyncze wystąpienia kontenerów platformy Docker, upraszczając wdrażanie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-303">Azure App Services can run single instances of Docker containers as well, simplifying the deployment.</span></span> <span data-ttu-id="32e2c-304">Przy użyciu platformy Docker można wdrożyć pojedynczą maszynę wirtualną jako hosta platformy Docker i uruchamiać wiele wystąpień.</span><span class="sxs-lookup"><span data-stu-id="32e2c-304">Using Docker, you can deploy a single VM as a Docker host, and run multiple instances.</span></span> <span data-ttu-id="32e2c-305">Korzystając z modułu równoważenia obciążenia platformy Azure, jak pokazano na rysunku 5-14, można zarządzać skalowaniem.</span><span class="sxs-lookup"><span data-stu-id="32e2c-305">Using the Azure balancer, as shown in the Figure 5-14, you can manage scaling.</span></span>

<span data-ttu-id="32e2c-306">Wdrożenie na różnych hostach może być zarządzane przy użyciu tradycyjnych technik wdrażania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-306">The deployment to the various hosts can be managed with traditional deployment techniques.</span></span> <span data-ttu-id="32e2c-307">Hosty platformy Docker mogą być zarządzane za pomocą poleceń, takich jak **uruchomienie platformy Docker** , wykonywane ręcznie lub za pomocą automatyzacji, takich jak potoki ciągłego dostarczania (CD).</span><span class="sxs-lookup"><span data-stu-id="32e2c-307">The Docker hosts can be managed with commands like **docker run** performed manually, or through automation such as Continuous Delivery (CD) pipelines.</span></span>

### <a name="monolithic-application-deployed-as-a-container"></a><span data-ttu-id="32e2c-308">Aplikacja monolityczna wdrożona jako kontener</span><span class="sxs-lookup"><span data-stu-id="32e2c-308">Monolithic application deployed as a container</span></span>

<span data-ttu-id="32e2c-309">Istnieją zalety używania kontenerów do zarządzania wdrożeniami aplikacji monolitycznych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-309">There are benefits of using containers to manage monolithic application deployments.</span></span> <span data-ttu-id="32e2c-310">Skalowanie wystąpień kontenerów jest znacznie szybsze i łatwiejsze niż wdrażanie dodatkowych maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-310">Scaling the instances of containers is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="32e2c-311">Nawet w przypadku używania zestawów skalowania maszyn wirtualnych do skalowania maszyn wirtualnych trwają one czas.</span><span class="sxs-lookup"><span data-stu-id="32e2c-311">Even when using virtual machine scale sets to scale VMs, they take time to instance.</span></span> <span data-ttu-id="32e2c-312">W przypadku wdrożenia jako wystąpienia aplikacji Konfiguracja aplikacji jest zarządzana w ramach maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-312">When deployed as app instances, the configuration of the app is managed as part of the VM.</span></span>

<span data-ttu-id="32e2c-313">Wdrażanie aktualizacji jako obrazów platformy Docker odbywa się znacznie szybciej i wydajniej.</span><span class="sxs-lookup"><span data-stu-id="32e2c-313">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="32e2c-314">Obrazy platformy Docker zwykle zaczynają się w ciągu sekund, co przyspiesza wprowadzanie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-314">Docker Images typically start in seconds, speeding rollouts.</span></span> <span data-ttu-id="32e2c-315">Przerywanie wystąpienia platformy Docker jest tak proste jak wydawanie `docker stop` polecenia, zwykle kończącego się w mniej niż drugim.</span><span class="sxs-lookup"><span data-stu-id="32e2c-315">Tearing down a Docker instance is as easy as issuing a `docker stop` command, typically completing in less than a second.</span></span>

<span data-ttu-id="32e2c-316">Ponieważ kontenery są z natury niezmienne przez zaprojektowanie, nigdy nie trzeba martwić się o uszkodzone maszyny wirtualne, natomiast skrypty aktualizacji mogą ulec zapomnieć na potrzeby konkretnej konfiguracji lub pliku pozostawionego na dysku.</span><span class="sxs-lookup"><span data-stu-id="32e2c-316">As containers are inherently immutable by design, you never need to worry about corrupted VMs, whereas update scripts might forget to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="32e2c-317">Kontenerów platformy Docker można używać do monolitycznego wdrażania prostszych aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="32e2c-317">You can use Docker containers for monolithic deployment of simpler web applications.</span></span> <span data-ttu-id="32e2c-318">Pozwala to zwiększyć ciągłą integrację i ciągłe wdrażanie potoków oraz zapewnić pomyślne wdrożenie do produkcji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-318">This improves continuous integration and continuous deployment pipelines and helps achieve deployment-to-production success.</span></span> <span data-ttu-id="32e2c-319">Nie ma więcej "działa w mojej maszynie, dlaczego nie działa w środowisku produkcyjnym?"</span><span class="sxs-lookup"><span data-stu-id="32e2c-319">No more “It works in my machine, why does it not work in production?”</span></span>

<span data-ttu-id="32e2c-320">Architektura oparta na mikrousługach ma wiele korzyści, ale te korzyści mają na celu zwiększenie złożoności.</span><span class="sxs-lookup"><span data-stu-id="32e2c-320">A microservices-based architecture has many benefits, but those benefits come at a cost of increased complexity.</span></span> <span data-ttu-id="32e2c-321">W niektórych przypadkach koszty te zwiększają korzyści, więc jest to lepsza aplikacja do wdrożenia działająca w jednym kontenerze lub w zaledwie kilku kontenerach.</span><span class="sxs-lookup"><span data-stu-id="32e2c-321">In some cases, the costs outweigh the benefits, so a monolithic deployment application running in a single container or in just a few containers is a better option.</span></span>

<span data-ttu-id="32e2c-322">Aplikacja monolityczna może nie być łatwo można jej przetworzyć w dobrze rozdzielonych mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="32e2c-322">A monolithic application might not be easily decomposable into well-separated microservices.</span></span> <span data-ttu-id="32e2c-323">Mikrousługi powinny działać niezależnie od siebie, aby zapewnić bardziej odporną aplikację.</span><span class="sxs-lookup"><span data-stu-id="32e2c-323">Microservices should work independently of each other to provide a more resilient application.</span></span> <span data-ttu-id="32e2c-324">Jeśli nie można dostarczyć niezależnych wycinków funkcji aplikacji, oddzielenie go tylko zwiększa złożoność.</span><span class="sxs-lookup"><span data-stu-id="32e2c-324">If you can't deliver independent feature slices of the application, separating it only adds complexity.</span></span>

<span data-ttu-id="32e2c-325">Aplikacja może jeszcze nie mieć możliwości skalowania funkcji niezależnie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-325">An application might not yet need to scale features independently.</span></span> <span data-ttu-id="32e2c-326">Wiele aplikacji, gdy wymagają skalowania poza pojedynczym wystąpieniem, może to zrobić za pomocą stosunkowo prostego procesu klonowania całego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="32e2c-326">Many applications, when they need to scale beyond a single instance, can do so through the relatively simple process of cloning that entire instance.</span></span> <span data-ttu-id="32e2c-327">Dodatkowa część pracy w celu rozdzielenia aplikacji na osobne usługi zapewnia minimalną korzyść, gdy skalowanie pełnych wystąpień aplikacji jest proste i ekonomiczne.</span><span class="sxs-lookup"><span data-stu-id="32e2c-327">The additional work to separate the application into discrete services provides minimal benefit when scaling full instances of the application is simple and cost-effective.</span></span>

<span data-ttu-id="32e2c-328">Na wczesnym etapie opracowywania aplikacji może nie mieć jasnego pomysłu, w którym naturalne granice funkcjonalności są.</span><span class="sxs-lookup"><span data-stu-id="32e2c-328">Early in the development of an application, you might not have a clear idea where the natural functional boundaries are.</span></span> <span data-ttu-id="32e2c-329">Podczas opracowywania minimalnego produktu, którego oddzielenie prawdopodobnie nie zostało jeszcze wykonane.</span><span class="sxs-lookup"><span data-stu-id="32e2c-329">As you develop a minimum viable product, the natural separation might not yet have emerged.</span></span> <span data-ttu-id="32e2c-330">Niektóre z tych warunków mogą być tymczasowe.</span><span class="sxs-lookup"><span data-stu-id="32e2c-330">Some of these conditions might be temporary.</span></span> <span data-ttu-id="32e2c-331">Można zacząć od utworzenia aplikacji monolitycznej i późniejszego oddzielenia niektórych funkcji, które mają być opracowane i wdrożone jako mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="32e2c-331">You might start by creating a monolithic application, and later separate some features to be developed and deployed as microservices.</span></span> <span data-ttu-id="32e2c-332">Inne warunki mogą być niezbędne w przypadku problemów z aplikacją, co oznacza, że aplikacja może nigdy nie być uszkodzona w wielu mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="32e2c-332">Other conditions might be essential to the application’s problem space, meaning that the application might never be broken into multiple microservices.</span></span>

<span data-ttu-id="32e2c-333">Rozdzielenie aplikacji na wiele procesów dyskretnych powoduje również zwiększenie nakładu pracy.</span><span class="sxs-lookup"><span data-stu-id="32e2c-333">Separating an application into many discrete processes also introduces overhead.</span></span> <span data-ttu-id="32e2c-334">Istnieje większa złożoność oddzielająca funkcje do różnych procesów.</span><span class="sxs-lookup"><span data-stu-id="32e2c-334">There's more complexity in separating features into different processes.</span></span> <span data-ttu-id="32e2c-335">Protokoły komunikacyjne stają się bardziej skomplikowane.</span><span class="sxs-lookup"><span data-stu-id="32e2c-335">The communication protocols become more complex.</span></span> <span data-ttu-id="32e2c-336">Zamiast wywołań metod, należy używać komunikacji asynchronicznej między usługami.</span><span class="sxs-lookup"><span data-stu-id="32e2c-336">Instead of method calls, you must use asynchronous communications between services.</span></span> <span data-ttu-id="32e2c-337">Podczas przechodzenia do architektury mikrousług należy dodać wiele bloków konstrukcyjnych zaimplementowanych w wersji mikrousług aplikacji eShopOnContainers: obsługa magistrali zdarzeń, odporność na wiadomości i ponawianie prób, spójność ostateczna i inne.</span><span class="sxs-lookup"><span data-stu-id="32e2c-337">As you move to a microservices architecture, you need to add many of the building blocks implemented in the microservices version of the eShopOnContainers application: event bus handling, message resiliency and retries, eventual consistency, and more.</span></span>

<span data-ttu-id="32e2c-338">Znacznie prostsze [aplikacje referencyjne eShopOnWeb](https://github.com/dotnet-architecture/eShopOnWeb) obsługują użycie kontenerów monolitycznych jednego kontenera.</span><span class="sxs-lookup"><span data-stu-id="32e2c-338">The much simpler [eShopOnWeb reference application](https://github.com/dotnet-architecture/eShopOnWeb) supports single-container monolithic container usage.</span></span> <span data-ttu-id="32e2c-339">Aplikacja zawiera jedną aplikację sieci Web, która zawiera tradycyjne widoki MVC, interfejsy API sieci Web i Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="32e2c-339">The application includes one web application that includes traditional MVC views, web APIs, and Razor Pages.</span></span> <span data-ttu-id="32e2c-340">Ta aplikacja może być uruchamiana z poziomu głównego rozwiązania przy `docker-compose build` użyciu `docker-compose up` poleceń i.</span><span class="sxs-lookup"><span data-stu-id="32e2c-340">This application can be launched from the solution root using the `docker-compose build` and `docker-compose up` commands.</span></span> <span data-ttu-id="32e2c-341">To polecenie umożliwia skonfigurowanie kontenera dla wystąpienia sieci Web przy użyciu `Dockerfile` znalezionego w katalogu głównym projektu sieci Web i uruchomienie kontenera na określonym porcie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-341">This command configures a container for the web instance, using the `Dockerfile` found in the web project's root, and runs the container on a specified port.</span></span> <span data-ttu-id="32e2c-342">Możesz pobrać źródło dla tej aplikacji z usługi GitHub i uruchomić ją lokalnie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-342">You can download the source for this application from GitHub and run it locally.</span></span> <span data-ttu-id="32e2c-343">Nawet ta monolityczna aplikacja nie będzie wdrażana w środowisku kontenera.</span><span class="sxs-lookup"><span data-stu-id="32e2c-343">Even this monolithic application benefits from being deployed in a container environment.</span></span>

<span data-ttu-id="32e2c-344">W przypadku jednego z kontenerów wdrożenie to oznacza, że każde wystąpienie aplikacji działa w tym samym środowisku.</span><span class="sxs-lookup"><span data-stu-id="32e2c-344">For one, the containerized deployment means that every instance of the application runs in the same environment.</span></span> <span data-ttu-id="32e2c-345">Obejmuje to środowisko deweloperskie, w którym odbywa się wczesne testowanie i programowanie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-345">This includes the developer environment where early testing and development take place.</span></span> <span data-ttu-id="32e2c-346">Zespół programistyczny może uruchomić aplikację w środowisku kontenerów, które pasuje do środowiska produkcyjnego.</span><span class="sxs-lookup"><span data-stu-id="32e2c-346">The development team can run the application in a containerized environment that matches the production environment.</span></span>

<span data-ttu-id="32e2c-347">Ponadto aplikacje kontenera są skalowane przy niższych kosztach.</span><span class="sxs-lookup"><span data-stu-id="32e2c-347">In addition, containerized applications scale out at lower cost.</span></span> <span data-ttu-id="32e2c-348">Użycie środowiska kontenera pozwala zwiększyć udostępnianie zasobów niż tradycyjne środowiska maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-348">Using a container environment enables greater resource sharing than traditional VM environments.</span></span>

<span data-ttu-id="32e2c-349">Na koniec konteneryzowania aplikacja wymusza rozdzielenie między logiką biznesową a serwerem magazynu.</span><span class="sxs-lookup"><span data-stu-id="32e2c-349">Finally, containerizing the application forces a separation between the business logic and the storage server.</span></span> <span data-ttu-id="32e2c-350">W miarę skalowania aplikacji, wiele kontenerów będzie polegać na jednym fizycznym nośniku magazynowania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-350">As the application scales out, the multiple containers will all rely on a single physical storage medium.</span></span> <span data-ttu-id="32e2c-351">Ten nośnik magazynu zazwyczaj jest serwerem o wysokiej dostępności z uruchomioną SQL Server bazą danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-351">This storage medium would typically be a high-availability server running a SQL Server database.</span></span>

## <a name="docker-support"></a><span data-ttu-id="32e2c-352">Obsługa platformy Docker</span><span class="sxs-lookup"><span data-stu-id="32e2c-352">Docker support</span></span>

<span data-ttu-id="32e2c-353">`eShopOnWeb` Projekt jest uruchamiany na platformie .NET Core.</span><span class="sxs-lookup"><span data-stu-id="32e2c-353">The `eShopOnWeb` project runs on .NET Core.</span></span> <span data-ttu-id="32e2c-354">W związku z tym może działać w kontenerach opartych na systemie Linux lub Windows.</span><span class="sxs-lookup"><span data-stu-id="32e2c-354">Therefore, it can run in either Linux-based or Windows-based containers.</span></span> <span data-ttu-id="32e2c-355">Należy pamiętać, że w przypadku wdrożenia platformy Docker chcesz użyć tego samego typu hosta dla SQL Server.</span><span class="sxs-lookup"><span data-stu-id="32e2c-355">Note that for Docker deployment, you want to use the same host type for SQL Server.</span></span> <span data-ttu-id="32e2c-356">Kontenery oparte na systemie Linux umożliwiają mniejsze rozmiary i są preferowane.</span><span class="sxs-lookup"><span data-stu-id="32e2c-356">Linux-based containers allow a smaller footprint and are preferred.</span></span>

<span data-ttu-id="32e2c-357">Aby dodać obsługę platformy Docker do istniejącej aplikacji, można użyć programu Visual Studio 2017 lub nowszego, klikając prawym przyciskiem myszy projekt w **Eksplorator rozwiązań** i wybierając polecenie **Dodaj** > **obsługę platformy Docker**.</span><span class="sxs-lookup"><span data-stu-id="32e2c-357">You can use Visual Studio 2017 or later to add Docker support to an existing application by right-clicking on a project in **Solution Explorer** and choosing **Add** > **Docker Support**.</span></span> <span data-ttu-id="32e2c-358">Spowoduje to dodanie plików wymaganych i zmodyfikowanie projektu w celu ich użycia.</span><span class="sxs-lookup"><span data-stu-id="32e2c-358">This adds the files required and modifies the project to use them.</span></span> <span data-ttu-id="32e2c-359">Bieżący `eShopOnWeb` przykład ma już te pliki.</span><span class="sxs-lookup"><span data-stu-id="32e2c-359">The current `eShopOnWeb` sample already has these files in place.</span></span>

<span data-ttu-id="32e2c-360">Plik poziomu `docker-compose.yml` rozwiązania zawiera informacje o obrazach do skompilowania oraz o kontenerach do uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="32e2c-360">The solution-level `docker-compose.yml` file contains information about what images to build and what containers to launch.</span></span> <span data-ttu-id="32e2c-361">Plik umożliwia używanie `docker-compose` polecenia do uruchamiania wielu aplikacji w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="32e2c-361">The file allows you to use the `docker-compose` command to launch multiple applications at the same time.</span></span> <span data-ttu-id="32e2c-362">W tym przypadku uruchamia tylko projekt sieci Web.</span><span class="sxs-lookup"><span data-stu-id="32e2c-362">In this case, it is only launching the Web project.</span></span> <span data-ttu-id="32e2c-363">Można go również użyć do skonfigurowania zależności, takich jak oddzielny kontener bazy danych.</span><span class="sxs-lookup"><span data-stu-id="32e2c-363">You can also use it to configure dependencies, such as a separate database container.</span></span>

```yml
version: '3'

services:
  eshopwebmvc:
    image: eshopwebmvc
    build:
      context: .
      dockerfile: src/Web/Dockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
    ports:
      - "5106:5106"

networks:
  default:
    external:
      name: nat
```

<span data-ttu-id="32e2c-364">Plik odwołuje `Dockerfile` się`Web`doprojektu. `docker-compose.yml`</span><span class="sxs-lookup"><span data-stu-id="32e2c-364">The `docker-compose.yml` file references the `Dockerfile` in the `Web` project.</span></span> <span data-ttu-id="32e2c-365">`Dockerfile` Służy do określenia, który kontener bazowy będzie używany, oraz sposobu ich konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="32e2c-365">The `Dockerfile` is used to specify which base container will be used and how the application will be configured on it.</span></span> <span data-ttu-id="32e2c-366">`Web`" :`Dockerfile`</span><span class="sxs-lookup"><span data-stu-id="32e2c-366">The `Web`' `Dockerfile`:</span></span>

```Dockerfile
FROM mcr.microsoft.com/dotnet/core/sdk:2.2 AS build
WORKDIR /app

COPY *.sln .
COPY . .
WORKDIR /app/src/Web
RUN dotnet restore

RUN dotnet publish -c Release -o out

FROM mcr.microsoft.com/dotnet/core/aspnet:2.2 AS runtime
WORKDIR /app
COPY --from=build /app/src/Web/out ./

# Optional: Set this here if not setting it from docker-compose.yml
# ENV ASPNETCORE_ENVIRONMENT Development

ENTRYPOINT ["dotnet", "Web.dll"]
```

### <a name="troubleshooting-docker-problems"></a><span data-ttu-id="32e2c-367">Rozwiązywanie problemów z platformą Docker</span><span class="sxs-lookup"><span data-stu-id="32e2c-367">Troubleshooting Docker problems</span></span>

<span data-ttu-id="32e2c-368">Po uruchomieniu aplikacji kontenera nadal będzie ona działać do momentu jej zatrzymania.</span><span class="sxs-lookup"><span data-stu-id="32e2c-368">Once you run the containerized application, it continues to run until you stop it.</span></span> <span data-ttu-id="32e2c-369">Możesz zobaczyć, które kontenery są uruchomione przy `docker ps` użyciu polecenia.</span><span class="sxs-lookup"><span data-stu-id="32e2c-369">You can view which containers are running with the `docker ps` command.</span></span> <span data-ttu-id="32e2c-370">Można zatrzymać uruchomiony kontener przy użyciu `docker stop` polecenia i określając identyfikator kontenera.</span><span class="sxs-lookup"><span data-stu-id="32e2c-370">You can stop a running container by using the `docker stop` command and specifying the container ID.</span></span>

<span data-ttu-id="32e2c-371">Należy pamiętać, że uruchomione kontenery platformy Docker mogą być powiązane z portami, z których możesz próbować korzystać w środowisku deweloperskim.</span><span class="sxs-lookup"><span data-stu-id="32e2c-371">Note that running Docker containers may be bound to ports you might otherwise try to use in your development environment.</span></span> <span data-ttu-id="32e2c-372">W przypadku próby uruchomienia lub debugowania aplikacji przy użyciu tego samego portu co uruchomiony kontener platformy Docker zostanie wyświetlony komunikat o błędzie informujący o tym, że serwer nie może powiązać z tym portem.</span><span class="sxs-lookup"><span data-stu-id="32e2c-372">If you try to run or debug an application using the same port as a running Docker container, you'll get an error stating that the server can't bind to that port.</span></span> <span data-ttu-id="32e2c-373">Po ponownym zatrzymywaniu kontenera należy rozwiązać ten problem.</span><span class="sxs-lookup"><span data-stu-id="32e2c-373">Once again, stopping the container should resolve the issue.</span></span>

<span data-ttu-id="32e2c-374">Jeśli chcesz dodać obsługę platformy Docker do aplikacji przy użyciu programu Visual Studio, upewnij się, że program Docker Desktop jest uruchomiony, gdy to zrobisz.</span><span class="sxs-lookup"><span data-stu-id="32e2c-374">If you want to add Docker support to your application using Visual Studio, make sure Docker Desktop is running when you do so.</span></span> <span data-ttu-id="32e2c-375">Kreator nie będzie działać prawidłowo, jeśli program Docker Desktop nie zostanie uruchomiony po uruchomieniu kreatora.</span><span class="sxs-lookup"><span data-stu-id="32e2c-375">The wizard won't run correctly if Docker Desktop isn't running when you start the wizard.</span></span> <span data-ttu-id="32e2c-376">Ponadto Kreator sprawdza bieżący kontener, aby dodać poprawną obsługę platformy Docker.</span><span class="sxs-lookup"><span data-stu-id="32e2c-376">In addition, the wizard examines your current container choice to add the correct Docker support.</span></span> <span data-ttu-id="32e2c-377">Jeśli chcesz dodać obsługę kontenerów systemu Windows, musisz uruchomić kreatora, gdy pulpit platformy Docker jest uruchomiony z skonfigurowanymi kontenerami systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="32e2c-377">If you want to add support for Windows Containers, you need to run the wizard while you have Docker Desktop running with Windows Containers configured.</span></span> <span data-ttu-id="32e2c-378">Jeśli chcesz dodać obsługę kontenerów systemu Linux, uruchom kreatora, gdy zainstalowano Aparat Docker z skonfigurowanymi kontenerami systemu Linux.</span><span class="sxs-lookup"><span data-stu-id="32e2c-378">If you want to add support for Linux containers, run the wizard while you have Docker running with Linux containers configured.</span></span>

### <a name="references--common-web-architectures"></a><span data-ttu-id="32e2c-379">Odwołania — wspólne architektury sieci Web</span><span class="sxs-lookup"><span data-stu-id="32e2c-379">References – Common web architectures</span></span>

- <span data-ttu-id="32e2c-380">**Czysta architektura**</span><span class="sxs-lookup"><span data-stu-id="32e2c-380">**The Clean Architecture**</span></span>  
  <https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html>
- <span data-ttu-id="32e2c-381">**Architektura cebuli**</span><span class="sxs-lookup"><span data-stu-id="32e2c-381">**The Onion Architecture**</span></span>  
  <https://jeffreypalermo.com/blog/the-onion-architecture-part-1/>
- <span data-ttu-id="32e2c-382">**Wzorzec repozytorium**</span><span class="sxs-lookup"><span data-stu-id="32e2c-382">**The Repository Pattern**</span></span>  
  <https://deviq.com/repository-pattern/>
- <span data-ttu-id="32e2c-383">**Przykład czystego rozwiązania architektury**</span><span class="sxs-lookup"><span data-stu-id="32e2c-383">**Clean Architecture Solution Sample**</span></span>  
  <https://github.com/ardalis/cleanarchitecture>
- <span data-ttu-id="32e2c-384">**Tworzenie architektury książki elektronicznej mikrousług**</span><span class="sxs-lookup"><span data-stu-id="32e2c-384">**Architecting Microservices e-book**</span></span>  
  <https://aka.ms/MicroservicesEbook>

>[!div class="step-by-step"]
><span data-ttu-id="32e2c-385">[Poprzedni](architectural-principles.md)
>[Następny](common-client-side-web-technologies.md)</span><span class="sxs-lookup"><span data-stu-id="32e2c-385">[Previous](architectural-principles.md)
[Next](common-client-side-web-technologies.md)</span></span>
