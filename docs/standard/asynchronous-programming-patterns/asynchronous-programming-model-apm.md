---
title: Model programowania asynchronicznego (APM)
description: Dowiedz się więcej o modelu programowania asynchronicznego (APM) w programie .NET. Dowiedz się, jak rozpocząć i zakończyć operację asynchroniczną.
ms.date: 03/30/2017
helpviewer_keywords:
- ending asynchronous operations
- starting asynchronous operations
- beginning asynchronous operations
- asynchronous programming, ending operations
- asynchronous programming
- stopping asynchronous operations
- asynchronous programming, beginning operations
ms.assetid: c9b3501e-6bc6-40f9-8efd-4b6d9e39ccf0
ms.openlocfilehash: 7b976cf48214fb623563b09aab8a991a5a05d3ca
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/18/2020
ms.locfileid: "94824444"
---
# <a name="asynchronous-programming-model-apm"></a><span data-ttu-id="0a2f7-104">Model programowania asynchronicznego (APM)</span><span class="sxs-lookup"><span data-stu-id="0a2f7-104">Asynchronous Programming Model (APM)</span></span>
<span data-ttu-id="0a2f7-105">Asynchroniczna operacja, która używa <xref:System.IAsyncResult> wzorca projektowego, jest implementowana jako dwie metody o nazwie `BeginOperationName` i `EndOperationName` , która rozpoczyna i kończy odpowiednio *operację* asynchroniczną.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-105">An asynchronous operation that uses the <xref:System.IAsyncResult> design pattern is implemented as two methods named `BeginOperationName` and `EndOperationName` that begin and end the asynchronous operation *OperationName* respectively.</span></span> <span data-ttu-id="0a2f7-106">Na przykład <xref:System.IO.FileStream> Klasa zawiera <xref:System.IO.FileStream.BeginRead%2A> metody i, <xref:System.IO.FileStream.EndRead%2A> Aby asynchronicznie odczytywać bajty z pliku.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-106">For example, the <xref:System.IO.FileStream> class provides the <xref:System.IO.FileStream.BeginRead%2A> and <xref:System.IO.FileStream.EndRead%2A> methods to asynchronously read bytes from a file.</span></span> <span data-ttu-id="0a2f7-107">Te metody implementują wersję asynchroniczną <xref:System.IO.FileStream.Read%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-107">These methods implement the asynchronous version of the <xref:System.IO.FileStream.Read%2A> method.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0a2f7-108">Począwszy od .NET Framework 4, Biblioteka zadań równoległych udostępnia nowy model dla programowania asynchronicznego i równoległego.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-108">Starting with the .NET Framework 4, the Task Parallel Library provides a new model for asynchronous and parallel programming.</span></span> <span data-ttu-id="0a2f7-109">Aby uzyskać więcej informacji, zobacz [Biblioteka zadań równoległych (TPL)](../parallel-programming/task-parallel-library-tpl.md) i [wzorzec asynchroniczny oparty na zadaniach (TAP)](task-based-asynchronous-pattern-tap.md)).</span><span class="sxs-lookup"><span data-stu-id="0a2f7-109">For more information, see [Task Parallel Library (TPL)](../parallel-programming/task-parallel-library-tpl.md) and [Task-based Asynchronous Pattern (TAP)](task-based-asynchronous-pattern-tap.md)).</span></span>  
  
 <span data-ttu-id="0a2f7-110">Po wywołaniu `BeginOperationName` aplikacja może kontynuować wykonywanie instrukcji w wątku wywołującym, gdy operacja asynchroniczna odbywa się w innym wątku.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-110">After calling `BeginOperationName`, an application can continue executing instructions on the calling thread while the asynchronous operation takes place on a different thread.</span></span> <span data-ttu-id="0a2f7-111">Dla każdego wywołania do `BeginOperationName` , aplikacja powinna również wywołać, `EndOperationName` Aby uzyskać wyniki operacji.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-111">For each call to `BeginOperationName`, the application should also call `EndOperationName` to get the results of the operation.</span></span>  
  
## <a name="beginning-an-asynchronous-operation"></a><span data-ttu-id="0a2f7-112">Rozpoczynanie operacji asynchronicznej</span><span class="sxs-lookup"><span data-stu-id="0a2f7-112">Beginning an Asynchronous Operation</span></span>  
 <span data-ttu-id="0a2f7-113">`BeginOperationName`Metoda rozpoczyna *wykonywanie operacji* asynchronicznej i zwraca obiekt, który implementuje <xref:System.IAsyncResult> interfejs.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-113">The `BeginOperationName` method begins asynchronous operation *OperationName* and returns an object that implements the <xref:System.IAsyncResult> interface.</span></span> <span data-ttu-id="0a2f7-114"><xref:System.IAsyncResult> obiekty przechowują informacje o operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-114"><xref:System.IAsyncResult> objects store information about an asynchronous operation.</span></span> <span data-ttu-id="0a2f7-115">W poniższej tabeli przedstawiono informacje na temat operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-115">The following table shows information about an asynchronous operation.</span></span>  
  
|<span data-ttu-id="0a2f7-116">Członek</span><span class="sxs-lookup"><span data-stu-id="0a2f7-116">Member</span></span>|<span data-ttu-id="0a2f7-117">Opis</span><span class="sxs-lookup"><span data-stu-id="0a2f7-117">Description</span></span>|  
|------------|-----------------|  
|<xref:System.IAsyncResult.AsyncState%2A>|<span data-ttu-id="0a2f7-118">Opcjonalny obiekt specyficzny dla aplikacji, który zawiera informacje o operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-118">An optional application-specific object that contains information about the asynchronous operation.</span></span>|  
|<xref:System.IAsyncResult.AsyncWaitHandle%2A>|<span data-ttu-id="0a2f7-119"><xref:System.Threading.WaitHandle>, Który może służyć do blokowania wykonywania aplikacji do momentu zakończenia operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-119">A <xref:System.Threading.WaitHandle> that can be used to block application execution until the asynchronous operation completes.</span></span>|  
|<xref:System.IAsyncResult.CompletedSynchronously%2A>|<span data-ttu-id="0a2f7-120">Wartość wskazująca, czy operacja asynchroniczna została zakończona na wątku używanym do wywoływania `BeginOperationName` zamiast wykonywania w osobnym <xref:System.Threading.ThreadPool> wątku.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-120">A value that indicates whether the asynchronous operation completed on the thread used to call `BeginOperationName` instead of completing on a separate <xref:System.Threading.ThreadPool> thread.</span></span>|  
|<xref:System.IAsyncResult.IsCompleted%2A>|<span data-ttu-id="0a2f7-121">Wartość wskazująca, czy operacja asynchroniczna została ukończona.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-121">A value that indicates whether the asynchronous operation has completed.</span></span>|  
  
 <span data-ttu-id="0a2f7-122">`BeginOperationName`Metoda przyjmuje wszystkie parametry zadeklarowane w sygnaturze synchronicznej wersji metody, która jest przenoszona przez wartość lub przez odwołanie.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-122">A `BeginOperationName` method takes any parameters declared in the signature of the synchronous version of the method that are passed by value or by reference.</span></span> <span data-ttu-id="0a2f7-123">Wszystkie parametry out nie są częścią `BeginOperationName` sygnatury metody.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-123">Any out parameters are not part of the `BeginOperationName` method signature.</span></span> <span data-ttu-id="0a2f7-124">`BeginOperationName`Sygnatura metody również zawiera dwa dodatkowe parametry.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-124">The `BeginOperationName` method signature also includes two additional parameters.</span></span> <span data-ttu-id="0a2f7-125">Pierwszy z nich definiuje <xref:System.AsyncCallback> delegata, który odwołuje się do metody, która jest wywoływana po zakończeniu operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-125">The first of these defines an <xref:System.AsyncCallback> delegate that references a method that is called when the asynchronous operation completes.</span></span> <span data-ttu-id="0a2f7-126">Obiekt wywołujący może określić `null` ( `Nothing` w Visual Basic), jeśli nie ma metody wywoływanej po zakończeniu operacji.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-126">The caller can specify `null` (`Nothing` in Visual Basic) if it does not want a method invoked when the operation completes.</span></span> <span data-ttu-id="0a2f7-127">Drugi dodatkowy parametr jest obiektem zdefiniowanym przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-127">The second additional parameter is a user-defined object.</span></span> <span data-ttu-id="0a2f7-128">Ten obiekt może służyć do przekazywania informacji o stanie specyficznym dla aplikacji do metody wywoływanej po zakończeniu operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-128">This object can be used to pass application-specific state information to the method invoked when the asynchronous operation completes.</span></span> <span data-ttu-id="0a2f7-129">Jeśli `BeginOperationName` Metoda przyjmuje dodatkowe parametry specyficzne dla operacji, takie jak tablica bajtowa do przechowywania bajtów odczytanych z pliku, <xref:System.AsyncCallback> obiekt stanu aplikacji jest ostatnim parametrem w `BeginOperationName` podpisie metody.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-129">If a `BeginOperationName` method takes additional operation-specific parameters, such as a byte array to store bytes read from a file, the <xref:System.AsyncCallback> and application state object are the last parameters in the `BeginOperationName` method signature.</span></span>  
  
 <span data-ttu-id="0a2f7-130">`BeginOperationName` zwraca bezpośrednio formant do wywołującego wątku.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-130">`BeginOperationName` returns control to the calling thread immediately.</span></span> <span data-ttu-id="0a2f7-131">Jeśli `BeginOperationName` Metoda zgłasza wyjątki, wyjątki są zgłaszane przed rozpoczęciem operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-131">If the `BeginOperationName` method throws exceptions, the exceptions are thrown before the asynchronous operation is started.</span></span> <span data-ttu-id="0a2f7-132">Jeśli `BeginOperationName` Metoda zgłasza wyjątki, metoda wywołania zwrotnego nie jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-132">If the `BeginOperationName` method throws exceptions, the callback method is not invoked.</span></span>  
  
## <a name="ending-an-asynchronous-operation"></a><span data-ttu-id="0a2f7-133">Kończenie operacji asynchronicznej</span><span class="sxs-lookup"><span data-stu-id="0a2f7-133">Ending an Asynchronous Operation</span></span>  
 <span data-ttu-id="0a2f7-134">`EndOperationName`Metoda spowoduje zakończenie operacji asynchronicznej. *OperationName*</span><span class="sxs-lookup"><span data-stu-id="0a2f7-134">The `EndOperationName` method ends asynchronous operation *OperationName*.</span></span> <span data-ttu-id="0a2f7-135">Wartość zwracana `EndOperationName` metody jest tego samego typu zwracanego przez jego odpowiednik synchroniczny i jest specyficzna dla operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-135">The return value of the `EndOperationName` method is the same type returned by its synchronous counterpart and is specific to the asynchronous operation.</span></span> <span data-ttu-id="0a2f7-136">Na przykład <xref:System.IO.FileStream.EndRead%2A> Metoda zwraca liczbę bajtów odczytanych z <xref:System.IO.FileStream> i, a <xref:System.Net.Dns.EndGetHostByName%2A> Metoda zwraca <xref:System.Net.IPHostEntry> obiekt, który zawiera informacje o komputerze hosta.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-136">For example, the <xref:System.IO.FileStream.EndRead%2A> method returns the number of bytes read from a <xref:System.IO.FileStream> and the <xref:System.Net.Dns.EndGetHostByName%2A> method returns an <xref:System.Net.IPHostEntry> object that contains information about a host computer.</span></span> <span data-ttu-id="0a2f7-137">`EndOperationName`Metoda przyjmuje wszystkie parametry out lub ref zadeklarowane w sygnaturze synchronicznej wersji metody.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-137">The `EndOperationName` method takes any out or ref parameters declared in the signature of the synchronous version of the method.</span></span> <span data-ttu-id="0a2f7-138">Oprócz parametrów z metody synchronicznej, `EndOperationName` Metoda zawiera również <xref:System.IAsyncResult> parametr.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-138">In addition to the parameters from the synchronous method, the `EndOperationName` method also includes an <xref:System.IAsyncResult> parameter.</span></span> <span data-ttu-id="0a2f7-139">Obiekty wywołujące muszą przekazać wystąpienie zwrócone przez odpowiednie wywołanie do `BeginOperationName` .</span><span class="sxs-lookup"><span data-stu-id="0a2f7-139">Callers must pass the instance returned by the corresponding call to `BeginOperationName`.</span></span>  
  
 <span data-ttu-id="0a2f7-140">Jeśli operacja asynchroniczna reprezentowana przez <xref:System.IAsyncResult> obiekt nie została ukończona `EndOperationName` , gdy jest wywoływana, `EndOperationName` blokuje wątek wywołujący do momentu ukończenia operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-140">If the asynchronous operation represented by the <xref:System.IAsyncResult> object has not completed when `EndOperationName` is called, `EndOperationName` blocks the calling thread until the asynchronous operation is complete.</span></span> <span data-ttu-id="0a2f7-141">Wyjątki zgłoszone przez operację asynchroniczną są generowane przez `EndOperationName` metodę.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-141">Exceptions thrown by the asynchronous operation are thrown from the `EndOperationName` method.</span></span> <span data-ttu-id="0a2f7-142">Efekt wywołania `EndOperationName` metody wiele razy z tą samą <xref:System.IAsyncResult> nie jest zdefiniowany.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-142">The effect of calling the `EndOperationName` method multiple times with the same <xref:System.IAsyncResult> is not defined.</span></span> <span data-ttu-id="0a2f7-143">Podobnie wywołanie `EndOperationName` metody z <xref:System.IAsyncResult> , która nie została zwrócona przez powiązaną metodę Begin, nie jest również zdefiniowane.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-143">Likewise, calling the `EndOperationName` method with an <xref:System.IAsyncResult> that was not returned by the related Begin method is also not defined.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0a2f7-144">Dla każdego z niezdefiniowanych scenariuszy implementujących należy rozważyć Przerzucanie <xref:System.InvalidOperationException> .</span><span class="sxs-lookup"><span data-stu-id="0a2f7-144">For either of the undefined scenarios, implementers should consider throwing <xref:System.InvalidOperationException>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0a2f7-145">Implementujący ten Wzorzec projektowy powinien poinformować wywołującego, że operacja asynchroniczna została zakończona przez ustawienie <xref:System.IAsyncResult.IsCompleted%2A> wartości true, wywołanie asynchronicznej metody wywołania zwrotnego (jeśli została określona) i sygnalizowanie <xref:System.IAsyncResult.AsyncWaitHandle%2A> .</span><span class="sxs-lookup"><span data-stu-id="0a2f7-145">Implementers of this design pattern should notify the caller that the asynchronous operation completed by setting <xref:System.IAsyncResult.IsCompleted%2A> to true, calling the asynchronous callback method (if one was specified) and signaling the <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span></span>  
  
 <span data-ttu-id="0a2f7-146">Deweloperzy aplikacji mają kilka opcji projektowania do uzyskiwania dostępu do wyników operacji asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-146">Application developers have several design choices for accessing the results of the asynchronous operation.</span></span> <span data-ttu-id="0a2f7-147">Prawidłowy wybór zależy od tego, czy aplikacja zawiera instrukcje, które mogą być wykonywane, gdy operacja zostanie ukończona.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-147">The correct choice depends on whether the application has instructions that can execute while the operation completes.</span></span> <span data-ttu-id="0a2f7-148">Jeśli aplikacja nie może wykonać żadnej dodatkowej pracy, dopóki nie odbierze wyników operacji asynchronicznej, aplikacja musi zablokować, dopóki wyniki nie będą dostępne.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-148">If an application cannot perform any additional work until it receives the results of the asynchronous operation, the application must block until the results are available.</span></span> <span data-ttu-id="0a2f7-149">Aby zablokować do momentu zakończenia operacji asynchronicznej, można użyć jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="0a2f7-149">To block until an asynchronous operation completes, you can use one of the following approaches:</span></span>  
  
- <span data-ttu-id="0a2f7-150">Wywołaj `EndOperationName` z głównego wątku aplikacji, blokując wykonywanie aplikacji do momentu ukończenia operacji.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-150">Call `EndOperationName` from the application’s main thread, blocking application execution until the operation is complete.</span></span> <span data-ttu-id="0a2f7-151">Przykład ilustrujący tę technikę można znaleźć w temacie [blokowanie wykonywania aplikacji przez zakończenie operacji asynchronicznej](blocking-application-execution-by-ending-an-async-operation.md).</span><span class="sxs-lookup"><span data-stu-id="0a2f7-151">For an example that illustrates this technique, see [Blocking Application Execution by Ending an Async Operation](blocking-application-execution-by-ending-an-async-operation.md).</span></span>  
  
- <span data-ttu-id="0a2f7-152">Użyj, <xref:System.IAsyncResult.AsyncWaitHandle%2A> Aby zablokować wykonywanie aplikacji, dopóki nie zostanie ukończona co najmniej jedna operacja.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-152">Use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> to block application execution until one or more operations are complete.</span></span> <span data-ttu-id="0a2f7-153">Przykład ilustrujący tę technikę można znaleźć w temacie [blokowanie wykonywania aplikacji przy użyciu AsyncWaitHandle](blocking-application-execution-using-an-asyncwaithandle.md).</span><span class="sxs-lookup"><span data-stu-id="0a2f7-153">For an example that illustrates this technique, see [Blocking Application Execution Using an AsyncWaitHandle](blocking-application-execution-using-an-asyncwaithandle.md).</span></span>  
  
 <span data-ttu-id="0a2f7-154">Aplikacje, które nie muszą blokować podczas kończenia operacji asynchronicznej, mogą korzystać z jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="0a2f7-154">Applications that do not need to block while the asynchronous operation completes can use one of the following approaches:</span></span>  
  
- <span data-ttu-id="0a2f7-155">Sondowanie stanu ukończenia operacji przez sprawdzenie <xref:System.IAsyncResult.IsCompleted%2A> Właściwości okresowo i wywołanie `EndOperationName` po zakończeniu operacji.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-155">Poll for operation completion status by checking the <xref:System.IAsyncResult.IsCompleted%2A> property periodically and calling `EndOperationName` when the operation is complete.</span></span> <span data-ttu-id="0a2f7-156">Przykład ilustrujący tę technikę można znaleźć w temacie [sondowanie stanu operacji asynchronicznej](polling-for-the-status-of-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="0a2f7-156">For an example that illustrates this technique, see [Polling for the Status of an Asynchronous Operation](polling-for-the-status-of-an-asynchronous-operation.md).</span></span>  
  
- <span data-ttu-id="0a2f7-157">Użyj <xref:System.AsyncCallback> delegata, aby określić metodę, która ma być wywoływana po zakończeniu operacji.</span><span class="sxs-lookup"><span data-stu-id="0a2f7-157">Use an <xref:System.AsyncCallback> delegate to specify a method to be invoked when the operation is complete.</span></span> <span data-ttu-id="0a2f7-158">Aby zapoznać się z przykładem, który ilustruje tę technikę, zobacz [Używanie delegata AsyncCallback do kończenia operacji asynchronicznej](using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="0a2f7-158">For an example that illustrates this technique, see [Using an AsyncCallback Delegate to End an Asynchronous Operation](using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0a2f7-159">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="0a2f7-159">See also</span></span>

- [<span data-ttu-id="0a2f7-160">Asynchroniczny wzorzec oparty na zdarzeniach (EAP)</span><span class="sxs-lookup"><span data-stu-id="0a2f7-160">Event-based Asynchronous Pattern (EAP)</span></span>](event-based-asynchronous-pattern-eap.md)
- [<span data-ttu-id="0a2f7-161">Wywołanie metod synchronicznych w sposób asynchroniczny</span><span class="sxs-lookup"><span data-stu-id="0a2f7-161">Calling Synchronous Methods Asynchronously</span></span>](calling-synchronous-methods-asynchronously.md)
- [<span data-ttu-id="0a2f7-162">Używanie delegata AsyncCallback i obiektu stanu</span><span class="sxs-lookup"><span data-stu-id="0a2f7-162">Using an AsyncCallback Delegate and State Object</span></span>](using-an-asynccallback-delegate-and-state-object.md)
