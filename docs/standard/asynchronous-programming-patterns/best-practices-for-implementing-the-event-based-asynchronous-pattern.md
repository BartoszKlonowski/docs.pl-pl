---
title: "Najlepsze rozwiązania w zakresie implementacji wzorca asynchronicznego opartego na zdarzeniach"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Event-based Asynchronous Pattern
- ProgressChangedEventArgs class
- BackgroundWorker component
- events [.NET Framework], asynchronous
- AsyncOperationManager class
- threading [.NET Framework], asynchronous features
- AsyncOperation class
- AsyncCompletedEventArgs class
ms.assetid: 4acd2094-4f46-4eff-9190-92d0d9ff47db
caps.latest.revision: "8"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: ac206e41f727d24e7748226101b9b8a86ee77376
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/23/2017
---
# <a name="best-practices-for-implementing-the-event-based-asynchronous-pattern"></a><span data-ttu-id="d46f2-102">Najlepsze rozwiązania w zakresie implementacji wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="d46f2-102">Best Practices for Implementing the Event-based Asynchronous Pattern</span></span>
<span data-ttu-id="d46f2-103">Asynchroniczny wzorzec oparty na zdarzeniach udostępnia efektywny sposób ujawniać asynchroniczne zachowanie w klasach ze zdarzeniem znanych i delegowanie semantyki.</span><span class="sxs-lookup"><span data-stu-id="d46f2-103">The Event-based Asynchronous Pattern provides you with an effective way to expose asynchronous behavior in classes, with familiar event and delegate semantics.</span></span> <span data-ttu-id="d46f2-104">Do implementacji klienta wzorca asynchronicznego opartego na zdarzeniach, należy wykonać niektóre określone wymagania funkcjonalne.</span><span class="sxs-lookup"><span data-stu-id="d46f2-104">To implement Event-based Asynchronous Pattern, you need to follow some specific behavioral requirements.</span></span> <span data-ttu-id="d46f2-105">W poniższych sekcjach opisano wymagania i wskazówki, które należy rozważyć podczas implementowania klasę, która wykonuje asynchroniczny wzorzec oparty na zdarzeniach.</span><span class="sxs-lookup"><span data-stu-id="d46f2-105">The following sections describe requirements and guidelines you should consider when you implement a class that follows the Event-based Asynchronous Pattern.</span></span>  
  
 <span data-ttu-id="d46f2-106">Aby uzyskać ogólne informacje, zobacz [implementacji wzorca asynchronicznego opartego na zdarzeniach](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="d46f2-106">For an overview, see [Implementing the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="required-behavioral-guarantees"></a><span data-ttu-id="d46f2-107">Wymagane gwarancje behawioralnej</span><span class="sxs-lookup"><span data-stu-id="d46f2-107">Required Behavioral Guarantees</span></span>  
 <span data-ttu-id="d46f2-108">Jeśli implementacji klienta wzorca asynchronicznego opartego na zdarzeniach, należy podać numer gwarancji, aby klasy będzie działać prawidłowo, a klienci klasy może polegać na takie zachowanie.</span><span class="sxs-lookup"><span data-stu-id="d46f2-108">If you implement the Event-based Asynchronous Pattern, you must provide a number of guarantees to ensure that your class will behave properly and clients of your class can rely on such behavior.</span></span>  
  
### <a name="completion"></a><span data-ttu-id="d46f2-109">Zakończenie</span><span class="sxs-lookup"><span data-stu-id="d46f2-109">Completion</span></span>  
 <span data-ttu-id="d46f2-110">Zawsze wywołania *MethodName* `Completed` obsługi zdarzeń po pomyślnym ukończeniu, błąd lub anulowania.</span><span class="sxs-lookup"><span data-stu-id="d46f2-110">Always invoke the *MethodName*`Completed` event handler when you have successful completion, an error, or a cancellation.</span></span> <span data-ttu-id="d46f2-111">Aplikacji nigdy nie powinna wystąpić sytuacja, w którym pozostają w stanie bezczynności i uzupełniania nigdy nie występuje.</span><span class="sxs-lookup"><span data-stu-id="d46f2-111">Applications should never encounter a situation where they remain idle and completion never occurs.</span></span> <span data-ttu-id="d46f2-112">Jedynym wyjątkiem od tej reguły jest, jeśli operacja asynchroniczna, sama go tak zaprojektowane, że nigdy się nie kończy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-112">One exception to this rule is if the asynchronous operation itself it designed so that it never completes.</span></span>  
  
### <a name="completed-event-and-eventargs"></a><span data-ttu-id="d46f2-113">Zakończonego zdarzenia i EventArgs</span><span class="sxs-lookup"><span data-stu-id="d46f2-113">Completed Event and EventArgs</span></span>  
 <span data-ttu-id="d46f2-114">Dla każdej szczegółowej *MethodName* `Async` metody, zastosuj następujące wymagania:</span><span class="sxs-lookup"><span data-stu-id="d46f2-114">For each separate *MethodName*`Async` method, apply the following design requirements:</span></span>  
  
-   <span data-ttu-id="d46f2-115">Zdefiniuj *MethodName* `Completed` zdarzenia w tej samej klasy jako metodę.</span><span class="sxs-lookup"><span data-stu-id="d46f2-115">Define a *MethodName*`Completed` event on the same class as the method.</span></span>  
  
-   <span data-ttu-id="d46f2-116">Zdefiniuj <xref:System.EventArgs> klasy i towarzyszące delegowanie dla *MethodName* `Completed` zdarzeń, która jest pochodną <xref:System.ComponentModel.AsyncCompletedEventArgs> klasy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-116">Define an <xref:System.EventArgs> class and accompanying delegate for the *MethodName*`Completed` event that derives from the <xref:System.ComponentModel.AsyncCompletedEventArgs> class.</span></span> <span data-ttu-id="d46f2-117">Domyślna nazwa klasy powinna mieć postać *MethodName*`CompletedEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="d46f2-117">The default class name should be of the form *MethodName*`CompletedEventArgs`.</span></span>  
  
-   <span data-ttu-id="d46f2-118">Upewnij się, że <xref:System.EventArgs> klasy jest specyficzna dla wartości zwracanych metody *MethodName* metody.</span><span class="sxs-lookup"><span data-stu-id="d46f2-118">Ensure that the <xref:System.EventArgs> class is specific to the return values of the *MethodName* method.</span></span> <span data-ttu-id="d46f2-119">Jeśli używasz <xref:System.EventArgs> klasy, należy nigdy nie wymagać deweloperom Rzutuj wynik.</span><span class="sxs-lookup"><span data-stu-id="d46f2-119">When you use the <xref:System.EventArgs> class, you should never require developers to cast the result.</span></span>  
  
     <span data-ttu-id="d46f2-120">Poniższy przykład kodu pokazuje odpowiednio dobrej i zły wdrożenia to wymaganie projektowe.</span><span class="sxs-lookup"><span data-stu-id="d46f2-120">The following code example shows good and bad implementation of this design requirement respectively.</span></span>  
  
```csharp  
// Good design  
private void Form1_MethodNameCompleted(object sender, xxxCompletedEventArgs e)   
{   
    DemoType result = e.Result;  
}  
  
// Bad design  
private void Form1_MethodNameCompleted(object sender, MethodNameCompletedEventArgs e)   
{   
    DemoType result = (DemoType)(e.Result);  
}  
```  
  
-   <span data-ttu-id="d46f2-121">Nie definiują <xref:System.EventArgs> klasy dla zwracania metody, które zwracają `void`.</span><span class="sxs-lookup"><span data-stu-id="d46f2-121">Do not define an <xref:System.EventArgs> class for returning methods that return `void`.</span></span> <span data-ttu-id="d46f2-122">Użyj wystąpienia <xref:System.ComponentModel.AsyncCompletedEventArgs> klasy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-122">Instead, use an instance of the <xref:System.ComponentModel.AsyncCompletedEventArgs> class.</span></span>  
  
-   <span data-ttu-id="d46f2-123">Upewnij się, że należy zawsze podnieść *MethodName* `Completed` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d46f2-123">Ensure that you always raise the *MethodName*`Completed` event.</span></span> <span data-ttu-id="d46f2-124">To zdarzenie zostanie zgłoszony na pomyślne zakończenie, błąd lub anulowania.</span><span class="sxs-lookup"><span data-stu-id="d46f2-124">This event should be raised on successful completion, on an error, or on cancellation.</span></span> <span data-ttu-id="d46f2-125">Aplikacji nigdy nie powinna wystąpić sytuacja, w którym pozostają w stanie bezczynności i uzupełniania nigdy nie występuje.</span><span class="sxs-lookup"><span data-stu-id="d46f2-125">Applications should never encounter a situation where they remain idle and completion never occurs.</span></span>  
  
-   <span data-ttu-id="d46f2-126">Upewnij się, że zostaną wychwycone wszelkie wyjątki, które występują w operacji asynchronicznej i przypisz zgłoszony wyjątek do <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="d46f2-126">Ensure that you catch any exceptions that occur in the asynchronous operation and assign the caught exception to the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>  
  
-   <span data-ttu-id="d46f2-127">Wystąpił błąd podczas wykonywania zadania, wyniki powinny być niedostępne.</span><span class="sxs-lookup"><span data-stu-id="d46f2-127">If there was an error completing the task, the results should not be accessible.</span></span> <span data-ttu-id="d46f2-128">Gdy <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> właściwość nie jest `null`, upewnij się, że podczas uzyskiwania dostępu do żadnej właściwości w <xref:System.EventArgs> struktury zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="d46f2-128">When the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property is not `null`, ensure that accessing any property in the <xref:System.EventArgs> structure raises an exception.</span></span> <span data-ttu-id="d46f2-129">Użyj <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> metodę w celu weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-129">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> method to perform this verification.</span></span>  
  
-   <span data-ttu-id="d46f2-130">Model limit czasu jako błąd.</span><span class="sxs-lookup"><span data-stu-id="d46f2-130">Model a time out as an error.</span></span> <span data-ttu-id="d46f2-131">W przypadku przekroczenia limitu czasu podnieść *MethodName* `Completed` zdarzenie i przypisz <xref:System.TimeoutException> do <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="d46f2-131">When a time out occurs, raise the *MethodName*`Completed` event and assign a <xref:System.TimeoutException> to the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>  
  
-   <span data-ttu-id="d46f2-132">Jeśli klasa obsługuje wiele równoczesnych wywołań, upewnij się, że *MethodName* `Completed` zdarzenie zawiera odpowiednie `userSuppliedState` obiektu.</span><span class="sxs-lookup"><span data-stu-id="d46f2-132">If your class supports multiple concurrent invocations, ensure that the *MethodName*`Completed` event contains the appropriate `userSuppliedState` object.</span></span>  
  
-   <span data-ttu-id="d46f2-133">Upewnij się, że *MethodName* `Completed` zdarzenie jest wywoływane w wątku odpowiednie i w odpowiednim czasie w cyklu życia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-133">Ensure that the *MethodName*`Completed` event is raised on the appropriate thread and at the appropriate time in the application lifecycle.</span></span> <span data-ttu-id="d46f2-134">Aby uzyskać więcej informacji zobacz sekcję wątki i konteksty.</span><span class="sxs-lookup"><span data-stu-id="d46f2-134">For more information, see the Threading and Contexts section.</span></span>  
  
### <a name="simultaneously-executing-operations"></a><span data-ttu-id="d46f2-135">Jednocześnie wykonywania operacji</span><span class="sxs-lookup"><span data-stu-id="d46f2-135">Simultaneously Executing Operations</span></span>  
  
-   <span data-ttu-id="d46f2-136">Jeśli klasa obsługuje wiele równoczesnych wywołań, Włącz projektanta do śledzenia każdego wywołania oddzielnie, definiując *MethodName* `Async` przeciążenia, które przyjmuje parametr zwracającej obiekt stanu lub identyfikator zadania o nazwie `userSuppliedState`.</span><span class="sxs-lookup"><span data-stu-id="d46f2-136">If your class supports multiple concurrent invocations, enable the developer to track each invocation separately by defining the *MethodName*`Async` overload that takes an object-valued state parameter, or task ID, called `userSuppliedState`.</span></span> <span data-ttu-id="d46f2-137">Ten parametr powinien zawsze być ostatnim parametrem *MethodName* `Async` podpis metody.</span><span class="sxs-lookup"><span data-stu-id="d46f2-137">This parameter should always be the last parameter in the *MethodName*`Async` method's signature.</span></span>  
  
-   <span data-ttu-id="d46f2-138">Jeśli klasa definiuje *MethodName* `Async` przeciążenia, które przyjmuje parametr zwracającej obiekt stanu lub identyfikator zadania, pamiętaj śledzić okres istnienia operację, podając identyfikator tego zadania i należy podać go do zakończenia Program obsługi.</span><span class="sxs-lookup"><span data-stu-id="d46f2-138">If your class defines the *MethodName*`Async` overload that takes an object-valued state parameter, or task ID, be sure to track the lifetime of the operation with that task ID, and be sure to provide it back into the completion handler.</span></span> <span data-ttu-id="d46f2-139">Brak pomagające klasy pomocy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-139">There are helper classes available to assist.</span></span> <span data-ttu-id="d46f2-140">Aby uzyskać więcej informacji dotyczących zarządzania współbieżności, zobacz [wskazówki: implementacja składnika obsługującego wzorzec asynchroniczny oparty na zdarzeniach](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="d46f2-140">For more information on concurrency management, see [Walkthrough: Implementing a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span></span>  
  
-   <span data-ttu-id="d46f2-141">Jeśli klasa definiuje *MethodName* `Async` metody bez parametru stanu który nie obsługuje wiele równoczesnych wywołań, upewnij się, że próby wywołania *MethodName* `Async` przed wcześniej *MethodName* `Async` wywołanie zostało ukończone zgłasza <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="d46f2-141">If your class defines the *MethodName*`Async` method without the state parameter, and it does not support multiple concurrent invocations, ensure that any attempt to invoke *MethodName*`Async` before the prior *MethodName*`Async` invocation has completed raises an <xref:System.InvalidOperationException>.</span></span>  
  
-   <span data-ttu-id="d46f2-142">Ogólnie rzecz biorąc, nie zgłaszał wyjątku, jeśli *MethodName* `Async` metody bez `userSuppliedState` parametru jest wywołana kilka razy, tak aby były wiele oczekujących operacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-142">In general, do not raise an exception if the *MethodName*`Async` method without the `userSuppliedState` parameter is invoked multiple times so that there are multiple outstanding operations.</span></span> <span data-ttu-id="d46f2-143">Należy zgłosić wyjątek, klasy jawnie nie może obsłużyć tej sytuacji, kiedy założono, że deweloperzy mogą obsługiwać te wielu wywołań zwrotnych nierozróżnialne</span><span class="sxs-lookup"><span data-stu-id="d46f2-143">You can raise an exception when your class explicitly cannot handle that situation, but assume that developers can handle these multiple indistinguishable callbacks</span></span>  
  
### <a name="accessing-results"></a><span data-ttu-id="d46f2-144">Uzyskiwanie dostępu do wyników</span><span class="sxs-lookup"><span data-stu-id="d46f2-144">Accessing Results</span></span>  
  
-   <span data-ttu-id="d46f2-145">Wystąpił błąd podczas wykonywania operacji asynchronicznej, wyniki powinny być niedostępne.</span><span class="sxs-lookup"><span data-stu-id="d46f2-145">If there was an error during execution of the asynchronous operation, the results should not be accessible.</span></span> <span data-ttu-id="d46f2-146">Upewnij się, że podczas uzyskiwania dostępu do żadnej właściwości w <xref:System.ComponentModel.AsyncCompletedEventArgs> podczas <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> nie jest `null` zgłasza wyjątek odwołuje się <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>.</span><span class="sxs-lookup"><span data-stu-id="d46f2-146">Ensure that accessing any property in the <xref:System.ComponentModel.AsyncCompletedEventArgs> when <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> is not `null` raises the exception referenced by <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>.</span></span> <span data-ttu-id="d46f2-147"><xref:System.ComponentModel.AsyncCompletedEventArgs> Klasa udostępnia <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> metody w tym celu.</span><span class="sxs-lookup"><span data-stu-id="d46f2-147">The <xref:System.ComponentModel.AsyncCompletedEventArgs> class provides the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> method for this purpose.</span></span>  
  
-   <span data-ttu-id="d46f2-148">Upewnij się, że wszelkie próbują uzyskać dostęp generuje wynik <xref:System.InvalidOperationException> informujący, że operacja została anulowana.</span><span class="sxs-lookup"><span data-stu-id="d46f2-148">Ensure that any attempt to access the result raises an <xref:System.InvalidOperationException> stating that the operation was canceled.</span></span> <span data-ttu-id="d46f2-149">Użyj <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> metodę w celu weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-149">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> method to perform this verification.</span></span>  
  
### <a name="progress-reporting"></a><span data-ttu-id="d46f2-150">Raportowanie postępu</span><span class="sxs-lookup"><span data-stu-id="d46f2-150">Progress Reporting</span></span>  
  
-   <span data-ttu-id="d46f2-151">Obsługuje raportowania postępu, jeśli to możliwe.</span><span class="sxs-lookup"><span data-stu-id="d46f2-151">Support progress reporting, if possible.</span></span> <span data-ttu-id="d46f2-152">Dzięki temu deweloperzy mogą podać lepsze środowisko aplikacji w przypadku korzystania z klasy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-152">This enables developers to provide a better application user experience when they use your class.</span></span>  
  
-   <span data-ttu-id="d46f2-153">W przypadku zastosowania `ProgressChanged` / *MethodName* `ProgressChanged` zdarzeń, upewnij się, że nie istnieją żadne zgłoszone dla określonej operacji asynchronicznych po zakończeniu tej operacji zdarzenia *MethodName* `Completed` zdarzeń został zgłoszony.</span><span class="sxs-lookup"><span data-stu-id="d46f2-153">If you implement a `ProgressChanged`/*MethodName*`ProgressChanged` event, ensure that there are no such events raised for a particular asynchronous operation after that operation's *MethodName*`Completed` event has been raised.</span></span>  
  
-   <span data-ttu-id="d46f2-154">Jeśli standardowa <xref:System.ComponentModel.ProgressChangedEventArgs> jest wypełniony, upewnij się, że <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> zawsze może zostać zinterpretowany jako procent.</span><span class="sxs-lookup"><span data-stu-id="d46f2-154">If the standard <xref:System.ComponentModel.ProgressChangedEventArgs> is being populated, ensure that the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> can always be interpreted as a percentage.</span></span> <span data-ttu-id="d46f2-155">Wartość procentowa musi być dokładne, ale powinien on reprezentować procent.</span><span class="sxs-lookup"><span data-stu-id="d46f2-155">The percentage does not need to be accurate, but it should represent a percentage.</span></span> <span data-ttu-id="d46f2-156">Jeśli postęp raportowania Metryka musi być inną niż procent, klasa wyprowadzona z <xref:System.ComponentModel.ProgressChangedEventArgs> klasy i pozostawić <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> w lokalizacji 0.</span><span class="sxs-lookup"><span data-stu-id="d46f2-156">If your progress reporting metric must be something other than a percentage, derive a class from the <xref:System.ComponentModel.ProgressChangedEventArgs> class and leave <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> at 0.</span></span> <span data-ttu-id="d46f2-157">Unikaj używania raportowania Metryka niż procent.</span><span class="sxs-lookup"><span data-stu-id="d46f2-157">Avoid using a reporting metric other than a percentage.</span></span>  
  
-   <span data-ttu-id="d46f2-158">Upewnij się, że `ProgressChanged` zdarzenie jest wywoływane w wątku odpowiednie i w odpowiednim czasie w cyklu życia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-158">Ensure that the `ProgressChanged` event is raised on the appropriate thread and at the appropriate time in the application lifecycle.</span></span> <span data-ttu-id="d46f2-159">Aby uzyskać więcej informacji zobacz sekcję wątki i konteksty.</span><span class="sxs-lookup"><span data-stu-id="d46f2-159">For more information, see the Threading and Contexts section.</span></span>  
  
### <a name="isbusy-implementation"></a><span data-ttu-id="d46f2-160">Implementacja IsBusy</span><span class="sxs-lookup"><span data-stu-id="d46f2-160">IsBusy Implementation</span></span>  
  
-   <span data-ttu-id="d46f2-161">Nie ujawniaj `IsBusy` właściwości, jeśli klasa obsługuje wiele równoczesnych wywołań.</span><span class="sxs-lookup"><span data-stu-id="d46f2-161">Do not expose an `IsBusy` property if your class supports multiple concurrent invocations.</span></span> <span data-ttu-id="d46f2-162">Na przykład serwery proxy usługi XML sieci Web nie ujawniaj `IsBusy` właściwości ponieważ obsługują wiele współbieżnych wywołań metod asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="d46f2-162">For example, XML Web service proxies do not expose an `IsBusy` property because they support multiple concurrent invocations of asynchronous methods.</span></span>  
  
-   <span data-ttu-id="d46f2-163">`IsBusy` Ma zwracać właściwość `true` po *MethodName* `Async` została wywołana metoda i przed *MethodName* `Completed` zdarzeń został zgłoszony.</span><span class="sxs-lookup"><span data-stu-id="d46f2-163">The `IsBusy` property should return `true` after the *MethodName*`Async` method has been called and before the *MethodName*`Completed` event has been raised.</span></span> <span data-ttu-id="d46f2-164">W przeciwnym razie powinien zwrócić `false`.</span><span class="sxs-lookup"><span data-stu-id="d46f2-164">Otherwise it should return `false`.</span></span> <span data-ttu-id="d46f2-165"><xref:System.ComponentModel.BackgroundWorker> i <xref:System.Net.WebClient> składniki są przykłady klas, które udostępniają `IsBusy` właściwości.</span><span class="sxs-lookup"><span data-stu-id="d46f2-165">The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.Net.WebClient> components are examples of classes that expose an `IsBusy` property.</span></span>  
  
### <a name="cancellation"></a><span data-ttu-id="d46f2-166">Anulowanie</span><span class="sxs-lookup"><span data-stu-id="d46f2-166">Cancellation</span></span>  
  
-   <span data-ttu-id="d46f2-167">Obsługuje anulowania, jeśli to możliwe.</span><span class="sxs-lookup"><span data-stu-id="d46f2-167">Support cancellation, if possible.</span></span> <span data-ttu-id="d46f2-168">Dzięki temu deweloperzy mogą podać lepsze środowisko aplikacji w przypadku korzystania z klasy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-168">This enables developers to provide a better application user experience when they use your class.</span></span>  
  
-   <span data-ttu-id="d46f2-169">W przypadku anulowania, ustaw <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> oflagowane w <xref:System.ComponentModel.AsyncCompletedEventArgs> obiektu.</span><span class="sxs-lookup"><span data-stu-id="d46f2-169">In the case of cancellation, set the <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> flag in the <xref:System.ComponentModel.AsyncCompletedEventArgs> object.</span></span>  
  
-   <span data-ttu-id="d46f2-170">Upewnij się, że wszelkie próbują uzyskać dostęp generuje wynik <xref:System.InvalidOperationException> informujący, że operacja została anulowana.</span><span class="sxs-lookup"><span data-stu-id="d46f2-170">Ensure that any attempt to access the result raises an <xref:System.InvalidOperationException> stating that the operation was canceled.</span></span> <span data-ttu-id="d46f2-171">Użyj <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> metodę w celu weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-171">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> method to perform this verification.</span></span>  
  
-   <span data-ttu-id="d46f2-172">Upewnij się, że wywołania metody anulowania zawsze zwracają pomyślnie i nigdy nie zgłaszał wyjątku.</span><span class="sxs-lookup"><span data-stu-id="d46f2-172">Ensure that calls to a cancellation method always return successfully, and never raise an exception.</span></span> <span data-ttu-id="d46f2-173">Ogólnie rzecz biorąc klient nie jest powiadamiany o operacji jest w pełni można anulować w dowolnym momencie i nie jest powiadamiany o określające, czy wcześniej wydanych anulowania zakończyła się pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="d46f2-173">In general, a client is not notified as to whether an operation is truly cancelable at any given time, and is not notified as to whether a previously issued cancellation has succeeded.</span></span> <span data-ttu-id="d46f2-174">Jednak aplikacja zawsze otrzymają powiadomienie podczas anulowania zakończyło się pomyślnie, ponieważ aplikacja uczestniczy w stan ukończenia.</span><span class="sxs-lookup"><span data-stu-id="d46f2-174">However, the application will always be given notification when a cancellation succeeded, because the application takes part in the completion status.</span></span>  
  
-   <span data-ttu-id="d46f2-175">Zgłoś *MethodName* `Completed` zdarzenie, gdy operacja została anulowana.</span><span class="sxs-lookup"><span data-stu-id="d46f2-175">Raise the *MethodName*`Completed` event when the operation is canceled.</span></span>  
  
### <a name="errors-and-exceptions"></a><span data-ttu-id="d46f2-176">Błędy i wyjątki</span><span class="sxs-lookup"><span data-stu-id="d46f2-176">Errors and Exceptions</span></span>  
  
-   <span data-ttu-id="d46f2-177">CATCH wszelkie wyjątki, które występują w ramach operacji asynchronicznej i ustaw wartość <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A?displayProperty=nameWithType> właściwości tego wyjątku.</span><span class="sxs-lookup"><span data-stu-id="d46f2-177">Catch any exceptions that occur in the asynchronous operation and set the value of the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A?displayProperty=nameWithType> property to that exception.</span></span>  
  
### <a name="threading-and-contexts"></a><span data-ttu-id="d46f2-178">Wątki i konteksty</span><span class="sxs-lookup"><span data-stu-id="d46f2-178">Threading and Contexts</span></span>  
 <span data-ttu-id="d46f2-179">Do poprawnego działania klasy jest krytyczny, że obsługi zdarzeń klienta są wywoływane na właściwy wątku lub kontekst dla modelu danej aplikacji, w tym [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] i aplikacji formularzy systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="d46f2-179">For correct operation of your class, it is critical that the client's event handlers are invoked on the proper thread or context for the given application model, including [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] and Windows Forms applications.</span></span> <span data-ttu-id="d46f2-180">Aby zapewnić poprawne działanie asynchroniczne klasy w dowolnej aplikacji modelu znajdują się dwie klasy pomocy ważne: <xref:System.ComponentModel.AsyncOperation> i <xref:System.ComponentModel.AsyncOperationManager>.</span><span class="sxs-lookup"><span data-stu-id="d46f2-180">Two important helper classes are provided to ensure that your asynchronous class behaves correctly under any application model: <xref:System.ComponentModel.AsyncOperation> and <xref:System.ComponentModel.AsyncOperationManager>.</span></span>  
  
 <span data-ttu-id="d46f2-181"><xref:System.ComponentModel.AsyncOperationManager>zawiera jedną metodę <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A>, która zwraca wartość <xref:System.ComponentModel.AsyncOperation>.</span><span class="sxs-lookup"><span data-stu-id="d46f2-181"><xref:System.ComponentModel.AsyncOperationManager> provides one method, <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A>, which returns an <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="d46f2-182">Twoje *MethodName* `Async` wywołania metody <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> i klasy używa zwróconego <xref:System.ComponentModel.AsyncOperation> śledzić okres istnienia zadanie asynchroniczne.</span><span class="sxs-lookup"><span data-stu-id="d46f2-182">Your *MethodName*`Async` method calls <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> and your class uses the returned <xref:System.ComponentModel.AsyncOperation> to track the lifetime of the asynchronous task.</span></span>  
  
 <span data-ttu-id="d46f2-183">Aby zgłosić postęp, wyniki przyrostowych i uzupełniania do klienta, należy wywołać <xref:System.ComponentModel.AsyncOperation.Post%2A> i <xref:System.ComponentModel.AsyncOperation.OperationCompleted%2A> metody <xref:System.ComponentModel.AsyncOperation>.</span><span class="sxs-lookup"><span data-stu-id="d46f2-183">To report progress, incremental results, and completion to the client, call the <xref:System.ComponentModel.AsyncOperation.Post%2A> and <xref:System.ComponentModel.AsyncOperation.OperationCompleted%2A> methods on the <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="d46f2-184"><xref:System.ComponentModel.AsyncOperation>jest odpowiedzialny za organizowanie wywołań obsługi zdarzeń klienckich do właściwego thread lub context.</span><span class="sxs-lookup"><span data-stu-id="d46f2-184"><xref:System.ComponentModel.AsyncOperation> is responsible for marshaling calls to the client's event handlers to the proper thread or context.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d46f2-185">Te reguły można ominąć, jeśli chcesz jawnie go przed zasady modelu aplikacji, ale nadal korzystać z innych zalety korzystania z wzorca asynchronicznego opartego na zdarzeniach.</span><span class="sxs-lookup"><span data-stu-id="d46f2-185">You can circumvent these rules if you explicitly want to go against the policy of the application model, but still benefit from the other advantages of using the Event-based Asynchronous Pattern.</span></span> <span data-ttu-id="d46f2-186">Można na przykład hiperwątkowe klasy działających w formularzach systemu Windows jako wolne.</span><span class="sxs-lookup"><span data-stu-id="d46f2-186">For example, you may want a class operating in Windows Forms to be free threaded.</span></span> <span data-ttu-id="d46f2-187">Tak długo, jak deweloperzy poznać domniemanych ograniczenia, można utworzyć klasę wolnych wątków.</span><span class="sxs-lookup"><span data-stu-id="d46f2-187">You can create a free threaded class, as long as developers understand the implied restrictions.</span></span> <span data-ttu-id="d46f2-188">Aplikacje konsoli nie Synchronizuj wykonywanie <xref:System.ComponentModel.AsyncOperation.Post%2A> wywołania.</span><span class="sxs-lookup"><span data-stu-id="d46f2-188">Console applications do not synchronize the execution of <xref:System.ComponentModel.AsyncOperation.Post%2A> calls.</span></span> <span data-ttu-id="d46f2-189">Może to spowodować `ProgressChanged` zdarzenia, które mają zostać wywołane poza kolejnością.</span><span class="sxs-lookup"><span data-stu-id="d46f2-189">This can cause `ProgressChanged` events to be raised out of order.</span></span> <span data-ttu-id="d46f2-190">Jeśli chcesz mieć serializacji wykonywanie <xref:System.ComponentModel.AsyncOperation.Post%2A> wywołań, wdrożenia i zainstalować <xref:System.Threading.SynchronizationContext?displayProperty=nameWithType> klasy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-190">If you wish to have serialized execution of <xref:System.ComponentModel.AsyncOperation.Post%2A> calls, implement and install a <xref:System.Threading.SynchronizationContext?displayProperty=nameWithType> class.</span></span>  
  
 <span data-ttu-id="d46f2-191">Aby uzyskać więcej informacji o korzystaniu z <xref:System.ComponentModel.AsyncOperation> i <xref:System.ComponentModel.AsyncOperationManager> umożliwia asynchroniczne operacje, zobacz [wskazówki: implementacja składnika obsługującego wzorzec asynchroniczny oparty na zdarzeniach](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="d46f2-191">For more information about using <xref:System.ComponentModel.AsyncOperation> and <xref:System.ComponentModel.AsyncOperationManager> to enable your asynchronous operations, see [Walkthrough: Implementing a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="guidelines"></a><span data-ttu-id="d46f2-192">Wytyczne dotyczące</span><span class="sxs-lookup"><span data-stu-id="d46f2-192">Guidelines</span></span>  
  
-   <span data-ttu-id="d46f2-193">W idealnym przypadku każdego wywołania metody powinny być niezależne od innych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="d46f2-193">Ideally, each method invocation should be independent of others.</span></span> <span data-ttu-id="d46f2-194">Należy unikać sprzężenia wywołań z udostępnionymi zasobami.</span><span class="sxs-lookup"><span data-stu-id="d46f2-194">You should avoid coupling invocations with shared resources.</span></span> <span data-ttu-id="d46f2-195">Jeśli zasoby mają być współużytkowane przez wywołań, konieczne będzie mechanizm właściwego synchronizacji w implementacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-195">If resources are to be shared among invocations, you will need to provide a proper synchronization mechanism in your implementation.</span></span>  
  
-   <span data-ttu-id="d46f2-196">Projekty, które wymagają klienta do zaimplementowania synchronizacji nie są zalecane.</span><span class="sxs-lookup"><span data-stu-id="d46f2-196">Designs that require the client to implement synchronization are discouraged.</span></span> <span data-ttu-id="d46f2-197">Na przykład można mieć metody asynchronicznej otrzymuje globalny obiekt statycznych jako parametr; wiele współbieżnych wywołań taka metoda może spowodować uszkodzenie danych lub zakleszczenia.</span><span class="sxs-lookup"><span data-stu-id="d46f2-197">For example, you could have an asynchronous method that receives a global static object as a parameter; multiple concurrent invocations of such a method could result in data corruption or deadlocks.</span></span>  
  
-   <span data-ttu-id="d46f2-198">W przypadku zastosowania metody z wieloma wywołania przeciążenia (`userState` w podpisie), klasy będą musieli zarządzać kolekcję stanów użytkownika lub identyfikatorów zadań i odpowiednie oczekujących operacji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-198">If you implement a method with the multiple-invocation overload (`userState` in the signature), your class will need to manage a collection of user states, or task IDs, and their corresponding pending operations.</span></span> <span data-ttu-id="d46f2-199">Ta kolekcja powinny być chronione przy użyciu `lock` regionach, ponieważ różnych wywołań Dodawanie i usuwanie `userState` obiektów w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="d46f2-199">This collection should be protected with `lock` regions, because the various invocations add and remove `userState` objects in the collection.</span></span>  
  
-   <span data-ttu-id="d46f2-200">Należy rozważyć ponowne użycie `CompletedEventArgs` klas, gdzie to możliwe i właściwe.</span><span class="sxs-lookup"><span data-stu-id="d46f2-200">Consider reusing `CompletedEventArgs` classes where feasible and appropriate.</span></span> <span data-ttu-id="d46f2-201">W takim przypadku nazewnictwo nie jest spójna z nazwą metody, ponieważ danego obiektu delegowanego i <xref:System.EventArgs> typu nie są związane z pojedynczej metody.</span><span class="sxs-lookup"><span data-stu-id="d46f2-201">In this case, the naming is not consistent with the method name, because a given delegate and <xref:System.EventArgs> type are not tied to a single method.</span></span> <span data-ttu-id="d46f2-202">Jednak wymuszania deweloperom rzutowania pobrać z właściwości na wartość <xref:System.EventArgs> nigdy nie jest akceptowany.</span><span class="sxs-lookup"><span data-stu-id="d46f2-202">However, forcing developers to cast the value retrieved from a property on the <xref:System.EventArgs> is never acceptable.</span></span>  
  
-   <span data-ttu-id="d46f2-203">W przypadku tworzenia klasy pochodnej z <xref:System.ComponentModel.Component>nie implementuje i zainstalować własne <xref:System.Threading.SynchronizationContext> klasy.</span><span class="sxs-lookup"><span data-stu-id="d46f2-203">If you are authoring a class that derives from <xref:System.ComponentModel.Component>, do not implement and install your own <xref:System.Threading.SynchronizationContext> class.</span></span> <span data-ttu-id="d46f2-204">Modele aplikacji, a nie składników, sterowanie <xref:System.Threading.SynchronizationContext> używany.</span><span class="sxs-lookup"><span data-stu-id="d46f2-204">Application models, not components, control the <xref:System.Threading.SynchronizationContext> that is used.</span></span>  
  
-   <span data-ttu-id="d46f2-205">Jeśli używasz wielowątkowość jakiegokolwiek rodzaju potencjalnie naraża samodzielnie do usterki bardzo poważne i złożone.</span><span class="sxs-lookup"><span data-stu-id="d46f2-205">When you use multithreading of any sort, you potentially expose yourself to very serious and complex bugs.</span></span> <span data-ttu-id="d46f2-206">Przed wdrożeniem dowolnego rozwiązania, które używa wielowątkowości, zobacz [zarządzanych wątków najlepsze rozwiązania w zakresie](../../../docs/standard/threading/managed-threading-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="d46f2-206">Before implementing any solution that uses multithreading, see [Managed Threading Best Practices](../../../docs/standard/threading/managed-threading-best-practices.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d46f2-207">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="d46f2-207">See Also</span></span>  
 <xref:System.ComponentModel.AsyncOperation>  
 <xref:System.ComponentModel.AsyncOperationManager>  
 <xref:System.ComponentModel.AsyncCompletedEventArgs>  
 <xref:System.ComponentModel.ProgressChangedEventArgs>  
 <xref:System.ComponentModel.BackgroundWorker>  
 [<span data-ttu-id="d46f2-208">Implementowanie wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="d46f2-208">Implementing the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="d46f2-209">Programowanie wielowątkowości za pomocą wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="d46f2-209">Multithreaded Programming with the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/multithreaded-programming-with-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="d46f2-210">Decydowanie o czasie implementacji wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="d46f2-210">Deciding When to Implement the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/deciding-when-to-implement-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="d46f2-211">Implementacja wzorca asynchronicznego opartego na zdarzeniach — najlepsze rozwiązania</span><span class="sxs-lookup"><span data-stu-id="d46f2-211">Best Practices for Implementing the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/best-practices-for-implementing-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="d46f2-212">Instrukcje: Używanie składników obsługujących wzorzec asynchroniczny oparty na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="d46f2-212">How to: Use Components That Support the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/how-to-use-components-that-support-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="d46f2-213">Przewodnik: Implementacja składnika obsługującego wzorzec asynchroniczny oparty na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="d46f2-213">Walkthrough: Implementing a Component That Supports the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md)
