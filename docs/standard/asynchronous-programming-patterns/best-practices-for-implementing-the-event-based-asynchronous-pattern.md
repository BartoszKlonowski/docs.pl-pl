---
title: Najlepsze rozwiązania w zakresie implementacji wzorca asynchronicznego opartego na zdarzeniach
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- Event-based Asynchronous Pattern
- ProgressChangedEventArgs class
- BackgroundWorker component
- events [.NET Framework], asynchronous
- AsyncOperationManager class
- threading [.NET Framework], asynchronous features
- AsyncOperation class
- AsyncCompletedEventArgs class
ms.assetid: 4acd2094-4f46-4eff-9190-92d0d9ff47db
ms.openlocfilehash: 439b862612d7997c9277ffb2cf4f15b14bd0b106
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/15/2020
ms.locfileid: "78156052"
---
# <a name="best-practices-for-implementing-the-event-based-asynchronous-pattern"></a><span data-ttu-id="3050d-102">Najlepsze rozwiązania w zakresie implementacji wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="3050d-102">Best Practices for Implementing the Event-based Asynchronous Pattern</span></span>
<span data-ttu-id="3050d-103">Wzorzec asynchroniczny oparty na zdarzeniach zapewnia skuteczny sposób uwidaczniania zachowania asynchronicznego w klasach, z opisem semantyki zdarzeń i delegować.</span><span class="sxs-lookup"><span data-stu-id="3050d-103">The Event-based Asynchronous Pattern provides you with an effective way to expose asynchronous behavior in classes, with familiar event and delegate semantics.</span></span> <span data-ttu-id="3050d-104">Aby zaimplementować wzorzec asynchroniczny oparty na zdarzeniach, należy przestrzegać pewnych określonych wymagań behawioralnych.</span><span class="sxs-lookup"><span data-stu-id="3050d-104">To implement Event-based Asynchronous Pattern, you need to follow some specific behavioral requirements.</span></span> <span data-ttu-id="3050d-105">W poniższych sekcjach opisano wymagania i wskazówki, które należy wziąć pod uwagę podczas implementowania klasy, która następuje po wzorca asynchronicznego opartego na zdarzeniach.</span><span class="sxs-lookup"><span data-stu-id="3050d-105">The following sections describe requirements and guidelines you should consider when you implement a class that follows the Event-based Asynchronous Pattern.</span></span>  
  
 <span data-ttu-id="3050d-106">Aby uzyskać omówienie, zobacz [Implementowanie wzorca asynchronicznego opartego na zdarzeniach](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="3050d-106">For an overview, see [Implementing the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="required-behavioral-guarantees"></a><span data-ttu-id="3050d-107">Wymagane gwarancje behawioralne</span><span class="sxs-lookup"><span data-stu-id="3050d-107">Required Behavioral Guarantees</span></span>  
 <span data-ttu-id="3050d-108">Jeśli zaimplementujesz wzorca asynchronicznego opartego na zdarzeniach, należy podać szereg gwarancji, aby upewnić się, że klasa będzie zachowywać się poprawnie, a klienci klasy mogą polegać na takim zachowaniu.</span><span class="sxs-lookup"><span data-stu-id="3050d-108">If you implement the Event-based Asynchronous Pattern, you must provide a number of guarantees to ensure that your class will behave properly and clients of your class can rely on such behavior.</span></span>  
  
### <a name="completion"></a><span data-ttu-id="3050d-109">Ukończenie</span><span class="sxs-lookup"><span data-stu-id="3050d-109">Completion</span></span>  
 <span data-ttu-id="3050d-110">Zawsze wywoływać <em>MethodName</em>**Completed** obsługi zdarzeń, gdy masz pomyślne zakończenie, błąd lub anulowanie.</span><span class="sxs-lookup"><span data-stu-id="3050d-110">Always invoke the <em>MethodName</em>**Completed** event handler when you have successful completion, an error, or a cancellation.</span></span> <span data-ttu-id="3050d-111">Aplikacje nigdy nie powinny wystąpić w sytuacji, w której pozostają bezczynne i zakończenie nigdy nie występuje.</span><span class="sxs-lookup"><span data-stu-id="3050d-111">Applications should never encounter a situation where they remain idle and completion never occurs.</span></span> <span data-ttu-id="3050d-112">Jednym z wyjątków od tej reguły jest, jeśli sama operacja asynchroniczna jest zaprojektowany tak, że nigdy nie kończy.</span><span class="sxs-lookup"><span data-stu-id="3050d-112">One exception to this rule is if the asynchronous operation itself is designed so that it never completes.</span></span>  
  
### <a name="completed-event-and-eventargs"></a><span data-ttu-id="3050d-113">Ukończone wydarzenie i eventargs</span><span class="sxs-lookup"><span data-stu-id="3050d-113">Completed Event and EventArgs</span></span>  
 <span data-ttu-id="3050d-114">Dla każdej oddzielnej metody**Asynia** <em>Nazwa metody</em>należy zastosować następujące wymagania projektowe:</span><span class="sxs-lookup"><span data-stu-id="3050d-114">For each separate <em>MethodName</em>**Async** method, apply the following design requirements:</span></span>  
  
- <span data-ttu-id="3050d-115">Zdefiniuj <em>MethodName</em>**Complete** zdarzenie w tej samej klasie co metoda.</span><span class="sxs-lookup"><span data-stu-id="3050d-115">Define a <em>MethodName</em>**Completed** event on the same class as the method.</span></span>  
  
- <span data-ttu-id="3050d-116">Zdefiniuj <xref:System.EventArgs> klasę i towarzyszącego delegata dla <em>MethodName</em>**Completed** zdarzenia, który pochodzi od <xref:System.ComponentModel.AsyncCompletedEventArgs> klasy.</span><span class="sxs-lookup"><span data-stu-id="3050d-116">Define an <xref:System.EventArgs> class and accompanying delegate for the <em>MethodName</em>**Completed** event that derives from the <xref:System.ComponentModel.AsyncCompletedEventArgs> class.</span></span> <span data-ttu-id="3050d-117">Domyślną nazwą klasy powinna być forma <em>MethodName</em>**CompletedEventArgs**.</span><span class="sxs-lookup"><span data-stu-id="3050d-117">The default class name should be of the form <em>MethodName</em>**CompletedEventArgs**.</span></span>  
  
- <span data-ttu-id="3050d-118">Upewnij się, że <xref:System.EventArgs> klasa jest specyficzna dla zwracanych wartości <em>MethodName</em> metody.</span><span class="sxs-lookup"><span data-stu-id="3050d-118">Ensure that the <xref:System.EventArgs> class is specific to the return values of the <em>MethodName</em> method.</span></span> <span data-ttu-id="3050d-119">Korzystając z <xref:System.EventArgs> klasy, nigdy nie należy wymagać od deweloperów rzutowanie wyniku.</span><span class="sxs-lookup"><span data-stu-id="3050d-119">When you use the <xref:System.EventArgs> class, you should never require developers to cast the result.</span></span>  
  
     <span data-ttu-id="3050d-120">Poniższy przykład kodu pokazuje dobre i złe wykonanie tego wymagania projektowego odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="3050d-120">The following code example shows good and bad implementation of this design requirement respectively.</span></span>  
  
```csharp  
// Good design  
private void Form1_MethodNameCompleted(object sender, xxxCompletedEventArgs e)
{
    DemoType result = e.Result;  
}  
  
// Bad design  
private void Form1_MethodNameCompleted(object sender, MethodNameCompletedEventArgs e)
{
    DemoType result = (DemoType)(e.Result);  
}  
```  
  
- <span data-ttu-id="3050d-121">Nie należy <xref:System.EventArgs> definiować klasy dla `void`zwracanych metod, które zwracają .</span><span class="sxs-lookup"><span data-stu-id="3050d-121">Do not define an <xref:System.EventArgs> class for returning methods that return `void`.</span></span> <span data-ttu-id="3050d-122">Zamiast tego należy użyć <xref:System.ComponentModel.AsyncCompletedEventArgs> wystąpienia klasy.</span><span class="sxs-lookup"><span data-stu-id="3050d-122">Instead, use an instance of the <xref:System.ComponentModel.AsyncCompletedEventArgs> class.</span></span>  
  
- <span data-ttu-id="3050d-123">Upewnij się, że zawsze podnieść <em>MethodName</em>**Complete event.**</span><span class="sxs-lookup"><span data-stu-id="3050d-123">Ensure that you always raise the <em>MethodName</em>**Completed** event.</span></span> <span data-ttu-id="3050d-124">To zdarzenie powinno zostać podniesione po pomyślnym zakończeniu, na błąd lub w przypadku anulowania.</span><span class="sxs-lookup"><span data-stu-id="3050d-124">This event should be raised on successful completion, on an error, or on cancellation.</span></span> <span data-ttu-id="3050d-125">Aplikacje nigdy nie powinny wystąpić w sytuacji, w której pozostają bezczynne i zakończenie nigdy nie występuje.</span><span class="sxs-lookup"><span data-stu-id="3050d-125">Applications should never encounter a situation where they remain idle and completion never occurs.</span></span>  
  
- <span data-ttu-id="3050d-126">Upewnij się, że można przechwycić wszelkie wyjątki, które występują w <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> operacji asynchronicznej i przypisać przechwyconego wyjątku do właściwości.</span><span class="sxs-lookup"><span data-stu-id="3050d-126">Ensure that you catch any exceptions that occur in the asynchronous operation and assign the caught exception to the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>  
  
- <span data-ttu-id="3050d-127">Jeśli wystąpił błąd podczas wykonywania zadania, wyniki nie powinny być dostępne.</span><span class="sxs-lookup"><span data-stu-id="3050d-127">If there was an error completing the task, the results should not be accessible.</span></span> <span data-ttu-id="3050d-128">Gdy <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> właściwość nie `null`jest , upewnij się, <xref:System.EventArgs> że dostęp do dowolnej właściwości w strukturze wywołuje wyjątek.</span><span class="sxs-lookup"><span data-stu-id="3050d-128">When the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property is not `null`, ensure that accessing any property in the <xref:System.EventArgs> structure raises an exception.</span></span> <span data-ttu-id="3050d-129">Użyj <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> tej metody, aby przeprowadzić tę weryfikację.</span><span class="sxs-lookup"><span data-stu-id="3050d-129">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> method to perform this verification.</span></span>  
  
- <span data-ttu-id="3050d-130">Modeluj uchyłka czasu jako błąd.</span><span class="sxs-lookup"><span data-stu-id="3050d-130">Model a time out as an error.</span></span> <span data-ttu-id="3050d-131">Gdy wystąpi uchyłaczasty czas, należy podnieść <xref:System.TimeoutException> <em>MethodName</em>**Completed** zdarzenia i przypisać do <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="3050d-131">When a time out occurs, raise the <em>MethodName</em>**Completed** event and assign a <xref:System.TimeoutException> to the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>  
  
- <span data-ttu-id="3050d-132">Jeśli klasa obsługuje wiele równoczesnych wywołań, upewnij się, że `userSuppliedState` <em>MethodName</em>**Completed** zdarzenie zawiera odpowiedni obiekt.</span><span class="sxs-lookup"><span data-stu-id="3050d-132">If your class supports multiple concurrent invocations, ensure that the <em>MethodName</em>**Completed** event contains the appropriate `userSuppliedState` object.</span></span>  
  
- <span data-ttu-id="3050d-133">Upewnij się, że <em>MethodName</em>**Complete zdarzenie** jest wywoływane w odpowiednim wątku i w odpowiednim czasie w cyklu życia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3050d-133">Ensure that the <em>MethodName</em>**Completed** event is raised on the appropriate thread and at the appropriate time in the application lifecycle.</span></span> <span data-ttu-id="3050d-134">Aby uzyskać więcej informacji, zobacz wątków i kontekstów sekcji.</span><span class="sxs-lookup"><span data-stu-id="3050d-134">For more information, see the Threading and Contexts section.</span></span>  
  
### <a name="simultaneously-executing-operations"></a><span data-ttu-id="3050d-135">Jednoczesne wykonywanie operacji</span><span class="sxs-lookup"><span data-stu-id="3050d-135">Simultaneously Executing Operations</span></span>  
  
- <span data-ttu-id="3050d-136">Jeśli klasa obsługuje wiele równoczesnych wywołań, włącz deweloperowi śledzenie każdego wywołania oddzielnie, definiując przeciążenie**Asynchroniczne** Nazwa `userSuppliedState` <em>metody,</em>które przyjmuje parametr stanu wartości obiektu lub identyfikator zadania o nazwie .</span><span class="sxs-lookup"><span data-stu-id="3050d-136">If your class supports multiple concurrent invocations, enable the developer to track each invocation separately by defining the <em>MethodName</em>**Async** overload that takes an object-valued state parameter, or task ID, called `userSuppliedState`.</span></span> <span data-ttu-id="3050d-137">Ten parametr powinien być zawsze ostatnim parametrem w podpisie metody <em>MethodName</em>**Async.**</span><span class="sxs-lookup"><span data-stu-id="3050d-137">This parameter should always be the last parameter in the <em>MethodName</em>**Async** method's signature.</span></span>  
  
- <span data-ttu-id="3050d-138">Jeśli klasa definiuje przeciążenie**Asynchronia** <em>MethodName,</em>które przyjmuje parametr stanu wartości obiektu lub identyfikator zadania, należy śledzić okres istnienia operacji z tego identyfikatora zadania i upewnij się, aby zapewnić go z powrotem do obsługi zakończenia.</span><span class="sxs-lookup"><span data-stu-id="3050d-138">If your class defines the <em>MethodName</em>**Async** overload that takes an object-valued state parameter, or task ID, be sure to track the lifetime of the operation with that task ID, and be sure to provide it back into the completion handler.</span></span> <span data-ttu-id="3050d-139">Istnieją zajęcia pomocnicze dostępne do pomocy.</span><span class="sxs-lookup"><span data-stu-id="3050d-139">There are helper classes available to assist.</span></span> <span data-ttu-id="3050d-140">Aby uzyskać więcej informacji na temat zarządzania współbieżnością, zobacz [Jak: Implementowanie składnika obsługującego wzorzec asynchroniczny oparty na zdarzeniach](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="3050d-140">For more information on concurrency management, see [How to: Implement a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span></span>  
  
- <span data-ttu-id="3050d-141">Jeśli klasa definiuje <em>MethodName</em>**Async** metody bez parametru stanu i nie obsługuje wielu wywołań równoczesnych, upewnij się, że każda próba wywołania <em>MethodName</em> <xref:System.InvalidOperationException>**Async** przed ukończenia poprzedniego wywołania**Async** <em>MethodName</em>wywołuje .</span><span class="sxs-lookup"><span data-stu-id="3050d-141">If your class defines the <em>MethodName</em>**Async** method without the state parameter, and it does not support multiple concurrent invocations, ensure that any attempt to invoke <em>MethodName</em>**Async** before the prior <em>MethodName</em>**Async** invocation has completed raises an <xref:System.InvalidOperationException>.</span></span>  
  
- <span data-ttu-id="3050d-142">Ogólnie rzecz biorąc nie zgłaszać wyjątek, jeśli <em>MethodName</em>**Async** metoda bez parametru `userSuppliedState` jest wywoływana wiele razy, tak aby istnieje wiele operacji zaległych.</span><span class="sxs-lookup"><span data-stu-id="3050d-142">In general, do not raise an exception if the <em>MethodName</em>**Async** method without the `userSuppliedState` parameter is invoked multiple times so that there are multiple outstanding operations.</span></span> <span data-ttu-id="3050d-143">Można zgłosić wyjątek, gdy klasa jawnie nie może obsłużyć tej sytuacji, ale załóżmy, że deweloperzy mogą obsługiwać te wiele wywołań wywołań wywołań niedo odróżnienia</span><span class="sxs-lookup"><span data-stu-id="3050d-143">You can raise an exception when your class explicitly cannot handle that situation, but assume that developers can handle these multiple indistinguishable callbacks</span></span>  
  
### <a name="accessing-results"></a><span data-ttu-id="3050d-144">Uzyskiwanie dostępu do wyników</span><span class="sxs-lookup"><span data-stu-id="3050d-144">Accessing Results</span></span>  
  
- <span data-ttu-id="3050d-145">Jeśli wystąpił błąd podczas wykonywania operacji asynchronicznej, wyniki nie powinny być dostępne.</span><span class="sxs-lookup"><span data-stu-id="3050d-145">If there was an error during execution of the asynchronous operation, the results should not be accessible.</span></span> <span data-ttu-id="3050d-146">Upewnij się, że dostęp <xref:System.ComponentModel.AsyncCompletedEventArgs> <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> do `null` dowolnej właściwości w <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>when nie jest zgłasza wyjątek odwołuje się .</span><span class="sxs-lookup"><span data-stu-id="3050d-146">Ensure that accessing any property in the <xref:System.ComponentModel.AsyncCompletedEventArgs> when <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> is not `null` raises the exception referenced by <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>.</span></span> <span data-ttu-id="3050d-147">Klasa <xref:System.ComponentModel.AsyncCompletedEventArgs> zapewnia <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> metodę w tym celu.</span><span class="sxs-lookup"><span data-stu-id="3050d-147">The <xref:System.ComponentModel.AsyncCompletedEventArgs> class provides the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> method for this purpose.</span></span>  
  
- <span data-ttu-id="3050d-148">Upewnij się, że każda próba <xref:System.InvalidOperationException> uzyskania dostępu do wyniku wywołuje stwierdzające, że operacja została anulowana.</span><span class="sxs-lookup"><span data-stu-id="3050d-148">Ensure that any attempt to access the result raises an <xref:System.InvalidOperationException> stating that the operation was canceled.</span></span> <span data-ttu-id="3050d-149">Użyj <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> tej metody, aby przeprowadzić tę weryfikację.</span><span class="sxs-lookup"><span data-stu-id="3050d-149">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> method to perform this verification.</span></span>  
  
### <a name="progress-reporting"></a><span data-ttu-id="3050d-150">Raportowanie postępów</span><span class="sxs-lookup"><span data-stu-id="3050d-150">Progress Reporting</span></span>  
  
- <span data-ttu-id="3050d-151">Jeśli to możliwe, obsługa raportowania postępów.</span><span class="sxs-lookup"><span data-stu-id="3050d-151">Support progress reporting, if possible.</span></span> <span data-ttu-id="3050d-152">Dzięki temu deweloperzy zapewniają lepsze środowisko użytkownika aplikacji, gdy używają klasy.</span><span class="sxs-lookup"><span data-stu-id="3050d-152">This enables developers to provide a better application user experience when they use your class.</span></span>  
  
- <span data-ttu-id="3050d-153">Jeśli zaimplementujesz **ProgressChanged** lub <em>MethodName</em>**ProgressChanged** zdarzenia, upewnij się, że nie ma takich zdarzeń zgłoszonych dla określonej operacji asynchronicznej po tej operacji <em>MethodName</em>**Completed** zdarzenie zostało podniesione.</span><span class="sxs-lookup"><span data-stu-id="3050d-153">If you implement a **ProgressChanged** or <em>MethodName</em>**ProgressChanged** event, ensure that there are no such events raised for a particular asynchronous operation after that operation's <em>MethodName</em>**Completed** event has been raised.</span></span>  
  
- <span data-ttu-id="3050d-154">Jeśli standard <xref:System.ComponentModel.ProgressChangedEventArgs> jest wypełniany, upewnij <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> się, że zawsze można interpretować jako procent.</span><span class="sxs-lookup"><span data-stu-id="3050d-154">If the standard <xref:System.ComponentModel.ProgressChangedEventArgs> is being populated, ensure that the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> can always be interpreted as a percentage.</span></span> <span data-ttu-id="3050d-155">Procent nie musi być dokładny, ale powinien reprezentować procent.</span><span class="sxs-lookup"><span data-stu-id="3050d-155">The percentage does not need to be accurate, but it should represent a percentage.</span></span> <span data-ttu-id="3050d-156">Jeśli metryka raportowania postępu musi być czymś innym niż <xref:System.ComponentModel.ProgressChangedEventArgs> procent, <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> wyprowauj klasę z klasy i pozostaw na 0.</span><span class="sxs-lookup"><span data-stu-id="3050d-156">If your progress reporting metric must be something other than a percentage, derive a class from the <xref:System.ComponentModel.ProgressChangedEventArgs> class and leave <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> at 0.</span></span> <span data-ttu-id="3050d-157">Unikaj używania metryki raportowania innej niż procent.</span><span class="sxs-lookup"><span data-stu-id="3050d-157">Avoid using a reporting metric other than a percentage.</span></span>  
  
- <span data-ttu-id="3050d-158">Upewnij się, że `ProgressChanged` zdarzenie jest wywoływane w odpowiednim wątku i w odpowiednim czasie w cyklu życia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3050d-158">Ensure that the `ProgressChanged` event is raised on the appropriate thread and at the appropriate time in the application lifecycle.</span></span> <span data-ttu-id="3050d-159">Aby uzyskać więcej informacji, zobacz wątków i kontekstów sekcji.</span><span class="sxs-lookup"><span data-stu-id="3050d-159">For more information, see the Threading and Contexts section.</span></span>  
  
### <a name="isbusy-implementation"></a><span data-ttu-id="3050d-160">Implementacja Isbusy</span><span class="sxs-lookup"><span data-stu-id="3050d-160">IsBusy Implementation</span></span>  
  
- <span data-ttu-id="3050d-161">Nie uwidaczniać `IsBusy` właściwość, jeśli klasa obsługuje wiele równoczesnych wywołań.</span><span class="sxs-lookup"><span data-stu-id="3050d-161">Do not expose an `IsBusy` property if your class supports multiple concurrent invocations.</span></span> <span data-ttu-id="3050d-162">Na przykład serwery proxy usługi sieci Web `IsBusy` XML nie ujawniają właściwości, ponieważ obsługują wiele równoczesnych wywołań metod asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="3050d-162">For example, XML Web service proxies do not expose an `IsBusy` property because they support multiple concurrent invocations of asynchronous methods.</span></span>  
  
- <span data-ttu-id="3050d-163">Właściwość `IsBusy` powinna `true` zwrócić po <em>MethodName</em>**Async** metoda została wywołana i przed <em>MethodName</em>**Completed** zdarzenie zostało podniesione.</span><span class="sxs-lookup"><span data-stu-id="3050d-163">The `IsBusy` property should return `true` after the <em>MethodName</em>**Async** method has been called and before the <em>MethodName</em>**Completed** event has been raised.</span></span> <span data-ttu-id="3050d-164">W przeciwnym `false`razie powinien powrócić .</span><span class="sxs-lookup"><span data-stu-id="3050d-164">Otherwise it should return `false`.</span></span> <span data-ttu-id="3050d-165">I <xref:System.ComponentModel.BackgroundWorker> <xref:System.Net.WebClient> składniki są przykładami klas, `IsBusy` które uwidaczniają właściwość.</span><span class="sxs-lookup"><span data-stu-id="3050d-165">The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.Net.WebClient> components are examples of classes that expose an `IsBusy` property.</span></span>  
  
### <a name="cancellation"></a><span data-ttu-id="3050d-166">Anulowanie</span><span class="sxs-lookup"><span data-stu-id="3050d-166">Cancellation</span></span>  
  
- <span data-ttu-id="3050d-167">Jeśli to możliwe, obsługa techniczna została anulowana.</span><span class="sxs-lookup"><span data-stu-id="3050d-167">Support cancellation, if possible.</span></span> <span data-ttu-id="3050d-168">Dzięki temu deweloperzy zapewniają lepsze środowisko użytkownika aplikacji, gdy używają klasy.</span><span class="sxs-lookup"><span data-stu-id="3050d-168">This enables developers to provide a better application user experience when they use your class.</span></span>  
  
- <span data-ttu-id="3050d-169">W przypadku anulowania ustaw <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> flagę w <xref:System.ComponentModel.AsyncCompletedEventArgs> obiekcie.</span><span class="sxs-lookup"><span data-stu-id="3050d-169">In the case of cancellation, set the <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> flag in the <xref:System.ComponentModel.AsyncCompletedEventArgs> object.</span></span>  
  
- <span data-ttu-id="3050d-170">Upewnij się, że każda próba <xref:System.InvalidOperationException> uzyskania dostępu do wyniku wywołuje stwierdzające, że operacja została anulowana.</span><span class="sxs-lookup"><span data-stu-id="3050d-170">Ensure that any attempt to access the result raises an <xref:System.InvalidOperationException> stating that the operation was canceled.</span></span> <span data-ttu-id="3050d-171">Użyj <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> tej metody, aby przeprowadzić tę weryfikację.</span><span class="sxs-lookup"><span data-stu-id="3050d-171">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> method to perform this verification.</span></span>  
  
- <span data-ttu-id="3050d-172">Upewnij się, że wywołania metody anulowania zawsze zwracają pomyślnie i nigdy nie zgłaszać wyjątek.</span><span class="sxs-lookup"><span data-stu-id="3050d-172">Ensure that calls to a cancellation method always return successfully, and never raise an exception.</span></span> <span data-ttu-id="3050d-173">Ogólnie rzecz biorąc klient nie jest powiadamiany o tym, czy operacja jest naprawdę anulowana w danym momencie i nie jest powiadamiany o tym, czy wcześniej wydane anulowanie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="3050d-173">In general, a client is not notified as to whether an operation is truly cancelable at any given time, and is not notified as to whether a previously issued cancellation has succeeded.</span></span> <span data-ttu-id="3050d-174">Jednak aplikacja zawsze będzie otrzymywać powiadomienia, gdy anulowanie powiodło się, ponieważ aplikacja bierze udział w stanie ukończenia.</span><span class="sxs-lookup"><span data-stu-id="3050d-174">However, the application will always be given notification when a cancellation succeeded, because the application takes part in the completion status.</span></span>  
  
- <span data-ttu-id="3050d-175">Podnieś <em>MethodName</em>**Complete** zdarzenie po anulowaniu operacji.</span><span class="sxs-lookup"><span data-stu-id="3050d-175">Raise the <em>MethodName</em>**Completed** event when the operation is canceled.</span></span>  
  
### <a name="errors-and-exceptions"></a><span data-ttu-id="3050d-176">Błędy i wyjątki</span><span class="sxs-lookup"><span data-stu-id="3050d-176">Errors and Exceptions</span></span>  
  
- <span data-ttu-id="3050d-177">Przechwyć wszelkie wyjątki, które występują w operacji <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A?displayProperty=nameWithType> asynchronicznej i ustawić wartość właściwości do tego wyjątku.</span><span class="sxs-lookup"><span data-stu-id="3050d-177">Catch any exceptions that occur in the asynchronous operation and set the value of the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A?displayProperty=nameWithType> property to that exception.</span></span>  
  
### <a name="threading-and-contexts"></a><span data-ttu-id="3050d-178">Wątkowanie i konteksty</span><span class="sxs-lookup"><span data-stu-id="3050d-178">Threading and Contexts</span></span>  
 <span data-ttu-id="3050d-179">Dla prawidłowego działania klasy, ważne jest, że programy obsługi zdarzeń klienta są wywoływane w odpowiednim wątku lub kontekstu dla danego modelu aplikacji, w tym ASP.NET i windows forms aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3050d-179">For correct operation of your class, it is critical that the client's event handlers are invoked on the proper thread or context for the given application model, including ASP.NET and Windows Forms applications.</span></span> <span data-ttu-id="3050d-180">Dwie ważne klasy pomocnika są dostarczane w celu zapewnienia, że klasa asynchroniczna zachowuje się poprawnie w dowolnym modelu aplikacji: <xref:System.ComponentModel.AsyncOperation> i <xref:System.ComponentModel.AsyncOperationManager>.</span><span class="sxs-lookup"><span data-stu-id="3050d-180">Two important helper classes are provided to ensure that your asynchronous class behaves correctly under any application model: <xref:System.ComponentModel.AsyncOperation> and <xref:System.ComponentModel.AsyncOperationManager>.</span></span>  
  
 <span data-ttu-id="3050d-181"><xref:System.ComponentModel.AsyncOperationManager>zapewnia jedną <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A>metodę, która <xref:System.ComponentModel.AsyncOperation>zwraca .</span><span class="sxs-lookup"><span data-stu-id="3050d-181"><xref:System.ComponentModel.AsyncOperationManager> provides one method, <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A>, which returns an <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="3050d-182"><em>Metoda MethodName</em>**Async** wywołuje <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> i klasy <xref:System.ComponentModel.AsyncOperation> używa zwracane do śledzenia okresu istnienia zadania asynchronicznego.</span><span class="sxs-lookup"><span data-stu-id="3050d-182">Your <em>MethodName</em>**Async** method calls <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> and your class uses the returned <xref:System.ComponentModel.AsyncOperation> to track the lifetime of the asynchronous task.</span></span>  
  
 <span data-ttu-id="3050d-183">Aby zgłosić postęp, wyniki przyrostowe i zakończenie <xref:System.ComponentModel.AsyncOperation.Post%2A> do <xref:System.ComponentModel.AsyncOperation.OperationCompleted%2A> klienta, <xref:System.ComponentModel.AsyncOperation>wywołać i metody na .</span><span class="sxs-lookup"><span data-stu-id="3050d-183">To report progress, incremental results, and completion to the client, call the <xref:System.ComponentModel.AsyncOperation.Post%2A> and <xref:System.ComponentModel.AsyncOperation.OperationCompleted%2A> methods on the <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="3050d-184"><xref:System.ComponentModel.AsyncOperation>jest odpowiedzialny za organizowanie wywołań obsługi zdarzeń klienta do właściwego wątku lub kontekstu.</span><span class="sxs-lookup"><span data-stu-id="3050d-184"><xref:System.ComponentModel.AsyncOperation> is responsible for marshaling calls to the client's event handlers to the proper thread or context.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3050d-185">Można obejść te reguły, jeśli jawnie chcesz przejść do zasad modelu aplikacji, ale nadal korzystać z innych zalet przy użyciu wzorca asynchronicznego opartego na zdarzeniach.</span><span class="sxs-lookup"><span data-stu-id="3050d-185">You can circumvent these rules if you explicitly want to go against the policy of the application model, but still benefit from the other advantages of using the Event-based Asynchronous Pattern.</span></span> <span data-ttu-id="3050d-186">Na przykład może chcesz klasy działających w formularzach systemu Windows być wolne wątków.</span><span class="sxs-lookup"><span data-stu-id="3050d-186">For example, you may want a class operating in Windows Forms to be free threaded.</span></span> <span data-ttu-id="3050d-187">Można utworzyć bezpłatną klasę wątkową, tak długo, jak deweloperzy rozumieją dorozumiane ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3050d-187">You can create a free threaded class, as long as developers understand the implied restrictions.</span></span> <span data-ttu-id="3050d-188">Aplikacje konsoli nie synchronizują wykonywania wywołań. <xref:System.ComponentModel.AsyncOperation.Post%2A></span><span class="sxs-lookup"><span data-stu-id="3050d-188">Console applications do not synchronize the execution of <xref:System.ComponentModel.AsyncOperation.Post%2A> calls.</span></span> <span data-ttu-id="3050d-189">Może to `ProgressChanged` spowodować zdarzenia, które mają być wywoływane poza kolejnością.</span><span class="sxs-lookup"><span data-stu-id="3050d-189">This can cause `ProgressChanged` events to be raised out of order.</span></span> <span data-ttu-id="3050d-190">Jeśli chcesz mieć serializowane <xref:System.ComponentModel.AsyncOperation.Post%2A> wykonywanie wywołań, <xref:System.Threading.SynchronizationContext?displayProperty=nameWithType> zaimplementuj i zainstaluj klasę.</span><span class="sxs-lookup"><span data-stu-id="3050d-190">If you wish to have serialized execution of <xref:System.ComponentModel.AsyncOperation.Post%2A> calls, implement and install a <xref:System.Threading.SynchronizationContext?displayProperty=nameWithType> class.</span></span>  
  
 <span data-ttu-id="3050d-191">Aby uzyskać więcej <xref:System.ComponentModel.AsyncOperation> <xref:System.ComponentModel.AsyncOperationManager> informacji na temat używania i włączania operacji asynchronicznych, zobacz [Jak: Implementowanie składnika obsługującego wzorzec asynchroniczny oparty na zdarzeniach](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="3050d-191">For more information about using <xref:System.ComponentModel.AsyncOperation> and <xref:System.ComponentModel.AsyncOperationManager> to enable your asynchronous operations, see [How to: Implement a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="guidelines"></a><span data-ttu-id="3050d-192">Wytyczne</span><span class="sxs-lookup"><span data-stu-id="3050d-192">Guidelines</span></span>  
  
- <span data-ttu-id="3050d-193">W idealnym przypadku każde wywołanie metody powinno być niezależne od innych.</span><span class="sxs-lookup"><span data-stu-id="3050d-193">Ideally, each method invocation should be independent of others.</span></span> <span data-ttu-id="3050d-194">Należy unikać wywołań sprzęgania z zasobami udostępnionymi.</span><span class="sxs-lookup"><span data-stu-id="3050d-194">You should avoid coupling invocations with shared resources.</span></span> <span data-ttu-id="3050d-195">Jeśli zasoby mają być współużytkowane między wywołaniami, należy zapewnić mechanizm synchronizacji właściwego w implementacji.</span><span class="sxs-lookup"><span data-stu-id="3050d-195">If resources are to be shared among invocations, you will need to provide a proper synchronization mechanism in your implementation.</span></span>  
  
- <span data-ttu-id="3050d-196">Projekty, które wymagają od klienta do zaimplementowania synchronizacji są odradzane.</span><span class="sxs-lookup"><span data-stu-id="3050d-196">Designs that require the client to implement synchronization are discouraged.</span></span> <span data-ttu-id="3050d-197">Na przykład można mieć metodę asynchroniczną, która odbiera globalny obiekt statyczny jako parametr; wiele równoczesnych wywołań takiej metody może spowodować uszkodzenie danych lub zakleszczenia.</span><span class="sxs-lookup"><span data-stu-id="3050d-197">For example, you could have an asynchronous method that receives a global static object as a parameter; multiple concurrent invocations of such a method could result in data corruption or deadlocks.</span></span>  
  
- <span data-ttu-id="3050d-198">Jeśli zaimplementujesz metodę z przeciążeniem`userState` wielokrotnego wywołania (w podpisie), klasa będzie musiała zarządzać kolekcją stanów użytkowników lub identyfikatorów zadań i odpowiadających im operacji oczekujących.</span><span class="sxs-lookup"><span data-stu-id="3050d-198">If you implement a method with the multiple-invocation overload (`userState` in the signature), your class will need to manage a collection of user states, or task IDs, and their corresponding pending operations.</span></span> <span data-ttu-id="3050d-199">Ta kolekcja powinna `lock` być chroniona za pomocą regionów, `userState` ponieważ różne wywołania dodawać i usuwać obiekty w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="3050d-199">This collection should be protected with `lock` regions, because the various invocations add and remove `userState` objects in the collection.</span></span>  
  
- <span data-ttu-id="3050d-200">Należy rozważyć ponowne użycie `CompletedEventArgs` klas, jeśli jest to możliwe i właściwe.</span><span class="sxs-lookup"><span data-stu-id="3050d-200">Consider reusing `CompletedEventArgs` classes where feasible and appropriate.</span></span> <span data-ttu-id="3050d-201">W takim przypadku nazewnictwo nie jest zgodne z nazwą metody, <xref:System.EventArgs> ponieważ dany delegat i typ nie są powiązane z jedną metodą.</span><span class="sxs-lookup"><span data-stu-id="3050d-201">In this case, the naming is not consistent with the method name, because a given delegate and <xref:System.EventArgs> type are not tied to a single method.</span></span> <span data-ttu-id="3050d-202">Jednak zmuszając deweloperów do rzutować wartość pobraną z właściwości na nigdy nie <xref:System.EventArgs> jest dopuszczalne.</span><span class="sxs-lookup"><span data-stu-id="3050d-202">However, forcing developers to cast the value retrieved from a property on the <xref:System.EventArgs> is never acceptable.</span></span>  
  
- <span data-ttu-id="3050d-203">Jeśli autoryzujesz klasę, która <xref:System.ComponentModel.Component>wywodzi <xref:System.Threading.SynchronizationContext> się z , nie implementuj i instaluj własną klasę.</span><span class="sxs-lookup"><span data-stu-id="3050d-203">If you are authoring a class that derives from <xref:System.ComponentModel.Component>, do not implement and install your own <xref:System.Threading.SynchronizationContext> class.</span></span> <span data-ttu-id="3050d-204">Modele aplikacji, a nie <xref:System.Threading.SynchronizationContext> składniki, sterują, który jest używany.</span><span class="sxs-lookup"><span data-stu-id="3050d-204">Application models, not components, control the <xref:System.Threading.SynchronizationContext> that is used.</span></span>  
  
- <span data-ttu-id="3050d-205">Korzystając z wielowątkowości wszelkiego rodzaju, potencjalnie narażasz się na bardzo poważne i złożone błędy.</span><span class="sxs-lookup"><span data-stu-id="3050d-205">When you use multithreading of any sort, you potentially expose yourself to very serious and complex bugs.</span></span> <span data-ttu-id="3050d-206">Przed wdrożeniem dowolnego rozwiązania, które używa wielowątkowości, zobacz [Zarządzane wątki najlepsze rozwiązania](../../../docs/standard/threading/managed-threading-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="3050d-206">Before implementing any solution that uses multithreading, see [Managed Threading Best Practices](../../../docs/standard/threading/managed-threading-best-practices.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3050d-207">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="3050d-207">See also</span></span>

- <xref:System.ComponentModel.AsyncOperation>
- <xref:System.ComponentModel.AsyncOperationManager>
- <xref:System.ComponentModel.AsyncCompletedEventArgs>
- <xref:System.ComponentModel.ProgressChangedEventArgs>
- <xref:System.ComponentModel.BackgroundWorker>
- [<span data-ttu-id="3050d-208">Implementowanie wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="3050d-208">Implementing the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)
- [<span data-ttu-id="3050d-209">Asynchroniczny wzorzec oparty na zdarzeniach (EAP)</span><span class="sxs-lookup"><span data-stu-id="3050d-209">Event-based Asynchronous Pattern (EAP)</span></span>](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)
- [<span data-ttu-id="3050d-210">Decydowanie o czasie implementacji klienta wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="3050d-210">Deciding When to Implement the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/deciding-when-to-implement-the-event-based-asynchronous-pattern.md)
- [<span data-ttu-id="3050d-211">Najlepsze rozwiązania w zakresie implementacji wzorca asynchronicznego opartego na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="3050d-211">Best Practices for Implementing the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/best-practices-for-implementing-the-event-based-asynchronous-pattern.md)
- [<span data-ttu-id="3050d-212">Instrukcje: Używanie składników obsługujących wzorzec asynchroniczny oparty na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="3050d-212">How to: Use Components That Support the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/how-to-use-components-that-support-the-event-based-asynchronous-pattern.md)
- [<span data-ttu-id="3050d-213">Instrukcje: Implementacja składnika obsługującego wzorzec asynchroniczny oparty na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="3050d-213">How to: Implement a Component That Supports the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md)
