---
title: Stacja robocza a wyrzucanie elementów bezużytecznych serwera (GC)
description: Dowiedz się więcej o śmietniku stacji roboczej i serwera w .NET.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, workstation
- garbage collection, server
- workstation garbage collection
- server garbage collection
ms.openlocfilehash: 6b8e5f6802e5d44669b95d43d4e897fa4a418512
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/23/2020
ms.locfileid: "82103556"
---
# <a name="workstation-and-server-garbage-collection"></a><span data-ttu-id="8c8e9-103">Wyrzucanie elementów bezużytecznych stacji roboczych i serwera</span><span class="sxs-lookup"><span data-stu-id="8c8e9-103">Workstation and server garbage collection</span></span>

<span data-ttu-id="8c8e9-104">Moduł zbierający elementy bezużyteczne jest samoczyszczenia i może pracować w wielu różnych scenariuszach.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-104">The garbage collector is self-tuning and can work in a wide variety of scenarios.</span></span> <span data-ttu-id="8c8e9-105">Można jednak [ustawić typ wyrzucania elementów bezużytecznych](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) na podstawie cech obciążenia.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-105">However, you can [set the type of garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) based on the characteristics of the workload.</span></span> <span data-ttu-id="8c8e9-106">Program CLR udostępnia następujące typy wyrzucania elementów bezużytecznych:</span><span class="sxs-lookup"><span data-stu-id="8c8e9-106">The CLR provides the following types of garbage collection:</span></span>

- <span data-ttu-id="8c8e9-107">Wyrzucanie elementów bezużytecznych stacji roboczych (GC), który jest przeznaczony dla aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-107">Workstation garbage collection (GC), which is designed for client apps.</span></span> <span data-ttu-id="8c8e9-108">Jest to domyślny smak GC dla autonomicznych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-108">It's the default GC flavor for standalone apps.</span></span> <span data-ttu-id="8c8e9-109">W przypadku hostowanych aplikacji, na przykład tych obsługiwanych przez ASP.NET, host określa domyślny smak GC.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-109">For hosted apps, for example, those hosted by ASP.NET, the host determines the default GC flavor.</span></span>

  <span data-ttu-id="8c8e9-110">Wyrzucanie elementów bezużytecznych stacji roboczej może być równoczesne lub niebieżne.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-110">Workstation garbage collection can be concurrent or non-concurrent.</span></span> <span data-ttu-id="8c8e9-111">Równoczesnych (lub *tła)* wyrzucania elementów bezużytecznych umożliwia zarządzanych wątków, aby kontynuować operacje podczas wyrzucania elementów bezużytecznych.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-111">Concurrent (or *background*) garbage collection enables managed threads to continue operations during a garbage collection.</span></span> <span data-ttu-id="8c8e9-112">[Wyrzucanie elementów bezużytecznych tła](background-gc.md) zastępuje [równoczesnych wyrzucania elementów bezużytecznych](background-gc.md#concurrent-garbage-collection) w .NET Framework 4 i nowszych wersjach.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-112">[Background garbage collection](background-gc.md) replaces [concurrent garbage collection](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 and later versions.</span></span>

- <span data-ttu-id="8c8e9-113">Wyrzucanie elementów bezużytecznych serwera, który jest przeznaczony dla aplikacji serwera, które wymagają wysokiej przepływności i skalowalności.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-113">Server garbage collection, which is intended for server applications that need high throughput and scalability.</span></span>

  - <span data-ttu-id="8c8e9-114">W .NET Core wyrzucanie elementów bezużytecznych serwera może być niebieżne lub tła.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-114">In .NET Core, server garbage collection can be non-concurrent or background.</span></span>

  - <span data-ttu-id="8c8e9-115">W .NET Framework 4.5 i nowszych wersjach wyrzucanie elementów bezużytecznych serwera może być równoczesne lub tła.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-115">In .NET Framework 4.5 and later versions, server garbage collection can be non-concurrent or background.</span></span> <span data-ttu-id="8c8e9-116">W .NET Framework 4 i poprzednich wersjach wyrzucanie elementów bezużytecznych serwera nie jest równoczesne.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-116">In .NET Framework 4 and previous versions, server garbage collection is non-concurrent.</span></span>

<span data-ttu-id="8c8e9-117">Na poniższej ilustracji przedstawiono dedykowane wątki, które wykonują wyrzucania elementów bezużytecznych na serwerze:</span><span class="sxs-lookup"><span data-stu-id="8c8e9-117">The following illustration shows the dedicated threads that perform the garbage collection on a server:</span></span>

![Wątki wyrzucania elementów bezużytecznych serwera](./media/gc-server.png)

## <a name="performance-considerations"></a><span data-ttu-id="8c8e9-119">Zagadnienia dotyczące wydajności</span><span class="sxs-lookup"><span data-stu-id="8c8e9-119">Performance considerations</span></span>

### <a name="workstation-gc"></a><span data-ttu-id="8c8e9-120">Stacja robocza GC</span><span class="sxs-lookup"><span data-stu-id="8c8e9-120">Workstation GC</span></span>

<span data-ttu-id="8c8e9-121">Poniżej przedstawiono zagadnienia dotyczące wątków i wydajności dla wyrzucania elementów bezużytecznych stacji roboczej:</span><span class="sxs-lookup"><span data-stu-id="8c8e9-121">The following are threading and performance considerations for workstation garbage collection:</span></span>

- <span data-ttu-id="8c8e9-122">Kolekcja występuje w wątku użytkownika, który wyzwolił wyrzucania elementów bezużytecznych i pozostaje w tym samym priorytecie.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-122">The collection occurs on the user thread that triggered the garbage collection and remains at the same priority.</span></span> <span data-ttu-id="8c8e9-123">Ponieważ wątki użytkownika zazwyczaj działają z normalnym priorytetem, moduł zbierający elementy bezużyteczne (który działa na wątku o normalnym priorytecie) musi konkurować z innymi wątkami dla czasu procesora CPU.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-123">Because user threads typically run at normal priority, the garbage collector (which runs on a normal priority thread) must compete with other threads for CPU time.</span></span> <span data-ttu-id="8c8e9-124">(Wątki, które uruchamiają kod macierzysty nie są zawieszone na serwerze lub stacji roboczej wyrzucania elementów bezużytecznych.)</span><span class="sxs-lookup"><span data-stu-id="8c8e9-124">(Threads that run native code are not suspended on either server or workstation garbage collection.)</span></span>

- <span data-ttu-id="8c8e9-125">Wyrzucanie elementów bezużytecznych stacji roboczej jest zawsze używane na komputerze, który ma tylko jeden procesor, niezależnie od [ustawienia konfiguracji](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver).</span><span class="sxs-lookup"><span data-stu-id="8c8e9-125">Workstation garbage collection is always used on a computer that has only one processor, regardless of the [configuration setting](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver).</span></span>

### <a name="server-gc"></a><span data-ttu-id="8c8e9-126">GC serwera</span><span class="sxs-lookup"><span data-stu-id="8c8e9-126">Server GC</span></span>

<span data-ttu-id="8c8e9-127">Poniżej przedstawiono zagadnienia dotyczące wątków i wydajności dla wyrzucania elementów bezużytecznych serwera:</span><span class="sxs-lookup"><span data-stu-id="8c8e9-127">The following are threading and performance considerations for server garbage collection:</span></span>

- <span data-ttu-id="8c8e9-128">Kolekcja występuje na wielu dedykowanych wątków, które są uruchomione na `THREAD_PRIORITY_HIGHEST` poziomie priorytetu.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-128">The collection occurs on multiple dedicated threads that are running at `THREAD_PRIORITY_HIGHEST` priority level.</span></span>

- <span data-ttu-id="8c8e9-129">Sterta i dedykowany wątek do wykonywania wyrzucania elementów bezużytecznych są dostarczane dla każdego procesora CPU, a sterty są zbierane w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-129">A heap and a dedicated thread to perform garbage collection are provided for each CPU, and the heaps are collected at the same time.</span></span> <span data-ttu-id="8c8e9-130">Każdy stos zawiera stertę małych obiektów i sterty dużego obiektu, a wszystkie sterty są dostępne za pomocą kodu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-130">Each heap contains a small object heap and a large object heap, and all heaps can be accessed by user code.</span></span> <span data-ttu-id="8c8e9-131">Obiekty na różnych stertach mogą odnosić się do siebie nawzajem.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-131">Objects on different heaps can refer to each other.</span></span>

- <span data-ttu-id="8c8e9-132">Ponieważ wiele wątków wyrzucania elementów bezużytecznych działa ze sobą, wyrzucanie elementów bezużytecznych serwera jest szybsze niż wyrzucanie elementów bezużytecznych na tym samym rozmiarze stosu.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-132">Because multiple garbage collection threads work together, server garbage collection is faster than workstation garbage collection on the same size heap.</span></span>

- <span data-ttu-id="8c8e9-133">Wyrzucanie elementów bezużytecznych serwera często ma większe segmenty rozmiaru.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-133">Server garbage collection often has larger size segments.</span></span> <span data-ttu-id="8c8e9-134">Jest to jednak tylko uogólnienie: rozmiar segmentu jest specyficzny dla implementacji i może ulec zmianie.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-134">However, this is only a generalization: segment size is implementation-specific and is subject to change.</span></span> <span data-ttu-id="8c8e9-135">Nie należy zakładać rozmiar segmentów przydzielonych przez moduł zbierający elementy bezużyteczne podczas dostrajania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-135">Don't make assumptions about the size of segments allocated by the garbage collector when tuning your app.</span></span>

- <span data-ttu-id="8c8e9-136">Wyrzucanie elementów bezużytecznych serwera może być intensywnie korzystające z zasobów.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-136">Server garbage collection can be resource-intensive.</span></span> <span data-ttu-id="8c8e9-137">Załóżmy na przykład, że istnieje 12 procesów, które używają gc serwera uruchomionego na komputerze, który ma cztery procesory.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-137">For example, imagine that there are 12 processes that use server GC running on a computer that has four processors.</span></span> <span data-ttu-id="8c8e9-138">Jeśli wszystkie procesy zdarzyć się zbierać śmieci w tym samym czasie, będą kolidować ze sobą, jak nie byłoby 12 wątków zaplanowanych na tym samym procesorze.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-138">If all the processes happen to collect garbage at the same time, they would interfere with each other, as there would be 12 threads scheduled on the same processor.</span></span> <span data-ttu-id="8c8e9-139">Jeśli procesy są aktywne, nie jest dobrym pomysłem, aby wszystkie one używać gc serwera.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-139">If the processes are active, it's not a good idea to have them all use server GC.</span></span>

<span data-ttu-id="8c8e9-140">Jeśli używasz setki wystąpień aplikacji, należy rozważyć użycie wyrzucania elementów bezużytecznych stacji roboczej z równoczesnym wyrzucaniem elementów bezużytecznych wyłączone.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-140">If you're running hundreds of instances of an application, consider using workstation garbage collection with concurrent garbage collection disabled.</span></span> <span data-ttu-id="8c8e9-141">Spowoduje to mniej przełączania kontekstu, co może poprawić wydajność.</span><span class="sxs-lookup"><span data-stu-id="8c8e9-141">This will result in less context switching, which can improve performance.</span></span>

## <a name="see-also"></a><span data-ttu-id="8c8e9-142">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="8c8e9-142">See also</span></span>

- [<span data-ttu-id="8c8e9-143">Wyrzucanie elementów bezużytecznych w tle</span><span class="sxs-lookup"><span data-stu-id="8c8e9-143">Background garbage collection</span></span>](background-gc.md)
- [<span data-ttu-id="8c8e9-144">Opcje konfiguracji w czasie wykonywania wyrzucania elementów bezużytecznych</span><span class="sxs-lookup"><span data-stu-id="8c8e9-144">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
