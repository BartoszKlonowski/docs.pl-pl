---
title: Odzyskiwanie pamięci w tle
description: Informacje o wyrzucaniu elementów bezużytecznych w programie .NET i sposobie ich użycia w wyrzucaniu elementów bezużytecznych w stacji roboczej
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, background
- background garbage collection
ms.openlocfilehash: 8134c0af55d74e57dcfce8c7174265b8c9902feb
ms.sourcegitcommit: 5280b2aef60a1ed99002dba44e4b9e7f6c830604
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/03/2020
ms.locfileid: "84307075"
---
# <a name="background-garbage-collection"></a><span data-ttu-id="de73a-103">Odzyskiwanie pamięci w tle</span><span class="sxs-lookup"><span data-stu-id="de73a-103">Background garbage collection</span></span>

<span data-ttu-id="de73a-104">W wyrzucaniu elementów bezużytecznych w tle (GC), generacji tymczasowe (0 i 1) są zbierane zgodnie z wymaganiami, gdy trwa zbieranie danych generacji 2.</span><span class="sxs-lookup"><span data-stu-id="de73a-104">In background garbage collection (GC), ephemeral generations (0 and 1) are collected as needed while the collection of generation 2 is in progress.</span></span> <span data-ttu-id="de73a-105">Wyrzucanie elementów bezużytecznych w tle jest wykonywane na co najmniej jednym dedykowanym wątku, w zależności od tego, czy jest to tło czy serwer GC, i ma zastosowanie tylko do kolekcji generacji 2.</span><span class="sxs-lookup"><span data-stu-id="de73a-105">Background garbage collection is performed on one or more dedicated threads, depending on whether it's background or server GC, and applies only to generation 2 collections.</span></span>

<span data-ttu-id="de73a-106">Wyrzucanie elementów bezużytecznych w tle jest domyślnie włączone.</span><span class="sxs-lookup"><span data-stu-id="de73a-106">Background garbage collection is enabled by default.</span></span> <span data-ttu-id="de73a-107">Można ją włączyć lub wyłączyć za pomocą ustawienia konfiguracji [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) w aplikacjach .NET Framework lub ustawienia [System. GC. współbieżne](../../core/run-time-config/garbage-collector.md#systemgcconcurrentcomplus_gcconcurrent) w aplikacjach .NET Core.</span><span class="sxs-lookup"><span data-stu-id="de73a-107">It can be enabled or disabled with the [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) configuration setting in .NET Framework apps or the [System.GC.Concurrent](../../core/run-time-config/garbage-collector.md#systemgcconcurrentcomplus_gcconcurrent) setting in .NET Core apps.</span></span>

> [!NOTE]
> <span data-ttu-id="de73a-108">Wyrzucanie elementów bezużytecznych w tle zastępuje [współbieżne odzyskiwanie pamięci](#concurrent-garbage-collection) i jest dostępne w .NET Framework 4 i nowszych wersjach.</span><span class="sxs-lookup"><span data-stu-id="de73a-108">Background garbage collection replaces [concurrent garbage collection](#concurrent-garbage-collection) and is available in .NET Framework 4 and later versions.</span></span> <span data-ttu-id="de73a-109">W .NET Framework 4 jest obsługiwana tylko dla wyrzucania elementów bezużytecznych *stacji roboczej* .</span><span class="sxs-lookup"><span data-stu-id="de73a-109">In .NET Framework 4, it's supported only for *workstation* garbage collection.</span></span> <span data-ttu-id="de73a-110">Począwszy od .NET Framework 4,5, wyrzucanie elementów bezużytecznych w tle jest dostępne zarówno dla *stacji roboczej* , jak i *serwera* .</span><span class="sxs-lookup"><span data-stu-id="de73a-110">Starting with .NET Framework 4.5, background garbage collection is available for both *workstation* and *server* garbage collection.</span></span>

<span data-ttu-id="de73a-111">Kolekcja tymczasowych generacji podczas wyrzucania elementów bezużytecznych w tle jest znana jako wyrzucanie elementów bezużytecznych *pierwszego planu* .</span><span class="sxs-lookup"><span data-stu-id="de73a-111">A collection on ephemeral generations during background garbage collection is known as *foreground* garbage collection.</span></span> <span data-ttu-id="de73a-112">Gdy wystąpią wyrzucanie elementów bezużytecznych pierwszego planu, wszystkie zarządzane wątki są zawieszane.</span><span class="sxs-lookup"><span data-stu-id="de73a-112">When foreground garbage collections occur, all managed threads are suspended.</span></span>

<span data-ttu-id="de73a-113">Gdy wyrzucanie elementów bezużytecznych w tle jest w toku i przydzielono wystarczającą liczbę obiektów w generacji 0, środowisko CLR wykonuje wyrzucanie elementów bezużytecznych generacji 0 lub generacji 1.</span><span class="sxs-lookup"><span data-stu-id="de73a-113">When background garbage collection is in progress and you've allocated enough objects in generation 0, the CLR performs a generation 0 or generation 1 foreground garbage collection.</span></span> <span data-ttu-id="de73a-114">Nieznaczny wątek wyrzucania elementów bezużytecznych w tle sprawdza, czy występuje żądanie wyrzucania elementów bezużytecznych na pierwszym planie.</span><span class="sxs-lookup"><span data-stu-id="de73a-114">The dedicated background garbage collection thread checks at frequent safe points to determine whether there is a request for foreground garbage collection.</span></span> <span data-ttu-id="de73a-115">Jeśli istnieje, kolekcja w tle zawiesza się tak, aby mogły wystąpić wyrzucanie elementów bezużytecznych na pierwszym planie.</span><span class="sxs-lookup"><span data-stu-id="de73a-115">If there is, the background collection suspends itself so that foreground garbage collection can occur.</span></span> <span data-ttu-id="de73a-116">Po zakończeniu wyrzucania elementów bezużytecznych, dedykowane wątki wyrzucania elementów bezużytecznych w tle i wątki użytkownika są wznawiane.</span><span class="sxs-lookup"><span data-stu-id="de73a-116">After the foreground garbage collection is completed, the dedicated background garbage collection threads and user threads resume.</span></span>

<span data-ttu-id="de73a-117">Wyrzucanie elementów bezużytecznych w tle usuwa ograniczenia alokacji narzucone przez współbieżne wyrzucanie elementów bezużytecznych, ponieważ tymczasowe wyrzucanie elementów bezużytecznych</span><span class="sxs-lookup"><span data-stu-id="de73a-117">Background garbage collection removes allocation restrictions imposed by concurrent garbage collection, because ephemeral garbage collections can occur during background garbage collection.</span></span> <span data-ttu-id="de73a-118">Wyrzucanie elementów bezużytecznych w tle umożliwia usuwanie martwych obiektów z generacji tymczasowych.</span><span class="sxs-lookup"><span data-stu-id="de73a-118">Background garbage collection can remove dead objects in ephemeral generations.</span></span> <span data-ttu-id="de73a-119">Można również rozszerzyć stertę, jeśli jest to konieczne podczas wyrzucania elementów bezużytecznych generacji 1.</span><span class="sxs-lookup"><span data-stu-id="de73a-119">It can also expand the heap if needed during a generation 1 garbage collection.</span></span>

## <a name="background-workstation-vs-server-gc"></a><span data-ttu-id="de73a-120">W tle stacja robocza a serwer GC</span><span class="sxs-lookup"><span data-stu-id="de73a-120">Background workstation vs. server GC</span></span>

<span data-ttu-id="de73a-121">Począwszy od .NET Framework 4,5, wyrzucanie elementów bezużytecznych w tle jest dostępne dla serwera GC.</span><span class="sxs-lookup"><span data-stu-id="de73a-121">Starting with .NET Framework 4.5, background garbage collection is available for server GC.</span></span> <span data-ttu-id="de73a-122">W tle jest domyślnym trybem odzyskiwania pamięci serwera.</span><span class="sxs-lookup"><span data-stu-id="de73a-122">Background GC is the default mode for server garbage collection.</span></span>

<span data-ttu-id="de73a-123">Odzyskiwanie pamięci serwera w tle działa podobnie do wyrzucania elementów bezużytecznych stacji roboczej, ale istnieje kilka różnic:</span><span class="sxs-lookup"><span data-stu-id="de73a-123">Background server garbage collection functions similarly to background workstation garbage collection, but there are a few differences:</span></span>

- <span data-ttu-id="de73a-124">Wyrzucanie elementów bezużytecznych stacji roboczej w tle używa jednego dedykowanego wątku wyrzucania elementów bezużytecznych w tle, podczas gdy odzyskiwanie pamięci serwera</span><span class="sxs-lookup"><span data-stu-id="de73a-124">Background workstation garbage collection uses one dedicated background garbage collection thread, whereas background server garbage collection uses multiple threads.</span></span> <span data-ttu-id="de73a-125">Zwykle istnieje dedykowany wątek dla każdego procesora logicznego.</span><span class="sxs-lookup"><span data-stu-id="de73a-125">Typically, there's a dedicated thread for each logical processor.</span></span>

- <span data-ttu-id="de73a-126">W przeciwieństwie do wątku wyrzucania elementów bezużytecznych w tle stacji roboczej serwer w tle nie przekracza limitu czasu.</span><span class="sxs-lookup"><span data-stu-id="de73a-126">Unlike the workstation background garbage collection thread, the background server GC threads do not time out.</span></span>

<span data-ttu-id="de73a-127">Na poniższej ilustracji przedstawiono wyrzucanie elementów bezużytecznych *stacji roboczej* w tle wykonywane w osobnym, dedykowanym wątku:</span><span class="sxs-lookup"><span data-stu-id="de73a-127">The following illustration shows background *workstation* garbage collection performed on a separate, dedicated thread:</span></span>

![Wyrzucanie elementów bezużytecznych stacji roboczej](media/fundamentals/background-workstation-garbage-collection.png)

<span data-ttu-id="de73a-129">Na poniższej ilustracji przedstawiono wyrzucanie elementów bezużytecznych *serwera* w tle wykonywane w oddzielnych, dedykowanych wątkach:</span><span class="sxs-lookup"><span data-stu-id="de73a-129">The following illustration shows background *server* garbage collection performed on separate, dedicated threads:</span></span>

![Odzyskiwanie pamięci serwera w tle](media/fundamentals/background-server-garbage-collection.png)

## <a name="concurrent-garbage-collection"></a><span data-ttu-id="de73a-131">Jednoczesne wyrzucanie elementów bezużytecznych</span><span class="sxs-lookup"><span data-stu-id="de73a-131">Concurrent garbage collection</span></span>

> [!TIP]
> <span data-ttu-id="de73a-132">Ta sekcja ma zastosowanie do:</span><span class="sxs-lookup"><span data-stu-id="de73a-132">This section applies to:</span></span>
>
> - <span data-ttu-id="de73a-133">.NET Framework 3,5 i wcześniejszy dla wyrzucania elementów bezużytecznych stacji roboczych</span><span class="sxs-lookup"><span data-stu-id="de73a-133">.NET Framework 3.5 and earlier for workstation garbage collection</span></span>
> - <span data-ttu-id="de73a-134">.NET Framework 4 i starsze do wyrzucania elementów bezużytecznych serwera</span><span class="sxs-lookup"><span data-stu-id="de73a-134">.NET Framework 4 and earlier for server garbage collection</span></span>
>
> <span data-ttu-id="de73a-135">Współbieżne elementy bezużyteczne są zastępowane przez odzyskiwanie pamięci w tle w nowszych wersjach.</span><span class="sxs-lookup"><span data-stu-id="de73a-135">Concurrent garbage is replaced by background garbage collection in later versions.</span></span>

<span data-ttu-id="de73a-136">W systemie stacja robocza lub wyrzucanie elementów bezużytecznych serwera można [włączyć współbieżne wyrzucanie elementów bezużytecznych](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md), dzięki czemu wątki mogą działać równolegle z dedykowanym wątkiem, który wykonuje wyrzucanie elementów bezużytecznych przez większość czasu trwania kolekcji.</span><span class="sxs-lookup"><span data-stu-id="de73a-136">In workstation or server garbage collection, you can [enable concurrent garbage collection](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md), which enables threads to run concurrently with a dedicated thread that performs the garbage collection for most of the duration of the collection.</span></span> <span data-ttu-id="de73a-137">Ta opcja ma wpływ tylko na wyrzucanie elementów bezużytecznych w generacji 2; generacji 0 i 1 są zawsze niewspółbieżne, ponieważ kończą się szybko.</span><span class="sxs-lookup"><span data-stu-id="de73a-137">This option affects only garbage collections in generation 2; generations 0 and 1 are always non-concurrent because they finish fast.</span></span>

<span data-ttu-id="de73a-138">Współbieżne wyrzucanie elementów bezużytecznych umożliwia lepsze reagowanie aplikacji interaktywnych przez zminimalizowanie przerw w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="de73a-138">Concurrent garbage collection enables interactive applications to be more responsive by minimizing pauses for a collection.</span></span> <span data-ttu-id="de73a-139">Zarządzane wątki mogą nadal uruchamiać większość czasu, gdy wątek współbieżnego odzyskiwania pamięci jest uruchomiony.</span><span class="sxs-lookup"><span data-stu-id="de73a-139">Managed threads can continue to run most of the time while the concurrent garbage collection thread is running.</span></span> <span data-ttu-id="de73a-140">Powoduje to krótsze pauzy podczas wyrzucania elementów bezużytecznych.</span><span class="sxs-lookup"><span data-stu-id="de73a-140">This results in shorter pauses while a garbage collection is occurring.</span></span>

<span data-ttu-id="de73a-141">Współbieżne wyrzucanie elementów bezużytecznych jest wykonywane w ramach dedykowanego wątku.</span><span class="sxs-lookup"><span data-stu-id="de73a-141">Concurrent garbage collection is performed on a dedicated thread.</span></span> <span data-ttu-id="de73a-142">Domyślnie środowisko CLR uruchamia wyrzucanie elementów bezużytecznych stacji roboczej z włączonym współbieżnym wyrzucaniem elementów bezużytecznych na komputerach z jednym procesorem lub na wiele procesorów</span><span class="sxs-lookup"><span data-stu-id="de73a-142">By default, the CLR runs workstation garbage collection with concurrent garbage collection enabled on both single-processor and multi-processor computers.</span></span>

<span data-ttu-id="de73a-143">Na poniższej ilustracji przedstawiono współbieżne wyrzucanie elementów bezużytecznych wykonywane w osobnym dedykowanym wątku.</span><span class="sxs-lookup"><span data-stu-id="de73a-143">The following illustration shows concurrent garbage collection performed on a separate dedicated thread.</span></span>

![Współbieżne wątki odzyskiwania pamięci](media/gc-concurrent.png)

## <a name="see-also"></a><span data-ttu-id="de73a-145">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="de73a-145">See also</span></span>

- [<span data-ttu-id="de73a-146">Stacja robocza i odzyskiwanie pamięci serwera</span><span class="sxs-lookup"><span data-stu-id="de73a-146">Workstation and server garbage collection</span></span>](workstation-server-gc.md)
- [<span data-ttu-id="de73a-147">Opcje konfiguracji czasu wykonywania dla wyrzucania elementów bezużytecznych</span><span class="sxs-lookup"><span data-stu-id="de73a-147">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
