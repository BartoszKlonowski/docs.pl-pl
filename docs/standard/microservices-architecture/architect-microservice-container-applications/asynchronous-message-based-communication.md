---
title: Oparta na komunikatach komunikacji asynchronicznej
description: "Architektura Mikrousług .NET dla aplikacji .NET konteneryzowanych | Oparta na komunikatach komunikacji asynchronicznej"
keywords: "Docker, Mikrousług, ASP.NET, kontenera"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: df39771295d12e122edbe27e91cd899e3318e301
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/22/2017
---
# <a name="asynchronous-message-based-communication"></a><span data-ttu-id="a8987-104">Oparta na komunikatach komunikacji asynchronicznej</span><span class="sxs-lookup"><span data-stu-id="a8987-104">Asynchronous message-based communication</span></span>

<span data-ttu-id="a8987-105">Asynchroniczne obsługi wiadomości i sterowane zdarzeniami komunikacji są krytyczne, gdy propagowanie zmian w wielu mikrousług oraz ich modeli domeny powiązane.</span><span class="sxs-lookup"><span data-stu-id="a8987-105">Asynchronous messaging and event-driven communication are critical when propagating changes across multiple microservices and their related domain models.</span></span> <span data-ttu-id="a8987-106">Jak wspomniano wcześniej w mikrousług dyskusji i konteksty ograniczone (usług łączności biznesowej), różne na różnych mikrousług lub usług łączności biznesowej oznacza modeli (użytkownika, klienta, produktu, konto, itp.).</span><span class="sxs-lookup"><span data-stu-id="a8987-106">As mentioned earlier in the discussion microservices and Bounded Contexts (BCs), models (User, Customer, Product, Account, etc.) can mean different things to different microservices or BCs.</span></span> <span data-ttu-id="a8987-107">Oznacza to, że podczas wprowadzania zmian, należy w celu uzgodnienia zmian w różnych modelach.</span><span class="sxs-lookup"><span data-stu-id="a8987-107">That means that when changes occur, you need some way to reconcile changes across the different models.</span></span> <span data-ttu-id="a8987-108">Rozwiązanie jest spójność ostateczna i komunikacji sterowane zdarzeniami oparte na asynchroniczną obsługę wiadomości.</span><span class="sxs-lookup"><span data-stu-id="a8987-108">A solution is eventual consistency and event-driven communication based on asynchronous messaging.</span></span>

<span data-ttu-id="a8987-109">Korzystając z komunikatów, procesy komunikują się przez wymianę wiadomości asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="a8987-109">When using messaging, processes communicate by exchanging messages asynchronously.</span></span> <span data-ttu-id="a8987-110">Klient wysyła polecenie lub żądanie do usługi wysyłając wiadomość.</span><span class="sxs-lookup"><span data-stu-id="a8987-110">A client makes a command or a request to a service by sending it a message.</span></span> <span data-ttu-id="a8987-111">Jeśli usługa musi odpowiedzieć, wysyła inną wiadomość do klienta.</span><span class="sxs-lookup"><span data-stu-id="a8987-111">If the service needs to reply, it sends a different message back to the client.</span></span> <span data-ttu-id="a8987-112">Ponieważ jest oparta na komunikatach komunikatu, klient przyjmie założenie, że odpowiedź nie otrzyma natychmiast, i że może być brak odpowiedzi na wszystkich.</span><span class="sxs-lookup"><span data-stu-id="a8987-112">Since it is a message-based communication, the client assumes that the reply will not be received immediately, and that there might be no response at all.</span></span>

<span data-ttu-id="a8987-113">Komunikat składa się nagłówka (metadane, takie jak informacje identyfikacyjne lub zabezpieczeń) i treść.</span><span class="sxs-lookup"><span data-stu-id="a8987-113">A message is composed by a header (metadata such as identification or security information) and a body.</span></span> <span data-ttu-id="a8987-114">Komunikaty są zwykle przesyłane za pośrednictwem protokołów asynchroniczne jak protokołu AMQP.</span><span class="sxs-lookup"><span data-stu-id="a8987-114">Messages are usually sent through asynchronous protocols like AMQP.</span></span>

<span data-ttu-id="a8987-115">Preferowany infrastruktury dla tego typu komunikacji w społeczności mikrousług jest brokera komunikatów lekkie, który jest inny niż brokerzy dużych i orchestrators używane w SOA.</span><span class="sxs-lookup"><span data-stu-id="a8987-115">The preferred infrastructure for this type of communication in the microservices community is a lightweight message broker, which is different than the large brokers and orchestrators used in SOA.</span></span> <span data-ttu-id="a8987-116">W brokerze lekkie wiadomości infrastruktury jest zazwyczaj "bez," działa tylko jako brokera komunikatów, z prostych implementacji, takie jak RabbitMQ lub magistralą skalowalna usługa w chmurze, takich jak usługi Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a8987-116">In a lightweight message broker, the infrastructure is typically “dumb,” acting only as a message broker, with simple implementations such as RabbitMQ or a scalable service bus in the cloud like Azure Service Bus.</span></span> <span data-ttu-id="a8987-117">W tym scenariuszu większość "inteligentne" planowania nadal znajduje się w punkty końcowe, które tworzenie i korzystanie z komunikatów — to znaczy w mikrousług.</span><span class="sxs-lookup"><span data-stu-id="a8987-117">In this scenario, most of the “smart” thinking still lives in the endpoints that are producing and consuming messages—that is, in the microservices.</span></span>

<span data-ttu-id="a8987-118">Inną regułę, które należy wykonać, jak to możliwe, jest do użycia tylko asynchroniczne wysyłanie komunikatów między wewnętrznych usług, a także używają synchroniczne komunikacji (takich jak HTTP) tylko z aplikacji klienta do usługi frontonu (bram interfejsu API oraz pierwszy poziom z mikrousług).</span><span class="sxs-lookup"><span data-stu-id="a8987-118">Another rule you should try to follow, as much as possible, is to use only asynchronous messaging between the internal services, and to use synchronous communication (such as HTTP) only from the client apps to the front-end services (API Gateways plus the first level of microservices).</span></span>

<span data-ttu-id="a8987-119">Istnieją dwa rodzaje komunikacji asynchronicznej obsługi komunikatów: komunikacji jednego odbiorcę komunikatów i wiele odbiorników komunikacji na podstawie komunikatu.</span><span class="sxs-lookup"><span data-stu-id="a8987-119">There are two kinds of asynchronous messaging communication: single receiver message-based communication, and multiple receivers message-based communication.</span></span> <span data-ttu-id="a8987-120">W poniższych sekcjach udostępniamy szczegółowe informacje o nich.</span><span class="sxs-lookup"><span data-stu-id="a8987-120">In the following sections we provide details about them.</span></span>

## <a name="single-receiver-message-based-communication"></a><span data-ttu-id="a8987-121">Komunikacja oparta na komunikatach jednego odbiornika</span><span class="sxs-lookup"><span data-stu-id="a8987-121">Single-receiver message-based communication</span></span> 

<span data-ttu-id="a8987-122">Komunikat asynchroniczne komunikacji z jednego odbiornika oznacza, że występuje komunikacja punkt-punkt, który zapewnia komunikat dokładnie jeden z użytkowników, która odczytuje z kanału i komunikat jest przetwarzany tylko raz.</span><span class="sxs-lookup"><span data-stu-id="a8987-122">Message-based asynchronous communication with a single receiver means there is point-to-point communication that delivers a message to exactly one of the consumers that is reading from the channel, and that the message is processed just once.</span></span> <span data-ttu-id="a8987-123">Istnieją jednak sytuacji specjalnych.</span><span class="sxs-lookup"><span data-stu-id="a8987-123">However, there are special situations.</span></span> <span data-ttu-id="a8987-124">Na przykład w systemie chmury, która podejmuje próbę usuwania skutków błędów, ten sam komunikat mógł zostać wysłany wiele razy.</span><span class="sxs-lookup"><span data-stu-id="a8987-124">For instance, in a cloud system that tries to automatically recover from failures, the same message could be sent multiple times.</span></span> <span data-ttu-id="a8987-125">Z powodu sieci lub inne błędy klient musi być w stanie ponowić próbę wysyłanie wiadomości, a serwer ma do wykonania operacji być idempotentności, aby przetworzyć komunikatu o określonym tylko raz.</span><span class="sxs-lookup"><span data-stu-id="a8987-125">Due to network or other failures, the client has to be able to retry sending messages, and the server has to implement an operation to be idempotent in order to process a particular message just once.</span></span>

<span data-ttu-id="a8987-126">Komunikacja oparta na komunikatach jednego odbiornika najlepiej nadaje się do wysyłania poleceń asynchroniczne z jednego mikrousługi do innego, jak pokazano w rysunek 4-18 ilustrujący takie podejście.</span><span class="sxs-lookup"><span data-stu-id="a8987-126">Single-receiver message-based communication is especially well suited for sending asynchronous commands from one microservice to another as shown in Figure 4-18 that illustrates this approach.</span></span>

<span data-ttu-id="a8987-127">Po uruchomieniu wysyłania wiadomości-komunikacji (albo z poleceń i zdarzeń), należy unikać mieszanie komunikacji wiadomości z synchronicznego komunikacji HTTP.</span><span class="sxs-lookup"><span data-stu-id="a8987-127">Once you start sending message-based communication (either with commands or events), you should avoid mixing message-based communication with synchronous HTTP communication.</span></span>

![](./media/image18.PNG)

<span data-ttu-id="a8987-128">**Rysunek 4-18**.</span><span class="sxs-lookup"><span data-stu-id="a8987-128">**Figure 4-18**.</span></span> <span data-ttu-id="a8987-129">Pojedynczy mikrousługi, otrzymywanie komunikatów asynchronicznych</span><span class="sxs-lookup"><span data-stu-id="a8987-129">A single microservice receiving an asynchronous message</span></span>

<span data-ttu-id="a8987-130">Należy pamiętać, że gdy polecenia pochodzą z aplikacji klienckich, ich można zaimplementować jako synchroniczne polecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="a8987-130">Note that when the commands come from client applications, they can be implemented as HTTP synchronous commands.</span></span> <span data-ttu-id="a8987-131">Należy używać poleceń oparta na komunikatach, gdy będziesz potrzebować skalowalności lub, gdy już proces biznesowy oparta na komunikatach.</span><span class="sxs-lookup"><span data-stu-id="a8987-131">You should use message-based commands when you need higher scalability or when you are already in a message-based business process.</span></span>

## <a name="multiple-receivers-message-based-communication"></a><span data-ttu-id="a8987-132">Wiele odbiorników komunikacji wiadomości</span><span class="sxs-lookup"><span data-stu-id="a8987-132">Multiple-receivers message-based communication</span></span> 

<span data-ttu-id="a8987-133">Jako bardziej elastyczne podejście można również używać mechanizmu publikowania/subskrypcji, tak aby komunikacji od nadawcy będzie mikrousług dodatkowe subskrybenta lub aplikacjami zewnętrznymi.</span><span class="sxs-lookup"><span data-stu-id="a8987-133">As a more flexible approach, you might also want to use a publish/subscribe mechanism so that your communication from the sender will be available to additional subscriber microservices or to external applications.</span></span> <span data-ttu-id="a8987-134">W związku z tym pomaga wykonaj [otwarty/zamknięty zasady](https://en.wikipedia.org/wiki/Open/closed_principle) wysyłania usługi.</span><span class="sxs-lookup"><span data-stu-id="a8987-134">Thus, it helps you to follow the [open/closed principle](https://en.wikipedia.org/wiki/Open/closed_principle) in the sending service.</span></span> <span data-ttu-id="a8987-135">Można dodać w ten sposób dodatkowe subskrybentów w przyszłości, bez konieczności modyfikowania usługi nadawcy.</span><span class="sxs-lookup"><span data-stu-id="a8987-135">That way, additional subscribers can be added in the future without the need to modify the sender service.</span></span>

<span data-ttu-id="a8987-136">Korzystając z komunikatu publikowania/subskrypcji, być może używasz interfejsu magistrali zdarzenia do publikowania zdarzeń do dowolnego subskrybenta.</span><span class="sxs-lookup"><span data-stu-id="a8987-136">When you use a publish/subscribe communication, you might be using an event bus interface to publish events to any subscriber.</span></span>

## <a name="asynchronous-event-driven-communication"></a><span data-ttu-id="a8987-137">Komunikacji asynchronicznej sterowane zdarzeniami</span><span class="sxs-lookup"><span data-stu-id="a8987-137">Asynchronous event-driven communication</span></span>

<span data-ttu-id="a8987-138">Podczas korzystania z komunikacji asynchronicznej sterowane zdarzeniami, mikrousługi publikuje integracji zdarzenie, gdy wydarzy się coś w jego domenie i innym mikrousługi musi wiedzieć, jak zmiany ceny mikrousługi katalogu produktów.</span><span class="sxs-lookup"><span data-stu-id="a8987-138">When using asynchronous event-driven communication, a microservice publishes an integration event when something happens within its domain and another microservice needs to be aware of it, like a price change in a product catalog microservice.</span></span> <span data-ttu-id="a8987-139">Mikrousług dodatkowe subskrybować zdarzenia, aby mogły one odbierać je asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="a8987-139">Additional microservices subscribe to the events so they can receive them asynchronously.</span></span> <span data-ttu-id="a8987-140">W takim przypadku odbiorców może aktualizować jednostek własnej domeny, co może powodować więcej zdarzeń integracji do opublikowania.</span><span class="sxs-lookup"><span data-stu-id="a8987-140">When that happens, the receivers might update their own domain entities, which can cause more integration events to be published.</span></span> <span data-ttu-id="a8987-141">Ten system publikowania/subskrypcji zwykle odbywa się przy użyciu implementacji magistrali zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="a8987-141">This publish/subscribe system is usually performed by using an implementation of an event bus.</span></span> <span data-ttu-id="a8987-142">Magistrali zdarzeń mogą służyć jako abstrakcji lub interfejsu z interfejsu API, który chcesz subskrybować zdarzeń oraz do publikowania zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="a8987-142">The event bus can be designed as an abstraction or interface, with the API that is needed to subscribe or unsubscribe to events and to publish events.</span></span> <span data-ttu-id="a8987-143">Magistrali zdarzeń również może zawierać jeden lub więcej implementacje oparte na wszystkie brokera między procesami i obsługi wiadomości, jak kolejki wiadomości lub obsługującego komunikacji asynchronicznej i modelu publikowania/subskrypcji usługi service bus.</span><span class="sxs-lookup"><span data-stu-id="a8987-143">The event bus can also have one or more implementations based on any inter-process and messaging broker, like a messaging queue or service bus that supports asynchronous communication and a publish/subscribe model.</span></span>

<span data-ttu-id="a8987-144">Jeśli system używa spójność ostateczna regulowane przez zdarzeń integracji, zaleca się czy tego podejścia być jasno całkowicie dla użytkownika końcowego.</span><span class="sxs-lookup"><span data-stu-id="a8987-144">If a system uses eventual consistency driven by integration events, it is recommended that this approach be made completely clear to the end user.</span></span> <span data-ttu-id="a8987-145">System nie należy używać metody, która symuluje zdarzeń integracji, takich jak SignalR lub systemów sondowania z klienta.</span><span class="sxs-lookup"><span data-stu-id="a8987-145">The system should not use an approach that mimics integration events, like SignalR or polling systems from the client.</span></span> <span data-ttu-id="a8987-146">Użytkownik końcowy i właściciel firmy muszą jawnie obejmować spójność ostateczna w systemie i pamiętaj, że w wielu przypadkach firmy nie ma problem z tej metody, tak długo, jak jest jawne.</span><span class="sxs-lookup"><span data-stu-id="a8987-146">The end user and the business owner have to explicitly embrace eventual consistency in the system and realize that in many cases the business does not have any problem with this approach, as long as it is explicit.</span></span>

<span data-ttu-id="a8987-147">Jak wspomniano wcześniej w [problemy i rozwiązania rozproszone Zarządzanie danych](#challenges-and-solutions-for-distributed-data-management) sekcji zdarzeń integracji można użyć do wykonania zadań biznesowych, które obejmują wiele mikrousług.</span><span class="sxs-lookup"><span data-stu-id="a8987-147">As noted earlier in the [Challenges and solutions for distributed data management](#challenges-and-solutions-for-distributed-data-management) section, you can use integration events to implement business tasks that span multiple microservices.</span></span> <span data-ttu-id="a8987-148">W związku z tym konieczne będzie spójność ostateczna między tymi usługami.</span><span class="sxs-lookup"><span data-stu-id="a8987-148">Thus you will have eventual consistency between those services.</span></span> <span data-ttu-id="a8987-149">Po pewnym czasie spójne transakcji składa się z kolekcji rozproszonej akcji.</span><span class="sxs-lookup"><span data-stu-id="a8987-149">An eventually consistent transaction is made up of a collection of distributed actions.</span></span> <span data-ttu-id="a8987-150">W każdej akcji powiązanych mikrousługi aktualizuje jednostką domeny i publikuje inne zdarzenie integracji, który wywołuje akcję dalej w ramach tego samego zadania biznesowe na trasie.</span><span class="sxs-lookup"><span data-stu-id="a8987-150">At each action, the related microservice updates a domain entity and publishes another integration event that raises the next action within the same end-to-end business task.</span></span>

<span data-ttu-id="a8987-151">Punkt ważne jest, czy może chcesz komunikują się z wielu mikrousług, który subskrybują tego samego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="a8987-151">An important point is that you might want to communicate to multiple microservices that are subscribed to the same event.</span></span> <span data-ttu-id="a8987-152">Aby to zrobić, można użyć publikowania/subskrypcji wiadomości na podstawie sterowane zdarzeniami komunikacji, jak pokazano w rysunek 4-19.</span><span class="sxs-lookup"><span data-stu-id="a8987-152">To do so, you can use publish/subscribe messaging based on event-driven communication, as shown in Figure 4-19.</span></span> <span data-ttu-id="a8987-153">Ten mechanizm publikowania/subskrypcji nie jest zarezerwowana architektury mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="a8987-153">This publish/subscribe mechanism is not exclusive to the microservice architecture.</span></span> <span data-ttu-id="a8987-154">Jest on podobny do sposobu [ograniczone kontekstów](http://martinfowler.com/bliki/BoundedContext.html) w skontaktować się DDD lub sposób propagacji aktualizacji z bazy danych zapisu do bazy danych do odczytu w [poleceń i zapytań podział odpowiedzialności (CQRS)](http://martinfowler.com/bliki/CQRS.html)wzorzec architektury.</span><span class="sxs-lookup"><span data-stu-id="a8987-154">It is similar to the way [Bounded Contexts](http://martinfowler.com/bliki/BoundedContext.html) in DDD should communicate, or to the way you propagate updates from the write database to the read database in the [Command and Query Responsibility Segregation (CQRS)](http://martinfowler.com/bliki/CQRS.html) architecture pattern.</span></span> <span data-ttu-id="a8987-155">Celem jest spójność ostateczna między wiele źródeł danych w rozproszonym systemie.</span><span class="sxs-lookup"><span data-stu-id="a8987-155">The goal is to have eventual consistency between multiple data sources across your distributed system.</span></span>

![](./media/image19.png)

<span data-ttu-id="a8987-156">**Rysunek 4-19**.</span><span class="sxs-lookup"><span data-stu-id="a8987-156">**Figure 4-19**.</span></span> <span data-ttu-id="a8987-157">Komunikacja komunikatów asynchronicznych sterowane zdarzeniami</span><span class="sxs-lookup"><span data-stu-id="a8987-157">Asynchronous event-driven message communication</span></span>

<span data-ttu-id="a8987-158">Implementacji zależy, który protokół do użycia na potrzeby komunikacji sterowane zdarzeniami, na podstawie komunikatu.</span><span class="sxs-lookup"><span data-stu-id="a8987-158">Your implementation will determine what protocol to use for event-driven, message-based communications.</span></span> <span data-ttu-id="a8987-159">[Protokół AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol) mogą pomóc osiągnąć niezawodny umieszczonych w kolejce.</span><span class="sxs-lookup"><span data-stu-id="a8987-159">[AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol) can help achieve reliable queued communication.</span></span>

<span data-ttu-id="a8987-160">Korzystając z magistrali zdarzeń, warto użyć poziom abstrakcji (np. interfejsu magistrali zdarzenia) oparty na powiązanych implementacja klas z kodem przy użyciu interfejsu API z brokera komunikatów, takie jak [RabbitMQ](https://www.rabbitmq.com/) lub service bus, podobnie jak [Usługi azure Service Bus z tematów](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="a8987-160">When you use an event bus, you might want to use an abstraction level (like an event bus interface) based on a related implementation in classes with code using the API from a message broker like [RabbitMQ](https://www.rabbitmq.com/) or a service bus like [Azure Service Bus with Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="a8987-161">Alternatywnie można użyć wyższego poziomu magistrali usług, takich jak NServiceBus, MassTransit lub Brighter zwrócone z magistrali zdarzeń i publikowania/subskrypcji systemu.</span><span class="sxs-lookup"><span data-stu-id="a8987-161">Alternatively, you might want to use a higher-level service bus like NServiceBus, MassTransit, or Brighter to articulate your event bus and publish/subscribe system.</span></span>

## <a name="a-note-about-messaging-technologies-for-production-systems"></a><span data-ttu-id="a8987-162">Uwagi dotyczące obsługi wiadomości technologii dla systemów produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="a8987-162">A note about messaging technologies for production systems</span></span>

<span data-ttu-id="a8987-163">Są dostępne dla implementacji magistrali sieci zdarzenia abstrakcyjnego technologie obsługi wiadomości na różnych poziomach.</span><span class="sxs-lookup"><span data-stu-id="a8987-163">The messaging technologies available for implementing your abstract event bus are at different levels.</span></span> <span data-ttu-id="a8987-164">Na przykład produktów, takich jak RabbitMQ (wiadomości transportu brokera) i usługi Azure Service Bus znajdują się na niższym poziomie niż innych produktów, takich jak NServiceBus, MassTransit albo Brighter, który może pracować na górze RabbitMQ i usługi Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a8987-164">For instance, products like RabbitMQ (a messaging broker transport) and Azure Service Bus sit at a lower level than other products like, NServiceBus, MassTransit, or Brighter, which can work on top of RabbitMQ and Azure Service Bus.</span></span> <span data-ttu-id="a8987-165">Wybór zależy od liczby różnorodnych funkcji na poziomie aplikacji i poza pole skalowalność, potrzebnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a8987-165">Your choice depends on how many rich features at the application level and out-of-the-box scalability you need for your application.</span></span> <span data-ttu-id="a8987-166">Do wykonania po prostu magistrali Weryfikacja koncepcji zdarzeń środowiska deweloperskiego, jak możemy to zostało zrobione w przykładowym eShopOnContainers proste wdrożenia na uruchomione w kontenerze Docker RabbitMQ może być wystarczającej ilości.</span><span class="sxs-lookup"><span data-stu-id="a8987-166">For implementing just a proof-of-concept event bus for your development environment, as we have done in the eShopOnContainers sample, a simple implementation on top of RabbitMQ running on a Docker container might be enough.</span></span>

<span data-ttu-id="a8987-167">Niemniej jednak w przypadku krytycznym i systemów produkcyjnych, które wymagają skalowalność funkcji hyper może chcesz ocenić Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a8987-167">However, for mission-critical and production systems that need hyper-scalability, you might want to evaluate Azure Service Bus.</span></span> <span data-ttu-id="a8987-168">Wysokiego poziomu obiektów abstrakcyjnych i funkcje, które ułatwia projektowanie aplikacji rozproszonych zaleca się dokonanie oceny innych magistrali usługi handlowych i open source, takie jak NServiceBus, MassTransit i Brighter.</span><span class="sxs-lookup"><span data-stu-id="a8987-168">For high-level abstractions and features that make the development of distributed applications easier, we recommend that you evaluate other commercial and open-source service buses, such as NServiceBus, MassTransit, and Brighter.</span></span> <span data-ttu-id="a8987-169">Oczywiście można tworzyć własne funkcje usługi service bus na niższym poziomie technologii, takich jak RabbitMQ i Docker.</span><span class="sxs-lookup"><span data-stu-id="a8987-169">Of course, you can build your own service-bus features on top of lower-level technologies like RabbitMQ and Docker.</span></span> <span data-ttu-id="a8987-170">Ale pracy żmudne procesy może koszt za dużo aplikacji niestandardowych przedsiębiorstwa.</span><span class="sxs-lookup"><span data-stu-id="a8987-170">But that plumbing work might cost too much for a custom enterprise application.</span></span>

## <a name="resiliently-publishing-to-the-event-bus"></a><span data-ttu-id="a8987-171">Publikowanie resiliently magistrali zdarzeń</span><span class="sxs-lookup"><span data-stu-id="a8987-171">Resiliently publishing to the event bus</span></span>

<span data-ttu-id="a8987-172">Żądanie w przypadku implementowania architekturę sterowane zdarzeniami między wieloma mikrousług jest automatycznie aktualizacji stanu w oryginalnym mikrousługi podczas resiliently publikowania do magistrali zdarzeń, w jakiś sposób na podstawie jej zdarzenia pokrewne integracji transakcje.</span><span class="sxs-lookup"><span data-stu-id="a8987-172">A challenge when implementing an event-driven architecture across multiple microservices is how to atomically update state in the original microservice while resiliently publishing its related integration event into the event bus, somehow based on transactions.</span></span> <span data-ttu-id="a8987-173">Poniżej przedstawiono na kilka sposobów, aby to osiągnąć, chociaż może to być również dodatkowych metod.</span><span class="sxs-lookup"><span data-stu-id="a8987-173">The following are a few ways to accomplish this, although there could be additional approaches as well.</span></span>

-   <span data-ttu-id="a8987-174">Przy użyciu transakcyjne kolejki (w oparciu o usługi DTC) takie jak usługi MSMQ.</span><span class="sxs-lookup"><span data-stu-id="a8987-174">Using a transactional (DTC-based) queue like MSMQ.</span></span> <span data-ttu-id="a8987-175">(Jednak jest podejście starszej wersji).</span><span class="sxs-lookup"><span data-stu-id="a8987-175">(However, this is a legacy approach.)</span></span>

-   <span data-ttu-id="a8987-176">Przy użyciu [wyszukiwania dziennik transakcji](http://www.scoop.it/t/sql-server-transaction-log-mining).</span><span class="sxs-lookup"><span data-stu-id="a8987-176">Using [transaction log mining](http://www.scoop.it/t/sql-server-transaction-log-mining).</span></span>

-   <span data-ttu-id="a8987-177">Przy użyciu pełnego [źródłem zdarzeń](https://msdn.microsoft.com/en-us/library/dn589792.aspx) wzorca.</span><span class="sxs-lookup"><span data-stu-id="a8987-177">Using full [Event Sourcing](https://msdn.microsoft.com/en-us/library/dn589792.aspx) pattern.</span></span>

-   <span data-ttu-id="a8987-178">Przy użyciu [wzorzec Skrzynka nadawcza](http://gistlabs.com/2014/05/the-outbox/): Tabela transakcyjne bazy danych jako kolejki komunikatów, który ma być base składnika tworzenia zdarzeń, który może utworzyć zdarzenia i opublikuj go.</span><span class="sxs-lookup"><span data-stu-id="a8987-178">Using the [Outbox pattern](http://gistlabs.com/2014/05/the-outbox/): a transactional database table as a message queue that will be the base for an event-creator component that would create the event and publish it.</span></span>

<span data-ttu-id="a8987-179">Tematy dodatkowe, które należy wziąć pod uwagę podczas komunikacji asynchronicznej są projektu wiadomości i deduplikacji wiadomości.</span><span class="sxs-lookup"><span data-stu-id="a8987-179">Additional topics to consider when using asynchronous communication are message idempotence and message deduplication.</span></span> <span data-ttu-id="a8987-180">Te tematy w sekcji [wdrożenie oparte na zdarzeniu komunikacji między mikrousług (zdarzeń integracji)](#implementing_event_based_comms_microserv) dalszej części tego przewodnika.</span><span class="sxs-lookup"><span data-stu-id="a8987-180">These topics are covered in the section [Implementing event-based communication between microservices (integration events)](#implementing_event_based_comms_microserv) later in this guide.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="a8987-181">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="a8987-181">Additional resources</span></span>

-   <span data-ttu-id="a8987-182">**Zdarzenia zmiennych wiadomości**
    [*http://soapatterns.org/design\_wzorce lub zdarzenia\_zmiennych\_obsługi wiadomości*](http://soapatterns.org/design_patterns/event_driven_messaging)</span><span class="sxs-lookup"><span data-stu-id="a8987-182">**Event Driven Messaging**
[*http://soapatterns.org/design\_patterns/event\_driven\_messaging*](http://soapatterns.org/design_patterns/event_driven_messaging)</span></span>

-   <span data-ttu-id="a8987-183">**Kanał publikowania/subskrypcji**
    [*http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html*](http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html)</span><span class="sxs-lookup"><span data-stu-id="a8987-183">**Publish/Subscribe Channel**
[*http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html*](http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html)</span></span>

-   <span data-ttu-id="a8987-184">**Udi Dahan. Zawiera wyjaśnienie CQRS**
    [*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span><span class="sxs-lookup"><span data-stu-id="a8987-184">**Udi Dahan. Clarified CQRS**
[*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span></span>

-   <span data-ttu-id="a8987-185">**Poleceń i zapytań podział odpowiedzialności (CQRS)**
    [*https://docs.microsoft.com/azure/architecture/patterns/cqrs*](https://docs.microsoft.com/azure/architecture/patterns/cqrs)</span><span class="sxs-lookup"><span data-stu-id="a8987-185">**Command and Query Responsibility Segregation (CQRS)**
[*https://docs.microsoft.com/azure/architecture/patterns/cqrs*](https://docs.microsoft.com/azure/architecture/patterns/cqrs)</span></span>

-   <span data-ttu-id="a8987-186">**Komunikacja pomiędzy ograniczone kontekstów**
    [*https://msdn.microsoft.com/library/jj591572.aspx*](https://msdn.microsoft.com/library/jj591572.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8987-186">**Communicating Between Bounded Contexts**
[*https://msdn.microsoft.com/library/jj591572.aspx*](https://msdn.microsoft.com/library/jj591572.aspx)</span></span>

-   <span data-ttu-id="a8987-187">**Spójność ostateczna**
    [*https://en.wikipedia.org/wiki/Eventual\_spójności*](https://en.wikipedia.org/wiki/Eventual_consistency)</span><span class="sxs-lookup"><span data-stu-id="a8987-187">**Eventual consistency**
[*https://en.wikipedia.org/wiki/Eventual\_consistency*](https://en.wikipedia.org/wiki/Eventual_consistency)</span></span>

-   <span data-ttu-id="a8987-188">**Jimmy Bogard. Refaktoryzacja kierunku odporności: Ocena sprzężenia**
    [*https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/*](https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/)</span><span class="sxs-lookup"><span data-stu-id="a8987-188">**Jimmy Bogard. Refactoring Towards Resilience: Evaluating Coupling**
[*https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/*](https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="a8987-189">[Poprzednie] (komunikacji w — mikrousługi architecture.md) [dalej] (Obsługa mikrousługi apis.md)</span><span class="sxs-lookup"><span data-stu-id="a8987-189">[Previous] (communication-in-microservice-architecture.md) [Next] (maintain-microservice-apis.md)</span></span>
