---
title: Oparta na komunikatach komunikacji asynchronicznej
description: Architektura Mikrousług .NET konteneryzowanych aplikacji .NET | Oparta na komunikatach komunikacji asynchronicznej
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.openlocfilehash: 865966a70f18c9023e4c733d82ea90aba9478753
ms.sourcegitcommit: 9bd8f213b50f0e1a73e03bd1e840c917fbd6d20a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/27/2018
ms.locfileid: "50135378"
---
# <a name="asynchronous-message-based-communication"></a><span data-ttu-id="94ed4-103">Oparta na komunikatach komunikacji asynchronicznej</span><span class="sxs-lookup"><span data-stu-id="94ed4-103">Asynchronous message-based communication</span></span>

<span data-ttu-id="94ed4-104">Asynchroniczna Obsługa komunikatów i komunikacji oparte na zdarzeniach mają kluczowe znaczenie, gdy propagowanie zmian przez wiele mikrousług i ich modeli powiązanych domeny.</span><span class="sxs-lookup"><span data-stu-id="94ed4-104">Asynchronous messaging and event-driven communication are critical when propagating changes across multiple microservices and their related domain models.</span></span> <span data-ttu-id="94ed4-105">Jak wspomniano wcześniej w dyskusji mikrousług i ograniczone konteksty (usług łączności biznesowej), modele (użytkownika, klient, produkt, konta itp.) może mieć różne znaczenie w różnych mikrousług lub usług łączności biznesowej.</span><span class="sxs-lookup"><span data-stu-id="94ed4-105">As mentioned earlier in the discussion microservices and Bounded Contexts (BCs), models (User, Customer, Product, Account, etc.) can mean different things to different microservices or BCs.</span></span> <span data-ttu-id="94ed4-106">Oznacza to, że zmianach, należy jakiś sposób, aby uzgadniać zmiany w różnych modelach.</span><span class="sxs-lookup"><span data-stu-id="94ed4-106">That means that when changes occur, you need some way to reconcile changes across the different models.</span></span> <span data-ttu-id="94ed4-107">To rozwiązanie jest spójność i oparte na zdarzeniach komunikacji asynchronicznej obsługi komunikatów w oparciu.</span><span class="sxs-lookup"><span data-stu-id="94ed4-107">A solution is eventual consistency and event-driven communication based on asynchronous messaging.</span></span>

<span data-ttu-id="94ed4-108">Korzystając z komunikatów, procesy komunikują się przez wymianę wiadomości asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="94ed4-108">When using messaging, processes communicate by exchanging messages asynchronously.</span></span> <span data-ttu-id="94ed4-109">Klient wysyła polecenie lub żądanie do usługi wysyłając wiadomość.</span><span class="sxs-lookup"><span data-stu-id="94ed4-109">A client makes a command or a request to a service by sending it a message.</span></span> <span data-ttu-id="94ed4-110">Jeśli usługa musi odpowiedzieć, wysyła inny komunikat do klienta.</span><span class="sxs-lookup"><span data-stu-id="94ed4-110">If the service needs to reply, it sends a different message back to the client.</span></span> <span data-ttu-id="94ed4-111">Ponieważ jest oparta na komunikatach komunikacji, klient przyjmie założenie, że odpowiedź nie otrzyma od razu i że może być brak odpowiedzi na wszystkich.</span><span class="sxs-lookup"><span data-stu-id="94ed4-111">Since it is a message-based communication, the client assumes that the reply will not be received immediately, and that there might be no response at all.</span></span>

<span data-ttu-id="94ed4-112">Komunikat składa się nagłówka (metadane, takie jak informacje identyfikacyjne lub zabezpieczeń) i treść.</span><span class="sxs-lookup"><span data-stu-id="94ed4-112">A message is composed by a header (metadata such as identification or security information) and a body.</span></span> <span data-ttu-id="94ed4-113">Komunikaty są zwykle wysyłane za pośrednictwem protokołów asynchronicznych, takich jak AMQP.</span><span class="sxs-lookup"><span data-stu-id="94ed4-113">Messages are usually sent through asynchronous protocols like AMQP.</span></span>

<span data-ttu-id="94ed4-114">Preferowany infrastrukturę dla tego typu komunikacji w społeczności mikrousług jest broker uproszczone komunikatów, który jest inny niż brokerów duże i koordynatorów używane w SOA.</span><span class="sxs-lookup"><span data-stu-id="94ed4-114">The preferred infrastructure for this type of communication in the microservices community is a lightweight message broker, which is different than the large brokers and orchestrators used in SOA.</span></span> <span data-ttu-id="94ed4-115">Broker komunikatów uproszczone infrastruktura jest zazwyczaj "bez," działają wyłącznie jako broker komunikatów, za pomocą prostych implementacji, takich jak RabbitMQ lub skalowalne usługi Service bus w chmurze, taka jak Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="94ed4-115">In a lightweight message broker, the infrastructure is typically “dumb,” acting only as a message broker, with simple implementations such as RabbitMQ or a scalable service bus in the cloud like Azure Service Bus.</span></span> <span data-ttu-id="94ed4-116">W tym scenariuszu większość "eleganckie" myśleć nadal znajduje się punkty końcowe, które tworzenie i korzystanie z komunikatów — czyli w mikrousług.</span><span class="sxs-lookup"><span data-stu-id="94ed4-116">In this scenario, most of the “smart” thinking still lives in the endpoints that are producing and consuming messages—that is, in the microservices.</span></span>

<span data-ttu-id="94ed4-117">Inną regułę, które należy wykonać, jak to możliwe, jest używanie tylko asynchronicznej obsługi komunikatów między usługami wewnętrznej i do użycia synchronicznego komunikacji (na przykład HTTP) tylko z poziomu aplikacji klienta do usługi frontonu (bramy interfejsu API oraz pierwszy poziom mikrousługi).</span><span class="sxs-lookup"><span data-stu-id="94ed4-117">Another rule you should try to follow, as much as possible, is to use only asynchronous messaging between the internal services, and to use synchronous communication (such as HTTP) only from the client apps to the front-end services (API Gateways plus the first level of microservices).</span></span>

<span data-ttu-id="94ed4-118">Istnieją dwa rodzaje komunikacji asynchronicznej obsługi komunikatów: komunikacja oparta na komunikatach jednego odbiornika i wiele odbiorników komunikacji oparta na komunikatach.</span><span class="sxs-lookup"><span data-stu-id="94ed4-118">There are two kinds of asynchronous messaging communication: single receiver message-based communication, and multiple receivers message-based communication.</span></span> <span data-ttu-id="94ed4-119">W poniższych sekcjach, firma Microsoft zapewnia szczegółowe informacje o nich.</span><span class="sxs-lookup"><span data-stu-id="94ed4-119">In the following sections we provide details about them.</span></span>

## <a name="single-receiver-message-based-communication"></a><span data-ttu-id="94ed4-120">Komunikacja oparta na komunikatach jednego odbiornika</span><span class="sxs-lookup"><span data-stu-id="94ed4-120">Single-receiver message-based communication</span></span> 

<span data-ttu-id="94ed4-121">Oparta na komunikatach komunikacji asynchronicznej za pomocą jednego odbiornika oznacza, że ma bezpośredniej komunikacji, który zapewnia komunikat z dokładnie jednym konsumentów, która odczytuje z kanału, a komunikat jest przetwarzany tylko raz.</span><span class="sxs-lookup"><span data-stu-id="94ed4-121">Message-based asynchronous communication with a single receiver means there is point-to-point communication that delivers a message to exactly one of the consumers that is reading from the channel, and that the message is processed just once.</span></span> <span data-ttu-id="94ed4-122">Istnieją jednak szczególnych sytuacjach.</span><span class="sxs-lookup"><span data-stu-id="94ed4-122">However, there are special situations.</span></span> <span data-ttu-id="94ed4-123">Na przykład w system w chmurze, która próbuje automatycznie odzyskać sprawność po awarii, ten sam komunikat można było wysłać wiele razy.</span><span class="sxs-lookup"><span data-stu-id="94ed4-123">For instance, in a cloud system that tries to automatically recover from failures, the same message could be sent multiple times.</span></span> <span data-ttu-id="94ed4-124">Z powodu sieci lub inne błędy klient musi umożliwiać ponowne wysyłanie wiadomości, a serwer musi przeprowadzić wdrażanie operacji być idempotentne, aby przetworzyć określonego komunikatu o tylko raz.</span><span class="sxs-lookup"><span data-stu-id="94ed4-124">Due to network or other failures, the client has to be able to retry sending messages, and the server has to implement an operation to be idempotent in order to process a particular message just once.</span></span>

<span data-ttu-id="94ed4-125">Komunikacja oparta na komunikatach jednego odbiornika szczególnie dobrze nadaje się do wysyłania poleceń asynchronicznego z jednego mikrousług innemu pokazany w rysunek 4-18, to podejście pokazano.</span><span class="sxs-lookup"><span data-stu-id="94ed4-125">Single-receiver message-based communication is especially well suited for sending asynchronous commands from one microservice to another as shown in Figure 4-18 that illustrates this approach.</span></span>

<span data-ttu-id="94ed4-126">Po rozpoczęciu wysyłania oparta na komunikatach komunikacji (albo za pomocą poleceń lub zdarzenia), należy unikać mieszania oparta na komunikatach komunikacji przy użyciu synchronicznej komunikacji HTTP.</span><span class="sxs-lookup"><span data-stu-id="94ed4-126">Once you start sending message-based communication (either with commands or events), you should avoid mixing message-based communication with synchronous HTTP communication.</span></span>

![](./media/image18.PNG)

<span data-ttu-id="94ed4-127">**Rysunek 4-18**.</span><span class="sxs-lookup"><span data-stu-id="94ed4-127">**Figure 4-18**.</span></span> <span data-ttu-id="94ed4-128">Odbieranie komunikatów asynchronicznych pojedynczych mikrousług</span><span class="sxs-lookup"><span data-stu-id="94ed4-128">A single microservice receiving an asynchronous message</span></span>

<span data-ttu-id="94ed4-129">Należy pamiętać, że przypadku polecenia pochodzących z aplikacji klienckich, ich można zaimplementować jako synchroniczna poleceń protokołu HTTP.</span><span class="sxs-lookup"><span data-stu-id="94ed4-129">Note that when the commands come from client applications, they can be implemented as HTTP synchronous commands.</span></span> <span data-ttu-id="94ed4-130">Należy użyć poleceń oparta na komunikatach, gdy będziesz potrzebować skalowalności, lub gdy masz już proces biznesowy oparta na komunikatach.</span><span class="sxs-lookup"><span data-stu-id="94ed4-130">You should use message-based commands when you need higher scalability or when you are already in a message-based business process.</span></span>

## <a name="multiple-receivers-message-based-communication"></a><span data-ttu-id="94ed4-131">Komunikacja oparta na komunikatach wielu odbiorców</span><span class="sxs-lookup"><span data-stu-id="94ed4-131">Multiple-receivers message-based communication</span></span> 

<span data-ttu-id="94ed4-132">Co jest bardziej elastyczne podejście można również używany był mechanizm publikowania/subskrybowania, tak, aby komunikacja od nadawcy, dostępna dla mikrousług dodatkowe subskrybenta lub do aplikacji zewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="94ed4-132">As a more flexible approach, you might also want to use a publish/subscribe mechanism so that your communication from the sender will be available to additional subscriber microservices or to external applications.</span></span> <span data-ttu-id="94ed4-133">W związku z tym, pomaga postępuj zgodnie z [otwarty/zamknięty zasady](https://en.wikipedia.org/wiki/Open/closed_principle) wysyłania usługi.</span><span class="sxs-lookup"><span data-stu-id="94ed4-133">Thus, it helps you to follow the [open/closed principle](https://en.wikipedia.org/wiki/Open/closed_principle) in the sending service.</span></span> <span data-ttu-id="94ed4-134">W ten sposób dodatkowe subskrybentów można dodawać w przyszłości, bez konieczności modyfikowania usługi nadawcy.</span><span class="sxs-lookup"><span data-stu-id="94ed4-134">That way, additional subscribers can be added in the future without the need to modify the sender service.</span></span>

<span data-ttu-id="94ed4-135">Użycie opcji publikowania/subskrybowania komunikacji, być może używasz interfejs magistrali zdarzeń do publikowania zdarzeń w celu każdy subskrybent.</span><span class="sxs-lookup"><span data-stu-id="94ed4-135">When you use a publish/subscribe communication, you might be using an event bus interface to publish events to any subscriber.</span></span>

## <a name="asynchronous-event-driven-communication"></a><span data-ttu-id="94ed4-136">Komunikacji asynchronicznej oparte na zdarzeniach</span><span class="sxs-lookup"><span data-stu-id="94ed4-136">Asynchronous event-driven communication</span></span>

<span data-ttu-id="94ed4-137">Korzystając z komunikacji asynchronicznej oparte na zdarzeniach, mikrousługi publikuje zdarzenie integracji, gdy coś, co się dzieje w jego domenie i innym mikrousług musi wiedzieć, jak zmiany ceny w mikrousługach katalogu produktów.</span><span class="sxs-lookup"><span data-stu-id="94ed4-137">When using asynchronous event-driven communication, a microservice publishes an integration event when something happens within its domain and another microservice needs to be aware of it, like a price change in a product catalog microservice.</span></span> <span data-ttu-id="94ed4-138">Dodatkowe mikrousług subskrybują zdarzenia, dzięki czemu mogą one odbierać je asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="94ed4-138">Additional microservices subscribe to the events so they can receive them asynchronously.</span></span> <span data-ttu-id="94ed4-139">Jeśli tak się stanie, odbiorców może aktualizować własne jednostki domeny, co może powodować więcej zdarzeń integracji do opublikowania.</span><span class="sxs-lookup"><span data-stu-id="94ed4-139">When that happens, the receivers might update their own domain entities, which can cause more integration events to be published.</span></span> <span data-ttu-id="94ed4-140">Ten system publikowania/subskrybowania zwykle odbywa się przy użyciu implementacji magistrali zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="94ed4-140">This publish/subscribe system is usually performed by using an implementation of an event bus.</span></span> <span data-ttu-id="94ed4-141">Magistrali zdarzeń mogą służyć jako abstrakcji lub interfejs, za pomocą interfejsu API, który chcesz subskrybować zdarzenia oraz do publikowania zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="94ed4-141">The event bus can be designed as an abstraction or interface, with the API that is needed to subscribe or unsubscribe to events and to publish events.</span></span> <span data-ttu-id="94ed4-142">Magistrali zdarzeń może również zawierać jeden lub więcej implementacje oparte na każdego brokera między procesami i obsługi komunikatów, takich jak kolejki komunikatów lub usługi service bus, który obsługuje komunikacji asynchronicznej i modelu publikowania/subskrybowania.</span><span class="sxs-lookup"><span data-stu-id="94ed4-142">The event bus can also have one or more implementations based on any inter-process and messaging broker, like a messaging queue or service bus that supports asynchronous communication and a publish/subscribe model.</span></span>

<span data-ttu-id="94ed4-143">Jeśli system używa prowadzona przez zdarzenia integracji spójność ostateczną, zalecane jest, czy tego podejścia być jasno całkowicie użytkownikowi końcowemu.</span><span class="sxs-lookup"><span data-stu-id="94ed4-143">If a system uses eventual consistency driven by integration events, it is recommended that this approach be made completely clear to the end user.</span></span> <span data-ttu-id="94ed4-144">System nie należy używać metody, która naśladuje zdarzenia integracji, takich jak SignalR lub systemy sondowania z klienta.</span><span class="sxs-lookup"><span data-stu-id="94ed4-144">The system should not use an approach that mimics integration events, like SignalR or polling systems from the client.</span></span> <span data-ttu-id="94ed4-145">Użytkownik końcowy i właściciel firmy trzeba jawnie Uwzględniaj spójność ostateczną w systemie i weź pod uwagę, że w wielu przypadkach firmy nie ma żadnych problem tego podejścia tak długo, jak jest jawne.</span><span class="sxs-lookup"><span data-stu-id="94ed4-145">The end user and the business owner have to explicitly embrace eventual consistency in the system and realize that in many cases the business does not have any problem with this approach, as long as it is explicit.</span></span>

<span data-ttu-id="94ed4-146">Jak wspomniano wcześniej w [problemy i rozwiązania dotyczące rozproszonego zarządzania danymi](#challenges-and-solutions-for-distributed-data-management) sekcji, można użyć zdarzenia integracji do zaimplementowania zadań biznesowych, obejmujących wiele mikrousług.</span><span class="sxs-lookup"><span data-stu-id="94ed4-146">As noted earlier in the [Challenges and solutions for distributed data management](#challenges-and-solutions-for-distributed-data-management) section, you can use integration events to implement business tasks that span multiple microservices.</span></span> <span data-ttu-id="94ed4-147">Ten sposób będziesz mieć spójności ostatecznej między tymi usługami.</span><span class="sxs-lookup"><span data-stu-id="94ed4-147">Thus you will have eventual consistency between those services.</span></span> <span data-ttu-id="94ed4-148">Transakcja ostatecznie spójną składa się z kolekcją rozproszonych działań.</span><span class="sxs-lookup"><span data-stu-id="94ed4-148">An eventually consistent transaction is made up of a collection of distributed actions.</span></span> <span data-ttu-id="94ed4-149">W każdej akcji powiązanych mikrousług zaktualizuje jednostkę domeny i publikuje inne zdarzenie integracji, która wywołuje następnej akcji w obrębie tego samego zadania biznesowe end-to-end.</span><span class="sxs-lookup"><span data-stu-id="94ed4-149">At each action, the related microservice updates a domain entity and publishes another integration event that raises the next action within the same end-to-end business task.</span></span>

<span data-ttu-id="94ed4-150">To ważny punkt jest, możesz zechcieć do komunikacji z wielu mikrousług, które mają subskrypcję do tego samego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="94ed4-150">An important point is that you might want to communicate to multiple microservices that are subscribed to the same event.</span></span> <span data-ttu-id="94ed4-151">Aby to zrobić, można użyć publikowania/subskrybowania komunikatów na podstawie oparte na zdarzeniach komunikacji, jak pokazano w rysunek 4-19.</span><span class="sxs-lookup"><span data-stu-id="94ed4-151">To do so, you can use publish/subscribe messaging based on event-driven communication, as shown in Figure 4-19.</span></span> <span data-ttu-id="94ed4-152">Ten mechanizm publikowania/subskrybowania nie jest wyłącznie w architekturze mikrousług.</span><span class="sxs-lookup"><span data-stu-id="94ed4-152">This publish/subscribe mechanism is not exclusive to the microservice architecture.</span></span> <span data-ttu-id="94ed4-153">Jest on podobny do sposobu [ograniczone konteksty](https://martinfowler.com/bliki/BoundedContext.html) w DDD skontaktować się lub sposób Propagacja aktualizacje z bazy danych zapisu do bazy danych do odczytu w [odpowiedzialności polecenia i zapytania podziału (CQRS)](https://martinfowler.com/bliki/CQRS.html)wzorzec architektury.</span><span class="sxs-lookup"><span data-stu-id="94ed4-153">It is similar to the way [Bounded Contexts](https://martinfowler.com/bliki/BoundedContext.html) in DDD should communicate, or to the way you propagate updates from the write database to the read database in the [Command and Query Responsibility Segregation (CQRS)](https://martinfowler.com/bliki/CQRS.html) architecture pattern.</span></span> <span data-ttu-id="94ed4-154">Celem jest zapewnienie spójności ostatecznej między wieloma źródłami danych w rozproszonym systemie.</span><span class="sxs-lookup"><span data-stu-id="94ed4-154">The goal is to have eventual consistency between multiple data sources across your distributed system.</span></span>

![](./media/image19.png)

<span data-ttu-id="94ed4-155">**Rysunek 4-19**.</span><span class="sxs-lookup"><span data-stu-id="94ed4-155">**Figure 4-19**.</span></span> <span data-ttu-id="94ed4-156">Komunikacja komunikatów oparte na zdarzeniach asynchronicznych</span><span class="sxs-lookup"><span data-stu-id="94ed4-156">Asynchronous event-driven message communication</span></span>

<span data-ttu-id="94ed4-157">Twoja implementacja określi, co protokołu na potrzeby komunikacji oparte na zdarzeniach, oparta na komunikatach.</span><span class="sxs-lookup"><span data-stu-id="94ed4-157">Your implementation will determine what protocol to use for event-driven, message-based communications.</span></span> <span data-ttu-id="94ed4-158">[Protokół AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol) może pomóc w osiągnięciu niezawodnej komunikacji umieszczonych w kolejce.</span><span class="sxs-lookup"><span data-stu-id="94ed4-158">[AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol) can help achieve reliable queued communication.</span></span>

<span data-ttu-id="94ed4-159">Korzystając z magistrali zdarzeń, warto użyć poziom abstrakcji (np. interfejsu magistrali zdarzenia) oparty na powiązane implementacji klas z kodu za pomocą interfejsu API z brokera komunikatów, takie jak [RabbitMQ](https://www.rabbitmq.com/) lub service bus, podobnie jak [Usługi azure Service Bus z obsługą tematów](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="94ed4-159">When you use an event bus, you might want to use an abstraction level (like an event bus interface) based on a related implementation in classes with code using the API from a message broker like [RabbitMQ](https://www.rabbitmq.com/) or a service bus like [Azure Service Bus with Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="94ed4-160">Alternatywnie można umożliwiają wyższego poziomu magistrali usług, takich jak NServiceBus, MassTransit lub Brighter sformułowania usługi Service bus event i publikowania/subskrybowania systemu.</span><span class="sxs-lookup"><span data-stu-id="94ed4-160">Alternatively, you might want to use a higher-level service bus like NServiceBus, MassTransit, or Brighter to articulate your event bus and publish/subscribe system.</span></span>

## <a name="a-note-about-messaging-technologies-for-production-systems"></a><span data-ttu-id="94ed4-161">Uwaga dotycząca komunikatów technologii dla systemów produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="94ed4-161">A note about messaging technologies for production systems</span></span>

<span data-ttu-id="94ed4-162">Technologii obsługi komunikatów, która jest dostępna dla implementacji usługi Service bus zdarzenie abstrakcyjne są na różnych poziomach.</span><span class="sxs-lookup"><span data-stu-id="94ed4-162">The messaging technologies available for implementing your abstract event bus are at different levels.</span></span> <span data-ttu-id="94ed4-163">Na przykład produktów, takich jak RabbitMQ (komunikatów transportu brokera) i usługi Azure Service Bus znajdują się na niższym poziomie niż innych produktów, takich jak NServiceBus, MassTransit lub Brighter, która może działać na podstawie RabbitMQ i usługi Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="94ed4-163">For instance, products like RabbitMQ (a messaging broker transport) and Azure Service Bus sit at a lower level than other products like, NServiceBus, MassTransit, or Brighter, which can work on top of RabbitMQ and Azure Service Bus.</span></span> <span data-ttu-id="94ed4-164">Wybór zależy od liczby rozbudowanych funkcji na poziomie aplikacji i skalowalności out-of--box, czego potrzebujesz do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="94ed4-164">Your choice depends on how many rich features at the application level and out-of-the-box scalability you need for your application.</span></span> <span data-ttu-id="94ed4-165">Do wykonania po prostu magistrali zdarzeń weryfikacji koncepcji dla swojego środowiska programowania, jak wykonaliśmy w tym przykładzie w ramach aplikacji eShopOnContainers proste wdrażanie na podstawie RabbitMQ uruchomione w kontenerze platformy Docker może wystarczyć.</span><span class="sxs-lookup"><span data-stu-id="94ed4-165">For implementing just a proof-of-concept event bus for your development environment, as we have done in the eShopOnContainers sample, a simple implementation on top of RabbitMQ running on a Docker container might be enough.</span></span>

<span data-ttu-id="94ed4-166">Jednak w przypadku o kluczowym znaczeniu oraz systemów produkcyjnych, wymagających hyper skalowalność, warto do oceny usługi Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="94ed4-166">However, for mission-critical and production systems that need hyper-scalability, you might want to evaluate Azure Service Bus.</span></span> <span data-ttu-id="94ed4-167">Dla abstrakcji wysokiego poziomu i funkcje, które ułatwić opracowywanie zawartości aplikacji rozproszonych firma Microsoft zaleca oceny innych magistrali usługi komercyjnych i typu open source, takich jak NServiceBus MassTransit i Brighter.</span><span class="sxs-lookup"><span data-stu-id="94ed4-167">For high-level abstractions and features that make the development of distributed applications easier, we recommend that you evaluate other commercial and open-source service buses, such as NServiceBus, MassTransit, and Brighter.</span></span> <span data-ttu-id="94ed4-168">Oczywiście można tworzyć własne funkcje usługi service bus na podstawie technologii niższego poziomu, takie jak RabbitMQ i platformy Docker.</span><span class="sxs-lookup"><span data-stu-id="94ed4-168">Of course, you can build your own service-bus features on top of lower-level technologies like RabbitMQ and Docker.</span></span> <span data-ttu-id="94ed4-169">Ale działające nadmiar kosztów za dużo aplikacji niestandardowych przedsiębiorstwa.</span><span class="sxs-lookup"><span data-stu-id="94ed4-169">But that plumbing work might cost too much for a custom enterprise application.</span></span>

## <a name="resiliently-publishing-to-the-event-bus"></a><span data-ttu-id="94ed4-170">Publikowanie odpornych magistrali zdarzeń</span><span class="sxs-lookup"><span data-stu-id="94ed4-170">Resiliently publishing to the event bus</span></span>

<span data-ttu-id="94ed4-171">Wyzwanie w przypadku implementowania architektury oparte na zdarzeniach między wiele mikrousług jest sposób niepodzielne aktualizacji stanu w oryginalnym mikrousług podczas odpornych publikowania jej zdarzenia powiązane integracji do magistrali zdarzeń, w jakiś sposób na podstawie transakcje.</span><span class="sxs-lookup"><span data-stu-id="94ed4-171">A challenge when implementing an event-driven architecture across multiple microservices is how to atomically update state in the original microservice while resiliently publishing its related integration event into the event bus, somehow based on transactions.</span></span> <span data-ttu-id="94ed4-172">Poniżej przedstawiono kilka sposobów, aby to osiągnąć, chociaż może to być także dodatkowe metody.</span><span class="sxs-lookup"><span data-stu-id="94ed4-172">The following are a few ways to accomplish this, although there could be additional approaches as well.</span></span>

-   <span data-ttu-id="94ed4-173">Za pomocą transakcyjne kolejki (w oparciu o usługi DTC) takich jak usługi MSMQ.</span><span class="sxs-lookup"><span data-stu-id="94ed4-173">Using a transactional (DTC-based) queue like MSMQ.</span></span> <span data-ttu-id="94ed4-174">(Jednak to podejście starszej wersji.)</span><span class="sxs-lookup"><span data-stu-id="94ed4-174">(However, this is a legacy approach.)</span></span>

-   <span data-ttu-id="94ed4-175">Za pomocą [wyszukiwania dziennik transakcji](https://www.scoop.it/t/sql-server-transaction-log-mining).</span><span class="sxs-lookup"><span data-stu-id="94ed4-175">Using [transaction log mining](https://www.scoop.it/t/sql-server-transaction-log-mining).</span></span>

-   <span data-ttu-id="94ed4-176">Przy użyciu pełnej [określania źródła zdarzeń](https://msdn.microsoft.com/library/dn589792.aspx) wzorca.</span><span class="sxs-lookup"><span data-stu-id="94ed4-176">Using full [Event Sourcing](https://msdn.microsoft.com/library/dn589792.aspx) pattern.</span></span>

-   <span data-ttu-id="94ed4-177">Za pomocą [wzorzec Skrzynka nadawcza](http://gistlabs.com/2014/05/the-outbox/): Tabela transakcji bazy danych jako kolejki komunikatów, który ma być base, aby składnik Twórca zdarzenia, który może utworzyć zdarzenia i opublikujesz je.</span><span class="sxs-lookup"><span data-stu-id="94ed4-177">Using the [Outbox pattern](http://gistlabs.com/2014/05/the-outbox/): a transactional database table as a message queue that will be the base for an event-creator component that would create the event and publish it.</span></span>

<span data-ttu-id="94ed4-178">Tematy dodatkowe, które należy wziąć pod uwagę podczas korzystania z komunikacji asynchronicznej są idempotentność wiadomości i deduplikacji wiadomości.</span><span class="sxs-lookup"><span data-stu-id="94ed4-178">Additional topics to consider when using asynchronous communication are message idempotence and message deduplication.</span></span> <span data-ttu-id="94ed4-179">Te tematy zostały omówione w sekcji [Implementowanie komunikacji opartej na zdarzeniach między mikrousługami (zdarzenia integracji)](#implementing_event_based_comms_microserv) później w tym przewodniku.</span><span class="sxs-lookup"><span data-stu-id="94ed4-179">These topics are covered in the section [Implementing event-based communication between microservices (integration events)](#implementing_event_based_comms_microserv) later in this guide.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="94ed4-180">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="94ed4-180">Additional resources</span></span>

-   <span data-ttu-id="94ed4-181">**Aktivita typu EventDriven komunikatów**
    [*http://soapatterns.org/design\_patterns/event\_driven\_messaging*](http://soapatterns.org/design_patterns/event_driven_messaging)</span><span class="sxs-lookup"><span data-stu-id="94ed4-181">**Event Driven Messaging**
[*http://soapatterns.org/design\_patterns/event\_driven\_messaging*](http://soapatterns.org/design_patterns/event_driven_messaging)</span></span>

-   <span data-ttu-id="94ed4-182">**Publikowania/subskrybowania kanału**
    [*https://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html*](https://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html)</span><span class="sxs-lookup"><span data-stu-id="94ed4-182">**Publish/Subscribe Channel**
[*https://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html*](https://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html)</span></span>

-   <span data-ttu-id="94ed4-183">**Udi Dahan. Sklarowanego CQRS**
    [*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span><span class="sxs-lookup"><span data-stu-id="94ed4-183">**Udi Dahan. Clarified CQRS**
[*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span></span>

-   <span data-ttu-id="94ed4-184">**Polecenie and Query Responsibility Segregation (CQRS)**
    [*https://docs.microsoft.com/azure/architecture/patterns/cqrs*](https://docs.microsoft.com/azure/architecture/patterns/cqrs)</span><span class="sxs-lookup"><span data-stu-id="94ed4-184">**Command and Query Responsibility Segregation (CQRS)**
[*https://docs.microsoft.com/azure/architecture/patterns/cqrs*](https://docs.microsoft.com/azure/architecture/patterns/cqrs)</span></span>

-   <span data-ttu-id="94ed4-185">**Komunikacja między ograniczone konteksty**
    [*https://msdn.microsoft.com/library/jj591572.aspx*](https://msdn.microsoft.com/library/jj591572.aspx)</span><span class="sxs-lookup"><span data-stu-id="94ed4-185">**Communicating Between Bounded Contexts**
[*https://msdn.microsoft.com/library/jj591572.aspx*](https://msdn.microsoft.com/library/jj591572.aspx)</span></span>

-   <span data-ttu-id="94ed4-186">**Spójność ostateczna**
    [*https://en.wikipedia.org/wiki/Eventual\_consistency*](https://en.wikipedia.org/wiki/Eventual_consistency)</span><span class="sxs-lookup"><span data-stu-id="94ed4-186">**Eventual consistency**
[*https://en.wikipedia.org/wiki/Eventual\_consistency*](https://en.wikipedia.org/wiki/Eventual_consistency)</span></span>

-   <span data-ttu-id="94ed4-187">**Jimmy Bogard. Refaktoryzacja kierunku odporności: Ocena sprzężenia**
    [*https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/*](https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/)</span><span class="sxs-lookup"><span data-stu-id="94ed4-187">**Jimmy Bogard. Refactoring Towards Resilience: Evaluating Coupling**
[*https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/*](https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="94ed4-188">[Poprzednie](communication-in-microservice-architecture.md)
[dalej](maintain-microservice-apis.md)</span><span class="sxs-lookup"><span data-stu-id="94ed4-188">[Previous](communication-in-microservice-architecture.md)
[Next](maintain-microservice-apis.md)</span></span>
