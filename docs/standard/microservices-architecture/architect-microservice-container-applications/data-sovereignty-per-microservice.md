---
title: Suwerenność danych przypadająca na mikrousługę
description: Suwerenność danych przypadająca na mikrousługę jest jednym z punktów kay mikrousług. Każda mikrousługa musi być jedynym właścicielem swojej bazy danych, udostępniając je żadnego innego. Oczywiście wszystkie wystąpienia elementu mikrousługi połączyć z tej samej bazy danych o wysokiej dostępności.
ms.date: 09/20/2018
ms.openlocfilehash: ccb12451cd7cd44938e09d171eb29e614786f469
ms.sourcegitcommit: 8699383914c24a0df033393f55db3369db728a7b
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/15/2019
ms.locfileid: "65644449"
---
# <a name="data-sovereignty-per-microservice"></a><span data-ttu-id="dd5a7-105">Suwerenność danych przypadająca na mikrousługę</span><span class="sxs-lookup"><span data-stu-id="dd5a7-105">Data sovereignty per microservice</span></span>

<span data-ttu-id="dd5a7-106">Regułę ważne dla architektury mikrousług jest to, że każda mikrousługa musi być właścicielem swoich danych domeny i logiki.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-106">An important rule for microservices architecture is that each microservice must own its domain data and logic.</span></span> <span data-ttu-id="dd5a7-107">Tak samo, jak Pełna aplikacja jest właścicielem jego logikę i dane, więc należy poszczególne mikrousługi właścicielem jego logikę i dane w ramach autonomicznego cykl życia, niezależnie od wdrożenia na mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-107">Just as a full application owns its logic and data, so must each microservice own its logic and data under an autonomous lifecycle, with independent deployment per microservice.</span></span>

<span data-ttu-id="dd5a7-108">Oznacza to, że model koncepcyjny domeny będą się różnić między podsystemów lub mikrousług.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-108">This means that the conceptual model of the domain will differ between subsystems or microservices.</span></span> <span data-ttu-id="dd5a7-109">Należy wziąć pod uwagę aplikacje dla przedsiębiorstw, gdzie relacji zarządzania (CRM) aplikacji klientów, transakcji zakupu podsystemów i podsystemów pomocy technicznej klienta każdego wywołania w atrybutów jednostki unikatowy klienta i dane, a każda używającego innego Ograniczony kontekst (BC).</span><span class="sxs-lookup"><span data-stu-id="dd5a7-109">Consider enterprise applications, where customer relationship management (CRM) applications, transactional purchase subsystems, and customer support subsystems each call on unique customer entity attributes and data, and where each employs a different Bounded Context (BC).</span></span>

<span data-ttu-id="dd5a7-110">Ta zasada jest podobna we [projektowania opartego na domenach (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), gdzie każdy [ograniczony kontekst](https://martinfowler.com/bliki/BoundedContext.html) lub autonomiczne podsystemu bądź usługi, musi być właścicielem swój model domeny (danych oraz zachowanie i logikę).</span><span class="sxs-lookup"><span data-stu-id="dd5a7-110">This principle is similar in [Domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), where each [Bounded Context](https://martinfowler.com/bliki/BoundedContext.html) or autonomous subsystem or service must own its domain model (data plus logic and behavior).</span></span> <span data-ttu-id="dd5a7-111">W każdym kontekście ograniczonych DDD skorelowany jeden mikrousług business (jednej lub kilku usług).</span><span class="sxs-lookup"><span data-stu-id="dd5a7-111">Each DDD Bounded Context correlates to one business microservice (one or several services).</span></span> <span data-ttu-id="dd5a7-112">Ten punkt o wzorcu ograniczonego kontekstu jest rozwinięte w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-112">This point about the Bounded Context pattern is expanded in the next section.</span></span>

<span data-ttu-id="dd5a7-113">Z drugiej strony podejście tradycyjnych (dane monolityczną) używane w wielu aplikacjach jest tylko kilka baz danych lub jednym scentralizowanej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-113">On the other hand, the traditional (monolithic data) approach used in many applications is to have a single centralized database or just a few databases.</span></span> <span data-ttu-id="dd5a7-114">Często jest znormalizowana bazę danych SQL używaną dla całej aplikacji i wszystkich jego podsystemów wewnętrznego, jak pokazano w rysunek 4 – 7.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-114">This is often a normalized SQL database that's used for the whole application and all its internal subsystems, as shown in Figure 4-7.</span></span>

![Tradycyjne podejście istnieje pojedynczej bazy danych, udostępnione dla wszystkich usług, zwykle w przypadku architektury warstwowej.](./media/image7.png)

<span data-ttu-id="dd5a7-117">**Rysunek 4 – 7**.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-117">**Figure 4-7**.</span></span> <span data-ttu-id="dd5a7-118">Porównanie niezależność danych: monolityczne bazy danych w porównaniu z mikrousług</span><span class="sxs-lookup"><span data-stu-id="dd5a7-118">Data sovereignty comparison: monolithic database versus microservices</span></span>

<span data-ttu-id="dd5a7-119">To podejście w scentralizowanej bazie danych początkowo wygląda prostsze i wydaje się umożliwiają wielokrotne użycie jednostek w różne podsystemy, aby wszystko, co jest zgodne.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-119">The centralized database approach initially looks simpler and seems to enable reuse of entities in different subsystems to make everything consistent.</span></span> <span data-ttu-id="dd5a7-120">Ale w rzeczywistości jest za duży tabel, obsługujących wiele różne podsystemy zawierające atrybutów i kolumny, które nie są wymagane w większości przypadków.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-120">But the reality is you end up with huge tables that serve many different subsystems, and that include attributes and columns that aren't needed in most cases.</span></span> <span data-ttu-id="dd5a7-121">Przypomina to próba użycia tej samej fizycznej mapy górach dziennik krótki, biorąc podróży samochodu dzień długi i uczenia lokalizacji geograficznej.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-121">It's like trying to use the same physical map for hiking a short trail, taking a day-long car trip, and learning geography.</span></span>

<span data-ttu-id="dd5a7-122">Monolitycznych z zwykle jednej relacyjnej bazie danych ma dwie ważne korzyści: [Transakcje ACID](https://en.wikipedia.org/wiki/ACID) i języka SQL, zarówno roboczych we wszystkich tabelach i dane związane z aplikacją.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-122">A monolithic application with typically a single relational database has two important benefits: [ACID transactions](https://en.wikipedia.org/wiki/ACID) and the SQL language, both working across all the tables and data related to your application.</span></span> <span data-ttu-id="dd5a7-123">Takie podejście umożliwia łatwe Napisz zapytanie, które łączy dane z wielu tabel.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-123">This approach provides a way to easily write a query that combines data from multiple tables.</span></span>

<span data-ttu-id="dd5a7-124">Jednak dostęp do danych staje się bardziej złożone, po przeniesieniu do architektury mikrousług.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-124">However, data access becomes much more complex when you move to a microservices architecture.</span></span> <span data-ttu-id="dd5a7-125">Ale nawet wtedy, gdy transakcje ACID można lub powinny być używane w ramach ograniczonego kontekstu lub mikrousług, dane należące do poszczególnych mikrousług są prywatne tego mikrousług i może zostać oceniony jedynie za pośrednictwem jego interfejsu API mikrousług.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-125">But even when ACID transactions can or should be used within a microservice or Bounded Context, the data owned by each microservice is private to that microservice and can only be accessed via its microservice API.</span></span> <span data-ttu-id="dd5a7-126">Zawieranie danych gwarantuje, że mikrousługi są luźno powiązane i może się rozwijać, niezależnie od siebie nawzajem.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-126">Encapsulating the data ensures that the microservices are loosely coupled and can evolve independently of one another.</span></span> <span data-ttu-id="dd5a7-127">Jeśli wiele usług zostały dostęp do tych samych danych, aktualizacje schematów wymaga przeprowadzenia skoordynowanych aktualizacji do wszystkich usług.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-127">If multiple services were accessing the same data, schema updates would require coordinated updates to all the services.</span></span> <span data-ttu-id="dd5a7-128">Spowoduje to przerwanie Autonomia cyklu życia mikrousług.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-128">This would break the microservice lifecycle autonomy.</span></span> <span data-ttu-id="dd5a7-129">Ale struktur danych rozproszonych oznacza, że nie możesz wprowadzać pojedynczej transakcji ACID między mikrousług.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-129">But distributed data structures mean that you can't make a single ACID transaction across microservices.</span></span> <span data-ttu-id="dd5a7-130">Z kolei oznacza to, że podczas procesu biznesowego obejmuje wiele mikrousług, należy użyć spójności ostatecznej.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-130">This in turn means you must use eventual consistency when a business process spans multiple microservices.</span></span> <span data-ttu-id="dd5a7-131">Jest to znacznie trudniejsze do zaimplementowania niż proste sprzężenia SQL, ponieważ nie można utworzyć ograniczenia integralności, lub użyj transakcje rozproszone między osobne bazy danych, ponieważ wyjaśnimy w późniejszym czasie na.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-131">This is much harder to implement than simple SQL joins, because you can't create integrity constraints or use distributed transactions between separate databases, as we'll explain later on.</span></span> <span data-ttu-id="dd5a7-132">Podobnie wiele innych funkcji relacyjnej bazy danych nie są dostępne w wielu mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-132">Similarly, many other relational database features aren't available across multiple microservices.</span></span>

<span data-ttu-id="dd5a7-133">Kontynuowanie nawet, różne mikrousługi często używają różnych *rodzajów* baz danych.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-133">Going even further, different microservices often use different *kinds* of databases.</span></span> <span data-ttu-id="dd5a7-134">Nowoczesne aplikacje sklepu i proces różnych rodzajów danych oraz relacyjnej bazy danych nie zawsze jest najlepszym wyborem.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-134">Modern applications store and process diverse kinds of data, and a relational database isn't always the best choice.</span></span> <span data-ttu-id="dd5a7-135">W przypadku niektórych przypadków użycia, bazy danych NoSQL, takie jak Azure cosmos DB lub MongoDB obejmujące wygodniejszy modelu danych oraz oferuje lepszą wydajność i skalowalność niż bazy danych SQL, takich jak program SQL Server lub usługi Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-135">For some use cases, a NoSQL database such as Azure CosmosDB or MongoDB might have a more convenient data model and offer better performance and scalability than a SQL database like SQL Server or Azure SQL Database.</span></span> <span data-ttu-id="dd5a7-136">W innych przypadkach relacyjnej bazy danych jest nadal jest najlepszym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-136">In other cases, a relational database is still the best approach.</span></span> <span data-ttu-id="dd5a7-137">W związku z tym, aplikacje oparte na mikrousługach często używają kombinacji bazy danych SQL i NoSQL, która jest czasem nazywany [ubocznym](https://martinfowler.com/bliki/PolyglotPersistence.html) podejście.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-137">Therefore, microservices-based applications often use a mixture of SQL and NoSQL databases, which is sometimes called the [polyglot persistence](https://martinfowler.com/bliki/PolyglotPersistence.html) approach.</span></span>

<span data-ttu-id="dd5a7-138">Partycjonowane trwałego polyglot architektura do przechowywania danych ma wiele zalet.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-138">A partitioned, polyglot-persistent architecture for data storage has many benefits.</span></span> <span data-ttu-id="dd5a7-139">Obejmują one luźno powiązanych usług i lepszą wydajność, skalowalność, kosztów i możliwości zarządzania.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-139">These include loosely coupled services and better performance, scalability, costs, and manageability.</span></span> <span data-ttu-id="dd5a7-140">Jednak może to wprowadzić niektóre wyzwania, zarządzania danych rozproszonych, jak wyjaśniono w "[identyfikowanie ograniczeń modelu domeny](identify-microservice-domain-model-boundaries.md)" później w tym rozdziale.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-140">However, it can introduce some distributed data management challenges, as explained in "[Identifying domain-model boundaries](identify-microservice-domain-model-boundaries.md)" later in this chapter.</span></span>

## <a name="the-relationship-between-microservices-and-the-bounded-context-pattern"></a><span data-ttu-id="dd5a7-141">Relacja między mikrousług i wzorzec ograniczony kontekst</span><span class="sxs-lookup"><span data-stu-id="dd5a7-141">The relationship between microservices and the Bounded Context pattern</span></span>

<span data-ttu-id="dd5a7-142">Pojęcie mikrousług jest pochodną [wzorzec ograniczony kontekst (BC)](https://martinfowler.com/bliki/BoundedContext.html) w [projektowania opartego na domenach (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span><span class="sxs-lookup"><span data-stu-id="dd5a7-142">The concept of microservice derives from the [Bounded Context (BC) pattern](https://martinfowler.com/bliki/BoundedContext.html) in [domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span></span> <span data-ttu-id="dd5a7-143">DDD dotyczy dużych modeli przez podzielenie ich na wielu usług łączności biznesowej i są wyraźnie ich granice.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-143">DDD deals with large models by dividing them into multiple BCs and being explicit about their boundaries.</span></span> <span data-ttu-id="dd5a7-144">Każdy BC musi mieć swój własny model i bazy danych. Podobnie każda mikrousługa jest właścicielem jej powiązane dane.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-144">Each BC must have its own model and database; likewise, each microservice owns its related data.</span></span> <span data-ttu-id="dd5a7-145">Ponadto każdy BC zazwyczaj ma swój własny [wszechobecne języka](https://martinfowler.com/bliki/UbiquitousLanguage.html) ułatwiających komunikację między programistami i ekspertów z konkretnych dziedzin.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-145">In addition, each BC usually has its own [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) to help communication between software developers and domain experts.</span></span>

<span data-ttu-id="dd5a7-146">Te warunki (głównie domeny jednostek) w języku uniwersalnych może mieć różne nazwy w różnych kontekstach powiązana, jednostki nawet wtedy, gdy różne domeny udostępnianie tej samej tożsamości (czyli unikatowy identyfikator, który został użyty do odczytu jednostki magazynu).</span><span class="sxs-lookup"><span data-stu-id="dd5a7-146">Those terms (mainly domain entities) in the ubiquitous language can have different names in different Bounded Contexts, even when different domain entities share the same identity (that is, the unique ID that's used to read the entity from storage).</span></span> <span data-ttu-id="dd5a7-147">Na przykład w kontekstach ograniczonych profilu użytkownika, jednostka domeny użytkownika może udostępniać tożsamości jednostka domeny kupujący w kontekście szeregowania ograniczone.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-147">For instance, in a user-profile Bounded Context, the User domain entity might share identity with the Buyer domain entity in the ordering Bounded Context.</span></span>

<span data-ttu-id="dd5a7-148">Mikrousługi w związku z tym przypomina ograniczony kontekst, ale również określi, czy jest to usługa rozproszonej.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-148">A microservice is therefore like a Bounded Context, but it also specifies that it's a distributed service.</span></span> <span data-ttu-id="dd5a7-149">Stworzona w oddzielnym procesie dla każdego kontekstu ograniczonego i musi używać protokoły rozproszonego zanotowanej wcześniej, takich jak HTTP/HTTPS, funkcja WebSockets, lub [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span><span class="sxs-lookup"><span data-stu-id="dd5a7-149">It's built as a separate process for each Bounded Context, and it must use the distributed protocols noted earlier, like HTTP/HTTPS, WebSockets, or [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span></span> <span data-ttu-id="dd5a7-150">Wzorzec ograniczony kontekst, jednak nie określa czy kontekstu ograniczonego są usługami rozproszonymi lub jeśli jest po prostu logiczną granic (na przykład ogólny podsystemu) w aplikacji monolitycznej wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-150">The Bounded Context pattern, however, doesn't specify whether the Bounded Context is a distributed service or if it's simply a logical boundary (such as a generic subsystem) within a monolithic-deployment application.</span></span>

<span data-ttu-id="dd5a7-151">Jest ważne podkreślić, że zdefiniowanie usługi dla każdego kontekstu ograniczonego jest dobrym miejscem do rozpoczęcia.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-151">It's important to highlight that defining a service for each Bounded Context is a good place to start.</span></span> <span data-ttu-id="dd5a7-152">Ale nie trzeba ograniczać projektu do niego.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-152">But you don't have to constrain your design to it.</span></span> <span data-ttu-id="dd5a7-153">Czasami należy projektować ograniczonego kontekstu lub firm mikrousług składa się z kilku usług fizycznych.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-153">Sometimes you must design a Bounded Context or business microservice composed of several physical services.</span></span> <span data-ttu-id="dd5a7-154">Ale ostatecznie obu wzorców - ograniczony kontekst i mikrousługi są ściśle powiązane.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-154">But ultimately, both patterns -Bounded Context and microservice- are closely related.</span></span>

<span data-ttu-id="dd5a7-155">DDD korzyści płynące z mikrousług uzyskując rzeczywistych granic w formie rozproszonych mikrousług.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-155">DDD benefits from microservices by getting real boundaries in the form of distributed microservices.</span></span> <span data-ttu-id="dd5a7-156">Ale pomysły, takie jak udostępnianie nie modelu między mikrousługami co chcecie również w kontekście ograniczone.</span><span class="sxs-lookup"><span data-stu-id="dd5a7-156">But ideas like not sharing the model between microservices are what you also want in a Bounded Context.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="dd5a7-157">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="dd5a7-157">Additional resources</span></span>

- <span data-ttu-id="dd5a7-158">**Chris Richardson. Wzorzec: Bazy danych na usługę** \\</span><span class="sxs-lookup"><span data-stu-id="dd5a7-158">**Chris Richardson. Pattern: Database per service** \\</span></span>
  <https://microservices.io/patterns/data/database-per-service.html>

- <span data-ttu-id="dd5a7-159">**Martin Fowler. BoundedContext** \\</span><span class="sxs-lookup"><span data-stu-id="dd5a7-159">**Martin Fowler. BoundedContext** \\</span></span>
  <https://martinfowler.com/bliki/BoundedContext.html>

- <span data-ttu-id="dd5a7-160">**Martin Fowler. PolyglotPersistence** \\</span><span class="sxs-lookup"><span data-stu-id="dd5a7-160">**Martin Fowler. PolyglotPersistence** \\</span></span>
  <https://martinfowler.com/bliki/PolyglotPersistence.html>

- <span data-ttu-id="dd5a7-161">**Alberto Brandolini. Strategiczne projektowania, które za pomocą kontekstu mapowania opartego na domenach** \\</span><span class="sxs-lookup"><span data-stu-id="dd5a7-161">**Alberto Brandolini. Strategic Domain Driven Design with Context Mapping** \\</span></span>
  <https://www.infoq.com/articles/ddd-contextmapping>

>[!div class="step-by-step"]
><span data-ttu-id="dd5a7-162">[Poprzednie](microservices-architecture.md)
>[dalej](logical-versus-physical-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="dd5a7-162">[Previous](microservices-architecture.md)
[Next](logical-versus-physical-architecture.md)</span></span>
