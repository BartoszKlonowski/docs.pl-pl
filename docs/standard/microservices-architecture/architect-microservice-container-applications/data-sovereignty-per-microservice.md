---
title: Suwerenności danych na mikrousługi
description: Architektura Mikrousług .NET dla aplikacji .NET konteneryzowanych | Suwerenności danych na mikrousługi
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.openlocfilehash: d739cc33dec372f6bd9569c05d034dcd25be8395
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
ms.locfileid: "33577296"
---
# <a name="data-sovereignty-per-microservice"></a><span data-ttu-id="e0e8d-103">Suwerenności danych na mikrousługi</span><span class="sxs-lookup"><span data-stu-id="e0e8d-103">Data sovereignty per microservice</span></span>

<span data-ttu-id="e0e8d-104">Ważne reguły dla architektury mikrousług jest, czy każdy mikrousługi musi być właścicielem jego danych domeny i logiki.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-104">An important rule for microservices architecture is that each microservice must own its domain data and logic.</span></span> <span data-ttu-id="e0e8d-105">Tak samo, jak Pełna aplikacji jest właścicielem jego logikę i dane, więc musi każdego mikrousługi właścicielem jego logikę i dane w ramach autonomicznej cykl życia, niezależnie od wdrożenia na mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-105">Just as a full application owns its logic and data, so must each microservice own its logic and data under an autonomous lifecycle, with independent deployment per microservice.</span></span>

<span data-ttu-id="e0e8d-106">Oznacza to, że model koncepcyjny domeny będą się różnić między podsystemami lub mikrousług.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-106">This means that the conceptual model of the domain will differ between subsystems or microservices.</span></span> <span data-ttu-id="e0e8d-107">Należy wziąć pod uwagę aplikacje dla przedsiębiorstw, gdzie relacji Zarządzanie Klientami aplikacji klienta, transakcyjne zakupu podsystemów i podsystemy Obsługa klienta każde wywołanie na atrybuty obiektu unikatowy klienta i dane, a każdy wykorzystuje inny Ograniczone kontekstu (BC).</span><span class="sxs-lookup"><span data-stu-id="e0e8d-107">Consider enterprise applications, where customer relationship management (CRM) applications, transactional purchase subsystems, and customer support subsystems each call on unique customer entity attributes and data, and where each employs a different Bounded Context (BC).</span></span>

<span data-ttu-id="e0e8d-108">Ta zasada jest podobna [projektowanie oparte na domenie (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), gdzie każdego [ograniczone kontekstu](https://martinfowler.com/bliki/BoundedContext.html) lub podsystemu autonomicznego lub usługi musi być właścicielem jego model domeny (danych oraz logiki i zachowanie).</span><span class="sxs-lookup"><span data-stu-id="e0e8d-108">This principle is similar in [Domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), where each [Bounded Context](https://martinfowler.com/bliki/BoundedContext.html) or autonomous subsystem or service must own its domain model (data plus logic and behavior).</span></span> <span data-ttu-id="e0e8d-109">Każdy kontekst ograniczone DDD są powiązane z jedną mikrousługi business (co najmniej jednej usługi).</span><span class="sxs-lookup"><span data-stu-id="e0e8d-109">Each DDD Bounded Context correlates to one business microservice (one or several services).</span></span> <span data-ttu-id="e0e8d-110">(Możemy rozwiń w tym punkcie o wzorcu ograniczone kontekstu w następnej sekcji.)</span><span class="sxs-lookup"><span data-stu-id="e0e8d-110">(We expand on this point about the Bounded Context pattern in the next section.)</span></span>

<span data-ttu-id="e0e8d-111">Z drugiej strony podejście tradycyjnych (dane wbudowanymi) używany w wielu aplikacjach ma kilka baz danych lub jeden scentralizowanej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-111">On the other hand, the traditional (monolithic data) approach used in many applications is to have a single centralized database or just a few databases.</span></span> <span data-ttu-id="e0e8d-112">Często jest znormalizowane bazy danych SQL, używany dla całej aplikacji i wszystkich jego podsystemów wewnętrznych, jak pokazano w rysunek 4-7.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-112">This is often a normalized SQL database that is used for the whole application and all its internal subsystems, as shown in Figure 4-7.</span></span>

![](./media/image7.png)

<span data-ttu-id="e0e8d-113">**Rysunek 4-7**.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-113">**Figure 4-7**.</span></span> <span data-ttu-id="e0e8d-114">Porównanie suwerenności danych: wbudowanymi bazy danych i mikrousług</span><span class="sxs-lookup"><span data-stu-id="e0e8d-114">Data sovereignty comparison: monolithic database versus microservices</span></span>

<span data-ttu-id="e0e8d-115">Podejście scentralizowanej bazie danych początkowo wygląda prostszy i wydaje się, aby umożliwić ponowne użycie jednostek w różne podsystemy do wszystkich spójne.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-115">The centralized database approach initially looks simpler and seems to enable reuse of entities in different subsystems to make everything consistent.</span></span> <span data-ttu-id="e0e8d-116">Ale rzeczywistego jest na końcu dużych tabel, obsługujących wiele różne podsystemy zawierające atrybuty i kolumny, które nie są wymagane w większości przypadków.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-116">But the reality is you end up with huge tables that serve many different subsystems, and that include attributes and columns that are not needed in most cases.</span></span> <span data-ttu-id="e0e8d-117">Przypomina to próby Użyj tej samej fizycznej mapy piesze krótkich ślad, biorąc podróży samochodu long dnia i uczenia geograficznych.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-117">it is like trying to use the same physical map for hiking a short trail, taking a day-long car trip, and learning geography.</span></span>

<span data-ttu-id="e0e8d-118">Wbudowanymi aplikacji zwykle pojedynczego relacyjna baza danych ma dwa istotne zalety: [transakcje ACID](https://en.wikipedia.org/wiki/ACID) i języka SQL, zarówno pracy we wszystkich tabelach i dane związane z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-118">A monolithic application with typically a single relational database has two important benefits: [ACID transactions](https://en.wikipedia.org/wiki/ACID) and the SQL language, both working across all the tables and data related to your application.</span></span> <span data-ttu-id="e0e8d-119">Takie podejście umożliwia łatwe Napisz zapytanie, które łączy dane z wielu tabel.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-119">This approach provides a way to easily write a query that combines data from multiple tables.</span></span>

<span data-ttu-id="e0e8d-120">Jednak dostęp do danych staje się bardziej złożonej, w przypadku przenoszenia do architektury mikrousług.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-120">However, data access becomes much more complex when you move to a microservices architecture.</span></span> <span data-ttu-id="e0e8d-121">Jednak nawet wtedy, gdy transakcje ACID można lub powinny być używane w ramach mikrousługi lub ograniczonych kontekstu, danych należących do każdego mikrousługi jest oznaczony jako prywatny tego mikrousługi i można uzyskać tylko za pośrednictwem jej interfejsu API mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-121">But even when ACID transactions can or should be used within a microservice or Bounded Context, the data owned by each microservice is private to that microservice and can only be accessed via its microservice API.</span></span> <span data-ttu-id="e0e8d-122">Zawieranie danych gwarantuje, że mikrousług są luźno powiązane i mogą rozwijać, niezależnie od siebie.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-122">Encapsulating the data ensures that the microservices are loosely coupled and can evolve independently of one another.</span></span> <span data-ttu-id="e0e8d-123">Jeśli wiele usług zostały dostęp do tych samych danych, aktualizacje schematu wymagają skoordynowanego aktualizacji do wszystkich usług.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-123">If multiple services were accessing the same data, schema updates would require coordinated updates to all the services.</span></span> <span data-ttu-id="e0e8d-124">Spowoduje to przerwanie Autonomia cyklu życia mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-124">This would break the microservice lifecycle autonomy.</span></span> <span data-ttu-id="e0e8d-125">Ale struktur danych rozproszonych oznacza, że nie można wprowadzić pojedynczej transakcji ACID między mikrousług.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-125">But distributed data structures mean that you cannot make a single ACID transaction across microservices.</span></span> <span data-ttu-id="e0e8d-126">Z kolei oznacza to, że należy użyć spójność ostateczna, gdy proces biznesowy obejmuje wiele mikrousług.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-126">This in turn means you must use eventual consistency when a business process spans multiple microservices.</span></span> <span data-ttu-id="e0e8d-127">To jest trudniejsze do zaimplementowania niż proste sprzężenia SQL; Podobnie wielu innych funkcji relacyjnej bazy danych nie są dostępne w wielu mikrousług.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-127">This is much harder to implement than simple SQL joins; similarly, many other relational database features are not available across multiple microservices.</span></span>

<span data-ttu-id="e0e8d-128">Kontynuowanie nawet, różnych mikrousług często używają różnych *rodzajów* baz danych.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-128">Going even further, different microservices often use different *kinds* of databases.</span></span> <span data-ttu-id="e0e8d-129">Nowoczesne aplikacje sklepu i procesu różnych rodzajów danych oraz relacyjnej bazy danych nie zawsze jest najlepszym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-129">Modern applications store and process diverse kinds of data, and a relational database is not always the best choice.</span></span> <span data-ttu-id="e0e8d-130">Dla niektórych zastosowań, bazą danych NoSQL, takie jak usługa Azure DocumentDB lub baza danych MongoDB może mieć wygodniejsze modelu danych i oferuje lepszą wydajność i skalowalność niż baza danych SQL, takich jak SQL Server lub baza danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-130">For some use cases, a NoSQL database such as Azure DocumentDB or MongoDB might have a more convenient data model and offer better performance and scalability than a SQL database like SQL Server or Azure SQL Database.</span></span> <span data-ttu-id="e0e8d-131">W pozostałych przypadkach relacyjnej bazy danych nadal jest najlepszym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-131">In other cases, a relational database is still the best approach.</span></span> <span data-ttu-id="e0e8d-132">W związku z tym aplikacji opartych na mikrousług często używają kombinację bazy danych SQL i NoSQL, który jest czasami nazywany [polyglot trwałości](https://martinfowler.com/bliki/PolyglotPersistence.html) podejście.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-132">Therefore, microservices-based applications often use a mixture of SQL and NoSQL databases, which is sometimes called the [polyglot persistence](https://martinfowler.com/bliki/PolyglotPersistence.html) approach.</span></span>

<span data-ttu-id="e0e8d-133">Podzielone na partycje, trwałe polyglot architektury do przechowywania danych ma wiele korzyści.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-133">A partitioned, polyglot-persistent architecture for data storage has many benefits.</span></span> <span data-ttu-id="e0e8d-134">Obejmują one luźno powiązanych usług i lepszą wydajność, skalowalność, kosztów i możliwości zarządzania.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-134">These include loosely coupled services and better performance, scalability, costs, and manageability.</span></span> <span data-ttu-id="e0e8d-135">Jednak go mogą stać się pewne wyzwania zarządzania danych rozproszonych, ponieważ Wyjaśnijmy w "[identyfikujące model domeny granice](#identifying-domain-model-boundaries-for-each-microservice)" dalej w tym rozdziale.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-135">However, it can introduce some distributed data management challenges, as we will explain in “[Identifying domain-model boundaries](#identifying-domain-model-boundaries-for-each-microservice)” later in this chapter.</span></span>

## <a name="the-relationship-between-microservices-and-the-bounded-context-pattern"></a><span data-ttu-id="e0e8d-136">Relacja między mikrousług i wzorzec ograniczone kontekstu</span><span class="sxs-lookup"><span data-stu-id="e0e8d-136">The relationship between microservices and the Bounded Context pattern</span></span>

<span data-ttu-id="e0e8d-137">Pojęcie mikrousługi pochodną [wzorzec kontekstu ograniczone (BC)](https://martinfowler.com/bliki/BoundedContext.html) w [projektowanie oparte na domenie (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span><span class="sxs-lookup"><span data-stu-id="e0e8d-137">The concept of microservice derives from the [Bounded Context (BC) pattern](https://martinfowler.com/bliki/BoundedContext.html) in [domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span></span> <span data-ttu-id="e0e8d-138">DDD dotyczy dużych modeli przez podzielenie ich na wielu usług łączności biznesowej, a w rezultacie jawne o ich granic.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-138">DDD deals with large models by dividing them into multiple BCs and being explicit about their boundaries.</span></span> <span data-ttu-id="e0e8d-139">Każdy BC musi mieć własne modelu i bazy danych. Podobnie każda mikrousługi właścicielem jego danych powiązanych.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-139">Each BC must have its own model and database; likewise, each microservice owns its related data.</span></span> <span data-ttu-id="e0e8d-140">Ponadto każdy BC zwykle ma własną [powszechny języka](https://martinfowler.com/bliki/UbiquitousLanguage.html) ułatwiające komunikację między programistami i ekspertów domeny.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-140">In addition, each BC usually has its own [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) to help communication between software developers and domain experts.</span></span>

<span data-ttu-id="e0e8d-141">Te warunki (głównie domeny jednostek) w języku uniwersalnych może mieć różne nazwy elementu w różnych kontekstach ograniczone, nawet wtedy, gdy różne domeny jednostek udział tej samej tożsamości (to znaczy Unikatowy identyfikator, który jest używany do odczytu jednostki z magazynu).</span><span class="sxs-lookup"><span data-stu-id="e0e8d-141">Those terms (mainly domain entities) in the ubiquitous language can have different names in different Bounded Contexts, even when different domain entities share the same identity (that is, the unique ID that is used to read the entity from storage).</span></span> <span data-ttu-id="e0e8d-142">Na przykład w kontekście ograniczony profil użytkownika, jednostką domeny użytkownika może udostępniać tożsamości jednostką domeny nabywców w kontekście porządkowania ograniczone.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-142">For instance, in a user-profile Bounded Context, the User domain entity might share identity with the Buyer domain entity in the ordering Bounded Context.</span></span>

<span data-ttu-id="e0e8d-143">Mikrousługi w związku z tym przypomina kontekst ograniczone, ale również określa, że jest rozproszonego usługi.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-143">A microservice is therefore like a Bounded Context, but it also specifies that it is a distributed service.</span></span> <span data-ttu-id="e0e8d-144">Jest ona wbudowana procesów odrębnych dla każdego z ograniczonym kontekstu i protokoły rozproszonego wspomniano wcześniej, takich jak HTTP/HTTPS, Websocket, należy użyć lub [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span><span class="sxs-lookup"><span data-stu-id="e0e8d-144">It is built as a separate process for each Bounded Context, and it must use the distributed protocols noted earlier, like HTTP/HTTPS, WebSockets, or [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span></span> <span data-ttu-id="e0e8d-145">Wzorzec ograniczone kontekstu, jednak nie określa czy kontekst ograniczone są usługami rozproszonymi, lub jeśli jest to po prostu granicę logiczne (na przykład ogólny podsystemu) aplikacji wbudowanymi wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-145">The Bounded Context pattern, however, does not specify whether the Bounded Context is a distributed service or if it is simply a logical boundary (such as a generic subsystem) within a monolithic-deployment application.</span></span>

<span data-ttu-id="e0e8d-146">Jest ważne wyróżnić, że definiowanie usługi dla każdego z ograniczonym kontekstu jest dobrym miejscem do rozpoczęcia.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-146">It is important to highlight that defining a service for each Bounded Context is a good place to start.</span></span> <span data-ttu-id="e0e8d-147">Ale nie trzeba ograniczyć projektu do niego.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-147">But you do not have to constrain your design to it.</span></span> <span data-ttu-id="e0e8d-148">Czasami należy projektować kontekst ograniczone lub business mikrousługi składa się z kilku usług fizycznych.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-148">Sometimes you must design a Bounded Context or business microservice composed of several physical services.</span></span> <span data-ttu-id="e0e8d-149">Ale ostatecznie oba wzorce — ograniczone kontekstu i mikrousługi — są ściśle powiązane.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-149">But ultimately, both patterns—Bounded Context and microservice—are closely related.</span></span>

<span data-ttu-id="e0e8d-150">DDD korzyści z mikrousług pobierając rzeczywistych granic w formie mikrousług rozproszonych.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-150">DDD benefits from microservices by getting real boundaries in the form of distributed microservices.</span></span> <span data-ttu-id="e0e8d-151">Ale pomysły, takie jak udostępnianie nie modelu między mikrousług co również ma w kontekście ograniczone.</span><span class="sxs-lookup"><span data-stu-id="e0e8d-151">But ideas like not sharing the model between microservices are what you also want in a Bounded Context.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="e0e8d-152">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="e0e8d-152">Additional resources</span></span>

-   <span data-ttu-id="e0e8d-153">**Krzysztof Richardson. Wzorzec: Bazy danych usługi**
    [*https://microservices.io/patterns/data/database-per-service.html*](https://microservices.io/patterns/data/database-per-service.html)</span><span class="sxs-lookup"><span data-stu-id="e0e8d-153">**Chris Richardson. Pattern: Database per service**
[*https://microservices.io/patterns/data/database-per-service.html*](https://microservices.io/patterns/data/database-per-service.html)</span></span>

-   <span data-ttu-id="e0e8d-154">**Pole Fowler. BoundedContext**
    [*https://martinfowler.com/bliki/BoundedContext.html*](https://martinfowler.com/bliki/BoundedContext.html)</span><span class="sxs-lookup"><span data-stu-id="e0e8d-154">**Martin Fowler. BoundedContext**
[*https://martinfowler.com/bliki/BoundedContext.html*](https://martinfowler.com/bliki/BoundedContext.html)</span></span>

-   <span data-ttu-id="e0e8d-155">**Pole Fowler. PolyglotPersistence**
    [*https://martinfowler.com/bliki/PolyglotPersistence.html*](https://martinfowler.com/bliki/PolyglotPersistence.html)</span><span class="sxs-lookup"><span data-stu-id="e0e8d-155">**Martin Fowler. PolyglotPersistence**
[*https://martinfowler.com/bliki/PolyglotPersistence.html*](https://martinfowler.com/bliki/PolyglotPersistence.html)</span></span>

-   <span data-ttu-id="e0e8d-156">**Alberto Brandolini. Strategiczne domeny na projekt z mapowaniem kontekstu**
    [*https://www.infoq.com/articles/ddd-contextmapping*](https://www.infoq.com/articles/ddd-contextmapping)</span><span class="sxs-lookup"><span data-stu-id="e0e8d-156">**Alberto Brandolini. Strategic Domain Driven Design with Context Mapping**
[*https://www.infoq.com/articles/ddd-contextmapping*](https://www.infoq.com/articles/ddd-contextmapping)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="e0e8d-157">[Poprzednie] (mikrousług architecture.md) [dalej] (logiczne i fizycznych architecture.md)</span><span class="sxs-lookup"><span data-stu-id="e0e8d-157">[Previous] (microservices-architecture.md) [Next] (logical-versus-physical-architecture.md)</span></span>
