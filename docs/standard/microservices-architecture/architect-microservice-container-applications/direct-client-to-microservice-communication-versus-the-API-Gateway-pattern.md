---
title: Wzorzec bramy interfejsu API i bezpośrednia komunikacja klient mikrousługi
description: Architektura Mikrousług .NET dla aplikacji .NET konteneryzowanych | Wzorzec bramy interfejsu API i bezpośrednia komunikacja klient mikrousługi
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 06/07/2018
ms.openlocfilehash: 75a7c0557319ca948d2112ba0a58f1761368e6f3
ms.sourcegitcommit: 2ad7d06f4f469b5d8a5280ac0e0289a81867fc8e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/08/2018
ms.locfileid: "35231554"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="7ce8b-103">Wzorzec bramy interfejsu API i bezpośrednia komunikacja klient mikrousługi</span><span class="sxs-lookup"><span data-stu-id="7ce8b-103">The API Gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="7ce8b-104">W architekturze mikrousług każdego mikrousługi udostępnia zestaw (zwykle) fine‑grained punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-104">In a microservices architecture, each microservice exposes a set of (typically) fine‑grained endpoints.</span></span> <span data-ttu-id="7ce8b-105">Ten fakt może wpływać na komunikacji client‑to‑microservice, zgodnie z objaśnieniem w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-105">This fact can impact the client‑to‑microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="7ce8b-106">Bezpośrednia komunikacja klient mikrousługi</span><span class="sxs-lookup"><span data-stu-id="7ce8b-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="7ce8b-107">Jest możliwe podejście do użycia z architektury bezpośrednia komunikacja klient mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="7ce8b-108">W tym podejście aplikacji klienckiej mogą wysyłać żądania bezpośrednio do niektórych mikrousług, jak pokazano na rysunku 4-12.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagram przedstawiający bezpośrednia komunikacja klient mikrousługi architektury](./media/image12.png)

<span data-ttu-id="7ce8b-110">**Rysunek 4-12**.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-110">**Figure 4-12**.</span></span> <span data-ttu-id="7ce8b-111">Przy użyciu architektury bezpośrednia komunikacja klient mikrousługi</span><span class="sxs-lookup"><span data-stu-id="7ce8b-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="7ce8b-112">W tej metody.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-112">In this approach.</span></span> <span data-ttu-id="7ce8b-113">Każdy mikrousługi ma publiczny punkt końcowy, niekiedy z różnych portów TCP dla każdego mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-113">each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="7ce8b-114">Przykładowy adres URL dla określonej usługi może być następujący adres URL na platformie Azure:</span><span class="sxs-lookup"><span data-stu-id="7ce8b-114">An example of a URL for a particular service could be the following URL in Azure:</span></span>

<http://eshoponcontainers.westus.cloudapp.azure.com:88/>

<span data-ttu-id="7ce8b-115">W środowisku produkcyjnym, oparty na klastrze, mapującej adres URL do modułu równoważenia obciążenia używanych w klastrze, który z kolei rozdzielaj żądania między mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-115">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="7ce8b-116">W środowiskach produkcyjnych, może mieć aplikacji dostarczania kontrolera (ADC) jak [brama aplikacji w usłudze Azure](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) Twojego mikrousług od Internetu.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-116">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="7ce8b-117">To dodatkowe przezroczyste warstwy, która nie przeprowadza równoważenia obciążenia tylko zabezpiecza oferując kończenia żądań SSL z usługami.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-117">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="7ce8b-118">Zwiększa to obciążenia hosty dzięki przeniesieniu kończenia żądań SSL użycie Procesora CPU i inne routingu obowiązków na bramie aplikacji Azure.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-118">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="7ce8b-119">W każdym przypadku modułu równoważenia obciążenia i ADC są niewidoczne z aplikacji logicznych architektura punktu widzenia.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-119">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="7ce8b-120">Architektura bezpośrednia komunikacja klient mikrousługi może to być dobry małych aplikacji opartej na mikrousługi, szczególnie w przypadku aplikacji klienckiej aplikacji sieci web po stronie serwera, takie jak aplikacja ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-120">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="7ce8b-121">Jednak podczas kompilowania dużych i złożonych aplikacji opartych na mikrousługi (na przykład podczas obsługi wielu rodzajów mikrousługi), a szczególnie w przypadku aplikacji klienta zdalnego aplikacji mobilnych lub aplikacji sieci web SPA tego podejścia skierowany kilka problemów.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-121">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="7ce8b-122">Podczas tworzenia dużej aplikacji oparte na mikrousług, należy wziąć pod uwagę następujące kwestie:</span><span class="sxs-lookup"><span data-stu-id="7ce8b-122">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="7ce8b-123">*Jak aplikacje klienckie zminimalizować liczbę żądań do wewnętrznej bazy danych i zmniejszyć chatty komunikacji wielu mikrousług?*</span><span class="sxs-lookup"><span data-stu-id="7ce8b-123">*How can client apps minimize the number of requests to the backend and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="7ce8b-124">Interakcji z wieloma mikrousług do tworzenia jednym ekranie interfejsu użytkownika powoduje zwiększenie liczby rund w Internecie.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-124">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="7ce8b-125">Zwiększa to opóźnienie i złożoność po stronie interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-125">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="7ce8b-126">W idealnym przypadku odpowiedzi wydajnie agregowania po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-126">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="7ce8b-127">Zmniejsza to opóźnienia, ponieważ wiele rodzajów danych wróć równolegle i niektóre interfejsu użytkownika można wyświetlić danych, jak jest gotowy.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-127">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it is ready.</span></span>

- <span data-ttu-id="7ce8b-128">*Jak można obsługiwać kompleksowymi problemów, takich jak autoryzacja, przekształcenia danych i wysyła żądanie dynamiczne?*</span><span class="sxs-lookup"><span data-stu-id="7ce8b-128">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="7ce8b-129">Implementacja zabezpieczeń oraz kompleksowymi problemy, np. zabezpieczeń i uwierzytelniania w każdym mikrousługi może wymagać znaczących nakład pracy.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-129">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="7ce8b-130">Możliwe podejście jest tych usług w ramach Docker host lub klaster wewnętrzny ograniczyć bezpośredni dostęp do nich z zewnątrz i wdrożenie tych problemów kompleksowymi w centralnym miejscu, podobnie jak bramy usługi interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-130">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="7ce8b-131">*Jak aplikacje klienckie mogą komunikować się z usług, które używają protokołów innych niż przyjazne Internet?*</span><span class="sxs-lookup"><span data-stu-id="7ce8b-131">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="7ce8b-132">Protokoły używane po stronie serwera (na przykład protokołu AMQP lub protokołów binarnych) zwykle nie są obsługiwane w aplikacjach klienckich.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-132">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="7ce8b-133">W związku z tym żądania musi być wykonywane za pośrednictwem protokołów, takich jak HTTP/HTTPS i później translacji na innych protokołów.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-133">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="7ce8b-134">A *man-in--middle* może pomóc w takiej sytuacji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-134">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="7ce8b-135">*Jak można kształtu fasad, szczególnie wprowadzone dla aplikacji mobilnych*</span><span class="sxs-lookup"><span data-stu-id="7ce8b-135">*How can you shape a façade especially made for mobile apps?*</span></span>

<span data-ttu-id="7ce8b-136">Interfejs API z wielu mikrousług może nie dobrze zaprojektowanej na potrzeby aplikacji innego klienta.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-136">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="7ce8b-137">Na przykład na potrzeby aplikacji mobilnej może różnić się od potrzeb aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-137">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="7ce8b-138">Dla aplikacji mobilnych konieczne może być jeszcze bardziej zoptymalizować tak, aby dane odpowiedzi może być skuteczniejsza.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-138">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="7ce8b-139">Może to zrobić przez agregowanie danych z wielu mikrousług i zwracanie jednego zestawu danych, a czasami wyeliminowanie żadnych danych w odpowiedzi, które nie są wymagane przez aplikację mobilną.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-139">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that is not needed by the mobile app.</span></span> <span data-ttu-id="7ce8b-140">I oczywiście można kompresować dane.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-140">And, of course, you might compress that data.</span></span> <span data-ttu-id="7ce8b-141">Ponownie fasad lub interfejsu API Between aplikacji mobilnej i mikrousług mogą być użyteczne dla tego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-141">Again, a façade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="7ce8b-142">Dlaczego należy wziąć pod uwagę bram interfejsu API zamiast bezpośredniej komunikacji klient mikrousługi</span><span class="sxs-lookup"><span data-stu-id="7ce8b-142">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="7ce8b-143">W architekturze mikrousług aplikacje klienckie zwykle muszą korzystać z funkcji z więcej niż jeden mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-143">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="7ce8b-144">Jeśli użycie tego jest wykonywana bezpośrednio, klient musi obsługiwać wielu wywołań do punktów końcowych mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-144">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="7ce8b-145">Co się dzieje podczas rozwoju aplikacji i wprowadzane są nowe mikrousług lub aktualizacji istniejącego mikrousług?</span><span class="sxs-lookup"><span data-stu-id="7ce8b-145">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="7ce8b-146">Jeśli aplikacja ma wiele mikrousług, obsługi tak wielu punktów końcowych z aplikacji klienta może być nightmare.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-146">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="7ce8b-147">Ponieważ aplikacja kliencka może zostać dołączone do tych wewnętrznych punktów końcowych, rozwijającymi mikrousług w przyszłości może spowodować duże znaczenie dla aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-147">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="7ce8b-148">W związku z tym poziomie pośrednim lub warstwy pośredni (bramy) może być bardzo wygodny dla aplikacji opartych na mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-148">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="7ce8b-149">Jeśli nie masz bram interfejsu API aplikacji klienta musi wysyłać żądania bezpośrednio do mikrousług i który stwarza problemy, takie jak następujące problemy:</span><span class="sxs-lookup"><span data-stu-id="7ce8b-149">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="7ce8b-150">**Sprzężenia**: bez wzorca bramy interfejsu API aplikacji klienta są powiązane do wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-150">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="7ce8b-151">Aplikacje klient musi wiedzieć, jak wiele obszarów aplikacji są rozłożone w mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-151">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="7ce8b-152">Gdy zmieniające się i refaktoryzacji mikrousług wewnętrznego, wpływ tych czynności konserwacji pretty nieprawidłowo ponieważ spowodują one najważniejszych zmian w aplikacjach klienta z powodu bezpośrednie odwołanie do wewnętrznego mikrousług z klienta aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-152">When evolving and refactoring the internal microservices, those actions impact maintenance pretty badly because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="7ce8b-153">Aplikacje klienta muszą zostać zaktualizowane często, co przeszkodę podlegać ewolucji rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-153">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="7ce8b-154">**Zbyt wiele rund**: jednej strony/ekranu w aplikacji klienta może wymagać wielu wywołań wielu usług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-154">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="7ce8b-155">Czy można doprowadzi do wielu sieci przekazywanych między klientem i serwerem, dodawanie znaczne opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-155">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="7ce8b-156">Obsługiwane w poziomie pośrednim agregacji może poprawić wydajność i środowisko użytkownika dla aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-156">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="7ce8b-157">**Problemy z zabezpieczeniami**: bez bramy, muszą być widoczne wszystkie mikrousług "zewnętrzne World", co obszar narażony na ataki większych niż ukryć wewnętrzny mikrousług bezpośrednio używane przez aplikacje klienckie.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-157">**Security issues**: Without a gateway, all the microservices must be exposed to the “external world”, making the attack surface larger than if you hide internal microservices not directly used by the client apps.</span></span> <span data-ttu-id="7ce8b-158">Jest mniejszy obszar narażony na ataki, bezpieczniejsze może być aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-158">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="7ce8b-159">**Dotyczy kompleksowymi**: każdego publicznie opublikowanych mikrousługi musi obsługiwać dotyczy takich jak autoryzacja, SSL, itp. W wielu sytuacjach te problemy można obsługiwane w pojedynczej warstwie, więc wewnętrzny mikrousług są uproszczone.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-159">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization, SSL, etc. In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="7ce8b-160">Co to jest wzorzec bramy interfejsu API?</span><span class="sxs-lookup"><span data-stu-id="7ce8b-160">What is the API Gateway pattern?</span></span>

<span data-ttu-id="7ce8b-161">Podczas projektowania i tworzenie dużych lub złożonych mikrousługi aplikacji z wielu klientów aplikacji może być dobrym sposobem należy wziąć pod uwagę [bramy interfejsu API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="7ce8b-161">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="7ce8b-162">Jest to usługa, która zapewnia jeden punkt wejścia dla niektórych grup mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-162">This is a service that provides a single entry point for certain groups of microservices.</span></span> <span data-ttu-id="7ce8b-163">Jest on podobny do [wzorzec fasady](https://en.wikipedia.org/wiki/Facade_pattern) od object‑oriented projektu, ale w takim przypadku tego część rozproszonego systemu.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-163">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object‑oriented design, but in this case, it's part of a distributed system.</span></span>
<span data-ttu-id="7ce8b-164">Wzorzec bramy interfejsu API jest również nazywany "wewnętrzna frontonu" [(BFF)](https://samnewman.io/patterns/architectural/bff/) ponieważ skompiluj go podczas planowania na potrzeby aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-164">The API Gateway pattern is also sometimes known as the “backend for frontend” [(BFF)](https://samnewman.io/patterns/architectural/bff/) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="7ce8b-165">W związku z tym API bramy znajduje się między aplikacjami klienta i mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-165">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="7ce8b-166">Działa ona jako zwrotny serwer proxy, routingu żądań od klientów do usług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-166">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="7ce8b-167">Można też podać dodatkowe funkcje kompleksowymi, takich jak uwierzytelnianie, kończenia żądań SSL i pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-167">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="7ce8b-168">Rysunek 4-13 przedstawiono, jak brama niestandardowego interfejsu API można umieścić w uproszczenia architektury mikrousługi na podstawie z kilku mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-168">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagram pokazujący, że bramy usługi interfejsu API zaimplementowano ją jako niestandardowe usługi](./media/image13.png)

<span data-ttu-id="7ce8b-170">**Rysunek 4-13**.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-170">**Figure 4-13**.</span></span> <span data-ttu-id="7ce8b-171">Przy użyciu bramy interfejsu API zaimplementowano ją jako niestandardowe usługi</span><span class="sxs-lookup"><span data-stu-id="7ce8b-171">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="7ce8b-172">W tym przykładzie brama interfejsu API będzie można zaimplementować jako niestandardowe usługi hosta sieci Web platformy ASP.NET Core uruchomionej jako kontener.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-172">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="7ce8b-173">Ważne jest, aby wyróżnić który na tym diagramie, jak można przy użyciu jednej usługi interfejsu API bramy niestandardowych skierowane w wielu i aplikacjach innego klienta.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-173">It is important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="7ce8b-174">Fakt można poważne zagrożenie, ponieważ usługi bramy interfejsu API zostanie powiększania i zmieniających się na podstawie wielu różne wymagania z aplikacji klienta.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-174">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="7ce8b-175">Po pewnym czasie będzie przeglądarek z powodu tych różnych potrzeb i efektywnie może być bardzo podobna do wbudowanymi aplikacji lub usługi wbudowanymi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-175">Eventually, it will be bloated because of those different needs and effectively it could be pretty similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="7ce8b-176">To jest znacznie zalecane jest podzielenie bramy interfejsu API w wielu usługach lub wielu mniejszych interfejsu API bram, po jednym dla każdego typu obudowie aplikacji klienta, na przykład.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-176">That is why it is very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="7ce8b-177">Należy zachować ostrożność podczas implementowania wzorzec bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-177">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="7ce8b-178">Zwykle nie jest dobrym pomysłem jest mieć pojedynczy bramy interfejsu API agregowanie wszystkich mikrousług wewnętrznych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-178">Usually it isn’t a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="7ce8b-179">Jeśli tak, działa jako wbudowanymi agregator lub orchestrator i narusza Autonomia mikrousługi przez wszystkie mikrousług sprzężenia.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-179">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="7ce8b-180">W związku z tym bram interfejsu API powinno rozdzielony na podstawie granice firm i aplikacji klienckich i nie act jako pojedynczy agregatora dla wszystkich wewnętrzny mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-180">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="7ce8b-181">W przypadku dzielenia warstwy interfejsu API bramy do wielu bram interfejsu API, jeśli aplikacja ma wiele aplikacji klienta, które mogą być podstawowy pivot podczas identyfikowania wiele typów bram interfejsu API, dzięki czemu mają różne fasad na potrzeby każdej aplikacji klienta.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-181">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different façade for the needs of each client app.</span></span> <span data-ttu-id="7ce8b-182">Ten przypadek to wzorzec o nazwie "Wewnętrznej bazy danych dla serwera sieci Web" ([BFF](http://samnewman.io/patterns/architectural/bff/)) w przypadku, gdy każdej bramy interfejsu API zapewniają interfejs API różnych dostosowane do każdego typu aplikacji klienta, prawdopodobnie nawet na podstawie współczynnika formularza klienta zaimplementowanie określonej karty kod który na dole wywołuje wielu mikrousług wewnętrznych, jak pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="7ce8b-182">This case is a pattern named “Backend for Frontend” ([BFF](http://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagram przedstawiający wielu bram niestandardowego interfejsu API](./media/image13.1.png)

<span data-ttu-id="7ce8b-184">**Rysunek 4-13.1**.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-184">**Figure 4-13.1**.</span></span> <span data-ttu-id="7ce8b-185">Korzystanie z wielu bram niestandardowego interfejsu API</span><span class="sxs-lookup"><span data-stu-id="7ce8b-185">Using multiple custom API Gateways</span></span>

<span data-ttu-id="7ce8b-186">Na poprzedniej ilustracji przedstawiono uproszczenia architektury z wielu bram szczegółowych interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-186">The previous image shows a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="7ce8b-187">W takim przypadku granice dla każdej bramy interfejsu API są oparte wyłącznie na "wewnętrznej bazy danych dla serwera sieci Web" ([BFF](http://samnewman.io/patterns/architectural/bff/)) wzorzec, dlatego oparte tylko na potrzeby każdej aplikacji klienta interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-187">In this case, the boundaries identified for each API Gateway are based purely on the “Backend for Frontend” ([BFF](http://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="7ce8b-188">Jednak w dużych aplikacji należy również Przejdź dalej i utworzyć dodatkowe bram interfejsu API w oparciu firm granice jako drugi pivot projektu.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-188">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="7ce8b-189">Główne funkcje we wzorcu interfejsu API bramy</span><span class="sxs-lookup"><span data-stu-id="7ce8b-189">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="7ce8b-190">Brama usługi interfejsu API można oferują wiele funkcji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-190">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="7ce8b-191">W zależności od produktu może oferować bardziej zaawansowane funkcje lub prostsze funkcje jednak najważniejsze i podstawowych funkcji wszystkie bramy interfejsu API są następujące wzorce projektowe:</span><span class="sxs-lookup"><span data-stu-id="7ce8b-191">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="7ce8b-192">**Wycofaj serwera proxy lub bramy routingu**.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-192">**Reverse proxy or gateway routing**.</span></span> <span data-ttu-id="7ce8b-193">Brama interfejsu API oferuje zwrotny serwer proxy do przekierowywania lub kierować żądania (warstwy 7 routingu, zazwyczaj w żądaniach Http) do punktów końcowych mikrousług wewnętrzny.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-193">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually Http requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="7ce8b-194">Brama zapewnia jeden punkt końcowy lub adres URL dla klienta aplikacji, a następnie wewnętrznie mapuje żądania do grupy mikrousług wewnętrznego.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-194">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="7ce8b-195">Rozdzielenie aplikacji klienta z mikrousług pomaga routingu, ale jest również bardzo wygodny podczas modernizacji wbudowanymi interfejsu API przez działo bramy interfejsu API Between wbudowanymi interfejsu API i aplikacje klienckie, a następnie można dodać nowych interfejsów API jako mikrousług nowy Podczas nadal przy użyciu starszej wersji interfejsu API z wbudowanymi do momentu jej jest podzielony na wiele mikrousług w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-195">This routing feature helps to decouple the client apps from the microservices but it is also pretty convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it is split into many microservices in the future.</span></span> <span data-ttu-id="7ce8b-196">Ze względu na bramie interfejsu API aplikacji klienta nie będzie Zwróć uwagę, jeśli interfejsy API używane są zaimplementowane jako mikrousług wewnętrzny lub wbudowanymi interfejsu API i co ważniejsze, gdy zmieniające się i refaktoryzacji wbudowanymi interfejsu API w mikrousług, Dziękujemy bramy Interfejs API routingu , nie będzie mieć wpływ na aplikacje klienckie przy każdej zmianie identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-196">Because of the API Gateway, the client apps won’t notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won’t be impacted with any URI change.</span></span>

<span data-ttu-id="7ce8b-197">Aby uzyskać więcej informacji, zobacz [wzorzec routingu bramy](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="7ce8b-197">For more information, see [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="7ce8b-198">**Żąda agregacji**.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-198">**Requests aggregation**.</span></span> <span data-ttu-id="7ce8b-199">W ramach wzorzec bramy może agregować wiele żądań klientów (zazwyczaj żądań Http) przeznaczonych dla wielu mikrousług wewnętrznego na pojedyncze żądanie klienta.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-199">As part of the gateway pattern you can aggregate multiple client requests (usually Http requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="7ce8b-200">Ten wzorzec jest zwłaszcza wtedy, gdy ekran/strony klienta wymaga informacji z kilku mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-200">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="7ce8b-201">Z tej metody aplikacja kliencka wysyła pojedyncze żądanie do bramy interfejsu API, która wywołuje kilka żądań do wewnętrznego mikrousług, a następnie agreguje wyniki i wysyła wszystkie elementy z powrotem do aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-201">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="7ce8b-202">Celem tego wzorca projektowego i główne korzyści jest zmniejszenie chattiness między aplikacjami klienta i zaplecza interfejsu API, który jest szczególnie ważne dla aplikacji zdalnych poza centrum danych, gdzie mikrousług na żywo, takich jak aplikacje mobilne lub żądania pochodzące z aplikacji JEDNOSTRONICOWEJ który pochodzą z języka Javascript w przeglądarkach zdalnego klienta.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-202">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from Javascript in client remote browsers.</span></span> <span data-ttu-id="7ce8b-203">Dla aplikacji web regularne wykonywanie żądania w środowisku serwera (np. aplikacji sieci web platformy ASP.NET Core MVC) ten wzorzec nie jest tak ważne, jak opóźnienie jest znacznie mniejszy niż w przypadku aplikacji klienta zdalnego.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-203">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="7ce8b-204">W zależności od używanego produktu do bramy interfejsu API może być możliwe do wykonania tej agregacji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-204">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="7ce8b-205">Jednak w wielu przypadkach jest bardziej elastyczne, aby utworzyć mikrousług agregacji w zakresie bramy interfejsu API, zdefiniuj agregacji w kodzie (to znaczy kodu C#).</span><span class="sxs-lookup"><span data-stu-id="7ce8b-205">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code).</span></span>

<span data-ttu-id="7ce8b-206">Aby uzyskać więcej informacji, zobacz [wzorzec agregacji bramy](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="7ce8b-206">For more information, see [Gateway aggregation pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="7ce8b-207">**Problemy kompleksowymi lub Odciążanie bramy**.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-207">**Cross-cutting concerns or gateway offloading**.</span></span> <span data-ttu-id="7ce8b-208">W zależności od funkcji oferowanych przez każdy z produktów bramy interfejsu API można odciążenia funkcjonalności z poszczególnych mikrousług do bramy, która ułatwia implementację każdego mikrousługi dzięki konsolidacji kompleksowymi problemy w jedną warstwę.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-208">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="7ce8b-209">Jest to szczególnie wygodne specjalne funkcje, które mogą być skomplikowane, aby prawidłowo zaimplementować w każdym mikrousługi wewnętrzne, takie jak następujące funkcje:</span><span class="sxs-lookup"><span data-stu-id="7ce8b-209">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="7ce8b-210">Uwierzytelnianie i autoryzacja</span><span class="sxs-lookup"><span data-stu-id="7ce8b-210">Authentication and authorization</span></span>
- <span data-ttu-id="7ce8b-211">Usługi integracji odnajdywania</span><span class="sxs-lookup"><span data-stu-id="7ce8b-211">Service discovery integration</span></span>
- <span data-ttu-id="7ce8b-212">Buforowanie odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="7ce8b-212">Response caching</span></span>
- <span data-ttu-id="7ce8b-213">Ponów próbę wykonania zasady, wyłącznika i QoS</span><span class="sxs-lookup"><span data-stu-id="7ce8b-213">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="7ce8b-214">Limitów szybkości i ograniczania przepustowości</span><span class="sxs-lookup"><span data-stu-id="7ce8b-214">Rate limiting and throttling</span></span>
- <span data-ttu-id="7ce8b-215">Równoważenie obciążenia</span><span class="sxs-lookup"><span data-stu-id="7ce8b-215">Load balancing</span></span>
- <span data-ttu-id="7ce8b-216">Rejestrowanie śledzenia korelacji</span><span class="sxs-lookup"><span data-stu-id="7ce8b-216">Logging, tracing, correlation</span></span>
- <span data-ttu-id="7ce8b-217">Nagłówki, ciągów zapytania i przekształcania oświadczeń</span><span class="sxs-lookup"><span data-stu-id="7ce8b-217">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="7ce8b-218">Listę dozwolonych podobnej IP</span><span class="sxs-lookup"><span data-stu-id="7ce8b-218">IP whitelisting</span></span>

<span data-ttu-id="7ce8b-219">Aby uzyskać więcej informacji, zobacz [bramy Odciążanie wzorzec](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="7ce8b-219">For more information, see [Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="7ce8b-220">Funkcje interfejsu API bramy przy użyciu produktów</span><span class="sxs-lookup"><span data-stu-id="7ce8b-220">Using products with API Gateway features</span></span>

<span data-ttu-id="7ce8b-221">Może istnieć wiele więcej dotyczy kompleksowymi oferowane przez produkty bram interfejsu API w zależności od każdego wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-221">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="7ce8b-222">Na przykład [Azure API Management](https://azure.microsoft.com/services/api-management/) (jak pokazano w rysunek 4-14) nie tylko rozwiązuje potrzeb bramy interfejsu API, ale zawiera funkcje, takie jak zbieranie szczegółowych informacji z swoje interfejsy API.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-222">For instance, [Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="7ce8b-223">Jeśli korzystasz z interfejsu API rozwiązania do zarządzania, bramę interfejsu API jest tylko składnik w tym pełnego rozwiązania do zarządzania interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-223">If you are using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Diagram przedstawiający bramy interfejsu API z interfejsu API Azure Architektura zarządzania](./media/image14.png)

<span data-ttu-id="7ce8b-225">**Rysunek 4-14**.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-225">**Figure 4-14**.</span></span> <span data-ttu-id="7ce8b-226">Za pomocą usługi Azure API Management bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="7ce8b-226">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="7ce8b-227">W takim przypadku przy użyciu produktu, takich jak Azure API Management, fakt, że może być pojedyncza brama interfejsu API nie jest więc ryzykowne ponieważ tego rodzaju bram interfejsu API są "grubsza", co oznacza, że nie implementują niestandardowego kodu C#, który można przekształcenia wbudowanymi składnik.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-227">In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span>

<span data-ttu-id="7ce8b-228">Produkty bramy interfejsu API zwykle działać tak jak zwrotny serwer proxy dla komunikacji wejściowych, można gdzie także filtrować interfejsy API z wewnętrznego mikrousług oraz dotyczą autoryzacji opublikowanych interfejsów API w tej warstwie pojedynczego.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-228">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="7ce8b-229">Dostępne z pomocy systemu zarządzanie interfejsami API szczegółowych danych zawierają opis sposobu używania swoje interfejsy API i jak są wykonywane.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-229">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="7ce8b-230">Robią to, co pozwala wyświetlać niemal analiz w czasie rzeczywistym raporty oraz identyfikowanie trendów, które mogą mieć wpływ na firmy.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-230">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="7ce8b-231">Ponadto można mieć dzienniki o działaniu żądania i odpowiedzi w celu dalszej analizy online i offline.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-231">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="7ce8b-232">Z usługą Azure API Management można zabezpieczyć swoje interfejsy API przy użyciu klucza, token i filtrowanie IP.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-232">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="7ce8b-233">Te funkcje umożliwiają wymuszanie przydziały elastyczne i szczegółowych i limity szybkości, zmodyfikować kształt i zachowanie swoje interfejsy API przy użyciu zasad i poprawić wydajność z buforowania odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-233">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="7ce8b-234">W tym przewodniku i odwołanie przykładowej aplikacji (eShopOnContainers) architektura jest ograniczona do prostszy i utworzone przez użytkownika architektura konteneryzowanych aby skupić się na zwykły kontenery bez użycia PaaS produktów, takich jak zarządzanie interfejsami API Azure.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-234">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="7ce8b-235">Jednak duża mikrousługi aplikacji wdrażanych w Microsoft Azure, firma Microsoft zachęca do oceny usługi Azure API Management jako podstawa dla bram sieci interfejsu API w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-235">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

<span data-ttu-id="7ce8b-236">**Ocelot.**</span><span class="sxs-lookup"><span data-stu-id="7ce8b-236">**Ocelot.**</span></span> <span data-ttu-id="7ce8b-237">Dla metod prostszy lekkie bramy interfejsu API, takich jak Ocelot jest zalecane.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-237">For simpler approaches, a lightweight API Gateway like Ocelot is recommended.</span></span> <span data-ttu-id="7ce8b-238">[Ocelot](https://github.com/ThreeMammals/Ocelot) open source bramy oparte na .NET Core API szczególnie staje się dla architektury mikrousług, wymagającym ujednoliconego punktów wejścia w systemie.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-238">[Ocelot](https://github.com/ThreeMammals/Ocelot) is an open-source .NET Core-based API Gateway especially made for microservices architecture that need unified points of entry into their system.</span></span> <span data-ttu-id="7ce8b-239">Jest lekki, szybkie i skalowalne i udostępnia routingu i uwierzytelniania między wiele innych funkcji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-239">It's lightweight, fast, scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="7ce8b-240">Głównym celem Dlaczego Ocelot został użyty w [eShopOnContainers odwołania aplikacji](https://github.com/dotnet-architecture/eShopOnContainers) ponieważ .NET Core lekkie interfejsu API bramy można wdrożyć na tym samym środowisku wdrażania aplikacji, którym jest wdrażany jest Ocelot mikrousług/kontenerów, takich jak Docker Host, Kubernetes, Service Fabric, itp. Ponieważ jest on oparty na .NET Core, jest wieloplatformowych, co umożliwia wdrażanie w systemie Linux lub Windows i.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-240">The main reason why Ocelot was used in the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, Service Fabric, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="7ce8b-241">Poprzednich diagramach przedstawiający niestandardowych bramy interfejsu API w kontenerach są dokładnie sposób można także uruchomić Ocelot w aplikacji opartej na mikrousługi i kontenera.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-241">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="7ce8b-242">Ponadto istnieje wiele innych produktów na rynku, oferujący funkcje interfejsu API bram, takie jak Apigee, Kong, MuleSoft, WSO2, i innych produktów, takich jak Linkerd i Istio usługi siatki funkcje kontrolera wejściowych.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-242">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="7ce8b-243">Po początkowej architektury i wzorce wyjaśnienie sekcje, w kolejnych sekcjach wyjaśniono sposób implementacji interfejsu API bramy przy użyciu [Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="7ce8b-243">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="7ce8b-244">Wady wzorca bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="7ce8b-244">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="7ce8b-245">Najważniejsze wadą jest to, że podczas implementowania interfejsu API bramy w przypadku sprzężenia warstwa z wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-245">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="7ce8b-246">Sprzężenia w następujący sposób może powodować poważne problemy dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-246">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="7ce8b-247">Vaster Clemens architektów w zespół usługi Azure Service Bus odwołuje się do tego potencjalne problemy jako "nowe ESB" w "[obsługi wiadomości i Mikrousług](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" sesji na GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-247">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as “the new ESB” in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="7ce8b-248">Przy użyciu mikrousług interfejsu API bramy tworzy dodatkowe możliwości pojedynczego punktu awarii.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-248">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="7ce8b-249">Brama usługi interfejsu API można wprowadzać czas odpowiedzi zwiększona z powodu wywołania dodatkowe sieci.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-249">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="7ce8b-250">To wywołanie dodatkowe ma zazwyczaj mniej wpływ niż o kliencie interfejs, który jest zbyt chatty bezpośrednio wywołać wewnętrzny mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-250">However, this extra call usually has less impact than having a client interface that is too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="7ce8b-251">Brama interfejsu API nie skalować w poziomie prawidłowo, może być wąskiego gardła.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-251">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="7ce8b-252">Bramy usługi interfejsu API wymaga programowanie dodatkowych kosztów i konserwacji w przyszłości, jeśli zawiera on niestandardowej logiki i agregacja danych.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-252">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="7ce8b-253">Deweloperzy muszą aktualizuje bramy interfejsu API w celu ekspozycji punktów końcowych każdego mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-253">Developers must update the API Gateway in order to expose each microservice’s endpoints.</span></span> <span data-ttu-id="7ce8b-254">Ponadto zmiany implementacji w wewnętrznej mikrousług może spowodować zmiany kodu na poziomie interfejsu API bramy.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-254">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="7ce8b-255">Jednak jeśli bramy interfejsu API jest po prostu stosowania zabezpieczeń, rejestrowanie i przechowywanie wersji (w przypadku korzystania z usługi Azure API Management), ten koszt dodatkowe programowanie może nie mieć zastosowania.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-255">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="7ce8b-256">Jeśli brama interfejsu API opracowanego przez jeden zespół, może być wąskie gardło rozwoju.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-256">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="7ce8b-257">Jest to kolejny powód, dlaczego lepszym rozwiązaniem jest kilka dopasowanymi grzywną interfejsu API bram, które odpowiadają na potrzeby innego klienta.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-257">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="7ce8b-258">Brama interfejsu API można również segregowanie wewnętrznie do wielu obszarów i warstwy, które należą do różnych zespołów pracuje wewnętrzny mikrousług.</span><span class="sxs-lookup"><span data-stu-id="7ce8b-258">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="7ce8b-259">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="7ce8b-259">Additional resources</span></span>

- <span data-ttu-id="7ce8b-260">**Lesiak Charlesa. Wzorzec: Interfejs API bramy / wewnętrznej bazy danych dla frontonu** [*https://microservices.io/patterns/apigateway.html*](https://microservices.io/patterns/apigateway.html)</span><span class="sxs-lookup"><span data-stu-id="7ce8b-260">**Charles Richardson. Pattern: API Gateway / Backend for Front-End** [*https://microservices.io/patterns/apigateway.html*](https://microservices.io/patterns/apigateway.html)</span></span>

- <span data-ttu-id="7ce8b-261">**Wzorzec bramy interfejsu API** [*https://docs.microsoft.com/azure/architecture/microservices/gateway*](https://docs.microsoft.com/azure/architecture/microservices/gateway)</span><span class="sxs-lookup"><span data-stu-id="7ce8b-261">**API Gateway pattern** [*https://docs.microsoft.com/azure/architecture/microservices/gateway*](https://docs.microsoft.com/azure/architecture/microservices/gateway)</span></span>

- <span data-ttu-id="7ce8b-262">**Wzorzec agregacji i kompozycji** [*http://microservices.io/patterns/data/api-composition.html*](http://microservices.io/patterns/data/api-composition.html)</span><span class="sxs-lookup"><span data-stu-id="7ce8b-262">**Aggregation and composition pattern** [*http://microservices.io/patterns/data/api-composition.html*](http://microservices.io/patterns/data/api-composition.html)</span></span>

- <span data-ttu-id="7ce8b-263">**Zarządzanie interfejsami API Azure** [*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span><span class="sxs-lookup"><span data-stu-id="7ce8b-263">**Azure API Management** [*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span></span>

- <span data-ttu-id="7ce8b-264">**Udi Dahan. Kompozycja zorientowane na usługę**\\</span><span class="sxs-lookup"><span data-stu-id="7ce8b-264">**Udi Dahan. Service-Oriented Composition**\\</span></span>
    [*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)

- <span data-ttu-id="7ce8b-265">**Clemens Vasters. Wiadomości i Mikrousług na GOTO 2016** (klip wideo)   [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span><span class="sxs-lookup"><span data-stu-id="7ce8b-265">**Clemens Vasters. Messaging and Microservices at GOTO 2016** (video)   [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="7ce8b-266">[Poprzednie] (zidentyfikować mikrousługi domeny — model-boundaries.md) [dalej] (komunikacji w — mikrousługi architecture.md)</span><span class="sxs-lookup"><span data-stu-id="7ce8b-266">[Previous] (identify-microservice-domain-model-boundaries.md) [Next] (communication-in-microservice-architecture.md)</span></span>
