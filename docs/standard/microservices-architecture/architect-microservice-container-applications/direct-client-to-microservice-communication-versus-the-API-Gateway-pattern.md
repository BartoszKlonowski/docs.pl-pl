---
title: Wzorzec bramy interfejsu API i bezpośrednia komunikacja klienta z mikrousługą
description: Dowiedz się, różnice i wykorzystuje wzorzec bramy interfejsu API i bezpośrednia komunikacja klienta z mikrousługą.
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 09/20/2018
ms.openlocfilehash: 36b95f8b6308773dbb49cc68e4f8e2099bdd1ff0
ms.sourcegitcommit: 35316b768394e56087483cde93f854ba607b63bc
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/26/2018
ms.locfileid: "52297318"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="6658a-103">Wzorzec bramy interfejsu API i bezpośrednia komunikacja klienta z mikrousługą</span><span class="sxs-lookup"><span data-stu-id="6658a-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="6658a-104">W architekturze mikrousług każda mikrousługa ujawnia zestaw punktów końcowych (zazwyczaj) szczegółowych.</span><span class="sxs-lookup"><span data-stu-id="6658a-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="6658a-105">Ten fakt może mieć wpływ na komunikację klienta z mikrousługą, zgodnie z opisem w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="6658a-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="6658a-106">Bezpośrednia komunikacja klienta z mikrousługą</span><span class="sxs-lookup"><span data-stu-id="6658a-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="6658a-107">Możliwych podejść jest bezpośrednia komunikacja klienta z mikrousługą opartych na architekturze.</span><span class="sxs-lookup"><span data-stu-id="6658a-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="6658a-108">W tej metodzie aplikacja kliencka mogą wysyłać żądania bezpośrednio do niektórych mikrousług, jak pokazano na rysunku 4-12.</span><span class="sxs-lookup"><span data-stu-id="6658a-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagram przedstawiający bezpośrednia komunikacja klienta z mikrousługą architektury, w którym każda aplikacja komunikuje się bezpośrednio z poszczególne mikrousługi.](./media/image12.png)

<span data-ttu-id="6658a-110">**Rysunek 4-12**.</span><span class="sxs-lookup"><span data-stu-id="6658a-110">**Figure 4-12**.</span></span> <span data-ttu-id="6658a-111">Przy użyciu architektury bezpośrednia komunikacja klienta z mikrousługą</span><span class="sxs-lookup"><span data-stu-id="6658a-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="6658a-112">W tym podejściu poszczególne mikrousługi ma publiczny punkt końcowy, czasami z różnych portów TCP dla poszczególnych mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="6658a-113">Przykładowy adres URL dla określonej usługi może być następujący adres URL na platformie Azure:</span><span class="sxs-lookup"><span data-stu-id="6658a-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

<http://eshoponcontainers.westus.cloudapp.azure.com:88/>

<span data-ttu-id="6658a-114">W środowisku produkcyjnym, oparte na klastrze mapującej adres URL do modułu równoważenia obciążenia, używany w klastrze, który z kolei rozkłada żądania na mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="6658a-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="6658a-115">W środowiskach produkcyjnych, może mieć Application Delivery kontrolera (ADC) takich jak [usługi Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) mikrousługi od Internetu.</span><span class="sxs-lookup"><span data-stu-id="6658a-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="6658a-116">Jest to zabezpieczenie przezroczyste warstwy, która nie przeprowadza równoważenia obciążenia tylko zabezpiecza usług, oferując kończenia żądań SSL.</span><span class="sxs-lookup"><span data-stu-id="6658a-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="6658a-117">Zwiększa to obciążenie hostów, przenosząc kończenia żądań SSL mocy procesora CPU i inne opłaty routingu do usługi Azure Application Gateway.</span><span class="sxs-lookup"><span data-stu-id="6658a-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="6658a-118">W każdym przypadku modułu równoważenia obciążenia i ADC są niewidoczne z aplikacji logicznych architektury punktu widzenia.</span><span class="sxs-lookup"><span data-stu-id="6658a-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="6658a-119">Architektura bezpośrednia komunikacja klienta z mikrousługą może być wystarczające dla małych aplikacji opartych na mikrousługach, zwłaszcza, jeśli aplikacja kliencka jest aplikacją sieci web po stronie serwera, np. aplikację ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="6658a-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="6658a-120">Jednak podczas kompilowania dużych i złożonych aplikacji opartych na mikrousługach (na przykład podczas obsługi dziesiątek, jak mikrousługi typów), a zwłaszcza w przypadku, gdy aplikacje klienckie są zdalnej aplikacji mobilnych lub aplikacji sieci web SPA, takie podejście twarzy kilka kwestii.</span><span class="sxs-lookup"><span data-stu-id="6658a-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="6658a-121">Podczas tworzenia dużych aplikacji opartego na mikrousługach, należy wziąć pod uwagę następujące kwestie:</span><span class="sxs-lookup"><span data-stu-id="6658a-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="6658a-122">*Jak aplikacje klienckie zminimalizować liczbę żądania do zaplecza i zmniejszyć nasilenie komunikacji do wielu mikrousług?*</span><span class="sxs-lookup"><span data-stu-id="6658a-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="6658a-123">Interakcja z wielu mikrousług, co umożliwia tworzenie jednego ekranu interfejsu użytkownika powoduje zwiększenie liczby rund w Internecie.</span><span class="sxs-lookup"><span data-stu-id="6658a-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="6658a-124">Zwiększa to opóźnienie i złożoność po stronie interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="6658a-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="6658a-125">W idealnym przypadku odpowiedzi efektywnie agregowania po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="6658a-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="6658a-126">Zmniejsza to opóźnienia, ponieważ wiele rodzajów danych możesz wrócić w sposób równoległy, a niektóre interfejsu użytkownika można wyświetlać dane, gdy tylko będzie gotowa.</span><span class="sxs-lookup"><span data-stu-id="6658a-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="6658a-127">*Jak obsługiwać odciąż przekrojowe zagadnienia, takie jak autoryzacja, przekształcenia danych i wysyła żądanie dynamiczne?*</span><span class="sxs-lookup"><span data-stu-id="6658a-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="6658a-128">Implementowanie zabezpieczeń i odciąż przekrojowe zagadnienia, takie jak zabezpieczenia i autoryzacji w mikrousługach, co może wymagać znaczących postanowiło.</span><span class="sxs-lookup"><span data-stu-id="6658a-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="6658a-129">Możliwych podejść jest tych usług w ramach wewnątrz klastra lub hosta platformy Docker, aby ograniczyć bezpośredni dostęp do nich z zewnątrz i do implementowania tych odciąż przekrojowe zagadnienia w centralnym miejscu, takie jak bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6658a-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="6658a-130">Jak może aplikacje klienckie komunikować się z usługami, które używają protokołów innych niż Internet przyjazne? \*</span><span class="sxs-lookup"><span data-stu-id="6658a-130">How can client apps communicate with services that use non-Internet-friendly protocols?\*</span></span>

<span data-ttu-id="6658a-131">Protokoły używane po stronie serwera (na przykład protokół AMQP lub protokołów binarnych) zwykle nie są obsługiwane w aplikacjach klienckich.</span><span class="sxs-lookup"><span data-stu-id="6658a-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="6658a-132">W związku z tym żądania musi być wykonywane za pośrednictwem protokołów, takich jak HTTP/HTTPS i przetłumaczone na inne protokoły później.</span><span class="sxs-lookup"><span data-stu-id="6658a-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="6658a-133">A *ataków typu man-in--middle* podejście może pomóc w takiej sytuacji.</span><span class="sxs-lookup"><span data-stu-id="6658a-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="6658a-134">*Jak możesz kształtować fasada szczególnie wprowadzone dla aplikacji mobilnych*</span><span class="sxs-lookup"><span data-stu-id="6658a-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="6658a-135">Interfejs API z wielu mikrousług może nie dobrze zaprojektowany na potrzeby różnych aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="6658a-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="6658a-136">Na przykład na potrzeby aplikacji mobilnej może być inny niż na potrzeby aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="6658a-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="6658a-137">Dla aplikacji mobilnych konieczne może być jeszcze bardziej zoptymalizować, tak, aby dane odpowiedzi może być bardziej efektywne.</span><span class="sxs-lookup"><span data-stu-id="6658a-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="6658a-138">Być może w tym celu agregowania danych z wielu mikrousług, zwracając jednego zestawu danych i czasami wyeliminowanie wszelkich danych w odpowiedzi, który nie jest wymagane przez aplikację mobilną.</span><span class="sxs-lookup"><span data-stu-id="6658a-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="6658a-139">I oczywiście, można kompresować dane.</span><span class="sxs-lookup"><span data-stu-id="6658a-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="6658a-140">Ponownie fasady lub interfejsu API Between mikrousług i aplikacji mobilnej może być wygodna dla tego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="6658a-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="6658a-141">Dlaczego warto wziąć pod uwagę bramy interfejsu API, zamiast bezpośredniej komunikacji klienta z mikrousługą</span><span class="sxs-lookup"><span data-stu-id="6658a-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="6658a-142">W architekturze mikrousług aplikacje klienckie zwykle konieczne używanie funkcji z więcej niż jeden mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="6658a-143">Jeśli użycie tego jest wykonywana bezpośrednio, klient musi obsługiwać wiele wywołań do punktów końcowych mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="6658a-144">Co się dzieje podczas rozwoju aplikacji i nowych mikrousług są wprowadzane lub aktualizacji istniejącej mikrousług?</span><span class="sxs-lookup"><span data-stu-id="6658a-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="6658a-145">Jeśli aplikacja ma wiele mikrousług, obsługi tak wielu punktów końcowych z aplikacji klienta może być okropnej.</span><span class="sxs-lookup"><span data-stu-id="6658a-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="6658a-146">Ponieważ aplikacja kliencka może zostać dołączone do tych wewnętrznych punktów końcowych, ewoluują mikrousługi w przyszłości może spowodować duży wpływ na aplikacje klienckie.</span><span class="sxs-lookup"><span data-stu-id="6658a-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="6658a-147">W związku z tym poziom pośredni lub warstwy pośredni (brama) może być wygodna dla aplikacji opartych na mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="6658a-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="6658a-148">Jeśli nie masz bramy interfejsu API, aplikacje klienckie musi wysyłać żądania bezpośrednio do mikrousług i która zgłasza problemy, takie jak następujące problemy:</span><span class="sxs-lookup"><span data-stu-id="6658a-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="6658a-149">**Sprzężenia**: bez wzorzec bramy interfejsu API, aplikacje klienckie są ściśle do wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="6658a-150">Aplikacje klienckie, trzeba wiedzieć, jak wiele obszarów aplikacji są rozłożone w mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="6658a-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="6658a-151">Gdy ewoluują i refaktoryzacji wewnętrznego mikrousług, wpływ na te akcje konserwacji wygląda niewłaściwie ponieważ powodują one przełomowe zmiany w aplikacjach klienta z powodu bezpośrednie odwołanie do wewnętrznego mikrousług z klienta aplikacji.</span><span class="sxs-lookup"><span data-stu-id="6658a-151">When evolving and refactoring the internal microservices, those actions impact maintenance pretty badly because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="6658a-152">Aplikacje klienckie muszą zostać zaktualizowane, co rozwiązanie trudniejsze ciągły rozwój.</span><span class="sxs-lookup"><span data-stu-id="6658a-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="6658a-153">**Zbyt wiele rund**: pojedynczej strony/ekranu w aplikacji klienckiej może wymagać kilka wywołań do wielu usług.</span><span class="sxs-lookup"><span data-stu-id="6658a-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="6658a-154">Czy można wynik na liście sieci wielu rund między klientem i serwerem oraz dodawanie znaczne opóźnienie.</span><span class="sxs-lookup"><span data-stu-id="6658a-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="6658a-155">Obsługiwane w poziom pośredni agregacji może poprawić wydajność i środowisko użytkownika dla aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="6658a-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="6658a-156">**Problemy z zabezpieczeniami**: bez bramy, muszą być widoczne wszystkie mikrousługi "zewnętrznych world", dzięki czemu obszar narażony na ataki większy niż ukryjesz bezpośrednio nie są używane przez aplikacje klienckie wewnętrznej mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="6658a-157">Jest mniejszy obszar narażony na ataki, bezpieczniejsze może być aplikacji.</span><span class="sxs-lookup"><span data-stu-id="6658a-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="6658a-158">**Odciąż przekrojowe zagadnienia**: każdego publikowanego publicznie mikrousług musi obsługiwać problemy takie jak uwierzytelnianie, protokół SSL, itp. W wielu sytuacjach te problemy można obsługiwane w pojedynczej warstwie, więc wewnętrznego mikrousługi są uproszczone.</span><span class="sxs-lookup"><span data-stu-id="6658a-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization, SSL, etc. In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="6658a-159">Co to jest wzorzec bramy interfejsu API?</span><span class="sxs-lookup"><span data-stu-id="6658a-159">What is the API Gateway pattern?</span></span>

<span data-ttu-id="6658a-160">Podczas projektowania i tworzenia aplikacji w dużej lub złożonej aplikacji opartych na mikrousługach za pomocą wielu klientów może być dobrym sposobem należy wziąć pod uwagę [bramy interfejsu API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="6658a-160">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="6658a-161">Jest to usługa, która dostarcza punktem pojedynczy wpis dla niektórych grup mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-161">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="6658a-162">Jest on podobny do [wzorzec fasady](https://en.wikipedia.org/wiki/Facade_pattern) od projektu zorientowane obiektowo, ale w takim przypadku swoich części systemu rozproszonego.</span><span class="sxs-lookup"><span data-stu-id="6658a-162">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="6658a-163">Wzorzec bramy interfejsu API jest również nazywany "wewnętrzna frontonu" ([BFF](https://samnewman.io/patterns/architectural/bff/)) a ponieważ tworzysz podczas myśleć o potrzeby aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="6658a-163">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="6658a-164">W związku między aplikacjami klienta i mikrousługi znajduje się brama interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6658a-164">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="6658a-165">Działa ona jako zwrotny serwer proxy kierowania żądań od klientów do usługi.</span><span class="sxs-lookup"><span data-stu-id="6658a-165">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="6658a-166">Można też podać dodatkowe funkcje przekrojowe, takie jak uwierzytelnianie, kończenie żądań SSL i pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="6658a-166">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="6658a-167">Rysunek 4 — 13 przedstawiono, jak niestandardowe bramy interfejsu API można dopasować do uproszczenia architektury oparte na mikrousługach przy użyciu zaledwie kilku mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-167">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagram przedstawiający bramy interfejsu API zaimplementowane jako to usługa niestandardowa, więc aplikacje połączenie z jednym punkcie końcowym bramę interfejsu API, który jest skonfigurowany do przesyłania żądań do poszczególnych mikrousług.](./media/image13.png)

<span data-ttu-id="6658a-169">**Rysunek 4 — 13**.</span><span class="sxs-lookup"><span data-stu-id="6658a-169">**Figure 4-13**.</span></span> <span data-ttu-id="6658a-170">Przy użyciu bramy interfejsu API zaimplementowane jako usługa niestandardowa</span><span class="sxs-lookup"><span data-stu-id="6658a-170">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="6658a-171">W tym przykładzie brama interfejsu API będzie można zaimplementować jako to usługa niestandardowa hostem sieci Web platformy ASP.NET Core uruchomionego jako kontener.</span><span class="sxs-lookup"><span data-stu-id="6658a-171">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="6658a-172">Jest ważne podkreślić że na tym diagramie, jak można przy użyciu jednej niestandardowych usługi bramy interfejsu API połączonego z wieloma i klienta w różnych aplikacjach.</span><span class="sxs-lookup"><span data-stu-id="6658a-172">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="6658a-173">Czy fakt może być ważne ryzyka, ponieważ usługi bramy interfejsu API będzie stałym wzbogacaniu i zmieniających się na podstawie wielu różnych wymagań aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="6658a-173">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="6658a-174">Po pewnym czasie będzie przeglądarek z powodu tych różnych potrzeb i skutecznie może być dość podobne do aplikacji monolitycznej lub monolityczne usługi.</span><span class="sxs-lookup"><span data-stu-id="6658a-174">Eventually, it will be bloated because of those different needs and effectively it could be pretty similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="6658a-175">Dlatego bardzo dużo zalecane jest podzielenie bramy interfejsu API w wielu usługach lub wielu mniejszych bramy interfejsu API, jeden na typ współczynnika postaci aplikacji klienckich, na przykład.</span><span class="sxs-lookup"><span data-stu-id="6658a-175">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="6658a-176">Należy zachować ostrożność podczas implementowania wzorca bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6658a-176">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="6658a-177">Zwykle nie jest dobry pomysł, aby mieć pojedynczy interfejs API bramy agregowania wszystkie mikrousługi wewnętrznych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="6658a-177">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="6658a-178">Jeśli tak jest, działa jako monolityczny agregatora lub programu orchestrator i narusza Autonomia mikrousług przez wszystkie mikrousługi sprzężenia.</span><span class="sxs-lookup"><span data-stu-id="6658a-178">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="6658a-179">W związku z tym bramy interfejsu API powinno rozdzielony na podstawie granic firm i aplikacje klienckie i nie act jako pojedynczy agregatora wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-179">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="6658a-180">W przypadku dzielenia warstwa bramy interfejsu API do wielu bram interfejsu API, jeśli aplikacja ma wiele aplikacji klienckich, które mogą być tabelę przestawną podstawowej przy identyfikowaniu wiele typów bramy interfejsu API, dzięki czemu może mieć różne fasada dla potrzeb każdej aplikacji klienta.</span><span class="sxs-lookup"><span data-stu-id="6658a-180">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="6658a-181">Ten przypadek jest wzorcem o nazwie "Wewnętrznej bazy danych dla serwera sieci Web" ([BFF](https://samnewman.io/patterns/architectural/bff/)) w przypadku, gdy każda brama interfejsu API może zapewnić innego interfejsu API, dostosowane do poszczególnych typów aplikacji klienckich, potencjalnie nawet na podstawie współczynnika postaci klienta przez zaimplementowanie określonej karty kodu, który na dole wywołuje wiele mikrousług wewnętrznych, jak pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="6658a-181">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagram przedstawiający wiele niestandardowych bramy interfejsu API, w którym bramy interfejsu API są rozdzielone według typu klienta; jeden dla klientów mobilnych i jeden dla klientów w sieci web.](./media/image13.1.png)

<span data-ttu-id="6658a-184">**Rysunek 4-13.1**.</span><span class="sxs-lookup"><span data-stu-id="6658a-184">**Figure 4-13.1**.</span></span> <span data-ttu-id="6658a-185">Za pomocą wielu niestandardowych bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="6658a-185">Using multiple custom API Gateways</span></span>

<span data-ttu-id="6658a-186">Na poprzedniej ilustracji przedstawiono uproszczona architektura o wiele szczegółowych bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6658a-186">The previous image shows a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="6658a-187">W tym przypadku granice dla każdej bramy interfejsu API są oparte wyłącznie na "Wewnętrznej bazy danych dla frontonu" ([BFF](https://samnewman.io/patterns/architectural/bff/)) wzorzec, dlatego tylko na podstawie interfejsu API potrzebne dla aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="6658a-187">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="6658a-188">Jednak w dużych aplikacji należy również użyteczność i utworzyć dodatkowe bramy interfejsu API oparte na granice firmy jako drugi pivot projektu.</span><span class="sxs-lookup"><span data-stu-id="6658a-188">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="6658a-189">Główne funkcje we wzorcu bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="6658a-189">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="6658a-190">Brama interfejsu API oferują wiele funkcji.</span><span class="sxs-lookup"><span data-stu-id="6658a-190">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="6658a-191">W zależności od produktu może zaoferować bardziej rozbudowane lub prostsze funkcje jednak najważniejsze i podstawowe funkcje dla żadnej bramy interfejsu API są następujące wzorce projektowe:</span><span class="sxs-lookup"><span data-stu-id="6658a-191">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="6658a-192">**Zwrotny serwer proxy lub routing bramy.**</span><span class="sxs-lookup"><span data-stu-id="6658a-192">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="6658a-193">Brama interfejsu API oferuje zwrotny serwer proxy do przekierowania lub kierować żądania (routingu warstwy 7, zwykle żądań HTTP) do punktów końcowych wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-193">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="6658a-194">Brama zapewnia jeden punkt końcowy lub adres URL dla klienta aplikacji, a następnie wewnętrznie mapuje żądania do grupy wewnętrznej mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-194">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="6658a-195">Ta funkcja routingu pomaga oddzielić aplikacje klienckie z mikrousług, ale jest również bardzo wygodne po modernizowanie monolityczne interfejsu API przez znajdują się brama interfejsu API Between monolityczne interfejsu API i aplikacje klienckie, a następnie możesz dodać nowe interfejsy API jako nowych mikrousług czas nadal przy użyciu starszej wersji interfejsu API z monolitycznego, dopóki dzieli się na wielu mikrousług, co w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="6658a-195">This routing feature helps to decouple the client apps from the microservices but it's also pretty convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="6658a-196">Ze względu na bramę interfejsu API aplikacje klienckie nie będą zauważyć, jeśli interfejsy API używane są implementowane jako wewnętrzny mikrousług lub monolityczne interfejsu API i co ważniejsze, kiedy ewolucji i refaktoryzacji monolityczne interfejsu API na mikrousługi, dziękuję routingu bramy interfejsu API , nie będzie mieć wpływ na aplikacje klienckie w przypadku każdej zmiany identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="6658a-196">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="6658a-197">Aby uzyskać więcej informacji, zobacz [wzorzec routingu bramy](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="6658a-197">For more information, see [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="6658a-198">**Agregacja żądań.**</span><span class="sxs-lookup"><span data-stu-id="6658a-198">**Requests aggregation.**</span></span> <span data-ttu-id="6658a-199">Jako część wzorca bramy można zagregować wiele żądań klientów (zazwyczaj żądań HTTP) przeznaczone dla wielu mikrousług wewnętrznego na jedno żądanie klienta.</span><span class="sxs-lookup"><span data-stu-id="6658a-199">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="6658a-200">Ten wzorzec jest zwłaszcza wtedy, gdy ekran/strony klienta wymaga informacji z wielu mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-200">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="6658a-201">Dzięki tej metodzie aplikacja kliencka wysyła pojedynczego żądania do bramy interfejsu API, która wywołuje kilka żądań do wewnętrznego mikrousług, a następnie agreguje wyniki i wysyła wszystkie elementy z powrotem do aplikacji klienckiej.</span><span class="sxs-lookup"><span data-stu-id="6658a-201">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="6658a-202">Główne korzyści i celów związanych z tym wzorcu projektowym jest ograniczenie liczby operacji między aplikacjami klienta i zaplecza interfejsu API, który jest szczególnie ważne w przypadku aplikacji zdalnych poza centrum danych, gdzie mikrousług na żywo, takie jak aplikacja mobilna lub żądania pochodzące z aplikacji SPA, pochodzą z języka Javascript w przeglądarkach zdalnego klienta.</span><span class="sxs-lookup"><span data-stu-id="6658a-202">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from Javascript in client remote browsers.</span></span> <span data-ttu-id="6658a-203">Dla zwykłych aplikacji internetowych Wykonywanie żądań w środowisku serwera (na przykład aplikacja sieci web platformy ASP.NET Core MVC) ten wzorzec nie jest tak ważne, ponieważ opóźnienie jest znacznie mniejszy niż w przypadku aplikacji klienta zdalnego.</span><span class="sxs-lookup"><span data-stu-id="6658a-203">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="6658a-204">W zależności od produktu bramy interfejsu API, których używasz może być możliwe do wykonania tej agregacji.</span><span class="sxs-lookup"><span data-stu-id="6658a-204">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="6658a-205">Jednak w wielu przypadkach jest bardziej elastyczna, że można utworzyć mikrousługi agregacji w zakresie bramy interfejsu API, aby zdefiniować agregacji w kodzie (czyli C# kodu):</span><span class="sxs-lookup"><span data-stu-id="6658a-205">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="6658a-206">Aby uzyskać więcej informacji, zobacz [wzorzec agregacji za pomocą bramy](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="6658a-206">For more information, see [Gateway aggregation pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="6658a-207">**Odciąż przekrojowe zagadnienia lub Odciążanie bramy.**</span><span class="sxs-lookup"><span data-stu-id="6658a-207">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="6658a-208">W zależności od funkcji oferowanych przez każdy produkt bramy interfejsu API można odciążyć działaniu między poszczególne mikrousługi bramy, która ułatwia implementację poszczególne mikrousługi konsolidując odciąż przekrojowe zagadnienia do jednej warstwy.</span><span class="sxs-lookup"><span data-stu-id="6658a-208">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="6658a-209">Jest to szczególnie wygodne specjalne funkcje, które mogą być złożone, aby prawidłowo zaimplementować w każdej mikrousługi wewnętrznych, takich jak następujące funkcje:</span><span class="sxs-lookup"><span data-stu-id="6658a-209">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="6658a-210">Uwierzytelnianie i autoryzacja</span><span class="sxs-lookup"><span data-stu-id="6658a-210">Authentication and authorization</span></span>
- <span data-ttu-id="6658a-211">Integracja z usługą odnajdywania</span><span class="sxs-lookup"><span data-stu-id="6658a-211">Service discovery integration</span></span>
- <span data-ttu-id="6658a-212">Buforowanie odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="6658a-212">Response caching</span></span>
- <span data-ttu-id="6658a-213">Ponów próbę wykonania zasady, wyłącznika i QoS</span><span class="sxs-lookup"><span data-stu-id="6658a-213">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="6658a-214">Ograniczanie szybkości i ograniczania przepustowości</span><span class="sxs-lookup"><span data-stu-id="6658a-214">Rate limiting and throttling</span></span>
- <span data-ttu-id="6658a-215">Równoważenie obciążenia</span><span class="sxs-lookup"><span data-stu-id="6658a-215">Load balancing</span></span>
- <span data-ttu-id="6658a-216">Rejestrowanie i śledzenie korelacji</span><span class="sxs-lookup"><span data-stu-id="6658a-216">Logging, tracing, correlation</span></span>
- <span data-ttu-id="6658a-217">Nagłówki, ciągów zapytań i przekształcania oświadczeń</span><span class="sxs-lookup"><span data-stu-id="6658a-217">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="6658a-218">Listy dozwolonych adresów IP</span><span class="sxs-lookup"><span data-stu-id="6658a-218">IP whitelisting</span></span>

<span data-ttu-id="6658a-219">Aby uzyskać więcej informacji, zobacz [wzorzec odciążania bramy](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="6658a-219">For more information, see [Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="6658a-220">Za pomocą produktów dzięki funkcjom bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="6658a-220">Using products with API Gateway features</span></span>

<span data-ttu-id="6658a-221">Może istnieć wiele więcej odciąż przekrojowe zagadnienia oferowane przez produkty bramy interfejsu API, w zależności od każdego wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="6658a-221">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="6658a-222">Przyjrzymy się tutaj:</span><span class="sxs-lookup"><span data-stu-id="6658a-222">We'll explore here:</span></span>

- [<span data-ttu-id="6658a-223">Usługa Azure API Management</span><span class="sxs-lookup"><span data-stu-id="6658a-223">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="6658a-224">Ocelot</span><span class="sxs-lookup"><span data-stu-id="6658a-224">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="6658a-225">Usługa Azure API Management</span><span class="sxs-lookup"><span data-stu-id="6658a-225">Azure API Management</span></span>

<span data-ttu-id="6658a-226">[Usługa Azure API Management](https://azure.microsoft.com/services/api-management/) (jak pokazano w rysunek 4 – 14) nie tylko rozwiązuje potrzeb bramy interfejsu API, ale zapewnia funkcje, takie jak zbieranie szczegółowych informacji z interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="6658a-226">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="6658a-227">Jeśli używasz interfejsu API rozwiązania do zarządzania, bramę interfejsu API jest tylko składnik w tym pełnego rozwiązania zarządzania interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6658a-227">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Usługa Azure API Management rozwiązuje oba bramy interfejsu API i zarządzanie potrzeb takich jak rejestrowanie, zabezpieczeń, zliczania itp.](./media/image14.png)

<span data-ttu-id="6658a-229">**Rysunek 4 – 14**.</span><span class="sxs-lookup"><span data-stu-id="6658a-229">**Figure 4-14**.</span></span> <span data-ttu-id="6658a-230">Za pomocą usługi Azure API Management dla swojej bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="6658a-230">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="6658a-231">W takim przypadku korzystać z produktu, takich jak usługi Azure API Management, fakt, że może być pojedynczą bramą interfejsu API jest, więc ryzykowne ponieważ tego rodzaju bramy interfejsu API "cieńsza", co oznacza, nie Implementowanie niestandardowego kodu C#, rozwijać kierunku monolityczne składnik.</span><span class="sxs-lookup"><span data-stu-id="6658a-231">In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span> <span data-ttu-id="6658a-232">Te produkty zachowywać się jak zwrotny serwer proxy komunikacji z transferem danych przychodzących, gdzie możesz można filtrować interfejsów API z wewnętrznego mikrousług i dotyczą autoryzacji opublikowanych interfejsów API w tej warstwie jednego.</span><span class="sxs-lookup"><span data-stu-id="6658a-232">These products act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices and apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="6658a-233">Produkty bramy interfejsu API zazwyczaj pełnić rolę zwrotnego serwera proxy do komunikacji z transferem danych przychodzących, można gdzie też filtrować interfejsów API z wewnętrznego mikrousługi oraz dotyczą autoryzacji opublikowanych interfejsów API w tej warstwie pojedynczego.</span><span class="sxs-lookup"><span data-stu-id="6658a-233">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="6658a-234">Dostępne z usługi API Management system pomocy szczegółowe informacje zawierają opis sposobu używania interfejsów API i jak są wykonywane.</span><span class="sxs-lookup"><span data-stu-id="6658a-234">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="6658a-235">Robią to, co pozwala wyświetlać niemal do użycia raportów analitycznych w czasie rzeczywistym i identyfikowania trendów, które mogą mieć wpływ na działalność.</span><span class="sxs-lookup"><span data-stu-id="6658a-235">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="6658a-236">Ponadto może mieć rejestruje działanie żądania i odpowiedzi w celu dalszej analizy online i offline.</span><span class="sxs-lookup"><span data-stu-id="6658a-236">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="6658a-237">Dzięki usłudze Azure API Management można zabezpieczyć swoje interfejsy API przy użyciu klucza, token oraz filtrowania adresów IP.</span><span class="sxs-lookup"><span data-stu-id="6658a-237">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="6658a-238">Te funkcje umożliwiają wymuszanie limitów przydziałów elastycznych i szczegółowych i limity szybkości, Modyfikuj kształt i zachowanie interfejsów API przy użyciu zasad i poprawianie wydajności za pomocą buforowanie odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="6658a-238">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="6658a-239">W tym przewodniku i odwołanie do przykładowej aplikacji (w ramach aplikacji eShopOnContainers) architektury jest ograniczona do prostszy i poza biurem architektura konteneryzowanych celu skupiania się na kontenery zwykłego bez korzystania z produktów PaaS, takich jak usługi Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="6658a-239">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="6658a-240">Jednak w przypadku dużych opartych na mikrousługach aplikacji, które zostały wdrożone na platformie Microsoft Azure, firma Microsoft zachęca do oceny usługi Azure API Management jako podstawy dla bram Twojego interfejsu API w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="6658a-240">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="6658a-241">Ocelot</span><span class="sxs-lookup"><span data-stu-id="6658a-241">Ocelot</span></span>

<span data-ttu-id="6658a-242">[Ocelot](https://github.com/ThreeMammals/Ocelot) jest uproszczona brama interfejsu API zalecane w przypadku prostszych metod.</span><span class="sxs-lookup"><span data-stu-id="6658a-242">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="6658a-243">Ocelot jest Otwórz źródło .NET Core bramy interfejsu API opartych na systemie szczególnie wprowadzone dla architektury mikrousług, wymagających ujednoliconego punktów wejścia w ich systemie.</span><span class="sxs-lookup"><span data-stu-id="6658a-243">Ocelot is an Open Source .NET Core based API Gateway especially made for microservices architecture that need unified points of entry into their system.</span></span> <span data-ttu-id="6658a-244">Jest lekkie, szybkie i skalowalne i zapewnia routingu i uwierzytelniania między wiele innych funkcji.</span><span class="sxs-lookup"><span data-stu-id="6658a-244">It's lightweight, fast, scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="6658a-245">Głównym celem wybierz Ocelot dla [ramach aplikacji eShopOnContainers odwołania aplikacji](https://github.com/dotnet-architecture/eShopOnContainers) jest, ponieważ Ocelot platformy .NET Core uproszczone brama interfejsu API, którą można wdrożyć na tym samym środowisku wdrożenia aplikacji, którym jest wdrażany mikrousługi/kontenerów, takich jak Host platformy Docker, Kubernetes, usługi Service Fabric itp. I ponieważ jest on oparty na platformie .NET Core, Międzyplatformowe, dzięki czemu można wdrażać w systemie Linux lub Windows.</span><span class="sxs-lookup"><span data-stu-id="6658a-245">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, Service Fabric, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="6658a-246">Poprzednich diagramach, przedstawiający niestandardowe bramy interfejsu API działających w kontenerach są dokładnie, jak można również uruchomić Ocelot w kontenerze i aplikacji opartych na mikrousługach.</span><span class="sxs-lookup"><span data-stu-id="6658a-246">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="6658a-247">Ponadto w rynku, oferujący funkcje bramy interfejsu API, takich jak Apigee, Hongkong, MuleSoft WSO2, istnieje wiele innych produktów i innych produktów, takich jak Linkerd i Istio usługi siatki funkcje kontrolera danych przychodzących.</span><span class="sxs-lookup"><span data-stu-id="6658a-247">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="6658a-248">Po początkowej architektura i wzorce wyjaśnienie sekcje, w kolejnych sekcjach wyjaśniono, jak zaimplementować bramy interfejsu API za pomocą [Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="6658a-248">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="6658a-249">Wady wzorzec bramy interfejsu API</span><span class="sxs-lookup"><span data-stu-id="6658a-249">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="6658a-250">Najważniejsze wadą jest to, że podczas implementowania bramy interfejsu API są sprzężenia tej warstwy za pomocą wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-250">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="6658a-251">Sprzężenia, np. to może powodować poważne problemy dla swojej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="6658a-251">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="6658a-252">Vaster Clemensa Architekt zespół usługi Azure Service Bus odwołuje się do tego potencjalnych trudności, jako "nowe ESB" w "[komunikatów i Mikrousług](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" sesji Konferencji GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="6658a-252">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="6658a-253">Przy użyciu mikrousług bramy interfejsu API tworzy dodatkowe możliwości pojedynczy punkt awarii.</span><span class="sxs-lookup"><span data-stu-id="6658a-253">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="6658a-254">Brama interfejsu API może wprowadzić wydłużenia czasów odpowiedzi ze względu na wywołanie dodatkowe sieci.</span><span class="sxs-lookup"><span data-stu-id="6658a-254">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="6658a-255">To dodatkowe wywołanie ma zwykle mniejszym wpływem na niż w przypadku interfejsu klienta, który jest zbyt duża liczba bezpośrednie wywoływanie wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-255">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="6658a-256">Nie skalowana w poziomie prawidłowo, może stać się wąskim gardłem przez bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6658a-256">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="6658a-257">Bramy interfejsu API wymaga dodatkowego programowania kosztów i konserwacji w przyszłości, jeśli zawiera logikę niestandardową i agregacja danych.</span><span class="sxs-lookup"><span data-stu-id="6658a-257">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="6658a-258">Deweloperzy muszą aktualizuje bramy interfejsu API w celu uwidaczniają punkty końcowe poszczególne mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="6658a-258">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="6658a-259">Ponadto wdrożenia zmiany w wewnętrznych mikrousług może spowodować zmiany kodu na poziomie bramy interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6658a-259">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="6658a-260">Jednakże jeśli brama interfejsu API po prostu są stosowane zabezpieczenia, rejestrowanie i przechowywanie wersji (tak jak w przypadku korzystania z usługi Azure API Management), ten koszt dodatkowego programowania może nie mieć zastosowania.</span><span class="sxs-lookup"><span data-stu-id="6658a-260">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="6658a-261">Jeśli brama interfejsu API jest opracowany przez jeden zespół, może to być "wąskie gardło" rozwoju.</span><span class="sxs-lookup"><span data-stu-id="6658a-261">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="6658a-262">Jest to kolejny powód, dlaczego lepszym rozwiązaniem jest zapewnienie kilku karę szczegółowej bramy interfejsu API na potrzeby innego klienta.</span><span class="sxs-lookup"><span data-stu-id="6658a-262">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="6658a-263">Brama interfejsu API można również segregowanie wewnętrznie do wielu obszarów i warstwy, które należą do różnych zespołów nad wewnętrznego mikrousług.</span><span class="sxs-lookup"><span data-stu-id="6658a-263">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="6658a-264">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="6658a-264">Additional resources</span></span>

- <span data-ttu-id="6658a-265">**Charles Leonard. Wzorzec: Brama interfejsu API / zaplecza dla frontonu** \\</span><span class="sxs-lookup"><span data-stu-id="6658a-265">**Charles Richardson. Pattern: API Gateway / Backend for Front-End** \\</span></span>
  [*https://microservices.io/patterns/apigateway.html*](https://microservices.io/patterns/apigateway.html)

- <span data-ttu-id="6658a-266">**Wzorzec bramy interfejsu API** \\</span><span class="sxs-lookup"><span data-stu-id="6658a-266">**API Gateway pattern** \\</span></span>
  [*https://docs.microsoft.com/azure/architecture/microservices/gateway*](https://docs.microsoft.com/azure/architecture/microservices/gateway)

- <span data-ttu-id="6658a-267">**Wzorzec agregacji i kompozycji** \\</span><span class="sxs-lookup"><span data-stu-id="6658a-267">**Aggregation and composition pattern** \\</span></span>
  [*https://microservices.io/patterns/data/api-composition.html*](https://microservices.io/patterns/data/api-composition.html)

- <span data-ttu-id="6658a-268">**Usługa Azure API Management** \\</span><span class="sxs-lookup"><span data-stu-id="6658a-268">**Azure API Management** \\</span></span>
  [*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)

- <span data-ttu-id="6658a-269">**Udi Dahan. Kompozycja korzystający z usługi** \\</span><span class="sxs-lookup"><span data-stu-id="6658a-269">**Udi Dahan. Service Oriented Composition** \\</span></span>
  [*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)

- <span data-ttu-id="6658a-270">**Clemensa Vastersa. Obsługa komunikatów i Mikrousług w 2016 GOTO (wideo)** \\</span><span class="sxs-lookup"><span data-stu-id="6658a-270">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** \\</span></span>
  [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)

- <span data-ttu-id="6658a-271">**Brama interfejsu API w skrócie** (seria samouczków bramy interfejsu API platformy ASP.net Core) \\</span><span class="sxs-lookup"><span data-stu-id="6658a-271">**API Gateway in a Nutshell** (ASP.net Core API Gateway Tutorial Series) \\</span></span>
  [*https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html*](https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html)

>[!div class="step-by-step"]
<span data-ttu-id="6658a-272">[Poprzednie](identify-microservice-domain-model-boundaries.md)
[dalej](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="6658a-272">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>
