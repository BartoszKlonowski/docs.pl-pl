---
title: Projektowanie modelu domeny mikrousługi
description: Architektura Mikrousług .NET konteneryzowanych aplikacji .NET | Podczas projektowania modelu domeny zorientowanej na wzorzec DDD, należy zrozumieć kluczowe pojęcia.
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/08/2018
ms.openlocfilehash: 5c2ac880462851dd18735ced189b3641a759c8ca
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/23/2019
ms.locfileid: "61760964"
---
# <a name="design-a-microservice-domain-model"></a><span data-ttu-id="30910-103">Projektowanie modelu domeny mikrousługi</span><span class="sxs-lookup"><span data-stu-id="30910-103">Design a microservice domain model</span></span>

<span data-ttu-id="30910-104">*Zdefiniuj jeden model domeny sformatowanego dla poszczególnych mikrousług firmy lub ograniczone do kontekstu.*</span><span class="sxs-lookup"><span data-stu-id="30910-104">*Define one rich domain model for each business microservice or Bounded Context.*</span></span>

<span data-ttu-id="30910-105">Celem użytkownika jest, aby utworzyć model pojedynczej domeny spójny dla poszczególnych mikrousług biznesowych lub ograniczony kontekst (BC).</span><span class="sxs-lookup"><span data-stu-id="30910-105">Your goal is to create a single cohesive domain model for each business microservice or Bounded Context (BC).</span></span> <span data-ttu-id="30910-106">Należy pamiętać, jednak, że BC lub mikrousług firmy może czasami składać się z kilka fizycznych usług, które mają model domeny pojedynczej.</span><span class="sxs-lookup"><span data-stu-id="30910-106">Keep in mind, however, that a BC or business microservice could sometimes be composed of several physical services that share a single domain model.</span></span> <span data-ttu-id="30910-107">Model domeny konieczne jest przechwycenie reguły, zachowanie, język biznesowy i ograniczenia pojedynczego ograniczonego kontekstu lub mikrousług firmy, który reprezentuje.</span><span class="sxs-lookup"><span data-stu-id="30910-107">The domain model must capture the rules, behavior, business language, and constraints of the single Bounded Context or business microservice that it represents.</span></span>

## <a name="the-domain-entity-pattern"></a><span data-ttu-id="30910-108">Wzorzec jednostka domeny</span><span class="sxs-lookup"><span data-stu-id="30910-108">The Domain Entity pattern</span></span>

<span data-ttu-id="30910-109">Jednostki reprezentują obiektów domeny i są zdefiniowane głównie przez ich tożsamości, ciągłość działalności biznesowej i trwałości wraz z upływem czasu, a nie tylko przez atrybuty, które składają się z nimi.</span><span class="sxs-lookup"><span data-stu-id="30910-109">Entities represent domain objects and are primarily defined by their identity, continuity, and persistence over time, and not only by the attributes that comprise them.</span></span> <span data-ttu-id="30910-110">Jak wynika z Eric Evans, "obiektu zdefiniowane głównie przez jego tożsamość nosi nazwę jednostki."</span><span class="sxs-lookup"><span data-stu-id="30910-110">As Eric Evans says, “an object primarily defined by its identity is called an Entity.”</span></span> <span data-ttu-id="30910-111">Jednostki są bardzo ważna w modelu domeny, ponieważ są one base dla modelu.</span><span class="sxs-lookup"><span data-stu-id="30910-111">Entities are very important in the domain model, since they are the base for a model.</span></span> <span data-ttu-id="30910-112">W związku z tym należy zidentyfikować i je uważnie projektować.</span><span class="sxs-lookup"><span data-stu-id="30910-112">Therefore, you should identify and design them carefully.</span></span>

<span data-ttu-id="30910-113">*Tożsamość obiektu można krzyżowe w wielu mikrousługach lub ograniczonych kontekstów.*</span><span class="sxs-lookup"><span data-stu-id="30910-113">*An entity’s identity can cross multiple microservices or Bounded Contexts.*</span></span>

<span data-ttu-id="30910-114">Ta sama tożsamość (czyli takie same `Id` wartości, mimo że być może nie tej samej domeny jednostki) mogą być modelowane w wielu kontekstach ograniczonych lub mikrousług.</span><span class="sxs-lookup"><span data-stu-id="30910-114">The same identity (that is, the same `Id` value, although perhaps not the same domain entity) can be modeled across multiple Bounded Contexts or microservices.</span></span> <span data-ttu-id="30910-115">Jednakże, nie oznacza, że tej samej jednostki o tej samej logiki i atrybuty mogą być realizowane w wielu kontekstach ograniczonych.</span><span class="sxs-lookup"><span data-stu-id="30910-115">However, that does not imply that the same entity, with the same attributes and logic would be implemented in multiple Bounded Contexts.</span></span> <span data-ttu-id="30910-116">Zamiast tego jednostki w każdym kontekście ograniczonych ograniczyć ich atrybuty i zachowaniami służącymi do wymaganych w domenie ten ograniczony kontekst.</span><span class="sxs-lookup"><span data-stu-id="30910-116">Instead, entities in each Bounded Context limit their attributes and behaviors to those required in that Bounded Context’s domain.</span></span>

<span data-ttu-id="30910-117">Na przykład jednostki nabywcy może być najbardziej atrybutów osoby, które są zdefiniowane w jednostce użytkownika w profilu lub tożsamości mikrousług, włącznie z tożsamością.</span><span class="sxs-lookup"><span data-stu-id="30910-117">For instance, the buyer entity might have most of a person’s attributes that are defined in the user entity in the profile or identity microservice, including the identity.</span></span> <span data-ttu-id="30910-118">Ale jednostki nabywcy w mikrousługach szeregowania może być mniej atrybutów, ponieważ określone dane kupujący jest powiązany z procesu zamówień.</span><span class="sxs-lookup"><span data-stu-id="30910-118">But the buyer entity in the ordering microservice might have fewer attributes, because only certain buyer data is related to the order process.</span></span> <span data-ttu-id="30910-119">Kontekst poszczególne mikrousługi lub ograniczony kontekst ma wpływ na jej modelu domeny.</span><span class="sxs-lookup"><span data-stu-id="30910-119">The context of each microservice or Bounded Context impacts its domain model.</span></span>

<span data-ttu-id="30910-120">*Jednostki domeny musi implementować zachowanie oprócz Implementowanie atrybutów danych.*</span><span class="sxs-lookup"><span data-stu-id="30910-120">*Domain entities must implement behavior in addition to implementing data attributes.*</span></span>

<span data-ttu-id="30910-121">Jednostka domeny w DDD musi implementować logikę domeny lub zachowania związane z danymi jednostki (object, dostępne w pamięci).</span><span class="sxs-lookup"><span data-stu-id="30910-121">A domain entity in DDD must implement the domain logic or behavior related to the entity data (the object accessed in memory).</span></span> <span data-ttu-id="30910-122">Na przykład jako część klasy jednostki zamówienia konieczne jest posiadanie logiki biznesowej i operacje zaimplementowane jako metody dla zadań, takich jak dodawanie przedmiot zamówienia, sprawdzanie poprawności danych i obliczenia całkowitej.</span><span class="sxs-lookup"><span data-stu-id="30910-122">For example, as part of an order entity class you must have business logic and operations implemented as methods for tasks such as adding an order item, data validation, and total calculation.</span></span> <span data-ttu-id="30910-123">Metody jednostki zajmujemy się invariants i reguł, jednostki, zamiast tych zasad, rozkładają się na warstwie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="30910-123">The entity’s methods take care of the invariants and rules of the entity instead of having those rules spread across the application layer.</span></span>

<span data-ttu-id="30910-124">Rysunek 7-8 przedstawia jednostka domeny, który implementuje nie tylko atrybuty danych, ale operacje lub metody w logice domeny powiązane.</span><span class="sxs-lookup"><span data-stu-id="30910-124">Figure 7-8 shows a domain entity that implements not only data attributes but operations or methods with related domain logic.</span></span>

![Jednostki modelu domeny implementuje zachowania za pomocą metod, oznacza to, że nie jest modelem "anemic".](./media/image9.png)

<span data-ttu-id="30910-126">**Rysunek 7-8**.</span><span class="sxs-lookup"><span data-stu-id="30910-126">**Figure 7-8**.</span></span> <span data-ttu-id="30910-127">Przykładowy projekt jednostka domeny Implementowanie danych oraz zachowania</span><span class="sxs-lookup"><span data-stu-id="30910-127">Example of a domain entity design implementing data plus behavior</span></span>

<span data-ttu-id="30910-128">Oczywiście czasami może być jednostek, które implementuje żadnej logiki jako część klasy jednostki.</span><span class="sxs-lookup"><span data-stu-id="30910-128">Of course, sometimes you can have entities that do not implement any logic as part of the entity class.</span></span> <span data-ttu-id="30910-129">Przyczyną może być w jednostki podrzędne w ramach agregacji jednostce podrzędnej nie ma jakąkolwiek logikę specjalną, ponieważ większość logiki jest definiowana w głównym agregacji.</span><span class="sxs-lookup"><span data-stu-id="30910-129">This can happen in child entities within an aggregate if the child entity does not have any special logic because most of the logic is defined in the aggregate root.</span></span> <span data-ttu-id="30910-130">W przypadku złożonych mikrousług, zawierającego wiele logiki implementowane w klasach usługi zamiast w jednostkach domeny może być należących do modelu domeny anemic szczegółowo opisane w poniższej sekcji.</span><span class="sxs-lookup"><span data-stu-id="30910-130">If you have a complex microservice that has a lot of logic implemented in the service classes instead of in the domain entities, you could be falling into the anemic domain model, explained in the following section.</span></span>

### <a name="rich-domain-model-versus-anemic-domain-model"></a><span data-ttu-id="30910-131">Model domeny rozbudowane i model domeny anemic</span><span class="sxs-lookup"><span data-stu-id="30910-131">Rich domain model versus anemic domain model</span></span>

<span data-ttu-id="30910-132">W jego wpis [AnemicDomainModel](https://martinfowler.com/bliki/AnemicDomainModel.html), Martina Fowlera w tym artykule opisano model domeny anemic w ten sposób:</span><span class="sxs-lookup"><span data-stu-id="30910-132">In his post [AnemicDomainModel](https://martinfowler.com/bliki/AnemicDomainModel.html), Martin Fowler describes an anemic domain model this way:</span></span>

<span data-ttu-id="30910-133">Podstawowe objaw Anemic modelu domeny to, co najpierw blush wygląda czegoś.</span><span class="sxs-lookup"><span data-stu-id="30910-133">The basic symptom of an Anemic Domain Model is that at first blush it looks like the real thing.</span></span> <span data-ttu-id="30910-134">Istnieją obiekty, wiele nazwana rzeczowniki w obszarze domeny i te obiekty są połączone za pomocą zaawansowanych relacje i strukturę, która ma modeli domeny true.</span><span class="sxs-lookup"><span data-stu-id="30910-134">There are objects, many named after the nouns in the domain space, and these objects are connected with the rich relationships and structure that true domain models have.</span></span> <span data-ttu-id="30910-135">Catch jest dostarczany, Przyjrzyj się zachowanie, gdy okazuje się, że występuje niewiele wszelkich zachowań tych obiektów, dzięki czemu można je nieco więcej niż zbiory metod pobierających i ustawiających.</span><span class="sxs-lookup"><span data-stu-id="30910-135">The catch comes when you look at the behavior, and you realize that there is hardly any behavior on these objects, making them little more than bags of getters and setters.</span></span>

<span data-ttu-id="30910-136">Oczywiście, korzystając z modelu domeny anemic te modele danych będą używane w z zestawu obiektów usługi (tradycyjnie nazwane *warstwy biznesowej*) który Przechwyć wszystkie domeny lub logikę biznesową.</span><span class="sxs-lookup"><span data-stu-id="30910-136">Of course, when you use an anemic domain model, those data models will be used from a set of service objects (traditionally named the *business layer*) which capture all the domain or business logic.</span></span> <span data-ttu-id="30910-137">Warstwy biznesowej znajduje się na podstawie modelu danych i używa modelu danych, podobnie jak dane.</span><span class="sxs-lookup"><span data-stu-id="30910-137">The business layer sits on top of the data model and uses the data model just as data.</span></span>

<span data-ttu-id="30910-138">Model domeny anemic jest po prostu procedurach styl projektowania.</span><span class="sxs-lookup"><span data-stu-id="30910-138">The anemic domain model is just a procedural style design.</span></span> <span data-ttu-id="30910-139">Obiekty anemic jednostki nie są rzeczywistych obiektów, ponieważ mają zachowanie (metod).</span><span class="sxs-lookup"><span data-stu-id="30910-139">Anemic entity objects are not real objects because they lack behavior (methods).</span></span> <span data-ttu-id="30910-140">Mogą zawierać tylko właściwości danych i dlatego nie jest zorientowany na obiekt.</span><span class="sxs-lookup"><span data-stu-id="30910-140">They only hold data properties and thus it is not object-oriented design.</span></span> <span data-ttu-id="30910-141">Poprzez umieszczenie wszystkich zachowanie na zewnątrz w obiektach usługi (warstwy biznesowej) zasadniczo na końcu [kodu w postaci spaghetti](https://en.wikipedia.org/wiki/Spaghetti_code) lub [skrypty transakcji](https://martinfowler.com/eaaCatalog/transactionScript.html), i w związku z tym utracić zalety modelu domeny udostępnia.</span><span class="sxs-lookup"><span data-stu-id="30910-141">By putting all the behavior out into service objects (the business layer) you essentially end up with [spaghetti code](https://en.wikipedia.org/wiki/Spaghetti_code) or [transaction scripts](https://martinfowler.com/eaaCatalog/transactionScript.html), and therefore you lose the advantages that a domain model provides.</span></span>

<span data-ttu-id="30910-142">Niezależnie od tego, jeśli mikrousług lub ograniczony kontekst jest bardzo proste (CRUD usługi), model domeny anemic w formie obiektów jednostek przy użyciu tylko właściwości danych może być wystarczające i może nie być warte Implementowanie wzorców DDD bardziej złożone.</span><span class="sxs-lookup"><span data-stu-id="30910-142">Regardless, if your microservice or Bounded Context is very simple (a CRUD service), the anemic domain model in the form of entity objects with just data properties might be good enough, and it might not be worth implementing more complex DDD patterns.</span></span> <span data-ttu-id="30910-143">W takiej sytuacji będzie po prostu modelu trwałości, ponieważ zostały celowo utworzone jednostki danymi tylko do celów CRUD.</span><span class="sxs-lookup"><span data-stu-id="30910-143">In that case, it will be simply a persistence model, because you have intentionally created an entity with only data for CRUD purposes.</span></span>

<span data-ttu-id="30910-144">Właśnie dlatego architektur mikrousług są idealne dla wielu architektury podejście w zależności od każdego kontekstu ograniczonego.</span><span class="sxs-lookup"><span data-stu-id="30910-144">That is why microservices architectures are perfect for a multi-architectural approach depending on each Bounded Context.</span></span> <span data-ttu-id="30910-145">Na przykład w ramach aplikacji eShopOnContainers, szeregowania mikrousługa implementuje wzorców DDD, ale mikrousług katalogu, który jest prostą usługę CRUD, nie ma.</span><span class="sxs-lookup"><span data-stu-id="30910-145">For instance, in eShopOnContainers, the ordering microservice implements DDD patterns, but the catalog microservice, which is a simple CRUD service, does not.</span></span>

<span data-ttu-id="30910-146">Niektóre osoby powiedzieć o tym, że model domeny anemic jest zapobieganie wzorca.</span><span class="sxs-lookup"><span data-stu-id="30910-146">Some people say that the anemic domain model is an anti-pattern.</span></span> <span data-ttu-id="30910-147">Tak naprawdę zależy to implementacja.</span><span class="sxs-lookup"><span data-stu-id="30910-147">It really depends on what you are implementing.</span></span> <span data-ttu-id="30910-148">Jeśli mikrousług, tworzona jest prosty wystarczająco (na przykład usługa CRUD), zgodnie z modelu anemic domeny nie jest zapobieganie wzorca.</span><span class="sxs-lookup"><span data-stu-id="30910-148">If the microservice you are creating is simple enough (for example, a CRUD service), following the anemic domain model it is not an anti-pattern.</span></span> <span data-ttu-id="30910-149">Jednak jeśli zachodzi potrzeba czoła złożoności domeny mikrousług, która ma wiele kolejne zmiany reguł biznesowych, model domeny anemic może być zapobieganie wzorzec dla tego mikrousług lub ograniczone do kontekstu.</span><span class="sxs-lookup"><span data-stu-id="30910-149">However, if you need to tackle the complexity of a microservice’s domain that has a lot of ever-changing business rules, the anemic domain model might be an anti-pattern for that microservice or Bounded Context.</span></span> <span data-ttu-id="30910-150">W takim przypadku projektowania jako zaawansowane modelu przy użyciu jednostek zawierających dane, a także zachowanie, a także wdrażanie dodatkowych wzorców DDD (agregacje, obiekty wartości itp.) może być ogromne korzyści długoterminowe powodzenia takich mikrousług.</span><span class="sxs-lookup"><span data-stu-id="30910-150">In that case, designing it as a rich model with entities containing data plus behavior as well as implementing additional DDD patterns (aggregates, value objects, etc.) might have huge benefits for the long-term success of such a microservice.</span></span>

#### <a name="additional-resources"></a><span data-ttu-id="30910-151">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="30910-151">Additional resources</span></span>

- <span data-ttu-id="30910-152">**DevIQ. Jednostka domeny** \\</span><span class="sxs-lookup"><span data-stu-id="30910-152">**DevIQ. Domain Entity** \\</span></span>
  <https://deviq.com/entity/>

- <span data-ttu-id="30910-153">**Martin Fowler. Model domeny** \\</span><span class="sxs-lookup"><span data-stu-id="30910-153">**Martin Fowler. The Domain Model** \\</span></span>
  <https://martinfowler.com/eaaCatalog/domainModel.html>

- <span data-ttu-id="30910-154">**Martin Fowler. Model domeny Anemic** \\</span><span class="sxs-lookup"><span data-stu-id="30910-154">**Martin Fowler. The Anemic Domain Model** \\</span></span>
  <https://martinfowler.com/bliki/AnemicDomainModel.html>

### <a name="the-value-object-pattern"></a><span data-ttu-id="30910-155">Wzorzec wartość obiektu</span><span class="sxs-lookup"><span data-stu-id="30910-155">The Value Object pattern</span></span>

<span data-ttu-id="30910-156">Wspomniane Eric Evans ma "wiele obiektów ma koncepcyjny tożsamości.</span><span class="sxs-lookup"><span data-stu-id="30910-156">As Eric Evans has noted, “Many objects do not have conceptual identity.</span></span> <span data-ttu-id="30910-157">Te obiekty opisują określoną wspólną charakterystykę rzeczy."</span><span class="sxs-lookup"><span data-stu-id="30910-157">These objects describe certain characteristics of a thing.”</span></span>

<span data-ttu-id="30910-158">Jednostka wymaga tożsamości, ale istnieje wiele obiektów w systemie, które w przeciwnym razie, takich jak wzorzec obiektu wartości.</span><span class="sxs-lookup"><span data-stu-id="30910-158">An entity requires an identity, but there are many objects in a system that do not, like the Value Object pattern.</span></span> <span data-ttu-id="30910-159">Obiekt wartości jest obiekt z nie pojęciach tożsamości, która opisuje aspekt domeny.</span><span class="sxs-lookup"><span data-stu-id="30910-159">A value object is an object with no conceptual identity that describes a domain aspect.</span></span> <span data-ttu-id="30910-160">Są to obiekty, które wystąpienia do reprezentowania elementów projektu, które tylko dotyczą możesz tymczasowo.</span><span class="sxs-lookup"><span data-stu-id="30910-160">These are objects that you instantiate to represent design elements that only concern you temporarily.</span></span> <span data-ttu-id="30910-161">Interesujące Cię *co* , nie są *kto* są.</span><span class="sxs-lookup"><span data-stu-id="30910-161">You care about *what* they are, not *who* they are.</span></span> <span data-ttu-id="30910-162">Przykłady obejmują liczby i ciągi, ale można też koncepcji wyższego poziomu, takich jak grupy atrybutów.</span><span class="sxs-lookup"><span data-stu-id="30910-162">Examples include numbers and strings, but can also be higher-level concepts like groups of attributes.</span></span>

<span data-ttu-id="30910-163">Coś, co jest jednostką w mikrousługach może być jednostki w innym mikrousług, ponieważ w drugim przypadku ograniczony kontekst może mieć inne znaczenie.</span><span class="sxs-lookup"><span data-stu-id="30910-163">Something that is an entity in a microservice might not be an entity in another microservice, because in the second case, the Bounded Context might have a different meaning.</span></span> <span data-ttu-id="30910-164">Na przykład adres w aplikacji handlu elektronicznego utracić tożsamości, ponieważ może być reprezentowana grupy atrybutów profilu klienta dla osoby lub firmy.</span><span class="sxs-lookup"><span data-stu-id="30910-164">For example, an address in an e-commerce application might not have an identity at all, since it might only represent a group of attributes of the customer’s profile for a person or company.</span></span> <span data-ttu-id="30910-165">W takim przypadku adres powinny być klasyfikowane jako obiekt wartości.</span><span class="sxs-lookup"><span data-stu-id="30910-165">In this case, the address should be classified as a value object.</span></span> <span data-ttu-id="30910-166">Jednak w aplikacji prądu energii elektrycznej adres odbiorcy może być ważne dla domeny biznesowej.</span><span class="sxs-lookup"><span data-stu-id="30910-166">However, in an application for an electric power utility company, the customer address could be important for the business domain.</span></span> <span data-ttu-id="30910-167">Adres musi mieć tożsamości, więc systemów rozliczeniowych, które może być bezpośrednio połączony do adresu.</span><span class="sxs-lookup"><span data-stu-id="30910-167">Therefore, the address must have an identity so the billing system can be directly linked to the address.</span></span> <span data-ttu-id="30910-168">W takim przypadku adres powinny być klasyfikowane jako jednostka domeny.</span><span class="sxs-lookup"><span data-stu-id="30910-168">In that case, an address should be classified as a domain entity.</span></span>

<span data-ttu-id="30910-169">Osoba mająca imię i nazwisko, zwykle jest jednostką, ponieważ osoba ma tożsamości, nawet wtedy, gdy imię i nazwisko pokrywa się z innego zestawu wartości, np. Jeśli te nazwy odnosi się także do innej osobie.</span><span class="sxs-lookup"><span data-stu-id="30910-169">A person with a name and surname is usually an entity because a person has identity, even if the name and surname coincide with another set of values, such as if those names also refers to a different person.</span></span>

<span data-ttu-id="30910-170">Obiekty wartości są trudny do zarządzania relacyjnymi bazami danych i ORMs, takie jak EF, natomiast w dokumencie korzystający z bazy danych, które są łatwiejsze do wdrożenia i użycia.</span><span class="sxs-lookup"><span data-stu-id="30910-170">Value objects are hard to manage in relational databases and ORMs like EF, whereas in document oriented databases they are easier to implement and use.</span></span>

<span data-ttu-id="30910-171">EF Core 2.0 obejmuje [należące do jednostek](https://devblogs.microsoft.com/dotnet/announcing-entity-framework-core-2-0/#owned-entities-and-table-splitting) funkcja, która sprawia, że łatwiej obsługiwać obiekty wartości, jak opisano szczegółowo w dalszej.</span><span class="sxs-lookup"><span data-stu-id="30910-171">EF Core 2.0 includes the [Owned Entities](https://devblogs.microsoft.com/dotnet/announcing-entity-framework-core-2-0/#owned-entities-and-table-splitting) feature that makes it easier to handle value objects, as we’ll see in detail later on.</span></span>

#### <a name="additional-resources"></a><span data-ttu-id="30910-172">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="30910-172">Additional resources</span></span>

- <span data-ttu-id="30910-173">**Martin Fowler. Value — wzorzec obiektu** \\</span><span class="sxs-lookup"><span data-stu-id="30910-173">**Martin Fowler. Value Object pattern** \\</span></span>
  <https://martinfowler.com/bliki/ValueObject.html>

- <span data-ttu-id="30910-174">**Obiekt wartości** \\</span><span class="sxs-lookup"><span data-stu-id="30910-174">**Value Object** \\</span></span>
  <https://deviq.com/value-object/>

- <span data-ttu-id="30910-175">**Obiekty wartości w Test-Driven Development** \\</span><span class="sxs-lookup"><span data-stu-id="30910-175">**Value Objects in Test-Driven Development** \\</span></span>
  [https://leanpub.com/tdd-ebook/read\#leanpub-auto-value-objects](https://leanpub.com/tdd-ebook/read#leanpub-auto-value-objects)

- <span data-ttu-id="30910-176">**Eric Evans. Projektowania opartego na domenie: Co dzień do czynienia złożoności serce oprogramowania.**</span><span class="sxs-lookup"><span data-stu-id="30910-176">**Eric Evans. Domain-Driven Design: Tackling Complexity in the Heart of Software.**</span></span> <span data-ttu-id="30910-177">(Zarezerwuj; zawiera omówienie obiekty wartości) \\</span><span class="sxs-lookup"><span data-stu-id="30910-177">(Book; includes a discussion of value objects) \\</span></span>
  <https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215/>

### <a name="the-aggregate-pattern"></a><span data-ttu-id="30910-178">Wzorzec agregacji</span><span class="sxs-lookup"><span data-stu-id="30910-178">The Aggregate pattern</span></span>

<span data-ttu-id="30910-179">Model domeny zawiera klaster jednostek różne dane i procesy, które można kontrolować istotny obszar funkcje, takie jak realizacja zamówień lub magazynu.</span><span class="sxs-lookup"><span data-stu-id="30910-179">A domain model contains clusters of different data entities and processes that can control a significant area of functionality, such as order fulfillment or inventory.</span></span> <span data-ttu-id="30910-180">Do bardziej szczegółowych DDD jest funkcję agregacji, w tym artykule opisano klastra lub grupy jednostek i zachowań, które mogą być traktowane jako jednostka cohesive.</span><span class="sxs-lookup"><span data-stu-id="30910-180">A more fine-grained DDD unit is the aggregate, which describes a cluster or group of entities and behaviors that can be treated as a cohesive unit.</span></span>

<span data-ttu-id="30910-181">Zazwyczaj zdefiniujesz agregacją, w oparciu o transakcji, które są potrzebne.</span><span class="sxs-lookup"><span data-stu-id="30910-181">You usually define an aggregate based on the transactions that you need.</span></span> <span data-ttu-id="30910-182">Klasycznym przykładem jest zamówienie, zawierający listę elementów w kolejności.</span><span class="sxs-lookup"><span data-stu-id="30910-182">A classic example is an order that also contains a list of order items.</span></span> <span data-ttu-id="30910-183">Przedmiot zamówienia zwykle jest jednostką.</span><span class="sxs-lookup"><span data-stu-id="30910-183">An order item will usually be an entity.</span></span> <span data-ttu-id="30910-184">Ale będzie ona jednostce podrzędnej w agregacji kolejność, która będzie również zawierać jednostki zamówienia jego jednostkę główną, zwykle nazywane głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="30910-184">But it will be a child entity within the order aggregate, which will also contain the order entity as its root entity, typically called an aggregate root.</span></span>

<span data-ttu-id="30910-185">Identyfikowanie zagregowanych danych może okazać się trudne.</span><span class="sxs-lookup"><span data-stu-id="30910-185">Identifying aggregates can be hard.</span></span> <span data-ttu-id="30910-186">Wartość zagregowana jest grupy obiektów, które muszą być zgodne ze sobą, ale nie można po prostu wybierz grupę obiektów i nadaj im etykiety na wartość zagregowana.</span><span class="sxs-lookup"><span data-stu-id="30910-186">An aggregate is a group of objects that must be consistent together, but you cannot just pick a group of objects and label them an aggregate.</span></span> <span data-ttu-id="30910-187">Musi rozpoczynać się koncepcja domeny i myśleć o jednostek, które są używane w najbardziej typowych transakcje powiązane z związany z tą koncepcją.</span><span class="sxs-lookup"><span data-stu-id="30910-187">You must start with a domain concept and think about the entities that are used in the most common transactions related to that concept.</span></span> <span data-ttu-id="30910-188">Te jednostki, które muszą być transakcyjnie spójne to, co stanowi agregację.</span><span class="sxs-lookup"><span data-stu-id="30910-188">Those entities that need to be transactionally consistent are what forms an aggregate.</span></span> <span data-ttu-id="30910-189">Myśleć o operacji transakcji jest prawdopodobnie najlepszym sposobem identyfikacji agregacji.</span><span class="sxs-lookup"><span data-stu-id="30910-189">Thinking about transaction operations is probably the best way to identify aggregates.</span></span>

### <a name="the-aggregate-root-or-root-entity-pattern"></a><span data-ttu-id="30910-190">Wzorzec głównego agregacji lub jednostki głównej</span><span class="sxs-lookup"><span data-stu-id="30910-190">The Aggregate Root or Root Entity pattern</span></span>

<span data-ttu-id="30910-191">Wartość zagregowana składa się z co najmniej jedną jednostkę: głównego agregacji, nazywane również jednostki głównej lub podstawowej jednostki.</span><span class="sxs-lookup"><span data-stu-id="30910-191">An aggregate is composed of at least one entity: the aggregate root, also called root entity or primary entity.</span></span> <span data-ttu-id="30910-192">Ponadto może mieć wiele podrzędnych jednostek i obiektów wartości wszystkich jednostek i obiektów współpracując do zaimplementowania transakcji i wymagane zachowanie.</span><span class="sxs-lookup"><span data-stu-id="30910-192">Additionally, it can have multiple child entities and value objects, with all entities and objects working together to implement required behavior and transactions.</span></span>

<span data-ttu-id="30910-193">Główny agregacji ma na celu zapewnienie spójności agregacji; należy go tylko punkt wejścia dla aktualizacji do agregacji za pomocą metod lub operacji w całkowitym Klasa główna.</span><span class="sxs-lookup"><span data-stu-id="30910-193">The purpose of an aggregate root is to ensure the consistency of the aggregate; it should be the only entry point for updates to the aggregate through methods or operations in the aggregate root class.</span></span> <span data-ttu-id="30910-194">Należy wprowadzić zmiany do jednostki w ramach agregacji tylko przy użyciu głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="30910-194">You should make changes to entities within the aggregate only via the aggregate root.</span></span> <span data-ttu-id="30910-195">Jest ochrona spójności agregacji, biorąc pod uwagę wszystkie invariants i zasady spójności, może być potrzebnych do wykonania w swojej agregacji.</span><span class="sxs-lookup"><span data-stu-id="30910-195">It is the aggregate’s consistency guardian, considering all the invariants and consistency rules you might need to comply with in your aggregate.</span></span> <span data-ttu-id="30910-196">Jeśli zmienisz niezależnie jednostka lub wartość obiektu podrzędnego, głównego agregacji nie upewnij się, że agregacja w prawidłowym stanie.</span><span class="sxs-lookup"><span data-stu-id="30910-196">If you change a child entity or value object independently, the aggregate root cannot ensure that the aggregate is in a valid state.</span></span> <span data-ttu-id="30910-197">Jest podobna do tabeli za pomocą nie będzie gałęzi.</span><span class="sxs-lookup"><span data-stu-id="30910-197">It would be like a table with a loose leg.</span></span> <span data-ttu-id="30910-198">Związane z utrzymaniem spójności jest głównym celem głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="30910-198">Maintaining consistency is the main purpose of the aggregate root.</span></span>

<span data-ttu-id="30910-199">W rysunek 7 – 9 możesz zobaczyć agreguje próbki takich jak kupujący agregacji, która zawiera pojedynczą jednostkę (kupujący w katalogu głównym agregacji).</span><span class="sxs-lookup"><span data-stu-id="30910-199">In Figure 7-9, you can see sample aggregates like the buyer aggregate, which contains a single entity (the aggregate root Buyer).</span></span> <span data-ttu-id="30910-200">Agregacja kolejności zawiera wiele jednostek i wartość obiektu.</span><span class="sxs-lookup"><span data-stu-id="30910-200">The order aggregate contains multiple entities and a value object.</span></span>

![Model domeny DDD składa się z agregatów, agregacji mogą mieć tylko jedną jednostkę lub więcej i mogą obejmować także obiekty wartości.](./media/image10.png)

<span data-ttu-id="30910-202">**Rysunek 7 – 9**.</span><span class="sxs-lookup"><span data-stu-id="30910-202">**Figure 7-9**.</span></span> <span data-ttu-id="30910-203">Przykład wartości zagregowanych z wieloma lub pojedynczego jednostek</span><span class="sxs-lookup"><span data-stu-id="30910-203">Example of aggregates with multiple or single entities</span></span>

<span data-ttu-id="30910-204">Należy zauważyć, że agregacji kupujący może dodatkowe podrzędne jednostki, w zależności od domeny, co w szeregowania mikrousługi w ramach aplikacji eShopOnContainers aplikacji odwołanie.</span><span class="sxs-lookup"><span data-stu-id="30910-204">Note that the Buyer aggregate could have additional child entities, depending on your domain, as it does in the ordering microservice in the eShopOnContainers reference application.</span></span> <span data-ttu-id="30910-205">Rysunek 7 – 9 po prostu ilustruje przypadek, w którym kupujący ma pojedynczej jednostki, na przykład agregacji, która zawiera tylko głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="30910-205">Figure 7-9 just illustrates a case in which the buyer has a single entity, as an example of an aggregate that contains only an aggregate root.</span></span>

<span data-ttu-id="30910-206">Aby można było obsługiwać separację agregacji i zachować wyraźne granice między nimi, jest dobrym rozwiązaniem w modelu domeny DDD nie zezwala na bezpośrednie Nawigacja pomiędzy agregacje i posiadanie tylko pole klucza obcego (klucz OBCY), zgodnie z implementacją w [ Kolejność modelu domeny mikrousługi](https://github.com/dotnet-architecture/eShopOnContainers/blob/master/src/Services/Ordering/Ordering.Domain/AggregatesModel/OrderAggregate/Order.cs) w ramach aplikacji eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="30910-206">In order to maintain separation of aggregates and keep clear boundaries between them, it is a good practice in a DDD domain model to disallow direct navigation between aggregates and only having the foreign key (FK) field, as implemented in the [Ordering microservice domain model](https://github.com/dotnet-architecture/eShopOnContainers/blob/master/src/Services/Ordering/Ordering.Domain/AggregatesModel/OrderAggregate/Order.cs) in eShopOnContainers.</span></span> <span data-ttu-id="30910-207">Jednostki zamówienia ma tylko pole klucza Obcego kupujący, ale nie do programu EF Core nawigacji właściwości, jak pokazano w poniższym kodzie:</span><span class="sxs-lookup"><span data-stu-id="30910-207">The Order entity only has a FK field for the buyer, but not an EF Core navigation property, as shown in the following code:</span></span>

```csharp
public class Order : Entity, IAggregateRoot
{
    private DateTime _orderDate;
    public Address Address { get; private set; }
    private int? _buyerId; //FK pointing to a different aggregate root
    public OrderStatus OrderStatus { get; private set; }
    private readonly List<OrderItem> _orderItems;
    public IReadOnlyCollection<OrderItem> OrderItems => _orderItems;
    // ... Additional code
}
```

<span data-ttu-id="30910-208">Identyfikowanie i Praca z agregacjami wymaga badania i doświadczenie.</span><span class="sxs-lookup"><span data-stu-id="30910-208">Identifying and working with aggregates requires research and experience.</span></span> <span data-ttu-id="30910-209">Aby uzyskać więcej informacji przejrzyj następującą listę dodatkowych zasobów.</span><span class="sxs-lookup"><span data-stu-id="30910-209">For more information, see the following Additional resources list.</span></span>

#### <a name="additional-resources"></a><span data-ttu-id="30910-210">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="30910-210">Additional resources</span></span>

- <span data-ttu-id="30910-211">**Vaughn Vernon. Efektywnym projektowaniu agregacji - Part I: Modelowanie jednej wartości zagregowanej** (z <http://dddcommunity.org/>) \\</span><span class="sxs-lookup"><span data-stu-id="30910-211">**Vaughn Vernon. Effective Aggregate Design - Part I: Modeling a Single Aggregate** (from <http://dddcommunity.org/>) \\</span></span>
  <http://dddcommunity.org/wp-content/uploads/files/pdf_articles/Vernon_2011_1.pdf>

- <span data-ttu-id="30910-212">**Vaughn Vernon. Skuteczne agregacji projektu — część II: Podejmowanie agreguje pracy ze sobą** (z <http://dddcommunity.org/>) \\</span><span class="sxs-lookup"><span data-stu-id="30910-212">**Vaughn Vernon. Effective Aggregate Design - Part II: Making Aggregates Work Together** (from <http://dddcommunity.org/>) \\</span></span>
  <http://dddcommunity.org/wp-content/uploads/files/pdf_articles/Vernon_2011_2.pdf>

- <span data-ttu-id="30910-213">**Vaughn Vernon. Skuteczne agregacji projektu — część III: Uzyskiwanie wglądu w ramach odnajdywania** (z <http://dddcommunity.org/>) \\</span><span class="sxs-lookup"><span data-stu-id="30910-213">**Vaughn Vernon. Effective Aggregate Design - Part III: Gaining Insight Through Discovery** (from <http://dddcommunity.org/>) \\</span></span>
  <http://dddcommunity.org/wp-content/uploads/files/pdf_articles/Vernon_2011_3.pdf>

- <span data-ttu-id="30910-214">**Sergey Grybniak. Wzorce projektowe taktyczne DDD** \\</span><span class="sxs-lookup"><span data-stu-id="30910-214">**Sergey Grybniak. DDD Tactical Design Patterns** \\</span></span>
  <https://www.codeproject.com/Articles/1164363/Domain-Driven-Design-Tactical-Design-Patterns-Part>

- <span data-ttu-id="30910-215">**Chris Richardson. Tworzenie transakcji Mikrousług przy użyciu wartości zagregowanych** \\</span><span class="sxs-lookup"><span data-stu-id="30910-215">**Chris Richardson. Developing Transactional Microservices Using Aggregates** \\</span></span>
  <https://www.infoq.com/articles/microservices-aggregates-events-cqrs-part-1-richardson>

- <span data-ttu-id="30910-216">**DevIQ. Wzorzec agregacji** \\</span><span class="sxs-lookup"><span data-stu-id="30910-216">**DevIQ. The Aggregate pattern** \\</span></span>
  <https://deviq.com/aggregate-pattern/>

>[!div class="step-by-step"]
><span data-ttu-id="30910-217">[Poprzednie](ddd-oriented-microservice.md)
>[dalej](net-core-microservice-domain-model.md)</span><span class="sxs-lookup"><span data-stu-id="30910-217">[Previous](ddd-oriented-microservice.md)
[Next](net-core-microservice-domain-model.md)</span></span>
