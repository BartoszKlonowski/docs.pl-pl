---
title: Projektowanie modelu domeny mikrousługi
description: Architektura Mikrousług .NET dla aplikacji .NET konteneryzowanych | Projektowanie modelu domeny mikrousługi
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 11/09/2017
ms.openlocfilehash: 2776412b96d4ed141f48814d19d2deaa1a71520d
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
---
# <a name="designing-a-microservice-domain-model"></a><span data-ttu-id="52723-103">Projektowanie modelu domeny mikrousługi</span><span class="sxs-lookup"><span data-stu-id="52723-103">Designing a microservice domain model</span></span>

<span data-ttu-id="52723-104">*Zdefiniuj jeden model domeny sformatowanego dla każdego mikrousługi biznesowych lub ograniczonych kontekstu*</span><span class="sxs-lookup"><span data-stu-id="52723-104">*Define one rich domain model for each business microservice or Bounded Context*</span></span>

<span data-ttu-id="52723-105">Celem użytkownika jest utworzyć model pojedynczej domeny spójności dla każdej mikrousługi biznesowych lub ograniczonych kontekstu (BC).</span><span class="sxs-lookup"><span data-stu-id="52723-105">Your goal is to create a single cohesive domain model for each business microservice or Bounded Context (BC).</span></span> <span data-ttu-id="52723-106">Należy pamiętać, mimo że BC lub business mikrousługi czasami może składają się z kilka fizycznych usług mających modelu pojedynczej domeny.</span><span class="sxs-lookup"><span data-stu-id="52723-106">Keep in mind, however, that a BC or business microservice could sometimes be composed of several physical services that share a single domain model.</span></span> <span data-ttu-id="52723-107">Model domeny konieczne jest przechwycenie reguł, zachowanie, języka biznesowych i ograniczenia w pojedynczym kontekście ograniczony lub mikrousługi biznesowych, który reprezentuje.</span><span class="sxs-lookup"><span data-stu-id="52723-107">The domain model must capture the rules, behavior, business language, and constraints of the single Bounded Context or business microservice that it represents.</span></span>

## <a name="the-domain-entity-pattern"></a><span data-ttu-id="52723-108">Wzorzec jednostką domeny</span><span class="sxs-lookup"><span data-stu-id="52723-108">The Domain Entity pattern</span></span>

<span data-ttu-id="52723-109">Jednostki reprezentują obiektów domeny i są zdefiniowane głównie przez ich tożsamość, ciągłość działania i trwałości wraz z upływem czasu i nie tylko atrybuty, które obejmują je.</span><span class="sxs-lookup"><span data-stu-id="52723-109">Entities represent domain objects and are primarily defined by their identity, continuity, and persistence over time, and not only by the attributes that comprise them.</span></span> <span data-ttu-id="52723-110">Jak Evans marek jest wyświetlany komunikat "obiekt zdefiniowane głównie przez jego tożsamość jest nazywany jednostką."</span><span class="sxs-lookup"><span data-stu-id="52723-110">As Eric Evans says, “an object primarily defined by its identity is called an Entity.”</span></span> <span data-ttu-id="52723-111">Jednostki są bardzo ważne w modelu domeny, ponieważ są one base dla modelu.</span><span class="sxs-lookup"><span data-stu-id="52723-111">Entities are very important in the domain model, since they are the base for a model.</span></span> <span data-ttu-id="52723-112">W związku z tym należy zidentyfikować i zaprojektować je dokładnie.</span><span class="sxs-lookup"><span data-stu-id="52723-112">Therefore, you should identify and design them carefully.</span></span>

<span data-ttu-id="52723-113">*Tożsamość jednostki mogą przechodzić wielu mikrousług lub kontekstów ograniczone.*</span><span class="sxs-lookup"><span data-stu-id="52723-113">*An entity’s identity can cross multiple microservices or Bounded Contexts.*</span></span>

<span data-ttu-id="52723-114">Tej samej tożsamości (choć nie tego samego obiektu) należy modelować wielu kontekstów ograniczony lub mikrousług.</span><span class="sxs-lookup"><span data-stu-id="52723-114">The same identity (though not the same entity) can be modeled across multiple Bounded Contexts or microservices.</span></span> <span data-ttu-id="52723-115">Która nie oznacza, że tej samej jednostki o tej samej logiki i atrybuty są realizowane w wielu sytuacjach ograniczone.</span><span class="sxs-lookup"><span data-stu-id="52723-115">However, that does not imply that the same entity, with the same attributes and logic would be implemented in multiple Bounded Contexts.</span></span> <span data-ttu-id="52723-116">Zamiast tego jednostek w kontekście każdego ograniczone ograniczyć ich atrybuty i zachowania do wymaganych w tym ograniczone kontekście domeny.</span><span class="sxs-lookup"><span data-stu-id="52723-116">Instead, entities in each Bounded Context limit their attributes and behaviors to those required in that Bounded Context’s domain.</span></span>

<span data-ttu-id="52723-117">Na przykład jednostki nabywcy może być najbardziej atrybutów osoby, które są zdefiniowane w jednostce użytkownika w profilu lub tożsamości mikrousługi, włącznie z tożsamością.</span><span class="sxs-lookup"><span data-stu-id="52723-117">For instance, the buyer entity might have most of a person’s attributes that are defined in the user entity in the profile or identity microservice, including the identity.</span></span> <span data-ttu-id="52723-118">Jednak obiektu nabywców porządkowania mikrousługi może być mniej atrybutów, ponieważ niektóre dane nabywców jest związane z procesem kolejności.</span><span class="sxs-lookup"><span data-stu-id="52723-118">But the buyer entity in the ordering microservice might have fewer attributes, because only certain buyer data is related to the order process.</span></span> <span data-ttu-id="52723-119">Kontekst każdego mikrousługi lub ograniczonych kontekstu ma wpływ na jego modelu domeny.</span><span class="sxs-lookup"><span data-stu-id="52723-119">The context of each microservice or Bounded Context impacts its domain model.</span></span>

<span data-ttu-id="52723-120">*Domeny jednostek musi implementować zachowanie oprócz atrybuty danych wykonawczych*</span><span class="sxs-lookup"><span data-stu-id="52723-120">*Domain entities must implement behavior in addition to implementing data attributes*</span></span>

<span data-ttu-id="52723-121">Jednostka w domenie w DDD musi implementować logika domeny lub zachowanie związane z danymi jednostki (obiekt dostęp do pamięci).</span><span class="sxs-lookup"><span data-stu-id="52723-121">A domain entity in DDD must implement the domain logic or behavior related to the entity data (the object accessed in memory).</span></span> <span data-ttu-id="52723-122">Na przykład w ramach klasy jednostki kolejności musi mieć logiki biznesowej i operacje zaimplementowane jako metody dla zadań, takich jak dodawanie elementu kolejności, sprawdzanie poprawności danych i obliczenie razem.</span><span class="sxs-lookup"><span data-stu-id="52723-122">For example, as part of an order entity class you must have business logic and operations implemented as methods for tasks such as adding an order item, data validation, and total calculation.</span></span> <span data-ttu-id="52723-123">Metody jednostki zajmie się invariants i reguł jednostki zamiast te reguły rozłożyć na warstwie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="52723-123">The entity’s methods take care of the invariants and rules of the entity instead of having those rules spread across the application layer.</span></span>

<span data-ttu-id="52723-124">Rysunek 9-8 zawiera jednostki domeny, która implementuje nie tylko atrybuty danych, ale metod lub operacji z logiką pokrewne domeny.</span><span class="sxs-lookup"><span data-stu-id="52723-124">Figure 9-8 shows a domain entity that implements not only data attributes but operations or methods with related domain logic.</span></span>

![](./media/image9.png)

<span data-ttu-id="52723-125">**Rysunek 9 — 8**.</span><span class="sxs-lookup"><span data-stu-id="52723-125">**Figure 9-8**.</span></span> <span data-ttu-id="52723-126">Przykład projektu jednostki domeny Implementowanie danych oraz zachowanie</span><span class="sxs-lookup"><span data-stu-id="52723-126">Example of a domain entity design implementing data plus behavior</span></span>

<span data-ttu-id="52723-127">Oczywiście czasami może być jednostek, które nie implementują wszelka logika jako część klasy jednostka.</span><span class="sxs-lookup"><span data-stu-id="52723-127">Of course, sometimes you can have entities that do not implement any logic as part of the entity class.</span></span> <span data-ttu-id="52723-128">Może to nastąpić w obiektów podrzędnych w agregacji, jeśli obiekt podrzędny nie ma żadnych specjalnych logiki, ponieważ większość logiki jest zdefiniowana w katalogu głównym łączny.</span><span class="sxs-lookup"><span data-stu-id="52723-128">This can happen in child entities within an aggregate if the child entity does not have any special logic because most of the logic is defined in the aggregate root.</span></span> <span data-ttu-id="52723-129">Jeśli masz mikrousługi złożonych, ma dużo logiki zaimplementowana w klasach usługi zamiast w jednostkach domeny może być należących do modelu domeny anemic wyjaśniono w poniższej sekcji.</span><span class="sxs-lookup"><span data-stu-id="52723-129">If you have a complex microservice that has a lot of logic implemented in the service classes instead of in the domain entities, you could be falling into the anemic domain model, explained in the following section.</span></span>

### <a name="rich-domain-model-versus-anemic-domain-model"></a><span data-ttu-id="52723-130">Model domeny sformatowany i model domeny anemic</span><span class="sxs-lookup"><span data-stu-id="52723-130">Rich domain model versus anemic domain model</span></span>

<span data-ttu-id="52723-131">W jego post [AnemicDomainModel](https://martinfowler.com/bliki/AnemicDomainModel.html), Fowler pole w tym artykule opisano model domeny anemic w ten sposób:</span><span class="sxs-lookup"><span data-stu-id="52723-131">In his post [AnemicDomainModel](https://martinfowler.com/bliki/AnemicDomainModel.html), Martin Fowler describes an anemic domain model this way:</span></span>

<span data-ttu-id="52723-132">Podstawowe objawem Anemic Model domeny jest najpierw co blush wygląda czegoś.</span><span class="sxs-lookup"><span data-stu-id="52723-132">The basic symptom of an Anemic Domain Model is that at first blush it looks like the real thing.</span></span> <span data-ttu-id="52723-133">Istnieją obiekty o nazwie wiele po rzeczowniki w obszarze domeny i te obiekty są połączone z zaawansowanych relacje i struktura, która ma modeli domeny wartość true.</span><span class="sxs-lookup"><span data-stu-id="52723-133">There are objects, many named after the nouns in the domain space, and these objects are connected with the rich relationships and structure that true domain models have.</span></span> <span data-ttu-id="52723-134">Catch zaczyna się po wyświetleniu zachowania i okazuje się, że tych obiektów, jest bardzo trudno żadnych zachowanie nadawania nieco więcej niż torebki o metodach ustawiających i pobierających.</span><span class="sxs-lookup"><span data-stu-id="52723-134">The catch comes when you look at the behavior, and you realize that there is hardly any behavior on these objects, making them little more than bags of getters and setters.</span></span>

<span data-ttu-id="52723-135">Oczywiście, gdy używasz modelu domeny anemic tych modeli danych będą używane w z zestawu obiektów usługi (tradycyjnie nazwane *warstwie business*) który Przechwyć wszystkie domeny lub logikę biznesową.</span><span class="sxs-lookup"><span data-stu-id="52723-135">Of course, when you use an anemic domain model, those data models will be used from a set of service objects (traditionally named the *business layer*) which capture all the domain or business logic.</span></span> <span data-ttu-id="52723-136">Warstwa biznesowa znajduje się w modelu danych i używa modelu danych tylko jako dane.</span><span class="sxs-lookup"><span data-stu-id="52723-136">The business layer sits on top of the data model and uses the data model just as data.</span></span>

<span data-ttu-id="52723-137">Model domeny anemic to po prostu projekt styl procedurach.</span><span class="sxs-lookup"><span data-stu-id="52723-137">The anemic domain model is just a procedural style design.</span></span> <span data-ttu-id="52723-138">Obiekty anemic obiektów nie są prawdziwe obiektów, ponieważ mają zachowanie (metody).</span><span class="sxs-lookup"><span data-stu-id="52723-138">Anemic entity objects are not real objects because they lack behavior (methods).</span></span> <span data-ttu-id="52723-139">Posiadają tylko właściwości danych i dlatego nie jest zorientowany obiektowo projektu.</span><span class="sxs-lookup"><span data-stu-id="52723-139">They only hold data properties and thus it is not object-oriented design.</span></span> <span data-ttu-id="52723-140">Ustawiając limit to zachowanie na obiekty usługi (warstwie business) zasadniczo na końcu [kod postaci spaghetti](https://en.wikipedia.org/wiki/Spaghetti_code) lub [skryptów transakcji](https://martinfowler.com/eaaCatalog/transactionScript.html), i w związku z tym utracić zalety modelu domeny udostępnia.</span><span class="sxs-lookup"><span data-stu-id="52723-140">By putting all the behavior out into service objects (the business layer) you essentially end up with [spaghetti code](https://en.wikipedia.org/wiki/Spaghetti_code) or [transaction scripts](https://martinfowler.com/eaaCatalog/transactionScript.html), and therefore you lose the advantages that a domain model provides.</span></span>

<span data-ttu-id="52723-141">Niezależnie od tego, jeśli mikrousługi lub ograniczonych kontekstu jest bardzo proste (CRUD usługa), modelu domeny anemic w formie obiektów jednostek z tylko właściwości danych może być wystarczająca i nie może być warto Implementowanie bardziej złożonych wzorców DDD.</span><span class="sxs-lookup"><span data-stu-id="52723-141">Regardless, if your microservice or Bounded Context is very simple (a CRUD service), the anemic domain model in the form of entity objects with just data properties might be good enough, and it might not be worth implementing more complex DDD patterns.</span></span> <span data-ttu-id="52723-142">W takim przypadku będzie po prostu modelu trwałości, ponieważ utworzono celowo jednostki z danych tylko do celów CRUD.</span><span class="sxs-lookup"><span data-stu-id="52723-142">In that case, it will be simply a persistence model, because you have intentionally created an entity with only data for CRUD purposes.</span></span>

<span data-ttu-id="52723-143">Właśnie dlatego architektury mikrousług są idealne w przypadku wielu architektura w zależności od kontekstu każdego ograniczone.</span><span class="sxs-lookup"><span data-stu-id="52723-143">That is why microservices architectures are perfect for a multi-architectural approach depending on each Bounded Context.</span></span> <span data-ttu-id="52723-144">Na przykład w eShopOnContainers, porządkowania mikrousługi implementuje wzorce DDD, ale mikrousługi katalogu, co jest proste usługi CRUD, nie ma.</span><span class="sxs-lookup"><span data-stu-id="52723-144">For instance, in eShopOnContainers, the ordering microservice implements DDD patterns, but the catalog microservice, which is a simple CRUD service, does not.</span></span>

<span data-ttu-id="52723-145">Niektórzy użytkownicy powiedzieć, że model anemic domeny jest uruchomiony wzorca.</span><span class="sxs-lookup"><span data-stu-id="52723-145">Some people say that the anemic domain model is an anti-pattern.</span></span> <span data-ttu-id="52723-146">Naprawdę zależy to implementacja.</span><span class="sxs-lookup"><span data-stu-id="52723-146">It really depends on what you are implementing.</span></span> <span data-ttu-id="52723-147">Jeśli mikrousługi tworzona jest prosty wystarczająco (na przykład usługa CRUD), po modelu anemic domeny nie jest uruchomiony wzorca.</span><span class="sxs-lookup"><span data-stu-id="52723-147">If the microservice you are creating is simple enough (for example, a CRUD service), following the anemic domain model it is not an anti-pattern.</span></span> <span data-ttu-id="52723-148">Jednak jeśli zachodzi potrzeba rozwiązania złożoność mikrousługi domeny, która ma wiele kiedykolwiek zmiana reguł biznesowych, model anemic domeny może być układ wzorca dla tego mikrousługi lub ograniczonych kontekstu.</span><span class="sxs-lookup"><span data-stu-id="52723-148">However, if you need to tackle the complexity of a microservice’s domain that has a lot of ever-changing business rules, the anemic domain model might be an anti-pattern for that microservice or Bounded Context.</span></span> <span data-ttu-id="52723-149">W takim przypadku projektowania jako wzbogaconej modelu za pomocą jednostek zawierających dane plus zachowanie, a także wykonania dodatkowych wzorce DDD (agregacje, obiekty wartości itp.) może być ogromnych korzyści długoterminowe Powodzenie takich mikrousługi.</span><span class="sxs-lookup"><span data-stu-id="52723-149">In that case, designing it as a rich model with entities containing data plus behavior as well as implementing additional DDD patterns (aggregates, value objects, etc.) might have huge benefits for the long-term success of such a microservice.</span></span>

#### <a name="additional-resources"></a><span data-ttu-id="52723-150">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="52723-150">Additional resources</span></span>

-   <span data-ttu-id="52723-151">**DevIQ. Domain Entity**
    [*http://deviq.com/entity/*](http://deviq.com/entity/)</span><span class="sxs-lookup"><span data-stu-id="52723-151">**DevIQ. Domain Entity**
[*http://deviq.com/entity/*](http://deviq.com/entity/)</span></span>

-   <span data-ttu-id="52723-152">**Pole Fowler. Model domeny**
    [*https://martinfowler.com/eaaCatalog/domainModel.html*](https://martinfowler.com/eaaCatalog/domainModel.html)</span><span class="sxs-lookup"><span data-stu-id="52723-152">**Martin Fowler. The Domain Model**
[*https://martinfowler.com/eaaCatalog/domainModel.html*](https://martinfowler.com/eaaCatalog/domainModel.html)</span></span>

-   <span data-ttu-id="52723-153">**Pole Fowler. Model domeny Anemic**</span><span class="sxs-lookup"><span data-stu-id="52723-153">**Martin Fowler. The Anemic Domain Model**</span></span>

    <https://martinfowler.com/bliki/AnemicDomainModel.html>

### <a name="the-value-object-pattern"></a><span data-ttu-id="52723-154">Wzorzec obiektu wartości</span><span class="sxs-lookup"><span data-stu-id="52723-154">The Value Object pattern</span></span>

<span data-ttu-id="52723-155">Wspomnianego Evans marek ma "wiele obiektów nie miały koncepcyjnej tożsamości.</span><span class="sxs-lookup"><span data-stu-id="52723-155">As Eric Evans has noted, “Many objects do not have conceptual identity.</span></span> <span data-ttu-id="52723-156">Te obiekty opisują niektórych parametrów przedmiotu".</span><span class="sxs-lookup"><span data-stu-id="52723-156">These objects describe certain characteristics of a thing.”</span></span>

<span data-ttu-id="52723-157">Jednostka wymaga tożsamości, ale w systemie, która nie istnieje wiele obiektów, takich jak wzorzec obiektu wartości.</span><span class="sxs-lookup"><span data-stu-id="52723-157">An entity requires an identity, but there are many objects in a system that do not, like the Value Object pattern.</span></span> <span data-ttu-id="52723-158">Obiekt wartości jest obiektem przy nie koncepcyjnej tożsamości, która opisuje aspekt domeny.</span><span class="sxs-lookup"><span data-stu-id="52723-158">A value object is an object with no conceptual identity that describes a domain aspect.</span></span> <span data-ttu-id="52723-159">Są to obiekty, które można utworzyć wystąpienia do reprezentowania elementów projektu, które tylko dotyczą możesz tymczasowo.</span><span class="sxs-lookup"><span data-stu-id="52723-159">These are objects that you instantiate to represent design elements that only concern you temporarily.</span></span> <span data-ttu-id="52723-160">Najważniejsze informacje dotyczące *co* , nie są *kto* są.</span><span class="sxs-lookup"><span data-stu-id="52723-160">You care about *what* they are, not *who* they are.</span></span> <span data-ttu-id="52723-161">Przykłady obejmują liczb i ciągów, ale można też pojęcia wyższego poziomu, takich jak grupy atrybutów.</span><span class="sxs-lookup"><span data-stu-id="52723-161">Examples include numbers and strings, but can also be higher-level concepts like groups of attributes.</span></span>

<span data-ttu-id="52723-162">Coś, co jest jednostką w mikrousługi może nie być jednostki w innym mikrousługi, ponieważ w drugim przypadku kontekstu ograniczone może mieć inne znaczenie.</span><span class="sxs-lookup"><span data-stu-id="52723-162">Something that is an entity in a microservice might not be an entity in another microservice, because in the second case, the Bounded Context might have a different meaning.</span></span> <span data-ttu-id="52723-163">Na przykład adres w aplikacji handlu elektronicznego może nie mieć tożsamości, ponieważ może stanowić jedynie grupy atrybutów profilu klienta dla osoby lub firmy.</span><span class="sxs-lookup"><span data-stu-id="52723-163">For example, an address in an e-commerce application might not have an identity at all, since it might only represent a group of attributes of the customer’s profile for a person or company.</span></span> <span data-ttu-id="52723-164">W takim przypadku adres powinny być klasyfikowane jako obiekt wartości.</span><span class="sxs-lookup"><span data-stu-id="52723-164">In this case, the address should be classified as a value object.</span></span> <span data-ttu-id="52723-165">Jednak w aplikacji firmy narzędzie energii elektrycznej adres odbiorcy może być ważne dla domeny biznesowych.</span><span class="sxs-lookup"><span data-stu-id="52723-165">However, in an application for an electric power utility company, the customer address could be important for the business domain.</span></span> <span data-ttu-id="52723-166">Adres musi mieć tożsamość, więc systemów rozliczeniowych może być bezpośrednio połączony adres.</span><span class="sxs-lookup"><span data-stu-id="52723-166">Therefore, the address must have an identity so the billing system can be directly linked to the address.</span></span> <span data-ttu-id="52723-167">W takim przypadku adres powinny być klasyfikowane jako jednostką domeny.</span><span class="sxs-lookup"><span data-stu-id="52723-167">In that case, an address should be classified as a domain entity.</span></span>

<span data-ttu-id="52723-168">Osoba mająca imię i nazwisko jest zwykle jednostki osoba ma tożsamość, nawet jeśli imię i nazwisko pokrywa się z innego zestawu wartości, np. Jeśli te nazwy odnosi się także do innej osoby.</span><span class="sxs-lookup"><span data-stu-id="52723-168">A person with a name and surname is usually an entity because a person has identity, even if the name and surname coincide with another set of values, such as if those names also refers to a different person.</span></span>

<span data-ttu-id="52723-169">Obiekty wartości są trudne do zarządzania relacyjnymi bazami danych i ORMs, takie jak EF, natomiast w dokumencie ukierunkowane bazy danych, które są łatwiejsze do zaimplementowania i użycia.</span><span class="sxs-lookup"><span data-stu-id="52723-169">Value objects are hard to manage in relational databases and ORMs like EF, whereas in document oriented databases they are easier to implement and use.</span></span>

#### <a name="additional-resources"></a><span data-ttu-id="52723-170">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="52723-170">Additional resources</span></span>

-   <span data-ttu-id="52723-171">**Pole Fowler. Value — wzorzec obiektu**
    [*https://martinfowler.com/bliki/ValueObject.html*](https://martinfowler.com/bliki/ValueObject.html)</span><span class="sxs-lookup"><span data-stu-id="52723-171">**Martin Fowler. Value Object pattern**
[*https://martinfowler.com/bliki/ValueObject.html*](https://martinfowler.com/bliki/ValueObject.html)</span></span>

-   <span data-ttu-id="52723-172">**Wartość obiektu**
    [*http://deviq.com/value-object/*](http://deviq.com/value-object/)</span><span class="sxs-lookup"><span data-stu-id="52723-172">**Value Object**
[*http://deviq.com/value-object/*](http://deviq.com/value-object/)</span></span>

-   <span data-ttu-id="52723-173">**Wartości obiektów w rozwoju Test-Driven**
    [*https://leanpub.com/tdd-ebook/read\#leanpub-auto wartość — obiekty*](https://leanpub.com/tdd-ebook/read#leanpub-auto-value-objects)</span><span class="sxs-lookup"><span data-stu-id="52723-173">**Value Objects in Test-Driven Development**
[*https://leanpub.com/tdd-ebook/read\#leanpub-auto-value-objects*](https://leanpub.com/tdd-ebook/read#leanpub-auto-value-objects)</span></span>

-   <span data-ttu-id="52723-174">**Evans marek. Projektowanie oparte na domenie: Czoła złożoności serca oprogramowania.**</span><span class="sxs-lookup"><span data-stu-id="52723-174">**Eric Evans. Domain-Driven Design: Tackling Complexity in the Heart of Software.**</span></span> <span data-ttu-id="52723-175">(Książki; zawiera omówienie obiekty wartości) [*https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215/*](https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215/)</span><span class="sxs-lookup"><span data-stu-id="52723-175">(Book; includes a discussion of value objects) [*https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215/*](https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215/)</span></span>

### <a name="the-aggregate-pattern"></a><span data-ttu-id="52723-176">Wzorzec agregacji</span><span class="sxs-lookup"><span data-stu-id="52723-176">The Aggregate pattern</span></span>

<span data-ttu-id="52723-177">Model domeny zawiera klaster jednostek inne dane i procesy, które można kontrolować istotny obszar funkcje, takie jak realizacji order lub magazynu.</span><span class="sxs-lookup"><span data-stu-id="52723-177">A domain model contains clusters of different data entities and processes that can control a significant area of functionality, such as order fulfilment or inventory.</span></span> <span data-ttu-id="52723-178">Do bardziej szczegółowych DDD jest agregacji, opisujący klastra lub grupy jednostek i zachowania, które mogą być traktowane jako jednostka spójności.</span><span class="sxs-lookup"><span data-stu-id="52723-178">A more fine-grained DDD unit is the aggregate, which describes a cluster or group of entities and behaviors that can be treated as a cohesive unit.</span></span>

<span data-ttu-id="52723-179">Zazwyczaj Definiowanie agregacji na podstawie transakcji, które są potrzebne.</span><span class="sxs-lookup"><span data-stu-id="52723-179">You usually define an aggregate based on the transactions that you need.</span></span> <span data-ttu-id="52723-180">Klasycznym przykładem jest zamówienie zawiera także listę kolejności elementów.</span><span class="sxs-lookup"><span data-stu-id="52723-180">A classic example is an order that also contains a list of order items.</span></span> <span data-ttu-id="52723-181">Element kolejności zwykle jest jednostką.</span><span class="sxs-lookup"><span data-stu-id="52723-181">An order item will usually be an entity.</span></span> <span data-ttu-id="52723-182">Ale będzie ona jednostce podrzędnej w wartości zagregowanej kolejności, będzie również zawierać jednostki zamówienia jego obiektu głównego, zwykle nazywane głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-182">But it will be a child entity within the order aggregate, which will also contain the order entity as its root entity, typically called an aggregate root.</span></span>

<span data-ttu-id="52723-183">Identyfikowanie agregacji może być trudne.</span><span class="sxs-lookup"><span data-stu-id="52723-183">Identifying aggregates can be hard.</span></span> <span data-ttu-id="52723-184">Wartość zagregowana jest grupy obiektów, które muszą być zgodne ze sobą, ale nie można po prostu wybierz grupy obiektów i etykietowanie agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-184">An aggregate is a group of objects that must be consistent together, but you cannot just pick a group of objects and label them an aggregate.</span></span> <span data-ttu-id="52723-185">Musi rozpoczynać się od domeny koncepcji i zastanowić, jednostek, które są używane w najbardziej typowych transakcje powiązane z tą koncepcją.</span><span class="sxs-lookup"><span data-stu-id="52723-185">You must start with a domain concept and think about the entities that are used in the most common transactions related to that concept.</span></span> <span data-ttu-id="52723-186">Tych jednostek, które muszą być spójna transakcyjnie są, co stanowi agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-186">Those entities that need to be transactionally consistent are what forms an aggregate.</span></span> <span data-ttu-id="52723-187">Analiza operacji transakcji jest prawdopodobnie najlepszy sposób, aby zidentyfikować agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-187">Thinking about transaction operations is probably the best way to identify aggregates.</span></span>

### <a name="the-aggregate-root-or-root-entity-pattern"></a><span data-ttu-id="52723-188">Wzorzec główny agregacji lub głównego jednostki</span><span class="sxs-lookup"><span data-stu-id="52723-188">The Aggregate Root or Root Entity pattern</span></span>

<span data-ttu-id="52723-189">Wartość zagregowana składa się z co najmniej jedną jednostkę: głównego agregacji, nazywany również jednostki głównej lub podstawowej jednostki.</span><span class="sxs-lookup"><span data-stu-id="52723-189">An aggregate is composed of at least one entity: the aggregate root, also called root entity or primary entity.</span></span> <span data-ttu-id="52723-190">Ponadto może mieć wiele jednostek podrzędnych i obiekty wartości ze wszystkimi jednostek i obiektów, które współpracują, aby zaimplementować wymagane zachowanie i transakcji.</span><span class="sxs-lookup"><span data-stu-id="52723-190">Additionally, it can have multiple child entities and value objects, with all entities and objects working together to implement required behavior and transactions.</span></span>

<span data-ttu-id="52723-191">Główny agregacji ma na celu zapewnienia spójności agregacji; należy go tylko punkt wejścia dla aktualizacji do zagregowania za pośrednictwem metody lub operacji w całkowitym Klasa główna.</span><span class="sxs-lookup"><span data-stu-id="52723-191">The purpose of an aggregate root is to ensure the consistency of the aggregate; it should be the only entry point for updates to the aggregate through methods or operations in the aggregate root class.</span></span> <span data-ttu-id="52723-192">Należy wprowadzić zmiany do podmiotów w obrębie agregacji tylko przy użyciu głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-192">You should make changes to entities within the aggregate only via the aggregate root.</span></span> <span data-ttu-id="52723-193">Jest ochrona spójności wartości zagregowanej, biorąc pod uwagę wszystkie invariants i reguły spójności, potrzebne do wykonania w Twojej agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-193">It is the aggregate’s consistency guardian, taking into account all the invariants and consistency rules you might need to comply with in your aggregate.</span></span> <span data-ttu-id="52723-194">W przypadku zmiany obiektu podrzędnego jednostka lub wartość niezależnie głównego agregacji nie powiodło się, że agregacji jest w prawidłowym stanie.</span><span class="sxs-lookup"><span data-stu-id="52723-194">If you change a child entity or value object independently, the aggregate root cannot ensure that the aggregate is in a valid state.</span></span> <span data-ttu-id="52723-195">Byłoby jak tabelę z utracić etap.</span><span class="sxs-lookup"><span data-stu-id="52723-195">It would be like a table with a loose leg.</span></span> <span data-ttu-id="52723-196">Obsługa spójności jest głównym celem głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-196">Maintaining consistency is the main purpose of the aggregate root.</span></span>

<span data-ttu-id="52723-197">9 rysunek-9, widać agreguje próbki jak kupujący agregacji, zawierający pojedynczy element (łączny głównego nabywców).</span><span class="sxs-lookup"><span data-stu-id="52723-197">In Figure 9-9, you can see sample aggregates like the buyer aggregate, which contains a single entity (the aggregate root Buyer).</span></span> <span data-ttu-id="52723-198">Agregacja kolejności zawiera wiele jednostek i obiektu wartości.</span><span class="sxs-lookup"><span data-stu-id="52723-198">The order aggregate contains multiple entities and a value object.</span></span>

![](./media/image10.png)

<span data-ttu-id="52723-199">**Rysunek 9 — 9**.</span><span class="sxs-lookup"><span data-stu-id="52723-199">**Figure 9-9**.</span></span> <span data-ttu-id="52723-200">Przykład agregacji w wielu lub pojedynczego jednostek</span><span class="sxs-lookup"><span data-stu-id="52723-200">Example of aggregates with multiple or single entities</span></span>

<span data-ttu-id="52723-201">Należy zauważyć, że Agregacja nabywców można kolejne podrzędne jednostki, w zależności od domeny, co w porządkowania mikrousługi w aplikacji odwołanie eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="52723-201">Note that the Buyer aggregate could have additional child entities, depending on your domain, as it does in the ordering microservice in the eShopOnContainers reference application.</span></span> <span data-ttu-id="52723-202">Rysunek 9 — 9 przedstawiono tylko przypadek, w którym kupujący ma pojedynczej jednostki, na przykład wartość zagregowaną, która zawiera tylko głównego agregacji.</span><span class="sxs-lookup"><span data-stu-id="52723-202">Figure 9-9 just illustrates a case in which the buyer has a single entity, as an example of an aggregate that contains only an aggregate root.</span></span>

<span data-ttu-id="52723-203">Aby zachowanie separacji agregacji i zapewnić wyraźne granice między nimi, jest dobrym rozwiązaniem w modelu domeny DDD, aby uniemożliwić bezpośrednie nawigacji między wartości zagregowanych i tylko posiadające pole klucza obcego (klucz OBCY) zgodnie z implementacją w [ Kolejność modelu domeny mikrousługi](https://github.com/dotnet-architecture/eShopOnContainers/blob/master/src/Services/Ordering/Ordering.Domain/AggregatesModel/OrderAggregate/Order.cs) w eShopOnContainers.</span><span class="sxs-lookup"><span data-stu-id="52723-203">In order to maintain separation of aggregates and keep clear boundaries between them, it is a good practice in a DDD domain model to disallow direct navigation between aggregates and only having the foreign key (FK) field, as implemented in the [Ordering microservice domain model](https://github.com/dotnet-architecture/eShopOnContainers/blob/master/src/Services/Ordering/Ordering.Domain/AggregatesModel/OrderAggregate/Order.cs) in eShopOnContainers.</span></span> <span data-ttu-id="52723-204">Jednostki kolejności ma tylko pola klucza Obcego dla kupującemu, ale nie EF Core właściwość nawigacji, jak pokazano w poniższym kodzie:</span><span class="sxs-lookup"><span data-stu-id="52723-204">The Order entity only has a FK field for the buyer, but not an EF Core navigation property, as shown in the following code:</span></span>

```csharp
public class Order : Entity, IAggregateRoot
{
    private DateTime _orderDate;
    public Address Address { get; private set; }
    private int? _buyerId; //FK pointing to a different aggregate root
    public OrderStatus OrderStatus { get; private set; }
    private readonly List<OrderItem> _orderItems;
    public IReadOnlyCollection<OrderItem> OrderItems => _orderItems;
    // ... Additional code
}
```

<span data-ttu-id="52723-205">Identyfikowanie i Praca z wartości zagregowanych wymaga badań i obsługi.</span><span class="sxs-lookup"><span data-stu-id="52723-205">Identifying and working with aggregates requires research and experience.</span></span> <span data-ttu-id="52723-206">Aby uzyskać więcej informacji zobacz następujące listę dodatkowych zasobów.</span><span class="sxs-lookup"><span data-stu-id="52723-206">For more information, see the following Additional resources list.</span></span>

#### <a name="additional-resources"></a><span data-ttu-id="52723-207">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="52723-207">Additional resources</span></span>

-   <span data-ttu-id="52723-208">**Vaughn Vernon. Efektywnym projektowaniu agregacji — część I: modelowania pojedynczego agregacji**
    [*https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD\_SPOŁECZNOŚCI\_OPISOWYCH\_AGREGUJE\_części \_pdf 1.*](https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD_COMMUNITY_ESSAY_AGGREGATES_PART_1.pdf)</span><span class="sxs-lookup"><span data-stu-id="52723-208">**Vaughn Vernon. Effective Aggregate Design - Part I: Modeling a Single Aggregate**
[*https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD\_COMMUNITY\_ESSAY\_AGGREGATES\_PART\_1.pdf*](https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD_COMMUNITY_ESSAY_AGGREGATES_PART_1.pdf)</span></span>

-   <span data-ttu-id="52723-209">**Vaughn Vernon. Skuteczne agregacji projektu — część II: Tworzenie wartości zagregowanych współpracują**
    *<https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD_COMMUNITY_ESSAY_AGGREGATES_PART_2.pdf> *</span><span class="sxs-lookup"><span data-stu-id="52723-209">**Vaughn Vernon. Effective Aggregate Design - Part II: Making Aggregates Work Together**
*<https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD_COMMUNITY_ESSAY_AGGREGATES_PART_2.pdf> *</span></span>

-   <span data-ttu-id="52723-210">**Vaughn Vernon. Skuteczne agregacji projektu — część III: Uzyskanie wglądu za pomocą odnajdywania**
    *<https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD_COMMUNITY_ESSAY_AGGREGATES_PART_3.pdf> *</span><span class="sxs-lookup"><span data-stu-id="52723-210">**Vaughn Vernon. Effective Aggregate Design - Part III: Gaining Insight Through Discovery**
*<https://vaughnvernon.co/wordpress/wp-content/uploads/2014/10/DDD_COMMUNITY_ESSAY_AGGREGATES_PART_3.pdf> *</span></span>

-   <span data-ttu-id="52723-211">**Sergey Grybniak. Wzorce projektowe taktyczne DDD**
    [*https://www.codeproject.com/Articles/1164363/Domain-Driven-Design-Tactical-Design-Patterns-Part*](https://www.codeproject.com/Articles/1164363/Domain-Driven-Design-Tactical-Design-Patterns-Part)</span><span class="sxs-lookup"><span data-stu-id="52723-211">**Sergey Grybniak. DDD Tactical Design Patterns**
[*https://www.codeproject.com/Articles/1164363/Domain-Driven-Design-Tactical-Design-Patterns-Part*](https://www.codeproject.com/Articles/1164363/Domain-Driven-Design-Tactical-Design-Patterns-Part)</span></span>

-   <span data-ttu-id="52723-212">**Krzysztof Richardson. Tworzenie Mikrousług transakcyjne przy użyciu wartości zagregowanych**
    [*https://www.infoq.com/articles/microservices-aggregates-events-cqrs-part-1-richardson*](https://www.infoq.com/articles/microservices-aggregates-events-cqrs-part-1-richardson)</span><span class="sxs-lookup"><span data-stu-id="52723-212">**Chris Richardson. Developing Transactional Microservices Using Aggregates**
[*https://www.infoq.com/articles/microservices-aggregates-events-cqrs-part-1-richardson*](https://www.infoq.com/articles/microservices-aggregates-events-cqrs-part-1-richardson)</span></span>

-   <span data-ttu-id="52723-213">**DevIQ. Wzorzec agregacji**
    [*http://deviq.com/aggregate-pattern/*](http://deviq.com/aggregate-pattern/)</span><span class="sxs-lookup"><span data-stu-id="52723-213">**DevIQ. The Aggregate pattern**
[*http://deviq.com/aggregate-pattern/*](http://deviq.com/aggregate-pattern/)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="52723-214">[Previous] (ddd-oriented-microservice.md) [Next] (net-core-microservice-domain-model.md)</span><span class="sxs-lookup"><span data-stu-id="52723-214">[Previous] (ddd-oriented-microservice.md) [Next] (net-core-microservice-domain-model.md)</span></span>
