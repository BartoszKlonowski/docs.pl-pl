---
title: "Stosowanie uproszczony CQRS i DDD wzorce w mikrousługi"
description: "Architektura Mikrousług .NET dla aplikacji .NET konteneryzowanych | Stosowanie uproszczony CQRS i DDD wzorce w mikrousługi"
keywords: "Docker, Mikrousług, ASP.NET, kontenera"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 5369ff73a0614170b220177f1e5d388483ca19f8
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/23/2017
---
# <a name="applying-simplified-cqrs-and-ddd-patterns-in-a-microservice"></a><span data-ttu-id="be732-104">Stosowanie uproszczony CQRS i DDD wzorce w mikrousługi</span><span class="sxs-lookup"><span data-stu-id="be732-104">Applying simplified CQRS and DDD patterns in a microservice</span></span>

<span data-ttu-id="be732-105">CQRS jest wzorzec architektury, która oddziela modeli do odczytywania i zapisywania danych.</span><span class="sxs-lookup"><span data-stu-id="be732-105">CQRS is an architectural pattern that separates the models for reading and writing data.</span></span> <span data-ttu-id="be732-106">Powiązane termin [polecenia separacja zapytania (CQS)](https://martinfowler.com/bliki/CommandQuerySeparation.html) została pierwotnie zdefiniowana przez Bertrand Meyer w jego książce *konstrukcji oprogramowania przeznaczonych dla obiektów*.</span><span class="sxs-lookup"><span data-stu-id="be732-106">The related term [Command Query Separation (CQS)](https://martinfowler.com/bliki/CommandQuerySeparation.html) was originally defined by Bertrand Meyer in his book *Object Oriented Software Construction*.</span></span> <span data-ttu-id="be732-107">Podstawową koncepcją jest podzielenie operacje systemu na dwie kategorie znacznie rozdzielonych:</span><span class="sxs-lookup"><span data-stu-id="be732-107">The basic idea is that you can divide a system’s operations into two sharply separated categories:</span></span>

-   <span data-ttu-id="be732-108">Zapytania.</span><span class="sxs-lookup"><span data-stu-id="be732-108">Queries.</span></span> <span data-ttu-id="be732-109">Te zwrócony wynik i nie należy zmieniać stanu systemu i są wolne od efekty uboczne.</span><span class="sxs-lookup"><span data-stu-id="be732-109">These return a result and do not change the state of the system, and they are free of side effects.</span></span>

-   <span data-ttu-id="be732-110">Polecenia.</span><span class="sxs-lookup"><span data-stu-id="be732-110">Commands.</span></span> <span data-ttu-id="be732-111">Te zmiany stanu systemu.</span><span class="sxs-lookup"><span data-stu-id="be732-111">These change the state of a system.</span></span>

<span data-ttu-id="be732-112">CQS to pojęcie proste — jest o metod w ramach tego samego obiektu zapytania lub poleceń.</span><span class="sxs-lookup"><span data-stu-id="be732-112">CQS is a simple concept—it is about methods within the same object being either queries or commands.</span></span> <span data-ttu-id="be732-113">Każda metoda zwraca stan lub mutuje stanu, ale nie oba.</span><span class="sxs-lookup"><span data-stu-id="be732-113">Each method either returns state or mutates state, but not both.</span></span> <span data-ttu-id="be732-114">Nawet obiektu wzorzec jednym repozytorium może być zgodne z CQS.</span><span class="sxs-lookup"><span data-stu-id="be732-114">Even a single repository pattern object can comply with CQS.</span></span> <span data-ttu-id="be732-115">CQS mogą zostać uwzględnione w CQRS podstawowych zasady.</span><span class="sxs-lookup"><span data-stu-id="be732-115">CQS can be considered a foundational principle for CQRS.</span></span>

<span data-ttu-id="be732-116">[Polecenie i podział odpowiedzialności kwerendy (CQRS)](https://martinfowler.com/bliki/CQRS.html) została wprowadzona przez małych Gregowi i silnie awansowane przez Udi Dahan i inne osoby.</span><span class="sxs-lookup"><span data-stu-id="be732-116">[Command and Query Responsibility Segregation (CQRS)](https://martinfowler.com/bliki/CQRS.html) was introduced by Greg Young and strongly promoted by Udi Dahan and others.</span></span> <span data-ttu-id="be732-117">Mimo że jest bardziej szczegółowe jest oparty na zasadzie CQS.</span><span class="sxs-lookup"><span data-stu-id="be732-117">It is based on the CQS principle, although it is more detailed.</span></span> <span data-ttu-id="be732-118">Można uważać wzorzec oparty na poleceń i zdarzeń, oraz opcjonalnie w wiadomościach asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="be732-118">It can be considered a pattern based on commands and events plus optionally on asynchronous messages.</span></span> <span data-ttu-id="be732-119">W wielu przypadkach CQRS powiązany jest bardziej zaawansowanych scenariuszy, takich jak o innej fizycznej bazy danych dla odczytów (queries) niż w przypadku zapisów (aktualizacji).</span><span class="sxs-lookup"><span data-stu-id="be732-119">In many cases, CQRS is related to more advanced scenarios, like having a different physical database for reads (queries) than for writes (updates).</span></span> <span data-ttu-id="be732-120">Ponadto może zastosować bardziej wydzielonego systemu CQRS [źródłem zdarzeń (ES)](http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/) aktualizacje bazy danych, więc będzie tylko są przechowywane zdarzeń w modelu domeny zamiast zapisywania danych w bieżącym stanie.</span><span class="sxs-lookup"><span data-stu-id="be732-120">Moreover, a more evolved CQRS system might implement [Event-Sourcing (ES)](http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/) for your updates database, so you would only store events in the domain model instead of storing the current-state data.</span></span> <span data-ttu-id="be732-121">Jednak nie jest to rozwiązanie używane w tym przewodniku; użyto najprostsza metoda CQRS, która składa się z tylko oddzielanie zapytania z poleceniami.</span><span class="sxs-lookup"><span data-stu-id="be732-121">However, this is not the approach used in this guide; we are using the simplest CQRS approach, which consists of just separating the queries from the commands.</span></span>

<span data-ttu-id="be732-122">Aspekt separacji CQRS jest to osiągane przez grupowanie operacje kwerend w jednej warstwy i polecenia w innej warstwie.</span><span class="sxs-lookup"><span data-stu-id="be732-122">The separation aspect of CQRS is achieved by grouping query operations in one layer and commands in another layer.</span></span> <span data-ttu-id="be732-123">Każda warstwa ma własny model danych (Zauważ, że możemy powiedzieć modelu, niekoniecznie innej bazy danych) i jest utworzony przy użyciu własnego kombinację wzorców i technologii.</span><span class="sxs-lookup"><span data-stu-id="be732-123">Each layer has its own data model (note that we say model, not necessarily a different database) and is built using its own combination of patterns and technologies.</span></span> <span data-ttu-id="be732-124">Co więcej dwie warstwy może być w tej samej warstwie lub mikrousługi, jak pokazano w przykładzie (kolejność mikrousługi) używany dla tego przewodnika.</span><span class="sxs-lookup"><span data-stu-id="be732-124">More importantly, the two layers can be within the same tier or microservice, as in the example (ordering microservice) used for this guide.</span></span> <span data-ttu-id="be732-125">Lub może można zaimplementować w różnych mikrousług lub procesów, dlatego może być zoptymalizowany i skalowanie oddzielnie bez wpływu na siebie.</span><span class="sxs-lookup"><span data-stu-id="be732-125">Or they could be implemented on different microservices or processes so they can be optimized and scaled out separately without affecting one another.</span></span>

<span data-ttu-id="be732-126">CQRS oznacza o dwa obiekty pod kątem operacji odczytu/zapisu, gdy w innych kontekstach istnieje.</span><span class="sxs-lookup"><span data-stu-id="be732-126">CQRS means having two objects for a read/write operation where in other contexts there is one.</span></span> <span data-ttu-id="be732-127">Brak powodów do bazy danych nieznormalizowany odczytów, którym można zapoznać się w bardziej zaawansowanym materiały CQRS.</span><span class="sxs-lookup"><span data-stu-id="be732-127">There are reasons to have a denormalized reads database, which you can learn about in more advanced CQRS literature.</span></span> <span data-ttu-id="be732-128">Ale nie używamy tego podejścia, której celem jest uzyskuje się większą elastyczność w zapytaniach zamiast ograniczanie zapytań dotyczących ograniczenia na podstawie wzorców DDD, takie jak wartości zagregowanych.</span><span class="sxs-lookup"><span data-stu-id="be732-128">But we are not using that approach here, where the goal is to have more flexibility in the queries instead of limiting the queries with constraints from DDD patterns like aggregates.</span></span>

<span data-ttu-id="be732-129">Przykładem tego rodzaju usługi jest porządkowania mikrousługi z eShopOnContainers odwołania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="be732-129">An example of this kind of service is the ordering microservice from the eShopOnContainers reference application.</span></span> <span data-ttu-id="be732-130">Ta usługa implementuje mikrousługi, oparty na uproszczonej podejście CQRS.</span><span class="sxs-lookup"><span data-stu-id="be732-130">This service implements a microservice based on a simplified CQRS approach.</span></span> <span data-ttu-id="be732-131">Używa pojedynczego źródła danych lub bazy danych, ale dwa modele logiczne oraz wzorce DDD transakcyjne domeny, jak pokazano na rysunku 9-2.</span><span class="sxs-lookup"><span data-stu-id="be732-131">It uses a single data source or database, but two logical models plus DDD patterns for the transactional domain, as shown in Figure 9-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="be732-132">**Rysunek 9-2**.</span><span class="sxs-lookup"><span data-stu-id="be732-132">**Figure 9-2**.</span></span> <span data-ttu-id="be732-133">Uproszczone na podstawie CQRS i DDD mikrousługi</span><span class="sxs-lookup"><span data-stu-id="be732-133">Simplified CQRS- and DDD-based microservice</span></span>

<span data-ttu-id="be732-134">Warstwa aplikacji może być interfejsu API sieci Web, do samej siebie.</span><span class="sxs-lookup"><span data-stu-id="be732-134">The application layer can be the Web API itself.</span></span> <span data-ttu-id="be732-135">Aspekt ważne projektu w tym miejscu jest czy mikrousługi została podzielona, zapytań i ViewModels (szczególnie utworzone dla aplikacji klienckich modeli danych) z poleceń, model domeny i po wzorzec CQRS transakcji.</span><span class="sxs-lookup"><span data-stu-id="be732-135">The important design aspect here is that the microservice has split the queries and ViewModels (data models especially created for the client applications) from the commands, domain model, and transactions following the CQRS pattern.</span></span> <span data-ttu-id="be732-136">Takie podejście pozwala zapytania niezależnie od ograniczeń i ograniczenia pochodzące z wzorców DDD, które warto tylko transakcje i aktualizacji, zgodnie z objaśnieniem w kolejnych sekcjach.</span><span class="sxs-lookup"><span data-stu-id="be732-136">This approach keeps the queries independent from restrictions and constraints coming from DDD patterns that only make sense for transactions and updates, as explained in later sections.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="be732-137">[Poprzednie] (index.md) [dalej] (eshoponcontainers-cqrs-ddd-microservice.md)</span><span class="sxs-lookup"><span data-stu-id="be732-137">[Previous] (index.md) [Next] (eshoponcontainers-cqrs-ddd-microservice.md)</span></span>
