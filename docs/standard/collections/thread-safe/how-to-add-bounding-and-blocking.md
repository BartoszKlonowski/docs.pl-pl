---
title: 'Porady: dodawanie do kolekcji funkcji blokujących i ograniczających'
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- thread-safe collections, custom blocking collections
ms.assetid: 4c2492de-3876-4873-b5a1-000bb404d770
ms.openlocfilehash: 33c0b5a93a9c63e3e743a04e69bb7353ac69fa8a
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/15/2020
ms.locfileid: "75711288"
---
# <a name="how-to-add-bounding-and-blocking-functionality-to-a-collection"></a><span data-ttu-id="c14fb-102">Porady: dodawanie do kolekcji funkcji blokujących i ograniczających</span><span class="sxs-lookup"><span data-stu-id="c14fb-102">How to: Add Bounding and Blocking Functionality to a Collection</span></span>
<span data-ttu-id="c14fb-103">W tym przykładzie pokazano, jak dodać funkcje ograniczające i <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> blokujące do klasy kolekcji niestandardowej, implementując interfejs <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>w klasie, a następnie używając wystąpienia klasy jako mechanizmu magazynu wewnętrznego dla .</span><span class="sxs-lookup"><span data-stu-id="c14fb-103">This example shows how to add bounding and blocking functionality to a custom collection class by implementing the <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> interface in the class, and then using a class instance as the internal storage mechanism for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="c14fb-104">Aby uzyskać więcej informacji na temat granic i blokowania, zobacz [BlockingCollection Omówienie](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c14fb-104">For more information about bounding and blocking, see [BlockingCollection Overview](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="c14fb-105">Przykład</span><span class="sxs-lookup"><span data-stu-id="c14fb-105">Example</span></span>  
 <span data-ttu-id="c14fb-106">Klasa kolekcji niestandardowej jest kolejką priorytetu podstawowego, w której <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType> poziomy priorytetu są reprezentowane jako tablica obiektów.</span><span class="sxs-lookup"><span data-stu-id="c14fb-106">The custom collection class is a basic priority queue in which the priority levels are represented as an array of <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType> objects.</span></span> <span data-ttu-id="c14fb-107">W każdej kolejce nie jest wykonywana żadna dodatkowa kolejność.</span><span class="sxs-lookup"><span data-stu-id="c14fb-107">No additional ordering is performed within each queue.</span></span>  
  
 <span data-ttu-id="c14fb-108">W kodzie klienta są uruchamiane trzy zadania.</span><span class="sxs-lookup"><span data-stu-id="c14fb-108">In the client code, three tasks are started.</span></span> <span data-ttu-id="c14fb-109">Pierwsze zadanie tylko sonduje dla pociągnięć klawiatury, aby włączyć anulowanie w dowolnym momencie podczas wykonywania.</span><span class="sxs-lookup"><span data-stu-id="c14fb-109">The first task just polls for keyboard strokes to enable cancellation at any point during execution.</span></span> <span data-ttu-id="c14fb-110">Drugim zadaniem jest wątek producenta; dodaje nowe elementy do kolekcji blokowania i nadaje każdemu elementowi priorytet na podstawie wartości losowej.</span><span class="sxs-lookup"><span data-stu-id="c14fb-110">The second task is the producer thread; it adds new items to the blocking collection and gives each item a priority based on a random value.</span></span> <span data-ttu-id="c14fb-111">Trzecie zadanie usuwa elementy z kolekcji, gdy stają się one dostępne.</span><span class="sxs-lookup"><span data-stu-id="c14fb-111">The third task removes items from the collection as they become available.</span></span>  
  
 <span data-ttu-id="c14fb-112">Zachowanie aplikacji można dostosować, wykonując jeden z wątków działa szybciej niż inne.</span><span class="sxs-lookup"><span data-stu-id="c14fb-112">You can adjust the behavior of the application by making one of the threads run faster than the other.</span></span> <span data-ttu-id="c14fb-113">Jeśli producent działa szybciej, można zauważyć, że funkcje ograniczające, jak blokowanie kolekcji zapobiega dodania elementów, jeśli już zawiera liczbę elementów, które są określone w konstruktorze.</span><span class="sxs-lookup"><span data-stu-id="c14fb-113">If the producer runs faster, you will notice the bounding functionality as the blocking collection prevents items from being added if it already contains the number of items that is specified in the constructor.</span></span> <span data-ttu-id="c14fb-114">Jeśli konsument działa szybciej, można zauważyć, że funkcja blokowania, jak konsument czeka na nowy element, który ma zostać dodany.</span><span class="sxs-lookup"><span data-stu-id="c14fb-114">If the consumer runs faster, you will notice the blocking functionality as the consumer waits for a new item to be added.</span></span>  
  
 [!code-csharp[CDS_BlockingCollection#06](../../../../samples/snippets/csharp/VS_Snippets_Misc/cds_blockingcollection/cs/prodcon.cs#06)]  
  
 <span data-ttu-id="c14fb-115">Domyślnie magazyn dla <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> a <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>jest .</span><span class="sxs-lookup"><span data-stu-id="c14fb-115">By default, the storage for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> is <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c14fb-116">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="c14fb-116">See also</span></span>

- [<span data-ttu-id="c14fb-117">Kolekcje bezpieczne wątkowo</span><span class="sxs-lookup"><span data-stu-id="c14fb-117">Thread-Safe Collections</span></span>](../../../../docs/standard/collections/thread-safe/index.md)
