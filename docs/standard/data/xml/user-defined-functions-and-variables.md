---
title: Funkcje i zmienne zdefiniowane przez użytkownika
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 4772f20e-1e7f-496e-93c2-1484473be555
ms.openlocfilehash: d4936ec32d54a465803d493048cba2b70ed50db6
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/18/2020
ms.locfileid: "94818508"
---
# <a name="user-defined-functions-and-variables"></a><span data-ttu-id="badc0-102">Funkcje i zmienne zdefiniowane przez użytkownika</span><span class="sxs-lookup"><span data-stu-id="badc0-102">User Defined Functions and Variables</span></span>
<span data-ttu-id="badc0-103"><xref:System.Xml.XPath.XPathNavigator>Klasa zawiera zestaw metod, które są używane do współpracy z <xref:System.Xml.XPath.XPathDocument> danymi.</span><span class="sxs-lookup"><span data-stu-id="badc0-103">The <xref:System.Xml.XPath.XPathNavigator> class provides a set of methods that are used to interact with <xref:System.Xml.XPath.XPathDocument> data.</span></span> <span data-ttu-id="badc0-104">Można uzupełnić standardowe funkcje XPath przez implementację funkcji i zmiennych rozszerzeń do użycia przez wyrażenia zapytań XPath.</span><span class="sxs-lookup"><span data-stu-id="badc0-104">You can supplement the standard XPath functions by implementing extension functions and variables for use by XPath query expressions.</span></span> <span data-ttu-id="badc0-105"><xref:System.Xml.XPath.XPathExpression.SetContext%2A>Metoda może akceptować kontekst zdefiniowany przez użytkownika, który pochodzi od <xref:System.Xml.Xsl.XsltContext> .</span><span class="sxs-lookup"><span data-stu-id="badc0-105">The <xref:System.Xml.XPath.XPathExpression.SetContext%2A> method can accept a user defined context derived from <xref:System.Xml.Xsl.XsltContext>.</span></span> <span data-ttu-id="badc0-106">Funkcje zdefiniowane przez użytkownika są rozwiązywane przez kontekst niestandardowy.</span><span class="sxs-lookup"><span data-stu-id="badc0-106">User defined functions are resolved by the custom context.</span></span>  
  
 <span data-ttu-id="badc0-107">Funkcje i zmienne rozszerzeń mogą być przydatne w zapobieganiu atakom przy iniekcji kodu XML.</span><span class="sxs-lookup"><span data-stu-id="badc0-107">Extension functions and variables can be useful in prevention of XML injection attacks.</span></span> <span data-ttu-id="badc0-108">W tych scenariuszach dane wejściowe użytkownika są przypisywane do zmiennych niestandardowych i przetwarzane przez funkcje rozszerzenia, nie jako pierwotne dane wejściowe połączone z instrukcjami przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="badc0-108">In these scenarios user input is assigned to custom variables and processed by extension functions, not as raw input concatenated with processing instructions.</span></span> <span data-ttu-id="badc0-109">Funkcje rozszerzenia i zmienne zawierają dane wejściowe użytkownika, dzięki czemu działają tylko na danych XML, które są przewidziane przez projektanta.</span><span class="sxs-lookup"><span data-stu-id="badc0-109">Extension functions and variables contain user input so that it only acts on XML data as intended by the designer.</span></span>  
  
 <span data-ttu-id="badc0-110">Aby użyć rozszerzeń implementujących klasę niestandardową <xref:System.Xml.Xsl.XsltContext> wraz z interfejsami i obsługującymi <xref:System.Xml.Xsl.IXsltContextFunction> <xref:System.Xml.Xsl.IXsltContextVariable> funkcje rozszerzeń i zmienne.</span><span class="sxs-lookup"><span data-stu-id="badc0-110">To use extensions you implement a custom <xref:System.Xml.Xsl.XsltContext> class along with the interfaces <xref:System.Xml.Xsl.IXsltContextFunction> and <xref:System.Xml.Xsl.IXsltContextVariable> that support extension functions and variables.</span></span> <span data-ttu-id="badc0-111"><xref:System.Xml.XPath.XPathExpression>Dodaje do niestandardowego dane wejściowe użytkownika <xref:System.Xml.Xsl.XsltArgumentList> <xref:System.Xml.Xsl.XsltContext> .</span><span class="sxs-lookup"><span data-stu-id="badc0-111">An <xref:System.Xml.XPath.XPathExpression> adds user input with its <xref:System.Xml.Xsl.XsltArgumentList> to the custom <xref:System.Xml.Xsl.XsltContext>.</span></span>  
  
 <span data-ttu-id="badc0-112"><xref:System.Xml.XPath.XPathExpression>Reprezentuje skompilowane zapytanie, które <xref:System.Xml.XPath.XPathNavigator> używa do znajdowania i przetwarzania węzłów identyfikowanych przez wyrażenie.</span><span class="sxs-lookup"><span data-stu-id="badc0-112">The <xref:System.Xml.XPath.XPathExpression> represents a compiled query that <xref:System.Xml.XPath.XPathNavigator> uses to find and process the nodes identified by the expression.</span></span>  
  
 <span data-ttu-id="badc0-113">W poniższym przykładzie przedstawiono implementację niestandardowej klasy kontekstu pochodzącej od <xref:System.Xml.Xsl.XsltContext> .</span><span class="sxs-lookup"><span data-stu-id="badc0-113">The following example shows implementation of a custom context class derived from <xref:System.Xml.Xsl.XsltContext>.</span></span> <span data-ttu-id="badc0-114">Komentarze w kodzie opisują elementy członkowskie klasy i ich użycia w funkcjach niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="badc0-114">Comments in the code describe class members and their use in custom functions.</span></span> <span data-ttu-id="badc0-115">Implementacje funkcji i zmiennych oraz Przykładowa aplikacja, która używa tych implementacji, jest zgodna z tym segmentem kodu.</span><span class="sxs-lookup"><span data-stu-id="badc0-115">Function and variable implementations and a sample application that uses these implementations follow this code segment.</span></span>  
  
 [!code-csharp[XPathExtensionFunctions#2](../../../../samples/snippets/csharp/VS_Snippets_Data/xpathextensionfunctions/cs/xpathextensionfunctions.cs#2)]
 [!code-vb[XPathExtensionFunctions#2](../../../../samples/snippets/visualbasic/VS_Snippets_Data/xpathextensionfunctions/vb/xpathextensionfunctions.vb#2)]  
  
 <span data-ttu-id="badc0-116">Poniższy kod implementuje <xref:System.Xml.Xsl.IXsltContextFunction> .</span><span class="sxs-lookup"><span data-stu-id="badc0-116">The following code implements <xref:System.Xml.Xsl.IXsltContextFunction>.</span></span> <span data-ttu-id="badc0-117">Klasa, która implementuje <xref:System.Xml.Xsl.IXsltContextFunction> rozpoznaje i wykonuje funkcje zdefiniowane przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="badc0-117">The class that implements <xref:System.Xml.Xsl.IXsltContextFunction> resolves and executes user-defined functions.</span></span> <span data-ttu-id="badc0-118">Ten przykład używa funkcji identyfikowanej przez deklarację: `private int CountChar(string title, char charTocount)` .</span><span class="sxs-lookup"><span data-stu-id="badc0-118">This example uses the function identified by the declaration: `private int CountChar(string title, char charTocount)`.</span></span>  
  
 <span data-ttu-id="badc0-119">Komentarze do kodu opisują elementy członkowskie klasy.</span><span class="sxs-lookup"><span data-stu-id="badc0-119">Code comments describe class members.</span></span>  
  
 [!code-csharp[XPathExtensionFunctions#3](../../../../samples/snippets/csharp/VS_Snippets_Data/xpathextensionfunctions/cs/xpathextensionfunctions.cs#3)]
 [!code-vb[XPathExtensionFunctions#3](../../../../samples/snippets/visualbasic/VS_Snippets_Data/xpathextensionfunctions/vb/xpathextensionfunctions.vb#3)]  
  
 <span data-ttu-id="badc0-120">Poniższy kod implementuje <xref:System.Xml.Xsl.IXsltContextVariable> .</span><span class="sxs-lookup"><span data-stu-id="badc0-120">The following code implements <xref:System.Xml.Xsl.IXsltContextVariable>.</span></span> <span data-ttu-id="badc0-121">Ta klasa rozpoznaje odwołania do zmiennych zdefiniowanych przez użytkownika w wyrażeniach zapytań XPath w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="badc0-121">This class resolves references to user-defined variables in XPath query expressions at run time.</span></span> <span data-ttu-id="badc0-122">Wystąpienie tej klasy jest tworzone i zwracane przez przesłoniętą <xref:System.Xml.Xsl.XsltContext.ResolveVariable%2A> metodę <xref:System.Xml.Xsl.XsltContext> klasy niestandardowej.</span><span class="sxs-lookup"><span data-stu-id="badc0-122">An instance of this class is created and returned by the overridden <xref:System.Xml.Xsl.XsltContext.ResolveVariable%2A> method of the custom <xref:System.Xml.Xsl.XsltContext> class.</span></span>  
  
 <span data-ttu-id="badc0-123">Komentarze do kodu opisują elementy członkowskie klasy.</span><span class="sxs-lookup"><span data-stu-id="badc0-123">Code comments describe the class members.</span></span>  
  
 [!code-csharp[XPathExtensionFunctions#4](../../../../samples/snippets/csharp/VS_Snippets_Data/xpathextensionfunctions/cs/xpathextensionfunctions.cs#4)]
 [!code-vb[XPathExtensionFunctions#4](../../../../samples/snippets/visualbasic/VS_Snippets_Data/xpathextensionfunctions/vb/xpathextensionfunctions.vb#4)]  
  
 <span data-ttu-id="badc0-124">Z poprzednimi definicjami klas w zakresie, poniższy kod używa funkcji niestandardowej do zliczania znaków w elementach `Tasks.xml` dokumentu.</span><span class="sxs-lookup"><span data-stu-id="badc0-124">With the previous class definitions in scope, the following code uses the custom function to count characters in the elements of the `Tasks.xml` document.</span></span> <span data-ttu-id="badc0-125">Komentarze w kodzie opisują kod, który kompiluje funkcję niestandardową i uruchamia ją względem `Tasks.xml` dokumentu.</span><span class="sxs-lookup"><span data-stu-id="badc0-125">Comments in the code describe the code that compiles the custom function and runs it against the `Tasks.xml` document.</span></span>  
  
 [!code-csharp[XPathExtensionFunctions#1](../../../../samples/snippets/csharp/VS_Snippets_Data/xpathextensionfunctions/cs/xpathextensionfunctions.cs#1)]
 [!code-vb[XPathExtensionFunctions#1](../../../../samples/snippets/visualbasic/VS_Snippets_Data/xpathextensionfunctions/vb/xpathextensionfunctions.vb#1)]  
  
 <span data-ttu-id="badc0-126">W tym przykładzie są stosowane następujące dane XML.</span><span class="sxs-lookup"><span data-stu-id="badc0-126">This example uses the following XML data.</span></span>  
  
 [!code-xml[XPathExtensionFunctions#5](../../../../samples/snippets/xml/VS_Snippets_Data/xpathextensionfunctions/XML/tasks.xml#5)]
