---
title: LINQ to XML zabezpieczenia — LINQ to XML
description: Dowiedz się więcej o rozwiązywaniu problemów z zabezpieczeniami LINQ to XML i sposobach ograniczenia zagrożeń bezpieczeństwa.
ms.date: 07/20/2015
ms.assetid: ef2c0dc9-ecf9-4c17-b24e-144184ab725f
ms.openlocfilehash: 72dd2bfe2a3f0edb69645daf4625ba24fb56732b
ms.sourcegitcommit: 0c3ce6d2e7586d925a30f231f32046b7b3934acb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/08/2020
ms.locfileid: "89553331"
---
# <a name="linq-to-xml-security"></a><span data-ttu-id="8641a-103">Zabezpieczenia LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="8641a-103">LINQ to XML security</span></span>

<span data-ttu-id="8641a-104">W tym artykule opisano problemy z zabezpieczeniami powiązane z LINQ to XML i przedstawiono wskazówki dotyczące ograniczania zagrożeń bezpieczeństwa.</span><span class="sxs-lookup"><span data-stu-id="8641a-104">This article describes security issues associated with LINQ to XML, and provides guidance for mitigating security exposure.</span></span>

## <a name="linq-to-xml-security-overview"></a><span data-ttu-id="8641a-105">Omówienie zabezpieczeń LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="8641a-105">LINQ to XML security overview</span></span>

<span data-ttu-id="8641a-106">LINQ to XML zaprojektowano więcej dla wygody programowania niż w przypadku aplikacji po stronie serwera z rygorystycznymi wymaganiami dotyczącymi bezpieczeństwa.</span><span class="sxs-lookup"><span data-stu-id="8641a-106">LINQ to XML is designed more for programming convenience than for server-side applications with stringent security requirements.</span></span> <span data-ttu-id="8641a-107">Większość scenariuszy XML polega na przetwarzaniu zaufanych dokumentów XML, a nie przetwarzaniu niezaufanych dokumentów XML, które są przekazywane do serwera.</span><span class="sxs-lookup"><span data-stu-id="8641a-107">Most XML scenarios consist of processing trusted XML documents, rather than processing untrusted XML documents that are uploaded to a server.</span></span> <span data-ttu-id="8641a-108">LINQ to XML jest zoptymalizowany pod kątem tych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="8641a-108">LINQ to XML is optimized for these scenarios.</span></span>

<span data-ttu-id="8641a-109">Jeśli konieczne jest przetworzenie niezaufanych danych z nieznanych źródeł, firma Microsoft zaleca użycie wystąpienia <xref:System.Xml.XmlReader> klasy, która została skonfigurowana do filtrowania znanych ataków typu "odmowa usługi" (DOS).</span><span class="sxs-lookup"><span data-stu-id="8641a-109">If you must process untrusted data from unknown sources, Microsoft recommends that you use an instance of the <xref:System.Xml.XmlReader> class that has been configured to filter out known XML denial of service (DoS) attacks.</span></span>

<span data-ttu-id="8641a-110">Jeśli skonfigurowano <xref:System.Xml.XmlReader> , aby ograniczyć ataki typu "odmowa usługi", można użyć tego czytnika do wypełnienia drzewa LINQ to XML i nadal korzystać z ulepszeń programistycznych LINQ to XML.</span><span class="sxs-lookup"><span data-stu-id="8641a-110">If you've configured an <xref:System.Xml.XmlReader> to mitigate denial of service attacks, you can use that reader to populate a LINQ to XML tree and still benefit from the programmer productivity enhancements of LINQ to XML.</span></span> <span data-ttu-id="8641a-111">Wiele technik zaradczych wiąże się z tworzeniem czytników skonfigurowanych do ograniczania problemu zabezpieczeń, a następnie tworzenia wystąpienia drzewa XML za pomocą skonfigurowanego czytnika.</span><span class="sxs-lookup"><span data-stu-id="8641a-111">Many mitigation techniques involve creating readers that are configured to mitigate the security issue, and then instantiating an XML tree through the configured reader.</span></span>

<span data-ttu-id="8641a-112">Język XML jest wewnętrznie narażony na ataki typu "odmowa usługi", ponieważ nie ma ograniczenia rozmiaru, głębokości, rozmiaru nazwy elementu i nie tylko.</span><span class="sxs-lookup"><span data-stu-id="8641a-112">XML is intrinsically vulnerable to denial of service attacks because documents are unbounded in size, depth, element name size, and more.</span></span> <span data-ttu-id="8641a-113">Bez względu na składnik używany do przetwarzania kodu XML, zawsze należy przygotować się do odtworzenia domeny aplikacji, jeśli używa nadmiernych zasobów.</span><span class="sxs-lookup"><span data-stu-id="8641a-113">Regardless of the component that you use to process XML, you should always be prepared to recycle the application domain if it uses excessive resources.</span></span>

## <a name="mitigation-of-xml-xsd-xpath-and-xslt-attacks"></a><span data-ttu-id="8641a-114">Eliminowanie ataków XML, XSD, XPath i XSLT</span><span class="sxs-lookup"><span data-stu-id="8641a-114">Mitigation of XML, XSD, XPath, and XSLT attacks</span></span>

<span data-ttu-id="8641a-115">LINQ to XML jest oparta na <xref:System.Xml.XmlReader> i <xref:System.Xml.XmlWriter> .</span><span class="sxs-lookup"><span data-stu-id="8641a-115">LINQ to XML is built upon <xref:System.Xml.XmlReader> and <xref:System.Xml.XmlWriter>.</span></span> <span data-ttu-id="8641a-116">LINQ to XML obsługuje XSD i XPath za pomocą metod rozszerzających <xref:System.Xml.Schema?displayProperty=nameWithType> w <xref:System.Xml.XPath?displayProperty=nameWithType> przestrzeniach nazw i.</span><span class="sxs-lookup"><span data-stu-id="8641a-116">LINQ to XML supports XSD and XPath through extension methods in the <xref:System.Xml.Schema?displayProperty=nameWithType> and <xref:System.Xml.XPath?displayProperty=nameWithType> namespaces.</span></span> <span data-ttu-id="8641a-117">Korzystając z <xref:System.Xml.XmlReader> klas, <xref:System.Xml.XPath.XPathNavigator> , i <xref:System.Xml.XmlWriter> w połączeniu z LINQ to XML, można wywołać XSLT, aby przekształcić drzewa XML.</span><span class="sxs-lookup"><span data-stu-id="8641a-117">By using the <xref:System.Xml.XmlReader>, <xref:System.Xml.XPath.XPathNavigator>, and <xref:System.Xml.XmlWriter> classes in conjunction with LINQ to XML, you can invoke XSLT to transform XML trees.</span></span>

<span data-ttu-id="8641a-118">W przypadku korzystania z mniej bezpiecznego środowiska istnieje wiele problemów z zabezpieczeniami, które są skojarzone z językiem XML, i używania klas w <xref:System.Xml?displayProperty=nameWithType> ,, <xref:System.Xml.Schema?displayProperty=nameWithType> <xref:System.Xml.XPath?displayProperty=nameWithType> i <xref:System.Xml.Xsl?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="8641a-118">If you're  operating in a less secure environment, there are a number of security issues that are associated with XML and the use of the classes in <xref:System.Xml?displayProperty=nameWithType>, <xref:System.Xml.Schema?displayProperty=nameWithType>, <xref:System.Xml.XPath?displayProperty=nameWithType>, and <xref:System.Xml.Xsl?displayProperty=nameWithType>.</span></span> <span data-ttu-id="8641a-119">Te problemy obejmują, ale nie są ograniczone do, następujące:</span><span class="sxs-lookup"><span data-stu-id="8641a-119">These issues include, but aren't limited to, the following:</span></span>

- <span data-ttu-id="8641a-120">XSD, XPath i XSLT są językami opartymi na ciągach, w których można określić operacje, które zużywają dużo czasu lub pamięci.</span><span class="sxs-lookup"><span data-stu-id="8641a-120">XSD, XPath, and XSLT are string-based languages in which you can specify operations that consume a lot of time or memory.</span></span> <span data-ttu-id="8641a-121">W celu sprawdzenia, czy ciągi nie są złośliwe, czy też monitorowania i łagodzenia, że Ocena tych ciągów będzie powodować nadmierne użycie zasobów systemowych, należy wziąć pod uwagę Programiści aplikacji, którzy mają ciągi XSD, XPath lub XSLT z niezaufanych źródeł.</span><span class="sxs-lookup"><span data-stu-id="8641a-121">It's the responsibility of application programmers who take XSD, XPath, or XSLT strings from untrusted sources to validate that the strings aren't malicious, or to monitor and mitigate the possibility that evaluating these strings will lead to excessive system resource consumption.</span></span>
- <span data-ttu-id="8641a-122">Schematy XSD (w tym schematy wbudowane) są podatne na ataki typu "odmowa usługi"; nie należy akceptować schematów z niezaufanych źródeł.</span><span class="sxs-lookup"><span data-stu-id="8641a-122">XSD schemas (including inline schemas) are inherently vulnerable to denial of service attacks; you shouldn't accept schemas from untrusted sources.</span></span>
- <span data-ttu-id="8641a-123">XSD i XSLT mogą zawierać odwołania do innych plików, a takie odwołania mogą powodować ataki między strefami i między domenami.</span><span class="sxs-lookup"><span data-stu-id="8641a-123">XSD and XSLT can include references to other files, and such references can result in cross-zone and cross-domain attacks.</span></span>
- <span data-ttu-id="8641a-124">Jednostki zewnętrzne w elementach DTD mogą powodować ataki między strefami i między domenami.</span><span class="sxs-lookup"><span data-stu-id="8641a-124">External entities in DTDs can result in cross-zone and cross-domain attacks.</span></span>
- <span data-ttu-id="8641a-125">Definicje DTD są podatne na ataki typu "odmowa usługi".</span><span class="sxs-lookup"><span data-stu-id="8641a-125">DTDs are vulnerable to denial of service attacks.</span></span>
- <span data-ttu-id="8641a-126">Wyjątkowo głębokie dokumenty XML mogą powodować problemy z odmową usługi; może zajść potrzeba ograniczenia głębokości dokumentów XML.</span><span class="sxs-lookup"><span data-stu-id="8641a-126">Exceptionally deep XML documents can pose denial of service issues; you might want to limit the depth of XML documents.</span></span>
- <span data-ttu-id="8641a-127">Nie Akceptuj składników pomocniczych, takich jak <xref:System.Xml.NameTable> , <xref:System.Xml.XmlNamespaceManager> i <xref:System.Xml.XmlResolver> obiektów, z niezaufanych zestawów.</span><span class="sxs-lookup"><span data-stu-id="8641a-127">Don't accept supporting components, such as <xref:System.Xml.NameTable>, <xref:System.Xml.XmlNamespaceManager>, and <xref:System.Xml.XmlResolver> objects, from untrusted assemblies.</span></span>
- <span data-ttu-id="8641a-128">Odczytywanie danych w fragmentach w celu ograniczenia ataków na duże dokumenty.</span><span class="sxs-lookup"><span data-stu-id="8641a-128">Read data in chunks to mitigate large document attacks.</span></span>
- <span data-ttu-id="8641a-129">Bloki skryptów w arkuszach stylów XSLT mogą uwidaczniać wiele ataków.</span><span class="sxs-lookup"><span data-stu-id="8641a-129">Script blocks in XSLT style sheets can expose a number of attacks.</span></span>
- <span data-ttu-id="8641a-130">Uważnie sprawdzaj przed konstruowaniem dynamicznych wyrażeń XPath.</span><span class="sxs-lookup"><span data-stu-id="8641a-130">Validate carefully before constructing dynamic XPath expressions.</span></span>

## <a name="linq-to-xml-security-issues"></a><span data-ttu-id="8641a-131">LINQ to XML problemy z zabezpieczeniami</span><span class="sxs-lookup"><span data-stu-id="8641a-131">LINQ to XML security issues</span></span>

<span data-ttu-id="8641a-132">Problemy z bezpieczeństwem w tym artykule nie są wyświetlane w żadnej określonej kolejności.</span><span class="sxs-lookup"><span data-stu-id="8641a-132">The security issues in this article aren't presented in any particular order.</span></span> <span data-ttu-id="8641a-133">Wszystkie problemy są ważne i powinny być odpowiednio rozwiązane.</span><span class="sxs-lookup"><span data-stu-id="8641a-133">All issues are important and should be addressed as appropriate.</span></span>

<span data-ttu-id="8641a-134">Pomyślne podniesienie uprawnień ataku daje złośliwemu zestawowi większą kontrolę nad jego środowiskiem.</span><span class="sxs-lookup"><span data-stu-id="8641a-134">A successful elevation of privilege attack gives a malicious assembly more control over its environment.</span></span> <span data-ttu-id="8641a-135">Pomyślne podniesienie uprawnień ataku może spowodować ujawnienie danych, odmowa usługi i nie tylko.</span><span class="sxs-lookup"><span data-stu-id="8641a-135">A successful elevation of privilege attack can result in disclosure of data, denial of service, and more.</span></span>

<span data-ttu-id="8641a-136">Aplikacje nie powinny ujawniać danych użytkownikom, którzy nie mają uprawnień do wyświetlania tych danych.</span><span class="sxs-lookup"><span data-stu-id="8641a-136">Applications shouldn't disclose data to users who aren't authorized to see that data.</span></span>

<span data-ttu-id="8641a-137">Ataki typu "odmowa usługi" powodują, że analizator XML lub LINQ to XML zużywa nadmierne ilości pamięci lub czasu procesora CPU.</span><span class="sxs-lookup"><span data-stu-id="8641a-137">Denial of service attacks cause the XML parser or LINQ to XML to consume excessive amounts of memory or CPU time.</span></span> <span data-ttu-id="8641a-138">Ataki typu "odmowa usługi" są uważane za mniej surowe niż podniesienie uprawnień lub ujawnienie danych.</span><span class="sxs-lookup"><span data-stu-id="8641a-138">Denial of service attacks are considered to be less severe than elevation of privilege attacks or disclosure of data attacks.</span></span> <span data-ttu-id="8641a-139">Jednak są ważne w scenariuszu, w którym serwer musi przetwarzać dokumenty XML z niezaufanych źródeł.</span><span class="sxs-lookup"><span data-stu-id="8641a-139">However, they're important in a scenario where a server needs to process XML documents from untrusted sources.</span></span>

### <a name="dont-expose-error-messages-to-untrusted-callers"></a><span data-ttu-id="8641a-140">Nie ujawniaj komunikatów o błędach niezaufanym wywołującym</span><span class="sxs-lookup"><span data-stu-id="8641a-140">Don't expose error messages to untrusted callers</span></span>

<span data-ttu-id="8641a-141">Opis błędu może ujawnić dane, takie jak dane, które są przekształcane, nazwy plików lub szczegóły implementacji.</span><span class="sxs-lookup"><span data-stu-id="8641a-141">The description of an error might reveal data, such as the data being transformed, file names, or implementation details.</span></span> <span data-ttu-id="8641a-142">Komunikaty o błędach nie powinny być ujawnione dla wywołujących, które nie są zaufane.</span><span class="sxs-lookup"><span data-stu-id="8641a-142">Error messages shouldn't be exposed to callers that aren't trusted.</span></span> <span data-ttu-id="8641a-143">Należy wychwycić wszystkie błędy i zgłosić błędy przy użyciu własnych niestandardowych komunikatów o błędach.</span><span class="sxs-lookup"><span data-stu-id="8641a-143">You should catch all errors and report errors with your own custom error messages.</span></span>

### <a name="dont-call-codeaccesspermissionsassert-in-an-event-handler"></a><span data-ttu-id="8641a-144">Nie wywołuj metody CodeAccessPermissions. Assert w obsłudze zdarzeń</span><span class="sxs-lookup"><span data-stu-id="8641a-144">Don't call CodeAccessPermissions.Assert in an event handler</span></span>

<span data-ttu-id="8641a-145">Zestaw może mieć mniejsze lub większe uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="8641a-145">An assembly can have lesser or greater permissions.</span></span> <span data-ttu-id="8641a-146">Zestaw, który ma większe uprawnienia, ma większą kontrolę nad komputerem i jego środowiskami.</span><span class="sxs-lookup"><span data-stu-id="8641a-146">An assembly that has greater permissions has greater control over the computer and its environments.</span></span>

<span data-ttu-id="8641a-147">Jeśli kod w zestawie z większą liczbą uprawnień jest wywoływany <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> w programie obsługi zdarzeń, a następnie drzewo XML zostanie przesłane do złośliwego zestawu z ograniczonymi uprawnieniami, złośliwy zestaw może spowodować podniesienie poziomu zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="8641a-147">If code in an assembly with greater permissions calls <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> in an event handler, and then the XML tree is passed to a malicious assembly that has restricted permissions, the malicious assembly can cause an event to be raised.</span></span> <span data-ttu-id="8641a-148">Ponieważ zdarzenie uruchamia kod, który znajduje się w zestawie z większymi uprawnieniami, złośliwy zestaw będzie działać z podwyższonym poziomem uprawnień.</span><span class="sxs-lookup"><span data-stu-id="8641a-148">Because the event runs code that's in the assembly with greater permissions, the malicious assembly would then be operating with elevated privileges.</span></span>

<span data-ttu-id="8641a-149">Firma Microsoft zaleca, aby nie wywoływać <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> w programie obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="8641a-149">Microsoft recommends that you never call <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> in an event handler.</span></span>

### <a name="dont-accept-dtds-from-untrusted-sources"></a><span data-ttu-id="8641a-150">Nie Akceptuj elementów DTD z niezaufanych źródeł</span><span class="sxs-lookup"><span data-stu-id="8641a-150">Don't accept DTDs from untrusted sources</span></span>

<span data-ttu-id="8641a-151">Jednostki w elementach DTD są z natury niebezpieczne.</span><span class="sxs-lookup"><span data-stu-id="8641a-151">Entities in DTDs are inherently not secure.</span></span> <span data-ttu-id="8641a-152">Istnieje możliwość złośliwego dokumentu XML zawierającego DTD, który może spowodować, że analizator będzie używał całej pamięci i czasu procesora, powodując atak typu "odmowa usługi".</span><span class="sxs-lookup"><span data-stu-id="8641a-152">It's possible for a malicious XML document that contains a DTD to cause the parser to use all memory and CPU time, causing a denial of service attack.</span></span> <span data-ttu-id="8641a-153">W związku z tym w LINQ to XML przetwarzanie DTD jest domyślnie wyłączone.</span><span class="sxs-lookup"><span data-stu-id="8641a-153">Therefore, in LINQ to XML, DTD processing is turned off by default.</span></span> <span data-ttu-id="8641a-154">Nie należy akceptować elementów DTD z niezaufanych źródeł.</span><span class="sxs-lookup"><span data-stu-id="8641a-154">You shouldn't accept DTDs from untrusted sources.</span></span>

<span data-ttu-id="8641a-155">Przykładem akceptowania elementów DTD z niezaufanych źródeł jest aplikacja sieci Web, która umożliwia użytkownikom sieci Web przekazywanie pliku XML, który odwołuje się do pliku DTD i DTD.</span><span class="sxs-lookup"><span data-stu-id="8641a-155">One example of accepting DTDs from untrusted sources is a Web application that allows Web users to upload an XML file that references a DTD and a DTD file.</span></span> <span data-ttu-id="8641a-156">Po sprawdzeniu poprawności pliku złośliwy element DTD może wykonać atak typu "odmowa usługi" na serwerze.</span><span class="sxs-lookup"><span data-stu-id="8641a-156">Upon validation of the file, a malicious DTD could execute a denial of service attack on your server.</span></span> <span data-ttu-id="8641a-157">Innym przykładem akceptowania elementów DTD z niezaufanych źródeł jest odwołanie do elementu DTD w udziale sieciowym, który umożliwia także anonimowy dostęp do FTP.</span><span class="sxs-lookup"><span data-stu-id="8641a-157">Another example of accepting DTDs from untrusted sources is to reference a DTD on a network share that also allows anonymous FTP access.</span></span>

### <a name="avoid-excessive-buffer-allocation"></a><span data-ttu-id="8641a-158">Unikaj nadmiernej alokacji buforu</span><span class="sxs-lookup"><span data-stu-id="8641a-158">Avoid excessive buffer allocation</span></span>

<span data-ttu-id="8641a-159">Deweloperzy aplikacji powinni mieć świadomość, że wyjątkowo duże źródła danych mogą prowadzić do wyczerpania zasobów i ataków typu "odmowa usługi".</span><span class="sxs-lookup"><span data-stu-id="8641a-159">Application developers should be aware that extremely large data sources can lead to resource exhaustion and denial of service attacks.</span></span>

<span data-ttu-id="8641a-160">Jeśli złośliwy użytkownik przesyła lub przekaże bardzo duży dokument XML, może to spowodować, że LINQ to XML zużywa nadmierne zasoby systemowe.</span><span class="sxs-lookup"><span data-stu-id="8641a-160">If a malicious user submits or uploads a very large XML document, it could cause LINQ to XML to consume excessive system resources.</span></span> <span data-ttu-id="8641a-161">Może to stanowić atak typu "odmowa usługi".</span><span class="sxs-lookup"><span data-stu-id="8641a-161">This can constitute a denial of service attack.</span></span> <span data-ttu-id="8641a-162">Aby tego uniknąć, można ustawić <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> Właściwość i utworzyć czytnik, który jest następnie ograniczony w rozmiarze dokumentu, który może zostać załadowany.</span><span class="sxs-lookup"><span data-stu-id="8641a-162">To prevent this, you can set the <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> property, and create a reader that's then limited in the size of document that it can load.</span></span> <span data-ttu-id="8641a-163">Następnie należy użyć czytnika, aby utworzyć drzewo XML.</span><span class="sxs-lookup"><span data-stu-id="8641a-163">You then use the reader to create the XML tree.</span></span>

<span data-ttu-id="8641a-164">Na przykład jeśli wiesz, że maksymalny oczekiwany rozmiar dokumentów XML pochodzących z niezaufanego źródła będzie mniejszy niż 50 000 bajtów, ustaw wartość <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> na 100 000.</span><span class="sxs-lookup"><span data-stu-id="8641a-164">For example, if you know that the maximum expected size of your XML documents coming from an untrusted source will be less than 50K bytes, set <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> to 100,000.</span></span> <span data-ttu-id="8641a-165">Nie będzie to encumber przetwarzania dokumentów XML i w tym samym czasie będzie ograniczać zagrożenia odmowy usługi, w przypadku których można przekazać dokumenty, które mogą zużywać duże ilości pamięci.</span><span class="sxs-lookup"><span data-stu-id="8641a-165">This will not encumber your processing of XML documents, and at the same time it will mitigate denial of service threats where documents might be uploaded that would consume large amounts of memory.</span></span>

### <a name="avoid-excess-entity-expansion"></a><span data-ttu-id="8641a-166">Unikaj nadmiernego rozszerzania jednostek</span><span class="sxs-lookup"><span data-stu-id="8641a-166">Avoid excess entity expansion</span></span>

<span data-ttu-id="8641a-167">Jednym z znanych ataków typu "odmowa usługi" w przypadku korzystania z DTD jest dokument, który powoduje nadmierne rozwinięcie jednostek.</span><span class="sxs-lookup"><span data-stu-id="8641a-167">One of the known denial of service attacks when using a DTD is a document that causes excessive entity expansion.</span></span> <span data-ttu-id="8641a-168">Aby tego uniknąć, można ustawić <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> Właściwość i utworzyć czytnik, który jest następnie ograniczony w liczbie znaków będących wynikiem rozwinięcia jednostki.</span><span class="sxs-lookup"><span data-stu-id="8641a-168">To prevent this, you can set the <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> property, and create a reader that's then limited in the number of characters that result from entity expansion.</span></span> <span data-ttu-id="8641a-169">Następnie należy użyć czytnika, aby utworzyć drzewo XML.</span><span class="sxs-lookup"><span data-stu-id="8641a-169">You then use the reader to create the XML tree.</span></span>

### <a name="limit-the-depth-of-the-xml-hierarchy"></a><span data-ttu-id="8641a-170">Ograniczanie głębokości hierarchii XML</span><span class="sxs-lookup"><span data-stu-id="8641a-170">Limit the depth of the XML hierarchy</span></span>

<span data-ttu-id="8641a-171">Jednym z możliwych ataków typu "odmowa usługi" jest przesłanie dokumentu, który ma nadmierną Głębokość hierarchii.</span><span class="sxs-lookup"><span data-stu-id="8641a-171">One possible denial of service attack is when a document is submitted that has excessive depth of hierarchy.</span></span> <span data-ttu-id="8641a-172">Aby tego uniknąć, można otoczyć obiekt <xref:System.Xml.XmlReader> we własnej klasie, która zlicza elementy.</span><span class="sxs-lookup"><span data-stu-id="8641a-172">To prevent this, you can wrap an <xref:System.Xml.XmlReader> in your own class that counts the depth of elements.</span></span> <span data-ttu-id="8641a-173">Jeśli głębokość przekracza wstępnie określony poziom, można przerwać przetwarzanie złośliwego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="8641a-173">If the depth exceeds a predetermined reasonable level, you can terminate the processing of the malicious document.</span></span>

### <a name="protect-against-untrusted-xmlreader-or-xmlwriter-implementations"></a><span data-ttu-id="8641a-174">Ochrona przed niezaufanymi implementacjami elementu XmlReader lub XmlWriter</span><span class="sxs-lookup"><span data-stu-id="8641a-174">Protect against untrusted XmlReader or XmlWriter implementations</span></span>

<span data-ttu-id="8641a-175">Administratorzy powinni upewnić się, że wszystkie dostarczone zewnętrznie <xref:System.Xml.XmlReader> lub <xref:System.Xml.XmlWriter> implementacje mają silne nazwy i zostały zarejestrowane w konfiguracji maszyny.</span><span class="sxs-lookup"><span data-stu-id="8641a-175">Administrators should verify that any externally supplied <xref:System.Xml.XmlReader> or <xref:System.Xml.XmlWriter> implementations have strong names and have been registered in the machine configuration.</span></span> <span data-ttu-id="8641a-176">Zapobiega to załadowaniu złośliwego kodu jako czytnika lub składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="8641a-176">This prevents malicious code masquerading as a reader or writer from being loaded.</span></span>

### <a name="periodically-free-objects-that-reference-xname"></a><span data-ttu-id="8641a-177">Okresowe bezpłatne obiekty odwołujące się do XName</span><span class="sxs-lookup"><span data-stu-id="8641a-177">Periodically free objects that reference XName</span></span>

<span data-ttu-id="8641a-178">Aby chronić przed niektórymi atakami, programiści aplikacji powinny bezpłatnie zwolnić wszystkie obiekty, które odwołują się do <xref:System.Xml.Linq.XName> obiektu w domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8641a-178">To protect against certain kinds of attacks, application programmers should free all objects that reference an <xref:System.Xml.Linq.XName> object in the application domain on a regular basis.</span></span>

### <a name="protect-against-random-xml-names"></a><span data-ttu-id="8641a-179">Ochrona przed przypadkowymi nazwami XML</span><span class="sxs-lookup"><span data-stu-id="8641a-179">Protect against random XML names</span></span>

<span data-ttu-id="8641a-180">Aplikacje, które pobierają dane z niezaufanych źródeł, powinny rozważyć użycie <xref:System.Xml.XmlReader> zawiniętego w kodzie niestandardowym w celu sprawdzenia możliwości losowych nazw XML i przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="8641a-180">Applications that take data from untrusted sources should consider using an <xref:System.Xml.XmlReader> that's wrapped in custom code to inspect for the possibility of random XML names and namespaces.</span></span> <span data-ttu-id="8641a-181">Jeśli zostaną wykryte takie losowe nazwy XML i przestrzenie nazw, aplikacja będzie mogła przerwać przetwarzanie złośliwego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="8641a-181">If such random XML names and namespaces are detected, the application can then terminate the processing of the malicious document.</span></span>

<span data-ttu-id="8641a-182">Możesz chcieć ograniczyć liczbę nazw w danej przestrzeni nazw (łącznie z nazwami w obszarze brak przestrzeni nazw) do rozsądnego limitu.</span><span class="sxs-lookup"><span data-stu-id="8641a-182">You might want to limit the number of names in any given namespace (including names in no namespace) to a reasonable limit.</span></span>

### <a name="serialize-linq-to-xml-objects-to-xml-text-before-passing-the-data-to-an-untrusted-component"></a><span data-ttu-id="8641a-183">Serializacja LINQ to XML obiektów do tekstu XML przed przekazaniem danych do niezaufanego składnika</span><span class="sxs-lookup"><span data-stu-id="8641a-183">Serialize LINQ to XML objects to XML text before passing the data to an untrusted component</span></span>

<span data-ttu-id="8641a-184">LINQ to XML może służyć do tworzenia potoków przetwarzania, w których różne składniki aplikacji ładują, weryfikują, wykonują zapytania, Przekształć, aktualizują i zapisują dane XML przesyłane między składnikami jako drzewa XML.</span><span class="sxs-lookup"><span data-stu-id="8641a-184">LINQ to XML could be used to build processing pipelines in which different application components load, validate, query, transform, update, and save XML data that's passed between components as XML trees.</span></span> <span data-ttu-id="8641a-185">Może to pomóc zoptymalizować wydajność, ponieważ obciążenie związane z ładowaniem i serializowaniem obiektów do tekstu XML odbywa się tylko na końcach potoku.</span><span class="sxs-lookup"><span data-stu-id="8641a-185">This can help optimize performance, because the overhead of loading and serializing objects to XML text is done only at the ends of the pipeline.</span></span> <span data-ttu-id="8641a-186">Deweloperzy muszą mieć jednak świadomość, że wszystkie adnotacje i programy obsługi zdarzeń utworzone przez jeden składnik są dostępne dla innych składników.</span><span class="sxs-lookup"><span data-stu-id="8641a-186">Developers must be aware, however, that all annotations and event handlers created by one component are accessible to other components.</span></span> <span data-ttu-id="8641a-187">Może to spowodować powstanie kilku luk w zabezpieczeniach, jeśli składniki mają różne poziomy zaufania.</span><span class="sxs-lookup"><span data-stu-id="8641a-187">This can create a number of vulnerabilities if the components have different levels of trust.</span></span> <span data-ttu-id="8641a-188">Aby utworzyć bezpieczne potoki w mniej zaufanych składnikach, należy serializować LINQ to XML obiektów do tekstu XML przed przekazaniem danych do niezaufanego składnika.</span><span class="sxs-lookup"><span data-stu-id="8641a-188">To build secure pipelines across less trusted components, you must serialize LINQ to XML objects to XML text before passing the data to an untrusted component.</span></span>

<span data-ttu-id="8641a-189">Niektóre zabezpieczenia są udostępniane przez środowisko uruchomieniowe języka wspólnego (CLR).</span><span class="sxs-lookup"><span data-stu-id="8641a-189">Some security is provided by the common language runtime (CLR).</span></span> <span data-ttu-id="8641a-190">Na przykład, składnik, który nie zawiera klasy prywatnej, nie może uzyskać dostępu do adnotacji, które są określone przez tę klasę.</span><span class="sxs-lookup"><span data-stu-id="8641a-190">For example, a component that doesn't include a private class can't access annotations keyed by that class.</span></span> <span data-ttu-id="8641a-191">Jednakże adnotacje mogą być usuwane przez składniki, które nie mogą ich odczytać.</span><span class="sxs-lookup"><span data-stu-id="8641a-191">However, annotations can be deleted by components that can't read them.</span></span> <span data-ttu-id="8641a-192">Może to być przyczyną naruszenia ataku.</span><span class="sxs-lookup"><span data-stu-id="8641a-192">This could be used as a tampering attack.</span></span>

## <a name="see-also"></a><span data-ttu-id="8641a-193">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="8641a-193">See also</span></span>

- [<span data-ttu-id="8641a-194">Przegląd LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="8641a-194">LINQ to XML overview</span></span>](linq-xml-overview.md)
