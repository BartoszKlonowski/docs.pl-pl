---
title: Budowanie odpornej usługi gotowe do chmury. Dążenie przejściowych błędów w chmurze
description: Architektura Mikrousług .NET dla aplikacji .NET konteneryzowanych | Budowanie odpornej usługi gotowe do chmury. Dążenie przejściowych błędów w chmurze
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/26/2017
ms.prod: .net
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 0ac1d67a5b5b9a19f47c1d20eeb446977466510f
ms.sourcegitcommit: 2e8acae16ae802f2d6d04e3ce0a6dbf04e476513
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/18/2018
---
# <a name="build-resilient-services-ready-for-the-cloud-embrace-transient-failures-in-the-cloud"></a><span data-ttu-id="0d542-105">Budowanie odpornej usługi gotowe do chmury: dążenie przejściowych błędów w chmurze</span><span class="sxs-lookup"><span data-stu-id="0d542-105">Build resilient services ready for the cloud: Embrace transient failures in the cloud</span></span>

<span data-ttu-id="0d542-106">Odporność jest możliwość skutków błędów i kontynuować działanie.</span><span class="sxs-lookup"><span data-stu-id="0d542-106">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="0d542-107">Odporność nie jest o unikanie błędów, ale akceptowania fakt, że wystąpią błędy i następnie odpowiada na żądania je w taki sposób, który pozwala uniknąć przestoju lub utraty danych.</span><span class="sxs-lookup"><span data-stu-id="0d542-107">Resiliency is not about avoiding failures, but accepting the fact that failures will occur, and then responding to them in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="0d542-108">Celem odporności jest do zwrócenia aplikacji w pełni funkcjonalnej stan po awarii.</span><span class="sxs-lookup"><span data-stu-id="0d542-108">The goal of resiliency is to return the application to a fully functioning state after a failure.</span></span>

<span data-ttu-id="0d542-109">Aplikacja jest gotowa do chmury, gdy co najmniej implementuje model opartych na oprogramowaniu odporności, a nie w modelu oparte na sprzęcie.</span><span class="sxs-lookup"><span data-stu-id="0d542-109">Your application is ready for the cloud when, at a minimum, it implements a software-based model of resiliency, rather than a hardware-based model.</span></span> <span data-ttu-id="0d542-110">Aplikacji w chmurze musi obejmować częściowe błędów, które na pewno nastąpi.</span><span class="sxs-lookup"><span data-stu-id="0d542-110">Your cloud application must embrace the partial failures that will certainly occur.</span></span> <span data-ttu-id="0d542-111">Należy zaprojektować lub częściowo Refaktoryzuj aplikacji, jeśli chcesz uzyskać odporność na awarie częściowe oczekiwanego.</span><span class="sxs-lookup"><span data-stu-id="0d542-111">You need to design or partially refactor your application if you want to achieve resiliency to expected partial failures.</span></span> <span data-ttu-id="0d542-112">Powinny być zaprojektowane do radzenia sobie z częściowa błędami, takie jak awarie sieci i węzły lub awarii w chmurze maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="0d542-112">It should be designed to cope with partial failures, like transient network outages and nodes, or VMs crashing in the cloud.</span></span> <span data-ttu-id="0d542-113">Kontenery nawet przenoszony do innego węzła w klastrze orchestrator może spowodować krótkich błędami okresowymi w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0d542-113">Even containers being moved to a different node within an orchestrator cluster can cause intermittent short failures within the application.</span></span>

## <a name="handling-partial-failure"></a><span data-ttu-id="0d542-114">Obsługa częściowej awarii</span><span class="sxs-lookup"><span data-stu-id="0d542-114">Handling partial failure</span></span>

<span data-ttu-id="0d542-115">W aplikacji opartej na chmurze istnieje ryzyko wszechobecne częściowej awarii.</span><span class="sxs-lookup"><span data-stu-id="0d542-115">In a cloud-based application, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="0d542-116">Na przykład wystąpienie jedną witrynę sieci Web lub kontener może się nie powieść lub może być niedostępny lub nie odpowiada przez krótki czas.</span><span class="sxs-lookup"><span data-stu-id="0d542-116">For instance, a single website instance or a container might fail, or it might be unavailable or unresponsive for a short time.</span></span> <span data-ttu-id="0d542-117">Lub z jednej maszyny Wirtualnej lub serwerem mogą ulec awarii.</span><span class="sxs-lookup"><span data-stu-id="0d542-117">Or, a single VM or server might crash.</span></span>

<span data-ttu-id="0d542-118">Ponieważ klienci i usługi są osobne procesy, usługa nie może być stanie odpowiedzieć w odpowiednim czasie żądania klienta.</span><span class="sxs-lookup"><span data-stu-id="0d542-118">Because clients and services are separate processes, a service might not be able to respond in a timely manner to a client's request.</span></span> <span data-ttu-id="0d542-119">Usługa może być przeciążona i bardzo wolno odpowiadać na żądania lub ją po prostu nie mogą być niedostępne przez krótki czas z powodu problemów dotyczących sieci.</span><span class="sxs-lookup"><span data-stu-id="0d542-119">The service might be overloaded and respond extremely slowly to requests, or it might simply not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="0d542-120">Rozważmy na przykład wbudowanymi aplikacji .NET, który uzyskuje dostęp do bazy danych w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="0d542-120">For example, consider a monolithic .NET application that accesses a database in Azure SQL Database.</span></span> <span data-ttu-id="0d542-121">Jeśli baza danych Azure SQL lub innych usług innych firm nie odpowiada na krótki czas (bazy danych Azure SQL mogą być przeniesione do innego węzła lub serwera i nie odpowiadać przez kilka sekund), gdy użytkownik spróbuje wykonać żadnych działań, mogą ulec awarii aplikacji i Pokaż w wyjątek bardzo jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="0d542-121">If the Azure SQL database or any other third-party service is unresponsive for a brief time (an Azure SQL database might be moved to a different node or server, and be unresponsive for a few seconds), when the user tries to do any action, the application might crash and show an exception at the very same moment.</span></span>

<span data-ttu-id="0d542-122">Podobny scenariusz może wystąpić w aplikacji, która korzysta z usług HTTP.</span><span class="sxs-lookup"><span data-stu-id="0d542-122">A similar scenario might occur in an app that consumes HTTP services.</span></span> <span data-ttu-id="0d542-123">Sieci lub samej usługi mogą nie być dostępne w chmurze podczas krótkich, przejściowy błąd.</span><span class="sxs-lookup"><span data-stu-id="0d542-123">The network or the service itself might not be available in the cloud during a short, transient failure.</span></span>

<span data-ttu-id="0d542-124">Odporność aplikacji, tak jak pokazano w rysunek 4 — 9 należy zaimplementować technik, takich jak "ponawia próbę z wykładniczego wycofywania" w celu daje aplikacji możliwość obsługi błędów przejściowych w zasobach.</span><span class="sxs-lookup"><span data-stu-id="0d542-124">A resilient application like the one shown in Figure 4-9 should implement techniques like "retries with exponential backoff" to give the application an opportunity to handle transient failures in resources.</span></span> <span data-ttu-id="0d542-125">Należy również użyć "obwód podziałów" w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0d542-125">You also should use "circuit breakers" in your applications.</span></span> <span data-ttu-id="0d542-126">Wyłącznika zatrzymuje aplikacji próby uzyskania dostępu do zasobu, gdy jest rzeczywiście długotrwałą awarię.</span><span class="sxs-lookup"><span data-stu-id="0d542-126">A circuit breaker stops an application from trying to access a resource when it's actually a long-term failure.</span></span> <span data-ttu-id="0d542-127">Używając wyłącznika aplikacji pozwala uniknąć zdolnemu odmowa usługi do samej siebie.</span><span class="sxs-lookup"><span data-stu-id="0d542-127">By using a circuit breaker, the application avoids provoking a denial of service to itself.</span></span>

![Błędy częściowe obsługiwane przez liczbę ponownych prób z wykładniczego wycofywania](./media/image9.png)

> <span data-ttu-id="0d542-129">**Rysunek 4-9.**</span><span class="sxs-lookup"><span data-stu-id="0d542-129">**Figure 4-9.**</span></span> <span data-ttu-id="0d542-130">Błędy częściowe obsługiwane przez liczbę ponownych prób z wykładniczego wycofywania</span><span class="sxs-lookup"><span data-stu-id="0d542-130">Partial failures handled by retries with exponential backoff</span></span>

<span data-ttu-id="0d542-131">Te techniki można użyć zarówno w zasobach HTTP, jak i w bazie danych zasobów.</span><span class="sxs-lookup"><span data-stu-id="0d542-131">You can use these techniques both in HTTP resources and in database resources.</span></span> <span data-ttu-id="0d542-132">4 rysunek-9, aplikacja jest oparty na architekturze 3-warstwowej, więc należy te techniki na poziomie usługi (HTTP) i na poziomie warstwy danych (TCP).</span><span class="sxs-lookup"><span data-stu-id="0d542-132">In Figure 4-9, the application is based on a 3-tier architecture, so you need these techniques at the services level (HTTP) and at the data tier level (TCP).</span></span> <span data-ttu-id="0d542-133">W wbudowanymi aplikacji, która używa tylko jednej aplikacji warstwę oprócz bazy danych (nie dodatkowych usług lub mikrousług) Obsługa przejściowe błędy na poziomie połączenia bazy danych może być wystarczająca.</span><span class="sxs-lookup"><span data-stu-id="0d542-133">In a monolithic application that uses only a single app tier in addition to the database (no additional services or microservices), handling transient failures at the database connection level might be enough.</span></span> <span data-ttu-id="0d542-134">W takim scenariuszu zwykle określoną konfigurację połączenia bazy danych jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="0d542-134">In that scenario, usually just a particular configuration of the database connection is required.</span></span>

<span data-ttu-id="0d542-135">Podczas wdrażania dostępu do bazy danych, w zależności od wersji platformy .NET, używane są odporne komunikacji może być bardzo proste (na przykład [z programu Entity Framework 6 lub nowszym](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx), jest wystarczy Konfigurowanie połączenie z bazą danych).</span><span class="sxs-lookup"><span data-stu-id="0d542-135">When implementing resilient communications that access the database, depending on the version of .NET you are using, it can be very straightforward (for example, [with Entity Framework 6 or later](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx), it's just a matter of configuring the database connection).</span></span> <span data-ttu-id="0d542-136">Lub może być konieczne korzystać z dodatkowych bibliotek, takich jak [bloku aplikacji obsługi błędów przejściowych](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx) (w przypadku wcześniejszych wersji programu .NET) lub nawet wdrożenia własnej biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0d542-136">Or, you might need to use additional libraries like the [Transient Fault Handling Application Block](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx) (for earlier versions of .NET), or even implement your own library.</span></span>

<span data-ttu-id="0d542-137">Podczas implementowania ponownych prób HTTP i podziałów obwód, dla platformy .NET zaleca się użycie [Polly](https://github.com/App-vNext/Polly) biblioteki, która .NET 4.0, .NET 4.5 i .NET Standard 1.1, które obsługuje .NET Core.</span><span class="sxs-lookup"><span data-stu-id="0d542-137">When implementing HTTP retries and circuit breakers, the recommendation for .NET is to use the [Polly](https://github.com/App-vNext/Polly) library, which targets .NET 4.0, .NET 4.5, and .NET Standard 1.1, which includes .NET Core support.</span></span>

<span data-ttu-id="0d542-138">Informacje na temat wdrożenie strategii dotyczące postępowania z częściowa błędów w chmurze, zobacz następujące odwołania.</span><span class="sxs-lookup"><span data-stu-id="0d542-138">To learn how to implement strategies for handling partial failures in the cloud, see the following references.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="0d542-139">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="0d542-139">Additional resources</span></span>

-   <span data-ttu-id="0d542-140">**Implementowanie odporność komunikacji do obsługi błędów w częściowej**</span><span class="sxs-lookup"><span data-stu-id="0d542-140">**Implementing resilient communication to handle partial failure**</span></span>

    [https://docs.microsoft.com/dotnet/standard/microservices-architecture/implement-resilient-applications/partial-failure-strategies](../../microservices-architecture/implement-resilient-applications/partial-failure-strategies.md)

-   <span data-ttu-id="0d542-141">**Entity Framework połączenia odporności i spróbuj ponownie logiki (wersja 6 i nowsze)**</span><span class="sxs-lookup"><span data-stu-id="0d542-141">**Entity Framework connection resiliency and retry logic (version 6 and later)**</span></span>

    [https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx)

-   <span data-ttu-id="0d542-142">**W bloku aplikacji obsługi błędu przejściowego**</span><span class="sxs-lookup"><span data-stu-id="0d542-142">**The Transient Fault Handling Application Block**</span></span>

-   [https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx)

-   <span data-ttu-id="0d542-143">**Biblioteka Polly odporność komunikacji HTTP**</span><span class="sxs-lookup"><span data-stu-id="0d542-143">**Polly library for resilient HTTP communication**</span></span>

    https://github.com/App-vNext/Polly

>[!div class="step-by-step"]
<span data-ttu-id="0d542-144">[Poprzednie](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
[dalej](modernize-your-apps-with-monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="0d542-144">[Previous](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
[Next](modernize-your-apps-with-monitoring-and-telemetry.md)</span></span>
