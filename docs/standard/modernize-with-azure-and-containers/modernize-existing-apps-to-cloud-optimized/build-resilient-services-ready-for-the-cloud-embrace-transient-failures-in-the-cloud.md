---
title: Kompilowanie odpornych usług gotowych do chmury. Obsługa przejściowych błędów w chmurze
description: Modernizacja istniejących aplikacji .NET za pomocą kontenerów w chmurze platformy Azure i Windows | Kompilowanie odpornych usług gotowych do chmury. Obsługa przejściowych błędów w chmurze
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 04/30/2018
ms.openlocfilehash: 16228321cc788b381603513213130415eb73a95c
ms.sourcegitcommit: ccd8c36b0d74d99291d41aceb14cf98d74dc9d2b
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/10/2018
ms.locfileid: "53128859"
---
# <a name="build-resilient-services-ready-for-the-cloud-embrace-transient-failures-in-the-cloud"></a><span data-ttu-id="28cb5-105">Kompilowanie odpornych usług gotowych do chmury: Obsługa przejściowych błędów w chmurze</span><span class="sxs-lookup"><span data-stu-id="28cb5-105">Build resilient services ready for the cloud: Embrace transient failures in the cloud</span></span>

<span data-ttu-id="28cb5-106">Odporność to zdolność do odzyskiwania po awarii i kontynuowania działania.</span><span class="sxs-lookup"><span data-stu-id="28cb5-106">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="28cb5-107">Odporność to nie jest o unikanie błędów, ale akceptowanie fakt, że wystąpią błędy i następnie odpowiadać ich w sposób, który pozwala uniknąć przestoju lub utraty danych.</span><span class="sxs-lookup"><span data-stu-id="28cb5-107">Resiliency is not about avoiding failures, but accepting the fact that failures will occur, and then responding to them in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="28cb5-108">Celem odporności jest przywrócenie aplikacji do stanu pełnej funkcjonalności po wystąpieniu awarii.</span><span class="sxs-lookup"><span data-stu-id="28cb5-108">The goal of resiliency is to return the application to a fully functioning state after a failure.</span></span>

<span data-ttu-id="28cb5-109">Aplikacja jest gotowa dla chmury, gdy co najmniej implementuje model oparty na oprogramowaniu odporności, a nie modelu oparte na sprzęcie.</span><span class="sxs-lookup"><span data-stu-id="28cb5-109">Your application is ready for the cloud when, at a minimum, it implements a software-based model of resiliency, rather than a hardware-based model.</span></span> <span data-ttu-id="28cb5-110">Aplikacja w chmurze musi wykorzystywać częściowe błędy, które na pewno zostanie przeprowadzona.</span><span class="sxs-lookup"><span data-stu-id="28cb5-110">Your cloud application must embrace the partial failures that will certainly occur.</span></span> <span data-ttu-id="28cb5-111">Projektujesz lub częściowo refaktoryzacji aplikacji umożliwiającego osiągnięcie odporności, z błędami częściowe oczekiwane.</span><span class="sxs-lookup"><span data-stu-id="28cb5-111">Design or partially refactor your application to achieve resiliency with expected partial failures.</span></span> <span data-ttu-id="28cb5-112">Powinny zostać tak zaprojektowane do radzenia sobie z błędami częściowych, takich jak awarie przejściowe problemy z siecią i węzłów lub awarii w chmurze maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="28cb5-112">It should be designed to cope with partial failures, like transient network outages and nodes, or VMs crashing in the cloud.</span></span> <span data-ttu-id="28cb5-113">Nawet kontenerów jest przenoszony do innego węzła w klastrze usługi orchestrator może powodować sporadyczne błędy krótki w ramach aplikacji.</span><span class="sxs-lookup"><span data-stu-id="28cb5-113">Even containers being moved to a different node within an orchestrator cluster can cause intermittent short failures within the application.</span></span>

## <a name="handling-partial-failure"></a><span data-ttu-id="28cb5-114">Obsługa częściowych niepowodzeń</span><span class="sxs-lookup"><span data-stu-id="28cb5-114">Handling partial failure</span></span>

<span data-ttu-id="28cb5-115">W aplikacji opartej na chmurze istnieje ryzyko wszechobecnym częściowych niepowodzeń.</span><span class="sxs-lookup"><span data-stu-id="28cb5-115">In a cloud-based application, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="28cb5-116">Na przykład wystąpienie jedną witrynę sieci Web lub kontener może się nie powieść lub może być niedostępny lub nie odpowiada przez krótki czas.</span><span class="sxs-lookup"><span data-stu-id="28cb5-116">For instance, a single website instance or a container might fail, or it might be unavailable or unresponsive for a short time.</span></span> <span data-ttu-id="28cb5-117">Lub pojedynczej maszyny Wirtualnej lub serwera mógł ulec awarii.</span><span class="sxs-lookup"><span data-stu-id="28cb5-117">Or, a single VM or server might crash.</span></span>

<span data-ttu-id="28cb5-118">Ponieważ klientów i usług są oddzielne procesy, usługi może nie móc reagować w odpowiednim czasie na żądanie klienta.</span><span class="sxs-lookup"><span data-stu-id="28cb5-118">Because clients and services are separate processes, a service might not be able to respond in a timely manner to a client's request.</span></span> <span data-ttu-id="28cb5-119">Usługa może być przeciążona i wolniej odpowiadał na żądania lub może nie być dostępne przez krótki czas ze względu na problemy z siecią.</span><span class="sxs-lookup"><span data-stu-id="28cb5-119">The service might be overloaded and respond slowly to requests, or it might not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="28cb5-120">Na przykład należy wziąć pod uwagę monolitycznych .NET, który uzyskuje dostęp do bazy danych w usłudze Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="28cb5-120">For example, consider a monolithic .NET application that accesses a database in Azure SQL Database.</span></span> <span data-ttu-id="28cb5-121">Jeśli baza danych Azure SQL lub dowolnej innej usługi innych firm nie odpowiada na krótki czas (Azure SQL database może być przeniesiony do innego węzła lub serwera i nie odpowiadać przez kilka sekund), gdy użytkownik próbuje wykonać żadnych działań, aplikacja może ulec awarii i Pokaż w wyjątku, w tym momencie.</span><span class="sxs-lookup"><span data-stu-id="28cb5-121">If the Azure SQL database or any other third-party service is unresponsive for a brief time (an Azure SQL database might be moved to a different node or server, and be unresponsive for a few seconds), when the user tries to do any action, the application might crash and show an exception at the same moment.</span></span>

<span data-ttu-id="28cb5-122">Podobny scenariusz może wystąpić w aplikacji, która korzysta z usług HTTP.</span><span class="sxs-lookup"><span data-stu-id="28cb5-122">A similar scenario might occur in an app that consumes HTTP services.</span></span> <span data-ttu-id="28cb5-123">Sieci lub samej usługi mogą nie być dostępne w chmurze podczas krótkich, przejściowy błąd.</span><span class="sxs-lookup"><span data-stu-id="28cb5-123">The network or the service itself might not be available in the cloud during a short, transient failure.</span></span>

<span data-ttu-id="28cb5-124">Odporna aplikacja jest podobny do przedstawionego w rysunek 4 – 9, powinny implementować technik, takich jak "ponawiają próby z wykorzystaniem wykładniczego wycofywania", aby umożliwić aplikacji do obsługi błędów przejściowych w zasobach.</span><span class="sxs-lookup"><span data-stu-id="28cb5-124">A resilient application like the one shown in Figure 4-9 should implement techniques like "retries with exponential backoff" to give the application an opportunity to handle transient failures in resources.</span></span> <span data-ttu-id="28cb5-125">Należy również użyć "wyłączniki" w swoich aplikacjach.</span><span class="sxs-lookup"><span data-stu-id="28cb5-125">You also should use "circuit breakers" in your applications.</span></span> <span data-ttu-id="28cb5-126">Wyłącznik zatrzymuje aplikację z próby uzyskania dostępu do zasobu, gdy jest ona rzeczywiście długotrwałą awarię.</span><span class="sxs-lookup"><span data-stu-id="28cb5-126">A circuit breaker stops an application from trying to access a resource when it's actually a long-term failure.</span></span> <span data-ttu-id="28cb5-127">Przy użyciu wyłącznika, aplikacji pozwala uniknąć zdolnemu odmowa usługi dla samej siebie.</span><span class="sxs-lookup"><span data-stu-id="28cb5-127">By using a circuit breaker, the application avoids provoking a denial of service to itself.</span></span>

![Błędy częściowe obsługiwane przez ponawiają próby z wykorzystaniem wykładniczego wycofywania](./media/image9.png)

> <span data-ttu-id="28cb5-129">**Rysunek 4 – 9.**</span><span class="sxs-lookup"><span data-stu-id="28cb5-129">**Figure 4-9.**</span></span> <span data-ttu-id="28cb5-130">Błędy częściowe obsługiwane przez ponawiają próby z wykorzystaniem wykładniczego wycofywania</span><span class="sxs-lookup"><span data-stu-id="28cb5-130">Partial failures handled by retries with exponential backoff</span></span>

<span data-ttu-id="28cb5-131">Można użyć tych technik, zarówno w zasobach HTTP, jak i zasobów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="28cb5-131">You can use these techniques both in HTTP resources and in database resources.</span></span> <span data-ttu-id="28cb5-132">W rysunek 4 – 9, aplikacja opiera się na architekturze 3-warstwowej, więc należy tych technik na poziomie usług (HTTP) i na poziomie warstwy danych (TCP).</span><span class="sxs-lookup"><span data-stu-id="28cb5-132">In Figure 4-9, the application is based on a 3-tier architecture, so you need these techniques at the services level (HTTP) and at the data tier level (TCP).</span></span> <span data-ttu-id="28cb5-133">W aplikacji monolitycznej, który używa tylko jednej aplikacji warstwy oprócz bazy danych (nie dodatkowych usług lub mikrousług) Obsługa błędów przejściowych na poziomie połączenia bazy danych może być wystarczająca.</span><span class="sxs-lookup"><span data-stu-id="28cb5-133">In a monolithic application that uses only a single app tier in addition to the database (no additional services or microservices), handling transient failures at the database connection level might be enough.</span></span> <span data-ttu-id="28cb5-134">W tym scenariuszu szczególną konfigurację połączenia z bazą danych jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="28cb5-134">In that scenario, just a particular configuration of the database connection is required.</span></span>

<span data-ttu-id="28cb5-135">Podczas implementowania odporne na błędy wiadomości, do których dostęp do bazy danych, w zależności od wersji programu .NET, którego używasz, może być prosta (na przykład [przy użyciu platformy Entity Framework 6 lub nowszym](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx), jest to kwestia konfigurowania połączenie z bazą danych).</span><span class="sxs-lookup"><span data-stu-id="28cb5-135">When implementing resilient communications that access the database, depending on the version of .NET you are using, it can be straightforward (for example, [with Entity Framework 6 or later](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx), it's just a matter of configuring the database connection).</span></span> <span data-ttu-id="28cb5-136">Lub może być konieczne użycie dodatkowych bibliotek, takich jak [blok aplikacji obsługi błędów przejściowych](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx) (w przypadku wcześniejszych wersji programu .NET), lub nawet implementować własne biblioteki.</span><span class="sxs-lookup"><span data-stu-id="28cb5-136">Or, you might need to use additional libraries like the [Transient Fault Handling Application Block](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx) (for earlier versions of .NET), or even implement your own library.</span></span>

<span data-ttu-id="28cb5-137">Podczas implementowania ponownych prób HTTP i wyłączniki, zalecenie dla platformy .NET jest użycie [Polly](https://github.com/App-vNext/Polly) biblioteki, która jest przeznaczony dla .NET Framework 4.0, .NET Framework 4.5 i .NET Standard 1.1, które obsługuje platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="28cb5-137">When implementing HTTP retries and circuit breakers, the recommendation for .NET is to use the [Polly](https://github.com/App-vNext/Polly) library, which targets .NET Framework 4.0, .NET Framework 4.5, and .NET Standard 1.1, which includes .NET Core support.</span></span>

<span data-ttu-id="28cb5-138">Aby dowiedzieć się, jak zaimplementować strategie dotyczące obsługi częściowych niepowodzeń w chmurze, zobacz następujące odwołania.</span><span class="sxs-lookup"><span data-stu-id="28cb5-138">To learn how to implement strategies for handling partial failures in the cloud, see the following references.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="28cb5-139">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="28cb5-139">Additional resources</span></span>

-   <span data-ttu-id="28cb5-140">**Implementowanie odpornych na błędy komunikacji do obsługi częściowych niepowodzeń**</span><span class="sxs-lookup"><span data-stu-id="28cb5-140">**Implementing resilient communication to handle partial failure**</span></span>

    [https://docs.microsoft.com/dotnet/standard/microservices-architecture/implement-resilient-applications/partial-failure-strategies](../../microservices-architecture/implement-resilient-applications/partial-failure-strategies.md)

-   <span data-ttu-id="28cb5-141">**Entity Framework odporności, a następnie spróbuj ponownie logika połączenia (w wersji 6 i nowsze)**</span><span class="sxs-lookup"><span data-stu-id="28cb5-141">**Entity Framework connection resiliency and retry logic (version 6 and later)**</span></span>

    [https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx](https://msdn.microsoft.com/library/dn456835(v=vs.113).aspx)

-   <span data-ttu-id="28cb5-142">**Blok obsługi błędów przejściowych w aplikacji**</span><span class="sxs-lookup"><span data-stu-id="28cb5-142">**The Transient Fault Handling Application Block**</span></span>

-   [https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx](https://msdn.microsoft.com/library/hh680934(v=pandp.50).aspx)

-   <span data-ttu-id="28cb5-143">**Biblioteki Polly odporne na błędy komunikacji HTTP**</span><span class="sxs-lookup"><span data-stu-id="28cb5-143">**Polly library for resilient HTTP communication**</span></span>

    https://github.com/App-vNext/Polly

>[!div class="step-by-step"]
><span data-ttu-id="28cb5-144">[Poprzednie](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
>[dalej](modernize-your-apps-with-monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="28cb5-144">[Previous](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
[Next](modernize-your-apps-with-monitoring-and-telemetry.md)</span></span>