---
title: Opcje scalania w PLINQ
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- PLINQ queries, merge options
ms.assetid: e8f7be3b-88de-4f33-ab14-dc008e76c1ba
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 7255ef11bfdf74afa6ae2032b0c86c8c44dbfe7d
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/28/2019
ms.locfileid: "64647726"
---
# <a name="merge-options-in-plinq"></a><span data-ttu-id="13f0f-102">Opcje scalania w PLINQ</span><span class="sxs-lookup"><span data-stu-id="13f0f-102">Merge Options in PLINQ</span></span>
<span data-ttu-id="13f0f-103">Gdy zapytanie jest wykonywany jako równoległego, PLINQ partycje sekwencji źródłowej wiele wątków może pracować na różnych częściach współbieżnie, zazwyczaj w oddzielnych wątkach.</span><span class="sxs-lookup"><span data-stu-id="13f0f-103">When a query is executing as parallel, PLINQ partitions the source sequence so that multiple threads can work on different parts concurrently, typically on separate threads.</span></span> <span data-ttu-id="13f0f-104">Jeśli wyniki mają być używane w jednym wątku, na przykład w `foreach` (`For Each` w języku Visual Basic) w pętli, a następnie wyniki z każdego wątku muszą być scalone jednej sekwencji.</span><span class="sxs-lookup"><span data-stu-id="13f0f-104">If the results are to be consumed on one thread, for example, in a `foreach` (`For Each` in Visual Basic) loop, then the results from every thread must be merged back into one sequence.</span></span> <span data-ttu-id="13f0f-105">Rodzaj scalania, który wykonuje PLINQ jest zależna od operatorów, które są obecne w zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="13f0f-105">The kind of merge that PLINQ performs depends on the operators that are present in the query.</span></span> <span data-ttu-id="13f0f-106">Na przykład operatory, które nakładają nowe zamówienie na wynikach musi buforu wszystkie elementy ze wszystkich wątków.</span><span class="sxs-lookup"><span data-stu-id="13f0f-106">For example, operators that impose a new order on the results must buffer all elements from all threads.</span></span> <span data-ttu-id="13f0f-107">Z punktu widzenia zużywającym wątku (jest to również w przypadku użytkowników aplikacji) pełni buforowane zapytanie może działać zauważalne okres czasu, tworzy jej pierwszego wyniku.</span><span class="sxs-lookup"><span data-stu-id="13f0f-107">From the perspective of the consuming thread (which is also that of the application user) a fully buffered query might run for a noticeable period of time before it produces its first result.</span></span> <span data-ttu-id="13f0f-108">Inne operatory domyślnie są częściowo buforowane; dają one ich wyniki w partiach.</span><span class="sxs-lookup"><span data-stu-id="13f0f-108">Other operators, by default, are partially buffered; they yield their results in batches.</span></span> <span data-ttu-id="13f0f-109">Jeden operator <xref:System.Linq.ParallelEnumerable.ForAll%2A> nie jest buforowana domyślnie.</span><span class="sxs-lookup"><span data-stu-id="13f0f-109">One operator, <xref:System.Linq.ParallelEnumerable.ForAll%2A> is not buffered by default.</span></span> <span data-ttu-id="13f0f-110">Natychmiast daje wszystkie elementy ze wszystkich wątków.</span><span class="sxs-lookup"><span data-stu-id="13f0f-110">It yields all elements from all threads immediately.</span></span>  
  
 <span data-ttu-id="13f0f-111">Za pomocą <xref:System.Linq.ParallelEnumerable.WithMergeOptions%2A> metody, jak pokazano w poniższym przykładzie, można udostępnić wskazówki PLINQ, która wskazuje, jakiego rodzaju scalania do wykonywania.</span><span class="sxs-lookup"><span data-stu-id="13f0f-111">By using the <xref:System.Linq.ParallelEnumerable.WithMergeOptions%2A> method, as shown in the following example, you can provide a hint to PLINQ that indicates what kind of merging to perform.</span></span>  
  
 [!code-csharp[PLINQ#26](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#26)]
 [!code-vb[PLINQ#26](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinq2_vb.vb#26)]  
  
 <span data-ttu-id="13f0f-112">Aby uzyskać kompletny przykład, zobacz [jak: Określanie opcji scalania w PLINQ](../../../docs/standard/parallel-programming/how-to-specify-merge-options-in-plinq.md).</span><span class="sxs-lookup"><span data-stu-id="13f0f-112">For the complete example, see [How to: Specify Merge Options in PLINQ](../../../docs/standard/parallel-programming/how-to-specify-merge-options-in-plinq.md).</span></span>  
  
 <span data-ttu-id="13f0f-113">Jeśli określone zapytanie nie obsługuje żądanej opcji, następnie opcję zostanie zignorowane.</span><span class="sxs-lookup"><span data-stu-id="13f0f-113">If the particular query cannot support the requested option, then the option will just be ignored.</span></span> <span data-ttu-id="13f0f-114">W większości przypadków jest konieczne określanie opcji scalania dla zapytania PLINQ.</span><span class="sxs-lookup"><span data-stu-id="13f0f-114">In most cases, you do not have to specify a merge option for a PLINQ query.</span></span> <span data-ttu-id="13f0f-115">Jednak w niektórych przypadkach może się okazać przez testom i pomiarom wykonujący zapytanie najlepiej w trybie innych niż domyślne.</span><span class="sxs-lookup"><span data-stu-id="13f0f-115">However, in some cases you may find by testing and measurement that a query executes best in a non-default mode.</span></span> <span data-ttu-id="13f0f-116">Wspólne użycie tej opcji jest wymuszenie operatorem scalanie fragmentu do przesyłania strumieniowego jego wyniki w celu zapewnienia zwiększyć szybkość reakcji interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="13f0f-116">A common use of this option is to force a chunk-merging operator to stream its results in order to provide a more responsive user interface.</span></span>  
  
## <a name="parallelmergeoptions"></a><span data-ttu-id="13f0f-117">ParallelMergeOptions</span><span class="sxs-lookup"><span data-stu-id="13f0f-117">ParallelMergeOptions</span></span>  
 <span data-ttu-id="13f0f-118"><xref:System.Linq.ParallelMergeOptions> Wyliczenie zawiera następujące opcje, które określają kształtów obsługiwane zapytania, jak uzyskane jest końcowych danych wyjściowych zapytania, gdy wyniki są używane w jednym wątku:</span><span class="sxs-lookup"><span data-stu-id="13f0f-118">The <xref:System.Linq.ParallelMergeOptions> enumeration includes the following options that specify, for supported query shapes, how the final output of the query is yielded when the results are consumed on one thread:</span></span>  
  
- `Not Buffered`  
  
     <span data-ttu-id="13f0f-119"><xref:System.Linq.ParallelMergeOptions.NotBuffered> Opcja powoduje, że każdy element przetwarzania będą zwracane z każdego wątku, tak szybko, jak są wytwarzane.</span><span class="sxs-lookup"><span data-stu-id="13f0f-119">The <xref:System.Linq.ParallelMergeOptions.NotBuffered> option causes each processed element to be returned from each thread as soon as it is produced.</span></span> <span data-ttu-id="13f0f-120">To zachowanie jest odpowiednikiem "przesyłanie strumieniowe" dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="13f0f-120">This behavior is analogous to "streaming" the output.</span></span> <span data-ttu-id="13f0f-121">Jeśli <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> operator jest obecne w zapytaniu `NotBuffered` zachowuje kolejność elementów źródła.</span><span class="sxs-lookup"><span data-stu-id="13f0f-121">If the <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> operator is present in the query, `NotBuffered` preserves the order of the source elements.</span></span> <span data-ttu-id="13f0f-122">Mimo że `NotBuffered` rozpoczyna się reaguje wyniki, jak są one dostępne, całkowity czas, aby wygenerować wszystkie wyniki mogą nadal być dłuższa niż przy użyciu jednej z innych opcji scalania.</span><span class="sxs-lookup"><span data-stu-id="13f0f-122">Although `NotBuffered` starts yielding results as soon as they're available,, the total time to produce all the results might still be longer than using one of the other merge options.</span></span>  
  
- `Auto Buffered`  
  
     <span data-ttu-id="13f0f-123"><xref:System.Linq.ParallelMergeOptions.AutoBuffered> Opcja powoduje, że zapytanie, aby zebrać elementy do buforu i okresowo uzyskanie zawartość buforu w całości zużywającym wątku.</span><span class="sxs-lookup"><span data-stu-id="13f0f-123">The <xref:System.Linq.ParallelMergeOptions.AutoBuffered> option causes the query to collect elements into a buffer and then periodically yield the buffer contents all at once to the consuming thread.</span></span> <span data-ttu-id="13f0f-124">Jest to analogiczne do otrzymania danych źródłowych w "fragmentów" zamiast "przesyłania strumieniowego" zachowanie `NotBuffered`.</span><span class="sxs-lookup"><span data-stu-id="13f0f-124">This is analogous to yielding the source data in "chunks" instead of using the "streaming" behavior of `NotBuffered`.</span></span> <span data-ttu-id="13f0f-125">`AutoBuffered` może to trwać dłużej niż `NotBuffered` udostępnić pierwszego elementu w zużywającym wątku.</span><span class="sxs-lookup"><span data-stu-id="13f0f-125">`AutoBuffered` may take longer than `NotBuffered` to make the first element available on the consuming thread.</span></span> <span data-ttu-id="13f0f-126">Rozmiar buforu i dokładne zachowanie otrzymania nie są konfigurowalne i mogą się różnić, w zależności od różnych czynników, które odnoszą się do zapytania.</span><span class="sxs-lookup"><span data-stu-id="13f0f-126">The size of the buffer and the exact yielding behavior are not configurable and may vary, depending on various factors that relate to the query.</span></span>  
  
- `FullyBuffered`  
  
     <span data-ttu-id="13f0f-127"><xref:System.Linq.ParallelMergeOptions.FullyBuffered> Opcja powoduje, że całe zapytanie, aby być buforowane, przed dowolne elementy są uzyskane dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="13f0f-127">The <xref:System.Linq.ParallelMergeOptions.FullyBuffered> option causes the output of the whole query to be buffered before any of the elements are yielded.</span></span> <span data-ttu-id="13f0f-128">Gdy używasz tej opcji, może to trwać dłużej przed pierwszym elementem jest dostępna w zużywającym wątku, ale pełnych wyników może być jeszcze przedstawiony szybciej niż przy użyciu innych opcji.</span><span class="sxs-lookup"><span data-stu-id="13f0f-128">When you use this option, it can take longer before the first element is available on the consuming thread, but the complete results might still be produced faster than by using the other options.</span></span>  
  
## <a name="query-operators-that-support-merge-options"></a><span data-ttu-id="13f0f-129">Operatory zapytań, które obsługują opcje scalania</span><span class="sxs-lookup"><span data-stu-id="13f0f-129">Query Operators that Support Merge Options</span></span>  
 <span data-ttu-id="13f0f-130">W poniższej tabeli wymieniono operatory, które obsługują wszystkie tryby opcja scalania, ograniczeniom określony.</span><span class="sxs-lookup"><span data-stu-id="13f0f-130">The following table lists the operators that support all merge option modes, subject to the specified restrictions.</span></span>  
  
|<span data-ttu-id="13f0f-131">Operator</span><span class="sxs-lookup"><span data-stu-id="13f0f-131">Operator</span></span>|<span data-ttu-id="13f0f-132">Ograniczenia</span><span class="sxs-lookup"><span data-stu-id="13f0f-132">Restrictions</span></span>|  
|--------------|------------------|  
|<xref:System.Linq.ParallelEnumerable.AsEnumerable%2A>|<span data-ttu-id="13f0f-133">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-133">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Cast%2A>|<span data-ttu-id="13f0f-134">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-134">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Concat%2A>|<span data-ttu-id="13f0f-135">Uporządkowane inne niż zapytania, które mają tablicy lub listy tylko źródłowe.</span><span class="sxs-lookup"><span data-stu-id="13f0f-135">Non-ordered queries that have an Array or List source only.</span></span>|  
|<xref:System.Linq.ParallelEnumerable.DefaultIfEmpty%2A>|<span data-ttu-id="13f0f-136">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-136">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.OfType%2A>|<span data-ttu-id="13f0f-137">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-137">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Reverse%2A>|<span data-ttu-id="13f0f-138">Uporządkowane inne niż zapytania, które mają tablicy lub listy tylko źródłowe.</span><span class="sxs-lookup"><span data-stu-id="13f0f-138">Non-ordered queries that have an Array or List source only.</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Select%2A>|<span data-ttu-id="13f0f-139">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-139">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.SelectMany%2A>|<span data-ttu-id="13f0f-140">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-140">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Skip%2A>|<span data-ttu-id="13f0f-141">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-141">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Take%2A>|<span data-ttu-id="13f0f-142">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-142">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Where%2A>|<span data-ttu-id="13f0f-143">Brak</span><span class="sxs-lookup"><span data-stu-id="13f0f-143">None</span></span>|  
  
 <span data-ttu-id="13f0f-144">Wszystkie inne operatory zapytań PLINQ może zignorować opcji scalania podanego przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="13f0f-144">All other PLINQ query operators might ignore user-provided merge options.</span></span> <span data-ttu-id="13f0f-145">Niektóre zapytania operatorów, na przykład <xref:System.Linq.ParallelEnumerable.Reverse%2A> i <xref:System.Linq.ParallelEnumerable.OrderBy%2A>, nie można przekazywać dowolne elementy, dopóki wszystkie utworzone i zmieniana.</span><span class="sxs-lookup"><span data-stu-id="13f0f-145">Some query operators, for example, <xref:System.Linq.ParallelEnumerable.Reverse%2A> and <xref:System.Linq.ParallelEnumerable.OrderBy%2A>, cannot yield any elements until all have been produced and reordered.</span></span> <span data-ttu-id="13f0f-146">W związku z tym, kiedy <xref:System.Linq.ParallelMergeOptions> jest używany w zapytaniu, które również zawiera takie jak operator <xref:System.Linq.ParallelEnumerable.Reverse%2A>, zachowanie scalania nie będą stosowane w zapytaniu do czasu, po tego operatora tworzył wyniki.</span><span class="sxs-lookup"><span data-stu-id="13f0f-146">Therefore, when <xref:System.Linq.ParallelMergeOptions> is used in a query that also contains an operator such as <xref:System.Linq.ParallelEnumerable.Reverse%2A>, the merge behavior will not be applied in the query until after that operator has produced its results.</span></span>  
  
 <span data-ttu-id="13f0f-147">Niektóre operatory możliwość obsługi opcji scalania zależy od typu sekwencji źródłowej i czy <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> operator zostało użyte we wcześniejszej części zapytania.</span><span class="sxs-lookup"><span data-stu-id="13f0f-147">The ability of some operators to handle merge options depends on the type of the source sequence, and whether the <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> operator was used earlier in the query.</span></span> <span data-ttu-id="13f0f-148"><xref:System.Linq.ParallelEnumerable.ForAll%2A> jest zawsze <xref:System.Linq.ParallelMergeOptions.NotBuffered> ; daje jego elementy natychmiast.</span><span class="sxs-lookup"><span data-stu-id="13f0f-148"><xref:System.Linq.ParallelEnumerable.ForAll%2A> is always <xref:System.Linq.ParallelMergeOptions.NotBuffered> ; it yields its elements immediately.</span></span> <span data-ttu-id="13f0f-149"><xref:System.Linq.ParallelEnumerable.OrderBy%2A> jest zawsze <xref:System.Linq.ParallelMergeOptions.FullyBuffered>; należy sortować całą listę, przed jego daje.</span><span class="sxs-lookup"><span data-stu-id="13f0f-149"><xref:System.Linq.ParallelEnumerable.OrderBy%2A> is always <xref:System.Linq.ParallelMergeOptions.FullyBuffered>; it must sort the whole list before it yields.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="13f0f-150">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="13f0f-150">See also</span></span>

- [<span data-ttu-id="13f0f-151">Równoległe LINQ (PLINQ)</span><span class="sxs-lookup"><span data-stu-id="13f0f-151">Parallel LINQ (PLINQ)</span></span>](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)
- [<span data-ttu-id="13f0f-152">Instrukcje: Określanie opcji scalania w PLINQ</span><span class="sxs-lookup"><span data-stu-id="13f0f-152">How to: Specify Merge Options in PLINQ</span></span>](../../../docs/standard/parallel-programming/how-to-specify-merge-options-in-plinq.md)
