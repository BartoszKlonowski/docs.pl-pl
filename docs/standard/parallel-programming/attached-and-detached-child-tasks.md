---
title: Dołączone i odłączone zadania podrzędne
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- tasks, child tasks
ms.assetid: c95788bf-90a6-4e96-b7bc-58e36a228cc5
ms.openlocfilehash: 3b9bc2a854dfdee724c2059b3298b67da799284b
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/24/2020
ms.locfileid: "95734299"
---
# <a name="attached-and-detached-child-tasks"></a><span data-ttu-id="e8a73-102">Dołączone i odłączone zadania podrzędne</span><span class="sxs-lookup"><span data-stu-id="e8a73-102">Attached and Detached Child Tasks</span></span>

<span data-ttu-id="e8a73-103">*Zadanie podrzędne* (lub *zadanie zagnieżdżone*) jest <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> wystąpieniem, które jest tworzone w delegatze użytkownika innego zadania, który jest znany jako *zadanie nadrzędne*.</span><span class="sxs-lookup"><span data-stu-id="e8a73-103">A *child task* (or *nested task*) is a <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> instance that is created in the user delegate of another task, which is known as the *parent task*.</span></span> <span data-ttu-id="e8a73-104">Zadanie podrzędne może być odłączone lub dołączone.</span><span class="sxs-lookup"><span data-stu-id="e8a73-104">A child task can be either detached or attached.</span></span> <span data-ttu-id="e8a73-105">*Odłączone zadanie podrzędne* to zadanie, które jest wykonywane niezależnie od jego elementu nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="e8a73-105">A *detached child task* is a task that executes independently of its parent.</span></span> <span data-ttu-id="e8a73-106">*Dołączone zadanie podrzędne* to zadanie zagnieżdżone, które jest tworzone z opcją, <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> której element nadrzędny nie jest jawnie lub domyślnie uniemożliwia dołączenie.</span><span class="sxs-lookup"><span data-stu-id="e8a73-106">An *attached child task* is a nested task that is created with the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option whose parent does not explicitly or by default prohibit it from being attached.</span></span> <span data-ttu-id="e8a73-107">Zadanie może utworzyć dowolną liczbę dołączonych i odłączonych zadań podrzędnych, ograniczoną tylko przez zasoby systemowe.</span><span class="sxs-lookup"><span data-stu-id="e8a73-107">A task may create any number of attached and detached child tasks, limited only by system resources.</span></span>  
  
 <span data-ttu-id="e8a73-108">W poniższej tabeli wymieniono podstawowe różnice między dwoma rodzajami zadań podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="e8a73-108">The following table lists the basic differences between the two kinds of child tasks.</span></span>  
  
|<span data-ttu-id="e8a73-109">Kategoria</span><span class="sxs-lookup"><span data-stu-id="e8a73-109">Category</span></span>|<span data-ttu-id="e8a73-110">Odłączone zadania podrzędne</span><span class="sxs-lookup"><span data-stu-id="e8a73-110">Detached child tasks</span></span>|<span data-ttu-id="e8a73-111">Dołączone zadania podrzędne</span><span class="sxs-lookup"><span data-stu-id="e8a73-111">Attached child tasks</span></span>|  
|--------------|--------------------------|--------------------------|  
|<span data-ttu-id="e8a73-112">Element nadrzędny czeka na zakończenie zadań podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="e8a73-112">Parent waits for child tasks to complete.</span></span>|<span data-ttu-id="e8a73-113">Nie</span><span class="sxs-lookup"><span data-stu-id="e8a73-113">No</span></span>|<span data-ttu-id="e8a73-114">Tak</span><span class="sxs-lookup"><span data-stu-id="e8a73-114">Yes</span></span>|  
|<span data-ttu-id="e8a73-115">Element nadrzędny propaguje wyjątki zgłoszone przez zadania podrzędne.</span><span class="sxs-lookup"><span data-stu-id="e8a73-115">Parent propagates exceptions thrown by child tasks.</span></span>|<span data-ttu-id="e8a73-116">Nie</span><span class="sxs-lookup"><span data-stu-id="e8a73-116">No</span></span>|<span data-ttu-id="e8a73-117">Tak</span><span class="sxs-lookup"><span data-stu-id="e8a73-117">Yes</span></span>|  
|<span data-ttu-id="e8a73-118">Stan elementu nadrzędnego zależy od stanu elementu podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="e8a73-118">Status of parent depends on status of child.</span></span>|<span data-ttu-id="e8a73-119">Nie</span><span class="sxs-lookup"><span data-stu-id="e8a73-119">No</span></span>|<span data-ttu-id="e8a73-120">Tak</span><span class="sxs-lookup"><span data-stu-id="e8a73-120">Yes</span></span>|  
  
 <span data-ttu-id="e8a73-121">W większości scenariuszy zalecamy korzystanie z odłączonych zadań podrzędnych, ponieważ ich relacje z innymi zadaniami są mniej skomplikowane.</span><span class="sxs-lookup"><span data-stu-id="e8a73-121">In most scenarios, we recommend that you use detached child tasks, because their relationships with other tasks are less complex.</span></span> <span data-ttu-id="e8a73-122">Dlatego zadania utworzone wewnątrz zadań nadrzędnych są odłączone domyślnie i należy jawnie określić <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> opcję tworzenia dołączonego zadania podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="e8a73-122">That is why tasks created inside parent tasks are detached by default, and you must explicitly specify the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option to create an attached child task.</span></span>  
  
## <a name="detached-child-tasks"></a><span data-ttu-id="e8a73-123">Odłączone zadania podrzędne</span><span class="sxs-lookup"><span data-stu-id="e8a73-123">Detached child tasks</span></span>  

 <span data-ttu-id="e8a73-124">Chociaż zadanie podrzędne jest tworzone przez zadanie nadrzędne, domyślnie jest ono niezależne od zadania nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="e8a73-124">Although a child task is created by a parent task, by default it is independent of the parent task.</span></span> <span data-ttu-id="e8a73-125">W poniższym przykładzie zadanie nadrzędne tworzy jedno proste zadanie podrzędne.</span><span class="sxs-lookup"><span data-stu-id="e8a73-125">In the following example, a parent task creates one simple child task.</span></span> <span data-ttu-id="e8a73-126">Jeśli przykładowy kod zostanie uruchomiony wielokrotnie, można zauważyć, że dane wyjściowe z przykładu różnią się od tego, a także że dane wyjściowe mogą ulec zmianie za każdym razem, gdy uruchamiasz kod.</span><span class="sxs-lookup"><span data-stu-id="e8a73-126">If you run the example code multiple times, you may notice that the output from the example differs from that shown, and also that the output may change each time you run the code.</span></span> <span data-ttu-id="e8a73-127">Dzieje się tak, ponieważ zadanie nadrzędne i podrzędne zadania są wykonywane niezależnie od siebie. obiekt podrzędny jest odłączonym zadaniem.</span><span class="sxs-lookup"><span data-stu-id="e8a73-127">This occurs because the parent task and child tasks execute independently of each other; the child is a detached task.</span></span> <span data-ttu-id="e8a73-128">Przykład czeka tylko na ukończenie zadania nadrzędnego, a zadanie podrzędne może nie zostać wykonane lub ukończone przed zakończeniem działania aplikacji konsolowej.</span><span class="sxs-lookup"><span data-stu-id="e8a73-128">The example waits only for the parent task to complete, and the child task may not execute or complete before the console app terminates.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/nested1.cs#1)]
 [!code-vb[TPL_ChildTasks#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/nested1.vb#1)]  
  
 <span data-ttu-id="e8a73-129">Jeśli zadanie podrzędne jest reprezentowane przez <xref:System.Threading.Tasks.Task%601> obiekt, a nie <xref:System.Threading.Tasks.Task> obiekt, można upewnić się, że zadanie nadrzędne będzie oczekiwać na ukończenie działania podrzędnego przez uzyskanie dostępu do <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> właściwości elementu podrzędnego, nawet jeśli jest to odłączonego zadanie podrzędne.</span><span class="sxs-lookup"><span data-stu-id="e8a73-129">If the child task is represented by a <xref:System.Threading.Tasks.Task%601> object rather than a <xref:System.Threading.Tasks.Task> object, you can ensure that the parent task will wait for the child to complete by accessing the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property of the child even if it is a detached child task.</span></span> <span data-ttu-id="e8a73-130"><xref:System.Threading.Tasks.Task%601.Result%2A>Właściwość jest blokowana do momentu zakończenia jego zadania, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="e8a73-130">The <xref:System.Threading.Tasks.Task%601.Result%2A> property blocks until its task completes, as the following example shows.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/childtasks.cs#4)]
 [!code-vb[TPL_ChildTasks#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/tpl_childtasks.vb#4)]  
  
## <a name="attached-child-tasks"></a><span data-ttu-id="e8a73-131">Dołączone zadania podrzędne</span><span class="sxs-lookup"><span data-stu-id="e8a73-131">Attached child tasks</span></span>  

 <span data-ttu-id="e8a73-132">W przeciwieństwie do odłączonych zadań podrzędnych, dołączone zadania podrzędne są ściśle zsynchronizowane z elementem nadrzędnym.</span><span class="sxs-lookup"><span data-stu-id="e8a73-132">Unlike detached child tasks, attached child tasks are closely synchronized with the parent.</span></span> <span data-ttu-id="e8a73-133">Można zmienić odłączone zadanie podrzędne w poprzednim przykładzie do dołączonego zadania podrzędnego przy użyciu <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> opcji w instrukcji tworzenia zadania, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="e8a73-133">You can change the detached child task in the previous example to an attached child task by using the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option in the task creation statement, as shown in the following example.</span></span> <span data-ttu-id="e8a73-134">W tym kodzie, dołączone zadanie podrzędne zostanie zakończone przed jego elementem nadrzędnym.</span><span class="sxs-lookup"><span data-stu-id="e8a73-134">In this code, the attached child task completes before its parent.</span></span> <span data-ttu-id="e8a73-135">W związku z tym dane wyjściowe z przykładu są takie same przy każdym uruchomieniu kodu.</span><span class="sxs-lookup"><span data-stu-id="e8a73-135">As a result, the output from the example is the same each time you run the code.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/child1.cs#2)]
 [!code-vb[TPL_ChildTasks#2](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/child1.vb#2)]  
  
 <span data-ttu-id="e8a73-136">Do tworzenia ściśle zsynchronizowanych wykresów operacji asynchronicznych można użyć dołączonych zadań podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="e8a73-136">You can use attached child tasks to create tightly synchronized graphs of asynchronous operations.</span></span>  
  
 <span data-ttu-id="e8a73-137">Jednak zadanie podrzędne może dołączyć do jego elementu nadrzędnego tylko wtedy, gdy jego element nadrzędny nie zabrania załączonych zadań podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="e8a73-137">However, a child task can attach to its parent only if its parent does not prohibit attached child tasks.</span></span> <span data-ttu-id="e8a73-138">Zadania nadrzędne mogą jawnie uniemożliwić dołączanie do nich zadań podrzędnych przez określenie <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> opcji w konstruktorze klas zadania nadrzędnego lub <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType> metodzie.</span><span class="sxs-lookup"><span data-stu-id="e8a73-138">Parent tasks can explicitly prevent child tasks from attaching to them by specifying the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option in the parent task's class constructor or the <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="e8a73-139">Zadania nadrzędne niejawnie uniemożliwiają dołączenie do nich zadań podrzędnych, jeśli są tworzone przez wywołanie <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="e8a73-139">Parent tasks implicitly prevent child tasks from attaching to them if they are created by calling the <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="e8a73-140">Ilustruje to poniższy przykład.</span><span class="sxs-lookup"><span data-stu-id="e8a73-140">The following example illustrates this.</span></span> <span data-ttu-id="e8a73-141">Jest identyczny z poprzednim przykładem, z tą różnicą, że zadanie nadrzędne jest tworzone przez wywołanie <xref:System.Threading.Tasks.Task.Run%28System.Action%29?displayProperty=nameWithType> metody zamiast <xref:System.Threading.Tasks.TaskFactory.StartNew%28System.Action%29?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="e8a73-141">It is identical to the previous example, except that the parent task is created by calling the <xref:System.Threading.Tasks.Task.Run%28System.Action%29?displayProperty=nameWithType> method rather than the <xref:System.Threading.Tasks.TaskFactory.StartNew%28System.Action%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="e8a73-142">Ponieważ zadanie podrzędne nie jest w stanie dołączyć do jego elementu nadrzędnego, dane wyjściowe z przykładu są nieprzewidywalne.</span><span class="sxs-lookup"><span data-stu-id="e8a73-142">Because the child task is not able to attach to its parent, the output from the example is unpredictable.</span></span> <span data-ttu-id="e8a73-143">Ponieważ domyślne opcje tworzenia zadań dla <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> przeciążenia obejmują <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> , ten przykład jest funkcjonalnie odpowiednikiem pierwszego przykładu w sekcji "odłączone zadania podrzędne".</span><span class="sxs-lookup"><span data-stu-id="e8a73-143">Because the default task creation options for the <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> overloads include <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>, this example is functionally equivalent to the first example in the "Detached child tasks" section.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/child1a.cs#3)]
 [!code-vb[TPL_ChildTasks#3](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/child1a.vb#3)]  
  
## <a name="exceptions-in-child-tasks"></a><span data-ttu-id="e8a73-144">Wyjątki w zadaniach podrzędnych</span><span class="sxs-lookup"><span data-stu-id="e8a73-144">Exceptions in child tasks</span></span>  

 <span data-ttu-id="e8a73-145">Jeśli odłączone zadanie podrzędne zgłasza wyjątek, ten wyjątek musi zostać zaobserwowany lub obsłużony bezpośrednio w zadaniu nadrzędnym, podobnie jak w przypadku dowolnego zadania niezagnieżdżonego.</span><span class="sxs-lookup"><span data-stu-id="e8a73-145">If a detached child task throws an exception, that exception must be observed or handled directly in the parent task just as with any non-nested task.</span></span> <span data-ttu-id="e8a73-146">Jeśli dołączone zadanie podrzędne zgłasza wyjątek, wyjątek jest automatycznie propagowany do zadania nadrzędnego i z powrotem do wątku, który czeka lub próbuje uzyskać dostęp do <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> właściwości zadania.</span><span class="sxs-lookup"><span data-stu-id="e8a73-146">If an attached child task throws an exception, the exception is automatically propagated to the parent task and back to the thread that waits or tries to access the task's <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="e8a73-147">W związku z tym przy użyciu dołączonych zadań podrzędnych można obsługiwać wszystkie wyjątki w tylko jednym punkcie w wywołaniu <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> w wątku wywołującym.</span><span class="sxs-lookup"><span data-stu-id="e8a73-147">Therefore, by using attached child tasks, you can handle all exceptions at just one point in the call to <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> on the calling thread.</span></span> <span data-ttu-id="e8a73-148">Aby uzyskać więcej informacji, zobacz [Obsługa wyjątków](exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="e8a73-148">For more information, see [Exception Handling](exception-handling-task-parallel-library.md).</span></span>  
  
## <a name="cancellation-and-child-tasks"></a><span data-ttu-id="e8a73-149">Anulowanie i zadania podrzędne</span><span class="sxs-lookup"><span data-stu-id="e8a73-149">Cancellation and child tasks</span></span>  

 <span data-ttu-id="e8a73-150">Anulowanie zadania jest spółdzielnią.</span><span class="sxs-lookup"><span data-stu-id="e8a73-150">Task cancellation is cooperative.</span></span> <span data-ttu-id="e8a73-151">Oznacza to, że jako możliwe do anulowania każde dołączone lub odłączone zadanie podrzędne musi monitorować stan tokenu anulowania.</span><span class="sxs-lookup"><span data-stu-id="e8a73-151">That is, to be cancelable, every attached or detached child task must monitor the status of the cancellation token.</span></span> <span data-ttu-id="e8a73-152">Aby anulować nadrzędne i wszystkie jego elementy podrzędne przy użyciu jednego żądania anulowania, należy przekazać ten sam token jako argument do wszystkich zadań i udostępnić każdemu zadaniu logikę odpowiedzi na żądanie w każdym zadaniu.</span><span class="sxs-lookup"><span data-stu-id="e8a73-152">If you want to cancel a parent and all its children by using one cancellation request, you pass the same token as an argument to all tasks and provide in each task the logic to respond to the request in each task.</span></span> <span data-ttu-id="e8a73-153">Aby uzyskać więcej informacji, zobacz [Anulowanie zadania](task-cancellation.md) i [instrukcje: Anulowanie zadania i jego elementów podrzędnych](how-to-cancel-a-task-and-its-children.md).</span><span class="sxs-lookup"><span data-stu-id="e8a73-153">For more information, see [Task Cancellation](task-cancellation.md) and [How to: Cancel a Task and Its Children](how-to-cancel-a-task-and-its-children.md).</span></span>  
  
### <a name="when-the-parent-cancels"></a><span data-ttu-id="e8a73-154">Gdy element nadrzędny zostanie anulowany</span><span class="sxs-lookup"><span data-stu-id="e8a73-154">When the parent cancels</span></span>  

 <span data-ttu-id="e8a73-155">Jeśli element nadrzędny zostanie anulowany przed rozpoczęciem jego zadania podrzędnego, element podrzędny nigdy nie zostanie uruchomiony.</span><span class="sxs-lookup"><span data-stu-id="e8a73-155">If a parent cancels itself before its child task is started, the child never starts.</span></span> <span data-ttu-id="e8a73-156">Jeśli element nadrzędny zostanie anulowany po uruchomieniu zadania podrzędnego, element podrzędny zostanie uruchomiony do ukończenia, chyba że ma własną logikę anulowania.</span><span class="sxs-lookup"><span data-stu-id="e8a73-156">If a parent cancels itself after its child task has already started, the child runs to completion unless it has its own cancellation logic.</span></span> <span data-ttu-id="e8a73-157">Aby uzyskać więcej informacji, zobacz [Anulowanie zadania](task-cancellation.md).</span><span class="sxs-lookup"><span data-stu-id="e8a73-157">For more information, see [Task Cancellation](task-cancellation.md).</span></span>  
  
### <a name="when-a-detached-child-task-cancels"></a><span data-ttu-id="e8a73-158">Po anulowaniu odłączonego zadania podrzędnego</span><span class="sxs-lookup"><span data-stu-id="e8a73-158">When a detached child task cancels</span></span>  

 <span data-ttu-id="e8a73-159">Jeśli odłączone zadanie podrzędne anuluje się za pomocą tego samego tokenu, który został przekazano do elementu nadrzędnego, a element nadrzędny nie czeka na zadanie podrzędne, żaden wyjątek nie jest propagowany, ponieważ wyjątek jest traktowany jako niegroźne anulowanie współpracy.</span><span class="sxs-lookup"><span data-stu-id="e8a73-159">If a detached child task cancels itself by using the same token that was passed to the parent, and the parent does not wait for the child task, no exception is propagated, because the exception is treated as benign cooperation cancellation.</span></span> <span data-ttu-id="e8a73-160">Takie zachowanie jest takie samo jak w przypadku każdego zadania najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="e8a73-160">This behavior is the same as that of any top-level task.</span></span>  
  
### <a name="when-an-attached-child-task-cancels"></a><span data-ttu-id="e8a73-161">Gdy dołączone zadanie podrzędne zostanie anulowane</span><span class="sxs-lookup"><span data-stu-id="e8a73-161">When an attached child task cancels</span></span>  

 <span data-ttu-id="e8a73-162">Gdy dołączone zadanie podrzędne anuluje się za pomocą tego samego tokenu, który został przekazano do jego zadania nadrzędnego, <xref:System.Threading.Tasks.TaskCanceledException> jest propagowany do wątku przyłączania wewnątrz <xref:System.AggregateException> .</span><span class="sxs-lookup"><span data-stu-id="e8a73-162">When an attached child task cancels itself by using the same token that was passed to its parent task, a <xref:System.Threading.Tasks.TaskCanceledException> is propagated to the joining thread inside an <xref:System.AggregateException>.</span></span> <span data-ttu-id="e8a73-163">Należy poczekać na zadanie nadrzędne, aby można było obsługiwać wszystkie niegroźne wyjątki oprócz wszystkich wyjątków powodujących błędy, które są propagowane za pomocą grafu dołączonych zadań podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="e8a73-163">You must wait for the parent task so that you can handle all benign exceptions in addition to all faulting exceptions that are propagated up through a graph of attached child tasks.</span></span>  
  
 <span data-ttu-id="e8a73-164">Aby uzyskać więcej informacji, zobacz [Obsługa wyjątków](exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="e8a73-164">For more information, see [Exception Handling](exception-handling-task-parallel-library.md).</span></span>  
  
## <a name="preventing-a-child-task-from-attaching-to-its-parent"></a><span data-ttu-id="e8a73-165">Uniemożliwianie podłączania zadania podrzędnego do jego elementu nadrzędnego</span><span class="sxs-lookup"><span data-stu-id="e8a73-165">Preventing a child task from attaching to its parent</span></span>  

 <span data-ttu-id="e8a73-166">Nieobsłużony wyjątek, który jest generowany przez zadanie podrzędne jest propagowany do zadania nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="e8a73-166">An unhandled exception that is thrown by a child task is propagated to the parent task.</span></span> <span data-ttu-id="e8a73-167">To zachowanie służy do przestrzegania wszystkich wyjątków zadań podrzędnych z jednego zadania głównego zamiast przechodzenia drzewa zadań.</span><span class="sxs-lookup"><span data-stu-id="e8a73-167">You can use this behavior to observe all child task exceptions from one root task instead of traversing a tree of tasks.</span></span> <span data-ttu-id="e8a73-168">Jednakże Propagacja wyjątku może być problematyczna, gdy zadanie nadrzędne nie oczekuje załącznika od innego kodu.</span><span class="sxs-lookup"><span data-stu-id="e8a73-168">However, exception propagation can be problematic when a parent task does not expect attachment from other code.</span></span> <span data-ttu-id="e8a73-169">Rozważmy na przykład aplikację, która wywołuje składnik biblioteki innej firmy z <xref:System.Threading.Tasks.Task> obiektu.</span><span class="sxs-lookup"><span data-stu-id="e8a73-169">For example, consider an app that calls a third-party library component from a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="e8a73-170">Jeśli składnik biblioteki innej firmy tworzy również <xref:System.Threading.Tasks.Task> obiekt i określa <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> , że ma zostać dołączony do zadania nadrzędnego, wszelkie Nieobsłużone wyjątki występujące w zadaniu podrzędnym propagują do obiektu nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="e8a73-170">If the third-party library component also creates a <xref:System.Threading.Tasks.Task> object and specifies <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> to attach it to the parent task, any unhandled exceptions that occur in the child task propagate to the parent.</span></span> <span data-ttu-id="e8a73-171">Może to prowadzić do nieoczekiwanego zachowania w aplikacji głównej.</span><span class="sxs-lookup"><span data-stu-id="e8a73-171">This could lead to unexpected behavior in the main app.</span></span>  
  
 <span data-ttu-id="e8a73-172">Aby zapobiec dołączeniu zadania podrzędnego do jego zadania nadrzędnego, należy określić <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> opcję podczas tworzenia elementu nadrzędnego <xref:System.Threading.Tasks.Task> lub <xref:System.Threading.Tasks.Task%601> obiektu.</span><span class="sxs-lookup"><span data-stu-id="e8a73-172">To prevent a child task from attaching to its parent task, specify the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option when you create the parent <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> object.</span></span> <span data-ttu-id="e8a73-173">Gdy zadanie próbuje dołączyć do jego elementu nadrzędnego, a element nadrzędny określa <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> opcję, zadanie podrzędne nie będzie mogło dołączyć do elementu nadrzędnego i zostanie wykonane tak, jakby <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> nie określono opcji.</span><span class="sxs-lookup"><span data-stu-id="e8a73-173">When a task tries to attach to its parent and the parent specifies the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option, the child task will not be able to attach to a parent and will execute just as if the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option was not specified.</span></span>  
  
 <span data-ttu-id="e8a73-174">Możesz również zapobiec dołączeniu zadania podrzędnego do jego elementu nadrzędnego, gdy zadanie podrzędne nie zakończy się w odpowiednim czasie.</span><span class="sxs-lookup"><span data-stu-id="e8a73-174">You might also want to prevent a child task from attaching to its parent when the child task does not finish in a timely manner.</span></span> <span data-ttu-id="e8a73-175">Ponieważ zadanie nadrzędne nie kończy się do momentu zakończenia wszystkich zadań podrzędnych, długotrwałe zadanie podrzędne może spowodować słabą pracę aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e8a73-175">Because a parent task does not finish until all child tasks finish, a long-running child task can cause the overall app to perform poorly.</span></span> <span data-ttu-id="e8a73-176">Aby zapoznać się z przykładem, który pokazuje, jak zwiększyć wydajność aplikacji, zapobiegając dołączeniu zadania do jego zadania nadrzędnego, zobacz [How to: zapobiegaj dołączeniu zadania podrzędnego do jego elementu nadrzędnego](how-to-prevent-a-child-task-from-attaching-to-its-parent.md).</span><span class="sxs-lookup"><span data-stu-id="e8a73-176">For an example that shows how to improve app performance by preventing a task from attaching to its parent task, see [How to: Prevent a Child Task from Attaching to its Parent](how-to-prevent-a-child-task-from-attaching-to-its-parent.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e8a73-177">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="e8a73-177">See also</span></span>

- [<span data-ttu-id="e8a73-178">Programowanie równoległe</span><span class="sxs-lookup"><span data-stu-id="e8a73-178">Parallel Programming</span></span>](index.md)
- [<span data-ttu-id="e8a73-179">Równoległość danych</span><span class="sxs-lookup"><span data-stu-id="e8a73-179">Data Parallelism</span></span>](data-parallelism-task-parallel-library.md)
