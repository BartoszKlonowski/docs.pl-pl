---
title: "Tworzenie łańcuchów zadań przy użyciu zadań kontynuacji"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords: tasks, continuations
ms.assetid: 0b45e9a2-de28-46ce-8212-1817280ed42d
caps.latest.revision: "30"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: 7037e0c91ee6ae83b70d6a26e72b87095456063b
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/18/2017
---
# <a name="chaining-tasks-by-using-continuation-tasks"></a><span data-ttu-id="37aff-102">Tworzenie łańcuchów zadań przy użyciu zadań kontynuacji</span><span class="sxs-lookup"><span data-stu-id="37aff-102">Chaining Tasks by Using Continuation Tasks</span></span>
<span data-ttu-id="37aff-103">W programowanie asynchroniczne jest często stosowane w jednej operacji asynchronicznej, po zakończeniu, aby wywołać operację drugi i przekazywania danych do niej.</span><span class="sxs-lookup"><span data-stu-id="37aff-103">In asynchronous programming, it is very common for one asynchronous operation, on completion, to invoke a second operation and pass data to it.</span></span> <span data-ttu-id="37aff-104">Tradycyjnie to przeprowadzono przy użyciu metody wywołania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="37aff-104">Traditionally, this has been done by using callback methods.</span></span> <span data-ttu-id="37aff-105">W bibliotece równoległych zadań podał funkcji *zadań kontynuacji*.</span><span class="sxs-lookup"><span data-stu-id="37aff-105">In the Task Parallel Library, the same functionality is provided by *continuation tasks*.</span></span> <span data-ttu-id="37aff-106">Zadania kontynuacji (nazywanego także po prostu utrzymania) jest zadanie asynchroniczne, które jest wywoływane przez inne zadanie, znany jako *antecedent*, po zakończeniu antecedent.</span><span class="sxs-lookup"><span data-stu-id="37aff-106">A continuation task (also known just as a continuation) is an asynchronous task that is invoked by another task, which is known as the *antecedent*, when the antecedent finishes.</span></span>  
  
 <span data-ttu-id="37aff-107">Kontynuacje są stosunkowo łatwa w użyciu, ale mimo to bardzo wydajny i elastyczny.</span><span class="sxs-lookup"><span data-stu-id="37aff-107">Continuations are relatively easy to use, but are nevertheless very powerful and flexible.</span></span> <span data-ttu-id="37aff-108">Możesz na przykład:</span><span class="sxs-lookup"><span data-stu-id="37aff-108">For example, you can:</span></span>  
  
-   <span data-ttu-id="37aff-109">Przekazywanie danych z antecedent do kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-109">Pass data from the antecedent to the continuation.</span></span>  
  
-   <span data-ttu-id="37aff-110">Określ dokładne warunki, w których kontynuacji będzie wywoływane lub nie został wywołany.</span><span class="sxs-lookup"><span data-stu-id="37aff-110">Specify the precise conditions under which the continuation will be invoked or not invoked.</span></span>  
  
-   <span data-ttu-id="37aff-111">Anuluj utrzymania przed rozpoczęciem lub wspólnie ponieważ jest on uruchomiony.</span><span class="sxs-lookup"><span data-stu-id="37aff-111">Cancel a continuation either before it starts or cooperatively as it is running.</span></span>  
  
-   <span data-ttu-id="37aff-112">Zawierają wskazówki dotyczące sposobu powinny zostać zaplanowane kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-112">Provide hints about how the continuation should be scheduled.</span></span>  
  
-   <span data-ttu-id="37aff-113">Wywołanie wielu kontynuacje z tym samym antecedent.</span><span class="sxs-lookup"><span data-stu-id="37aff-113">Invoke multiple continuations from the same antecedent.</span></span>  
  
-   <span data-ttu-id="37aff-114">Po ukończeniu całości lub jedną z wielu antecedents, należy wywołać kontynuacji jeden.</span><span class="sxs-lookup"><span data-stu-id="37aff-114">Invoke one continuation when all or any one of multiple antecedents complete.</span></span>  
  
-   <span data-ttu-id="37aff-115">Powiązane kontynuacje jeden po drugim żadnych dowolnej długości.</span><span class="sxs-lookup"><span data-stu-id="37aff-115">Chain continuations one after another to any arbitrary length.</span></span>  
  
-   <span data-ttu-id="37aff-116">Umożliwia Obsługa wyjątków zgłaszanych przez antecedent utrzymania.</span><span class="sxs-lookup"><span data-stu-id="37aff-116">Use a continuation to handle exceptions thrown by the antecedent.</span></span>  
  
## <a name="about-continuations"></a><span data-ttu-id="37aff-117">O kontynuacje</span><span class="sxs-lookup"><span data-stu-id="37aff-117">About continuations</span></span>  
 <span data-ttu-id="37aff-118">Kontynuacja to zadanie, które jest tworzony w <xref:System.Threading.Tasks.TaskStatus.WaitingForActivation> stanu.</span><span class="sxs-lookup"><span data-stu-id="37aff-118">A continuation is a task that is created in the <xref:System.Threading.Tasks.TaskStatus.WaitingForActivation> state.</span></span> <span data-ttu-id="37aff-119">Jest aktywowane automatycznie po ukończeniu jego poprzedzających zadania lub zadania.</span><span class="sxs-lookup"><span data-stu-id="37aff-119">It is activated automatically when its antecedent task or tasks complete.</span></span> <span data-ttu-id="37aff-120">Wywoływanie <xref:System.Threading.Tasks.Task.Start%2A?displayProperty=nameWithType> na kontynuację w kodzie użytkownika zgłasza <xref:System.InvalidOperationException?displayProperty=nameWithType> wyjątku.</span><span class="sxs-lookup"><span data-stu-id="37aff-120">Calling <xref:System.Threading.Tasks.Task.Start%2A?displayProperty=nameWithType> on a continuation in user code throws an <xref:System.InvalidOperationException?displayProperty=nameWithType> exception.</span></span>  
  
 <span data-ttu-id="37aff-121">Jest to kontynuacja <xref:System.Threading.Tasks.Task> i nie są blokowane w wątku, na którym jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="37aff-121">A continuation is itself a <xref:System.Threading.Tasks.Task> and does not block the thread on which it is started.</span></span> <span data-ttu-id="37aff-122">Wywołanie <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> metodę, aby zablokować zakończenie zadania kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-122">Call the <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> method to block until the continuation task finishes.</span></span>  
  
## <a name="creating-a-continuation-for-a-single-antecedent"></a><span data-ttu-id="37aff-123">Tworzenie kontynuacji dla pojedynczego antecedent</span><span class="sxs-lookup"><span data-stu-id="37aff-123">Creating a continuation for a single antecedent</span></span>  
 <span data-ttu-id="37aff-124">Utwórz utrzymania wykonującą po zakończeniu jego antecedent przez wywołanie metody <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="37aff-124">You create a continuation that executes when its antecedent has completed by calling the <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="37aff-125">W poniższym przykładzie przedstawiono podstawowe wzorzec, (dla uzyskania przejrzystości, obsługa wyjątków został pominięty).</span><span class="sxs-lookup"><span data-stu-id="37aff-125">The following example shows the basic pattern, (for clarity, exception handling is omitted).</span></span> <span data-ttu-id="37aff-126">Wykonywania poprzedzających zadań `taskA`, która zwraca <xref:System.DayOfWeek> obiekt, który wskazuje nazwę bieżącego dnia tygodnia.</span><span class="sxs-lookup"><span data-stu-id="37aff-126">It executes an antecedent task, `taskA`, that returns a <xref:System.DayOfWeek> object that indicates the name of the current day of the week.</span></span> <span data-ttu-id="37aff-127">Po zakończeniu antecedent zadania kontynuacji `taskB`, jest przekazywany antecedent i wyświetla ciąg, który zawiera jego wynik.</span><span class="sxs-lookup"><span data-stu-id="37aff-127">When the antecedent finishes, the continuation task, `taskB`, is passed the antecedent and displays a string that includes its result.</span></span>  
  
 [!code-csharp[TPL_Continuations#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/simple1.cs#1)]
 [!code-vb[TPL_Continuations#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/simple1.vb#1)]  
  
## <a name="creating-a-continuation-for-multiple-antecedents"></a><span data-ttu-id="37aff-128">Tworzenie kontynuacji dla wielu antecedents</span><span class="sxs-lookup"><span data-stu-id="37aff-128">Creating a continuation for multiple antecedents</span></span>  
 <span data-ttu-id="37aff-129">Można również utworzyć kontynuacji, które zostanie uruchomione po ukończeniu niektóre lub wszystkie z grupy zadań.</span><span class="sxs-lookup"><span data-stu-id="37aff-129">You can also create a continuation that will run when any or all of a group of tasks has completed.</span></span> <span data-ttu-id="37aff-130">Kontynuacja należy wykonać po zakończeniu wykonywania wszystkich zadań poprzedzających, należy wywołać statycznych (`Shared` w języku Visual Basic) <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> metody lub wystąpienie <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="37aff-130">To execute a continuation when all antecedent tasks have completed, you call the static (`Shared` in Visual Basic) <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> method or the instance <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="37aff-131">Kontynuacja należy wykonać po zakończeniu poprzedzających zadań, należy wywołać statycznych (`Shared` w języku Visual Basic) <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> metody lub wystąpienie <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAny%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="37aff-131">To execute a continuation when any of the antecedent tasks has completed, you call the static (`Shared` in Visual Basic) <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> method or the instance <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAny%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="37aff-132">Należy pamiętać, że wywołań <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> i <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> przeciążenia nie blokują wątek wywołujący.</span><span class="sxs-lookup"><span data-stu-id="37aff-132">Note that calls to the <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> and <xref:System.Threading.Tasks.Task.WhenAny%2A?displayProperty=nameWithType> overloads do not block the calling thread.</span></span>  <span data-ttu-id="37aff-133">Jednak zwykle wywołują wszystkie elementy oprócz <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> i <xref:System.Threading.Tasks.Task.WhenAll%28System.Threading.Tasks.Task%5B%5D%29?displayProperty=nameWithType> metody do pobierania zwróconego <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> właściwość, która zablokować wywołania wątku.</span><span class="sxs-lookup"><span data-stu-id="37aff-133">However, you typically call all but the <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> and  <xref:System.Threading.Tasks.Task.WhenAll%28System.Threading.Tasks.Task%5B%5D%29?displayProperty=nameWithType> methods to retrieve the returned  <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property, which does block the calling thread.</span></span>  
  
 <span data-ttu-id="37aff-134">Następujące przykładowe wywołania <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> metodę w celu utworzenia zadania kontynuacji odzwierciedlający wyniki dziesięć poprzedzających zadań.</span><span class="sxs-lookup"><span data-stu-id="37aff-134">The following example calls the <xref:System.Threading.Tasks.Task.WhenAll%28System.Collections.Generic.IEnumerable%7BSystem.Threading.Tasks.Task%7D%29?displayProperty=nameWithType> method to create a continuation task that reflects the results of its ten antecedent tasks.</span></span> <span data-ttu-id="37aff-135">Każde zadanie poprzedzających kwadraty wartość indeksu, która w zakresie od 1 do 10.</span><span class="sxs-lookup"><span data-stu-id="37aff-135">Each antecedent task squares an index value that ranges from one to ten.</span></span> <span data-ttu-id="37aff-136">Jeśli antecedents zakończy się pomyślnie (ich <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> właściwość jest <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>), <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> właściwości kontynuacji jest tablicą <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> wartości zwracanych przez każdego antecedent.</span><span class="sxs-lookup"><span data-stu-id="37aff-136">If the antecedents complete successfully (their <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> property is <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>), the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property of the continuation is an array of the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> values returned by each antecedent.</span></span> <span data-ttu-id="37aff-137">Przykład dodaje je do obliczenia sumę kwadratów liczb wszystkich między 1 a 10.</span><span class="sxs-lookup"><span data-stu-id="37aff-137">The example adds them to compute the sum of squares for all numbers between one and ten.</span></span>  
  
 [!code-csharp[TPL_Continuations#5](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/whenall1.cs#5)]
 [!code-vb[TPL_Continuations#5](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/whenall1.vb#5)]  
  
## <a name="continuation-options"></a><span data-ttu-id="37aff-138">Opcje kontynuacji</span><span class="sxs-lookup"><span data-stu-id="37aff-138">Continuation options</span></span>  
 <span data-ttu-id="37aff-139">Podczas tworzenia kontynuacji jednego zadania, można użyć <xref:System.Threading.Tasks.Task.ContinueWith%2A> przeciążenia, które przyjmuje <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> wartość wyliczenia do określenia warunków, w jakich uruchamia kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-139">When you create a single-task continuation, you can use a <xref:System.Threading.Tasks.Task.ContinueWith%2A> overload that takes a <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> enumeration value to specify the conditions under which the continuation starts.</span></span> <span data-ttu-id="37aff-140">Na przykład można określić, że kontynuowanie jest uruchomienie tylko wtedy, gdy antecedent zakończy się pomyślnie, lub tylko wtedy, gdy ukończy stan.</span><span class="sxs-lookup"><span data-stu-id="37aff-140">For example, you can specify that the continuation is to run only if the antecedent completes successfully, or only if it completes in a faulted state.</span></span> <span data-ttu-id="37aff-141">Jeśli warunek nie zostanie spełniony, gdy antecedent jest gotowe do kontynuacji wywołania, kontynuacji bezpośrednio do przejścia <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> stanu i nie można uruchomić po tym.</span><span class="sxs-lookup"><span data-stu-id="37aff-141">If the condition is not true when the antecedent is ready to invoke the continuation, the continuation transitions directly to the <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> state and cannot be started after that.</span></span>  
  
 <span data-ttu-id="37aff-142">Wiele metod kontynuacji wielu zadań, takich jak przeciążeń <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType> metody również obejmować <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> parametru.</span><span class="sxs-lookup"><span data-stu-id="37aff-142">A number of multi-task continuation methods, such as overloads of the <xref:System.Threading.Tasks.TaskFactory.ContinueWhenAll%2A?displayProperty=nameWithType> method, also include a <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> parameter.</span></span> <span data-ttu-id="37aff-143">Tylko podzestaw wszystkie <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> elementy członkowskie wyliczenia są prawidłowe, jednak.</span><span class="sxs-lookup"><span data-stu-id="37aff-143">Only a subset of all <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> enumeration members are valid, however.</span></span> <span data-ttu-id="37aff-144">Można określić <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> wartości, które mają odpowiednikowi w <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=nameWithType> wyliczenia, takich jak <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType>, <xref:System.Threading.Tasks.TaskContinuationOptions.LongRunning?displayProperty=nameWithType>, i <xref:System.Threading.Tasks.TaskContinuationOptions.PreferFairness?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="37aff-144">You can specify <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=nameWithType> values that have counterparts in the <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=nameWithType> enumeration, such as <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType>, <xref:System.Threading.Tasks.TaskContinuationOptions.LongRunning?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.TaskContinuationOptions.PreferFairness?displayProperty=nameWithType>.</span></span> <span data-ttu-id="37aff-145">Jeśli określisz żadnego z `NotOn` lub `OnlyOn` opcje w przypadku kontynuacji wielu zadań, <xref:System.ArgumentOutOfRangeException> zostanie wygenerowany wyjątek w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="37aff-145">If you specify any of the `NotOn` or `OnlyOn` options with a multi-task continuation, an <xref:System.ArgumentOutOfRangeException> exception will be thrown at run time.</span></span>  
  
 <span data-ttu-id="37aff-146">Aby uzyskać więcej informacji na temat zadań kontynuacji opcji, zobacz <xref:System.Threading.Tasks.TaskContinuationOptions> tematu.</span><span class="sxs-lookup"><span data-stu-id="37aff-146">For more information on task continuation options, see the <xref:System.Threading.Tasks.TaskContinuationOptions> topic.</span></span>  
  
## <a name="passing-data-to-a-continuation"></a><span data-ttu-id="37aff-147">Przekazywanie danych do kontynuacji</span><span class="sxs-lookup"><span data-stu-id="37aff-147">Passing Data to a Continuation</span></span>  
 <span data-ttu-id="37aff-148"><xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> Metoda przekazuje odwołanie do antecedent do delegata użytkownika o kontynuację jako argument.</span><span class="sxs-lookup"><span data-stu-id="37aff-148">The <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> method passes a reference to the antecedent to the user delegate of the continuation as an argument.</span></span> <span data-ttu-id="37aff-149">Jeśli jest antecedent <xref:System.Threading.Tasks.Task%601?displayProperty=nameWithType> obiektu, a zadanie uruchomione dopóki została ukończona, mogą uzyskiwać dostęp do kontynuacji, a następnie <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> właściwości zadania.</span><span class="sxs-lookup"><span data-stu-id="37aff-149">If the antecedent is a <xref:System.Threading.Tasks.Task%601?displayProperty=nameWithType> object, and the task ran until it was completed, then the continuation can access the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property of the task.</span></span>  
  
 <span data-ttu-id="37aff-150"><xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> Właściwość blokuje dopiero po ukończeniu zadania.</span><span class="sxs-lookup"><span data-stu-id="37aff-150">The <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property blocks until the task has completed.</span></span> <span data-ttu-id="37aff-151">Jednak jeśli zadanie zostało anulowane lub wystąpił błąd, próbuje uzyskać dostęp do <xref:System.Threading.Tasks.Task%601.Result%2A> zgłasza właściwości <xref:System.AggregateException> wyjątku.</span><span class="sxs-lookup"><span data-stu-id="37aff-151">However, if the task was canceled or faulted, attempting to access the <xref:System.Threading.Tasks.Task%601.Result%2A> property throws an <xref:System.AggregateException> exception.</span></span> <span data-ttu-id="37aff-152">Można uniknąć tego problemu za pomocą <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnRanToCompletion> opcji, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="37aff-152">You can avoid this problem by using the <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnRanToCompletion> option, as shown in the following example.</span></span>  
  
 [!code-csharp[TPL_Continuations#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/result1.cs#2)]
 [!code-vb[TPL_Continuations#2](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/result1.vb#2)]  
  
 <span data-ttu-id="37aff-153">Jeśli chcesz kontynuacji do uruchomienia, nawet jeśli antecedent nie zostało uruchomione na pomyślne zakończenie, należy zabezpieczyć się przed wyjątek.</span><span class="sxs-lookup"><span data-stu-id="37aff-153">If you want the continuation to run even if the antecedent did not run to successful completion, you must guard against the exception.</span></span> <span data-ttu-id="37aff-154">Jednym z podejść jest przetestowanie <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> właściwość poprzedzających i tylko próba uzyskania dostępu do <xref:System.Threading.Tasks.Task%601.Result%2A> właściwość, o ile nie jest w stanie <xref:System.Threading.Tasks.TaskStatus.Faulted> lub <xref:System.Threading.Tasks.TaskStatus.Canceled>.</span><span class="sxs-lookup"><span data-stu-id="37aff-154">One approach is to test the <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> property of the antecedent, and only attempt to access the <xref:System.Threading.Tasks.Task%601.Result%2A> property if the status is not <xref:System.Threading.Tasks.TaskStatus.Faulted> or <xref:System.Threading.Tasks.TaskStatus.Canceled>.</span></span> <span data-ttu-id="37aff-155">Można również sprawdzić <xref:System.Threading.Tasks.Task.Exception%2A> właściwość antecedent.</span><span class="sxs-lookup"><span data-stu-id="37aff-155">You can also examine the <xref:System.Threading.Tasks.Task.Exception%2A> property of the antecedent.</span></span> <span data-ttu-id="37aff-156">Aby uzyskać więcej informacji, zobacz [obsługi wyjątków](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="37aff-156">For more information, see [Exception Handling](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md).</span></span> <span data-ttu-id="37aff-157">Poniższy przykład modyfikuje poprzedniego przykładu do dostępu antecedent <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> właściwość tylko wtedy, gdy jego stan jest <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="37aff-157">The following example modifies the previous example to access antecedent's <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property only if its status is <xref:System.Threading.Tasks.TaskStatus.RanToCompletion?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[TPL_Continuations#7](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/result2.cs#7)]
 [!code-vb[TPL_Continuations#7](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/result2.vb#7)]  
  
## <a name="canceling-a-continuation"></a><span data-ttu-id="37aff-158">Anulowanie utrzymania</span><span class="sxs-lookup"><span data-stu-id="37aff-158">Canceling a Continuation</span></span>  
 <span data-ttu-id="37aff-159"><xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> Ma ustawioną właściwość utrzymania <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> w następujących sytuacjach:</span><span class="sxs-lookup"><span data-stu-id="37aff-159">The <xref:System.Threading.Tasks.Task.Status%2A?displayProperty=nameWithType> property of a continuation is set to <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> in the following situations:</span></span>  
  
-   <span data-ttu-id="37aff-160">Zgłasza <xref:System.OperationCanceledException> wyjątek w odpowiedzi na żądanie anulowania.</span><span class="sxs-lookup"><span data-stu-id="37aff-160">It throws an <xref:System.OperationCanceledException> exception in response to a cancellation request.</span></span> <span data-ttu-id="37aff-161">Podobnie jak wszystkie zadania, jeśli wyjątek zawiera ten sam token, który został przekazany do kontynuacji, będzie traktowane jako potwierdzenie wspólne anulowanie.</span><span class="sxs-lookup"><span data-stu-id="37aff-161">Just as with any task, if the exception contains the same token that was passed to the continuation, it is treated as an acknowledgement of cooperative cancellation.</span></span>  
  
-   <span data-ttu-id="37aff-162">Kontynuacja jest przekazywany <xref:System.Threading.CancellationToken?displayProperty=nameWithType> których <xref:System.Threading.CancellationToken.IsCancellationRequested%2A> jest właściwość `true`.</span><span class="sxs-lookup"><span data-stu-id="37aff-162">The continuation is passed a <xref:System.Threading.CancellationToken?displayProperty=nameWithType> whose <xref:System.Threading.CancellationToken.IsCancellationRequested%2A> property is `true`.</span></span> <span data-ttu-id="37aff-163">W takim przypadku nie można uruchomić kontynuacji, a przechodzi on w <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> stanu.</span><span class="sxs-lookup"><span data-stu-id="37aff-163">In this case, the continuation does not start, and it transitions to the <xref:System.Threading.Tasks.TaskStatus.Canceled?displayProperty=nameWithType> state.</span></span>  
  
-   <span data-ttu-id="37aff-164">Utrzymanie nigdy nie działa, ponieważ warunek ustawiony jego <xref:System.Threading.Tasks.TaskContinuationOptions> argument nie została spełniona.</span><span class="sxs-lookup"><span data-stu-id="37aff-164">The continuation never runs because the condition set by its <xref:System.Threading.Tasks.TaskContinuationOptions> argument was not met.</span></span> <span data-ttu-id="37aff-165">Na przykład, jeśli antecedent przechodzi w stan <xref:System.Threading.Tasks.TaskStatus.Faulted?displayProperty=nameWithType> stanu, jego kontynuację, który został przekazany <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnFaulted?displayProperty=nameWithType> opcja nie będzie działać, ale spowoduje przejście do <xref:System.Threading.Tasks.TaskStatus.Canceled> stanu.</span><span class="sxs-lookup"><span data-stu-id="37aff-165">For example, if an antecedent goes into a <xref:System.Threading.Tasks.TaskStatus.Faulted?displayProperty=nameWithType> state, its continuation that was passed the <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnFaulted?displayProperty=nameWithType> option will not run but will transition to the <xref:System.Threading.Tasks.TaskStatus.Canceled> state.</span></span>  
  
 <span data-ttu-id="37aff-166">Jeśli zadania i jego kontynuacji reprezentować dwie części tej samej operacji logicznych, można przekazać ten sam token anulowania do obu zadań, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="37aff-166">If a task and its continuation represent two parts of the same logical operation, you can pass the same cancellation token to both tasks, as shown in the following example.</span></span> <span data-ttu-id="37aff-167">Składa się z antecedent, który generuje listę liczb całkowitych, które są podzielna przez 33 przekazaniem do kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-167">It consists of an antecedent that generates a list of integers that are divisible by 33, which it passes to the continuation.</span></span> <span data-ttu-id="37aff-168">Kontynuacja z kolei umożliwia wyświetlenie listy.</span><span class="sxs-lookup"><span data-stu-id="37aff-168">The continuation in turn displays the list.</span></span> <span data-ttu-id="37aff-169">Antecedent jak również kontynuacji wstrzymać regularnie dla losowych odstępach czasu.</span><span class="sxs-lookup"><span data-stu-id="37aff-169">Both the antecedent and the continuation pause regularly for random intervals.</span></span> <span data-ttu-id="37aff-170">Ponadto <xref:System.Threading.Timer?displayProperty=nameWithType> obiektu służy do wykonywania `Elapsed` metody po upływie czasu pięciu sekund limitu czasu.</span><span class="sxs-lookup"><span data-stu-id="37aff-170">In addition, a <xref:System.Threading.Timer?displayProperty=nameWithType> object is used to execute the `Elapsed` method after a five-second timeout interval.</span></span> <span data-ttu-id="37aff-171">Powoduje to wywołanie <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> metodę, która powoduje wywołanie aktualnie wykonywanego zadania <xref:System.Threading.CancellationToken.ThrowIfCancellationRequested%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="37aff-171">This calls the <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> method, which causes the currently executing task to call the <xref:System.Threading.CancellationToken.ThrowIfCancellationRequested%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="37aff-172">Czy <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> metoda jest wywoływana podczas wykonywania jest antecedent lub jego kontynuacji zależy od czas trwania pauzy losowo wygenerowany.</span><span class="sxs-lookup"><span data-stu-id="37aff-172">Whether the <xref:System.Threading.CancellationTokenSource.Cancel%2A?displayProperty=nameWithType> method is called when the antecedent or its continuation is executing depends on the duration of the randomly generated pauses.</span></span> <span data-ttu-id="37aff-173">Jeśli antecedent zostało anulowane, kontynuacji nie zostanie uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="37aff-173">If the antecedent is canceled, the continuation will not start.</span></span> <span data-ttu-id="37aff-174">Jeśli antecedent nie została anulowana, token nadal można anulować kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-174">If the antecedent is not canceled, the token can still be used to cancel the continuation.</span></span>  
  
 [!code-csharp[TPL_Continuations#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/cancellation1.cs#3)]
 [!code-vb[TPL_Continuations#3](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/cancellation1.vb#3)]  
  
 <span data-ttu-id="37aff-175">Możesz również uniemożliwić kontynuacji wykonania, jeśli jego antecedent zostało anulowane bez podawania kontynuacji token anulowania, określając <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnCanceled?displayProperty=nameWithType> podczas tworzenia kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-175">You can also prevent a continuation from executing if its antecedent is canceled without supplying the continuation a cancellation token by specifying the <xref:System.Threading.Tasks.TaskContinuationOptions.NotOnCanceled?displayProperty=nameWithType> option when you create the continuation.</span></span> <span data-ttu-id="37aff-176">Poniżej przedstawiono prosty przykład.</span><span class="sxs-lookup"><span data-stu-id="37aff-176">The following is a simple example.</span></span>  
  
 [!code-csharp[TPL_Continuations#8](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/cancellation2.cs#8)]
 [!code-vb[TPL_Continuations#8](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/cancellation2.vb#8)]  
  
 <span data-ttu-id="37aff-177">Po kontynuacji przechodzi w stan <xref:System.Threading.Tasks.TaskStatus.Canceled> stan może mieć wpływ na kontynuacje, które należy wykonać, w zależności od <xref:System.Threading.Tasks.TaskContinuationOptions> dla tych kontynuacje określono.</span><span class="sxs-lookup"><span data-stu-id="37aff-177">After a continuation goes into the <xref:System.Threading.Tasks.TaskStatus.Canceled> state, it may affect continuations that follow, depending on the <xref:System.Threading.Tasks.TaskContinuationOptions> that were specified for those continuations.</span></span>  
  
 <span data-ttu-id="37aff-178">Nie można uruchomić kontynuacje, które zostały usunięte.</span><span class="sxs-lookup"><span data-stu-id="37aff-178">Continuations that are disposed will not start.</span></span>  
  
## <a name="continuations-and-child-tasks"></a><span data-ttu-id="37aff-179">Kontynuacje i zadania podrzędne</span><span class="sxs-lookup"><span data-stu-id="37aff-179">Continuations and Child Tasks</span></span>  
 <span data-ttu-id="37aff-180">Kontynuacja nie działa do momentu antecedent i wszystkie jego zadań podrzędnych dołączonych została ukończona.</span><span class="sxs-lookup"><span data-stu-id="37aff-180">A continuation does not run until the antecedent and all of its attached child tasks have completed.</span></span> <span data-ttu-id="37aff-181">Kontynuacji bez oczekiwania na zakończenie zadań podrzędnych odłączony.</span><span class="sxs-lookup"><span data-stu-id="37aff-181">The continuation does not wait for detached child tasks to finish.</span></span> <span data-ttu-id="37aff-182">Dwa poniższe przykłady przedstawiają zadań podrzędnych dołączonych do i odłączyć od antecedent, która tworzy utrzymania.</span><span class="sxs-lookup"><span data-stu-id="37aff-182">The following two examples illustrate child tasks that are attached to and detached from an antecedent that creates a continuation.</span></span> <span data-ttu-id="37aff-183">W poniższym przykładzie kontynuacji uruchamia dopiero po zakończeniu wykonywania wszystkich zadań podrzędnych i identyczne systemem generuje wiele razy w przykładzie danych wyjściowych zawsze.</span><span class="sxs-lookup"><span data-stu-id="37aff-183">In the following example, the continuation runs only after all child tasks have completed, and running the example multiple times produces identical output each time.</span></span> <span data-ttu-id="37aff-184">Należy pamiętać, że przykładzie uruchamia antecedent wywołując <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType> metody, ponieważ domyślnie <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> metoda tworzy zadaniem nadrzędnym, którego domyślna opcja tworzenia zadań jest <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="37aff-184">Note that the example launches the antecedent by calling the <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType> method, since by default the <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> method creates a parent task whose default task creation option is <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[TPL_Continuations#9](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/attached1.cs#9)]
 [!code-vb[TPL_Continuations#9](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/attached1.vb#9)]  
  
 <span data-ttu-id="37aff-185">Jeśli zadania podrzędne są odłączone od antecedent, jednak kontynuacji działa jak antecedent został zakończony, bez względu na stan zadania podrzędne.</span><span class="sxs-lookup"><span data-stu-id="37aff-185">If child tasks are detached from the antecedent, however, the continuation runs as soon as the antecedent has terminated, regardless of the state of the child tasks.</span></span> <span data-ttu-id="37aff-186">W związku z tym wiele przebiegów w poniższym przykładzie można utworzyć zmiennej danych wyjściowych, która zależy od sposobu harmonogram zadań obsługi każdego zadania podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="37aff-186">As a result, multiple runs of the following example can produce variable output that depends on how the task scheduler handled each child task.</span></span>  
  
 [!code-csharp[TPL_Continuations#10](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/detached1.cs#10)]
 [!code-vb[TPL_Continuations#10](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/detached1.vb#10)]  
  
 <span data-ttu-id="37aff-187">Stan końcowy poprzedzających zadania zależy od żadnych zadań podrzędnych dołączonych stan końcowy.</span><span class="sxs-lookup"><span data-stu-id="37aff-187">The final status of the antecedent task depends on the final status of any attached child tasks.</span></span> <span data-ttu-id="37aff-188">Stan zadania podrzędne odłączony nie ma wpływu na element nadrzędny.</span><span class="sxs-lookup"><span data-stu-id="37aff-188">The status of detached child tasks does not affect the parent.</span></span> <span data-ttu-id="37aff-189">Aby uzyskać więcej informacji, zobacz [dołączonego i odłączone zadania podrzędne](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="37aff-189">For more information, see [Attached and Detached Child Tasks](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span></span>  
  
## <a name="associating-state-with-continuations"></a><span data-ttu-id="37aff-190">Kojarzenie z Kontynuacje stanu</span><span class="sxs-lookup"><span data-stu-id="37aff-190">Associating State with Continuations</span></span>  
 <span data-ttu-id="37aff-191">Stan dowolnego można skojarzyć z kontynuacji zadań.</span><span class="sxs-lookup"><span data-stu-id="37aff-191">You can associate arbitrary state with a task continuation.</span></span> <span data-ttu-id="37aff-192"><xref:System.Threading.Tasks.Task.ContinueWith%2A> Metoda zapewnia przeciążone wersje każdego podjęcia <xref:System.Object> wartość, która reprezentuje stan kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-192">The <xref:System.Threading.Tasks.Task.ContinueWith%2A> method provides overloaded versions that each take an <xref:System.Object> value that represents the state of the continuation.</span></span> <span data-ttu-id="37aff-193">Ten obiekt stanu może później dostęp przy użyciu <xref:System.Threading.Tasks.Task.AsyncState%2A?displayProperty=nameWithType> właściwości.</span><span class="sxs-lookup"><span data-stu-id="37aff-193">You can later access this state object by using the <xref:System.Threading.Tasks.Task.AsyncState%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="37aff-194">Ten obiekt stanu jest `null` , jeśli nie zostanie określona wartość.</span><span class="sxs-lookup"><span data-stu-id="37aff-194">This state object is `null` if you do not provide a value.</span></span>  
  
 <span data-ttu-id="37aff-195">Stan kontynuacji jest przydatne, jeśli Konwertuj istniejący kod, który używa [asynchronicznego programowania modelu (APM)](../../../docs/standard/asynchronous-programming-patterns/asynchronous-programming-model-apm.md) do użycia TPL.</span><span class="sxs-lookup"><span data-stu-id="37aff-195">Continuation state is useful when you convert existing code that uses the [Asynchronous Programming Model (APM)](../../../docs/standard/asynchronous-programming-patterns/asynchronous-programming-model-apm.md) to use the TPL.</span></span> <span data-ttu-id="37aff-196">Zwykle w APM, można zapewnić stan obiektu w  **rozpocząć*metody*** — metoda i nowszym dostępu, który stanu przy użyciu <xref:System.IAsyncResult.AsyncState%2A?displayProperty=nameWithType> właściwości.</span><span class="sxs-lookup"><span data-stu-id="37aff-196">In the APM, you typically provide object state in the **Begin*Method*** method and later access that state by using the <xref:System.IAsyncResult.AsyncState%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="37aff-197">Za pomocą <xref:System.Threading.Tasks.Task.ContinueWith%2A> metody, można zachować ten stan podczas konwertowania kod, który używa APM do użycia TPL.</span><span class="sxs-lookup"><span data-stu-id="37aff-197">By using the <xref:System.Threading.Tasks.Task.ContinueWith%2A> method, you can preserve this state when you convert code that uses the APM to use the TPL.</span></span>  
  
 <span data-ttu-id="37aff-198">Stan kontynuacji również może być przydatna podczas pracy z <xref:System.Threading.Tasks.Task> obiekty w [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] debugera.</span><span class="sxs-lookup"><span data-stu-id="37aff-198">Continuation state can also be useful when you work with <xref:System.Threading.Tasks.Task> objects in the [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] debugger.</span></span> <span data-ttu-id="37aff-199">Na przykład w **zadań równoległych** okna, **zadań** kolumny Wyświetla reprezentację ciągu obiektu stanu dla każdego zadania.</span><span class="sxs-lookup"><span data-stu-id="37aff-199">For example, in the **Parallel Tasks** window, the **Task** column displays the string representation of the state object for each task.</span></span> <span data-ttu-id="37aff-200">Aby uzyskać więcej informacji na temat **zadań równoległych** okna, zobacz [korzystanie z okna zadań](/visualstudio/debugger/using-the-tasks-window).</span><span class="sxs-lookup"><span data-stu-id="37aff-200">For more information about the **Parallel Tasks** window, see [Using the Tasks Window](/visualstudio/debugger/using-the-tasks-window).</span></span>  
  
 <span data-ttu-id="37aff-201">Poniższy przykład przedstawia użycie stan kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-201">The following example shows how to use continuation state.</span></span> <span data-ttu-id="37aff-202">Tworzy łańcuch zadań kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-202">It creates a chain of continuation tasks.</span></span> <span data-ttu-id="37aff-203">Każde zadanie zawiera bieżący czas <xref:System.DateTime> obiektu, dla `state` parametr <xref:System.Threading.Tasks.Task.ContinueWith%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="37aff-203">Each task provides the current time, a <xref:System.DateTime> object, for the `state` parameter of the <xref:System.Threading.Tasks.Task.ContinueWith%2A> method.</span></span> <span data-ttu-id="37aff-204">Każdy <xref:System.DateTime> obiekt reprezentuje czas, o której została utworzona zadania kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-204">Each <xref:System.DateTime> object represents the time at which the continuation task is created.</span></span> <span data-ttu-id="37aff-205">Każde zadanie tworzy jako wynik drugi <xref:System.DateTime> obiekt, który reprezentuje czas, w którym kończy zadanie.</span><span class="sxs-lookup"><span data-stu-id="37aff-205">Each task produces as its result a second <xref:System.DateTime> object that represents the time at which the task finishes.</span></span> <span data-ttu-id="37aff-206">Po zakończeniu wszystkich zadań, w tym przykładzie wyświetla czas tworzenia i czasu, w którym każdy kontynuacji kończy zadanie.</span><span class="sxs-lookup"><span data-stu-id="37aff-206">After all tasks finish, this example displays the creation time and the time at which each continuation task finishes.</span></span>  
  
 [!code-csharp[TPL_ContinuationState#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuationstate/cs/continuationstate.cs#1)]
 [!code-vb[TPL_ContinuationState#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuationstate/vb/continuationstate.vb#1)]  
  
## <a name="handling-exceptions-thrown-from-continuations"></a><span data-ttu-id="37aff-207">Obsługa wyjątków zgłaszanych przez Kontynuacje</span><span class="sxs-lookup"><span data-stu-id="37aff-207">Handling Exceptions Thrown from Continuations</span></span>  
 <span data-ttu-id="37aff-208">Relacja kontynuacji antecedent nie jest w relacji nadrzędny podrzędny.</span><span class="sxs-lookup"><span data-stu-id="37aff-208">An antecedent-continuation relationship is not a parent-child relationship.</span></span> <span data-ttu-id="37aff-209">Wyjątki generowane przez kontynuacje nie są propagowane do antecedent.</span><span class="sxs-lookup"><span data-stu-id="37aff-209">Exceptions thrown by continuations are not propagated to the antecedent.</span></span> <span data-ttu-id="37aff-210">W związku z tym obsługa wyjątków zgłaszanych przez kontynuacje, jak będzie je obsłużyć w następujący sposób w innych zadań:</span><span class="sxs-lookup"><span data-stu-id="37aff-210">Therefore, handle exceptions thrown by continuations as you would handle them in any other task, as follows:</span></span>  
  
-   <span data-ttu-id="37aff-211">Można użyć <xref:System.Threading.Tasks.Task.Wait%2A>, <xref:System.Threading.Tasks.Task.WaitAll%2A>, lub <xref:System.Threading.Tasks.Task.WaitAny%2A> metody lub jego ogólny odpowiednik, oczekiwanie na kontynuowanie.</span><span class="sxs-lookup"><span data-stu-id="37aff-211">You can use the <xref:System.Threading.Tasks.Task.Wait%2A>, <xref:System.Threading.Tasks.Task.WaitAll%2A>, or <xref:System.Threading.Tasks.Task.WaitAny%2A> method, or its generic counterpart, to wait on the continuation.</span></span> <span data-ttu-id="37aff-212">Poczekaj antecedent i jego kontynuacje w tym samym `try` instrukcji, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="37aff-212">You can wait for an antecedent and its continuations in the same `try` statement, as shown in the following example.</span></span>  
  
     [!code-csharp[TPL_Continuations#6](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/exception1.cs#6)]
     [!code-vb[TPL_Continuations#6](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/exception1.vb#6)]  
  
-   <span data-ttu-id="37aff-213">Można obserwować drugi kontynuacji <xref:System.Threading.Tasks.Task.Exception%2A> właściwości pierwszy kontynuacji.</span><span class="sxs-lookup"><span data-stu-id="37aff-213">You can use a second continuation to observe the <xref:System.Threading.Tasks.Task.Exception%2A> property of the first continuation.</span></span> <span data-ttu-id="37aff-214">W poniższym przykładzie zadanie próbuje odczytać z pliku nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="37aff-214">In the following example, a task attempts to read from a non-existent file.</span></span> <span data-ttu-id="37aff-215">Następnie kontynuacji Wyświetla informacje o wyjątku w poprzedzających zadań.</span><span class="sxs-lookup"><span data-stu-id="37aff-215">The continuation then displays information about the exception in the antecedent task.</span></span>  
  
     [!code-csharp[TPL_Continuations#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/exception2.cs#4)]
     [!code-vb[TPL_Continuations#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/exception2.vb#4)]  
  
     <span data-ttu-id="37aff-216">Ponieważ zostało uruchomione z <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnFaulted?displayProperty=nameWithType> opcji kontynuacji wykonuje tylko w przypadku wystąpienia wyjątku w antecedent i dlatego jego można założyć, że antecedent <xref:System.Threading.Tasks.Task.Exception%2A> właściwość nie jest `null`.</span><span class="sxs-lookup"><span data-stu-id="37aff-216">Because it was run with the <xref:System.Threading.Tasks.TaskContinuationOptions.OnlyOnFaulted?displayProperty=nameWithType> option, the continuation executes only if an exception occurs in the antecedent, and therefore it can assume that the antecedent's <xref:System.Threading.Tasks.Task.Exception%2A> property is not `null`.</span></span> <span data-ttu-id="37aff-217">Jeśli kontynuacji wykonuje, czy wyjątek w antecedent, będą musiały być Sprawdź, czy antecedent <xref:System.Threading.Tasks.Task.Exception%2A> właściwość nie jest `null` przed podjęciem próby obsłużyć wyjątek, jako poniższy fragment kodu przedstawia.</span><span class="sxs-lookup"><span data-stu-id="37aff-217">If the continuation executes whether or not an exception is thrown in the antecedent, it would have to check whether the antecedent's <xref:System.Threading.Tasks.Task.Exception%2A> property is not `null` before attempting to handle the exception, as the following code fragment shows.</span></span>  
  
     [!code-csharp[TPL_Continuations#11](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_continuations/cs/exception2.cs#11)]
     [!code-vb[TPL_Continuations#11](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_continuations/vb/exception2.vb#11)]  
  
     <span data-ttu-id="37aff-218">Aby uzyskać więcej informacji, zobacz [obsługi wyjątków](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md) i [NIB: porady: obsługa wyjątków zgłaszanych przez zadania](http://msdn.microsoft.com/en-us/d6c47ec8-9de9-4880-beb3-ff19ae51565d).</span><span class="sxs-lookup"><span data-stu-id="37aff-218">For more information, see [Exception Handling](../../../docs/standard/parallel-programming/exception-handling-task-parallel-library.md) and [NIB: How to: Handle Exceptions Thrown by Tasks](http://msdn.microsoft.com/en-us/d6c47ec8-9de9-4880-beb3-ff19ae51565d).</span></span>  
  
-   <span data-ttu-id="37aff-219">Jeśli kontynuacji jest zadania podrzędnego dołączone, który został utworzony przy użyciu <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType> opcji jego wyjątki będą przekazywane przez nadrzędny powrót do wywoływania wątku, jak w przypadku innych podrzędnych dołączonych.</span><span class="sxs-lookup"><span data-stu-id="37aff-219">If the continuation is an attached child task that was created by using the <xref:System.Threading.Tasks.TaskContinuationOptions.AttachedToParent?displayProperty=nameWithType> option, its exceptions will be propagated by the parent back to the calling thread, as is the case in any other attached child.</span></span> <span data-ttu-id="37aff-220">Aby uzyskać więcej informacji, zobacz [dołączonego i odłączone zadania podrzędne](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="37aff-220">For more information, see [Attached and Detached Child Tasks](../../../docs/standard/parallel-programming/attached-and-detached-child-tasks.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37aff-221">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="37aff-221">See Also</span></span>  
 [<span data-ttu-id="37aff-222">Biblioteka zadań równoległych (TPL)</span><span class="sxs-lookup"><span data-stu-id="37aff-222">Task Parallel Library (TPL)</span></span>](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md)
