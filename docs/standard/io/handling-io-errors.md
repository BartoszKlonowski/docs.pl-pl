---
title: Obsługa błędów we/wy w programie .NET
ms.date: 08/27/2018
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- I/O, exception handling
- I/O, errors
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 51eb0e758f1ae8fb41c842ef9b32a9f8928af9ac
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/30/2019
ms.locfileid: "73120740"
---
# <a name="handling-io-errors-in-net"></a><span data-ttu-id="0e9f7-102">Obsługa błędów we/wy w programie .NET</span><span class="sxs-lookup"><span data-stu-id="0e9f7-102">Handling I/O errors in .NET</span></span>

<span data-ttu-id="0e9f7-103">Oprócz wyjątków, które mogą być zgłaszane w przypadku dowolnego wywołania metody (na przykład <xref:System.OutOfMemoryException> w przypadku naciskania systemu lub <xref:System.NullReferenceException> z powodu błędu programisty), metody systemu plików .NET mogą zgłosić następujące wyjątki:</span><span class="sxs-lookup"><span data-stu-id="0e9f7-103">In addition to the exceptions that can be thrown in any method call (such as an <xref:System.OutOfMemoryException> when a system is stressed or an <xref:System.NullReferenceException> due to programmer error), .NET file system methods can throw the following exceptions:</span></span>

- <span data-ttu-id="0e9f7-104"><xref:System.IO.IOException?displayProperty=nameWithType>, Klasa bazowa wszystkich typów wyjątków <xref:System.IO>.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-104"><xref:System.IO.IOException?displayProperty=nameWithType>, the base class of all <xref:System.IO> exception types.</span></span> <span data-ttu-id="0e9f7-105">Jest zgłaszany w przypadku błędów, których kody powrotne z systemu operacyjnego nie są bezpośrednio mapowane do żadnego innego typu wyjątku.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-105">It is thrown for errors whose return codes from the operating system don't directly map to any other exception type.</span></span>
- <span data-ttu-id="0e9f7-106"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="0e9f7-106"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="0e9f7-107"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="0e9f7-107"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="0e9f7-108"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="0e9f7-108"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="0e9f7-109"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="0e9f7-109"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="0e9f7-110"><xref:System.OperationCanceledException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="0e9f7-110"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="0e9f7-111"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="0e9f7-111"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="0e9f7-112"><xref:System.ArgumentException?displayProperty=nameWithType>, który jest generowany dla nieprawidłowych znaków ścieżki w .NET Framework i na platformie .NET Core 2,0 i wcześniejszych wersjach.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-112"><xref:System.ArgumentException?displayProperty=nameWithType>, which is thrown for invalid path characters on .NET Framework and on .NET Core 2.0 and previous versions.</span></span>
- <span data-ttu-id="0e9f7-113"><xref:System.NotSupportedException?displayProperty=nameWithType>, który jest generowany dla nieprawidłowych dwukropków w .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-113"><xref:System.NotSupportedException?displayProperty=nameWithType>, which is thrown for invalid colons in .NET Framework.</span></span>
- <span data-ttu-id="0e9f7-114"><xref:System.Security.SecurityException?displayProperty=nameWithType>, który jest generowany w przypadku aplikacji działających w ograniczonej relacji zaufania, które nie mają wymaganych uprawnień tylko .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-114"><xref:System.Security.SecurityException?displayProperty=nameWithType>, which is thrown for applications running in limited trust that lack the necessary permissions on .NET Framework only.</span></span> <span data-ttu-id="0e9f7-115">(Pełne zaufanie jest wartością domyślną w .NET Framework).</span><span class="sxs-lookup"><span data-stu-id="0e9f7-115">(Full trust is the default on .NET Framework.)</span></span>

## <a name="mapping-error-codes-to-exceptions"></a><span data-ttu-id="0e9f7-116">Mapowanie kodów błędów na wyjątki</span><span class="sxs-lookup"><span data-stu-id="0e9f7-116">Mapping error codes to exceptions</span></span>

<span data-ttu-id="0e9f7-117">Ponieważ system plików jest zasobem systemu operacyjnego, metody we/wy w oprogramowaniu .NET Core i .NET Framework zawijają wywołania do bazowego systemu operacyjnego.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-117">Because the file system is an operating system resource, I/O methods in both .NET Core and .NET Framework wrap calls to the underlying operating system.</span></span> <span data-ttu-id="0e9f7-118">Gdy w kodzie wykonywanym przez system operacyjny wystąpi błąd we/wy, system operacyjny zwraca informacje o błędzie do metody we/wy platformy .NET.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-118">When an I/O error occurs in code executed by the operating system, the operating system returns error information to the .NET I/O method.</span></span> <span data-ttu-id="0e9f7-119">Następnie metoda tłumaczy informacje o błędzie, zazwyczaj w postaci kodu błędu, do typu wyjątku platformy .NET.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-119">The method then translates the error information, typically in the form of an error code, into a .NET exception type.</span></span> <span data-ttu-id="0e9f7-120">W większości przypadków robi to przez bezpośrednie przekazanie kodu błędu do odpowiadającego mu typu wyjątku; nie wykonuje żadnego specjalnego mapowania błędu na podstawie kontekstu wywołania metody.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-120">In most cases, it does this by directly translating the error code into its corresponding exception type; it does not perform any special mapping of the error based on the context of the method call.</span></span>

<span data-ttu-id="0e9f7-121">Na przykład w systemie operacyjnym Windows wywołanie metody zwracające kod błędu `ERROR_FILE_NOT_FOUND` (lub 0x02) mapuje do <xref:System.IO.FileNotFoundException>, a kod błędu `ERROR_PATH_NOT_FOUND` (lub 0x03) mapuje na <xref:System.IO.DirectoryNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-121">For example, on the Windows operating system, a method call that returns an error code of `ERROR_FILE_NOT_FOUND` (or 0x02) maps to a <xref:System.IO.FileNotFoundException>, and an error code of `ERROR_PATH_NOT_FOUND` (or 0x03) maps to a <xref:System.IO.DirectoryNotFoundException>.</span></span>

<span data-ttu-id="0e9f7-122">Jednak precyzyjne warunki, w których system operacyjny zwraca określone kody błędów, są często nieudokumentowane lub źle udokumentowane.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-122">However, the precise conditions under which the operating system returns particular error codes is often undocumented or poorly documented.</span></span> <span data-ttu-id="0e9f7-123">W związku z tym mogą wystąpić nieoczekiwane wyjątki.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-123">As a result, unexpected exceptions can occur.</span></span> <span data-ttu-id="0e9f7-124">Na przykład, ponieważ pracujesz z katalogiem, a nie plikiem, należy się spodziewać, że podawanie nieprawidłowej ścieżki katalogu do konstruktora <xref:System.IO.DirectoryInfo.%23ctor%2A?displayProperty=nameWithType> zgłosi <xref:System.IO.DirectoryNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-124">For example, because you are working with a directory rather than a file, you would expect that providing an invalid directory path to the <xref:System.IO.DirectoryInfo.%23ctor%2A?displayProperty=nameWithType> constructor throws a <xref:System.IO.DirectoryNotFoundException>.</span></span> <span data-ttu-id="0e9f7-125">Jednak może ona również zgłosić <xref:System.IO.FileNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-125">However, it may also throw a <xref:System.IO.FileNotFoundException>.</span></span>

## <a name="exception-handling-in-io-operations"></a><span data-ttu-id="0e9f7-126">Obsługa wyjątków w operacjach we/wy</span><span class="sxs-lookup"><span data-stu-id="0e9f7-126">Exception handling in I/O operations</span></span>

<span data-ttu-id="0e9f7-127">Ze względu na to, że jest to zależność od systemu operacyjnego, identyczne warunki wyjątków (takie jak błąd nie znaleziono katalogu w naszym przykładzie) mogą spowodować, że metoda we/wy zgłasza jedną z wielu wyjątków we/wy.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-127">Because of this reliance on the operating system, identical exception conditions (such as the directory not found error in our example) can result in an I/O method throwing any one of the entire class of I/O exceptions.</span></span> <span data-ttu-id="0e9f7-128">Oznacza to, że podczas wywoływania interfejsów API we/wy kod powinien zostać przygotowany do obsługi większości lub wszystkich tych wyjątków, jak pokazano w poniższej tabeli:</span><span class="sxs-lookup"><span data-stu-id="0e9f7-128">This means that, when calling I/O APIs, your code should be prepared to handle most or all of these exceptions, as shown in the following table:</span></span>

| <span data-ttu-id="0e9f7-129">Typ wyjątku</span><span class="sxs-lookup"><span data-stu-id="0e9f7-129">Exception type</span></span> | <span data-ttu-id="0e9f7-130">.NET Core</span><span class="sxs-lookup"><span data-stu-id="0e9f7-130">.NET Core</span></span> | <span data-ttu-id="0e9f7-131">.NET Framework</span><span class="sxs-lookup"><span data-stu-id="0e9f7-131">.NET Framework</span></span> |
|---|---|---|
| <xref:System.IO.IOException> | <span data-ttu-id="0e9f7-132">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-132">Yes</span></span> | <span data-ttu-id="0e9f7-133">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-133">Yes</span></span> |
| <xref:System.IO.FileNotFoundException> | <span data-ttu-id="0e9f7-134">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-134">Yes</span></span> | <span data-ttu-id="0e9f7-135">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-135">Yes</span></span> |
| <xref:System.IO.DirectoryNotFoundException> | <span data-ttu-id="0e9f7-136">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-136">Yes</span></span> | <span data-ttu-id="0e9f7-137">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-137">Yes</span></span> |
| <xref:System.IO.DriveNotFoundException?> | <span data-ttu-id="0e9f7-138">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-138">Yes</span></span> | <span data-ttu-id="0e9f7-139">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-139">Yes</span></span> |
| <xref:System.IO.PathTooLongException> | <span data-ttu-id="0e9f7-140">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-140">Yes</span></span> | <span data-ttu-id="0e9f7-141">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-141">Yes</span></span> |
| <xref:System.OperationCanceledException> | <span data-ttu-id="0e9f7-142">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-142">Yes</span></span> | <span data-ttu-id="0e9f7-143">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-143">Yes</span></span> |
| <xref:System.UnauthorizedAccessException> | <span data-ttu-id="0e9f7-144">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-144">Yes</span></span> | <span data-ttu-id="0e9f7-145">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-145">Yes</span></span> |
| <xref:System.ArgumentException> | <span data-ttu-id="0e9f7-146">.NET Core 2,0 i starsze</span><span class="sxs-lookup"><span data-stu-id="0e9f7-146">.NET Core 2.0 and earlier</span></span>| <span data-ttu-id="0e9f7-147">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-147">Yes</span></span> |
| <xref:System.NotSupportedException> | <span data-ttu-id="0e9f7-148">Nie</span><span class="sxs-lookup"><span data-stu-id="0e9f7-148">No</span></span> | <span data-ttu-id="0e9f7-149">Tak</span><span class="sxs-lookup"><span data-stu-id="0e9f7-149">Yes</span></span> |
| <xref:System.Security.SecurityException> | <span data-ttu-id="0e9f7-150">Nie</span><span class="sxs-lookup"><span data-stu-id="0e9f7-150">No</span></span> | <span data-ttu-id="0e9f7-151">Tylko ograniczone zaufanie</span><span class="sxs-lookup"><span data-stu-id="0e9f7-151">Limited trust only</span></span> |

## <a name="handling-ioexception"></a><span data-ttu-id="0e9f7-152">Obsługa IOException</span><span class="sxs-lookup"><span data-stu-id="0e9f7-152">Handling IOException</span></span>

<span data-ttu-id="0e9f7-153">Jako klasa bazowa dla wyjątków w przestrzeni nazw <xref:System.IO>, <xref:System.IO.IOException> jest również zgłaszane dla każdego kodu błędu, który nie jest mapowany do wstępnie zdefiniowanego typu wyjątku.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-153">As the base class for exceptions in the <xref:System.IO> namespace, <xref:System.IO.IOException> is also thrown for any error code that does not map to a predefined exception type.</span></span> <span data-ttu-id="0e9f7-154">Oznacza to, że może być zgłaszane przez dowolną operację we/wy.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-154">This means that it can be thrown by any I/O operation.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="0e9f7-155">Ponieważ <xref:System.IO.IOException> jest klasą bazową innych typów wyjątków w przestrzeni nazw <xref:System.IO>, należy obsłużyć w bloku `catch` po obsłudze innych wyjątków związanych z innymi we/wy.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-155">Because <xref:System.IO.IOException> is the base class of the other exception types in the <xref:System.IO> namespace, you should handle in a `catch` block after you've handled the other I/O-related exceptions.</span></span>

<span data-ttu-id="0e9f7-156">Oprócz tego, począwszy od platformy .NET Core 2,1, walidacja sprawdza poprawność ścieżki (na przykład w celu upewnienia się, że nieprawidłowe znaki nie są obecne w ścieżce), a środowisko uruchomieniowe zgłasza wyjątek mapowany z kodu błędu systemu operacyjnego zamiast z własnego kodu sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-156">In addition, starting with .NET Core 2.1, validation checks for path correctness (for example, to ensure that invalid characters are not present in a path) have been removed, and the runtime throws an exception mapped from an operating system error code rather than from its own validation code.</span></span> <span data-ttu-id="0e9f7-157">Najprawdopodobniej wyjątek, który ma zostać zgłoszony w tym przypadku, jest <xref:System.IO.IOException>, mimo że może być również wygenerowany jakikolwiek inny typ wyjątku.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-157">The most likely exception to be thrown in this case is an <xref:System.IO.IOException>, although any other exception type could also be thrown.</span></span>

<span data-ttu-id="0e9f7-158">Należy pamiętać, że w kodzie obsługi wyjątków zawsze należy obsłużyć ostatnią <xref:System.IO.IOException>.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-158">Note that, in your exception handling code, you should always handle the <xref:System.IO.IOException> last.</span></span> <span data-ttu-id="0e9f7-159">W przeciwnym razie, ponieważ jest klasą bazową wszystkich innych wyjątków we/wy, bloki catch klas pochodnych nie zostaną ocenione.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-159">Otherwise, because it is the base class of all other IO exceptions, the catch blocks of derived classes will not be evaluated.</span></span>

<span data-ttu-id="0e9f7-160">W przypadku <xref:System.IO.IOException>można uzyskać dodatkowe informacje o błędzie z właściwości [IOException. HRESULT](xref:System.Exception.HResult) .</span><span class="sxs-lookup"><span data-stu-id="0e9f7-160">In the case of an <xref:System.IO.IOException>, you can get additional error information from the [IOException.HResult](xref:System.Exception.HResult) property.</span></span> <span data-ttu-id="0e9f7-161">Aby przekonwertować wartość HResult na kod błędu Win32, należy rozdzielić górne 16 bitów wartości 32-bitowej.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-161">To convert the HResult value to a Win32 error code, you strip out the upper 16 bits of the 32-bit value.</span></span> <span data-ttu-id="0e9f7-162">Poniższa tabela zawiera listę kodów błędów, które mogą być opakowane w <xref:System.IO.IOException>.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-162">The following table lists error codes that may be wrapped in an <xref:System.IO.IOException>.</span></span>

| <span data-ttu-id="0e9f7-163">Wynik</span><span class="sxs-lookup"><span data-stu-id="0e9f7-163">HResult</span></span> | <span data-ttu-id="0e9f7-164">Stała</span><span class="sxs-lookup"><span data-stu-id="0e9f7-164">Constant</span></span> | <span data-ttu-id="0e9f7-165">Opis</span><span class="sxs-lookup"><span data-stu-id="0e9f7-165">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="0e9f7-166">ERROR_SHARING_VIOLATION</span><span class="sxs-lookup"><span data-stu-id="0e9f7-166">ERROR_SHARING_VIOLATION</span></span> | <span data-ttu-id="0e9f7-167">32</span><span class="sxs-lookup"><span data-stu-id="0e9f7-167">32</span></span> | <span data-ttu-id="0e9f7-168">Brak nazwy pliku lub plik lub katalog jest używany.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-168">The file name is missing, or the file or directory is in use.</span></span> |
| <span data-ttu-id="0e9f7-169">ERROR_FILE_EXISTS</span><span class="sxs-lookup"><span data-stu-id="0e9f7-169">ERROR_FILE_EXISTS</span></span> | <span data-ttu-id="0e9f7-170">80</span><span class="sxs-lookup"><span data-stu-id="0e9f7-170">80</span></span> | <span data-ttu-id="0e9f7-171">Plik już istnieje.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-171">The file already exists.</span></span> |
| <span data-ttu-id="0e9f7-172">ERROR_INVALID_PARAMETER</span><span class="sxs-lookup"><span data-stu-id="0e9f7-172">ERROR_INVALID_PARAMETER</span></span> | <span data-ttu-id="0e9f7-173">87</span><span class="sxs-lookup"><span data-stu-id="0e9f7-173">87</span></span> | <span data-ttu-id="0e9f7-174">Argument przekazany do metody jest nieprawidłowy.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-174">An argument supplied to the method is invalid.</span></span> |
| <span data-ttu-id="0e9f7-175">ERROR_ALREADY_EXISTS</span><span class="sxs-lookup"><span data-stu-id="0e9f7-175">ERROR_ALREADY_EXISTS</span></span> | <span data-ttu-id="0e9f7-176">183</span><span class="sxs-lookup"><span data-stu-id="0e9f7-176">183</span></span> | <span data-ttu-id="0e9f7-177">Plik lub katalog już istnieje.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-177">The file or directory already exists.</span></span> |

<span data-ttu-id="0e9f7-178">Można je obsłużyć za pomocą klauzuli `When` w instrukcji catch, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="0e9f7-178">You can handle these using a `When` clause in a catch statement, as the following example shows.</span></span>

[!code-csharp[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/cs/io-exceptions.cs)]
[!code-vb[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/vb/io-exceptions.vb)]

## <a name="see-also"></a><span data-ttu-id="0e9f7-179">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="0e9f7-179">See also</span></span>

- [<span data-ttu-id="0e9f7-180">Obsługa i zgłaszanie wyjątków w programie .NET</span><span class="sxs-lookup"><span data-stu-id="0e9f7-180">Handling and throwing exceptions in .NET</span></span>](../exceptions/index.md)
- [<span data-ttu-id="0e9f7-181">Obsługa wyjątków (Biblioteka zadań równoległych)</span><span class="sxs-lookup"><span data-stu-id="0e9f7-181">Exception handling (Task Parallel Library)</span></span>](../parallel-programming/exception-handling-task-parallel-library.md)
- [<span data-ttu-id="0e9f7-182">Najlepsze rozwiązania dotyczące wyjątków</span><span class="sxs-lookup"><span data-stu-id="0e9f7-182">Best practices for exceptions</span></span>](../exceptions/best-practices-for-exceptions.md)
- [<span data-ttu-id="0e9f7-183">Jak używać określonych wyjątków w bloku catch</span><span class="sxs-lookup"><span data-stu-id="0e9f7-183">How to use specific exceptions in a catch block</span></span>](../exceptions/how-to-use-specific-exceptions-in-a-catch-block.md)
