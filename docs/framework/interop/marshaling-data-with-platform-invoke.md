---
title: Organizowanie danych w wywołaniu platformy
description: Kierowanie danych za pomocą wywołania platformy na platformie .NET. Zobacz listę typów danych używanych w interfejsach API systemu Windows i funkcje w stylu C, a następnie Znajdź odpowiadające im typy zarządzane przez platformę .NET.
ms.date: 03/20/2019
dev_langs:
- cpp
helpviewer_keywords:
- platform invoke, marshaling data
- data marshaling, platform invoke
- marshaling, platform invoke
ms.assetid: dc5c76cf-7b12-406f-b79c-d1a023ec245d
ms.openlocfilehash: 27045790780c1eef9537bdf7e52deb579e2b467c
ms.sourcegitcommit: 3824ff187947572b274b9715b60c11269335c181
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/17/2020
ms.locfileid: "84904107"
---
# <a name="marshaling-data-with-platform-invoke"></a><span data-ttu-id="35792-104">Organizowanie danych w wywołaniu platformy</span><span class="sxs-lookup"><span data-stu-id="35792-104">Marshaling Data with Platform Invoke</span></span>

<span data-ttu-id="35792-105">Aby wywoływać funkcje wyeksportowane z biblioteki niezarządzanej, aplikacja .NET Framework wymaga prototypu funkcji w zarządzanym kodzie, który reprezentuje niezarządzaną funkcję.</span><span class="sxs-lookup"><span data-stu-id="35792-105">To call functions exported from an unmanaged library, a .NET Framework application requires a function prototype in managed code that represents the unmanaged function.</span></span> <span data-ttu-id="35792-106">Aby utworzyć prototyp umożliwiający poprawne kierowanie danych przez wywołanie platformy, należy wykonać następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="35792-106">To create a prototype that enables platform invoke to marshal data correctly, you must do the following:</span></span>

- <span data-ttu-id="35792-107">Zastosuj <xref:System.Runtime.InteropServices.DllImportAttribute> atrybut do statycznej funkcji lub metody w kodzie zarządzanym.</span><span class="sxs-lookup"><span data-stu-id="35792-107">Apply the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute to the static function or method in managed code.</span></span>

- <span data-ttu-id="35792-108">Podstawianie typów danych zarządzanych dla niezarządzanych typów danych.</span><span class="sxs-lookup"><span data-stu-id="35792-108">Substitute managed data types for unmanaged data types.</span></span>

<span data-ttu-id="35792-109">Korzystając z dokumentacji dostarczonej z niezarządzaną funkcją, można utworzyć odpowiedni prototyp zarządzany przez zastosowanie atrybutu z opcjonalnymi polami i podstawianie typów danych zarządzanych dla typów niezarządzanych.</span><span class="sxs-lookup"><span data-stu-id="35792-109">You can use the documentation supplied with an unmanaged function to construct an equivalent managed prototype by applying the attribute with its optional fields and substituting managed data types for unmanaged types.</span></span> <span data-ttu-id="35792-110">Aby uzyskać instrukcje dotyczące sposobu zastosowania <xref:System.Runtime.InteropServices.DllImportAttribute> , zobacz Korzystanie z [niezarządzanych funkcji DLL](consuming-unmanaged-dll-functions.md).</span><span class="sxs-lookup"><span data-stu-id="35792-110">For instructions about how to apply the <xref:System.Runtime.InteropServices.DllImportAttribute>, see [Consuming Unmanaged DLL Functions](consuming-unmanaged-dll-functions.md).</span></span>

<span data-ttu-id="35792-111">Ta sekcja zawiera przykłady, które pokazują, jak utworzyć prototypy funkcji zarządzanych do przekazywania argumentów do i otrzymywania wartości zwracanych z funkcji wyeksportowanych przez biblioteki niezarządzane.</span><span class="sxs-lookup"><span data-stu-id="35792-111">This section provides samples that demonstrate how to create managed function prototypes for passing arguments to and receiving return values from functions exported by unmanaged libraries.</span></span> <span data-ttu-id="35792-112">Przykłady pokazują również, kiedy używać <xref:System.Runtime.InteropServices.MarshalAsAttribute> atrybutu i <xref:System.Runtime.InteropServices.Marshal> klasy, aby jawnie zorganizować dane.</span><span class="sxs-lookup"><span data-stu-id="35792-112">The samples also demonstrate when to use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute and the <xref:System.Runtime.InteropServices.Marshal> class to explicitly marshal data.</span></span>

## <a name="platform-invoke-data-types"></a><span data-ttu-id="35792-113">Typy danych wywołania platformy</span><span class="sxs-lookup"><span data-stu-id="35792-113">Platform invoke data types</span></span>

<span data-ttu-id="35792-114">Poniższa tabela zawiera listę typów danych używanych w interfejsach API systemu Windows i w funkcjach w stylu języka C.</span><span class="sxs-lookup"><span data-stu-id="35792-114">The following table lists data types used in the Windows APIs and C-style functions.</span></span> <span data-ttu-id="35792-115">Wiele bibliotek niezarządzanych zawiera funkcje, które przekazują te typy danych jako parametry i wartości zwracane.</span><span class="sxs-lookup"><span data-stu-id="35792-115">Many unmanaged libraries contain functions that pass these data types as parameters and return values.</span></span> <span data-ttu-id="35792-116">Trzecia kolumna zawiera listę odpowiednich .NET Framework wbudowanego typu wartości lub klasy, które są używane w kodzie zarządzanym.</span><span class="sxs-lookup"><span data-stu-id="35792-116">The third column lists the corresponding .NET Framework built-in value type or class that you use in managed code.</span></span> <span data-ttu-id="35792-117">W niektórych przypadkach można zastąpić typ o takim samym rozmiarze dla typu wymienionego w tabeli.</span><span class="sxs-lookup"><span data-stu-id="35792-117">In some cases, you can substitute a type of the same size for the type listed in the table.</span></span>

|<span data-ttu-id="35792-118">Typ niezarządzany w interfejsach API systemu Windows</span><span class="sxs-lookup"><span data-stu-id="35792-118">Unmanaged type in Windows APIs</span></span>|<span data-ttu-id="35792-119">Niezarządzany typ języka C</span><span class="sxs-lookup"><span data-stu-id="35792-119">Unmanaged C language type</span></span>|<span data-ttu-id="35792-120">Typ zarządzany</span><span class="sxs-lookup"><span data-stu-id="35792-120">Managed type</span></span>|<span data-ttu-id="35792-121">Opis</span><span class="sxs-lookup"><span data-stu-id="35792-121">Description</span></span>|
|--------------------------------|-------------------------------|------------------------|-----------------|
|`VOID`|`void`|<xref:System.Void?displayProperty=nameWithType>|<span data-ttu-id="35792-122">Zastosowano do funkcji, która nie zwraca wartości.</span><span class="sxs-lookup"><span data-stu-id="35792-122">Applied to a function that does not return a value.</span></span>|
|`HANDLE`|`void *`|<span data-ttu-id="35792-123"><xref:System.IntPtr?displayProperty=nameWithType> lub <xref:System.UIntPtr?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="35792-123"><xref:System.IntPtr?displayProperty=nameWithType> or <xref:System.UIntPtr?displayProperty=nameWithType></span></span>|<span data-ttu-id="35792-124">32 bitów w 32-bitowych systemach operacyjnych Windows, 64 BITS w systemach operacyjnych Windows w 64-bitowym.</span><span class="sxs-lookup"><span data-stu-id="35792-124">32 bits on 32-bit Windows operating systems, 64 bits on 64-bit Windows operating systems.</span></span>|
|`BYTE`|`unsigned char`|<xref:System.Byte?displayProperty=nameWithType>|<span data-ttu-id="35792-125">8 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-125">8 bits</span></span>|
|`SHORT`|`short`|<xref:System.Int16?displayProperty=nameWithType>|<span data-ttu-id="35792-126">16 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-126">16 bits</span></span>|
|`WORD`|`unsigned short`|<xref:System.UInt16?displayProperty=nameWithType>|<span data-ttu-id="35792-127">16 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-127">16 bits</span></span>|
|`INT`|`int`|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="35792-128">32 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-128">32 bits</span></span>|
|`UINT`|`unsigned int`|<xref:System.UInt32?displayProperty=nameWithType>|<span data-ttu-id="35792-129">32 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-129">32 bits</span></span>|
|`LONG`|`long`|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="35792-130">32 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-130">32 bits</span></span>|
|`BOOL`|`long`|<span data-ttu-id="35792-131"><xref:System.Boolean?displayProperty=nameWithType> lub <xref:System.Int32?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="35792-131"><xref:System.Boolean?displayProperty=nameWithType> or <xref:System.Int32?displayProperty=nameWithType></span></span>|<span data-ttu-id="35792-132">32 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-132">32 bits</span></span>|
|`DWORD`|`unsigned long`|<xref:System.UInt32?displayProperty=nameWithType>|<span data-ttu-id="35792-133">32 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-133">32 bits</span></span>|
|`ULONG`|`unsigned long`|<xref:System.UInt32?displayProperty=nameWithType>|<span data-ttu-id="35792-134">32 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-134">32 bits</span></span>|
|`CHAR`|`char`|<xref:System.Char?displayProperty=nameWithType>|<span data-ttu-id="35792-135">Dekorować z ANSI.</span><span class="sxs-lookup"><span data-stu-id="35792-135">Decorate with ANSI.</span></span>|
|`WCHAR`|`wchar_t`|<xref:System.Char?displayProperty=nameWithType>|<span data-ttu-id="35792-136">Dekorować z kodowaniem Unicode.</span><span class="sxs-lookup"><span data-stu-id="35792-136">Decorate with Unicode.</span></span>|
|`LPSTR`|`char *`|<span data-ttu-id="35792-137"><xref:System.String?displayProperty=nameWithType> lub <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="35792-137"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="35792-138">Dekorować z ANSI.</span><span class="sxs-lookup"><span data-stu-id="35792-138">Decorate with ANSI.</span></span>|
|`LPCSTR`|`const char *`|<span data-ttu-id="35792-139"><xref:System.String?displayProperty=nameWithType> lub <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="35792-139"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="35792-140">Dekorować z ANSI.</span><span class="sxs-lookup"><span data-stu-id="35792-140">Decorate with ANSI.</span></span>|
|`LPWSTR`|`wchar_t *`|<span data-ttu-id="35792-141"><xref:System.String?displayProperty=nameWithType> lub <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="35792-141"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="35792-142">Dekorować z kodowaniem Unicode.</span><span class="sxs-lookup"><span data-stu-id="35792-142">Decorate with Unicode.</span></span>|
|`LPCWSTR`|`const wchar_t *`|<span data-ttu-id="35792-143"><xref:System.String?displayProperty=nameWithType> lub <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="35792-143"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="35792-144">Dekorować z kodowaniem Unicode.</span><span class="sxs-lookup"><span data-stu-id="35792-144">Decorate with Unicode.</span></span>|
|`FLOAT`|`float`|<xref:System.Single?displayProperty=nameWithType>|<span data-ttu-id="35792-145">32 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-145">32 bits</span></span>|
|`DOUBLE`|`double`|<xref:System.Double?displayProperty=nameWithType>|<span data-ttu-id="35792-146">64 bitów</span><span class="sxs-lookup"><span data-stu-id="35792-146">64 bits</span></span>|

<span data-ttu-id="35792-147">Odpowiednie typy w Visual Basic, C# i C++ można znaleźć w temacie [wprowadzenie do biblioteki klas .NET Framework](../../standard/class-library-overview.md#system-namespace).</span><span class="sxs-lookup"><span data-stu-id="35792-147">For corresponding types in Visual Basic, C#, and C++, see the [Introduction to the .NET Framework Class Library](../../standard/class-library-overview.md#system-namespace).</span></span>

## <a name="pinvokelibdll"></a><span data-ttu-id="35792-148">PinvokeLib.dll</span><span class="sxs-lookup"><span data-stu-id="35792-148">PinvokeLib.dll</span></span>

<span data-ttu-id="35792-149">Poniższy kod definiuje funkcje biblioteki udostępniane przez Pinvoke.dll.</span><span class="sxs-lookup"><span data-stu-id="35792-149">The following code defines the library functions provided by Pinvoke.dll.</span></span> <span data-ttu-id="35792-150">Wiele przykładów opisanych w tej sekcji wywołuje tę bibliotekę.</span><span class="sxs-lookup"><span data-stu-id="35792-150">Many samples described in this section call this library.</span></span>

### <a name="example"></a><span data-ttu-id="35792-151">Przykład</span><span class="sxs-lookup"><span data-stu-id="35792-151">Example</span></span>

[!code-cpp[PInvokeLib#1](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.cpp#1)]

[!code-cpp[PInvokeLib#2](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.h#2)]
