---
title: "Importowanie biblioteki typów jako zestawu"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
caps.latest.revision: "14"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: a7657540991099cca29dc911c8e42e5ddcd22802
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/21/2017
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="f61d8-102">Importowanie biblioteki typów jako zestawu</span><span class="sxs-lookup"><span data-stu-id="f61d8-102">Importing a Type Library as an Assembly</span></span>
<span data-ttu-id="f61d8-103">Definicje typów COM zazwyczaj znajdują się w bibliotece typów.</span><span class="sxs-lookup"><span data-stu-id="f61d8-103">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="f61d8-104">Z kolei kompilatory zgodne ze specyfikacją CLS utworzyć metadanych typów w zestawie.</span><span class="sxs-lookup"><span data-stu-id="f61d8-104">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="f61d8-105">Dwóch źródeł informacji o typie znacznie różnią się.</span><span class="sxs-lookup"><span data-stu-id="f61d8-105">The two sources of type information are quite different.</span></span> <span data-ttu-id="f61d8-106">W tym temacie opisano metody generowania metadanych z biblioteki typów.</span><span class="sxs-lookup"><span data-stu-id="f61d8-106">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="f61d8-107">Wynikowy zestaw nosi nazwę zestawu międzyoperacyjnego i informacji o typie, który zawiera umożliwia używanie typów COM aplikacji .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f61d8-107">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>  
  
 <span data-ttu-id="f61d8-108">Istnieją dwa sposoby, aby udostępnić informacje tego typu aplikacji:</span><span class="sxs-lookup"><span data-stu-id="f61d8-108">There are two ways to make this type information available to your application:</span></span>  
  
-   <span data-ttu-id="f61d8-109">Przy użyciu projektu tylko od czasu zestawy międzyoperacyjne: począwszy od [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], można nakazać kompilatorowi osadzanie informacji o typie z zestawu międzyoperacyjnego do pliku wykonywalnego.</span><span class="sxs-lookup"><span data-stu-id="f61d8-109">Using design-time-only interop assemblies: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="f61d8-110">Kompilator osadza informacje typu, używanych przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="f61d8-110">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="f61d8-111">Nie trzeba wdrażać zestawu międzyoperacyjnego z aplikacją.</span><span class="sxs-lookup"><span data-stu-id="f61d8-111">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="f61d8-112">Jest to zalecana technika.</span><span class="sxs-lookup"><span data-stu-id="f61d8-112">This is the recommended technique.</span></span>  
  
-   <span data-ttu-id="f61d8-113">Zestawy międzyoperacyjne wdrażania: można utworzyć standardowe odwołanie do zestawu międzyoperacyjnego.</span><span class="sxs-lookup"><span data-stu-id="f61d8-113">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="f61d8-114">W takim przypadku należy wdrożyć zestawu międzyoperacyjnego z aplikacją.</span><span class="sxs-lookup"><span data-stu-id="f61d8-114">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="f61d8-115">Jeśli zostanie zastosowana ta technika, a nie jest używany prywatny składnika modelu COM, zawsze odwoływać się do podstawowego zestawu międzyoperacyjnego (PIA) opublikowane przez autora składnika modelu COM, który chcesz uwzględnić w kodzie zarządzanym.</span><span class="sxs-lookup"><span data-stu-id="f61d8-115">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="f61d8-116">Aby uzyskać więcej informacji na temat Tworzenie i używanie podstawowe zestawy międzyoperacyjne zobacz [podstawowe zestawy międzyoperacyjne](http://msdn.microsoft.com/en-us/b977a8be-59a0-40a0-a806-b11ffba5c080).</span><span class="sxs-lookup"><span data-stu-id="f61d8-116">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](http://msdn.microsoft.com/en-us/b977a8be-59a0-40a0-a806-b11ffba5c080).</span></span>  
  
 <span data-ttu-id="f61d8-117">Gdy używasz projektu tylko od czasu zestawy międzyoperacyjne można osadzić informacji o typie z podstawowego zestawu międzyoperacyjnego opublikowane przez autora składnika modelu COM.</span><span class="sxs-lookup"><span data-stu-id="f61d8-117">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="f61d8-118">Jednak nie musisz wdrażać podstawowego zestawu międzyoperacyjnego z aplikacją.</span><span class="sxs-lookup"><span data-stu-id="f61d8-118">However, you do not have to deploy the primary interop assembly with your application.</span></span>  
  
 <span data-ttu-id="f61d8-119">Przy użyciu projektu tylko od czasu zestawy międzyoperacyjne zmniejsza rozmiar aplikacji, ponieważ większość aplikacji należy używać wszystkich funkcji składnika modelu COM.</span><span class="sxs-lookup"><span data-stu-id="f61d8-119">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="f61d8-120">Kompilator jest bardzo wydajny, gdy ją osadza informacje o typie; Jeśli aplikacja używa pewnych metod w interfejsie COM, kompilator nie można osadzić nieużywane metody.</span><span class="sxs-lookup"><span data-stu-id="f61d8-120">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="f61d8-121">Gdy aplikacja, która zawiera osadzone informacji o typie współdziała z innej takich aplikacji lub współdziała z aplikacją, która używa podstawowego zestawu międzyoperacyjnego, wspólne używa środowiska wykonawczego języka wpisz równoważność zasady w celu ustalenia, czy dwa typy z tej samej nazwy reprezentują ten sam typ COM.</span><span class="sxs-lookup"><span data-stu-id="f61d8-121">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="f61d8-122">Nie trzeba znać obiektów COM tych reguł.</span><span class="sxs-lookup"><span data-stu-id="f61d8-122">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="f61d8-123">Jednak jeśli interesuje Cię w zasadach, zobacz [równoważność typów i osadzone typy międzyoperacyjne](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="f61d8-123">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span></span>  
  
## <a name="generating-metadata"></a><span data-ttu-id="f61d8-124">Generowanie metadanych</span><span class="sxs-lookup"><span data-stu-id="f61d8-124">Generating Metadata</span></span>  
 <span data-ttu-id="f61d8-125">Biblioteki typów COM może być autonomicznym pliki, które mają rozszerzenie .tlb, takich jak Loanlib.tlb.</span><span class="sxs-lookup"><span data-stu-id="f61d8-125">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="f61d8-126">Niektóre biblioteki typów są osadzone w sekcji zasobów w pliku .dll lub .exe.</span><span class="sxs-lookup"><span data-stu-id="f61d8-126">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="f61d8-127">Inne źródła informacji o typie biblioteki są plikami .olb i .ocx.</span><span class="sxs-lookup"><span data-stu-id="f61d8-127">Other sources of type library information are .olb and .ocx files.</span></span>  
  
 <span data-ttu-id="f61d8-128">Po zlokalizowaniu bibliotekę typu, która zawiera implementację docelowego typu COM, masz następujące opcje generowania zestawu międzyoperacyjnego zawierający metadane typu:</span><span class="sxs-lookup"><span data-stu-id="f61d8-128">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>  
  
-   <span data-ttu-id="f61d8-129">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="f61d8-129">Visual Studio</span></span>  
  
     <span data-ttu-id="f61d8-130">Visual Studio automatycznie konwertuje typów COM w bibliotece typów metadanych w zestawie.</span><span class="sxs-lookup"><span data-stu-id="f61d8-130">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="f61d8-131">Aby uzyskać instrukcje, zobacz [porady: Dodawanie odwołania do bibliotek typów](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md) i [wskazówki: osadzanie informacji o typie z zestawów Microsoft Office](http://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3).</span><span class="sxs-lookup"><span data-stu-id="f61d8-131">For instructions, see [How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md) and [Walkthrough: Embedding Type Information from Microsoft Office Assemblies](http://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3).</span></span>  
  
-   [<span data-ttu-id="f61d8-132">Importer biblioteki typów (Tlbimp.exe)</span><span class="sxs-lookup"><span data-stu-id="f61d8-132">Type Library Importer (Tlbimp.exe)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
  
     <span data-ttu-id="f61d8-133">Importer biblioteki typów udostępnia opcje wiersza polecenia, aby dopasować metadanych w wynikowym pliku międzyoperacyjnego, importuje typy z istniejącej biblioteki typów, a następnie generuje zestawu międzyoperacyjnego i przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="f61d8-133">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="f61d8-134">Aby uzyskać instrukcje, zobacz [porady: generowanie zestawy międzyoperacyjne z bibliotek typów](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="f61d8-134">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>  
  
-   <span data-ttu-id="f61d8-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType>klasy</span><span class="sxs-lookup"><span data-stu-id="f61d8-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>  
  
     <span data-ttu-id="f61d8-136">Ta klasa dostarcza metody do przekonwertowania klasy coclass i interfejsy w bibliotece typów do metadanych w zestawie.</span><span class="sxs-lookup"><span data-stu-id="f61d8-136">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="f61d8-137">Tworzy tych samych danych wyjściowych metadanych jako Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="f61d8-137">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="f61d8-138">Jednak w przeciwieństwie do Tlbimp.exe <xref:System.Runtime.InteropServices.TypeLibConverter> klasy można skonwertować biblioteki typów w pamięci na metadanych.</span><span class="sxs-lookup"><span data-stu-id="f61d8-138">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>  
  
-   <span data-ttu-id="f61d8-139">Otoki niestandardowe</span><span class="sxs-lookup"><span data-stu-id="f61d8-139">Custom wrappers</span></span>  
  
     <span data-ttu-id="f61d8-140">Gdy biblioteki typów jest niedostępny lub nieprawidłowy, co rozwiązaniem jest utworzenie zduplikowanych definicji klasy lub interfejsu w kodzie źródłowym zarządzanych.</span><span class="sxs-lookup"><span data-stu-id="f61d8-140">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="f61d8-141">Następnie kompilacja kodu źródłowego z kompilatorem, przeznaczonego dla środowiska uruchomieniowego do utworzenia metadanych w zestawie.</span><span class="sxs-lookup"><span data-stu-id="f61d8-141">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>  
  
     <span data-ttu-id="f61d8-142">Aby ręcznie zdefiniować typy dla modelu COM, musi mieć dostęp do następujących elementów:</span><span class="sxs-lookup"><span data-stu-id="f61d8-142">To define COM types manually, you must have access to the following items:</span></span>  
  
    -   <span data-ttu-id="f61d8-143">Dokładne opisy klasy coclass i interfejsy definiowanego.</span><span class="sxs-lookup"><span data-stu-id="f61d8-143">Precise descriptions of the coclasses and interfaces being defined.</span></span>  
  
    -   <span data-ttu-id="f61d8-144">Kompilator, takich jak C# kompilator, generowany odpowiednie definicje klas .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f61d8-144">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>  
  
    -   <span data-ttu-id="f61d8-145">Znajomość reguły biblioteki do zestawu konwersji typu.</span><span class="sxs-lookup"><span data-stu-id="f61d8-145">Knowledge of the type library-to-assembly conversion rules.</span></span>  
  
     <span data-ttu-id="f61d8-146">Pisanie niestandardowych otoki jest zaawansowanych technik.</span><span class="sxs-lookup"><span data-stu-id="f61d8-146">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="f61d8-147">Aby uzyskać dodatkowe informacje na temat generowania otoki niestandardowe, zobacz [dostosowywanie standardowych otoki](http://msdn.microsoft.com/en-us/c40d089b-6a3c-41b5-a20d-d760c215e49d).</span><span class="sxs-lookup"><span data-stu-id="f61d8-147">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](http://msdn.microsoft.com/en-us/c40d089b-6a3c-41b5-a20d-d760c215e49d).</span></span>  
  
 <span data-ttu-id="f61d8-148">Aby uzyskać więcej informacji na temat procesu importowania międzyoperacyjnego COM zobacz [biblioteki typów na zestaw konwersja — Podsumowanie](http://msdn.microsoft.com/en-us/bf3f90c5-4770-4ab8-895c-3ba1055cc958).</span><span class="sxs-lookup"><span data-stu-id="f61d8-148">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](http://msdn.microsoft.com/en-us/bf3f90c5-4770-4ab8-895c-3ba1055cc958).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f61d8-149">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="f61d8-149">See Also</span></span>  
 <xref:System.Runtime.InteropServices.TypeLibConverter>  
 [<span data-ttu-id="f61d8-150">Udostępnianie składników modelu COM aplikacji .NET Framework</span><span class="sxs-lookup"><span data-stu-id="f61d8-150">Exposing COM Components to the .NET Framework</span></span>](../../../docs/framework/interop/exposing-com-components.md)  
 [<span data-ttu-id="f61d8-151">Biblioteki typów na zestaw konwersja — podsumowanie</span><span class="sxs-lookup"><span data-stu-id="f61d8-151">Type Library to Assembly Conversion Summary</span></span>](http://msdn.microsoft.com/en-us/bf3f90c5-4770-4ab8-895c-3ba1055cc958)  
 [<span data-ttu-id="f61d8-152">Tlbimp.exe (Importer biblioteki typów)</span><span class="sxs-lookup"><span data-stu-id="f61d8-152">Tlbimp.exe (Type Library Importer)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
 [<span data-ttu-id="f61d8-153">Dostosowywanie standardowych otoki</span><span class="sxs-lookup"><span data-stu-id="f61d8-153">Customizing Standard Wrappers</span></span>](http://msdn.microsoft.com/en-us/c40d089b-6a3c-41b5-a20d-d760c215e49d)  
 [<span data-ttu-id="f61d8-154">Używanie typów COM w kodzie zarządzanym</span><span class="sxs-lookup"><span data-stu-id="f61d8-154">Using COM Types in Managed Code</span></span>](http://msdn.microsoft.com/en-us/1a95a8ca-c8b8-4464-90b0-5ee1a1135b66)  
 [<span data-ttu-id="f61d8-155">Kompilowanie projektu międzyoperacyjnego</span><span class="sxs-lookup"><span data-stu-id="f61d8-155">Compiling an Interop Project</span></span>](../../../docs/framework/interop/compiling-an-interop-project.md)  
 [<span data-ttu-id="f61d8-156">Wdrażanie aplikacji międzyoperacyjnych</span><span class="sxs-lookup"><span data-stu-id="f61d8-156">Deploying an Interop Application</span></span>](../../../docs/framework/interop/deploying-an-interop-application.md)  
 [<span data-ttu-id="f61d8-157">Porady: Dodawanie odwołania do bibliotek typów</span><span class="sxs-lookup"><span data-stu-id="f61d8-157">How to: Add References to Type Libraries</span></span>](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)  
 [<span data-ttu-id="f61d8-158">Porady: generowanie zestawów międzyoperacyjnych z bibliotek typów</span><span class="sxs-lookup"><span data-stu-id="f61d8-158">How to: Generate Interop Assemblies from Type Libraries</span></span>](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)  
 [<span data-ttu-id="f61d8-159">Wskazówki: Osadzanie informacji o typie z zestawów Microsoft Office</span><span class="sxs-lookup"><span data-stu-id="f61d8-159">Walkthrough: Embedding Type Information from Microsoft Office Assemblies</span></span>](http://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3)
