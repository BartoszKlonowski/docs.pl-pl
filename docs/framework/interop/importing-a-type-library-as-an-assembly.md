---
title: Importowanie biblioteki typów jako zestawu
description: Zaimportuj bibliotekę typów, która zawiera definicje typów COM jako zestaw. Dowiedz się, jak utworzyć metadane z biblioteki typów, co spowoduje powstanie zestawu międzyoperacyjnego.
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
ms.openlocfilehash: bc1b921fea5aff086e21c046369f1d461f553bc7
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/15/2020
ms.locfileid: "90554687"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="14aa2-104">Importowanie biblioteki typów jako zestawu</span><span class="sxs-lookup"><span data-stu-id="14aa2-104">Importing a Type Library as an Assembly</span></span>

<span data-ttu-id="14aa2-105">Definicje typu COM zwykle znajdują się w bibliotece typów.</span><span class="sxs-lookup"><span data-stu-id="14aa2-105">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="14aa2-106">Z kolei kompilatory zgodne ze specyfikacją CLS generują metadane typu w zestawie.</span><span class="sxs-lookup"><span data-stu-id="14aa2-106">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="14aa2-107">Dwa źródła informacji o typie są zupełnie inne.</span><span class="sxs-lookup"><span data-stu-id="14aa2-107">The two sources of type information are quite different.</span></span> <span data-ttu-id="14aa2-108">W tym temacie opisano techniki generowania metadanych z biblioteki typów.</span><span class="sxs-lookup"><span data-stu-id="14aa2-108">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="14aa2-109">Zestaw, który jest nazywany zestawem międzyoperacyjnym, i zawarte w nim informacje o typie umożliwiają aplikacjom .NET Framework korzystanie z typów COM.</span><span class="sxs-lookup"><span data-stu-id="14aa2-109">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>

<span data-ttu-id="14aa2-110">Istnieją dwa sposoby, aby te informacje o typie były dostępne dla aplikacji:</span><span class="sxs-lookup"><span data-stu-id="14aa2-110">There are two ways to make this type information available to your application:</span></span>

- <span data-ttu-id="14aa2-111">Przy użyciu zestawów międzyoperacyjnych tylko do projektowania: począwszy od .NET Framework 4, można wydać kompilatorowi możliwość osadzenia informacji o typie z zestawu międzyoperacyjnego do pliku wykonywalnego.</span><span class="sxs-lookup"><span data-stu-id="14aa2-111">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="14aa2-112">Kompilator osadza tylko informacje o typie używane przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="14aa2-112">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="14aa2-113">Nie trzeba wdrażać zestawu międzyoperacyjnego przy użyciu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="14aa2-113">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="14aa2-114">Jest to zalecana technika.</span><span class="sxs-lookup"><span data-stu-id="14aa2-114">This is the recommended technique.</span></span>

- <span data-ttu-id="14aa2-115">Wdrażanie zestawów międzyoperacyjnych: można utworzyć standardowe odwołanie do zestawu międzyoperacyjnego.</span><span class="sxs-lookup"><span data-stu-id="14aa2-115">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="14aa2-116">W takim przypadku zestaw międzyoperacyjny musi zostać wdrożony wraz z aplikacją.</span><span class="sxs-lookup"><span data-stu-id="14aa2-116">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="14aa2-117">Jeśli ta technika jest stosowana i nie używasz prywatnego składnika COM, zawsze odwołuje się do podstawowego zestawu międzyoperacyjnego (PIA) opublikowanego przez autora składnika COM, który ma zostać dołączony do kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="14aa2-117">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="14aa2-118">Aby uzyskać więcej informacji na temat tworzenia i używania podstawowych zestawów międzyoperacyjnych, zobacz [podstawowe zestawy międzyoperacyjności](/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="14aa2-118">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>

<span data-ttu-id="14aa2-119">W przypadku korzystania z zestawów międzyoperacyjnych tylko do projektowania można osadzić informacje o typie z podstawowego zestawu międzyoperacyjnego opublikowanego przez autora składnika modelu COM.</span><span class="sxs-lookup"><span data-stu-id="14aa2-119">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="14aa2-120">Nie trzeba jednak wdrażać podstawowego zestawu międzyoperacyjnego przy użyciu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="14aa2-120">However, you do not have to deploy the primary interop assembly with your application.</span></span>

<span data-ttu-id="14aa2-121">Używanie zestawów międzyoperacyjnych tylko do projektowania zmniejsza rozmiar aplikacji, ponieważ większość aplikacji nie korzysta ze wszystkich funkcji składnika COM.</span><span class="sxs-lookup"><span data-stu-id="14aa2-121">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="14aa2-122">Kompilator jest bardzo wydajny, gdy osadza informacje o typie; Jeśli aplikacja używa tylko niektórych metod w interfejsie COM, kompilator nie osadza nieużywanych metod.</span><span class="sxs-lookup"><span data-stu-id="14aa2-122">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="14aa2-123">Gdy aplikacja zawierająca informacje o typie osadzonym współdziała z inną aplikacją lub współdziała z aplikacją, która używa podstawowego zestawu międzyoperacyjnego, środowisko uruchomieniowe języka wspólnego używa reguł równoważności typów do określenia, czy dwa typy o takiej samej nazwie reprezentują ten sam typ COM.</span><span class="sxs-lookup"><span data-stu-id="14aa2-123">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="14aa2-124">Nie trzeba znać tych reguł, aby używać obiektów COM.</span><span class="sxs-lookup"><span data-stu-id="14aa2-124">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="14aa2-125">Jednak jeśli interesuje Cię reguły, zobacz [typ równoważności i osadzone typy międzyoperacyjnych](type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="14aa2-125">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](type-equivalence-and-embedded-interop-types.md).</span></span>

## <a name="generating-metadata"></a><span data-ttu-id="14aa2-126">Generowanie metadanych</span><span class="sxs-lookup"><span data-stu-id="14aa2-126">Generating Metadata</span></span>

<span data-ttu-id="14aa2-127">Biblioteki typu COM mogą być autonomicznymi plikami, które mają rozszerzenie. tlb, takie jak LOANLib. tlb.</span><span class="sxs-lookup"><span data-stu-id="14aa2-127">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="14aa2-128">Niektóre biblioteki typów są osadzone w sekcji zasobów pliku DLL lub exe.</span><span class="sxs-lookup"><span data-stu-id="14aa2-128">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="14aa2-129">Inne źródła informacji o bibliotece typów to. olb i. ocx.</span><span class="sxs-lookup"><span data-stu-id="14aa2-129">Other sources of type library information are .olb and .ocx files.</span></span>

<span data-ttu-id="14aa2-130">Po znalezieniu biblioteki typów, która zawiera implementację docelowego typu COM, dostępne są następujące opcje generowania zestawu międzyoperacyjnego zawierającego metadane typu:</span><span class="sxs-lookup"><span data-stu-id="14aa2-130">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>

- <span data-ttu-id="14aa2-131">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="14aa2-131">Visual Studio</span></span>

  <span data-ttu-id="14aa2-132">Program Visual Studio automatycznie konwertuje typy COM w bibliotece typów na metadane w zestawie.</span><span class="sxs-lookup"><span data-stu-id="14aa2-132">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="14aa2-133">Aby uzyskać instrukcje, zobacz [How to: Add References to Library Type](how-to-add-references-to-type-libraries.md)librarys.</span><span class="sxs-lookup"><span data-stu-id="14aa2-133">For instructions, see [How to: Add References to Type Libraries](how-to-add-references-to-type-libraries.md).</span></span>

- [<span data-ttu-id="14aa2-134">Importer biblioteki typów (Tlbimp.exe)</span><span class="sxs-lookup"><span data-stu-id="14aa2-134">Type Library Importer (Tlbimp.exe)</span></span>](../tools/tlbimp-exe-type-library-importer.md)

  <span data-ttu-id="14aa2-135">Importer biblioteki typów zawiera opcje wiersza polecenia służące do dostosowywania metadanych w wyniku pliku międzyoperacyjnego, importuje typy z istniejącej biblioteki typów i generuje zestaw międzyoperacyjny i przestrzeń nazw.</span><span class="sxs-lookup"><span data-stu-id="14aa2-135">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="14aa2-136">Aby uzyskać instrukcje, zobacz [How to: Generate zestawy międzyoperacyjności z bibliotek typów](how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="14aa2-136">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>

- <span data-ttu-id="14aa2-137">Klasa <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="14aa2-137"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>

  <span data-ttu-id="14aa2-138">Ta klasa dostarcza metody do konwertowania klas i interfejsów w bibliotece typów na metadane w ramach zestawu.</span><span class="sxs-lookup"><span data-stu-id="14aa2-138">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="14aa2-139">Generuje te same dane wyjściowe metadanych co Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="14aa2-139">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="14aa2-140">Jednak, w przeciwieństwie do Tlbimp.exe, <xref:System.Runtime.InteropServices.TypeLibConverter> Klasa może skonwertować bibliotekę typów w pamięci na metadane.</span><span class="sxs-lookup"><span data-stu-id="14aa2-140">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>

- <span data-ttu-id="14aa2-141">Otoki niestandardowe</span><span class="sxs-lookup"><span data-stu-id="14aa2-141">Custom wrappers</span></span>

  <span data-ttu-id="14aa2-142">Gdy biblioteka typów jest niedostępna lub nieprawidłowa, jedną z opcji jest utworzenie zduplikowanej definicji klasy lub interfejsu w zarządzanym kodzie źródłowym.</span><span class="sxs-lookup"><span data-stu-id="14aa2-142">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="14aa2-143">Następnie można skompilować kod źródłowy z kompilatorem przeznaczonym dla środowiska uruchomieniowego w celu utworzenia metadanych w zestawie.</span><span class="sxs-lookup"><span data-stu-id="14aa2-143">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>

  <span data-ttu-id="14aa2-144">Aby ręcznie zdefiniować typy COM, musisz mieć dostęp do następujących elementów:</span><span class="sxs-lookup"><span data-stu-id="14aa2-144">To define COM types manually, you must have access to the following items:</span></span>

  - <span data-ttu-id="14aa2-145">Precyzyjne opisy klas i interfejsów, które są definiowane.</span><span class="sxs-lookup"><span data-stu-id="14aa2-145">Precise descriptions of the coclasses and interfaces being defined.</span></span>

  - <span data-ttu-id="14aa2-146">Kompilator, taki jak kompilator języka C#, który może generować odpowiednie definicje klas .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="14aa2-146">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>

  - <span data-ttu-id="14aa2-147">Znajomość reguł konwersji typu "Biblioteka na zestaw".</span><span class="sxs-lookup"><span data-stu-id="14aa2-147">Knowledge of the type library-to-assembly conversion rules.</span></span>

  <span data-ttu-id="14aa2-148">Pisanie otoki niestandardowej jest zaawansowaną techniką.</span><span class="sxs-lookup"><span data-stu-id="14aa2-148">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="14aa2-149">Aby uzyskać dodatkowe informacje na temat sposobu generowania otoki niestandardowej, zobacz [Dostosowywanie otok standardowych](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="14aa2-149">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>

 <span data-ttu-id="14aa2-150">Aby uzyskać więcej informacji na temat procesu importowania międzyoperacyjności modelu COM, zobacz [Podsumowanie konwersji typu Biblioteka na zestaw](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="14aa2-150">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>

## <a name="see-also"></a><span data-ttu-id="14aa2-151">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="14aa2-151">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="14aa2-152">Udostępnianie składników COM programowi.NET Framework</span><span class="sxs-lookup"><span data-stu-id="14aa2-152">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- <span data-ttu-id="14aa2-153">[Podsumowanie dotyczące konwersji biblioteki typów na zestaw](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="14aa2-153">[Type Library to Assembly Conversion Summary](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="14aa2-154">Tlbimp.exe (Importer biblioteki typów)</span><span class="sxs-lookup"><span data-stu-id="14aa2-154">Tlbimp.exe (Type Library Importer)</span></span>](../tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="14aa2-155">[Dostosowywanie otok standardowych](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="14aa2-155">[Customizing Standard Wrappers](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="14aa2-156">[Używanie typów COM w kodzie zarządzanym](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="14aa2-156">[Using COM Types in Managed Code](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="14aa2-157">Kompilowanie projektu międzyoperacyjnego</span><span class="sxs-lookup"><span data-stu-id="14aa2-157">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
- [<span data-ttu-id="14aa2-158">Wdrażanie aplikacji międzyoperacyjnych</span><span class="sxs-lookup"><span data-stu-id="14aa2-158">Deploying an Interop Application</span></span>](deploying-an-interop-application.md)
- [<span data-ttu-id="14aa2-159">Instrukcje: Dodawanie odwołań do bibliotek typów</span><span class="sxs-lookup"><span data-stu-id="14aa2-159">How to: Add References to Type Libraries</span></span>](how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="14aa2-160">Instrukcje: Generowanie zestawów międzyoperacyjnych z bibliotek typów</span><span class="sxs-lookup"><span data-stu-id="14aa2-160">How to: Generate Interop Assemblies from Type Libraries</span></span>](how-to-generate-interop-assemblies-from-type-libraries.md)
