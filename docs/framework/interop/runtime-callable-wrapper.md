---
title: Wywoływana otoka środowiska uruchomieniowego
ms.date: 03/30/2017
ms.prod: .net-framework
ms.technology:
- dotnet-clr
ms.topic: article
helpviewer_keywords:
- COM interop, COM wrappers
- RCW
- COM wrappers
- runtime callable wrappers
- interoperation with unmanaged code, COM wrappers
ms.assetid: 7e542583-1e31-4e10-b523-8cf2f29cb4a4
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: bc92f169851680465f33170290d865be8426a53d
ms.sourcegitcommit: 9a4fe1a1c37b26532654b4bbe22d702237950009
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/16/2018
---
# <a name="runtime-callable-wrapper"></a><span data-ttu-id="7b5de-102">Wywoływana otoka środowiska uruchomieniowego</span><span class="sxs-lookup"><span data-stu-id="7b5de-102">Runtime Callable Wrapper</span></span>
<span data-ttu-id="7b5de-103">Środowisko uruchomieniowe języka wspólnego przedstawia obiekty COM za pośrednictwem serwera proxy, nazywany wywoływana otoka środowiska uruchomieniowego (otoki RCW).</span><span class="sxs-lookup"><span data-stu-id="7b5de-103">The common language runtime exposes COM objects through a proxy called the runtime callable wrapper (RCW).</span></span> <span data-ttu-id="7b5de-104">Mimo że otoki RCW wydaje się być obiekt zwykłej do klientów platformy .NET, jego podstawową funkcją jest do organizowania wywołań między klientem .NET obiektu COM.</span><span class="sxs-lookup"><span data-stu-id="7b5de-104">Although the RCW appears to be an ordinary object to .NET clients, its primary function is to marshal calls between a .NET client and a COM object.</span></span>  
  
 <span data-ttu-id="7b5de-105">Środowisko uruchomieniowe tworzy dokładnie jeden otoki RCW dla każdego obiektu modelu COM, niezależnie od liczby odwołań, które istnieją w tym obiekcie.</span><span class="sxs-lookup"><span data-stu-id="7b5de-105">The runtime creates exactly one RCW for each COM object, regardless of the number of references that exist on that object.</span></span> <span data-ttu-id="7b5de-106">Środowisko uruchomieniowe obsługuje pojedynczy otoki RCW na proces dla każdego obiektu.</span><span class="sxs-lookup"><span data-stu-id="7b5de-106">The runtime maintains a single RCW per process for each object.</span></span>  <span data-ttu-id="7b5de-107">Jeśli tworzenie otoki RCW w jednej domenie aplikacji lub typu apartment, a następnie przekazać odwołanie do innej domeny aplikacji lub typu apartment, będzie używany serwer proxy, aby pierwszy obiekt.</span><span class="sxs-lookup"><span data-stu-id="7b5de-107">If you create an RCW in one application domain or apartment, and then pass a reference to another application domain or apartment, a proxy to the first object will be used.</span></span>  <span data-ttu-id="7b5de-108">Jak pokazano na poniższej ilustracji, dowolną liczbę zarządzanych klientów może zawierać odwołania do obiektów COM, które udostępniają INew i INewer interfejsów.</span><span class="sxs-lookup"><span data-stu-id="7b5de-108">As the following illustration shows, any number of managed clients can hold a reference to the COM objects that expose INew and INewer interfaces.</span></span>  
  
 <span data-ttu-id="7b5de-109">![RCW](./media/rcw.gif "rcw")</span><span class="sxs-lookup"><span data-stu-id="7b5de-109">![RCW](./media/rcw.gif "rcw")</span></span>  
<span data-ttu-id="7b5de-110">Uzyskiwanie dostępu do obiektów COM za pomocą wywoływana otoka środowiska uruchomieniowego</span><span class="sxs-lookup"><span data-stu-id="7b5de-110">Accessing COM objects through the runtime callable wrapper</span></span>  
  
 <span data-ttu-id="7b5de-111">Przy użyciu metadanych pochodzące z biblioteki typów, środowisko uruchomieniowe tworzy obiekt COM, wywoływana i otoki dla tego obiektu.</span><span class="sxs-lookup"><span data-stu-id="7b5de-111">Using metadata derived from a type library, the runtime creates both the COM object being called and a wrapper for that object.</span></span> <span data-ttu-id="7b5de-112">Każdy otoki RCW obsługuje pamięć podręczną wskaźniki interfejsu w obiekcie COM zawijany i zwalnia jego odwołania do obiektu COM otoki RCW jest już potrzebne.</span><span class="sxs-lookup"><span data-stu-id="7b5de-112">Each RCW maintains a cache of interface pointers on the COM object it wraps and releases its reference on the COM object when the RCW is no longer needed.</span></span> <span data-ttu-id="7b5de-113">Środowisko uruchomieniowe przeprowadzają otoki RCW wyrzucanie elementów bezużytecznych.</span><span class="sxs-lookup"><span data-stu-id="7b5de-113">The runtime performs garbage collection on the RCW.</span></span>  
  
 <span data-ttu-id="7b5de-114">Wśród innych działań otoki RCW marshals danych między zarządzanymi i niezarządzanymi kodu w imieniu opakowana obiektu.</span><span class="sxs-lookup"><span data-stu-id="7b5de-114">Among other activities, the RCW marshals data between managed and unmanaged code, on behalf of the wrapped object.</span></span> <span data-ttu-id="7b5de-115">W szczególności otoki RCW umożliwia organizowanie metody argumentów i wartości zwracanych metody zawsze, gdy klient i serwer mają różne reprezentacje danych przesyłanych między nimi.</span><span class="sxs-lookup"><span data-stu-id="7b5de-115">Specifically, the RCW provides marshaling for method arguments and method return values whenever the client and server have different representations of the data passed between them.</span></span>  
  
 <span data-ttu-id="7b5de-116">Standardowa otoki wymusza wbudowane reguły kierowania.</span><span class="sxs-lookup"><span data-stu-id="7b5de-116">The standard wrapper enforces built-in marshaling rules.</span></span> <span data-ttu-id="7b5de-117">Na przykład gdy klienta .NET przekazuje typu ciąg jako część argumentu do niezarządzanego obiektu, otoka konwertuje ciąg na typ BSTR.</span><span class="sxs-lookup"><span data-stu-id="7b5de-117">For example, when a .NET client passes a String type as part of an argument to an unmanaged object, the wrapper converts the string to a BSTR type.</span></span> <span data-ttu-id="7b5de-118">Obiekt wywołujący obiektu COM należy przywrócić BSTR zarządzanych wywołującego, otrzymuje ciąg.</span><span class="sxs-lookup"><span data-stu-id="7b5de-118">Should the COM object return a BSTR to its managed caller, the caller receives a String.</span></span> <span data-ttu-id="7b5de-119">Zarówno klient, jak i serwer wysyłania i odbierania danych, które są znane do nich.</span><span class="sxs-lookup"><span data-stu-id="7b5de-119">Both the client and the server send and receive data that is familiar to them.</span></span> <span data-ttu-id="7b5de-120">Inne typy wymagają brak konwersji.</span><span class="sxs-lookup"><span data-stu-id="7b5de-120">Other types require no conversion.</span></span> <span data-ttu-id="7b5de-121">Na przykład standardowe otoki zawsze przekazuje 4-bajtowych liczb całkowitych między zarządzanymi i niezarządzanymi kodu bez konwersji typu.</span><span class="sxs-lookup"><span data-stu-id="7b5de-121">For instance, a standard wrapper will always pass a 4-byte integer between managed and unmanaged code without converting the type.</span></span>  
  
## <a name="marshaling-selected-interfaces"></a><span data-ttu-id="7b5de-122">Przekazywanie wybranego interfejsów</span><span class="sxs-lookup"><span data-stu-id="7b5de-122">Marshaling selected interfaces</span></span>  
 <span data-ttu-id="7b5de-123">Podstawowym celem [wywoływana otoka środowiska uruchomieniowego](runtime-callable-wrapper.md) (otoki RCW) jest ukrycie różnice między zarządzanymi i niezarządzanymi modele programowania.</span><span class="sxs-lookup"><span data-stu-id="7b5de-123">The primary goal of the [runtime callable wrapper](runtime-callable-wrapper.md) (RCW) is to hide the differences between the managed and unmanaged programming models.</span></span> <span data-ttu-id="7b5de-124">Aby utworzyć płynne przejście, otoki RCW zużywa wybrane interfejsy COM bez narażania ich do klienta .NET, jak pokazano na poniższej ilustracji.</span><span class="sxs-lookup"><span data-stu-id="7b5de-124">To create a seamless transition, the RCW consumes selected COM interfaces without exposing them to the .NET client, as shown in the following illustration.</span></span>  
  
 <span data-ttu-id="7b5de-125">![Otoka RCW z interfejsów](./media/rcwwithinterfaces.gif "rcwwithinterfaces")</span><span class="sxs-lookup"><span data-stu-id="7b5de-125">![RCW With Interfaces](./media/rcwwithinterfaces.gif "rcwwithinterfaces")</span></span>  
<span data-ttu-id="7b5de-126">Interfejsy modelu COM i wywoływana otoka środowiska uruchomieniowego</span><span class="sxs-lookup"><span data-stu-id="7b5de-126">COM interfaces and the runtime callable wrapper</span></span>  
  
 <span data-ttu-id="7b5de-127">Po utworzeniu jako obiekt z wczesnym wiązaniem otoki RCW jest określonego typu.</span><span class="sxs-lookup"><span data-stu-id="7b5de-127">When created as an early-bound object, the RCW is a specific type.</span></span> <span data-ttu-id="7b5de-128">Implementuje interfejsy implementuje i udostępnia metody, właściwości i zdarzeń z interfejsów obiektu obiektu COM.</span><span class="sxs-lookup"><span data-stu-id="7b5de-128">It implements the interfaces that the COM object implements and exposes the methods, properties, and events from the object's interfaces.</span></span> <span data-ttu-id="7b5de-129">Na ilustracji uwidacznia interfejs INew otoki RCW, ale zużywa **IUnknown** i **IDispatch** interfejsów.</span><span class="sxs-lookup"><span data-stu-id="7b5de-129">In the illustration, the RCW exposes the INew interface but consumes the **IUnknown** and **IDispatch** interfaces.</span></span> <span data-ttu-id="7b5de-130">Ponadto otoki RCW przedstawia wszystkie elementy członkowskie interfejsu INew do klienta programu .NET.</span><span class="sxs-lookup"><span data-stu-id="7b5de-130">Further, the RCW exposes all members of the INew interface to the .NET client.</span></span>  
  
 <span data-ttu-id="7b5de-131">Otoka RCW korzysta z interfejsów wymienionych w poniższej tabeli, które są udostępniane przez obiektu, do którego jest zawijany.</span><span class="sxs-lookup"><span data-stu-id="7b5de-131">The RCW consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="7b5de-132">Interface</span><span class="sxs-lookup"><span data-stu-id="7b5de-132">Interface</span></span>|<span data-ttu-id="7b5de-133">Opis</span><span class="sxs-lookup"><span data-stu-id="7b5de-133">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="7b5de-134">**IDispatch**</span><span class="sxs-lookup"><span data-stu-id="7b5de-134">**IDispatch**</span></span>|<span data-ttu-id="7b5de-135">Późne powiązania do obiektów COM za pomocą odbicia.</span><span class="sxs-lookup"><span data-stu-id="7b5de-135">For late binding to COM objects through reflection.</span></span>|  
|<span data-ttu-id="7b5de-136">**IErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="7b5de-136">**IErrorInfo**</span></span>|<span data-ttu-id="7b5de-137">Dostarcza opis tekstowy błąd, źródła pliku pomocy, kontekst pomocy i identyfikator GUID interfejsu, który zdefiniowano błędu (zawsze **GUID_NULL** dla klas .NET).</span><span class="sxs-lookup"><span data-stu-id="7b5de-137">Provides a textual description of the error, its source, a Help file, Help context, and the GUID of the interface that defined the error (always **GUID_NULL** for .NET classes).</span></span>|  
|<span data-ttu-id="7b5de-138">**IProvideClassInfo**</span><span class="sxs-lookup"><span data-stu-id="7b5de-138">**IProvideClassInfo**</span></span>|<span data-ttu-id="7b5de-139">Jeśli trwa obiektu COM opakowana implementuje **IProvideClassInfo**, otoki RCW wyodrębnia informacje o typie w tym interfejsie, aby zapewnić lepsze typu tożsamości.</span><span class="sxs-lookup"><span data-stu-id="7b5de-139">If the COM object being wrapped implements **IProvideClassInfo**, the RCW extracts the type information from this interface to provide better type identity.</span></span>|  
|<span data-ttu-id="7b5de-140">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="7b5de-140">**IUnknown**</span></span>|<span data-ttu-id="7b5de-141">Tożsamość obiektu, koercja typu i zarządzanie okresem istnienia:</span><span class="sxs-lookup"><span data-stu-id="7b5de-141">For object identity, type coercion, and lifetime management:</span></span><br /><br /> <span data-ttu-id="7b5de-142">— Identity obiekt</span><span class="sxs-lookup"><span data-stu-id="7b5de-142">-   Object identity</span></span><br />     <span data-ttu-id="7b5de-143">Środowisko uruchomieniowe rozróżnia obiektów COM, porównując wartości **IUnknown** interfejsu dla każdego obiektu.</span><span class="sxs-lookup"><span data-stu-id="7b5de-143">The runtime distinguishes between COM objects by comparing the value of the **IUnknown** interface for each object.</span></span><br /><span data-ttu-id="7b5de-144">— Koercja typ</span><span class="sxs-lookup"><span data-stu-id="7b5de-144">-   Type coercion</span></span><br />     <span data-ttu-id="7b5de-145">Otoka RCW rozpoznaje odnajdywania typu dynamicznego wykonywane przez **QueryInterface** metody.</span><span class="sxs-lookup"><span data-stu-id="7b5de-145">The RCW recognizes the dynamic type discovery performed by the **QueryInterface** method.</span></span><br /><span data-ttu-id="7b5de-146">-Zarządzanie okresem istnienia</span><span class="sxs-lookup"><span data-stu-id="7b5de-146">-   Lifetime management</span></span><br />     <span data-ttu-id="7b5de-147">Przy użyciu **QueryInterface** metoda pobiera otoki RCW i zawiera odwołanie do niezarządzanego obiektu, dopóki środowisko uruchomieniowe przeprowadzają otoki, które zwalnia niezarządzane obiekt wyrzucanie elementów bezużytecznych.</span><span class="sxs-lookup"><span data-stu-id="7b5de-147">Using the **QueryInterface** method, the RCW gets and holds a reference to an unmanaged object until the runtime performs garbage collection on the wrapper, which releases the unmanaged object.</span></span>|  
  
 <span data-ttu-id="7b5de-148">Otoka RCW zużywa opcjonalnie interfejsów wymienionych w poniższej tabeli, które są udostępniane przez obiektu, do którego jest zawijany.</span><span class="sxs-lookup"><span data-stu-id="7b5de-148">The RCW optionally consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="7b5de-149">Interface</span><span class="sxs-lookup"><span data-stu-id="7b5de-149">Interface</span></span>|<span data-ttu-id="7b5de-150">Opis</span><span class="sxs-lookup"><span data-stu-id="7b5de-150">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="7b5de-151">**IConnectionPoint** i **IConnectionPointContainer**</span><span class="sxs-lookup"><span data-stu-id="7b5de-151">**IConnectionPoint** and **IConnectionPointContainer**</span></span>|<span data-ttu-id="7b5de-152">Obiektów konwertuje otoki RCW, które udostępniają styl zdarzenie punktu połączenia na podstawie delegata zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="7b5de-152">The RCW converts objects that expose the connection-point event style to delegate-based events.</span></span>|  
|<span data-ttu-id="7b5de-153">**IDispatchEx**</span><span class="sxs-lookup"><span data-stu-id="7b5de-153">**IDispatchEx**</span></span>|<span data-ttu-id="7b5de-154">Jeśli klasa implementuje **IDispatchEx**, implementuje otoki RCW **IExpando**.</span><span class="sxs-lookup"><span data-stu-id="7b5de-154">If the class implements **IDispatchEx**, the RCW implements **IExpando**.</span></span> <span data-ttu-id="7b5de-155">**IDispatchEx** interfejsu jest rozszerzeniem **IDispatch** interfejsu, w odróżnieniu od **IDispatch**, umożliwia wyliczania, dodawania, usuwania i z uwzględnieniem wielkości liter wywoływanie elementów członkowskich.</span><span class="sxs-lookup"><span data-stu-id="7b5de-155">The **IDispatchEx** interface is an extension of the **IDispatch** interface that, unlike **IDispatch**, enables enumeration, addition, deletion, and case-sensitive calling of members.</span></span>|  
|<span data-ttu-id="7b5de-156">**Interfejsu IEnumVARIANT**</span><span class="sxs-lookup"><span data-stu-id="7b5de-156">**IEnumVARIANT**</span></span>|<span data-ttu-id="7b5de-157">Umożliwia typów COM, które obsługują wyliczenia powinien być traktowany jako kolekcji.</span><span class="sxs-lookup"><span data-stu-id="7b5de-157">Enables COM types that support enumerations to be treated as collections.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="7b5de-158">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="7b5de-158">See Also</span></span>  
 [<span data-ttu-id="7b5de-159">Otoki COM</span><span class="sxs-lookup"><span data-stu-id="7b5de-159">COM Wrappers</span></span>](com-wrappers.md)  
 <span data-ttu-id="7b5de-160">[Przekazywanie wybranego interfejsów](https://msdn.microsoft.com/library/fdb97fd0-f694-4832-bf15-a4e7cf413840(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="7b5de-160">[Marshaling Selected Interfaces](https://msdn.microsoft.com/library/fdb97fd0-f694-4832-bf15-a4e7cf413840(v=vs.100))</span></span>  
 [<span data-ttu-id="7b5de-161">Wywoływana otoka COM</span><span class="sxs-lookup"><span data-stu-id="7b5de-161">COM Callable Wrapper</span></span>](com-callable-wrapper.md)  
 <span data-ttu-id="7b5de-162">[Biblioteki typów na zestaw konwersja — podsumowanie](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="7b5de-162">[Type Library to Assembly Conversion Summary](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100))</span></span>  
 [<span data-ttu-id="7b5de-163">Importowanie biblioteki typów jako zestawu</span><span class="sxs-lookup"><span data-stu-id="7b5de-163">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
