---
title: Równoważność typów i osadzone typy międzyoperacyjne
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: b9ec21a21ce3c81c2d29d2edf353a098489c9026
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/23/2019
ms.locfileid: "62032890"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="e2ab8-102">Równoważność typów i osadzone typy międzyoperacyjne</span><span class="sxs-lookup"><span data-stu-id="e2ab8-102">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="e2ab8-103">Począwszy od [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], wspólnego obsługuje środowisko uruchomieniowe języka osadzanie informacji o typie dla typów modelu COM bezpośrednio do zestawów zarządzanych, zamiast zestawów zarządzanych uzyskać informacje o typie dla typów modelu COM z zestawów międzyoperacyjnych.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-103">Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="e2ab8-104">Informacje o typie osadzony zawiera tylko typy i elementy członkowskie, które są rzeczywiście używane przez zestaw zarządzany, dwóch zestawów zarządzanych, może być bardzo różne widoki tego samego typu COM.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-104">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="e2ab8-105">Każdy zestaw zarządzany ma inną <xref:System.Type> obiektu do reprezentowania jej widok typów modelu COM.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-105">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="e2ab8-106">Środowisko uruchomieniowe języka wspólnego obsługuje równoważności typu między te różne widoki dla interfejsy, struktury, wyliczenia i delegaty.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-106">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="e2ab8-107">Równoważności typu oznacza o tym, że obiekt COM, który jest przekazywany z jednego zestawu zarządzanego do innego, mogą być rzutowane do odpowiedniego zarządzane typu w zestawie odbierania.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-107">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="e2ab8-108">Równoważność typów i osadzone typy międzyoperacyjne we wdrażaniu aplikacji i dodatki, które korzystają ze składników COM, ponieważ nie jest wymagane do wdrożenia usług międzyoperacyjnych z aplikacjami.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-108">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="e2ab8-109">Deweloperzy udostępnionych składników modelu COM nadal jest konieczne tworzenie podstawowych zestawów międzyoperacyjnych (PIA), jeśli chcą, aby ich składniki do użycia przez starsze wersje programu .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-109">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="e2ab8-110">Odpowiednik typu</span><span class="sxs-lookup"><span data-stu-id="e2ab8-110">Type equivalence</span></span>

 <span data-ttu-id="e2ab8-111">Równoważność typów modelu COM, jest obsługiwana dla interfejsy, struktury, wyliczenia i delegaty.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-111">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="e2ab8-112">Typy modelu COM kwalifikują się jako równoważne, jeśli spełnione są wszystkie z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="e2ab8-112">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="e2ab8-113">Typy są zarówno interfejsów, lub zarówno struktur, lub zarówno wyliczenia lub obu delegatów.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-113">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="e2ab8-114">Typy mają taką samą tożsamość, zgodnie z opisem w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-114">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="e2ab8-115">Oba typy kwalifikują się do typu równoważności, zgodnie z opisem w [oznaczanie typy modelu COM dla równoważności typu](#marking-com-types-for-type-equivalence) sekcji.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-115">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="e2ab8-116">Typ tożsamości</span><span class="sxs-lookup"><span data-stu-id="e2ab8-116">Type identity</span></span>

<span data-ttu-id="e2ab8-117">Dwa typy są określane za tej samej tożsamości, gdy ich zakresów i tożsamości są zgodne, oznacza to, jeśli każda z nich <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> atrybut i dwa atrybuty zawierają zgodnych <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> i <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-117">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="e2ab8-118">Porównanie dla <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> jest rozróżniana wielkość liter.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-118">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="e2ab8-119">Jeśli typ nie ma <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> atrybut, lub jeśli ma <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> atrybut, który nie określa zakresu i identyfikator, typ mogą nadal zostać uwzględnione w równoważności w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="e2ab8-119">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="e2ab8-120">W przypadku interfejsów wartość <xref:System.Runtime.InteropServices.GuidAttribute> jest używana zamiast <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> właściwości i <xref:System.Type.FullName%2A?displayProperty=nameWithType> (czyli nazwę typu, włącznie z przestrzenią nazw) jest używana zamiast <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> właściwości.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-120">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="e2ab8-121">Dla struktury, wyliczenia i delegaci <xref:System.Runtime.InteropServices.GuidAttribute> zestawu zawierającego jest używana zamiast <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> właściwości i <xref:System.Type.FullName%2A?displayProperty=nameWithType> właściwość jest używana zamiast <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-121">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="e2ab8-122">Oznaczanie typów modelu COM dla równoważności typu</span><span class="sxs-lookup"><span data-stu-id="e2ab8-122">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="e2ab8-123">Można oznaczyć typu jako kwalifikuje się do równoważności typu na dwa sposoby:</span><span class="sxs-lookup"><span data-stu-id="e2ab8-123">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="e2ab8-124">Zastosuj <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> atrybutu typu.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-124">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="e2ab8-125">Zmień typ typ importu COM.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-125">Make the type a COM import type.</span></span> <span data-ttu-id="e2ab8-126">Interfejs jest typ importu COM, jeśli ma on <xref:System.Runtime.InteropServices.ComImportAttribute> atrybutu.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-126">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="e2ab8-127">Interfejs, struktury, wyliczenia lub delegata jest typ importu COM, jeśli zestaw, w którym jest zdefiniowana ma <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> atrybutu.</span><span class="sxs-lookup"><span data-stu-id="e2ab8-127">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="e2ab8-128">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="e2ab8-128">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="e2ab8-129">[Używanie typów modelu COM w kodzie zarządzanym](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="e2ab8-129">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="e2ab8-130">Importowanie biblioteki typów jako zestawu</span><span class="sxs-lookup"><span data-stu-id="e2ab8-130">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
