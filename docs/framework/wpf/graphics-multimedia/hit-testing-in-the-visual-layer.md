---
title: Test trafienia w warstwie Visual
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- hit testing functionality [WPF]
- visual layer [WPF], hit testing functionality
ms.assetid: b1a64b61-14be-4d75-b89a-5c67bebb2c7b
ms.openlocfilehash: d4d304353e91147c57297dcc4525759ff1474b4f
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186404"
---
# <a name="hit-testing-in-the-visual-layer"></a><span data-ttu-id="83865-102">Test trafienia w warstwie Visual</span><span class="sxs-lookup"><span data-stu-id="83865-102">Hit Testing in the Visual Layer</span></span>
<span data-ttu-id="83865-103">W tym temacie przedstawiono omówienie funkcji testowania trafień udostępnianych przez warstwę wizualną.</span><span class="sxs-lookup"><span data-stu-id="83865-103">This topic provides an overview of hit testing functionality provided by the visual layer.</span></span> <span data-ttu-id="83865-104">Obsługa testowania trafień umożliwia określenie, czy geometria lub wartość <xref:System.Windows.Media.Visual>punktu mieści się w renderowanej zawartości programu , co pozwala na zaimplementowanie zachowania interfejsu użytkownika, takiego jak prostokąt zaznaczenia, aby zaznaczyć wiele obiektów.</span><span class="sxs-lookup"><span data-stu-id="83865-104">Hit testing support allows you to determine whether a geometry or point value falls within the rendered content of a <xref:System.Windows.Media.Visual>, allowing you to implement user interface behavior such as a selection rectangle to select multiple objects.</span></span>  

<a name="hit_testing_scenarios"></a>
## <a name="hit-testing-scenarios"></a><span data-ttu-id="83865-105">Scenariusze testowania trafień</span><span class="sxs-lookup"><span data-stu-id="83865-105">Hit Testing Scenarios</span></span>  
 <span data-ttu-id="83865-106">Klasa <xref:System.Windows.UIElement> zapewnia <xref:System.Windows.UIElement.InputHitTest%2A> metodę, która umożliwia trafienie test u elementu przy użyciu danej wartości współrzędnych.</span><span class="sxs-lookup"><span data-stu-id="83865-106">The <xref:System.Windows.UIElement> class provides the <xref:System.Windows.UIElement.InputHitTest%2A> method, which allows you to hit test against an element using a given coordinate value.</span></span> <span data-ttu-id="83865-107">W wielu przypadkach <xref:System.Windows.UIElement.InputHitTest%2A> metoda zapewnia żądaną funkcjonalność do implementowania testowania trafień elementów.</span><span class="sxs-lookup"><span data-stu-id="83865-107">In many cases, the <xref:System.Windows.UIElement.InputHitTest%2A> method provides the desired functionality for implementing hit testing of elements.</span></span> <span data-ttu-id="83865-108">Istnieje jednak kilka scenariuszy, w których może być konieczne zaimplementowanie testowania trafień w warstwie wizualnej.</span><span class="sxs-lookup"><span data-stu-id="83865-108">However, there are several scenarios in which you may need to implement hit testing at the visual layer.</span></span>  
  
- <span data-ttu-id="83865-109">Testowanie trafień<xref:System.Windows.UIElement> przeciwko obiektom niebędącym obiektami:<xref:System.Windows.UIElement> ma to <xref:System.Windows.Media.DrawingVisual> zastosowanie w przypadku trafienia podczas testowania obiektów niebędących obiektami, takimi jak obiekty graficzne.</span><span class="sxs-lookup"><span data-stu-id="83865-109">Hit testing against non-<xref:System.Windows.UIElement> objects: This applies if you are hit testing non-<xref:System.Windows.UIElement> objects, such as <xref:System.Windows.Media.DrawingVisual> or graphics objects.</span></span>  
  
- <span data-ttu-id="83865-110">Testowanie trafień przy użyciu geometrii: Ma to zastosowanie, jeśli konieczne jest trafienie testu przy użyciu obiektu geometrii, a nie wartości współrzędnych punktu.</span><span class="sxs-lookup"><span data-stu-id="83865-110">Hit testing using a geometry: This applies if you need to hit test using a geometry object rather than the coordinate value of a point.</span></span>  
  
- <span data-ttu-id="83865-111">Testowanie trafień względem wielu obiektów: ma to zastosowanie, gdy trzeba trafić test na wiele obiektów, takich jak nakładające się obiekty.</span><span class="sxs-lookup"><span data-stu-id="83865-111">Hit testing against multiple objects: This applies when you need to hit test against multiple objects, such as overlapping objects.</span></span> <span data-ttu-id="83865-112">Można uzyskać wyniki dla wszystkich wizualizacji przecinających geometrię lub punkt, a nie tylko dla pierwszego.</span><span class="sxs-lookup"><span data-stu-id="83865-112">You can get results for all visuals intersecting a geometry or point, not just the first one.</span></span>  
  
- <span data-ttu-id="83865-113">Ignorowanie <xref:System.Windows.UIElement> zasad testowania trafień: ma to <xref:System.Windows.UIElement> zastosowanie, gdy trzeba zignorować zasady testowania trafień, która uwzględnia takie czynniki, jak to, czy element jest wyłączony, czy niewidoczny.</span><span class="sxs-lookup"><span data-stu-id="83865-113">Ignoring <xref:System.Windows.UIElement> hit testing policy: This applies when you need to ignore the <xref:System.Windows.UIElement> hit testing policy, which takes into consideration such factors as whether an element is disabled or invisible.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="83865-114">Aby uzyskać pełny przykładowy kod ilustrujący testowanie trafień w warstwie wizualnej, zobacz [Hit Test using DrawingVisuals Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual) and Hit Test with [Win32 Interoperation Sample](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting).</span><span class="sxs-lookup"><span data-stu-id="83865-114">For a complete code sample illustrating hit testing at the visual layer, see [Hit Test Using DrawingVisuals Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual) and [Hit Test with Win32 Interoperation Sample](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting).</span></span>  
  
<a name="hit_testing_support"></a>
## <a name="hit-testing-support"></a><span data-ttu-id="83865-115">Pomoc techniczna w testowaniu trafień</span><span class="sxs-lookup"><span data-stu-id="83865-115">Hit Testing Support</span></span>  
 <span data-ttu-id="83865-116">Celem <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metod w <xref:System.Windows.Media.VisualTreeHelper> klasie jest określenie, czy wartość geometrii lub współrzędnych punktowych znajduje się w renderowanych zawartości danego obiektu, takich jak formant lub element graficzny.</span><span class="sxs-lookup"><span data-stu-id="83865-116">The purpose of the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class is to determine whether a geometry or point coordinate value is within the rendered content of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="83865-117">Na przykład można użyć testowania trafień, aby ustalić, czy kliknięcie myszą w obrębie prostokąta ograniczającego obiektu mieści się w geometrii okręgu.</span><span class="sxs-lookup"><span data-stu-id="83865-117">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle.</span></span> <span data-ttu-id="83865-118">Można również zastąpić domyślną implementację testowania trafień, aby wykonać własne niestandardowe obliczenia testu trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-118">You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="83865-119">Na poniższej ilustracji przedstawiono relację między regionem obiektu niekularnego a jego prostokątnym prostokątem.</span><span class="sxs-lookup"><span data-stu-id="83865-119">The following illustration shows the relationship between a non-rectangular object's region and its bounding rectangle.</span></span>  
  
 <span data-ttu-id="83865-120">![Diagram prawidłowego regionu testu trafień](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span><span class="sxs-lookup"><span data-stu-id="83865-120">![Diagram of valid hit test region](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span></span>  
<span data-ttu-id="83865-121">Diagram prawidłowego regionu testu trafień</span><span class="sxs-lookup"><span data-stu-id="83865-121">Diagram of valid hit test region</span></span>  
  
<a name="hit_testing_and_z-order"></a>
## <a name="hit-testing-and-z-order"></a><span data-ttu-id="83865-122">Testowanie trafień i zamówienie Z</span><span class="sxs-lookup"><span data-stu-id="83865-122">Hit Testing and Z-Order</span></span>  
 <span data-ttu-id="83865-123">Warstwa wizualna [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] obsługuje testowanie trafień względem wszystkich obiektów znajdujących się pod punktem lub geometrią, a nie tylko obiektów najwyższej klasy.</span><span class="sxs-lookup"><span data-stu-id="83865-123">The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] visual layer supports hit testing against all objects under a point or geometry, not just the top-most object.</span></span> <span data-ttu-id="83865-124">Wyniki są zwracane w kolejności z.</span><span class="sxs-lookup"><span data-stu-id="83865-124">Results are returned in z-order.</span></span> <span data-ttu-id="83865-125">Jednak obiekt wizualny, który przekazujesz <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> jako parametr do metody określa, która część drzewa wizualnego, która zostanie trafiona test.</span><span class="sxs-lookup"><span data-stu-id="83865-125">However, the visual object that you pass as the parameter to the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method determines which portion of the visual tree that will be hit test.</span></span> <span data-ttu-id="83865-126">Możesz trafić test na całe drzewo wizualne lub dowolną jego część.</span><span class="sxs-lookup"><span data-stu-id="83865-126">You can hit test against the entire visual tree, or any portion of it.</span></span>  
  
 <span data-ttu-id="83865-127">Na poniższej ilustracji obiekt okręgu znajduje się zarówno na wierzchu obiektów kwadratowych, jak i trójkątnych.</span><span class="sxs-lookup"><span data-stu-id="83865-127">In the following illustration, the circle object is on top of both the square and triangle objects.</span></span> <span data-ttu-id="83865-128">Jeśli jesteś zainteresowany tylko trafienie testowania obiektu wizualnego, którego wartość z-order jest najwyższa, <xref:System.Windows.Media.HitTestResultBehavior.Stop> można <xref:System.Windows.Media.HitTestResultCallback> ustawić wizualne wyliczenie testu trafienia, aby powrócić z, aby zatrzymać przechodzenie testu trafień po pierwszym elemencie.</span><span class="sxs-lookup"><span data-stu-id="83865-128">If you are only interested in hit testing the visual object whose z-order value is top-most, you can set the visual hit test enumeration to return <xref:System.Windows.Media.HitTestResultBehavior.Stop> from the <xref:System.Windows.Media.HitTestResultCallback> to stop the hit test traversal after the first item.</span></span>  
  
 <span data-ttu-id="83865-129">![Diagram kolejności&#45;z drzewa wizualnego](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span><span class="sxs-lookup"><span data-stu-id="83865-129">![Diagram of the z&#45;order of a visual tree](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span></span>  
<span data-ttu-id="83865-130">Diagram kolejności z drzewa wizualnego</span><span class="sxs-lookup"><span data-stu-id="83865-130">Diagram of the z-order of a visual tree</span></span>  
  
 <span data-ttu-id="83865-131">Jeśli chcesz wyliczyć wszystkie obiekty wizualne pod określonym <xref:System.Windows.Media.HitTestResultBehavior.Continue> punktem <xref:System.Windows.Media.HitTestResultCallback>lub geometrią, wróć z pliku .</span><span class="sxs-lookup"><span data-stu-id="83865-131">If you want to enumerate all visual objects under a specific point or geometry, return <xref:System.Windows.Media.HitTestResultBehavior.Continue> from the <xref:System.Windows.Media.HitTestResultCallback>.</span></span> <span data-ttu-id="83865-132">Oznacza to, że można trafić test dla obiektów wizualnych, które znajdują się pod innymi obiektami, nawet jeśli są one całkowicie zasłonięte.</span><span class="sxs-lookup"><span data-stu-id="83865-132">This means you can hit test for visual objects that are beneath other objects, even if they are wholly obscured.</span></span> <span data-ttu-id="83865-133">Zobacz przykładowy kod w sekcji "Korzystanie z wywołania zwrotnego wyników testu trafień", aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="83865-133">See the sample code in the section "Using a Hit Test Results Callback" for more information.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="83865-134">Obiekt wizualny, który jest przezroczysty może być również test trafienia.</span><span class="sxs-lookup"><span data-stu-id="83865-134">A visual object that is transparent can also be hit test.</span></span>  
  
<a name="using_default_hit_testing"></a>
## <a name="using-default-hit-testing"></a><span data-ttu-id="83865-135">Korzystanie z domyślnego testowania trafień</span><span class="sxs-lookup"><span data-stu-id="83865-135">Using Default Hit Testing</span></span>  
 <span data-ttu-id="83865-136">Można określić, czy punkt znajduje się w geometrii <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> obiektu wizualnego, za pomocą metody, aby określić obiekt wizualny i wartość współrzędnych punktu do przetestowania.</span><span class="sxs-lookup"><span data-stu-id="83865-136">You can identify whether a point is within the geometry of a visual object, by using the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method to specify a visual object and a point coordinate value to test against.</span></span> <span data-ttu-id="83865-137">Parametr obiektu wizualnego identyfikuje punkt początkowy w drzewie wizualnym dla wyszukiwania testu trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-137">The visual object parameter identifies the starting point in the visual tree for the hit test search.</span></span> <span data-ttu-id="83865-138">Jeśli obiekt wizualny zostanie znaleziony w drzewie wizualnym, którego <xref:System.Windows.Media.HitTestResult.VisualHit%2A> geometria <xref:System.Windows.Media.HitTestResult> zawiera współrzędną, jest on ustawiony na właściwość obiektu.</span><span class="sxs-lookup"><span data-stu-id="83865-138">If a visual object is found in the visual tree whose geometry contains the coordinate, it is set to the <xref:System.Windows.Media.HitTestResult.VisualHit%2A> property of a <xref:System.Windows.Media.HitTestResult> object.</span></span> <span data-ttu-id="83865-139">Następnie <xref:System.Windows.Media.HitTestResult> jest zwracany <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> z metody.</span><span class="sxs-lookup"><span data-stu-id="83865-139">The <xref:System.Windows.Media.HitTestResult> is then returned from the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span> <span data-ttu-id="83865-140">Jeśli punkt nie jest zawarty w wizualnym poddrzewie, które trafisz, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> zwraca wartość `null`.</span><span class="sxs-lookup"><span data-stu-id="83865-140">If the point is not contained with the visual sub-tree you are hit testing, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> returns `null`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="83865-141">Domyślne testowanie trafień zawsze zwraca najbardziej najlepszy obiekt w kolejności z.</span><span class="sxs-lookup"><span data-stu-id="83865-141">Default hit testing always returns the top-most object in the z-order.</span></span> <span data-ttu-id="83865-142">Aby zidentyfikować wszystkie obiekty wizualne, nawet te, które mogą być częściowo lub całkowicie zasłonięte, użyj wywołania zwrotnego wyniku testu trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-142">In order to identify all visual objects, even those that may be partly or wholly obscured, use a hit test result callback.</span></span>  
  
 <span data-ttu-id="83865-143">Wartość współrzędnych, którą <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> przekazujesz jako parametr punktowy dla metody, musi być względem przestrzeni współrzędnych obiektu wizualnego, przeciwko której trafisz test.</span><span class="sxs-lookup"><span data-stu-id="83865-143">The coordinate value you pass as the point parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method has to be relative to the coordinate space of the visual object you are hit testing against.</span></span> <span data-ttu-id="83865-144">Na przykład jeśli masz zagnieżdżone obiekty wizualne zdefiniowane w (100, 100) w przestrzeni współrzędnych nadrzędnego, a następnie trafienie testowania wizualizacji podrzędnej w (0, 0) jest równoznaczne z testowaniem trafień (100, 100) w przestrzeni współrzędnych rodzica.</span><span class="sxs-lookup"><span data-stu-id="83865-144">For example, if you have nested visual objects defined at (100, 100) in the parent's coordinate space, then hit testing a child visual at (0, 0) is equivalent to hit testing at (100, 100) in the parent's coordinate space.</span></span>  
  
 <span data-ttu-id="83865-145">Poniższy kod pokazuje, jak skonfigurować programy <xref:System.Windows.UIElement> obsługi zdarzeń myszy dla obiektu, który jest używany do przechwytywania zdarzeń używanych do testowania trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-145">The following code shows how to set up mouse event handlers for a <xref:System.Windows.UIElement> object that is used to capture events used for hit testing.</span></span>  
  
 [!code-csharp[HitTestingOverview#100](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#100)]
 [!code-vb[HitTestingOverview#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#100)]  
  
### <a name="how-the-visual-tree-affects-hit-testing"></a><span data-ttu-id="83865-146">Jak drzewo wizualne wpływa na testowanie trafień</span><span class="sxs-lookup"><span data-stu-id="83865-146">How the Visual Tree Affects Hit Testing</span></span>  
 <span data-ttu-id="83865-147">Punkt początkowy w drzewie wizualnym określa, które obiekty są zwracane podczas wyliczania obiektów testu trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-147">The starting point in the visual tree determines which objects are returned during the hit test enumeration of objects.</span></span> <span data-ttu-id="83865-148">Jeśli masz wiele obiektów, które chcesz trafić test, obiekt wizualny używany jako punkt początkowy w drzewie wizualnym musi być wspólnym elementem nadrzędnym wszystkich interesujących obiektów.</span><span class="sxs-lookup"><span data-stu-id="83865-148">If you have multiple objects you want to hit test, the visual object used as the starting point in the visual tree must be the common ancestor of all objects of interest.</span></span> <span data-ttu-id="83865-149">Na przykład jeśli chcesz trafić testowania zarówno elementu przycisku i rysunku wizualnego na poniższym diagramie, trzeba ustawić punkt początkowy w drzewie wizualnym do wspólnego elementu nadrzędnego obu.</span><span class="sxs-lookup"><span data-stu-id="83865-149">For example, if you were interested in hit testing both the button element and drawing visual in the following diagram, you would have to set the starting point in the visual tree to the common ancestor of both.</span></span> <span data-ttu-id="83865-150">W takim przypadku element płótna jest wspólnym elementem nadrzędnym zarówno elementu przycisku, jak i wizualizacji rysunku.</span><span class="sxs-lookup"><span data-stu-id="83865-150">In this case, the canvas element is the common ancestor of both the button element and the drawing visual.</span></span>  
  
 <span data-ttu-id="83865-151">![Diagram hierarchii drzewa wizualnego](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span><span class="sxs-lookup"><span data-stu-id="83865-151">![Diagram of a visual tree hierarchy](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span></span>  
<span data-ttu-id="83865-152">Diagram hierarchii drzewa wizualnego</span><span class="sxs-lookup"><span data-stu-id="83865-152">Diagram of a visual tree hierarchy</span></span>  
  
> [!NOTE]
> <span data-ttu-id="83865-153">Właściwość <xref:System.Windows.UIElement.IsHitTestVisible%2A> pobiera lub ustawia wartość, <xref:System.Windows.UIElement>która deklaruje, czy obiekt pochodny może być ewentualnie zwrócony jako wynik testu trafień z pewnej części jego renderowanej zawartości.</span><span class="sxs-lookup"><span data-stu-id="83865-153">The <xref:System.Windows.UIElement.IsHitTestVisible%2A> property gets or sets a value that declares whether a <xref:System.Windows.UIElement>-derived object can possibly be returned as a hit test result from some portion of its rendered content.</span></span> <span data-ttu-id="83865-154">Dzięki temu można selektywnie zmienić drzewa wizualnego, aby określić, które obiekty wizualne są zaangażowane w test trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-154">This allows you to selectively alter the visual tree to determine which visual objects are involved in a hit test.</span></span>  
  
<a name="using_a_hit_test_result_callback"></a>
## <a name="using-a-hit-test-result-callback"></a><span data-ttu-id="83865-155">Korzystanie z wywołania zwrotnego wyniku testu trafień</span><span class="sxs-lookup"><span data-stu-id="83865-155">Using a Hit Test Result Callback</span></span>  
 <span data-ttu-id="83865-156">Można wyliczyć wszystkie obiekty wizualne w drzewie wizualnym, którego geometria zawiera określoną wartość współrzędnych.</span><span class="sxs-lookup"><span data-stu-id="83865-156">You can enumerate all visual objects in a visual tree whose geometry contains a specified coordinate value.</span></span> <span data-ttu-id="83865-157">Pozwala to zidentyfikować wszystkie obiekty wizualne, nawet te, które mogą być częściowo lub całkowicie zasłonięte przez inne obiekty wizualne.</span><span class="sxs-lookup"><span data-stu-id="83865-157">This allows you to identify all visual objects, even those that may be partly or wholly obscured by other visual objects.</span></span> <span data-ttu-id="83865-158">Aby wyliczyć obiekty wizualne w <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> drzewie wizualnym należy użyć metody z funkcją wywołania zwrotnego testu trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-158">To enumerate visual objects in a visual tree use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method with a hit test callback function.</span></span> <span data-ttu-id="83865-159">Funkcja wywołania zwrotnego testu trafień jest wywoływana przez system, gdy określona wartość współrzędnych znajduje się w obiekcie wizualnym.</span><span class="sxs-lookup"><span data-stu-id="83865-159">The hit test callback function is called by the system when the coordinate value you specify is contained in a visual object.</span></span>  
  
 <span data-ttu-id="83865-160">Podczas wyliczania wyników testu trafienia nie należy wykonywać żadnej operacji, która modyfikuje drzewo wizualne.</span><span class="sxs-lookup"><span data-stu-id="83865-160">During the hit test results enumeration, you should not perform any operation that modifies the visual tree.</span></span> <span data-ttu-id="83865-161">Dodawanie lub usuwanie obiektu z drzewa wizualnego podczas przechodzenia może spowodować nieprzewidywalne zachowanie.</span><span class="sxs-lookup"><span data-stu-id="83865-161">Adding or removing an object from the visual tree while it is being traversed can result in unpredictable behavior.</span></span> <span data-ttu-id="83865-162">Można bezpiecznie zmodyfikować drzewa <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> wizualnego po zwraca metodę.</span><span class="sxs-lookup"><span data-stu-id="83865-162">You can safely modify the visual tree after the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method returns.</span></span> <span data-ttu-id="83865-163">Można podać strukturę danych, takich <xref:System.Collections.ArrayList>jak , do przechowywania wartości podczas wyliczenia wyników testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="83865-163">You may want to provide a data structure, such as an <xref:System.Collections.ArrayList>, to store values during the hit test results enumeration.</span></span>  
  
 [!code-csharp[HitTestingOverview#101](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[HitTestingOverview#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="83865-164">Metoda wywołania zwrotnego testu trafień definiuje akcje wykonywane po zidentyfikowaniu testu trafień na określonym obiekcie wizualnym w drzewie wizualnym.</span><span class="sxs-lookup"><span data-stu-id="83865-164">The hit test callback method defines the actions you perform when a hit test is identified on a particular visual object in the visual tree.</span></span> <span data-ttu-id="83865-165">Po wykonaniu akcji zwracasz <xref:System.Windows.Media.HitTestResultBehavior> wartość, która określa, czy kontynuować wyliczanie innych obiektów wizualnych, czy nie.</span><span class="sxs-lookup"><span data-stu-id="83865-165">After you perform the actions, you return a <xref:System.Windows.Media.HitTestResultBehavior> value that determines whether to continue the enumeration of any other visual objects or not.</span></span>  
  
 [!code-csharp[HitTestingOverview#102](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[HitTestingOverview#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#102)]  
  
> [!NOTE]
> <span data-ttu-id="83865-166">Kolejność wyliczania trafień obiektów wizualnych jest według kolejności z.</span><span class="sxs-lookup"><span data-stu-id="83865-166">The order of enumeration of hit visual objects is by z-order.</span></span> <span data-ttu-id="83865-167">Obiekt wizualny na najwyższym poziomie z-order jest pierwszym obiektem wyliczonym.</span><span class="sxs-lookup"><span data-stu-id="83865-167">The visual object at the top-most z-order level is the first object enumerated.</span></span> <span data-ttu-id="83865-168">Wszystkie inne obiekty wizualne wyliczone są na malejącym poziomie z-order.</span><span class="sxs-lookup"><span data-stu-id="83865-168">Any other visual objects enumerated are at decreasing z-order level.</span></span> <span data-ttu-id="83865-169">Ta kolejność wyliczenia odpowiada kolejności renderowania wizualizacji.</span><span class="sxs-lookup"><span data-stu-id="83865-169">This order of enumeration corresponds to the rendering order of the visuals.</span></span>  
  
 <span data-ttu-id="83865-170">Wyliczenie obiektów wizualnych można zatrzymać w dowolnym momencie w funkcji <xref:System.Windows.Media.HitTestResultBehavior.Stop>wywołania zwrotnego testu trafień, zwracając program .</span><span class="sxs-lookup"><span data-stu-id="83865-170">You can stop the enumeration of visual objects at any time in the hit test callback function by returning <xref:System.Windows.Media.HitTestResultBehavior.Stop>.</span></span>  
  
 [!code-csharp[HitTestingOverview#103](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#103)]
 [!code-vb[HitTestingOverview#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#103)]  
  
<a name="using_a_hit_test_filter_callback"></a>
## <a name="using-a-hit-test-filter-callback"></a><span data-ttu-id="83865-171">Korzystanie z wywołania zwrotnego filtru testu trafień</span><span class="sxs-lookup"><span data-stu-id="83865-171">Using a Hit Test Filter Callback</span></span>  
 <span data-ttu-id="83865-172">Można użyć opcjonalnego filtru testu trafień, aby ograniczyć obiekty, które są przekazywane do wyników testu trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-172">You can use an optional hit test filter to restrict the objects that are passed on to the hit test results.</span></span> <span data-ttu-id="83865-173">Dzięki temu można zignorować części drzewa wizualnego, które nie są zainteresowane przetwarzania w wynikach testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="83865-173">This allows you to ignore parts of the visual tree that you are not interested in processing in your hit test results.</span></span> <span data-ttu-id="83865-174">Aby zaimplementować filtr testu trafień, należy zdefiniować funkcję wywołania zwrotnego filtru testu trafień i przekazać ją jako wartość parametru podczas wywoływania <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="83865-174">To implement a hit test filter, you define a hit test filter callback function and pass it as a parameter value when you call the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#104](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#104)]
 [!code-vb[HitTestingOverview#104](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#104)]  
  
 <span data-ttu-id="83865-175">Jeśli nie chcesz podać opcjonalnefilmowanie filtru testu `null` trafienia wywołania <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> zwrotnego, przekazać wartość jako jego parametr dla metody.</span><span class="sxs-lookup"><span data-stu-id="83865-175">If you do not want to supply the optional hit test filter callback function, pass a `null` value as its parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#105](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#105)]
 [!code-vb[HitTestingOverview#105](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#105)]  
  
 <span data-ttu-id="83865-176">![Przycinanie drzewa wizualnego przy użyciu filtru testu trafień](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span><span class="sxs-lookup"><span data-stu-id="83865-176">![Pruning a visual tree using a hit test filter](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span></span>  
<span data-ttu-id="83865-177">Przycinanie drzewa wizualnego</span><span class="sxs-lookup"><span data-stu-id="83865-177">Pruning a visual tree</span></span>  
  
 <span data-ttu-id="83865-178">Funkcja wywołania zwrotnego filtru testu trafień umożliwia wyliczenie wszystkich wizualizacji, których renderowana zawartość zawiera określone współrzędne.</span><span class="sxs-lookup"><span data-stu-id="83865-178">The hit test filter callback function allows you to enumerate through all the visuals whose rendered content contains the coordinates you specify.</span></span> <span data-ttu-id="83865-179">Jednak można zignorować niektóre gałęzie drzewa wizualnego, które nie są zainteresowane przetwarzaniem w wynikach trafień funkcji wywołania zwrotnego wyników.</span><span class="sxs-lookup"><span data-stu-id="83865-179">However, you may want to ignore certain branches of the visual tree that you are not interested in processing in your hit test results callback function.</span></span> <span data-ttu-id="83865-180">Zwracana wartość funkcji wywołania zwrotnego filtru testu trafień określa, jaki typ akcji należy podjąć wyliczanie obiektów wizualnych.</span><span class="sxs-lookup"><span data-stu-id="83865-180">The return value of the hit test filter callback function determines what type of action the enumeration of the visual objects should take.</span></span> <span data-ttu-id="83865-181">Na przykład, jeśli zwrócisz <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>wartość, można usunąć bieżący obiekt wizualny i jego elementy podrzędne z wyliczenia wyników testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="83865-181">For example, if you return the value, <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>, you can remove the current visual object and its children from the hit test results enumeration.</span></span> <span data-ttu-id="83865-182">Oznacza to, że wyniki testu trafienia wywołanie zwrotne funkcji nie zobaczy tych obiektów w jego wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="83865-182">This means that the hit test results callback function will not see these objects in its enumeration.</span></span> <span data-ttu-id="83865-183">Przycinanie drzewa wizualnego obiektów zmniejsza ilość przetwarzania podczas przebiegu wyliczenia wyników testu trafień.</span><span class="sxs-lookup"><span data-stu-id="83865-183">Pruning the visual tree of objects decreases the amount of processing during the hit test results enumeration pass.</span></span> <span data-ttu-id="83865-184">W poniższym przykładzie kodu filtr pomija etykiety i ich elementy podrzędne i trafienia testuje wszystko inne.</span><span class="sxs-lookup"><span data-stu-id="83865-184">In the following code example, the filter skips labels and their descendants and hit tests everything else.</span></span>  
  
 [!code-csharp[HitTestingOverview#106](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#106)]
 [!code-vb[HitTestingOverview#106](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#106)]  
  
> [!NOTE]
> <span data-ttu-id="83865-185">Wywołanie zwrotne filtru testu trafień będzie czasami wywoływane w przypadkach, gdy wywołanie wywołania zwrotnego wyników testu trafień nie jest wywoływane.</span><span class="sxs-lookup"><span data-stu-id="83865-185">The hit test filter callback will sometimes be called in cases where the hit test results callback is not called.</span></span>  
  
<a name="overriding_default_hit_testing"></a>
## <a name="overriding-default-hit-testing"></a><span data-ttu-id="83865-186">Zastępowanie domyślnego testowania trafień</span><span class="sxs-lookup"><span data-stu-id="83865-186">Overriding Default Hit Testing</span></span>  
 <span data-ttu-id="83865-187">Można zastąpić domyślną obsługę testowania trafień obiektu wizualnego, zastępując <xref:System.Windows.Media.Visual.HitTestCore%2A> metodę.</span><span class="sxs-lookup"><span data-stu-id="83865-187">You can override a visual object’s default hit testing support by overriding the <xref:System.Windows.Media.Visual.HitTestCore%2A> method.</span></span> <span data-ttu-id="83865-188">Oznacza to, że podczas <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> wywoływania metody, implementacja zastąpiona <xref:System.Windows.Media.Visual.HitTestCore%2A> jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="83865-188">This means that when you invoke the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method, your overridden implementation of <xref:System.Windows.Media.Visual.HitTestCore%2A> is called.</span></span> <span data-ttu-id="83865-189">Zastąpiona metoda jest wywoływana, gdy test trafień mieści się w prostokątze ograniczającym obiektu wizualnego, nawet jeśli współrzędna wykracza poza renderowanej zawartości obiektu wizualnego.</span><span class="sxs-lookup"><span data-stu-id="83865-189">Your overridden method is called when a hit test falls within the bounding rectangle of the visual object, even if the coordinate falls outside the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#107](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#107)]
 [!code-vb[HitTestingOverview#107](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#107)]  
  
 <span data-ttu-id="83865-190">Może się okazać, że chcesz trafić test zarówno względem prostokąta ograniczającego, jak i renderowanej zawartości obiektu wizualnego.</span><span class="sxs-lookup"><span data-stu-id="83865-190">There may be times when you want to hit test against both the bounding rectangle and the rendered content of a visual object.</span></span> <span data-ttu-id="83865-191">Za pomocą `PointHitTestParameters` wartości parametru w <xref:System.Windows.Media.Visual.HitTestCore%2A> zastąpiona metoda jako <xref:System.Windows.Media.Visual.HitTestCore%2A>parametr do metody podstawowej , można wykonać akcje na podstawie trafienia prostokąta ograniczającego obiektu wizualnego, a następnie wykonać drugi test trafień względem renderowanej zawartości obiektu wizualnego.</span><span class="sxs-lookup"><span data-stu-id="83865-191">By using the `PointHitTestParameters` parameter value in your overridden <xref:System.Windows.Media.Visual.HitTestCore%2A> method as the parameter to the base method <xref:System.Windows.Media.Visual.HitTestCore%2A>, you can perform actions based on a hit of the bounding rectangle of a visual object, and then perform a second hit test against the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#108](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#108)]
 [!code-vb[HitTestingOverview#108](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#108)]  
  
## <a name="see-also"></a><span data-ttu-id="83865-192">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="83865-192">See also</span></span>

- <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>
- <xref:System.Windows.Media.HitTestResult>
- <xref:System.Windows.Media.HitTestResultCallback>
- <xref:System.Windows.Media.HitTestFilterCallback>
- <xref:System.Windows.UIElement.IsHitTestVisible%2A>
- [<span data-ttu-id="83865-193">Test trafień przy użyciu przykładu DrawingVisuals</span><span class="sxs-lookup"><span data-stu-id="83865-193">Hit Test Using DrawingVisuals Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual)
- [<span data-ttu-id="83865-194">Test trafień z próbką interoperacyjności Win32</span><span class="sxs-lookup"><span data-stu-id="83865-194">Hit Test with Win32 Interoperation Sample</span></span>](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting)
- [<span data-ttu-id="83865-195">Przeprowadź test trafienia geometrii w Visual</span><span class="sxs-lookup"><span data-stu-id="83865-195">Hit Test Geometry in a Visual</span></span>](how-to-hit-test-geometry-in-a-visual.md)
- [<span data-ttu-id="83865-196">Przeprowadzanie testu trafienia za pomocą kontenera hosta Win32</span><span class="sxs-lookup"><span data-stu-id="83865-196">Hit Test Using a Win32 Host Container</span></span>](how-to-hit-test-using-a-win32-host-container.md)
