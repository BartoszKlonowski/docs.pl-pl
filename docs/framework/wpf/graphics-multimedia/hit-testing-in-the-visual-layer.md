---
title: Test trafienia w warstwie Visual
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- hit testing functionality [WPF]
- visual layer [WPF], hit testing functionality
ms.assetid: b1a64b61-14be-4d75-b89a-5c67bebb2c7b
ms.openlocfilehash: 0cb8d0656765e5bc2c2a54ef5f282a67d8579f20
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/18/2019
ms.locfileid: "59082181"
---
# <a name="hit-testing-in-the-visual-layer"></a><span data-ttu-id="267a4-102">Test trafienia w warstwie Visual</span><span class="sxs-lookup"><span data-stu-id="267a4-102">Hit Testing in the Visual Layer</span></span>
<span data-ttu-id="267a4-103">Ten temat zawiera omówienie funkcji testowania trafień, dostarczone przez warstwy visual.</span><span class="sxs-lookup"><span data-stu-id="267a4-103">This topic provides an overview of hit testing functionality provided by the visual layer.</span></span> <span data-ttu-id="267a4-104">Obsługa testowania trafień pozwala określić, czy wartość geometrii lub punkt mieści się w renderowanym zawartość <xref:System.Windows.Media.Visual>, dzięki czemu można zaimplementować zachowania interfejsu użytkownika, takie jak prostokąta zaznaczenia na wybranie wielu obiektów.</span><span class="sxs-lookup"><span data-stu-id="267a4-104">Hit testing support allows you to determine whether a geometry or point value falls within the rendered content of a <xref:System.Windows.Media.Visual>, allowing you to implement user interface behavior such as a selection rectangle to select multiple objects.</span></span>  

<a name="hit_testing_scenarios"></a>   
## <a name="hit-testing-scenarios"></a><span data-ttu-id="267a4-105">Trafienia scenariuszy testowania</span><span class="sxs-lookup"><span data-stu-id="267a4-105">Hit Testing Scenarios</span></span>  
 <span data-ttu-id="267a4-106"><xref:System.Windows.UIElement> Klasa udostępnia <xref:System.Windows.UIElement.InputHitTest%2A> metody, która pozwala na trafień Testuj pod względem elementu za pomocą podanej wartości współrzędnych.</span><span class="sxs-lookup"><span data-stu-id="267a4-106">The <xref:System.Windows.UIElement> class provides the <xref:System.Windows.UIElement.InputHitTest%2A> method, which allows you to hit test against an element using a given coordinate value.</span></span> <span data-ttu-id="267a4-107">W wielu przypadkach <xref:System.Windows.UIElement.InputHitTest%2A> metoda zapewnia odpowiednich funkcji do testowania elementów wykonawczych trafień.</span><span class="sxs-lookup"><span data-stu-id="267a4-107">In many cases, the <xref:System.Windows.UIElement.InputHitTest%2A> method provides the desired functionality for implementing hit testing of elements.</span></span> <span data-ttu-id="267a4-108">Istnieje jednak kilka scenariuszy, w których użytkownik może być konieczne wdrożenie testowania trafień w warstwie visual.</span><span class="sxs-lookup"><span data-stu-id="267a4-108">However, there are several scenarios in which you may need to implement hit testing at the visual layer.</span></span>  
  
-   <span data-ttu-id="267a4-109">Test przed non - trafienia<xref:System.Windows.UIElement> obiektów: Ma to zastosowanie, jeśli napotkasz testowania non -<xref:System.Windows.UIElement> obiekty, takie jak <xref:System.Windows.Media.DrawingVisual> lub obiektów graficznych.</span><span class="sxs-lookup"><span data-stu-id="267a4-109">Hit testing against non-<xref:System.Windows.UIElement> objects: This applies if you are hit testing non-<xref:System.Windows.UIElement> objects, such as <xref:System.Windows.Media.DrawingVisual> or graphics objects.</span></span>  
  
-   <span data-ttu-id="267a4-110">Test przy użyciu geometrii trafienia: Ma to zastosowanie, jeśli potrzebujesz test trafienia przy użyciu obiektów geometrii, a nie wartość współrzędnych punktu.</span><span class="sxs-lookup"><span data-stu-id="267a4-110">Hit testing using a geometry: This applies if you need to hit test using a geometry object rather than the coordinate value of a point.</span></span>  
  
-   <span data-ttu-id="267a4-111">Trafienia testowanie wielu obiektów: Ma to zastosowanie, gdy trzeba trafień Testuj pod względem wielu obiektów, takich jak nakładających się obiektów.</span><span class="sxs-lookup"><span data-stu-id="267a4-111">Hit testing against multiple objects: This applies when you need to hit test against multiple objects, such as overlapping objects.</span></span> <span data-ttu-id="267a4-112">Aby uzyskać wyniki dla wszystkich wizualizacji przecinające się geometrię lub punktu, nie tylko pierwszy z nich.</span><span class="sxs-lookup"><span data-stu-id="267a4-112">You can get results for all visuals intersecting a geometry or point, not just the first one.</span></span>  
  
-   <span data-ttu-id="267a4-113">Ignorowanie <xref:System.Windows.UIElement> zasady testowania trafień: Ma to zastosowanie, gdy należy zignorować <xref:System.Windows.UIElement> trafień testowania zasad, które uwzględnia takie czynniki jak tego, czy element jest wyłączony lub niewidoczne.</span><span class="sxs-lookup"><span data-stu-id="267a4-113">Ignoring <xref:System.Windows.UIElement> hit testing policy: This applies when you need to ignore the <xref:System.Windows.UIElement> hit testing policy, which takes into consideration such factors as whether an element is disabled or invisible.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="267a4-114">Aby uzyskać kompletny kod przykładowy pokazujący test trafienia w warstwie wizualizacji, zobacz [trafień za pomocą DrawingVisuals próbkę](https://go.microsoft.com/fwlink/?LinkID=159994) i [trafień testu z Win32 — współdziałanie](https://go.microsoft.com/fwlink/?LinkID=159995).</span><span class="sxs-lookup"><span data-stu-id="267a4-114">For a complete code sample illustrating hit testing at the visual layer, see [Hit Test Using DrawingVisuals Sample](https://go.microsoft.com/fwlink/?LinkID=159994) and [Hit Test with Win32 Interoperation Sample](https://go.microsoft.com/fwlink/?LinkID=159995).</span></span>  
  
<a name="hit_testing_support"></a>   
## <a name="hit-testing-support"></a><span data-ttu-id="267a4-115">Obsługa testowania trafień</span><span class="sxs-lookup"><span data-stu-id="267a4-115">Hit Testing Support</span></span>  
 <span data-ttu-id="267a4-116">Celem <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody <xref:System.Windows.Media.VisualTreeHelper> klasy ma na celu określenie, czy wartość współrzędnych geometrii lub punkt znajduje się w renderowanej zawartości danego obiektu, takiego jak kontrolka lub element graficzny.</span><span class="sxs-lookup"><span data-stu-id="267a4-116">The purpose of the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class is to determine whether a geometry or point coordinate value is within the rendered content of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="267a4-117">Na przykład można użyć testowania trafień do określenia, czy kliknięcia w ramach prostokąt otaczający obiektu mieści się w geometrii okrąg.</span><span class="sxs-lookup"><span data-stu-id="267a4-117">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle.</span></span> <span data-ttu-id="267a4-118">Można także Przesłoń domyślną implementację elementu testowania trafień do wykonywania obliczeń test trafień niestandardowy.</span><span class="sxs-lookup"><span data-stu-id="267a4-118">You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="267a4-119">Poniższa ilustracja przedstawia relację między regionów innych niż prostokątne obiekt i jego prostokąt otaczający.</span><span class="sxs-lookup"><span data-stu-id="267a4-119">The following illustration shows the relationship between a non-rectangular object's region and its bounding rectangle.</span></span>  
  
 <span data-ttu-id="267a4-120">![Diagram of valid hit test region](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span><span class="sxs-lookup"><span data-stu-id="267a4-120">![Diagram of valid hit test region](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span></span>  
<span data-ttu-id="267a4-121">Diagram przedstawiający region prawidłowe testu trafienia</span><span class="sxs-lookup"><span data-stu-id="267a4-121">Diagram of valid hit test region</span></span>  
  
<a name="hit_testing_and_z-order"></a>   
## <a name="hit-testing-and-z-order"></a><span data-ttu-id="267a4-122">Testowanie trafień i porządek osi z</span><span class="sxs-lookup"><span data-stu-id="267a4-122">Hit Testing and Z-Order</span></span>  
 <span data-ttu-id="267a4-123">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] Warstwy visual obsługuje testowania trafień względem wszystkich obiektów w ramach punktu lub geometrii, nie tylko najważniejsze obiekty.</span><span class="sxs-lookup"><span data-stu-id="267a4-123">The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] visual layer supports hit testing against all objects under a point or geometry, not just the top-most object.</span></span> <span data-ttu-id="267a4-124">Wyniki są zwracane w porządku osi z.</span><span class="sxs-lookup"><span data-stu-id="267a4-124">Results are returned in z-order.</span></span> <span data-ttu-id="267a4-125">Jednak obiekt wizualny, który jest przekazywany jako parametr do <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> Metoda określa, które części drzewa wizualnego, który będzie wskazywać testu.</span><span class="sxs-lookup"><span data-stu-id="267a4-125">However, the visual object that you pass as the parameter to the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method determines which portion of the visual tree that will be hit test.</span></span> <span data-ttu-id="267a4-126">Testuj pod względem całego drzewa wizualnego lub jakiejkolwiek jego części jest osiągalny.</span><span class="sxs-lookup"><span data-stu-id="267a4-126">You can hit test against the entire visual tree, or any portion of it.</span></span>  
  
 <span data-ttu-id="267a4-127">Na poniższej ilustracji obiekt circle znajduje się na szczycie kwadratu i trójkąt obiektów.</span><span class="sxs-lookup"><span data-stu-id="267a4-127">In the following illustration, the circle object is on top of both the square and triangle objects.</span></span> <span data-ttu-id="267a4-128">Jeśli interesuje Cię tylko obiekt wizualny, którego wartość porządku osi jest umieszczony najwyżej testowania trafień, możesz ustawić wyliczenie visual testu trafienia do zwrócenia <xref:System.Windows.Media.HitTestResultBehavior.Stop> z <xref:System.Windows.Media.HitTestResultCallback> przestanie przechodzenie testu trafienia po pierwszym elementem.</span><span class="sxs-lookup"><span data-stu-id="267a4-128">If you are only interested in hit testing the visual object whose z-order value is top-most, you can set the visual hit test enumeration to return <xref:System.Windows.Media.HitTestResultBehavior.Stop> from the <xref:System.Windows.Media.HitTestResultCallback> to stop the hit test traversal after the first item.</span></span>  
  
 <span data-ttu-id="267a4-129">![Diagram z&#45;kolejność drzewa wizualnego](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span><span class="sxs-lookup"><span data-stu-id="267a4-129">![Diagram of the z&#45;order of a visual tree](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span></span>  
<span data-ttu-id="267a4-130">Diagram przedstawiający porządek drzewo wizualne</span><span class="sxs-lookup"><span data-stu-id="267a4-130">Diagram of the z-order of a visual tree</span></span>  
  
 <span data-ttu-id="267a4-131">Aby wyliczyć wszystkich obiektów wizualnych pod określony punkt lub geometrii wrócić <xref:System.Windows.Media.HitTestResultBehavior.Continue> z <xref:System.Windows.Media.HitTestResultCallback>.</span><span class="sxs-lookup"><span data-stu-id="267a4-131">If you want to enumerate all visual objects under a specific point or geometry, return <xref:System.Windows.Media.HitTestResultBehavior.Continue> from the <xref:System.Windows.Media.HitTestResultCallback>.</span></span> <span data-ttu-id="267a4-132">Oznacza to, że mogą trafić testu dla obiektów wizualnych, które są pod innymi obiektami, nawet wtedy, gdy są one całkowicie zasłonięte.</span><span class="sxs-lookup"><span data-stu-id="267a4-132">This means you can hit test for visual objects that are beneath other objects, even if they are wholly obscured.</span></span> <span data-ttu-id="267a4-133">Zobacz przykładowy kod w sekcji "Przy użyciu trafień testu wyniki wywołania zwrotnego", aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="267a4-133">See the sample code in the section "Using a Hit Test Results Callback" for more information.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="267a4-134">Wizualne obiekt, który jest przezroczysty również mogą trafić testu.</span><span class="sxs-lookup"><span data-stu-id="267a4-134">A visual object that is transparent can also be hit test.</span></span>  
  
<a name="using_default_hit_testing"></a>   
## <a name="using-default-hit-testing"></a><span data-ttu-id="267a4-135">Test trafienia przy użyciu domyślnego</span><span class="sxs-lookup"><span data-stu-id="267a4-135">Using Default Hit Testing</span></span>  
 <span data-ttu-id="267a4-136">Można zidentyfikować, czy punkt znajduje się w geometrię obiektu visual przy użyciu <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metodę, aby określić obiekt wizualny i punkt koordynować wartości na potrzeby testowania wstępnego.</span><span class="sxs-lookup"><span data-stu-id="267a4-136">You can identify whether a point is within the geometry of a visual object, by using the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method to specify a visual object and a point coordinate value to test against.</span></span> <span data-ttu-id="267a4-137">Parametr obiekt wizualny identyfikuje punkt początkowy w drzewie wizualnym wyszukiwania testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-137">The visual object parameter identifies the starting point in the visual tree for the hit test search.</span></span> <span data-ttu-id="267a4-138">Jeśli obiekt wizualny znajduje się w drzewie wizualnym, w których geometrii zawiera współrzędne, jest równa <xref:System.Windows.Media.HitTestResult.VisualHit%2A> właściwość <xref:System.Windows.Media.HitTestResult> obiektu.</span><span class="sxs-lookup"><span data-stu-id="267a4-138">If a visual object is found in the visual tree whose geometry contains the coordinate, it is set to the <xref:System.Windows.Media.HitTestResult.VisualHit%2A> property of a <xref:System.Windows.Media.HitTestResult> object.</span></span> <span data-ttu-id="267a4-139"><xref:System.Windows.Media.HitTestResult> Jest następnie zwracany z <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="267a4-139">The <xref:System.Windows.Media.HitTestResult> is then returned from the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span> <span data-ttu-id="267a4-140">Jeśli punkt nie znajduje się za pomocą podrzędne drzewa wizualnego, testowania, są trafień <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> zwraca `null`.</span><span class="sxs-lookup"><span data-stu-id="267a4-140">If the point is not contained with the visual sub-tree you are hit testing, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> returns `null`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="267a4-141">Trafień domyślnego badania zawsze zwraca najważniejsze obiekty w porządku osi z.</span><span class="sxs-lookup"><span data-stu-id="267a4-141">Default hit testing always returns the top-most object in the z-order.</span></span> <span data-ttu-id="267a4-142">Aby zidentyfikować wszystkie obiekty wizualne, nawet te, które mogą być całkowicie lub częściowo zasłonięte, należy użyć wywołania zwrotnego wynik testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-142">In order to identify all visual objects, even those that may be partly or wholly obscured, use a hit test result callback.</span></span>  
  
 <span data-ttu-id="267a4-143">Wartość współrzędnych jako parametr punktu <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metoda ma względem współrzędnych obiekt wizualny trafisz testowanie.</span><span class="sxs-lookup"><span data-stu-id="267a4-143">The coordinate value you pass as the point parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method has to be relative to the coordinate space of the visual object you are hit testing against.</span></span> <span data-ttu-id="267a4-144">Na przykład, jeśli można zagnieżdżać zdefiniowanych obiektów wizualnych na (100, 100) przestrzeni współrzędnych obiektu nadrzędnego, kliknij przycisk testowania wizualizacji podrzędnych w (0, 0) jest odpowiednikiem trafień, testowanie w firmie (100, 100) w przestrzeni współrzędnych obiektu nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="267a4-144">For example, if you have nested visual objects defined at (100, 100) in the parent's coordinate space, then hit testing a child visual at (0, 0) is equivalent to hit testing at (100, 100) in the parent's coordinate space.</span></span>  
  
 <span data-ttu-id="267a4-145">Poniższy kod przedstawia sposób konfigurowania obsługi zdarzeń myszy <xref:System.Windows.UIElement> obiekt, który służy do przechwytywania zdarzeń używane do testowania trafień.</span><span class="sxs-lookup"><span data-stu-id="267a4-145">The following code shows how to set up mouse event handlers for a <xref:System.Windows.UIElement> object that is used to capture events used for hit testing.</span></span>  
  
 [!code-csharp[HitTestingOverview#100](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#100)]
 [!code-vb[HitTestingOverview#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#100)]  
  
### <a name="how-the-visual-tree-affects-hit-testing"></a><span data-ttu-id="267a4-146">Test trafienia wpływ drzewo wizualne</span><span class="sxs-lookup"><span data-stu-id="267a4-146">How the Visual Tree Affects Hit Testing</span></span>  
 <span data-ttu-id="267a4-147">Począwszy od punktu w drzewie wizualnym określa obiekty, które są zwracane podczas wyliczania testu trafienia obiektów.</span><span class="sxs-lookup"><span data-stu-id="267a4-147">The starting point in the visual tree determines which objects are returned during the hit test enumeration of objects.</span></span> <span data-ttu-id="267a4-148">W przypadku wielu obiektów, które mają być przeprowadzanie testu trafienia visual obiekt używany jako punktu wyjścia w drzewie wizualnym musi być nadrzędnej wspólnej dla wszystkich obiektów zainteresowania.</span><span class="sxs-lookup"><span data-stu-id="267a4-148">If you have multiple objects you want to hit test, the visual object used as the starting point in the visual tree must be the common ancestor of all objects of interest.</span></span> <span data-ttu-id="267a4-149">Na przykład jeśli interesują Cię trafień testowania button element i rysowania visual na poniższym diagramie, trzeba ustawić punkt początkowy w drzewie wizualnym nadrzędnej wspólnej dla obu tych elementów.</span><span class="sxs-lookup"><span data-stu-id="267a4-149">For example, if you were interested in hit testing both the button element and drawing visual in the following diagram, you would have to set the starting point in the visual tree to the common ancestor of both.</span></span> <span data-ttu-id="267a4-150">W tym przypadku element roboczy jest nadrzędnej wspólnej dla zarówno button element, jak i rysowania wizualizacji.</span><span class="sxs-lookup"><span data-stu-id="267a4-150">In this case, the canvas element is the common ancestor of both the button element and the drawing visual.</span></span>  
  
 <span data-ttu-id="267a4-151">![Diagram of a visual tree hierarchy](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span><span class="sxs-lookup"><span data-stu-id="267a4-151">![Diagram of a visual tree hierarchy](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span></span>  
<span data-ttu-id="267a4-152">Diagram hierarchii drzewa wizualnego</span><span class="sxs-lookup"><span data-stu-id="267a4-152">Diagram of a visual tree hierarchy</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="267a4-153"><xref:System.Windows.UIElement.IsHitTestVisible%2A> Właściwości pobiera lub ustawia wartość deklarującą, czy <xref:System.Windows.UIElement>-pochodnego obiektu może być zwrócony jako wynik testu trafienia z niektórych części zrenderowanej zawartości.</span><span class="sxs-lookup"><span data-stu-id="267a4-153">The <xref:System.Windows.UIElement.IsHitTestVisible%2A> property gets or sets a value that declares whether a <xref:System.Windows.UIElement>-derived object can possibly be returned as a hit test result from some portion of its rendered content.</span></span> <span data-ttu-id="267a4-154">Dzięki temu można selektywnie zmieniać drzewa wizualnego, aby określić obiekty wizualne, które są zaangażowane w hit test.</span><span class="sxs-lookup"><span data-stu-id="267a4-154">This allows you to selectively alter the visual tree to determine which visual objects are involved in a hit test.</span></span>  
  
<a name="using_a_hit_test_result_callback"></a>   
## <a name="using-a-hit-test-result-callback"></a><span data-ttu-id="267a4-155">Za pomocą wywołania zwrotnego wynik testu trafienia</span><span class="sxs-lookup"><span data-stu-id="267a4-155">Using a Hit Test Result Callback</span></span>  
 <span data-ttu-id="267a4-156">Można wyliczyć wszystkich obiektów wizualnych w drzewie wizualnym, w których geometrii zawiera określoną wartość współrzędnych.</span><span class="sxs-lookup"><span data-stu-id="267a4-156">You can enumerate all visual objects in a visual tree whose geometry contains a specified coordinate value.</span></span> <span data-ttu-id="267a4-157">Dzięki temu można zidentyfikować wszystkie obiekty wizualne, nawet tych, które mogą być całkowicie lub częściowo zasłonięte przez inne obiekty visual.</span><span class="sxs-lookup"><span data-stu-id="267a4-157">This allows you to identify all visual objects, even those that may be partly or wholly obscured by other visual objects.</span></span> <span data-ttu-id="267a4-158">Do wyliczenia obiektów wizualnych w użyciu drzewa wizualnego <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody za pomocą funkcji wywołania zwrotnego testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-158">To enumerate visual objects in a visual tree use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method with a hit test callback function.</span></span> <span data-ttu-id="267a4-159">Funkcja wywołania zwrotnego test trafień jest wywoływane przez system, gdy współrzędnych podaną wartość jest zawarta w obiekt wizualny.</span><span class="sxs-lookup"><span data-stu-id="267a4-159">The hit test callback function is called by the system when the coordinate value you specify is contained in a visual object.</span></span>  
  
 <span data-ttu-id="267a4-160">Podczas trafień badania wyliczenie wyników, nie należy wykonywać żadnych operacji, która modyfikuje drzewo wizualne.</span><span class="sxs-lookup"><span data-stu-id="267a4-160">During the hit test results enumeration, you should not perform any operation that modifies the visual tree.</span></span> <span data-ttu-id="267a4-161">Dodawanie lub usuwanie obiektu z drzewa wizualnego, podczas gdy jej linia może spowodować nieprzewidywalne zachowanie.</span><span class="sxs-lookup"><span data-stu-id="267a4-161">Adding or removing an object from the visual tree while it is being traversed can result in unpredictable behavior.</span></span> <span data-ttu-id="267a4-162">Można bezpiecznie modyfikować drzewa wizualnego po <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metoda zwraca.</span><span class="sxs-lookup"><span data-stu-id="267a4-162">You can safely modify the visual tree after the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method returns.</span></span> <span data-ttu-id="267a4-163">Możesz chcieć zapewnić struktury danych, takich jak <xref:System.Collections.ArrayList>, aby przechowywać wartości podczas wyliczania wyników testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-163">You may want to provide a data structure, such as an <xref:System.Collections.ArrayList>, to store values during the hit test results enumeration.</span></span>  
  
 [!code-csharp[HitTestingOverview#101](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[HitTestingOverview#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="267a4-164">Metody wywołania zwrotnego test trafień Określa akcje, które wykonujesz w chwili zidentyfikowania hit test dla określonego obiektu visual w drzewie wizualnym.</span><span class="sxs-lookup"><span data-stu-id="267a4-164">The hit test callback method defines the actions you perform when a hit test is identified on a particular visual object in the visual tree.</span></span> <span data-ttu-id="267a4-165">Po wykonaniu akcji, zwraca <xref:System.Windows.Media.HitTestResultBehavior> wartość, która określa, czy należy kontynuować wyliczania innych obiektów wizualnych, czy nie.</span><span class="sxs-lookup"><span data-stu-id="267a4-165">After you perform the actions, you return a <xref:System.Windows.Media.HitTestResultBehavior> value that determines whether to continue the enumeration of any other visual objects or not.</span></span>  
  
 [!code-csharp[HitTestingOverview#102](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[HitTestingOverview#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#102)]  
  
> [!NOTE]
>  <span data-ttu-id="267a4-166">Kolejność wyliczania obiektów wizualnych trafień jest według porządku osi z.</span><span class="sxs-lookup"><span data-stu-id="267a4-166">The order of enumeration of hit visual objects is by z-order.</span></span> <span data-ttu-id="267a4-167">Obiekt wizualny na poziomie najbardziej na wierzchu porządek jest pierwszy obiekt wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="267a4-167">The visual object at the top-most z-order level is the first object enumerated.</span></span> <span data-ttu-id="267a4-168">Innych obiektów wizualnych wyliczany znajdują się w zmniejsza poziomu porządku osi z.</span><span class="sxs-lookup"><span data-stu-id="267a4-168">Any other visual objects enumerated are at decreasing z-order level.</span></span> <span data-ttu-id="267a4-169">Kolejność wyliczania odnosi się do renderowania kolejność elementów wizualnych.</span><span class="sxs-lookup"><span data-stu-id="267a4-169">This order of enumeration corresponds to the rendering order of the visuals.</span></span>  
  
 <span data-ttu-id="267a4-170">Wyliczanie obiektów wizualnych w funkcji wywołania zwrotnego testu trafienia w dowolnym momencie można zatrzymać, zwracając <xref:System.Windows.Media.HitTestResultBehavior.Stop>.</span><span class="sxs-lookup"><span data-stu-id="267a4-170">You can stop the enumeration of visual objects at any time in the hit test callback function by returning <xref:System.Windows.Media.HitTestResultBehavior.Stop>.</span></span>  
  
 [!code-csharp[HitTestingOverview#103](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#103)]
 [!code-vb[HitTestingOverview#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#103)]  
  
<a name="using_a_hit_test_filter_callback"></a>   
## <a name="using-a-hit-test-filter-callback"></a><span data-ttu-id="267a4-171">Za pomocą zwrotnym filtra Hit Test</span><span class="sxs-lookup"><span data-stu-id="267a4-171">Using a Hit Test Filter Callback</span></span>  
 <span data-ttu-id="267a4-172">Filtr opcjonalne testu trafienia można użyć do ograniczenia obiektów, które są przekazywane do wyników testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-172">You can use an optional hit test filter to restrict the objects that are passed on to the hit test results.</span></span> <span data-ttu-id="267a4-173">Dzięki temu można zignorować części drzewa wizualnego, że nie jesteś zainteresowany przetwarzania w wynikach testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-173">This allows you to ignore parts of the visual tree that you are not interested in processing in your hit test results.</span></span> <span data-ttu-id="267a4-174">Aby zaimplementować filtr test trafień, definiowanie funkcji wywołania zwrotnego filtru test trafień i przekazać go jako wartość parametru, gdy wywołujesz <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="267a4-174">To implement a hit test filter, you define a hit test filter callback function and pass it as a parameter value when you call the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#104](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#104)]
 [!code-vb[HitTestingOverview#104](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#104)]  
  
 <span data-ttu-id="267a4-175">Jeśli nie chcesz podać funkcji wywołania zwrotnego filtru opcjonalne test trafień, przekazać `null` wartość jako parametr dla <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="267a4-175">If you do not want to supply the optional hit test filter callback function, pass a `null` value as its parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#105](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#105)]
 [!code-vb[HitTestingOverview#105](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#105)]  
  
 <span data-ttu-id="267a4-176">![Oczyszczanie drzewa wizualnego, za pomocą filtru testów trafienia](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span><span class="sxs-lookup"><span data-stu-id="267a4-176">![Pruning a visual tree using a hit test filter](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span></span>  
<span data-ttu-id="267a4-177">Oczyszczanie drzewa wizualnego</span><span class="sxs-lookup"><span data-stu-id="267a4-177">Pruning a visual tree</span></span>  
  
 <span data-ttu-id="267a4-178">Funkcja wywołania zwrotnego testu trafienia filtru można wyliczyć wszystkie wizualizacje renderowanych zawierającym współrzędne, które określisz.</span><span class="sxs-lookup"><span data-stu-id="267a4-178">The hit test filter callback function allows you to enumerate through all the visuals whose rendered content contains the coordinates you specify.</span></span> <span data-ttu-id="267a4-179">Jednakże można zignorować niektórych gałęzi drzewa wizualnego, że nie jesteś zainteresowany przetwarzania w funkcji wywołania zwrotnego wyników testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-179">However, you may want to ignore certain branches of the visual tree that you are not interested in processing in your hit test results callback function.</span></span> <span data-ttu-id="267a4-180">Wartość zwracana funkcji wywołania zwrotnego filtr test trafień Określa, jakiego rodzaju akcji wyliczenie obiektów wizualnych powinno zająć.</span><span class="sxs-lookup"><span data-stu-id="267a4-180">The return value of the hit test filter callback function determines what type of action the enumeration of the visual objects should take.</span></span> <span data-ttu-id="267a4-181">Na przykład, jeśli zwróci wartość <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>, możesz usunąć bieżący obiekt wizualny i jego elementy podrzędne z wyliczenia wyników testu trafienia.</span><span class="sxs-lookup"><span data-stu-id="267a4-181">For example, if you return the value, <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>, you can remove the current visual object and its children from the hit test results enumeration.</span></span> <span data-ttu-id="267a4-182">Oznacza to, czy funkcja wywołania zwrotnego wyników testu trafienia nie będą widzieć tych obiektów w wyliczeniu, jego.</span><span class="sxs-lookup"><span data-stu-id="267a4-182">This means that the hit test results callback function will not see these objects in its enumeration.</span></span> <span data-ttu-id="267a4-183">Widok drzewa obiektów czyszczenia zmniejsza ilość przetwarzania podczas wyliczania wyników testu trafienia — dostęp próbny.</span><span class="sxs-lookup"><span data-stu-id="267a4-183">Pruning the visual tree of objects decreases the amount of processing during the hit test results enumeration pass.</span></span> <span data-ttu-id="267a4-184">W poniższym przykładzie kodu filtr pomija etykiety i jego elementy podrzędne i naciśnij klawisz analiz, wszystkie inne elementy.</span><span class="sxs-lookup"><span data-stu-id="267a4-184">In the following code example, the filter skips labels and their descendants and hit tests everything else.</span></span>  
  
 [!code-csharp[HitTestingOverview#106](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#106)]
 [!code-vb[HitTestingOverview#106](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#106)]  
  
> [!NOTE]
>  <span data-ttu-id="267a4-185">Wywołanie zwrotne filtr testu trafienia czasami zostanie wywołana w przypadkach, gdy wywołanie zwrotne wyników testu trafienia nie zostanie wywołana.</span><span class="sxs-lookup"><span data-stu-id="267a4-185">The hit test filter callback will sometimes be called in cases where the hit test results callback is not called.</span></span>  
  
<a name="overriding_default_hit_testing"></a>   
## <a name="overriding-default-hit-testing"></a><span data-ttu-id="267a4-186">Zastępowanie domyślnego testowania trafień</span><span class="sxs-lookup"><span data-stu-id="267a4-186">Overriding Default Hit Testing</span></span>  
 <span data-ttu-id="267a4-187">Można zastąpić trafień domyślny obiekt wizualny obsługę testów poprzez zastąpienie <xref:System.Windows.Media.Visual.HitTestCore%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="267a4-187">You can override a visual object’s default hit testing support by overriding the <xref:System.Windows.Media.Visual.HitTestCore%2A> method.</span></span> <span data-ttu-id="267a4-188">Oznacza to, że po wywołaniu <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> metody, implementacja zgodnym z przesłoniętą <xref:System.Windows.Media.Visual.HitTestCore%2A> jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="267a4-188">This means that when you invoke the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method, your overridden implementation of <xref:System.Windows.Media.Visual.HitTestCore%2A> is called.</span></span> <span data-ttu-id="267a4-189">Zastąpione metoda jest wywoływana, gdy hit test mieści się w prostokąt otaczający obiekt wizualny nawet wtedy, gdy współrzędnych znajduje się poza renderowanej zawartości obiekt wizualny.</span><span class="sxs-lookup"><span data-stu-id="267a4-189">Your overridden method is called when a hit test falls within the bounding rectangle of the visual object, even if the coordinate falls outside the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#107](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#107)]
 [!code-vb[HitTestingOverview#107](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#107)]  
  
 <span data-ttu-id="267a4-190">Mogą wystąpić sytuacje, gdy zachodzi potrzeba trafień Testuj pod względem prostokąt otaczający i renderowanej zawartości obiekt wizualny.</span><span class="sxs-lookup"><span data-stu-id="267a4-190">There may be times when you want to hit test against both the bounding rectangle and the rendered content of a visual object.</span></span> <span data-ttu-id="267a4-191">Za pomocą `PointHitTestParameters` wartość parametru w swojej zastąpione <xref:System.Windows.Media.Visual.HitTestCore%2A> metoda jako parametr do metody podstawowej <xref:System.Windows.Media.Visual.HitTestCore%2A>, można wykonywać działania dotyczące trafienie prostokąt otaczający obiekt wizualny, a następnie wykonaj drugi test trafień dla renderowania zawartości obiekt wizualny.</span><span class="sxs-lookup"><span data-stu-id="267a4-191">By using the `PointHitTestParameters` parameter value in your overridden <xref:System.Windows.Media.Visual.HitTestCore%2A> method as the parameter to the base method <xref:System.Windows.Media.Visual.HitTestCore%2A>, you can perform actions based on a hit of the bounding rectangle of a visual object, and then perform a second hit test against the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#108](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#108)]
 [!code-vb[HitTestingOverview#108](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#108)]  
  
## <a name="see-also"></a><span data-ttu-id="267a4-192">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="267a4-192">See also</span></span>

- <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>
- <xref:System.Windows.Media.HitTestResult>
- <xref:System.Windows.Media.HitTestResultCallback>
- <xref:System.Windows.Media.HitTestFilterCallback>
- <xref:System.Windows.UIElement.IsHitTestVisible%2A>
- [<span data-ttu-id="267a4-193">Test trafienia przy użyciu przykładowych DrawingVisuals</span><span class="sxs-lookup"><span data-stu-id="267a4-193">Hit Test Using DrawingVisuals Sample</span></span>](https://go.microsoft.com/fwlink/?LinkID=159994)
- [<span data-ttu-id="267a4-194">Hit Test przykład współdziałanie Win32</span><span class="sxs-lookup"><span data-stu-id="267a4-194">Hit Test with Win32 Interoperation Sample</span></span>](https://go.microsoft.com/fwlink/?LinkID=159995)
- [<span data-ttu-id="267a4-195">Przeprowadzanie testu trafienia geometrii w wizualizacji</span><span class="sxs-lookup"><span data-stu-id="267a4-195">Hit Test Geometry in a Visual</span></span>](how-to-hit-test-geometry-in-a-visual.md)
- [<span data-ttu-id="267a4-196">Przeprowadzanie testu trafienia za pomocą kontenera hosta Win32</span><span class="sxs-lookup"><span data-stu-id="267a4-196">Hit Test Using a Win32 Host Container</span></span>](how-to-hit-test-using-a-win32-host-container.md)
