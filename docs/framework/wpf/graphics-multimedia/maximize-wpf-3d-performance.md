---
title: Maksymalizuj wydajność 3D WPF
ms.date: 03/30/2017
helpviewer_keywords:
- 3-D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: e1a90406423e36dd10b8b108e076fe73f99947f0
ms.sourcegitcommit: 77e33b682db39955e331b8e8eda4ef1925a24e78
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/29/2019
ms.locfileid: "70133846"
---
# <a name="maximize-wpf-3d-performance"></a>Maksymalizuj wydajność 3D WPF
Gdy używasz [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] do kompilowania kontrolek 3D i dołączania scen 3D do aplikacji, ważne jest, aby rozważyć optymalizację wydajności. Ten temat zawiera listę klas i właściwości 3D, które mają wpływ na wydajność aplikacji, a także zalecenia dotyczące optymalizacji wydajności podczas ich używania.  
  
 W tym temacie założono zaawansowaną wiedzę o [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] funkcjach 3W. Sugestie przedstawione w tym dokumencie dotyczą "renderowania warstwy 2" — w sposób niezdefiniowany jako sprzęt obsługujący program do cieniowania pikseli w wersji 2,0 i programu do cieniowania wierzchołków w wersji 2,0. Aby uzyskać więcej informacji, zobacz [warstwy renderowania grafiki](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Wpływ na wydajność: Wysoka  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Szybkość pędzla (najszybszych do najwolniejszych):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>pozostaje<br /><br /> <xref:System.Windows.Media.VisualBrush>pozostaje<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>niebuforowanych<br /><br /> <xref:System.Windows.Media.VisualBrush>niebuforowanych|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Ustaw `Viewport3D.ClipToBounds` wartość false, jeśli nie musisz [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] jawnie wyciąć zawartości elementu <xref:System.Windows.Controls.Viewport3D> do Viewport3D's prostokąta. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]Przycinanie antyaliasowe może być bardzo wolne i `ClipToBounds` jest domyślnie włączone (wolno) w systemie. <xref:System.Windows.Controls.Viewport3D>|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Ustaw `Viewport3D.IsHitTestVisible` wartość false, jeśli nie trzeba [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <xref:System.Windows.Controls.Viewport3D> brać pod uwagę zawartości podczas przeprowadzania testowania trafień myszą.  Testowanie trafień zawartości 3D odbywa się w oprogramowaniu i może być powolne z dużymi oczkami. <xref:System.Windows.UIElement.IsHitTestVisible%2A>jest włączona (wolno) domyślnie w systemie <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Twórz różne modele tylko wtedy, gdy wymagają różnych materiałów lub transformacji.  W przeciwnym razie spróbuj połączyć wiele <xref:System.Windows.Media.Media3D.GeometryModel3D> wystąpień z tymi samymi materiałami i przetworzyć je w <xref:System.Windows.Media.Media3D.GeometryModel3D> kilku <xref:System.Windows.Media.Media3D.MeshGeometry3D> większych wystąpieniach.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Animacja siatki — zmiana poszczególnych wierzchołków siatki w poszczególnych klatkach — nie zawsze jest wydajna w [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].  Aby zminimalizować wpływ na wydajność powiadomień o zmianach po zmodyfikowaniu każdego z wierzchołków, odłącz siatkę od drzewa wizualnego przed wykonaniem modyfikacji na wierzchołku.  Po zmodyfikowaniu siatki należy ponownie dołączyć ją do drzewa wizualnego.  Ponadto spróbuj zminimalizować rozmiar siatek, które będą animowane w ten sposób.|  
|Wygładzanie 3W|Aby zwiększyć szybkość renderowania, należy wyłączyć próbkowanie na <xref:System.Windows.Controls.Viewport3D> podstawie przez ustawienie dołączonej <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> właściwości `Aliased`do.  Domyślnie wygładzanie 3W jest włączone w systemie Windows z 4 próbkami na piksel.|  
|Tekst|Tekst na żywo w scenie 3D (na żywo, ponieważ znajduje się <xref:System.Windows.Media.DrawingBrush> on <xref:System.Windows.Media.VisualBrush>w lub) może być wolny. Spróbuj użyć obrazów zamiast tekstu (za pośrednictwem <xref:System.Windows.Media.Imaging.RenderTargetBitmap>), chyba że zmieni się tekst.|  
|<xref:System.Windows.Media.TileBrush>|Jeśli <xref:System.Windows.Media.VisualBrush> musisz użyć <xref:System.Windows.Media.DrawingBrush> lub w scenie 3D, ponieważ zawartość pędzla nie jest statyczna, spróbuj buforować pędzlem (ustawienie dołączonej właściwości <xref:System.Windows.Media.RenderOptions.CachingHint%2A> do `Cache`).  Ustaw minimalne i maksymalne wartości progowe unieważnienia skali (z dołączonymi właściwościami <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> i <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>), tak aby nie generować zbyt częste pędzle w pamięci podręcznej, utrzymując jednocześnie żądany poziom jakości.  Domyślnie <xref:System.Windows.Media.DrawingBrush> i<xref:System.Windows.Media.VisualBrush> nie są przechowywane w pamięci podręcznej, co oznacza, że każde pomalowane przy użyciu pędzla musi być odtwarzane, cała zawartość pędzla musi być najpierw renderowana na pośredniej powierzchni.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect>wymusza, aby cała zawartość miała być renderowana bez przyspieszenia sprzętowego.  W celu uzyskania najlepszej wydajności nie należy <xref:System.Windows.Media.Effects.BitmapEffect>używać programu.|  
  
## <a name="performance-impact-medium"></a>Wpływ na wydajność: Średni  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Gdy siatka jest definiowana jako sąsiednie Trójkąty z współdzielonymi wierzchołkami, a wierzchołki mają takie same współrzędne położenia, normalnej i tekstury, zdefiniuj każdy współużytkowany wierzchołek tylko raz, a następnie zdefiniuj Trójkąty według indeksu <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>przy użyciu.|  
|<xref:System.Windows.Media.ImageBrush>|Spróbuj zminimalizować rozmiary tekstury, gdy masz jawną kontrolę nad rozmiarem (gdy <xref:System.Windows.Media.Imaging.RenderTargetBitmap> używasz i/ <xref:System.Windows.Media.ImageBrush>lub a).  Należy pamiętać, że tekstury o niższej rozdzielczości mogą zmniejszyć jakość wizualną, a więc spróbować znaleźć odpowiednią równowagę między jakością i wydajnością.|  
|Nieprzezroczystość|Podczas renderowania przezroczystej zawartości 3W (na przykład odbicia) należy użyć właściwości nieprzezroczystości dla pędzli lub <xref:System.Windows.Media.Brush.Opacity%2A> materiałów <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>(za pośrednictwem lub) zamiast <xref:System.Windows.Controls.Viewport3D> tworzyć osobne ustawienia półprzezroczyste przez ustawienie `Viewport3D.Opacity` wartości mniejszej niż 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Zminimalizuj liczbę <xref:System.Windows.Controls.Viewport3D> obiektów, które są używane w scenie.  Należy umieścić wiele modeli 3D w tym samym Viewport3D zamiast tworzyć oddzielne wystąpienia Viewport3D dla każdego modelu.|  
|<xref:System.Windows.Freezable>|Zazwyczaj korzystne jest ponowne użycie <xref:System.Windows.Media.Media3D.MeshGeometry3D>, <xref:System.Windows.Media.Media3D.GeometryModel3D>, pędzle i materiały.  Wszystkie są elementami nadrzędnymi, ponieważ pochodzą z programu `Freezable`.|  
|<xref:System.Windows.Freezable>|Wywołaj <xref:System.Windows.Freezable.Freeze%2A> metodę w obiektów Freezable platformie, gdy ich właściwości pozostaną bez zmian w aplikacji.  Zamrażanie może zmniejszyć zestaw roboczy i zwiększyć szybkość.|  
|<xref:System.Windows.Media.Brush>|Użyj <xref:System.Windows.Media.ImageBrush> zamiastlub<xref:System.Windows.Media.DrawingBrush>kiedy zawartość pędzla nie ulegnie zmianie. <xref:System.Windows.Media.VisualBrush>  zawartość 2D może zostać przekonwertowana na <xref:System.Windows.Controls.Image> za <xref:System.Windows.Media.Imaging.RenderTargetBitmap> pomocą <xref:System.Windows.Media.ImageBrush>, a następnie użyta w.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Nie używaj <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> , chyba że rzeczywiście zachodzi potrzeba wyświetlenia twarzy <xref:System.Windows.Media.Media3D.GeometryModel3D>z tyłu.|  
|<xref:System.Windows.Media.Media3D.Light>|Prędkość świetlna (najwolniejsze do niska):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Staraj się zachować rozmiary sieci w ramach tych limitów:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: wystąpienia <xref:System.Windows.Media.Media3D.Point3D> 20 001<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: wystąpienia <xref:System.Int32> 60 003|  
|<xref:System.Windows.Media.Media3D.Material>|Szybkość materiału (najszybszych do najwolniejszych):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]3W nie wybiera niewidocznych pędzli (czarne pędzle, jasne pędzle itp.) w spójny sposób.  Rozważ pominięcie ich z sceny.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|<xref:System.Windows.Media.Media3D.Material> Każda<xref:System.Windows.Media.Media3D.MaterialGroup> z nich powoduje, że inne przeprowadzenie renderowania, więc w tym wiele materiałów, nawet prostych materiałów, może znacząco zwiększyć liczbę żądań wypełnienia procesora GPU.  Zminimalizuj liczbę materiałów w Twojej firmie <xref:System.Windows.Media.Media3D.MaterialGroup>.|  
  
## <a name="performance-impact-low"></a>Wpływ na wydajność: Małe  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Gdy nie potrzebujesz animacji ani powiązania danych, zamiast korzystać z grupy transformacji zawierającej wiele przekształceń, użyj jednego <xref:System.Windows.Media.Media3D.MatrixTransform3D>z nich, ustawiając go jako iloczyn wszystkich przekształceń, które w przeciwnym razie w grupie Przekształć.|  
|<xref:System.Windows.Media.Media3D.Light>|Zminimalizuj liczbę sygnalizatorów w scenie. Zbyt wiele lamp w scenie spowoduje [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] powrót do renderowania oprogramowania.  Limity dotyczą około 110 <xref:System.Windows.Media.Media3D.DirectionalLight> obiektów, 70 <xref:System.Windows.Media.Media3D.PointLight> obiektów lub 40 <xref:System.Windows.Media.Media3D.SpotLight> obiektów.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Oddziel obiekty od obiektów statycznych, umieszczając je w <xref:System.Windows.Media.Media3D.ModelVisual3D> osobnych wystąpieniach.  ModelVisual3D jest "grubsza" <xref:System.Windows.Media.Media3D.GeometryModel3D> , ponieważ buforuje przekształcenia.  Elementu GeometryModel3D jest zoptymalizowany pod kątem modelu; ModelVisual3D jest zoptymalizowany jako węzeł sceny.  Użyj ModelVisual3D, aby umieścić udostępnione wystąpienia elementu elementu GeometryModel3D w scenie.|  
|<xref:System.Windows.Media.Media3D.Light>|Zminimalizuj, ile razy zmienić liczbę sygnalizatorów w scenie.  Każda zmiana liczby świateł wymusza regenerację i ponowną kompilację programu do cieniowania, chyba że taka konfiguracja już istniała (i w związku z tym ma zbuforowane cieniowanie).|  
|Świateł|Czarne światła nie będą widoczne, ale zostaną dodane do czasu renderowania; Rozważ pominięcie ich.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Aby zminimalizować czas konstruowania dużych kolekcji w [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], takich jak MeshGeometry3D's <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>, i <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>, wstępnie rozmiar kolekcji przed populacją wartości. Jeśli to możliwe, należy przejść do wstępnie wypełnionych struktur danych konstruktorów kolekcji, takich jak tablice lub listy.|  
  
## <a name="see-also"></a>Zobacz także

- [Grafika 3D — przegląd](3-d-graphics-overview.md)
