---
title: Maksymalizuj wydajność 3W
ms.date: 03/30/2017
helpviewer_keywords:
- 3-D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 414a4677a1e05cd69c382e35194328d6ce1bddf9
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/24/2020
ms.locfileid: "76744595"
---
# <a name="maximize-wpf-3d-performance"></a>Maksymalizuj wydajność 3D WPF
Korzystając z [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] do kompilowania kontrolek 3D i dołączania scen 3D do aplikacji, ważne jest, aby rozważyć optymalizację wydajności. Ten temat zawiera listę klas i właściwości 3D, które mają wpływ na wydajność aplikacji, a także zalecenia dotyczące optymalizacji wydajności podczas ich używania.  
  
 W tym temacie założono zaawansowaną wiedzę o [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] funkcjach 3W. Sugestie przedstawione w tym dokumencie dotyczą "renderowania warstwy 2" — w sposób niezdefiniowany jako sprzęt obsługujący program do cieniowania pikseli w wersji 2,0 i programu do cieniowania wierzchołków w wersji 2,0. Aby uzyskać więcej informacji, zobacz [warstwy renderowania grafiki](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Wpływ na wydajność: wysoki  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Szybkość pędzla (najszybszych do najwolniejszych):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (w pamięci podręcznej)<br /><br /> <xref:System.Windows.Media.VisualBrush> (w pamięci podręcznej)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (pamięć podręczna)<br /><br /> <xref:System.Windows.Media.VisualBrush> (pamięć podręczna)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Ustaw `Viewport3D.ClipToBounds` na false, gdy nie musisz mieć [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] jawnie przycinania zawartości <xref:System.Windows.Controls.Viewport3D> do Viewport3D'sego prostokąta. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] przycinania antyaliasów może być bardzo wolno i `ClipToBounds` jest domyślnie włączona (powolne) w <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Ustaw `Viewport3D.IsHitTestVisible` na false, gdy nie potrzebujesz [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] do rozważenia zawartości <xref:System.Windows.Controls.Viewport3D> podczas testowania trafień myszy.  Testowanie trafień zawartości 3D odbywa się w oprogramowaniu i może być powolne z dużymi oczkami. <xref:System.Windows.UIElement.IsHitTestVisible%2A> jest domyślnie włączona (powolne) w <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Twórz różne modele tylko wtedy, gdy wymagają różnych materiałów lub transformacji.  W przeciwnym razie spróbuj połączyć wiele wystąpień <xref:System.Windows.Media.Media3D.GeometryModel3D> z tymi samymi materiałami i przetworzyć kilka większych <xref:System.Windows.Media.Media3D.GeometryModel3D> i <xref:System.Windows.Media.Media3D.MeshGeometry3D> wystąpień.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Animacja siatki — zmiana poszczególnych wierzchołków siatki w poszczególnych klatkach — nie zawsze jest wydajna w [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].  Aby zminimalizować wpływ na wydajność powiadomień o zmianach po zmodyfikowaniu każdego z wierzchołków, odłącz siatkę od drzewa wizualnego przed wykonaniem modyfikacji na wierzchołku.  Po zmodyfikowaniu siatki należy ponownie dołączyć ją do drzewa wizualnego.  Ponadto spróbuj zminimalizować rozmiar siatek, które będą animowane w ten sposób.|  
|Wygładzanie 3W|Aby zwiększyć szybkość renderowania, należy wyłączyć próbkowanie na <xref:System.Windows.Controls.Viewport3D> przez ustawienie <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> dołączonej właściwości do `Aliased`.  Domyślnie wygładzanie 3W jest włączone w systemie Windows z 4 próbkami na piksel.|  
|Tekst|Tekst na żywo w scenie 3D (na żywo, ponieważ znajduje się on w <xref:System.Windows.Media.DrawingBrush> lub <xref:System.Windows.Media.VisualBrush>) może być wolny. Spróbuj użyć obrazów zamiast tekstu (za pośrednictwem <xref:System.Windows.Media.Imaging.RenderTargetBitmap>), chyba że zmieni się tekst.|  
|<xref:System.Windows.Media.TileBrush>|Jeśli musisz użyć <xref:System.Windows.Media.VisualBrush> lub <xref:System.Windows.Media.DrawingBrush> w scenie 3D, ponieważ zawartość pędzla nie jest statyczna, spróbuj buforować pędzlem (ustawiając przyłączoną Właściwość <xref:System.Windows.Media.RenderOptions.CachingHint%2A> na `Cache`).  Ustaw minimalne i maksymalne wartości progowe nieważności skalowania (z dołączonymi właściwościami <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> i <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>), dzięki czemu nie będą one ponownie generowane w pamięci podręcznej, a nadal utrzymują żądany poziom jakości.  Domyślnie <xref:System.Windows.Media.DrawingBrush> i <xref:System.Windows.Media.VisualBrush> nie są przechowywane w pamięci podręcznej, co oznacza, że za każdym razem, gdy coś malowanego pędzla musi być odtwarzane, cała zawartość pędzla musi być najpierw renderowana na pośredniej powierzchni.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect> wymusza renderowanie całej powiązanej zawartości bez przyspieszenia sprzętowego.  W celu uzyskania najlepszej wydajności nie należy używać <xref:System.Windows.Media.Effects.BitmapEffect>.|  
  
## <a name="performance-impact-medium"></a>Wpływ na wydajność: Średni  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Gdy siatka jest definiowana jako sąsiednie Trójkąty z współdzielonymi wierzchołkami i te wierzchołki mają takie same współrzędne położenia, normalnej i tekstury, zdefiniuj każdy współużytkowany wierzchołek tylko raz, a następnie zdefiniuj Trójkąty według indeksu <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>.|  
|<xref:System.Windows.Media.ImageBrush>|Spróbuj zminimalizować rozmiary tekstury, gdy masz jawną kontrolę nad rozmiarem (gdy używasz <xref:System.Windows.Media.Imaging.RenderTargetBitmap> i/lub <xref:System.Windows.Media.ImageBrush>).  Należy pamiętać, że tekstury o niższej rozdzielczości mogą zmniejszyć jakość wizualną, a więc spróbować znaleźć odpowiednią równowagę między jakością i wydajnością.|  
|Nieprzezroczystość|Podczas renderowania przezroczystej zawartości 3W (na przykład odbicia) należy użyć właściwości nieprzezroczystości dla pędzli lub materiałów (za pośrednictwem <xref:System.Windows.Media.Brush.Opacity%2A> lub <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>), zamiast tworzyć oddzielne <xref:System.Windows.Controls.Viewport3D> przezroczyste przez ustawienie `Viewport3D.Opacity` na wartość mniejszą niż 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Zminimalizuj liczbę <xref:System.Windows.Controls.Viewport3D> obiektów, które są używane w scenie.  Należy umieścić wiele modeli 3D w tym samym Viewport3D zamiast tworzyć oddzielne wystąpienia Viewport3D dla każdego modelu.|  
|<xref:System.Windows.Freezable>|Zazwyczaj korzystne jest ponowne użycie <xref:System.Windows.Media.Media3D.MeshGeometry3D>, <xref:System.Windows.Media.Media3D.GeometryModel3D>, pędzli i materiałów.  Wszystkie są elementami nadrzędnymi, ponieważ pochodzą one z `Freezable`.|  
|<xref:System.Windows.Freezable>|Wywołaj metodę <xref:System.Windows.Freezable.Freeze%2A> w obiektów Freezable platformie, gdy ich właściwości pozostaną bez zmian w aplikacji.  Zamrażanie może zmniejszyć zestaw roboczy i zwiększyć szybkość.|  
|<xref:System.Windows.Media.Brush>|Użyj <xref:System.Windows.Media.ImageBrush> zamiast <xref:System.Windows.Media.VisualBrush> lub <xref:System.Windows.Media.DrawingBrush>, gdy zawartość pędzla nie ulegnie zmianie.  zawartość 2D można przekonwertować na <xref:System.Windows.Controls.Image> za pośrednictwem <xref:System.Windows.Media.Imaging.RenderTargetBitmap>, a następnie użyć jej w <xref:System.Windows.Media.ImageBrush>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Nie używaj <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>, chyba że rzeczywiście zachodzi potrzeba wyświetlenia tylnych twarzy <xref:System.Windows.Media.Media3D.GeometryModel3D>.|  
|<xref:System.Windows.Media.Media3D.Light>|Prędkość świetlna (najwolniejsze do niska):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Staraj się zachować rozmiary sieci w ramach tych limitów:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: wystąpienia <xref:System.Windows.Media.Media3D.Point3D> 20 001<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: wystąpienia <xref:System.Int32> 60 003|  
|<xref:System.Windows.Media.Media3D.Material>|Szybkość materiału (najszybszych do najwolniejszych):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 3W nie zrezygnuje z niewidocznych pędzli (czarne pędzle, jasne pędzle itp.) w spójny sposób.  Rozważ pominięcie ich z sceny.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Każda <xref:System.Windows.Media.Media3D.Material> w <xref:System.Windows.Media.Media3D.MaterialGroup> powoduje, że inne przeprowadzenie renderowania, w tym wiele materiałów, nawet prostych materiałów, może znacząco zwiększyć liczbę żądań wypełnienia procesora GPU.  Zminimalizuj liczbę materiałów w <xref:System.Windows.Media.Media3D.MaterialGroup>.|  
  
## <a name="performance-impact-low"></a>Wpływ na wydajność: niski  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Gdy nie potrzebujesz animacji ani powiązania danych, zamiast korzystać z grupy transformacji zawierającej wiele przekształceń, użyj jednego <xref:System.Windows.Media.Media3D.MatrixTransform3D>, ustawiając go jako produkt wszystkich przekształceń, które w przeciwnym razie będą istniały niezależnie od grupy transformacji.|  
|<xref:System.Windows.Media.Media3D.Light>|Zminimalizuj liczbę sygnalizatorów w scenie. Zbyt wiele sygnalizatorów w scenie spowoduje wymuszenie [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] przywrócenia oprogramowania.  Limity są w przybliżeniu 110 <xref:System.Windows.Media.Media3D.DirectionalLight> obiektów, 70 obiektów <xref:System.Windows.Media.Media3D.PointLight> i 40 obiektów <xref:System.Windows.Media.Media3D.SpotLight>.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Oddziel obiekty od obiektów statycznych, umieszczając je w oddzielnych <xref:System.Windows.Media.Media3D.ModelVisual3D> wystąpieniach.  ModelVisual3D jest "grubsza" niż <xref:System.Windows.Media.Media3D.GeometryModel3D>, ponieważ buforuje przekształceń.  Elementu GeometryModel3D jest zoptymalizowany pod kątem modelu; ModelVisual3D jest zoptymalizowany jako węzeł sceny.  Użyj ModelVisual3D, aby umieścić udostępnione wystąpienia elementu elementu GeometryModel3D w scenie.|  
|<xref:System.Windows.Media.Media3D.Light>|Zminimalizuj, ile razy zmienić liczbę sygnalizatorów w scenie.  Każda zmiana liczby świateł wymusza regenerację i ponowną kompilację programu do cieniowania, chyba że taka konfiguracja już istniała (i w związku z tym ma zbuforowane cieniowanie).|  
|Świateł|Czarne światła nie będą widoczne, ale zostaną dodane do czasu renderowania; Rozważ pominięcie ich.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Aby zminimalizować czas konstruowania dużych kolekcji w [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], takich jak MeshGeometry3D's <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>i <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>, należy wstępnie rozmiar kolekcji przed populacją wartości. Jeśli to możliwe, należy przejść do wstępnie wypełnionych struktur danych konstruktorów kolekcji, takich jak tablice lub listy.|  
  
## <a name="see-also"></a>Zobacz także

- [Grafika 3D — przegląd](3-d-graphics-overview.md)
