---
title: Maksymalizacja wydajności 3D
ms.date: 03/30/2017
helpviewer_keywords:
- 3D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 3825ea8e57c6863e2ee654072efda623db21c2a8
ms.sourcegitcommit: 267d092663aba36b6b2ea853034470aea493bfae
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/21/2020
ms.locfileid: "80112001"
---
# <a name="maximize-wpf-3d-performance"></a>Maksymalizuj wydajność 3D WPF
W miarę [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] tworzenia formantów 3D i dołączania scen 3D do aplikacji należy wziąć pod uwagę optymalizację wydajności. Ten temat zawiera listę klas 3D i właściwości, które mają wpływ na wydajność aplikacji, wraz z zaleceniami dotyczącymi optymalizacji wydajności podczas ich używania.  
  
 W tym temacie przyjęto [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] zaawansowane zrozumienie funkcji 3D. Sugestie zawarte w tym dokumencie dotyczą "renderowania warstwy 2" — z grubsza zdefiniowanego jako sprzęt obsługujący moduł cieniujący pikseli w wersji 2.0 i moduł cieniujący wierzchołek w wersji 2.0. Aby uzyskać więcej informacji, zobacz [Warstwy renderowania grafiki](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Wpływ na wydajność: Wysoki  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Prędkość pędzla (od najszybszych do najwolniejszych):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(w pamięci podręcznej)<br /><br /> <xref:System.Windows.Media.VisualBrush>(w pamięci podręcznej)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(bez zakaszu)<br /><br /> <xref:System.Windows.Media.VisualBrush>(bez zakaszu)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Ustaw `Viewport3D.ClipToBounds` na false, gdy nie [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] trzeba mieć jawnie <xref:System.Windows.Controls.Viewport3D> klip zawartości do prostokąta Viewport3D.Set to false whenever you do not need to have explicitly clip the content of a to the Viewport3D's rectangle. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]antialiased przycinanie może być `ClipToBounds` bardzo powolny, i jest <xref:System.Windows.Controls.Viewport3D>włączona (powolny) domyślnie na .|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Ustaw `Viewport3D.IsHitTestVisible` na false, gdy [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] nie trzeba brać <xref:System.Windows.Controls.Viewport3D> pod uwagę zawartość podczas wykonywania testowania trafień myszy.  Testowanie trafień zawartości 3D odbywa się w oprogramowaniu i może być powolne przy dużych siatkach. <xref:System.Windows.UIElement.IsHitTestVisible%2A>domyślnie włączona (wolno) <xref:System.Windows.Controls.Viewport3D>włączona .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Tworzenie różnych modeli tylko wtedy, gdy wymagają różnych materiałów lub przekształceń.  W przeciwnym razie spróbuj <xref:System.Windows.Media.Media3D.GeometryModel3D> zjednoczyć wiele wystąpień z tych samych materiałów i przekształca się w kilka większych <xref:System.Windows.Media.Media3D.GeometryModel3D> i <xref:System.Windows.Media.Media3D.MeshGeometry3D> wystąpień.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Animacja siatki — zmiana poszczególnych wierzchołków siatki na klatkę — nie zawsze jest skuteczna w programie [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].  Aby zminimalizować wpływ powiadomień o zmianach na wydajność, gdy każdy wierzchołek jest modyfikowany, odłącz siatkę od drzewa wizualnego przed wykonaniem modyfikacji na wierzchołek.  Po zmodyfikowaniu siatki ponownie dołącz ją do drzewa wizualnego.  Spróbuj również zminimalizować rozmiar oczek, które będą animowane w ten sposób.|  
|Antyaliasing 3D|Aby zwiększyć szybkość renderowania, należy wyłączyć <xref:System.Windows.Controls.Viewport3D> wielowymiarowe <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> wyrywanie na a, ustawiając dołączoną właściwość na `Aliased`.  Domyślnie antyaliasing 3D jest włączony w systemie Windows z 4 próbkami na piksel.|  
|Tekst|Tekst na żywo w scenie 3D (na <xref:System.Windows.Media.DrawingBrush> <xref:System.Windows.Media.VisualBrush>żywo, ponieważ znajduje się w lub) może być powolny. Spróbuj użyć obrazów tekstu zamiast (przez), <xref:System.Windows.Media.Imaging.RenderTargetBitmap>chyba że tekst ulegnie zmianie.|  
|<xref:System.Windows.Media.TileBrush>|Jeśli musisz użyć <xref:System.Windows.Media.VisualBrush> lub <xref:System.Windows.Media.DrawingBrush> a w scenie 3D, ponieważ zawartość pędzla nie jest statyczna, spróbuj <xref:System.Windows.Media.RenderOptions.CachingHint%2A> buforować pędzel (ustawienie dołączonej właściwości ). `Cache`  Ustaw minimalne i maksymalne progi unieważnienia skali <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> (z dołączonymi właściwościami i <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>), aby buforowane pędzle nie były generowane zbyt często, przy jednoczesnym zachowaniu pożądanego poziomu jakości.  Domyślnie <xref:System.Windows.Media.DrawingBrush> i <xref:System.Windows.Media.VisualBrush> nie są buforowane, co oznacza, że za każdym razem, gdy coś malowane pędzlem musi być ponownie renderowane, cała zawartość pędzla musi najpierw zostać ponownie renderowana na powierzchni pośredniej.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect>wymusza renderowanie całej zawartości bez przyspieszania sprzętowego.  Aby uzyskać najlepszą <xref:System.Windows.Media.Effects.BitmapEffect>wydajność, nie należy używać .|  
  
## <a name="performance-impact-medium"></a>Wpływ na wydajność: Średni  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Gdy siatka jest zdefiniowana jako przylegające trójkąty z współdzielonymi wierzchołkami, a te wierzchołki mają tę <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>samą pozycję, współrzędne normalne i tekstury, zdefiniuj każdy udostępniony wierzchołek tylko raz, a następnie zdefiniuj trójkąty według indeksu za pomocą programu .|  
|<xref:System.Windows.Media.ImageBrush>|Spróbuj zminimalizować rozmiary tekstur, gdy masz wyraźną kontrolę nad rozmiarem <xref:System.Windows.Media.Imaging.RenderTargetBitmap> (gdy <xref:System.Windows.Media.ImageBrush>używasz i/lub ).  Pamiętaj, że tekstury o niższej rozdzielczości mogą obniżać jakość obrazu, więc spróbuj znaleźć właściwą równowagę między jakością a wydajnością.|  
|Krycie|Podczas renderowania przezroczystej zawartości 3D (takiej jak odbicia) należy użyć właściwości krycia <xref:System.Windows.Media.Brush.Opacity%2A> <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>na pędzlach lub materiałach (za pośrednictwem lub) zamiast tworzyć oddzielne przezroczyste, <xref:System.Windows.Controls.Viewport3D> ustawiając `Viewport3D.Opacity` wartość mniejszą niż 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Minimalizowanie liczby <xref:System.Windows.Controls.Viewport3D> obiektów używanych w scenie.  Umieść wiele modeli 3D w tym samym widoku3D zamiast tworzyć oddzielne wystąpienia viewport3D dla każdego modelu.|  
|<xref:System.Windows.Freezable>|Zazwyczaj jest to korzystne do <xref:System.Windows.Media.Media3D.MeshGeometry3D> <xref:System.Windows.Media.Media3D.GeometryModel3D>ponownego użycia , Szczotki i materiały.  Wszystkie są multiparentable ponieważ pochodzą `Freezable`one z .|  
|<xref:System.Windows.Freezable>|Wywołanie <xref:System.Windows.Freezable.Freeze%2A> metody freezables, gdy ich właściwości pozostaną niezmienione w aplikacji.  Zamrażanie może zmniejszyć zestaw roboczy i zwiększyć prędkość.|  
|<xref:System.Windows.Media.Brush>|Użyj <xref:System.Windows.Media.ImageBrush> zamiast <xref:System.Windows.Media.VisualBrush> lub <xref:System.Windows.Media.DrawingBrush> gdy zawartość pędzla nie ulegnie zmianie.  Zawartość 2D można przekonwertować na via, <xref:System.Windows.Controls.Image> <xref:System.Windows.Media.Imaging.RenderTargetBitmap> a następnie użyć w pliku <xref:System.Windows.Media.ImageBrush>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Nie używaj, <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> chyba że rzeczywiście trzeba zobaczyć <xref:System.Windows.Media.Media3D.GeometryModel3D>tylne twarze swojego .|  
|<xref:System.Windows.Media.Media3D.Light>|Prędkość światła (od najszybszych do najwolniejszych):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Staraj się zachować rozmiary oczek sieci w następujących granicach:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20 001 <xref:System.Windows.Media.Media3D.Point3D> wystąpień<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60 003 <xref:System.Int32> instancje|  
|<xref:System.Windows.Media.Media3D.Material>|Prędkość materiału (od najszybszych do najwolniejszych):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]3D nie rezygnuje z niewidocznych pędzli (czarnych pędzli otoczenia, przezroczystych pędzli itp.) w spójny sposób.  Zastanów się nad pominięciem ich ze swojej sceny.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Każdy <xref:System.Windows.Media.Media3D.Material> w <xref:System.Windows.Media.Media3D.MaterialGroup> ach powoduje inny przebieg renderowania, więc włączenie wielu materiałów, nawet prostych materiałów, może znacznie zwiększyć zapotrzebowanie na wypełnienie procesora graficznego.  Zminimalizuj liczbę <xref:System.Windows.Media.Media3D.MaterialGroup>materiałów w pliku .|  
  
## <a name="performance-impact-low"></a>Wpływ na wydajność: niski  
  
|Właściwość|Zalecenie|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Jeśli nie potrzebujesz animacji lub powiązania danych, zamiast używać grupy transformacji zawierającej <xref:System.Windows.Media.Media3D.MatrixTransform3D>wiele przekształceń, należy użyć pojedynczego , ustawienie go jako produktu wszystkich przekształceń, które w przeciwnym razie istniałyby niezależnie w grupie transformacji.|  
|<xref:System.Windows.Media.Media3D.Light>|Zminimalizuj liczbę świateł w scenie. Zbyt wiele świateł w [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] scenie wymusi powrót do renderowania oprogramowania.  Limity to około 110 <xref:System.Windows.Media.Media3D.DirectionalLight> obiektów, <xref:System.Windows.Media.Media3D.PointLight> 70 obiektów <xref:System.Windows.Media.Media3D.SpotLight> lub 40 obiektów.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Oddziel ruchome obiekty od obiektów <xref:System.Windows.Media.Media3D.ModelVisual3D> statycznych, umieszczając je w oddzielnych wystąpieniach.  ModelVisual3D jest "cięższy" niż <xref:System.Windows.Media.Media3D.GeometryModel3D> dlatego, że buforuje przekształcone granice.  GeometriaModel3D jest zoptymalizowany jako model; ModelVisual3D jest zoptymalizowany jako węzeł sceny.  ModelVisual3D umożliwia umieszczenie w scenie udostępnionych wystąpień programu GeometryModel3D.|  
|<xref:System.Windows.Media.Media3D.Light>|Zminimalizuj liczbę zmian liczby świateł w scenie.  Każda zmiana liczby światła wymusza regenerację i ponowną kompilację modułu cieniującego, chyba że ta konfiguracja istniała wcześniej (a zatem jej moduł cieniujący był buforowany).|  
|Jasny|Czarne światła nie będą widoczne, ale dodadzą czas renderowania; należy rozważyć ich pominięcie.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Aby [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]zminimalizować czas budowy dużych kolekcji w , takich jak MeshGeometry3D <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>,, <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>i <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>, wstępnie rozmiar kolekcji przed populacji wartości. Jeśli to możliwe, przekaż konstruktorów kolekcji wstępnie wypełnionych struktur danych, takich jak tablice lub listy.|  
  
## <a name="see-also"></a>Zobacz też

- [Omówienie grafiki 3D](3-d-graphics-overview.md)
