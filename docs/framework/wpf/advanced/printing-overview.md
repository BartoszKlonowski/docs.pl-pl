---
title: Przegląd Drukowanie
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 902d51341850b5245b9fa6410b1954b2ab373bbc
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187201"
---
# <a name="printing-overview"></a><span data-ttu-id="8c28a-102">Przegląd Drukowanie</span><span class="sxs-lookup"><span data-stu-id="8c28a-102">Printing Overview</span></span>
<span data-ttu-id="8c28a-103">Dzięki programowi Microsoft .NET Framework deweloperzy aplikacji korzystający z programu Windows Presentation Foundation (WPF) mają nowy, bogaty zestaw interfejsów API zarządzania systemem drukowania i drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="8c28a-104">W systemie Windows Vista niektóre z tych ulepszeń systemu drukowania są również dostępne dla deweloperów tworzących aplikacje windows forms i deweloperów korzystających z kodu niezarządzanego.</span><span class="sxs-lookup"><span data-stu-id="8c28a-104">With Windows Vista, some of these print system enhancements are also available to developers creating Windows Forms applications and developers using unmanaged code.</span></span> <span data-ttu-id="8c28a-105">Podstawą tej nowej funkcji jest nowy format pliku XML Paper Specification (XPS) i ścieżka drukowania XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="8c28a-106">Ten temat zawiera poniższe sekcje.</span><span class="sxs-lookup"><span data-stu-id="8c28a-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>
## <a name="about-xps"></a><span data-ttu-id="8c28a-107">Informacje o XPS</span><span class="sxs-lookup"><span data-stu-id="8c28a-107">About XPS</span></span>  
 <span data-ttu-id="8c28a-108">XPS to elektroniczny format dokumentu, format pliku buforu i język opisu strony.</span><span class="sxs-lookup"><span data-stu-id="8c28a-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="8c28a-109">Jest to otwarty format dokumentu, który używa XML, Open Packaging Conventions (OPC) i innych standardów branżowych do tworzenia dokumentów międzyplatformowych.</span><span class="sxs-lookup"><span data-stu-id="8c28a-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="8c28a-110">System XPS upraszcza proces tworzenia, udostępniania, drukowania, przeglądania i archiwizowania dokumentów cyfrowych.</span><span class="sxs-lookup"><span data-stu-id="8c28a-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="8c28a-111">Aby uzyskać dodatkowe informacje na temat systemu XPS, zobacz [Dokumenty XPS](/windows/desktop/printdocs/documents).</span><span class="sxs-lookup"><span data-stu-id="8c28a-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="8c28a-112">Kilka technik drukowania zawartości opartej na XPS przy użyciu WPF są przedstawione w [programowo drukować pliki XPS](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="8c28a-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="8c28a-113">Może okazać się przydatne do odwoływania się do tych przykładów podczas przeglądu zawartości zawartej w tym temacie.</span><span class="sxs-lookup"><span data-stu-id="8c28a-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="8c28a-114">(Deweloperzy kodu niezarządzanego powinni zapoznać się z dokumentacją [funkcji MXDC_ESCAPE](/windows/desktop/printdocs/mxdc-escape).</span><span class="sxs-lookup"><span data-stu-id="8c28a-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="8c28a-115">Deweloperzy formularzy systemu Windows <xref:System.Drawing.Printing> muszą używać interfejsu API w obszarze nazw, który nie obsługuje pełnej ścieżki drukowania xps, ale obsługuje hybrydową ścieżkę drukowania GDI-TO-XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="8c28a-116">Zobacz **architekturę ścieżki drukowania** poniżej).)</span><span class="sxs-lookup"><span data-stu-id="8c28a-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>
## <a name="xps-print-path"></a><span data-ttu-id="8c28a-117">Ścieżka drukowania XPS</span><span class="sxs-lookup"><span data-stu-id="8c28a-117">XPS Print Path</span></span>  
 <span data-ttu-id="8c28a-118">Ścieżka drukowania XML Paper Specification (XPS) to nowa funkcja systemu Windows, która na nowo definiuje sposób obsługi drukowania w aplikacjach systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="8c28a-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="8c28a-119">Ponieważ system XPS może zastąpić język prezentacji dokumentu (na przykład RTF), format buforu wydruku (na przykład WMF) i język opisu strony (na przykład PCL lub Postscript); nowa ścieżka drukowania utrzymuje format XPS od publikacji aplikacji do ostatecznego przetwarzania w sterowniku lub urządzeniu drukującym.</span><span class="sxs-lookup"><span data-stu-id="8c28a-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="8c28a-120">Ścieżka drukowania XPS jest oparta na modelu sterownika drukarki XPS (XPSDrv), który zapewnia kilka korzyści dla programistów, takich jak "to, co widzisz, jest tym, co otrzymujesz" (WYSIWYG), ulepszona obsługa kolorów i znacznie lepsza wydajność drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="8c28a-121">(Aby uzyskać więcej informacji na temat XPSDrv, zobacz [dokumentację zestawu sterowników systemu Windows](/windows-hardware/drivers/).)</span><span class="sxs-lookup"><span data-stu-id="8c28a-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="8c28a-122">Działanie buforu wydruku dla dokumentów XPS jest zasadniczo takie samo jak w poprzednich wersjach systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="8c28a-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="8c28a-123">Jednak oprócz istniejącej ścieżki drukowania GDI została on akces do obsługi ścieżki drukowania XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="8c28a-124">Nowa ścieżka drukowania natywnie zużywa plik buforu XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="8c28a-125">Podczas gdy sterowniki drukarki w trybie użytkownika napisane dla poprzednich wersji systemu Windows będą nadal działać, do korzystania ze ścieżki drukowania XPS wymagany jest sterownik drukarki XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="8c28a-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="8c28a-126">Korzyści ze ścieżki drukowania XPS są znaczące i obejmują:</span><span class="sxs-lookup"><span data-stu-id="8c28a-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="8c28a-127">Obsługa druku WYSIWYG</span><span class="sxs-lookup"><span data-stu-id="8c28a-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="8c28a-128">Natywna obsługa zaawansowanych profili kolorów, które obejmują 32 bity na kanał (bpc), CMYK, nazwane kolory, n-farby i natywną obsługę przezroczystości i gradientów.</span><span class="sxs-lookup"><span data-stu-id="8c28a-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="8c28a-129">Poprawiono wydajność drukowania zarówno dla aplikacji opartych na platformie .NET Framework, jak i w aplikacji opartych na win32.</span><span class="sxs-lookup"><span data-stu-id="8c28a-129">Improved print performance for both .NET Framework and Win32 based applications.</span></span>  
  
- <span data-ttu-id="8c28a-130">Standardowy format XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="8c28a-131">W przypadku podstawowych scenariuszy drukowania dostępny jest prosty i intuicyjny interfejs API z jednym punktem wejścia do interfejsu użytkownika, konfiguracji i przesyłania zadań.</span><span class="sxs-lookup"><span data-stu-id="8c28a-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="8c28a-132">W przypadku zaawansowanych scenariuszy dodawana jest dodatkowa obsługa [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] dostosowywania (lub wcale), [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] drukowania synchronicznej lub asynchronicznej oraz możliwości drukowania wsadowego.</span><span class="sxs-lookup"><span data-stu-id="8c28a-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="8c28a-133">Obie opcje zapewniają obsługę drukowania w trybie pełnego lub częściowego zaufania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="8c28a-134">Xps został zaprojektowany z myślą o rozciągliwości.</span><span class="sxs-lookup"><span data-stu-id="8c28a-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="8c28a-135">Za pomocą struktury rozszerzalności funkcje i możliwości można dodać do systemu XPS w sposób modułowy.</span><span class="sxs-lookup"><span data-stu-id="8c28a-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="8c28a-136">Funkcje rozszerzalności obejmują:</span><span class="sxs-lookup"><span data-stu-id="8c28a-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="8c28a-137">Schemat drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-137">Print Schema.</span></span> <span data-ttu-id="8c28a-138">Schemat publiczny jest regularnie aktualizowany i umożliwia szybkie rozszerzanie możliwości urządzenia.</span><span class="sxs-lookup"><span data-stu-id="8c28a-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="8c28a-139">(Zobacz **PrintTicket i PrintCapabilities** poniżej.)</span><span class="sxs-lookup"><span data-stu-id="8c28a-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="8c28a-140">Rozszerzalny potok filtrów.</span><span class="sxs-lookup"><span data-stu-id="8c28a-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="8c28a-141">Potok filtrów sterownika drukarki XPS (XPSDrv) został zaprojektowany w celu umożliwienia zarówno bezpośredniego, jak i skalowalnego drukowania dokumentów XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="8c28a-142">Aby uzyskać więcej informacji, zobacz [Sterowniki drukarek XPSDrv](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="8c28a-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>
  
### <a name="print-path-architecture"></a><span data-ttu-id="8c28a-143">Architektura ścieżki drukowania</span><span class="sxs-lookup"><span data-stu-id="8c28a-143">Print Path Architecture</span></span>  
 <span data-ttu-id="8c28a-144">Podczas gdy aplikacje Win32 i .NET Framework obsługują aplikacje XPS, aplikacje Win32 i Windows Forms używają konwersji GDI na XPS w celu utworzenia zawartości sformatowanej w formacie XPS dla sterownika drukarki XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="8c28a-144">While both Win32 and .NET Framework applications support XPS, Win32 and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="8c28a-145">Te aplikacje nie są wymagane do korzystania ze ścieżki drukowania XPS i mogą nadal korzystać z drukowania opartego na rozszerzonym metafile (EMF).</span><span class="sxs-lookup"><span data-stu-id="8c28a-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="8c28a-146">Jednak większość funkcji i ulepszeń systemu XPS jest dostępna tylko dla aplikacji, które są przeznaczone dla ścieżki drukowania XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="8c28a-147">Aby umożliwić korzystanie z drukarek opartych na systemie XPSDrv przez aplikacje Win32 i Windows Forms, sterownik drukarki XPS (XPSDrv) obsługuje konwersję GDI do formatu XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-147">To enable the use of XPSDrv-based printers by Win32 and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="8c28a-148">Model XPSDrv zapewnia również konwerter dla formatu XPS do GDI, dzięki czemu aplikacje Win32 mogą drukować dokumenty XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-148">The XPSDrv model also provides a converter for XPS to GDI format so that Win32 applications can print XPS Documents.</span></span> <span data-ttu-id="8c28a-149">W przypadku aplikacji WPF konwersja formatu XPS do <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> formatu GDI odbywa się automatycznie przez i <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> metody <xref:System.Windows.Xps.XpsDocumentWriter> klasy, gdy docelowa kolejka wydruku operacji zapisu nie ma sterownika XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="8c28a-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="8c28a-150">(Aplikacje Windows Forms nie mogą drukować dokumentów XPS).</span><span class="sxs-lookup"><span data-stu-id="8c28a-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="8c28a-151">Poniższa ilustracja przedstawia podsystem drukowania i definiuje części dostarczone przez firmę Microsoft oraz części zdefiniowane przez dostawców oprogramowania i sprzętu:</span><span class="sxs-lookup"><span data-stu-id="8c28a-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![Zrzut ekranu pokazuje system drukowania XPS.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="8c28a-153">Podstawowe drukowanie XPS</span><span class="sxs-lookup"><span data-stu-id="8c28a-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="8c28a-154">WPF WPF definiuje zarówno podstawowy, jak i zaawansowany interfejs API.</span><span class="sxs-lookup"><span data-stu-id="8c28a-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="8c28a-155">W przypadku aplikacji, które nie wymagają rozbudowanych dostosowywania wydruku lub dostępu do pełnego zestawu funkcji XPS, dostępna jest podstawowa obsługa drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="8c28a-156">Podstawowa obsługa drukowania jest widoczna za pomocą kontrolki okna dialogowego drukowania, która wymaga minimalnej konfiguracji i zawiera znajomy [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]program .</span><span class="sxs-lookup"><span data-stu-id="8c28a-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="8c28a-157">Wiele funkcji XPS jest dostępnych przy użyciu tego uproszczonego modelu drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="8c28a-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="8c28a-158">PrintDialog</span></span>  
 <span data-ttu-id="8c28a-159">Formant <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> zapewnia pojedynczy punkt [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]wejścia dla , konfiguracji i przesyłania zadań XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="8c28a-160">Aby uzyskać informacje dotyczące tworzenia wystąpienia i używania formantu, zobacz [Wywoływanie okna dialogowego drukowania](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="8c28a-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="8c28a-161">Zaawansowane drukowanie XPS</span><span class="sxs-lookup"><span data-stu-id="8c28a-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="8c28a-162">Aby uzyskać dostęp do pełnego zestawu funkcji XPS, należy użyć zaawansowanego interfejsu API drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="8c28a-163">Kilka odpowiednich api są opisane bardziej szczegółowo poniżej.</span><span class="sxs-lookup"><span data-stu-id="8c28a-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="8c28a-164">Aby uzyskać pełną listę interfejsów API ścieżki <xref:System.Windows.Xps> drukowania systemu XPS, zobacz odwołania do obszaru nazw i <xref:System.Printing> obszarów nazw.</span><span class="sxs-lookup"><span data-stu-id="8c28a-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="8c28a-165">PrintTicket i PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="8c28a-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="8c28a-166">Klasy <xref:System.Printing.PrintTicket> <xref:System.Printing.PrintCapabilities> i klasy są podstawą zaawansowanych funkcji XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="8c28a-167">Oba typy obiektów są sformatowanymi w formacie XML strukturami funkcji zorientowanych na wydruk, takich jak sortowanie, drukowanie dwustronne, zszywanie itp. Struktury te są definiowane przez schemat drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="8c28a-168">A <xref:System.Printing.PrintTicket> instruuje drukarkę, jak przetworzyć zadanie drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="8c28a-169">Klasa <xref:System.Printing.PrintCapabilities> definiuje możliwości drukarki.</span><span class="sxs-lookup"><span data-stu-id="8c28a-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="8c28a-170">Poprzez zapytanie możliwości drukarki, <xref:System.Printing.PrintTicket> można utworzyć, który w pełni wykorzystuje obsługiwane funkcje drukarki.</span><span class="sxs-lookup"><span data-stu-id="8c28a-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="8c28a-171">Podobnie można uniknąć nieobsługiwałych funkcji.</span><span class="sxs-lookup"><span data-stu-id="8c28a-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="8c28a-172">W poniższym przykładzie pokazano, jak <xref:System.Printing.PrintCapabilities> kwerendy <xref:System.Printing.PrintTicket> drukarki i utworzyć przy użyciu kodu.</span><span class="sxs-lookup"><span data-stu-id="8c28a-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="8c28a-173">PrintServer i PrintQueue</span><span class="sxs-lookup"><span data-stu-id="8c28a-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="8c28a-174">Klasa <xref:System.Printing.PrintServer> reprezentuje serwer wydruku <xref:System.Printing.PrintQueue> sieciowego, a klasa reprezentuje drukarkę i skojarzoną z nią kolejkę zadań wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="8c28a-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="8c28a-175">Razem te interfejsy API umożliwiają zaawansowane zarządzanie zadaniami drukowania serwera.</span><span class="sxs-lookup"><span data-stu-id="8c28a-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="8c28a-176">A <xref:System.Printing.PrintServer>lub jedna z jego klas pochodnych <xref:System.Printing.PrintQueue>jest używana do zarządzania .</span><span class="sxs-lookup"><span data-stu-id="8c28a-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="8c28a-177">Metoda <xref:System.Printing.PrintQueue.AddJob%2A> służy do wstawiania nowego zadania drukowania do kolejki.</span><span class="sxs-lookup"><span data-stu-id="8c28a-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="8c28a-178">W poniższym przykładzie pokazano, jak utworzyć <xref:System.Printing.LocalPrintServer> i uzyskać dostęp do jego domyślne <xref:System.Printing.PrintQueue> przy użyciu kodu.</span><span class="sxs-lookup"><span data-stu-id="8c28a-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="8c28a-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="8c28a-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="8c28a-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, z <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> jego <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> wielu i metod, służy do <xref:System.Printing.PrintQueue>pisania dokumentów XPS do .</span><span class="sxs-lookup"><span data-stu-id="8c28a-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="8c28a-181">Na przykład <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> metoda jest używana do wyprowadzania <xref:System.Printing.PrintTicket> dokumentu XPS i synchronicznie.</span><span class="sxs-lookup"><span data-stu-id="8c28a-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="8c28a-182">Metoda <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> jest używana do wyprowadzania <xref:System.Printing.PrintTicket> dokumentu XPS i asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="8c28a-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="8c28a-183">W poniższym przykładzie pokazano, jak utworzyć przy <xref:System.Windows.Xps.XpsDocumentWriter> użyciu kodu.</span><span class="sxs-lookup"><span data-stu-id="8c28a-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="8c28a-184">Metody <xref:System.Printing.PrintQueue.AddJob%2A> zapewniają również sposoby drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="8c28a-185">Zobacz [programowo drukowanie plików XPS](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="8c28a-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="8c28a-186">szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="8c28a-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>
## <a name="gdi-print-path"></a><span data-ttu-id="8c28a-187">Ścieżka drukowania GDI</span><span class="sxs-lookup"><span data-stu-id="8c28a-187">GDI Print Path</span></span>  
 <span data-ttu-id="8c28a-188">Podczas gdy aplikacje WPF natywnie obsługują ścieżkę drukowania XPS, aplikacje Win32 i Windows Forms mogą również korzystać z niektórych funkcji systemu XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-188">While WPF applications natively support the XPS print path, Win32 and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="8c28a-189">Sterownik drukarki XPS (XPSDrv) może konwertować dane wyjściowe oparte na GDI na format XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="8c28a-190">W przypadku zaawansowanych scenariuszy niestandardowa konwersja zawartości jest obsługiwana przy użyciu [konwertera dokumentów Microsoft XPS (MXDC).](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)</span><span class="sxs-lookup"><span data-stu-id="8c28a-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="8c28a-191">Podobnie aplikacje WPF można również wyjść do ścieżki drukowania <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> GDI, wywołując jedną z lub <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> metody <xref:System.Windows.Xps.XpsDocumentWriter> klasy i wyznaczając drukarki non-XpsDrv jako docelowej kolejki wydruku.</span><span class="sxs-lookup"><span data-stu-id="8c28a-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="8c28a-192">W przypadku aplikacji, które nie wymagają funkcji lub obsługi systemu XPS, bieżąca ścieżka drukowania GDI pozostaje niezmieniona.</span><span class="sxs-lookup"><span data-stu-id="8c28a-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="8c28a-193">Aby uzyskać dodatkowy materiał referencyjny na ścieżce drukowania GDI i różnych opcjach konwersji XPS, zobacz [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) i [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="8c28a-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="8c28a-194">Model sterownika XPSDrv</span><span class="sxs-lookup"><span data-stu-id="8c28a-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="8c28a-195">Ścieżka drukowania XPS zwiększa wydajność buforu przy użyciu systemu XPS jako natywnego formatu buforu wydruku podczas drukowania na drukarce lub sterowniku z obsługą systemu XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="8c28a-196">Uproszczony proces buforowania eliminuje konieczność generowania pliku buforu pośredniego, takiego jak plik danych EMF, przed buforowaniem dokumentu.</span><span class="sxs-lookup"><span data-stu-id="8c28a-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="8c28a-197">Dzięki mniejszym rozmiarom plików buforu ścieżka drukowania XPS może zmniejszyć ruch sieciowy i poprawić wydajność drukowania.</span><span class="sxs-lookup"><span data-stu-id="8c28a-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="8c28a-198">EMF jest formatem zamkniętym, który reprezentuje dane wyjściowe aplikacji jako serię wywołań do GDI do renderowania usług.</span><span class="sxs-lookup"><span data-stu-id="8c28a-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="8c28a-199">W przeciwieństwie do EMF format buforu XPS reprezentuje rzeczywisty dokument bez konieczności dalszej interpretacji podczas pracy do sterownika drukarki opartej na xps (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="8c28a-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="8c28a-200">Sterowniki mogą działać bezpośrednio na danych w formacie.</span><span class="sxs-lookup"><span data-stu-id="8c28a-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="8c28a-201">Ta funkcja eliminuje konwersje danych i przestrzeni kolorów wymagane podczas korzystania z plików EMF i sterowników wydruku opartych na GDI.</span><span class="sxs-lookup"><span data-stu-id="8c28a-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="8c28a-202">Rozmiary plików buforu są zwykle zmniejszane podczas korzystania z dokumentów XPS, które są przeznaczone dla sterownika drukarki XPS (XPSDrv) w porównaniu z ich odpowiednikami EMF; istnieją jednak wyjątki:</span><span class="sxs-lookup"><span data-stu-id="8c28a-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="8c28a-203">Grafika wektorowa, która jest bardzo złożona, wielowarstwowa lub nieefektywnie napisana, może być większa niż wersja bitmapowa tej samej grafiki.</span><span class="sxs-lookup"><span data-stu-id="8c28a-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="8c28a-204">Do celów wyświetlania ekranu pliki XPS osadzają czcionki urządzenia, a także czcionki komputerowe; mając na uwadze, że pliki buforu GDI nie osadzają czcionek urządzenia.</span><span class="sxs-lookup"><span data-stu-id="8c28a-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="8c28a-205">Ale oba rodzaje czcionek są podzbiony (patrz poniżej) i sterowniki drukarek można usunąć czcionki urządzenia przed przesłaniem pliku do drukarki.</span><span class="sxs-lookup"><span data-stu-id="8c28a-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="8c28a-206">Zmniejszenie rozmiaru szpuli odbywa się za pomocą kilku mechanizmów:</span><span class="sxs-lookup"><span data-stu-id="8c28a-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="8c28a-207">**Podjednanie czcionek**.</span><span class="sxs-lookup"><span data-stu-id="8c28a-207">**Font subsetting**.</span></span> <span data-ttu-id="8c28a-208">W pliku XPS są przechowywane tylko znaki używane w rzeczywistym dokumencie.</span><span class="sxs-lookup"><span data-stu-id="8c28a-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="8c28a-209">**Zaawansowana obsługa grafiki**.</span><span class="sxs-lookup"><span data-stu-id="8c28a-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="8c28a-210">Natywna obsługa przezroczystości i ćwiaryzów gradientu pozwala uniknąć rasteryzacji zawartości w dokumencie XPS.</span><span class="sxs-lookup"><span data-stu-id="8c28a-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="8c28a-211">**Identyfikacja wspólnych zasobów**.</span><span class="sxs-lookup"><span data-stu-id="8c28a-211">**Identification of common resources**.</span></span> <span data-ttu-id="8c28a-212">Zasoby, które są używane wiele razy (na przykład obraz, który reprezentuje logo firmy) są traktowane jako zasoby udostępnione i są ładowane tylko raz.</span><span class="sxs-lookup"><span data-stu-id="8c28a-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="8c28a-213">**Kompresja ZIP**.</span><span class="sxs-lookup"><span data-stu-id="8c28a-213">**ZIP compression**.</span></span> <span data-ttu-id="8c28a-214">Wszystkie dokumenty XPS korzystają z kompresji ZIP.</span><span class="sxs-lookup"><span data-stu-id="8c28a-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8c28a-215">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="8c28a-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="8c28a-216">Tematy in jakże</span><span class="sxs-lookup"><span data-stu-id="8c28a-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="8c28a-217">Dokumenty w WPF</span><span class="sxs-lookup"><span data-stu-id="8c28a-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="8c28a-218">Dokumenty XPS</span><span class="sxs-lookup"><span data-stu-id="8c28a-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="8c28a-219">Serializacja dokumentu i przechowywanie</span><span class="sxs-lookup"><span data-stu-id="8c28a-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="8c28a-220">Konwerter dokumentów Microsoft XPS (MXDC)</span><span class="sxs-lookup"><span data-stu-id="8c28a-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
