---
title: 'Przewodnik: hostowanie zawartości WPF w Win32'
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: 03a35d26fd1917d926f9a26d25ae8a8e32c476f4
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/22/2019
ms.locfileid: "69917626"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="5a00a-102">Przewodnik: hostowanie zawartości WPF w Win32</span><span class="sxs-lookup"><span data-stu-id="5a00a-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="5a00a-103">oferuje bogate środowisko do tworzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-103">provides a rich environment for creating applications.</span></span> <span data-ttu-id="5a00a-104">Jeśli jednak masz znaczną inwestycję w [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] kod, bardziej efektywne może być dodanie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funkcji do aplikacji zamiast ponownego pisania oryginalnego kodu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="5a00a-105">zapewnia prosty mechanizm do hostowania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] w oknie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-105">provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="5a00a-106">W tym samouczku opisano sposób pisania przykładowej aplikacji, która udostępnia [zawartość WPF w przykładowym oknie Win32](https://go.microsoft.com/fwlink/?LinkID=160004), [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] która hostuje [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] zawartość w oknie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="5a00a-107">Ten przykład można rozwinąć, aby hostować [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] dowolne okno.</span><span class="sxs-lookup"><span data-stu-id="5a00a-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="5a00a-108">Ponieważ obejmuje mieszanie kodu zarządzanego i niezarządzanego, aplikacja jest zapisywana C++w/CLI.</span><span class="sxs-lookup"><span data-stu-id="5a00a-108">Because it involves mixing managed and unmanaged code, the application is written in C++/CLI.</span></span>  

<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="5a00a-109">Wymagania</span><span class="sxs-lookup"><span data-stu-id="5a00a-109">Requirements</span></span>  
 <span data-ttu-id="5a00a-110">W tym samouczku założono podstawową znajomość obu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programowania.</span><span class="sxs-lookup"><span data-stu-id="5a00a-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="5a00a-111">Aby zapoznać się z podstawowymi wprowadzeniem do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programowania, zobacz [wprowadzenie](../getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="5a00a-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md).</span></span> <span data-ttu-id="5a00a-112">Aby zapoznać się z [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] wprowadzeniem do programowania, należy odwołać się do dowolnej z wielu książek w temacie, w szczególności do *programowania systemu Windows* przez Charles Petzold.</span><span class="sxs-lookup"><span data-stu-id="5a00a-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="5a00a-113">Ponieważ przykład, który obejmuje ten samouczek, jest zaimplementowany w C++/CLI, w tym samouczku założono, że korzystanie C++ z programu do obsługi interfejsu API systemu Windows oraz zrozumienie programowania kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="5a00a-113">Because the sample that accompanies this tutorial is implemented in C++/CLI, this tutorial assumes familiarity with the use of C++ to program the Windows API plus an understanding of managed code programming.</span></span> <span data-ttu-id="5a00a-114">Znajomość C++/CLI jest przydatna, ale nie jest istotna.</span><span class="sxs-lookup"><span data-stu-id="5a00a-114">Familiarity with C++/CLI is helpful but not essential.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="5a00a-115">Ten samouczek zawiera wiele przykładów kodu ze skojarzonego przykładu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="5a00a-116">Jednak w celu zapewnienia czytelności nie obejmuje kompletny kod przykładowy.</span><span class="sxs-lookup"><span data-stu-id="5a00a-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="5a00a-117">Aby uzyskać kompletny przykładowy kod, zobacz [hosting zawartości WPF w przykładzie okna Win32](https://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="5a00a-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="5a00a-118">Podstawowa procedura</span><span class="sxs-lookup"><span data-stu-id="5a00a-118">The Basic Procedure</span></span>  
 <span data-ttu-id="5a00a-119">Ta sekcja zawiera opis podstawowej procedury używanej do hostowania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] w oknie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="5a00a-120">Pozostałe sekcje zawierają szczegółowe informacje o każdym z kroków.</span><span class="sxs-lookup"><span data-stu-id="5a00a-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="5a00a-121">Kluczem do hostowania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] w oknie jest <xref:System.Windows.Interop.HwndSource> Klasa.</span><span class="sxs-lookup"><span data-stu-id="5a00a-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="5a00a-122">Ta klasa otacza [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna, umożliwiając umieszczenie go [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] w oknie jako podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="5a00a-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="5a00a-123">Poniższe podejście łączy [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w pojedynczej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1. <span data-ttu-id="5a00a-124">Zaimplementuj [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość jako klasę zarządzaną.</span><span class="sxs-lookup"><span data-stu-id="5a00a-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2. <span data-ttu-id="5a00a-125">Implementowanie aplikacji systemu Windows C++za pomocą/CLI.</span><span class="sxs-lookup"><span data-stu-id="5a00a-125">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="5a00a-126">Jeśli zaczynasz od istniejącej aplikacji i niezarządzanego C++ kodu, możesz zwykle włączyć ją do wywoływania kodu zarządzanego, zmieniając ustawienia projektu w celu uwzględnienia `/clr` flagi kompilatora.</span><span class="sxs-lookup"><span data-stu-id="5a00a-126">If you are starting with an existing application and unmanaged C++ code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3. <span data-ttu-id="5a00a-127">Ustaw model wątkowości na Apartament jednowątkowy (STA).</span><span class="sxs-lookup"><span data-stu-id="5a00a-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4. <span data-ttu-id="5a00a-128">Obsługuj powiadomienie [WM_CREATE](/windows/desktop/winmsg/wm-create)w procedurze okna i wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="5a00a-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1. <span data-ttu-id="5a00a-129">Utwórz nowy <xref:System.Windows.Interop.HwndSource> obiekt z oknem nadrzędnym `parent` jako parametr.</span><span class="sxs-lookup"><span data-stu-id="5a00a-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2. <span data-ttu-id="5a00a-130">Utwórz wystąpienie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] klasy zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3. <span data-ttu-id="5a00a-131">Przypisz odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu Content <xref:System.Windows.Interop.HwndSource.RootVisual%2A> do właściwości <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="5a00a-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4. <span data-ttu-id="5a00a-132">Pobierz Właściwość HWND dla zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-132">Get the HWND for the content.</span></span> <span data-ttu-id="5a00a-133"><xref:System.Windows.Interop.HwndSource.Handle%2A> Właściwość<xref:System.Windows.Interop.HwndSource> obiektu zawiera uchwyt okna (HWND).</span><span class="sxs-lookup"><span data-stu-id="5a00a-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="5a00a-134">Aby uzyskać Właściwość HWND, która może być używana w niezarządzanej części aplikacji, Rzutowanie `Handle.ToPointer()` na Właściwość HWND.</span><span class="sxs-lookup"><span data-stu-id="5a00a-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5. <span data-ttu-id="5a00a-135">Zaimplementuj zarządzaną klasę, która zawiera pole statyczne, aby pomieścić odwołanie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-136">Ta klasa pozwala uzyskać odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości z Twojego [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6. <span data-ttu-id="5a00a-137">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Przypisz zawartość do pola statycznego.</span><span class="sxs-lookup"><span data-stu-id="5a00a-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7. <span data-ttu-id="5a00a-138">Odbieraj powiadomienia z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości przez dołączenie programu obsługi do jednego lub większej [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] liczby zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5a00a-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8. <span data-ttu-id="5a00a-139">Komunikuj się z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartością przy użyciu odwołania przechowywanego w polu statycznym, aby ustawić właściwości i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="5a00a-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="5a00a-140">Możesz również użyć [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] , aby [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zaimplementować zawartość.</span><span class="sxs-lookup"><span data-stu-id="5a00a-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-141">Należy jednak skompilować ją oddzielnie jako bibliotekę dołączaną dynamicznie (dll) i odwołać się do tej biblioteki DLL z [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-141">However, you will have to compile it separately as a dynamic-link library (DLL) and reference that DLL from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="5a00a-142">Pozostała część procedury jest podobna do przedstawionej powyżej.</span><span class="sxs-lookup"><span data-stu-id="5a00a-142">The remainder of the procedure is similar to that outlined above.</span></span>

<a name="implementing_the_application"></a>
## <a name="implementing-the-host-application"></a><span data-ttu-id="5a00a-143">Implementowanie aplikacji hosta</span><span class="sxs-lookup"><span data-stu-id="5a00a-143">Implementing the Host Application</span></span>
 <span data-ttu-id="5a00a-144">W tej sekcji opisano, jak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] hostować zawartość w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacji podstawowej.</span><span class="sxs-lookup"><span data-stu-id="5a00a-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="5a00a-145">Sama zawartość jest implementowana w C++/CLI jako Klasa zarządzana.</span><span class="sxs-lookup"><span data-stu-id="5a00a-145">The content itself is implemented in C++/CLI as a managed class.</span></span> <span data-ttu-id="5a00a-146">W większości przypadków jest to proste [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programowanie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="5a00a-147">Kluczowe aspekty implementacji zawartości zostały omówione w temacie implementowanie [zawartości WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="5a00a-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>

<a name="autoNestedSectionsOUTLINE1"></a>
- [<span data-ttu-id="5a00a-148">Podstawowa aplikacja</span><span class="sxs-lookup"><span data-stu-id="5a00a-148">The Basic Application</span></span>](#the_basic_application)

- [<span data-ttu-id="5a00a-149">Hosting zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)

- [<span data-ttu-id="5a00a-150">Przechowywanie odwołania do zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)

- [<span data-ttu-id="5a00a-151">Komunikacja z zawartością WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)

<a name="the_basic_application"></a>
### <a name="the-basic-application"></a><span data-ttu-id="5a00a-152">Podstawowa aplikacja</span><span class="sxs-lookup"><span data-stu-id="5a00a-152">The Basic Application</span></span>
 <span data-ttu-id="5a00a-153">Punktem początkowym aplikacji hosta było utworzenie szablonu programu Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="5a00a-153">The starting point for the host application was to create a Visual Studio 2005 template.</span></span>

1. <span data-ttu-id="5a00a-154">Otwórz program Visual Studio 2005 i wybierz pozycję **Nowy projekt** z menu **plik** .</span><span class="sxs-lookup"><span data-stu-id="5a00a-154">Open Visual Studio 2005, and select **New Project** from the **File** menu.</span></span>

2. <span data-ttu-id="5a00a-155">Z listy [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] typów projektów wybierz opcję Win32.</span><span class="sxs-lookup"><span data-stu-id="5a00a-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="5a00a-156">Jeśli językiem domyślnym nie C++jest, te typy projektów są dostępne w **innych językach**.</span><span class="sxs-lookup"><span data-stu-id="5a00a-156">If your default language is not C++, you will find these project types under **Other Languages**.</span></span>

3. <span data-ttu-id="5a00a-157">Wybierz szablon **projektu Win32** , przypisz nazwę do projektu, a następnie kliknij przycisk **OK** , aby uruchomić **Kreatora aplikacji Win32**.</span><span class="sxs-lookup"><span data-stu-id="5a00a-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>

4. <span data-ttu-id="5a00a-158">Zaakceptuj ustawienia domyślne kreatora i kliknij przycisk **Zakończ** , aby uruchomić projekt.</span><span class="sxs-lookup"><span data-stu-id="5a00a-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>

 <span data-ttu-id="5a00a-159">Szablon tworzy podstawową [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikację, w tym:</span><span class="sxs-lookup"><span data-stu-id="5a00a-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>

- <span data-ttu-id="5a00a-160">Punkt wejścia dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-160">An entry point for the application.</span></span>

- <span data-ttu-id="5a00a-161">Okno z skojarzoną procedurą okna (WndProc).</span><span class="sxs-lookup"><span data-stu-id="5a00a-161">A window, with an associated window procedure (WndProc).</span></span>

- <span data-ttu-id="5a00a-162">Menu z nagłówkami **plików** i **pomocy** .</span><span class="sxs-lookup"><span data-stu-id="5a00a-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="5a00a-163">Menu **plik** zawiera element **wyjścia** , który zamknie aplikację.</span><span class="sxs-lookup"><span data-stu-id="5a00a-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="5a00a-164">Menu **Pomoc** zawiera element **o** elemencie, który powoduje uruchomienie prostego okna dialogowego.</span><span class="sxs-lookup"><span data-stu-id="5a00a-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>

 <span data-ttu-id="5a00a-165">Przed rozpoczęciem pisania kodu w celu hostowania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości należy wprowadzić dwie zmiany w szablonie podstawowym.</span><span class="sxs-lookup"><span data-stu-id="5a00a-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>

 <span data-ttu-id="5a00a-166">Pierwszym jest skompilowanie projektu jako kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="5a00a-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="5a00a-167">Domyślnie projekt kompiluje jako kod niezarządzany.</span><span class="sxs-lookup"><span data-stu-id="5a00a-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="5a00a-168">Jednak ze względu na to, że [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] jest zaimplementowany w kodzie zarządzanym, projekt musi być odpowiednio skompilowany.</span><span class="sxs-lookup"><span data-stu-id="5a00a-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>

1. <span data-ttu-id="5a00a-169">Kliknij prawym przyciskiem myszy nazwę projektu w **Eksplorator rozwiązań** i wybierz polecenie **Właściwości** z menu kontekstowego, aby uruchomić okno dialogowe **strony właściwości** .</span><span class="sxs-lookup"><span data-stu-id="5a00a-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>

2. <span data-ttu-id="5a00a-170">W okienku po lewej stronie wybierz pozycję **Właściwości konfiguracji** w widoku drzewa.</span><span class="sxs-lookup"><span data-stu-id="5a00a-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>

3. <span data-ttu-id="5a00a-171">Wybierz opcję Obsługa **środowiska uruchomieniowego** CLR z listy **wartości domyślne projektu** w okienku po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>

4. <span data-ttu-id="5a00a-172">W polu listy rozwijanej wybierz opcję **Obsługa środowiska uruchomieniowego CLR (/CLR)** .</span><span class="sxs-lookup"><span data-stu-id="5a00a-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>

> [!NOTE]
> <span data-ttu-id="5a00a-173">Ta flaga kompilatora umożliwia korzystanie z kodu zarządzanego w aplikacji, ale kod niezarządzany jeszcze nie zostanie skompilowany.</span><span class="sxs-lookup"><span data-stu-id="5a00a-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="5a00a-174">używa modelu wątku jednowątkowego Apartment (STA).</span><span class="sxs-lookup"><span data-stu-id="5a00a-174">uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="5a00a-175">Aby zapewnić prawidłowe działanie z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] kodem zawartości, należy ustawić model wątkowości aplikacji na sta przez zastosowanie atrybutu do punktu wejścia.</span><span class="sxs-lookup"><span data-stu-id="5a00a-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>

 [!code-cpp[Win32HostingWPFPage#WinMain](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]

<a name="hosting_the_wpf_page"></a>
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="5a00a-176">Hosting zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-176">Hosting the WPF Content</span></span>
 <span data-ttu-id="5a00a-177">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Zawartość jest prostą aplikacją wpisu adresu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="5a00a-178">Składa się z <xref:System.Windows.Controls.TextBox> kilku kontrolek do przyłączenia nazwy użytkownika, adresu i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="5a00a-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="5a00a-179">Istnieją również dwie <xref:System.Windows.Controls.Button> kontrolki, **OK** i **Anuluj**.</span><span class="sxs-lookup"><span data-stu-id="5a00a-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="5a00a-180">Gdy użytkownik kliknie przycisk **OK**, program obsługi <xref:System.Windows.Controls.Primitives.ButtonBase.Click> zdarzeń przycisku zbiera dane z <xref:System.Windows.Controls.TextBox> formantów, przypisze je do odpowiednich właściwości i wywołuje zdarzenie `OnButtonClicked`niestandardowe.</span><span class="sxs-lookup"><span data-stu-id="5a00a-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="5a00a-181">Gdy użytkownik kliknie **przycisk Anuluj**, program obsługi po prostu `OnButtonClicked`wygeneruje.</span><span class="sxs-lookup"><span data-stu-id="5a00a-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="5a00a-182">Obiekt argumentu zdarzenia dla `OnButtonClicked` zawiera pole logiczne, które wskazuje, który przycisk został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="5a00a-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>

 <span data-ttu-id="5a00a-183">Kod obsługujący [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość jest implementowany w programie obsługi powiadomienia [WM_CREATE](/windows/desktop/winmsg/wm-create) w oknie hosta.</span><span class="sxs-lookup"><span data-stu-id="5a00a-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCreate](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]

 <span data-ttu-id="5a00a-184">Metoda pobiera informacje o rozmiarze i pozycji oraz uchwyt okna nadrzędnego i zwraca uchwyt okna hostowanej [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości. `GetHwnd`</span><span class="sxs-lookup"><span data-stu-id="5a00a-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

> [!NOTE]
> <span data-ttu-id="5a00a-185">Nie można użyć `#using` dyrektywy `System::Windows::Interop` dla przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="5a00a-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="5a00a-186">Spowoduje to utworzenie kolizji nazw między <xref:System.Windows.Interop.MSG> strukturą w tej przestrzeni nazw a strukturą komunikatów zadeklarowaną w Winuser. h.</span><span class="sxs-lookup"><span data-stu-id="5a00a-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="5a00a-187">Zamiast tego należy użyć w pełni kwalifikowanych nazw, aby uzyskać dostęp do zawartości tej przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="5a00a-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>

 [!code-cpp[Win32HostingWPFPage#GetHwnd](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]

 <span data-ttu-id="5a00a-188">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Zawartości nie można hostować bezpośrednio w oknie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="5a00a-189">Zamiast tego należy najpierw utworzyć <xref:System.Windows.Interop.HwndSource> obiekt, który będzie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawijał zawartość.</span><span class="sxs-lookup"><span data-stu-id="5a00a-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-190">Ten obiekt jest w zasadzie oknem, który jest przeznaczony do hostowania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-191"><xref:System.Windows.Interop.HwndSource> Obiekt można hostować w oknie nadrzędnym, tworząc go jako element podrzędny [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna, które jest częścią aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="5a00a-192">Parametry konstruktora zawierają wiele tych samych informacji, które można przekazać do okna, podczas [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] tworzenia okna podrzędnego. <xref:System.Windows.Interop.HwndSource></span><span class="sxs-lookup"><span data-stu-id="5a00a-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>

 <span data-ttu-id="5a00a-193">Następnie utworzysz wystąpienie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu Content.</span><span class="sxs-lookup"><span data-stu-id="5a00a-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="5a00a-194">W takim przypadku [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość jest zaimplementowana jako oddzielna `WPFPage`Klasa, przy C++użyciu/CLI.</span><span class="sxs-lookup"><span data-stu-id="5a00a-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using C++/CLI.</span></span> <span data-ttu-id="5a00a-195">Możesz również zaimplementować [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość za pomocą [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5a00a-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="5a00a-196">W tym celu należy jednak skonfigurować oddzielny projekt i skompilować [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość jako bibliotekę DLL.</span><span class="sxs-lookup"><span data-stu-id="5a00a-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a DLL.</span></span> <span data-ttu-id="5a00a-197">Do projektu można dodać odwołanie do tego pliku dll i użyć tego odwołania, aby utworzyć wystąpienie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-197">You can add a reference to that DLL to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

 <span data-ttu-id="5a00a-198">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Zawartość w oknie podrzędnym można wyświetlić, przypisując odwołanie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do zawartości <xref:System.Windows.Interop.HwndSource.RootVisual%2A> właściwości <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="5a00a-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>

 <span data-ttu-id="5a00a-199">Następny wiersz kodu dołącza procedurę obsługi `WPFButtonClicked`zdarzeń [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do zdarzenia zawartości `OnButtonClicked` .</span><span class="sxs-lookup"><span data-stu-id="5a00a-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="5a00a-200">Ta procedura obsługi jest wywoływana, gdy użytkownik kliknie przycisk **OK** lub **Anuluj** .</span><span class="sxs-lookup"><span data-stu-id="5a00a-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="5a00a-201">Zobacz [zawartość communicating_with_the_WPF](#communicating_with_the_page) , aby poznać dalsze omówienie tego programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5a00a-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>

 <span data-ttu-id="5a00a-202">Ostatni wiersz podanego kodu zwraca uchwyt okna (HWND), który jest skojarzony z <xref:System.Windows.Interop.HwndSource> obiektem.</span><span class="sxs-lookup"><span data-stu-id="5a00a-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="5a00a-203">Tego uchwytu można użyć w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodzie do wysyłania komunikatów do hostowanego okna, chociaż nie jest to konieczne.</span><span class="sxs-lookup"><span data-stu-id="5a00a-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="5a00a-204"><xref:System.Windows.Interop.HwndSource> Obiekt zgłasza zdarzenie za każdym razem, gdy odbierze komunikat.</span><span class="sxs-lookup"><span data-stu-id="5a00a-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="5a00a-205">Aby przetworzyć komunikaty, należy <xref:System.Windows.Interop.HwndSource.AddHook%2A> wywołać metodę w celu dołączenia obsługi komunikatów, a następnie przetworzyć komunikaty w ramach tej procedury obsługi.</span><span class="sxs-lookup"><span data-stu-id="5a00a-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>

<a name="holding_a_reference"></a>
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="5a00a-206">Przechowywanie odwołania do zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-206">Holding a Reference to the WPF Content</span></span>
 <span data-ttu-id="5a00a-207">W przypadku wielu aplikacji chcesz później komunikować się z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartością.</span><span class="sxs-lookup"><span data-stu-id="5a00a-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="5a00a-208">Na przykład możesz chcieć zmodyfikować [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] właściwości zawartości lub <xref:System.Windows.Interop.HwndSource> być może obiekt hostuje inną [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość.</span><span class="sxs-lookup"><span data-stu-id="5a00a-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-209">W tym celu należy odwołać się do <xref:System.Windows.Interop.HwndSource> obiektu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] lub zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-210">Obiekt i jego skojarzona [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość pozostają w pamięci do momentu zniszczenia uchwytu okna. <xref:System.Windows.Interop.HwndSource></span><span class="sxs-lookup"><span data-stu-id="5a00a-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="5a00a-211">Jednak zmienna przypisana do <xref:System.Windows.Interop.HwndSource> obiektu wyjdzie poza zakres od razu po powrocie z procedury okna.</span><span class="sxs-lookup"><span data-stu-id="5a00a-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="5a00a-212">Niestandardowy sposób obsługi tego problemu w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacjach polega na użyciu zmiennej statycznej lub globalnej.</span><span class="sxs-lookup"><span data-stu-id="5a00a-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="5a00a-213">Niestety, nie można przypisać obiektu zarządzanego do tych typów zmiennych.</span><span class="sxs-lookup"><span data-stu-id="5a00a-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="5a00a-214">Dojście do okna skojarzone z <xref:System.Windows.Interop.HwndSource> obiektem można przypisać do zmiennej globalnej lub statycznej, ale nie zapewnia ona dostępu do samego obiektu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>

 <span data-ttu-id="5a00a-215">Najprostszym rozwiązaniem tego problemu jest zaimplementowanie zarządzanej klasy, która zawiera zestaw pól statycznych do przechowywania odwołań do wszystkich obiektów zarządzanych, do których wymagany jest dostęp.</span><span class="sxs-lookup"><span data-stu-id="5a00a-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="5a00a-216">Przykład używa `WPFPageHost` klasy do przechowywania odwołania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do zawartości oraz początkowych wartości liczby właściwości, które mogą zostać zmienione później przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5a00a-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="5a00a-217">Jest to zdefiniowane w nagłówku.</span><span class="sxs-lookup"><span data-stu-id="5a00a-217">This is defined in the header.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageHost](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]

 <span data-ttu-id="5a00a-218">Ta ostatnia część `GetHwnd` funkcji przypisuje wartości do tych pól do późniejszego użycia, `myPage` gdy nadal znajduje się w zakresie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>

<a name="communicating_with_the_page"></a>
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="5a00a-219">Komunikacja z zawartością WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-219">Communicating with the WPF Content</span></span>
 <span data-ttu-id="5a00a-220">Istnieją dwa typy komunikacji z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartością.</span><span class="sxs-lookup"><span data-stu-id="5a00a-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-221">Aplikacja otrzymuje informacje z zawartości, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] gdy użytkownik kliknie przyciski **OK** lub **Anuluj** .</span><span class="sxs-lookup"><span data-stu-id="5a00a-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="5a00a-222">Aplikacja ma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] również możliwość zmiany różnych [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] właściwości zawartości, takich jak kolor tła lub domyślny rozmiar czcionki.</span><span class="sxs-lookup"><span data-stu-id="5a00a-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>

 <span data-ttu-id="5a00a-223">Jak wspomniano powyżej, gdy użytkownik kliknie dowolny przycisk [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] , zawartość `OnButtonClicked` zgłasza zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="5a00a-224">Aplikacja dołącza procedurę obsługi do tego zdarzenia, aby otrzymywać te powiadomienia.</span><span class="sxs-lookup"><span data-stu-id="5a00a-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="5a00a-225">Jeśli kliknięto przycisk **OK** , program obsługi pobiera informacje o użytkowniku z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości i wyświetla je w zestawie formantów statycznych.</span><span class="sxs-lookup"><span data-stu-id="5a00a-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]

 <span data-ttu-id="5a00a-226">Program obsługi odbiera obiekt argumentu zdarzenia niestandardowego z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] `MyPageEventArgs`zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="5a00a-227">`IsOK` Właściwość obiektu jest ustawiona na `true` , gdy kliknięto przycisk **OK** , i `false` Jeśli kliknięto przycisk **Anuluj** .</span><span class="sxs-lookup"><span data-stu-id="5a00a-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>

 <span data-ttu-id="5a00a-228">Jeśli kliknięto przycisk **OK** , program obsługi pobiera odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości z klasy kontenera.</span><span class="sxs-lookup"><span data-stu-id="5a00a-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="5a00a-229">Następnie zbiera informacje o użytkowniku, które są przechowywane przez skojarzone [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] właściwości zawartości i używa formantów statycznych do wyświetlania informacji w oknie nadrzędnym.</span><span class="sxs-lookup"><span data-stu-id="5a00a-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="5a00a-230">Ponieważ dane [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] zawartości są w postaci ciągu zarządzanego, musi być organizowane do użycia przez formant. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="5a00a-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="5a00a-231">Jeśli kliknięto przycisk **Anuluj** , program obsługi wyczyści dane z kontrolek statycznych.</span><span class="sxs-lookup"><span data-stu-id="5a00a-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>

 <span data-ttu-id="5a00a-232">Aplikacja [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zawiera zestaw przycisków radiowych, które pozwalają użytkownikowi modyfikować kolor [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tła zawartości i kilka właściwości związanych z czcionką.</span><span class="sxs-lookup"><span data-stu-id="5a00a-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="5a00a-233">Poniższy przykład jest fragmentem z procedury okna aplikacji (WndProc) i obsługą komunikatów, która ustawia różne właściwości różnych komunikatów, w tym kolor tła.</span><span class="sxs-lookup"><span data-stu-id="5a00a-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="5a00a-234">Inne są podobne i nie są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="5a00a-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="5a00a-235">Zobacz kompletny przykład dla szczegółów i kontekstu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-235">See the complete sample for details and context.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]

 <span data-ttu-id="5a00a-236">Aby ustawić kolor tła, Pobierz odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości (`hostedPage`) z `WPFPageHost` i ustaw właściwość kolor tła na odpowiedni kolor.</span><span class="sxs-lookup"><span data-stu-id="5a00a-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="5a00a-237">W przykładzie są stosowane trzy opcje koloru: oryginalny kolor, jasnozielony lub lekki.</span><span class="sxs-lookup"><span data-stu-id="5a00a-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="5a00a-238">Oryginalny kolor tła jest przechowywany jako pole statyczne w `WPFPageHost` klasie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="5a00a-239">Aby ustawić pozostałe dwa, należy utworzyć nowy <xref:System.Windows.Media.SolidColorBrush> obiekt i przekazać konstruktorowi wartość statyczne kolory <xref:System.Windows.Media.Colors> z obiektu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>

<a name="implementing_the_wpf_page"></a>
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="5a00a-240">Implementowanie strony WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-240">Implementing the WPF Page</span></span>
 <span data-ttu-id="5a00a-241">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Zawartość można hostować i korzystać z niej bez znajomości rzeczywistej implementacji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="5a00a-242">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Jeśli zawartość została spakowana w oddzielnej bibliotece DLL, mogła zostać skompilowana w dowolnym języku środowiska uruchomieniowego języka wspólnego (CLR).</span><span class="sxs-lookup"><span data-stu-id="5a00a-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate DLL, it could have been built in any common language runtime (CLR) language.</span></span> <span data-ttu-id="5a00a-243">Poniżej znajduje się krótki przewodnik implementacji C++/CLI, który jest używany w przykładzie.</span><span class="sxs-lookup"><span data-stu-id="5a00a-243">Following is a brief walkthrough of the C++/CLI implementation that is used in the sample.</span></span> <span data-ttu-id="5a00a-244">Ta sekcja zawiera następujące podsekcje.</span><span class="sxs-lookup"><span data-stu-id="5a00a-244">This section contains the following subsections.</span></span>

<a name="autoNestedSectionsOUTLINE2"></a>
- [<span data-ttu-id="5a00a-245">Układ</span><span class="sxs-lookup"><span data-stu-id="5a00a-245">Layout</span></span>](#page_layout)

- [<span data-ttu-id="5a00a-246">Zwracanie danych do okna hosta</span><span class="sxs-lookup"><span data-stu-id="5a00a-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)

- [<span data-ttu-id="5a00a-247">Ustawianie właściwości WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-247">Setting the WPF Properties</span></span>](#set_page_properties)

<a name="page_layout"></a>
### <a name="layout"></a><span data-ttu-id="5a00a-248">Układ</span><span class="sxs-lookup"><span data-stu-id="5a00a-248">Layout</span></span>
 <span data-ttu-id="5a00a-249">Elementy w zawartości składają się z pięciu <xref:System.Windows.Controls.TextBox> kontrolek ze skojarzonymi <xref:System.Windows.Controls.Label> kontrolkami: [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Nazwa, adres, miasto, stan i zip.</span><span class="sxs-lookup"><span data-stu-id="5a00a-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="5a00a-250">Istnieją również dwie <xref:System.Windows.Controls.Button> kontrolki, **OK** i **Anuluj**</span><span class="sxs-lookup"><span data-stu-id="5a00a-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>

 <span data-ttu-id="5a00a-251">Zawartość jest zaimplementowana `WPFPage` w klasie. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="5a00a-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="5a00a-252">Układ jest obsługiwany przy użyciu <xref:System.Windows.Controls.Grid> elementu układu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="5a00a-253">Klasa dziedziczy od <xref:System.Windows.Controls.Grid>, co efektywnie staje [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] się elementem głównym zawartości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>

 <span data-ttu-id="5a00a-254">Konstruktor zawartości przyjmuje wymaganą szerokość i wysokość i <xref:System.Windows.Controls.Grid> odpowiednio zmienia rozmiar. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="5a00a-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="5a00a-255">Następnie definiuje podstawowy układ przez utworzenie zestawu <xref:System.Windows.Controls.ColumnDefinition> i <xref:System.Windows.Controls.RowDefinition> obiektów oraz dodanie ich do <xref:System.Windows.Controls.Grid> obiektu podstawowego <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> i <xref:System.Windows.Controls.Grid.RowDefinitions%2A> kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5a00a-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="5a00a-256">Definiuje on siatkę pięciu wierszy i siedmiu kolumn, z wymiarami określonymi przez zawartość komórek.</span><span class="sxs-lookup"><span data-stu-id="5a00a-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]

 <span data-ttu-id="5a00a-257">Następnie Konstruktor dodaje [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elementy <xref:System.Windows.Controls.Grid>do.</span><span class="sxs-lookup"><span data-stu-id="5a00a-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="5a00a-258">Pierwszy element jest tekstem tytułu, który <xref:System.Windows.Controls.Label> jest formantem, który jest wyśrodkowany w pierwszym wierszu siatki.</span><span class="sxs-lookup"><span data-stu-id="5a00a-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]

 <span data-ttu-id="5a00a-259">Następny wiersz zawiera kontrolkę nazwa <xref:System.Windows.Controls.Label> i skojarzoną <xref:System.Windows.Controls.TextBox> z nią kontrolkę.</span><span class="sxs-lookup"><span data-stu-id="5a00a-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="5a00a-260">Ponieważ ten sam kod jest używany dla każdej pary Etykieta/pole tekstowe, jest umieszczany w parze metod prywatnych i używany dla wszystkich pięciu par Etykieta/pole tekstowe.</span><span class="sxs-lookup"><span data-stu-id="5a00a-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="5a00a-261">Metody tworzą odpowiednią kontrolkę i wywołują <xref:System.Windows.Controls.Grid> klasy static <xref:System.Windows.Controls.Grid.SetColumn%2A> i <xref:System.Windows.Controls.Grid.SetRow%2A> Methods, aby umieścić kontrolki w odpowiedniej komórce.</span><span class="sxs-lookup"><span data-stu-id="5a00a-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="5a00a-262">Po utworzeniu kontrolki, przykład wywołuje <xref:System.Windows.Controls.UIElementCollection.Add%2A> metodę <xref:System.Windows.Controls.Panel.Children%2A> właściwości, <xref:System.Windows.Controls.Grid> aby dodać formant do siatki.</span><span class="sxs-lookup"><span data-stu-id="5a00a-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="5a00a-263">Kod, aby dodać pozostałe pary Etykieta/pole tekstowe jest podobny.</span><span class="sxs-lookup"><span data-stu-id="5a00a-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="5a00a-264">Zobacz przykładowy kod, aby uzyskać szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="5a00a-264">See the sample code for details.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]

 <span data-ttu-id="5a00a-265">Implementacja dwóch metod jest następująca:</span><span class="sxs-lookup"><span data-stu-id="5a00a-265">The implementation of the two methods is as follows:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]

 <span data-ttu-id="5a00a-266">Na koniec przykład dodaje przyciski **OK** i **Anuluj** i dołącza procedurę obsługi zdarzeń do swoich <xref:System.Windows.Controls.Primitives.ButtonBase.Click> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5a00a-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]

<a name="returning_data_to_window"></a>
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="5a00a-267">Zwracanie danych do okna hosta</span><span class="sxs-lookup"><span data-stu-id="5a00a-267">Returning the Data to the Host Window</span></span>
 <span data-ttu-id="5a00a-268">Po kliknięciu dowolnego przycisku jego <xref:System.Windows.Controls.Primitives.ButtonBase.Click> zdarzenie jest wywoływane.</span><span class="sxs-lookup"><span data-stu-id="5a00a-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="5a00a-269">Okno hosta może po prostu dołączyć programy obsługi do tych zdarzeń i pobrać dane bezpośrednio z <xref:System.Windows.Controls.TextBox> kontrolek.</span><span class="sxs-lookup"><span data-stu-id="5a00a-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="5a00a-270">W przykładzie jest stosowane nieco mniej bezpośrednie podejście.</span><span class="sxs-lookup"><span data-stu-id="5a00a-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="5a00a-271">Obsługuje <xref:System.Windows.Controls.Primitives.ButtonBase.Click> `OnButtonClicked`ona zawartość, a następnie wywołuje niestandardowe [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zdarzenie, aby powiadomić zawartość. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="5a00a-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5a00a-272">Dzięki [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] temu zawartość może zostać zweryfikowana przed powiadomieniem hosta.</span><span class="sxs-lookup"><span data-stu-id="5a00a-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="5a00a-273">Program obsługi pobiera tekst z <xref:System.Windows.Controls.TextBox> formantów i przypisuje go do właściwości publicznych, z którego host może pobrać informacje.</span><span class="sxs-lookup"><span data-stu-id="5a00a-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>

 <span data-ttu-id="5a00a-274">Deklaracja zdarzenia w WPFPage. h:</span><span class="sxs-lookup"><span data-stu-id="5a00a-274">The event declaration, in WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]

 <span data-ttu-id="5a00a-275">Program <xref:System.Windows.Controls.Primitives.ButtonBase.Click> obsługi zdarzeń w WPFPage. cpp:</span><span class="sxs-lookup"><span data-stu-id="5a00a-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]

<a name="set_page_properties"></a>
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="5a00a-276">Ustawianie właściwości WPF</span><span class="sxs-lookup"><span data-stu-id="5a00a-276">Setting the WPF Properties</span></span>
 <span data-ttu-id="5a00a-277">Host zezwala użytkownikowi na zmianę kilku [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] właściwości zawartości. [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="5a00a-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="5a00a-278">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Po stronie jest po prostu kwestią zmiany właściwości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="5a00a-279">Implementacja w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] klasie zawartości jest nieco bardziej skomplikowana, ponieważ nie ma żadnej pojedynczej właściwości globalnej, która kontroluje czcionki dla wszystkich kontrolek.</span><span class="sxs-lookup"><span data-stu-id="5a00a-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="5a00a-280">Zamiast tego odpowiednia właściwość dla każdej kontrolki jest zmieniana w obszarze właściwości metody dostępu.</span><span class="sxs-lookup"><span data-stu-id="5a00a-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="5a00a-281">Poniższy przykład pokazuje kod `DefaultFontFamily` właściwości.</span><span class="sxs-lookup"><span data-stu-id="5a00a-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="5a00a-282">Ustawienie właściwości wywołuje prywatną metodę, która z kolei ustawia <xref:System.Windows.Controls.Control.FontFamily%2A> właściwości dla różnych kontrolek.</span><span class="sxs-lookup"><span data-stu-id="5a00a-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>

 <span data-ttu-id="5a00a-283">Z WPFPage. h:</span><span class="sxs-lookup"><span data-stu-id="5a00a-283">From WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]

 <span data-ttu-id="5a00a-284">Z WPFPage. cpp:</span><span class="sxs-lookup"><span data-stu-id="5a00a-284">From WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]

## <a name="see-also"></a><span data-ttu-id="5a00a-285">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="5a00a-285">See also</span></span>

- <xref:System.Windows.Interop.HwndSource>
- [<span data-ttu-id="5a00a-286">WPF i Win32 — współdziałanie</span><span class="sxs-lookup"><span data-stu-id="5a00a-286">WPF and Win32 Interoperation</span></span>](wpf-and-win32-interoperation.md)
