---
title: "Wskazówki: Hosting zawartości WPF w Win32"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology:
- dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
caps.latest.revision: 
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 0f24e32af1782ad9f6f17fcf2a72a476d053b188
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/22/2017
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="5042c-102">Wskazówki: Hosting zawartości WPF w Win32</span><span class="sxs-lookup"><span data-stu-id="5042c-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="5042c-103">udostępnia bogate środowisko do tworzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5042c-103"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="5042c-104">Jednak jeśli masz znaczących inwestycji [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] kodu, może być bardziej skuteczne dodać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funkcji aplikacji, a nie ponowne zapisywanie oryginalnego kodu.</span><span class="sxs-lookup"><span data-stu-id="5042c-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="5042c-105">udostępnia mechanizm prostego hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna.</span><span class="sxs-lookup"><span data-stu-id="5042c-105"> provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="5042c-106">Ten przewodnik opisuje sposób tworzenia aplikacji przykładowej, [Hosting zawartości WPF w przykładowym okna Win32](http://go.microsoft.com/fwlink/?LinkID=160004), że hosty [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna.</span><span class="sxs-lookup"><span data-stu-id="5042c-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="5042c-107">Istnieje możliwość rozszerzenia tego przykładu do przechowywania wszelkich [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna.</span><span class="sxs-lookup"><span data-stu-id="5042c-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="5042c-108">Ponieważ spowodowałoby to mieszanie kodu zarządzane i niezarządzane, aplikacja została napisana [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5042c-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  
  
 
  
<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="5042c-109">Wymagania</span><span class="sxs-lookup"><span data-stu-id="5042c-109">Requirements</span></span>  
 <span data-ttu-id="5042c-110">W tym samouczku założono podstawowa znajomość zarówno [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programowania.</span><span class="sxs-lookup"><span data-stu-id="5042c-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="5042c-111">Podstawowe wprowadzenie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programowania, zobacz [wprowadzenie](../../../../docs/framework/wpf/getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="5042c-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../../../../docs/framework/wpf/getting-started/index.md).</span></span> <span data-ttu-id="5042c-112">Aby obejrzeć wprowadzenie do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programowania, użytkownik powinien odwoływać się żadnego wiele książek na ten temat, w szczególności *programowania Windows* przez Petzold Charlesa.</span><span class="sxs-lookup"><span data-stu-id="5042c-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="5042c-113">Ponieważ próbki, dołączony w tym samouczku jest zaimplementowana w [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], w tym samouczku założono znajomość stosowania [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] do programu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] oraz opis programowania kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="5042c-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming.</span></span> <span data-ttu-id="5042c-114">Znajomość [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] jest pomocna, ale nie są niezbędne.</span><span class="sxs-lookup"><span data-stu-id="5042c-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5042c-115">Ten samouczek zawiera szereg przykłady kodu z skojarzone próbki.</span><span class="sxs-lookup"><span data-stu-id="5042c-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="5042c-116">Jednak aby zwiększyć czytelność, go nie ma kompletnego przykładowego kodu.</span><span class="sxs-lookup"><span data-stu-id="5042c-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="5042c-117">Zakończenie przykładowy kod, zobacz [Hosting zawartości WPF w przykładowym okna Win32](http://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="5042c-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="5042c-118">Podstawowe procedury</span><span class="sxs-lookup"><span data-stu-id="5042c-118">The Basic Procedure</span></span>  
 <span data-ttu-id="5042c-119">W tej sekcji opisano procedury podstawowa umożliwia hosta [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna.</span><span class="sxs-lookup"><span data-stu-id="5042c-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="5042c-120">W pozostałych sekcjach opisano szczegóły każdego kroku.</span><span class="sxs-lookup"><span data-stu-id="5042c-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="5042c-121">Klucz do hostingu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości na [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno jest <xref:System.Windows.Interop.HwndSource> klasy.</span><span class="sxs-lookup"><span data-stu-id="5042c-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="5042c-122">Ta klasa jest zawijana [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna, dzięki któremu można włączyć do Twojej [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] jako okna podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="5042c-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="5042c-123">Następujące podejścia łączy [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w pojedynczej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5042c-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="5042c-124">Wdrożenie programu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość jako zarządzanej klasy.</span><span class="sxs-lookup"><span data-stu-id="5042c-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2.  <span data-ttu-id="5042c-125">Implementowanie [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacja o [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5042c-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="5042c-126">Jeśli jesteś rozpoczynających się od istniejącej aplikacji, jak i niezarządzanych [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] kodu, możesz je zwykle włączyć do wywoływania z kodu zarządzanego, zmieniając ustawienia projektu, aby uwzględnić `/clr` flagi kompilatora.</span><span class="sxs-lookup"><span data-stu-id="5042c-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3.  <span data-ttu-id="5042c-127">Wartość modelu wątkowości jednowątkowego apartamentu (STA).</span><span class="sxs-lookup"><span data-stu-id="5042c-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4.  <span data-ttu-id="5042c-128">Obsługa [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)powiadomień w procedurę okna i wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="5042c-128">Handle the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)notification in your window procedure and do the following:</span></span>  
  
    1.  <span data-ttu-id="5042c-129">Utwórz nową <xref:System.Windows.Interop.HwndSource> obiekt z okna nadrzędnego jako jego `parent` parametru.</span><span class="sxs-lookup"><span data-stu-id="5042c-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="5042c-130">Utwórz wystąpienie programu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości klasy.</span><span class="sxs-lookup"><span data-stu-id="5042c-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="5042c-131">Odwołanie do przypisywania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości obiektu do <xref:System.Windows.Interop.HwndSource.RootVisual%2A> właściwość <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="5042c-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4.  <span data-ttu-id="5042c-132">Pobierz HWND zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-132">Get the HWND for the content.</span></span> <span data-ttu-id="5042c-133"><xref:System.Windows.Interop.HwndSource.Handle%2A> Właściwość <xref:System.Windows.Interop.HwndSource> obiektu zawiera uchwyt okna (HWND).</span><span class="sxs-lookup"><span data-stu-id="5042c-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="5042c-134">Aby dokonać HWND używanego w niezarządzanych część aplikacji, `Handle.ToPointer()` do HWND.</span><span class="sxs-lookup"><span data-stu-id="5042c-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5.  <span data-ttu-id="5042c-135">Implementowanie zarządzanych klasę, która zawiera pola statycznego do przechowywania odwołanie do użytkownika [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-136">Ta klasa umożliwia odwołać się do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości z Twojego [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodu.</span><span class="sxs-lookup"><span data-stu-id="5042c-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6.  <span data-ttu-id="5042c-137">Przypisz [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości do pola statycznego.</span><span class="sxs-lookup"><span data-stu-id="5042c-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7.  <span data-ttu-id="5042c-138">Odbieranie powiadomień z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości przez dołączenie obsługi do co najmniej jednego z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="5042c-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8.  <span data-ttu-id="5042c-139">Komunikować się z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości za pomocą odwołania, który przechowywany w polu statycznym, aby ustawić właściwości itd.</span><span class="sxs-lookup"><span data-stu-id="5042c-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5042c-140">Można również użyć [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] do zaimplementowania programu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-141">Jednak należy go skompilować oddzielnie jako [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] i odwołać, który [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] z Twojej [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5042c-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="5042c-142">W pozostałej części procedura jest podobna do opisanych powyżej.</span><span class="sxs-lookup"><span data-stu-id="5042c-142">The remainder of the procedure is similar to that outlined above.</span></span>  
  
<a name="implementing_the_application"></a>   
## <a name="implementing-the-host-application"></a><span data-ttu-id="5042c-143">Wdrażanie aplikacji hosta</span><span class="sxs-lookup"><span data-stu-id="5042c-143">Implementing the Host Application</span></span>  
 <span data-ttu-id="5042c-144">W tej sekcji opisano sposób hosta [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5042c-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="5042c-145">Zawartość jest zaimplementowana w [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] jako zarządzanej klasy.</span><span class="sxs-lookup"><span data-stu-id="5042c-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="5042c-146">W większości przypadków jest bezpośrednia [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programowania.</span><span class="sxs-lookup"><span data-stu-id="5042c-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="5042c-147">Omówiono kluczowe aspekty wdrożenia zawartości w [wdrażanie zawartości WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="5042c-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>  
  
<a name="autoNestedSectionsOUTLINE1"></a>   
-   [<span data-ttu-id="5042c-148">Aplikacji w warstwie podstawowa</span><span class="sxs-lookup"><span data-stu-id="5042c-148">The Basic Application</span></span>](#the_basic_application)  
  
-   [<span data-ttu-id="5042c-149">Hostowanie zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)  
  
-   [<span data-ttu-id="5042c-150">Zawierający odwołanie do zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)  
  
-   [<span data-ttu-id="5042c-151">Podczas komunikacji z zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)  
  
<a name="the_basic_application"></a>   
### <a name="the-basic-application"></a><span data-ttu-id="5042c-152">Aplikacji w warstwie podstawowa</span><span class="sxs-lookup"><span data-stu-id="5042c-152">The Basic Application</span></span>  
 <span data-ttu-id="5042c-153">Punkt początkowy aplikacji hosta było utworzyć [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] szablonu.</span><span class="sxs-lookup"><span data-stu-id="5042c-153">The starting point for the host application was to create a [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] template.</span></span>  
  
1.  <span data-ttu-id="5042c-154">Otwórz [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)]i wybierz **nowy projekt** z **pliku** menu.</span><span class="sxs-lookup"><span data-stu-id="5042c-154">Open [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], and select **New Project** from the **File** menu.</span></span>  
  
2.  <span data-ttu-id="5042c-155">Wybierz **Win32** z listy [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] typy projektów.</span><span class="sxs-lookup"><span data-stu-id="5042c-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="5042c-156">Jeśli nie jest domyślnym językiem [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], można znaleźć tych typów projektów, w obszarze **inne języki**.</span><span class="sxs-lookup"><span data-stu-id="5042c-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>  
  
3.  <span data-ttu-id="5042c-157">Wybierz **projektu Win32** szablonu, Przypisz nazwę do projektu i kliknij przycisk **OK** można uruchomić **Kreator aplikacji Win32**.</span><span class="sxs-lookup"><span data-stu-id="5042c-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>  
  
4.  <span data-ttu-id="5042c-158">Zaakceptuj domyślne ustawienia kreatora i kliknij przycisk **Zakończ** do uruchamiania projektu.</span><span class="sxs-lookup"><span data-stu-id="5042c-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>  
  
 <span data-ttu-id="5042c-159">Szablon tworzy podstawowego [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacji, w tym:</span><span class="sxs-lookup"><span data-stu-id="5042c-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>  
  
-   <span data-ttu-id="5042c-160">Punkt wejścia dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5042c-160">An entry point for the application.</span></span>  
  
-   <span data-ttu-id="5042c-161">Okno programu, przy użyciu procedury okna skojarzony (WndProc).</span><span class="sxs-lookup"><span data-stu-id="5042c-161">A window, with an associated window procedure (WndProc).</span></span>  
  
-   <span data-ttu-id="5042c-162">Menu z **pliku** i **pomocy** nagłówków.</span><span class="sxs-lookup"><span data-stu-id="5042c-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="5042c-163">**Pliku** menu ma **zakończenia** elementu, który zamyka aplikację.</span><span class="sxs-lookup"><span data-stu-id="5042c-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="5042c-164">**Pomocy** menu ma **o** elementu, który uruchamia prostego okna dialogowego.</span><span class="sxs-lookup"><span data-stu-id="5042c-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>  
  
 <span data-ttu-id="5042c-165">Przed rozpoczęciem pisania kodu do hosta [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości, należy dokonać modyfikacji dwa podstawowe szablonu.</span><span class="sxs-lookup"><span data-stu-id="5042c-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>  
  
 <span data-ttu-id="5042c-166">Pierwsza to skompilowania projektu jako kod zarządzany.</span><span class="sxs-lookup"><span data-stu-id="5042c-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="5042c-167">Domyślnie projektu kompiluje jako kodu niezarządzanego.</span><span class="sxs-lookup"><span data-stu-id="5042c-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="5042c-168">Jednak ponieważ [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zaimplementowano w kodzie zarządzanym, projekt musi zostać odpowiednio skompilowany.</span><span class="sxs-lookup"><span data-stu-id="5042c-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>  
  
1.  <span data-ttu-id="5042c-169">Kliknij prawym przyciskiem myszy nazwę projektu w **Eksploratora rozwiązań** i wybierz **właściwości** z menu kontekstowego, aby uruchomić **strony właściwości** okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="5042c-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>  
  
2.  <span data-ttu-id="5042c-170">Wybierz **właściwości konfiguracji** z widoku drzewa w okienku po lewej stronie.</span><span class="sxs-lookup"><span data-stu-id="5042c-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>  
  
3.  <span data-ttu-id="5042c-171">Wybierz **środowisko uruchomieniowe języka wspólnego** obsługiwać z **domyślne projektu** listy w okienku po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="5042c-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>  
  
4.  <span data-ttu-id="5042c-172">Wybierz **wsparcie CLR (/ clr)** w polu listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="5042c-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5042c-173">Ta flaga kompilatora pozwala na stosowanie kodu zarządzanego w aplikacji, ale kodu niezarządzanego nadal Kompiluj co poprzednio.</span><span class="sxs-lookup"><span data-stu-id="5042c-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="5042c-174">używa jednowątkowego apartamentu (STA) modelu wątków.</span><span class="sxs-lookup"><span data-stu-id="5042c-174"> uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="5042c-175">Aby działać poprawnie ze [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości kodu, musisz ustawić model wątkowości aplikacji STA przez zastosowanie atrybutu do punktu wejścia.</span><span class="sxs-lookup"><span data-stu-id="5042c-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WinMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]  
  
<a name="hosting_the_wpf_page"></a>   
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="5042c-176">Hostowanie zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-176">Hosting the WPF Content</span></span>  
 <span data-ttu-id="5042c-177">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Zawartości jest aplikacją wpis adres proste.</span><span class="sxs-lookup"><span data-stu-id="5042c-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="5042c-178">Składa się z kilku <xref:System.Windows.Controls.TextBox> formanty podjęcie nazwy użytkownika, adresu i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="5042c-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="5042c-179">Istnieją również dwa <xref:System.Windows.Controls.Button> formantów, **OK** i **anulować**.</span><span class="sxs-lookup"><span data-stu-id="5042c-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="5042c-180">Po kliknięciu przez użytkownika **OK**, przycisku <xref:System.Windows.Controls.Primitives.ButtonBase.Click> obsługi zdarzeń zbiera dane z <xref:System.Windows.Controls.TextBox> kontrolki, przypisuje go do odpowiednich właściwości i zgłasza zdarzenie niestandardowe, `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="5042c-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="5042c-181">Po kliknięciu przez użytkownika **anulować**, po prostu wywołuje program obsługi `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="5042c-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="5042c-182">Dla obiekt argument zdarzenia `OnButtonClicked` zawiera pole logiczną, wskazującą, który przycisk został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="5042c-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>  
  
 <span data-ttu-id="5042c-183">Kod do hosta [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości jest zaimplementowana w procedurze obsługi dla [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) powiadomienia na okno hosta.</span><span class="sxs-lookup"><span data-stu-id="5042c-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) notification on the host window.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCreate](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]  
  
 <span data-ttu-id="5042c-184">`GetHwnd` Metoda ma rozmiar i położenie informacje oraz nadrzędnego uchwytu okna i zwraca uchwyt okna hostowanej [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5042c-185">Nie można użyć `#using` dyrektywy dla `System::Windows::Interop` przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="5042c-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="5042c-186">Dzięki temu tworzy kolizję nazw między <xref:System.Windows.Interop.MSG> struktury w tej przestrzeni nazw i struktura MSG zadeklarowany w winuser.h.</span><span class="sxs-lookup"><span data-stu-id="5042c-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="5042c-187">Zamiast niej należy użyć nazwy w pełni kwalifikowane dostępu do zawartości tej przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="5042c-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#GetHwnd](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]  
  
 <span data-ttu-id="5042c-188">Nie można hostować [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości bezpośrednio w oknie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5042c-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="5042c-189">Zamiast tego należy najpierw utworzyć <xref:System.Windows.Interop.HwndSource> obiekt do zakodowania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-190">Ten obiekt jest zasadniczo okna, które jest przeznaczona do obsługi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-191">W przypadku obsługi <xref:System.Windows.Interop.HwndSource> obiektu w okno nadrzędne, tworząc jako element podrzędny [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna, który jest częścią aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5042c-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="5042c-192"><xref:System.Windows.Interop.HwndSource> Parametrów konstruktora zawiera wiele tych samych informacji przejdzie właściwości CreateWindow podczas tworzenia [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="5042c-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>  
  
 <span data-ttu-id="5042c-193">Następnie utwórz wystąpienie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości obiektu.</span><span class="sxs-lookup"><span data-stu-id="5042c-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="5042c-194">W takim przypadku [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości jest zaimplementowany jako osobnej klasy `WPFPage`za pomocą [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5042c-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="5042c-195">Można też wdrożyć [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości z [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5042c-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="5042c-196">Jednak w tym celu należy skonfigurować oddzielny projekt do kompilacji [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość jako [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5042c-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="5042c-197">Można dodać odwołanie do tego [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] do projektu i użyj odwołujący się do utworzenia wystąpienia [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
 <span data-ttu-id="5042c-198">Możesz wyświetlić [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość okna podrzędnego, przypisując odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości do <xref:System.Windows.Interop.HwndSource.RootVisual%2A> właściwość <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="5042c-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
 <span data-ttu-id="5042c-199">W następnym wierszu kodu dołącza program obsługi zdarzeń `WPFButtonClicked`, do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości `OnButtonClicked` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5042c-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="5042c-200">Ten program obsługi jest wywoływana, gdy użytkownik kliknie **OK** lub **anulować** przycisku.</span><span class="sxs-lookup"><span data-stu-id="5042c-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="5042c-201">Zobacz [zawartości communicating_with_the_WPF](#communicating_with_the_page) Aby zapoznać się z tej obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5042c-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>  
  
 <span data-ttu-id="5042c-202">Końcowego wiersza kodu pokazano zwraca uchwyt okna (HWND), z którym skojarzony jest <xref:System.Windows.Interop.HwndSource> obiektu.</span><span class="sxs-lookup"><span data-stu-id="5042c-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="5042c-203">Można użyć tego uchwytu z Twojej [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kod do wysyłania wiadomości do okna hostowanej, mimo że próbki nie jest to.</span><span class="sxs-lookup"><span data-stu-id="5042c-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="5042c-204"><xref:System.Windows.Interop.HwndSource> Obiektu zgłasza zdarzenie, za każdym razem, gdy odbierze komunikat.</span><span class="sxs-lookup"><span data-stu-id="5042c-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="5042c-205">Aby przetwarzać komunikaty, wywołaj <xref:System.Windows.Interop.HwndSource.AddHook%2A> metodę, aby dołączyć obsługi wiadomości i następnie przetwarzanie wiadomości w programu obsługi.</span><span class="sxs-lookup"><span data-stu-id="5042c-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>  
  
<a name="holding_a_reference"></a>   
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="5042c-206">Zawierający odwołanie do zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-206">Holding a Reference to the WPF Content</span></span>  
 <span data-ttu-id="5042c-207">Dla wielu aplikacji, można nawiązać połączenia z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości później.</span><span class="sxs-lookup"><span data-stu-id="5042c-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="5042c-208">Na przykład można zmodyfikować [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości właściwości lub może mieć <xref:System.Windows.Interop.HwndSource> obiektu hosta innego [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-209">Aby to zrobić, należy odwołanie do <xref:System.Windows.Interop.HwndSource> obiektu lub [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-210"><xref:System.Windows.Interop.HwndSource> Obiekt i jego skojarzony [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości pozostawać w pamięci, dopóki zniszczyć uchwytu okna.</span><span class="sxs-lookup"><span data-stu-id="5042c-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="5042c-211">Jednak zmiennej możesz przypisać <xref:System.Windows.Interop.HwndSource> obiektu przejdzie poza zakresem zaraz po powrocie z procedurę okna.</span><span class="sxs-lookup"><span data-stu-id="5042c-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="5042c-212">Zwyczajowe sposobem obsługi tego problemu z [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacji jest użycie zmiennej statyczny lub globalnego.</span><span class="sxs-lookup"><span data-stu-id="5042c-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="5042c-213">Niestety nie można przypisać obiektu zarządzanego tych typów zmiennych.</span><span class="sxs-lookup"><span data-stu-id="5042c-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="5042c-214">Można przypisać skojarzono uchwyt okna <xref:System.Windows.Interop.HwndSource> obiekt do zmiennej globalnej lub statycznej, ale ten Nowak nie zapewniają dostęp do danego obiektu.</span><span class="sxs-lookup"><span data-stu-id="5042c-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>  
  
 <span data-ttu-id="5042c-215">Najprostszym rozwiązaniem tego problemu jest zarządzanej klasy, która zawiera zestaw pól statycznych do przechowywania odwołań do zarządzanych obiektów, które wymagają dostępu do wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="5042c-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="5042c-216">W przykładzie użyto `WPFPageHost` klasy utrzymującej odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości oraz wartości początkowej liczby jego właściwości, które można zmienić później przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5042c-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="5042c-217">To jest zdefiniowany w nagłówku.</span><span class="sxs-lookup"><span data-stu-id="5042c-217">This is defined in the header.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageHost](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]  
  
 <span data-ttu-id="5042c-218">Ostatnie część `GetHwnd` funkcja przypisuje wartości do tych pól do późniejszego użytku podczas `myPage` jest nadal w zakresie.</span><span class="sxs-lookup"><span data-stu-id="5042c-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>  
  
<a name="communicating_with_the_page"></a>   
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="5042c-219">Podczas komunikacji z zawartości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-219">Communicating with the WPF Content</span></span>  
 <span data-ttu-id="5042c-220">Istnieją dwa typy komunikacji z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-221">Po otrzymaniu informacji z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości, gdy użytkownik kliknie **OK** lub **anulować** przycisków.</span><span class="sxs-lookup"><span data-stu-id="5042c-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="5042c-222">Aplikacja ma również [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] który umożliwia użytkownikowi zmianę różnych [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości właściwości, takie jak tła kolor lub domyślny rozmiar czcionki.</span><span class="sxs-lookup"><span data-stu-id="5042c-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>  
  
 <span data-ttu-id="5042c-223">Jak wspomniano powyżej, gdy użytkownik kliknie przycisk albo [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości generuje `OnButtonClicked` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5042c-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="5042c-224">Aplikacja dołącza program obsługi do tego zdarzenia, aby otrzymywać te powiadomienia.</span><span class="sxs-lookup"><span data-stu-id="5042c-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="5042c-225">Jeśli **OK** przycisk został kliknięty, program obsługi pobiera informacje o użytkowniku z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości i wyświetla je w zestawie formantów statycznych.</span><span class="sxs-lookup"><span data-stu-id="5042c-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]  
  
 <span data-ttu-id="5042c-226">Program obsługi odbiera obiekt argument niestandardowe zdarzenie z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości, `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="5042c-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="5042c-227">Obiektu `IsOK` właściwość jest ustawiona na `true` Jeśli **OK** kliknął przycisk i `false` Jeśli **anulować** przycisk został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="5042c-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>  
  
 <span data-ttu-id="5042c-228">Jeśli **OK** przycisk został kliknięty, program obsługi pobiera odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości z klasy kontenera.</span><span class="sxs-lookup"><span data-stu-id="5042c-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="5042c-229">Następnie zbiera informacje o użytkowniku, który jest przechowywany przez skojarzony [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości właściwości i używa formantów statycznych, aby wyświetlić informacje w oknie nadrzędnym.</span><span class="sxs-lookup"><span data-stu-id="5042c-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="5042c-230">Ponieważ [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] danych zawartości jest w formie ciągu zarządzany, musi być przekazywane do użycia przez [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] formantu.</span><span class="sxs-lookup"><span data-stu-id="5042c-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="5042c-231">Jeśli **anulować** przycisk został kliknięty, program obsługi spowoduje wyczyszczenie danych z formantów statycznych.</span><span class="sxs-lookup"><span data-stu-id="5042c-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>  
  
 <span data-ttu-id="5042c-232">Aplikacja [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zawiera zestaw przycisków radiowych, które umożliwiają użytkownikom modyfikowanie kolor tła [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości i kilka właściwości związanych z czcionki.</span><span class="sxs-lookup"><span data-stu-id="5042c-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="5042c-233">Poniższy przykład zawiera fragment procedurę okna aplikacji (WndProc) i jego obsługa który komunikatów ustawia różne właściwości na inne komunikaty, w tym kolor tła.</span><span class="sxs-lookup"><span data-stu-id="5042c-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="5042c-234">Inne podobne i nie są pokazywane.</span><span class="sxs-lookup"><span data-stu-id="5042c-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="5042c-235">Zobacz pełną próbki szczegółowe informacje i kontekstu.</span><span class="sxs-lookup"><span data-stu-id="5042c-235">See the complete sample for details and context.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]  
  
 <span data-ttu-id="5042c-236">Aby ustawić kolor tła, pobrać odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości (`hostedPage`) z `WPFPageHost` i ustaw właściwość kolor tła na kolor odpowiednie.</span><span class="sxs-lookup"><span data-stu-id="5042c-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="5042c-237">Próbka używa trzech opcji koloru: oryginalny kolor, światła łososia Green threshold lub prostych.</span><span class="sxs-lookup"><span data-stu-id="5042c-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="5042c-238">Oryginalny kolor tła jest przechowywana jako pola statycznego w `WPFPageHost` klasy.</span><span class="sxs-lookup"><span data-stu-id="5042c-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="5042c-239">Aby ustawić innych dwa, należy utworzyć nowy <xref:System.Windows.Media.SolidColorBrush> obiektu i przekazać wartości kolorów statyczne z konstruktora <xref:System.Windows.Media.Colors> obiektu.</span><span class="sxs-lookup"><span data-stu-id="5042c-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>  
  
<a name="implementing_the_wpf_page"></a>   
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="5042c-240">Implementacja strony WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-240">Implementing the WPF Page</span></span>  
 <span data-ttu-id="5042c-241">Możesz udostępniać i użyć [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości bez żadnych wiedzy rzeczywistego wykonania.</span><span class="sxs-lookup"><span data-stu-id="5042c-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="5042c-242">Jeśli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość była zostały opakowane w oddzielnej [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], można został skompilowany w żadnym [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] języka.</span><span class="sxs-lookup"><span data-stu-id="5042c-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span></span> <span data-ttu-id="5042c-243">Poniżej znajduje się krótki przewodnik [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementację, która jest używana w próbce.</span><span class="sxs-lookup"><span data-stu-id="5042c-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="5042c-244">Ta sekcja zawiera następujące podsekcje.</span><span class="sxs-lookup"><span data-stu-id="5042c-244">This section contains the following subsections.</span></span>  
  
<a name="autoNestedSectionsOUTLINE2"></a>   
-   [<span data-ttu-id="5042c-245">Układ</span><span class="sxs-lookup"><span data-stu-id="5042c-245">Layout</span></span>](#page_layout)  
  
-   [<span data-ttu-id="5042c-246">Przesłać dane do okna hosta</span><span class="sxs-lookup"><span data-stu-id="5042c-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)  
  
-   [<span data-ttu-id="5042c-247">Ustawianie właściwości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-247">Setting the WPF Properties</span></span>](#set_page_properties)  
  
<a name="page_layout"></a>   
### <a name="layout"></a><span data-ttu-id="5042c-248">Układ</span><span class="sxs-lookup"><span data-stu-id="5042c-248">Layout</span></span>  
 <span data-ttu-id="5042c-249">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Elementów w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości składają się z pięciu <xref:System.Windows.Controls.TextBox> kontrolki, z skojarzony <xref:System.Windows.Controls.Label> kontrolki: nazwa, adres miejscowość, stan i Zip.</span><span class="sxs-lookup"><span data-stu-id="5042c-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="5042c-250">Istnieją również dwa <xref:System.Windows.Controls.Button> formantów, **OK** i **Anuluj**</span><span class="sxs-lookup"><span data-stu-id="5042c-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>  
  
 <span data-ttu-id="5042c-251">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Zawartości jest zaimplementowana w `WPFPage` klasy.</span><span class="sxs-lookup"><span data-stu-id="5042c-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="5042c-252">Układ jest obsługiwany z <xref:System.Windows.Controls.Grid> elementu układu.</span><span class="sxs-lookup"><span data-stu-id="5042c-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="5042c-253">Klasa dziedziczy <xref:System.Windows.Controls.Grid>, które skutecznie stwarza [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementu głównego zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>  
  
 <span data-ttu-id="5042c-254">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Zawartości Konstruktor pobiera wymaganych szerokość i wysokość oraz rozmiary <xref:System.Windows.Controls.Grid> odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="5042c-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="5042c-255">Następnie definiuje podstawowy układ tworząc zestaw <xref:System.Windows.Controls.ColumnDefinition> i <xref:System.Windows.Controls.RowDefinition> obiektów oraz dodanie ich do <xref:System.Windows.Controls.Grid> obiektu podstawowego <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> i <xref:System.Windows.Controls.Grid.RowDefinitions%2A> kolekcje, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="5042c-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="5042c-256">Definiuje siatki pięć wierszy i kolumn siedmiu o wymiarach ustaleniami zawartości komórek.</span><span class="sxs-lookup"><span data-stu-id="5042c-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]  
  
 <span data-ttu-id="5042c-257">Następnie dodaje konstruktora [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elementy <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="5042c-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="5042c-258">Pierwszy element jest tekst tytułu, który jest <xref:System.Windows.Controls.Label> formant, który skupia się w pierwszym wierszu siatki.</span><span class="sxs-lookup"><span data-stu-id="5042c-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]  
  
 <span data-ttu-id="5042c-259">Następny wiersz zawiera nazwę <xref:System.Windows.Controls.Label> kontroli i jego skojarzony <xref:System.Windows.Controls.TextBox> formantu.</span><span class="sxs-lookup"><span data-stu-id="5042c-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="5042c-260">Ponieważ ten sam kod jest używane dla każdej pary etykiety/pola tekstowego, jest umieszczony w parze prywatnych metod i używane dla wszystkich pięciu par etykiety/textbox.</span><span class="sxs-lookup"><span data-stu-id="5042c-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="5042c-261">Utwórz odpowiednie metody kontroli i wywołać <xref:System.Windows.Controls.Grid> klasy statycznej <xref:System.Windows.Controls.Grid.SetColumn%2A> i <xref:System.Windows.Controls.Grid.SetRow%2A> metody Umieść formanty w komórce, odpowiedni.</span><span class="sxs-lookup"><span data-stu-id="5042c-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="5042c-262">Po utworzeniu formantu przykład wywołuje <xref:System.Windows.Controls.UIElementCollection.Add%2A> metoda <xref:System.Windows.Controls.Panel.Children%2A> właściwość <xref:System.Windows.Controls.Grid> można dodać kontrolki do siatki.</span><span class="sxs-lookup"><span data-stu-id="5042c-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="5042c-263">Przypomina kod, aby dodać pozostałe pary etykiety/textbox.</span><span class="sxs-lookup"><span data-stu-id="5042c-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="5042c-264">Zobacz przykładowy kod, aby uzyskać szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="5042c-264">See the sample code for details.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]  
  
 <span data-ttu-id="5042c-265">Implementacja dwie metody jest następująca:</span><span class="sxs-lookup"><span data-stu-id="5042c-265">The implementation of the two methods is as follows:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]  
  
 <span data-ttu-id="5042c-266">Na koniec dodaje próbki **OK** i **anulować** przyciski i dołącza program obsługi zdarzeń do ich <xref:System.Windows.Controls.Primitives.ButtonBase.Click> zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="5042c-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]  
  
<a name="returning_data_to_window"></a>   
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="5042c-267">Przesłać dane do okna hosta</span><span class="sxs-lookup"><span data-stu-id="5042c-267">Returning the Data to the Host Window</span></span>  
 <span data-ttu-id="5042c-268">Po kliknięciu przycisku albo jego <xref:System.Windows.Controls.Primitives.ButtonBase.Click> zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="5042c-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="5042c-269">Okno hosta można po prostu Dołącz programów obsługi na te zdarzenia i Pobierz dane bezpośrednio z <xref:System.Windows.Controls.TextBox> formantów.</span><span class="sxs-lookup"><span data-stu-id="5042c-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="5042c-270">W przykładzie użyto nieco mniej bezpośredniego podejście.</span><span class="sxs-lookup"><span data-stu-id="5042c-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="5042c-271">Obsługuje on <xref:System.Windows.Controls.Primitives.ButtonBase.Click> w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości, a następnie wywołuje zdarzenie niestandardowe `OnButtonClicked`, aby powiadomić [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="5042c-272">Dzięki temu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w celu niektóre sprawdzanie poprawności parametru przed powiadamiania hosta.</span><span class="sxs-lookup"><span data-stu-id="5042c-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="5042c-273">Program obsługi pobiera tekst z <xref:System.Windows.Controls.TextBox> steruje i przypisuje go do właściwości publiczne, z których mogą pobrać hosta informacje.</span><span class="sxs-lookup"><span data-stu-id="5042c-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>  
  
 <span data-ttu-id="5042c-274">Deklaracja zdarzenia w WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="5042c-274">The event declaration, in WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]  
  
 <span data-ttu-id="5042c-275"><xref:System.Windows.Controls.Primitives.ButtonBase.Click> Obsługi zdarzeń w WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="5042c-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]  
  
<a name="set_page_properties"></a>   
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="5042c-276">Ustawianie właściwości WPF</span><span class="sxs-lookup"><span data-stu-id="5042c-276">Setting the WPF Properties</span></span>  
 <span data-ttu-id="5042c-277">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Hosta umożliwia użytkownikowi zmianę kilka [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] właściwości zawartości.</span><span class="sxs-lookup"><span data-stu-id="5042c-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="5042c-278">Z [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] strony, jest po prostu kwestią zmiany właściwości.</span><span class="sxs-lookup"><span data-stu-id="5042c-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="5042c-279">Implementacja w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] klasy zawartości jest nieco bardziej skomplikowane, ponieważ nie ma jednej właściwości globalne kontrolujące czcionki dla wszystkich kontrolek.</span><span class="sxs-lookup"><span data-stu-id="5042c-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="5042c-280">Zamiast tego odpowiednie właściwości dla każdego formantu zostanie zmieniona w metodach dostępu set właściwości.</span><span class="sxs-lookup"><span data-stu-id="5042c-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="5042c-281">W poniższym przykładzie pokazano kod `DefaultFontFamily` właściwości.</span><span class="sxs-lookup"><span data-stu-id="5042c-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="5042c-282">Ustawienie właściwości wywołuje metody prywatnej to z kolei zestawy <xref:System.Windows.Controls.Control.FontFamily%2A> właściwości różnych formantów.</span><span class="sxs-lookup"><span data-stu-id="5042c-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>  
  
 <span data-ttu-id="5042c-283">Z WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="5042c-283">From WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]  
  
 <span data-ttu-id="5042c-284">Z WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="5042c-284">From WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]  
  
## <a name="see-also"></a><span data-ttu-id="5042c-285">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="5042c-285">See Also</span></span>  
 <xref:System.Windows.Interop.HwndSource>  
 [<span data-ttu-id="5042c-286">WPF i Win32 — współdziałanie</span><span class="sxs-lookup"><span data-stu-id="5042c-286">WPF and Win32 Interoperation</span></span>](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)
