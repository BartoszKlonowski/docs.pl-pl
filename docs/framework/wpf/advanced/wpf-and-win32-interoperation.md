---
title: WPF i Win32 — Współdziałanie
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-wpf
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
- HWND interop [WPF]
- Win32 code [WPF], WPF interoperation
- interoperability [WPF], Win32
ms.assetid: 0ffbde0d-701d-45a3-a6fa-dd71f4d9772e
caps.latest.revision: 26
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 6388762815a621b37c2894cdb7f7966b2c36639c
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/26/2018
---
# <a name="wpf-and-win32-interoperation"></a><span data-ttu-id="7f797-102">WPF i Win32 — Współdziałanie</span><span class="sxs-lookup"><span data-stu-id="7f797-102">WPF and Win32 Interoperation</span></span>
<span data-ttu-id="7f797-103">Ten temat zawiera omówienie sposobu współdziałać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodu.</span><span class="sxs-lookup"><span data-stu-id="7f797-103">This topic provides an overview of how to interoperate [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span> [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="7f797-104"> udostępnia bogate środowisko do tworzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7f797-104"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="7f797-105">Jednak jeśli masz znaczących inwestycji [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] kodu, może być bardziej efektywną ponowne części kodu.</span><span class="sxs-lookup"><span data-stu-id="7f797-105">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to reuse some of that code.</span></span>  
  

  
<a name="basics"></a>   
## <a name="wpf-and-win32-interoperation-basics"></a><span data-ttu-id="7f797-106">WPF i współdziałanie podstawy Win32</span><span class="sxs-lookup"><span data-stu-id="7f797-106">WPF and Win32 Interoperation Basics</span></span>  
 <span data-ttu-id="7f797-107">Istnieją dwie podstawowe metody współdziałanie między [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodu.</span><span class="sxs-lookup"><span data-stu-id="7f797-107">There are two basic techniques for interoperation between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
-   <span data-ttu-id="7f797-108">Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna.</span><span class="sxs-lookup"><span data-stu-id="7f797-108">Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="7f797-109">W przypadku tej techniki, można użyć funkcji zaawansowanych graficznych [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w ramach standardowego [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7f797-109">With this technique, you can use the advanced graphics capabilities of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within the framework of a standard [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window and application.</span></span>  
  
-   <span data-ttu-id="7f797-110">Host [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="7f797-110">Host a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7f797-111">W przypadku tej techniki, można użyć istniejącego niestandardowe [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kontroli w kontekście innych [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości i przekazywanie danych poza granicami.</span><span class="sxs-lookup"><span data-stu-id="7f797-111">With this technique, you can use an existing custom [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control in the context of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and pass data across the boundaries.</span></span>  
  
 <span data-ttu-id="7f797-112">Każdy z tych metod jest koncepcyjnie opisanymi w tym temacie.</span><span class="sxs-lookup"><span data-stu-id="7f797-112">Each of these techniques is conceptually introduced in this topic.</span></span> <span data-ttu-id="7f797-113">Ilustracyjną więcej zorientowane na kod obsługi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], zobacz [wskazówki: Obsługa zawartości WPF w Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="7f797-113">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], see [Walkthrough: Hosting WPF Content in Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span></span> <span data-ttu-id="7f797-114">Ilustracyjną więcej zorientowane na kod obsługi [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], zobacz [wskazówki: hostowanie formantu Win32 na platformie WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="7f797-114">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Walkthrough: Hosting a Win32 Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>  
  
<a name="projects"></a>   
## <a name="wpf-interoperation-projects"></a><span data-ttu-id="7f797-115">Projekty współdziałanie z WPF</span><span class="sxs-lookup"><span data-stu-id="7f797-115">WPF Interoperation Projects</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7f797-116"> [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] czy kodu zarządzanego, ale większość istniejące [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programy są zapisywane niezarządzanych [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f797-116"> [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] are managed code, but most existing [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programs are written in unmanaged [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span></span>  <span data-ttu-id="7f797-117">Nie można wywołać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] z rzeczywistego niezarządzanych program.</span><span class="sxs-lookup"><span data-stu-id="7f797-117">You cannot call [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] from a true unmanaged program.</span></span> <span data-ttu-id="7f797-118">Jednak przy użyciu `/clr` opcję z [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)] kompilatora, można utworzyć mieszanych niezarządzany zarządzany program gdzie bezproblemowo można łączyć zarządzanych i niezarządzanych [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] wywołania.</span><span class="sxs-lookup"><span data-stu-id="7f797-118">However, by using the `/clr` option with the [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)] compiler, you can create a mixed managed-unmanaged program where you can seamlessly mix managed and unmanaged [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] calls.</span></span>  
  
 <span data-ttu-id="7f797-119">Jeden poziom projektu complication jest, że nie można skompilować [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] pliki do [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] projektu.</span><span class="sxs-lookup"><span data-stu-id="7f797-119">One project-level complication is that you cannot compile [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] files into a [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] project.</span></span>  <span data-ttu-id="7f797-120">Istnieje kilka technik dzielenia projektu to kompensacji.</span><span class="sxs-lookup"><span data-stu-id="7f797-120">There are several project division techniques to compensate for this.</span></span>  
  
-   <span data-ttu-id="7f797-121">Utwórz DLL języka C#, która zawiera wszystkie Twoje [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] strony jako skompilowanym zestawie, a następnie z [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] obejmują plik wykonywalny, który [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] jako odwołanie.</span><span class="sxs-lookup"><span data-stu-id="7f797-121">Create a C# DLL that contains all your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pages as a compiled assembly, and then have your [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] executable include that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] as a reference.</span></span>  
  
-   <span data-ttu-id="7f797-122">Utwórz C# plik wykonywalny dla [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości i jego odwołania [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] zawierający [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="7f797-122">Create a C# executable for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and have it reference a [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] that contains the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>  
  
-   <span data-ttu-id="7f797-123">Użyj <xref:System.Windows.Markup.XamlReader.Load%2A> załadować żadnego [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] w czasie wykonywania, zamiast kompilowanie programu [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f797-123">Use <xref:System.Windows.Markup.XamlReader.Load%2A> to load any [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at run time, instead of compiling your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>  
  
-   <span data-ttu-id="7f797-124">Nie używaj [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] i zapisanie wszystkich sieci [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w kodzie, tworzenie drzewa elementu z <xref:System.Windows.Application>.</span><span class="sxs-lookup"><span data-stu-id="7f797-124">Do not use [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at all, and write all your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in code, building up the element tree from <xref:System.Windows.Application>.</span></span>  
  
 <span data-ttu-id="7f797-125">Użyj dowolnej metody działa najlepiej dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="7f797-125">Use whatever approach works best for you.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7f797-126">Jeśli nie używasz [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] przed, takich jak można zauważyć pewne "new" słów kluczowych `gcnew` i `nullptr` w przykładach współdziałanie kodu.</span><span class="sxs-lookup"><span data-stu-id="7f797-126">If you have not used [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] before, you might notice some "new" keywords such as `gcnew` and `nullptr` in the interoperation code examples.</span></span> <span data-ttu-id="7f797-127">Słowa kluczowe zastępowania starszych składni podkreślenia o podwójnej precyzji (`__gc`) i zapewnić bardziej naturalne składni dla kodu zarządzanego w [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f797-127">These keywords supersede the older double-underscore syntax (`__gc`) and provide a more natural syntax for managed code in [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span></span>  <span data-ttu-id="7f797-128">Aby dowiedzieć się więcej o [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] zarządzanego funkcji, zobacz [Component Extensions dla platform środowiska uruchomieniowego](/cpp/windows/component-extensions-for-runtime-platforms) i [Hello C + +/ CLI](http://go.microsoft.com/fwlink/?LinkId=98739).</span><span class="sxs-lookup"><span data-stu-id="7f797-128">To learn more about the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] managed features, see [Component Extensions for Runtime Platforms](/cpp/windows/component-extensions-for-runtime-platforms) and [Hello, C++/CLI](http://go.microsoft.com/fwlink/?LinkId=98739).</span></span>  
  
<a name="hwnds"></a>   
## <a name="how-wpf-uses-hwnds"></a><span data-ttu-id="7f797-129">Jak WPF używa parametrów hWnd</span><span class="sxs-lookup"><span data-stu-id="7f797-129">How WPF Uses Hwnds</span></span>  
 <span data-ttu-id="7f797-130">Aby w pełni wykorzystać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] "HWND interop", należy zrozumieć sposób [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] używa parametrów hWnd.</span><span class="sxs-lookup"><span data-stu-id="7f797-130">To make the most of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] "HWND interop", you need to understand how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses HWNDs.</span></span> <span data-ttu-id="7f797-131">Dla dowolnego HWND nie można mieszać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] renderowania z [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] renderowania lub [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]  /  [!INCLUDE[TLA2#tla_gdiplus](../../../../includes/tla2sharptla-gdiplus-md.md)] renderowania.</span><span class="sxs-lookup"><span data-stu-id="7f797-131">For any HWND, you cannot mix [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering with [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] rendering or [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] / [!INCLUDE[TLA2#tla_gdiplus](../../../../includes/tla2sharptla-gdiplus-md.md)] rendering.</span></span> <span data-ttu-id="7f797-132">Ma to liczba skutki.</span><span class="sxs-lookup"><span data-stu-id="7f797-132">This has a number of implications.</span></span> <span data-ttu-id="7f797-133">Przede wszystkim aby można było w ogóle mieszać te modele renderowania, należy utworzyć współdziałanie rozwiązania i użyj wyznaczonych segmenty współdziałanie dla każdego modelu renderowania, który chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="7f797-133">Primarily, in order to mix these rendering models at all, you must create an interoperation solution, and use designated segments of interoperation for each rendering model that you choose to use.</span></span> <span data-ttu-id="7f797-134">Ponadto sposób renderowania tworzy ograniczenie "powietrznej" co można zrobić współdziałanie rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="7f797-134">Also, the rendering behavior creates an "airspace" restriction for what your interoperation solution can accomplish.</span></span> <span data-ttu-id="7f797-135">Pojęcie "powietrznej" objaśniono szczegółowo w temacie [omówienie technologii regionów](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7f797-135">The "airspace" concept is explained in greater detail in the topic [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span></span>  
  
 <span data-ttu-id="7f797-136">Wszystkie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementy na ekranie ostatecznie bazują na HWND.</span><span class="sxs-lookup"><span data-stu-id="7f797-136">All [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements on the screen are ultimately backed by a HWND.</span></span> <span data-ttu-id="7f797-137">Po utworzeniu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tworzy HWND najwyższego poziomu i używa <xref:System.Windows.Interop.HwndSource> umieścić <xref:System.Windows.Window> i jego [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości wewnątrz HWND.</span><span class="sxs-lookup"><span data-stu-id="7f797-137">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] creates a top-level HWND, and uses an <xref:System.Windows.Interop.HwndSource> to put the <xref:System.Windows.Window> and its [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content inside the HWND.</span></span>  <span data-ttu-id="7f797-138">Pozostała część programu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tego pojedynczej HWND udostępnia zawartość w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7f797-138">The rest of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in the application shares that singular HWND.</span></span> <span data-ttu-id="7f797-139">Wyjątkiem jest menu, kombi pole listy rozwijane i innych wyskakujące okienka.</span><span class="sxs-lookup"><span data-stu-id="7f797-139">An exception is menus, combo box drop downs, and other pop-ups.</span></span> <span data-ttu-id="7f797-140">Te elementy utworzyć własne okno najwyższego poziomu, które jest dlaczego [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu potencjalnie może przejść poza krawędź okna HWND, który go zawiera.</span><span class="sxs-lookup"><span data-stu-id="7f797-140">These elements create their own top-level window, which is why a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu can potentially go past the edge of the window HWND that contains it.</span></span> <span data-ttu-id="7f797-141">Jeśli używasz <xref:System.Windows.Interop.HwndHost> umieścić HWND wewnątrz [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informuje o [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] położenie nowe podrzędne HWND względem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span><span class="sxs-lookup"><span data-stu-id="7f797-141">When you use <xref:System.Windows.Interop.HwndHost> to put an HWND inside [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informs [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] how to position the new child HWND relative to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span></span>  
  
 <span data-ttu-id="7f797-142">Pojęciem do HWND jest przezroczystość wewnątrz i między każdym HWND.</span><span class="sxs-lookup"><span data-stu-id="7f797-142">A related concept to HWND is transparency within and between each HWND.</span></span> <span data-ttu-id="7f797-143">Jest to również omówione w tym temacie [omówienie technologii regionów](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7f797-143">This is also discussed in the topic [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span></span>  
  
<a name="hosting_a_wpf_page"></a>   
## <a name="hosting-wpf-content-in-a-microsoft-win32-window"></a><span data-ttu-id="7f797-144">Hostowanie zawartości WPF w oknie Microsoft Win32</span><span class="sxs-lookup"><span data-stu-id="7f797-144">Hosting WPF Content in a Microsoft Win32 Window</span></span>  
 <span data-ttu-id="7f797-145">Klucz do hostingu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] na [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno jest <xref:System.Windows.Interop.HwndSource> klasy.</span><span class="sxs-lookup"><span data-stu-id="7f797-145">The key to hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="7f797-146">Ta klasa jest zawijana [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno, aby [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości można włączyć do Twojej [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] jako okna podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="7f797-146">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, so that the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content can be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="7f797-147">Następujące podejścia łączy [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w pojedynczej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7f797-147">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="7f797-148">Wdrożenie programu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości (element główny zawartości) jako zarządzanej klasy.</span><span class="sxs-lookup"><span data-stu-id="7f797-148">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (the content root element) as a managed class.</span></span> <span data-ttu-id="7f797-149">Zazwyczaj klasa dziedziczy z jednej z klas, które może zawierać wielu elementów podrzędnych i/lub użyć jako element główny, takich jak <xref:System.Windows.Controls.DockPanel> lub <xref:System.Windows.Controls.Page>.</span><span class="sxs-lookup"><span data-stu-id="7f797-149">Typically, the class inherits from one of the classes that can contain multiple child elements and/or used as a root element, such as <xref:System.Windows.Controls.DockPanel> or <xref:System.Windows.Controls.Page>.</span></span> <span data-ttu-id="7f797-150">W kolejnych krokach tej klasy jest nazywane [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] klasy zawartości i wystąpień klasy są określane jako [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości obiektów.</span><span class="sxs-lookup"><span data-stu-id="7f797-150">In subsequent steps, this class is referred to as the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class, and instances of the class are referred to as [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content objects.</span></span>  
  
2.  <span data-ttu-id="7f797-151">Implementowanie [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacja o [!INCLUDE[TLA2#tla_cppcli](../../../../includes/tla2sharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f797-151">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA2#tla_cppcli](../../../../includes/tla2sharptla-cppcli-md.md)].</span></span> <span data-ttu-id="7f797-152">Jeśli uruchamiasz z istniejącym niezarządzanych [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] aplikacji, możesz je zwykle włączyć do wywoływania z kodu zarządzanego, zmieniając ustawienia projektu, aby uwzględnić `/clr` flagi kompilatora (pełny zakres co mogą być niezbędne do obsługi `/clr`kompilacja nie została opisana w tym temacie).</span><span class="sxs-lookup"><span data-stu-id="7f797-152">If you are starting with an existing unmanaged [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] application, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag (the full scope of what might be necessary to support `/clr` compilation is not described in this topic).</span></span>  
  
3.  <span data-ttu-id="7f797-153">Ustaw model wątkowy do pojedynczego wątku Apartment (STA).</span><span class="sxs-lookup"><span data-stu-id="7f797-153">Set the threading model to Single Threaded Apartment (STA).</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7f797-154"> używa tego modelu wątkowości.</span><span class="sxs-lookup"><span data-stu-id="7f797-154"> uses this threading model.</span></span>  
  
4.  <span data-ttu-id="7f797-155">Obsługa powiadomień WM_CREATE w odpowiedniej procedury okna.</span><span class="sxs-lookup"><span data-stu-id="7f797-155">Handle the WM_CREATE notification in your window procedure.</span></span>  
  
5.  <span data-ttu-id="7f797-156">W ramach obsługi (lub funkcję, która wywołuje program obsługi) wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="7f797-156">Within the handler (or a function that the handler calls), do the following:</span></span>  
  
    1.  <span data-ttu-id="7f797-157">Utwórz nową <xref:System.Windows.Interop.HwndSource> okno nadrzędne HWND obiektu jako jego `parent` parametru.</span><span class="sxs-lookup"><span data-stu-id="7f797-157">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window HWND as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="7f797-158">Utwórz wystąpienie programu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości klasy.</span><span class="sxs-lookup"><span data-stu-id="7f797-158">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="7f797-159">Odwołanie do przypisywania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości obiektu do <xref:System.Windows.Interop.HwndSource> obiektu <xref:System.Windows.Interop.HwndSource.RootVisual%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="7f797-159">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property.</span></span>  
  
    4.  <span data-ttu-id="7f797-160"><xref:System.Windows.Interop.HwndSource> Obiektu <xref:System.Windows.Interop.HwndSource.Handle%2A> właściwość zawiera uchwyt okna (HWND).</span><span class="sxs-lookup"><span data-stu-id="7f797-160">The <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.Handle%2A> property contains the window handle (HWND).</span></span> <span data-ttu-id="7f797-161">Aby dokonać HWND używanego w niezarządzanych część aplikacji, `Handle.ToPointer()` do HWND.</span><span class="sxs-lookup"><span data-stu-id="7f797-161">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
6.  <span data-ttu-id="7f797-162">Implementowanie zarządzanych klasę, która zawiera pola statycznego, który zawiera odwołanie do użytkownika [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości obiektu.</span><span class="sxs-lookup"><span data-stu-id="7f797-162">Implement a managed class that contains a static field that holds a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="7f797-163">Tej klasy można pobrać odwołania do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu zawartości z Twojego [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodu, ale bardziej istotne uniemożliwia Twojej <xref:System.Windows.Interop.HwndSource> przed przypadkowo bezużytecznych.</span><span class="sxs-lookup"><span data-stu-id="7f797-163">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code, but more importantly it prevents your <xref:System.Windows.Interop.HwndSource> from being inadvertently garbage collected.</span></span>  
  
7.  <span data-ttu-id="7f797-164">Odbieranie powiadomień z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości obiektu dołączając obsługi do co najmniej jeden z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości zdarzenia obiektu.</span><span class="sxs-lookup"><span data-stu-id="7f797-164">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object events.</span></span>  
  
8.  <span data-ttu-id="7f797-165">Komunikować się z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu zawartości za pomocą odwołania, który przechowywany w polu statycznym do zestawu właściwości, metody wywołania itp.</span><span class="sxs-lookup"><span data-stu-id="7f797-165">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by using the reference that you stored in the static field to set properties, call methods, etc.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7f797-166">Można wykonać niektóre lub wszystkie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości definicji klasy dla w jednym kroku [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] przy użyciu domyślnej klasy częściowej klasy zawartości, jeśli możesz utworzyć osobny zestaw i odwoływanie się.</span><span class="sxs-lookup"><span data-stu-id="7f797-166">You can do some or all of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class definition for Step One in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] using the default partial class of the content class, if you produce a separate assembly and then reference it.</span></span> <span data-ttu-id="7f797-167">Mimo że zwykle zawierają <xref:System.Windows.Application> obiektu jako część kompilowanie [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] w zestawie nie na końcu za pomocą którego <xref:System.Windows.Application> jako część współdziałanie, możesz użyć przynajmniej jednej klasy głównym dla [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pliki określonego Aby aplikacja i odwołuje się ich klas częściowych.</span><span class="sxs-lookup"><span data-stu-id="7f797-167">Although you typically include an <xref:System.Windows.Application> object as part of compiling the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] into an assembly, you do not end up using that <xref:System.Windows.Application> as part of the interoperation, you just use one or more of the root classes for [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] files referred to by the application and reference their partial classes.</span></span> <span data-ttu-id="7f797-168">W pozostałej części procedura jest zasadniczo podobna do opisanych powyżej.</span><span class="sxs-lookup"><span data-stu-id="7f797-168">The remainder of the procedure is essentially similar to that outlined above.</span></span>  
>   
>  <span data-ttu-id="7f797-169">Każdy z tych kroków przedstawiono przez kod w temacie [wskazówki: Obsługa zawartości WPF w Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="7f797-169">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting WPF Content in Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span></span>  
  
<a name="hosting_an_hwnd"></a>   
## <a name="hosting-a-microsoft-win32-window-in-wpf"></a><span data-ttu-id="7f797-170">Hosting okna Microsoft Win32 na platformie WPF</span><span class="sxs-lookup"><span data-stu-id="7f797-170">Hosting a Microsoft Win32 Window in WPF</span></span>  
 <span data-ttu-id="7f797-171">Klucz do hostingu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna w innych [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość jest <xref:System.Windows.Interop.HwndHost> klasy.</span><span class="sxs-lookup"><span data-stu-id="7f797-171">The key to hosting a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window within other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is the <xref:System.Windows.Interop.HwndHost> class.</span></span> <span data-ttu-id="7f797-172">Ta klasa jest zawijana okna w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementu, którego można dodać do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element drzewa.</span><span class="sxs-lookup"><span data-stu-id="7f797-172">This class wraps the window in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element which can be added to a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element tree.</span></span> <span data-ttu-id="7f797-173"><xref:System.Windows.Interop.HwndHost> obsługuje również [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] który umożliwiają wykonywanie zadań takich jak przetwarzanie komunikatów hostowanej okna.</span><span class="sxs-lookup"><span data-stu-id="7f797-173"><xref:System.Windows.Interop.HwndHost> also supports [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] that allow you to do such tasks as process messages for the hosted window.</span></span> <span data-ttu-id="7f797-174">Podstawowa procedura jest:</span><span class="sxs-lookup"><span data-stu-id="7f797-174">The basic procedure is:</span></span>  
  
1.  <span data-ttu-id="7f797-175">Utwórz drzewo elementu dla [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aplikacji (może być za pomocą kodu lub znacznik).</span><span class="sxs-lookup"><span data-stu-id="7f797-175">Create an element tree for a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application (can be through code or markup).</span></span> <span data-ttu-id="7f797-176">Znaleźć punktu odpowiednie, a dopuszczalna w drzewie element gdzie <xref:System.Windows.Interop.HwndHost> implementacja może być dodany jako element podrzędny.</span><span class="sxs-lookup"><span data-stu-id="7f797-176">Find an appropriate and permissible point in the element tree where the <xref:System.Windows.Interop.HwndHost> implementation can be added as a child element.</span></span> <span data-ttu-id="7f797-177">W pozostałej części następujące kroki ten element jest nazywane rezerwacją elementu.</span><span class="sxs-lookup"><span data-stu-id="7f797-177">In the remainder of these steps, this element is referred to as the reserving element.</span></span>  
  
2.  <span data-ttu-id="7f797-178">Pochodzić od <xref:System.Windows.Interop.HwndHost> do utworzenia obiektu, który zawiera Twoje [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] zawartości.</span><span class="sxs-lookup"><span data-stu-id="7f797-178">Derive from <xref:System.Windows.Interop.HwndHost> to create an object that holds your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>  
  
3.  <span data-ttu-id="7f797-179">W tej grupie hostów, należy zastąpić <xref:System.Windows.Interop.HwndHost> metody <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span><span class="sxs-lookup"><span data-stu-id="7f797-179">In that host class, override the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span></span> <span data-ttu-id="7f797-180">Zwróć HWND hostowanej okna.</span><span class="sxs-lookup"><span data-stu-id="7f797-180">Return the HWND of the hosted window.</span></span> <span data-ttu-id="7f797-181">Możesz chcieć zawijać rzeczywiste doświadczeniach kontrolnych jako okna podrzędnego okna zwrócony; Zawijanie formantów w oknie hosta zapewnia prostą metodę dla Twojego [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości otrzymywać powiadomienia z formantów.</span><span class="sxs-lookup"><span data-stu-id="7f797-181">You might want to wrap the actual control(s) as a child window of the returned window; wrapping the controls in a host window provides a simple way for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to receive notifications from the controls.</span></span> <span data-ttu-id="7f797-182">Ta technika pozwala rozwiązać dla niektórych [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kwestiami dotyczącymi komunikat — Obsługa na granicy formantu hostowanej.</span><span class="sxs-lookup"><span data-stu-id="7f797-182">This technique helps correct for some [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] issues regarding message handling at the hosted control boundary.</span></span>  
  
4.  <span data-ttu-id="7f797-183">Zastąpienie <xref:System.Windows.Interop.HwndHost> metody <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> i <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="7f797-183">Override the <xref:System.Windows.Interop.HwndHost> methods <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> and <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span> <span data-ttu-id="7f797-184">W tym miejscu jest przetwarzanie oczyszczania i usunąć odwołania do zawartości hostowanej, zwłaszcza w przypadku, gdy utworzono odwołania do obiektów niezarządzane.</span><span class="sxs-lookup"><span data-stu-id="7f797-184">The intention here is to process cleanup and remove references to the hosted content, particularly if you created references to unmanaged objects.</span></span>  
  
5.  <span data-ttu-id="7f797-185">W pliku CodeBehind utworzyć wystąpienia formantu hosting klasy i Uczyń elementem podrzędnym elementu rezerwacją.</span><span class="sxs-lookup"><span data-stu-id="7f797-185">In your code-behind file, create an instance of the control hosting class and make it a child of the reserving element.</span></span> <span data-ttu-id="7f797-186">Zwykle takie jak należy użyć programu obsługi zdarzeń <xref:System.Windows.FrameworkElement.Loaded>, lub użyj konstruktora klasy częściowej.</span><span class="sxs-lookup"><span data-stu-id="7f797-186">Typically you would use an event handler such as <xref:System.Windows.FrameworkElement.Loaded>, or use the partial class constructor.</span></span> <span data-ttu-id="7f797-187">Ale można również dodać współdziałanie zawartości za pomocą zachowania w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="7f797-187">But you could also add the interoperation content through a runtime behavior.</span></span>  
  
6.  <span data-ttu-id="7f797-188">Proces wybranych komunikatów okien, takich jak powiadomień dotyczących formantu karty.</span><span class="sxs-lookup"><span data-stu-id="7f797-188">Process selected window messages, such as control notifications.</span></span> <span data-ttu-id="7f797-189">Istnieją dwie metody.</span><span class="sxs-lookup"><span data-stu-id="7f797-189">There are two approaches.</span></span> <span data-ttu-id="7f797-190">Zarówno udostępniają identyczne dostęp do strumienia komunikatów, więc wybór jest przede wszystkim programowania wygody.</span><span class="sxs-lookup"><span data-stu-id="7f797-190">Both provide identical access to the message stream, so your choice is largely a matter of programming convenience.</span></span>  
  
    -   <span data-ttu-id="7f797-191">Przetwarzania dla wszystkich wiadomości (nie tylko komunikatów zamknięcia) w zastąpienia z komunikatu wdrożenie <xref:System.Windows.Interop.HwndHost> metody <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="7f797-191">Implement message processing for all messages (not just shutdown messages) in your override of the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>  
  
    -   <span data-ttu-id="7f797-192">Obsługujący [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element przetwarzania komunikatów Obsługa <xref:System.Windows.Interop.HwndHost.MessageHook> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7f797-192">Have the hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element process the messages by handling the <xref:System.Windows.Interop.HwndHost.MessageHook> event.</span></span> <span data-ttu-id="7f797-193">To zdarzenie jest wywoływane dla każdego komunikatu wysyłanego do procedury okna głównego okna hostowanej.</span><span class="sxs-lookup"><span data-stu-id="7f797-193">This event is raised for every message that is sent to the main window procedure of the hosted window.</span></span>  
  
    -   <span data-ttu-id="7f797-194">Nie można przetworzyć wiadomości z systemu windows, które są poza przy użyciu procesu <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="7f797-194">You cannot process messages from windows that are out of process using <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>  
  
7.  <span data-ttu-id="7f797-195">Komunikować się z okna hostowanej przy użyciu platformy wywołania do wywołania niezarządzanej `SendMessage` funkcji.</span><span class="sxs-lookup"><span data-stu-id="7f797-195">Communicate with the hosted window by using platform invoke to call the unmanaged `SendMessage` function.</span></span>  
  
 <span data-ttu-id="7f797-196">Poniższe kroki tworzy aplikację, która współdziała z myszą.</span><span class="sxs-lookup"><span data-stu-id="7f797-196">Following these steps creates an application that works with mouse input.</span></span> <span data-ttu-id="7f797-197">Można dodać obsługę tabulacji hostowanej okna zaimplementowanie <xref:System.Windows.Interop.IKeyboardInputSink> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="7f797-197">You can add tabbing support for your hosted window by implementing the <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span></span>  
  
 <span data-ttu-id="7f797-198">Każdy z tych kroków przedstawiono przez kod w temacie [wskazówki: hostowanie formantu Win32 na platformie WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="7f797-198">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting a Win32 Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>  
  
### <a name="hwnds-inside-wpf"></a><span data-ttu-id="7f797-199">Wewnątrz parametrów hWnd WPF</span><span class="sxs-lookup"><span data-stu-id="7f797-199">Hwnds Inside WPF</span></span>  
 <span data-ttu-id="7f797-200">Można potraktować <xref:System.Windows.Interop.HwndHost> jako formant specjalnych.</span><span class="sxs-lookup"><span data-stu-id="7f797-200">You can think of <xref:System.Windows.Interop.HwndHost> as a special control.</span></span> <span data-ttu-id="7f797-201">(Z technicznego punktu widzenia <xref:System.Windows.Interop.HwndHost> jest <xref:System.Windows.FrameworkElement> nie pochodzi z klasy, <xref:System.Windows.Controls.Control> klasy, ale mogą zostać uwzględnione formantu do celów współdziałanie.) <xref:System.Windows.Interop.HwndHost> abstracts odpowiadającego [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] rodzaj hostowaną zawartość tak, aby w pozostałej części [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uwzględnia hostowanej zawartości innego obiektu typu formantu, który powinien renderować i przetworzyć danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="7f797-201">(Technically, <xref:System.Windows.Interop.HwndHost> is a <xref:System.Windows.FrameworkElement> derived class, not a <xref:System.Windows.Controls.Control> derived class, but it can be considered a control for purposes of interoperation.) <xref:System.Windows.Interop.HwndHost> abstracts the underlying [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] nature of the hosted content such that the remainder of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considers the hosted content to be another control-like object, which should render and process input.</span></span> <span data-ttu-id="7f797-202"><xref:System.Windows.Interop.HwndHost> Ogólnie rzecz biorąc zachowuje się jak każdy inny [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, chociaż istnieją pewne różnice ważne wokół danych wyjściowych (rysowania i grafiki) oraz danych wejściowych (myszy i klawiatury) opartych na ograniczenia jakie podstawowych parametrów hWnd może obsługiwać.</span><span class="sxs-lookup"><span data-stu-id="7f797-202"><xref:System.Windows.Interop.HwndHost> generally behaves like any other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, although there are some important differences around output (drawing and graphics) and input (mouse and keyboard) based on limitations of what the underlying HWNDs can support.</span></span>  
  
#### <a name="notable-differences-in-output-behavior"></a><span data-ttu-id="7f797-203">Istotnych różnic w zachowaniu danych wyjściowych</span><span class="sxs-lookup"><span data-stu-id="7f797-203">Notable Differences in Output Behavior</span></span>  
  
-   <span data-ttu-id="7f797-204"><xref:System.Windows.FrameworkElement>, która jest <xref:System.Windows.Interop.HwndHost> klasy podstawowej, ma kilka właściwości, które określają zmiany do interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7f797-204"><xref:System.Windows.FrameworkElement>, which is the <xref:System.Windows.Interop.HwndHost> base class, has quite a few properties that imply changes to the UI.</span></span> <span data-ttu-id="7f797-205">Te właściwości obejmują takie jak <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, który zmienia układ elementów wewnątrz tego elementu jako elementu nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="7f797-205">These include properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, which changes the layout of elements within that element as a parent.</span></span> <span data-ttu-id="7f797-206">Jednak większość tych właściwości nie są mapowane na możliwości [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] ekwiwalenty, nawet jeśli ekwiwalentu może istnieć.</span><span class="sxs-lookup"><span data-stu-id="7f797-206">However, most of these properties are not mapped to possible [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] equivalents, even if such equivalents might exist.</span></span> <span data-ttu-id="7f797-207">Zbyt wiele z tych właściwości i ich znaczenie są zbyt technologii renderowania specyficzne dla mapowań praktyczne.</span><span class="sxs-lookup"><span data-stu-id="7f797-207">Too many of these properties and their meanings are too rendering-technology specific for mappings to be practical.</span></span> <span data-ttu-id="7f797-208">W związku z tym, takie jak ustawienie właściwości <xref:System.Windows.FrameworkElement.FlowDirection%2A> na <xref:System.Windows.Interop.HwndHost> nie ma wpływu.</span><span class="sxs-lookup"><span data-stu-id="7f797-208">Therefore, setting properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A> on <xref:System.Windows.Interop.HwndHost> has no effect.</span></span>  
  
-   <span data-ttu-id="7f797-209"><xref:System.Windows.Interop.HwndHost> nie może być obracany, skalowana, spowodowałoby zafałszowanie lub w inny sposób wpływ transformacji.</span><span class="sxs-lookup"><span data-stu-id="7f797-209"><xref:System.Windows.Interop.HwndHost> cannot be rotated, scaled, skewed, or otherwise affected by a Transform.</span></span>  
  
-   <span data-ttu-id="7f797-210"><xref:System.Windows.Interop.HwndHost> nie obsługuje <xref:System.Windows.UIElement.Opacity%2A> właściwości (przenikanie alfa).</span><span class="sxs-lookup"><span data-stu-id="7f797-210"><xref:System.Windows.Interop.HwndHost> does not support the <xref:System.Windows.UIElement.Opacity%2A> property (alpha blending).</span></span> <span data-ttu-id="7f797-211">Jeśli zawartości wewnątrz <xref:System.Windows.Interop.HwndHost> wykonuje <xref:System.Drawing> operacje, które zawierają dane alfa, który sam nie jest to naruszenie, ale <xref:System.Windows.Interop.HwndHost> jako całość obsługuje tylko nieprzezroczystość = 1.0 (100%).</span><span class="sxs-lookup"><span data-stu-id="7f797-211">If content inside the <xref:System.Windows.Interop.HwndHost> performs <xref:System.Drawing> operations that include alpha information, that is itself not a violation, but the <xref:System.Windows.Interop.HwndHost> as a whole only supports Opacity = 1.0 (100%).</span></span>  
  
-   <span data-ttu-id="7f797-212"><xref:System.Windows.Interop.HwndHost> pojawi się na drugim [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementów w tym samym oknie najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="7f797-212"><xref:System.Windows.Interop.HwndHost> will appear on top of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements in the same top-level window.</span></span> <span data-ttu-id="7f797-213">Jednak <xref:System.Windows.Controls.ToolTip> lub <xref:System.Windows.Controls.ContextMenu> wygenerowanego menu jest osobnym oknie najwyższego poziomu, a więc będzie działać prawidłowo z <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="7f797-213">However, a <xref:System.Windows.Controls.ToolTip> or <xref:System.Windows.Controls.ContextMenu> generated menu is a separate top-level window, and so will behave correctly with <xref:System.Windows.Interop.HwndHost>.</span></span>  
  
-   <span data-ttu-id="7f797-214"><xref:System.Windows.Interop.HwndHost> nie przestrzega obszaru przycinania nadrzędnego <xref:System.Windows.UIElement>.</span><span class="sxs-lookup"><span data-stu-id="7f797-214"><xref:System.Windows.Interop.HwndHost> does not respect the clipping region of its parent <xref:System.Windows.UIElement>.</span></span> <span data-ttu-id="7f797-215">Prawdopodobnie jest to problem, jeśli próba umieszczenia <xref:System.Windows.Interop.HwndHost> klasy w regionie przewijania lub <xref:System.Windows.Controls.Canvas>.</span><span class="sxs-lookup"><span data-stu-id="7f797-215">This is potentially an issue if you attempt to put an <xref:System.Windows.Interop.HwndHost> class inside a scrolling region or <xref:System.Windows.Controls.Canvas>.</span></span>  
  
#### <a name="notable-differences-in-input-behavior"></a><span data-ttu-id="7f797-216">Istotnych różnic w zachowaniu wejściowych</span><span class="sxs-lookup"><span data-stu-id="7f797-216">Notable Differences in Input Behavior</span></span>  
  
-   <span data-ttu-id="7f797-217">Ogólnie, gdy urządzenia wejściowe do zakresu w ramach <xref:System.Windows.Interop.HwndHost> hostowane [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regionu, zdarzenia wejściowe przejść bezpośrednio do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7f797-217">In general, while input devices are scoped within the <xref:System.Windows.Interop.HwndHost> hosted [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, input events go directly to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span></span>  
  
-   <span data-ttu-id="7f797-218">Gdy wskaźnik myszy znajduje się nad <xref:System.Windows.Interop.HwndHost>, aplikacja nie otrzyma [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zdarzenia myszy, a wartość [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] właściwości <xref:System.Windows.UIElement.IsMouseOver%2A> będzie `false`.</span><span class="sxs-lookup"><span data-stu-id="7f797-218">While the mouse is over the <xref:System.Windows.Interop.HwndHost>, your application does not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mouse events, and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsMouseOver%2A> will be `false`.</span></span>  
  
-   <span data-ttu-id="7f797-219">Podczas <xref:System.Windows.Interop.HwndHost> ma fokus klawiatury, aplikacja nie będzie odbierać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] klawiatury zdarzenia i wartość [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] właściwości <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> będzie `false`.</span><span class="sxs-lookup"><span data-stu-id="7f797-219">While the <xref:System.Windows.Interop.HwndHost> has keyboard focus, your application will not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard events and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> will be `false`.</span></span>  
  
-   <span data-ttu-id="7f797-220">Gdy fokus jest w <xref:System.Windows.Interop.HwndHost> i zmiany inny formant wewnątrz <xref:System.Windows.Interop.HwndHost>, aplikacja nie będzie odbierać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zdarzenia <xref:System.Windows.UIElement.GotFocus> lub <xref:System.Windows.UIElement.LostFocus>.</span><span class="sxs-lookup"><span data-stu-id="7f797-220">When focus is within the <xref:System.Windows.Interop.HwndHost> and changes to another control inside the <xref:System.Windows.Interop.HwndHost>, your application will not receive the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus>.</span></span>  
  
-   <span data-ttu-id="7f797-221">Związane z pióro właściwości i zdarzeń są podobne i nie będą zgłaszać informacji, gdy pióro znajduje się nad <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="7f797-221">Related stylus properties and events are analogous, and do not report information while the stylus is over <xref:System.Windows.Interop.HwndHost>.</span></span>  
  
<a name="tabbing_mnemonics_accelerators"></a>   
## <a name="tabbing-mnemonics-and-accelerators"></a><span data-ttu-id="7f797-222">Klawisza TAB, klawiszy skrótu i akceleratorami</span><span class="sxs-lookup"><span data-stu-id="7f797-222">Tabbing, Mnemonics, and Accelerators</span></span>  
 <span data-ttu-id="7f797-223"><xref:System.Windows.Interop.IKeyboardInputSink> i <xref:System.Windows.Interop.IKeyboardInputSite> interfejsów pozwala na tworzenie środowisko bezproblemowe klawiatury dla mieszanym [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikacji:</span><span class="sxs-lookup"><span data-stu-id="7f797-223">The <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces allow you to create a seamless keyboard experience for mixed [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications:</span></span>  
  
-   <span data-ttu-id="7f797-224">Przełączania między [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] składników</span><span class="sxs-lookup"><span data-stu-id="7f797-224">Tabbing between [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] components</span></span>  
  
-   <span data-ttu-id="7f797-225">Klawiszy skrótu i akceleratorów, które działa zarówno, gdy fokus jest w składniku Win32 i jest w składniku WPF.</span><span class="sxs-lookup"><span data-stu-id="7f797-225">Mnemonics and accelerators that work both when focus is within a Win32 component and when it is within a WPF component.</span></span>  
  
 <span data-ttu-id="7f797-226"><xref:System.Windows.Interop.HwndHost> i <xref:System.Windows.Interop.HwndSource> klasy zarówno zawierać implementacje używanych <xref:System.Windows.Interop.IKeyboardInputSink>, ale ich nie może obsługiwać wszystkie komunikaty wejściowe dla bardziej zaawansowanych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="7f797-226">The <xref:System.Windows.Interop.HwndHost> and <xref:System.Windows.Interop.HwndSource> classes both provide implementations of <xref:System.Windows.Interop.IKeyboardInputSink>, but they may not handle all the input messages that you want for more advanced scenarios.</span></span> <span data-ttu-id="7f797-227">Zastąpienie odpowiedniej metody w celu uzyskania zachowanie klawiatury, który ma.</span><span class="sxs-lookup"><span data-stu-id="7f797-227">Override the appropriate methods to get the keyboard behavior you want.</span></span>  
  
 <span data-ttu-id="7f797-228">Interfejsy tylko zapewnić obsługę co się dzieje w przypadku przejścia między [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regionów.</span><span class="sxs-lookup"><span data-stu-id="7f797-228">The interfaces only provide support for what happens on the transition between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regions.</span></span> <span data-ttu-id="7f797-229">W ramach [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regionu, klawisza TAB zachowanie jest całkowicie kontrolowane przez [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] zaimplementowana logikę klawisza TAB, jeśli istnieje.</span><span class="sxs-lookup"><span data-stu-id="7f797-229">Within the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, tabbing behavior is entirely controlled by the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] implemented logic for tabbing, if any.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7f797-230">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="7f797-230">See Also</span></span>  
 <xref:System.Windows.Interop.HwndHost>  
 <xref:System.Windows.Interop.HwndSource>  
 <xref:System.Windows.Interop>  
 [<span data-ttu-id="7f797-231">Przewodnik: hosting kontrolki Win32 w WPF</span><span class="sxs-lookup"><span data-stu-id="7f797-231">Walkthrough: Hosting a Win32 Control in WPF</span></span>](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md)  
 [<span data-ttu-id="7f797-232">Przewodnik: hosting zawartości WPF w Win32</span><span class="sxs-lookup"><span data-stu-id="7f797-232">Walkthrough: Hosting WPF Content in Win32</span></span>](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md)
