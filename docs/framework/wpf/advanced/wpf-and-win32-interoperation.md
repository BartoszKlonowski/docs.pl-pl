---
title: WPF i Win32 — Współdziałanie
ms.date: 03/30/2017
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
- HWND interop [WPF]
- Win32 code [WPF], WPF interoperation
- interoperability [WPF], Win32
ms.assetid: 0ffbde0d-701d-45a3-a6fa-dd71f4d9772e
ms.openlocfilehash: c66003a692cd6d54e62491ed7c32970162452b3e
ms.sourcegitcommit: 581ab03291e91983459e56e40ea8d97b5189227e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/27/2019
ms.locfileid: "70041023"
---
# <a name="wpf-and-win32-interoperation"></a><span data-ttu-id="3a5ab-102">WPF i Win32 — Współdziałanie</span><span class="sxs-lookup"><span data-stu-id="3a5ab-102">WPF and Win32 Interoperation</span></span>

<span data-ttu-id="3a5ab-103">Ten temat zawiera omówienie współpracy [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodu.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-103">This topic provides an overview of how to interoperate [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span> [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="3a5ab-104">oferuje bogate środowisko do tworzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-104">provides a rich environment for creating applications.</span></span> <span data-ttu-id="3a5ab-105">Jeśli jednak masz znaczną inwestycję w [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] kod, może być bardziej efektywne ponowne użycie części tego kodu.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-105">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to reuse some of that code.</span></span>

<a name="basics"></a>

## <a name="wpf-and-win32-interoperation-basics"></a><span data-ttu-id="3a5ab-106">Podstawowe informacje dotyczące WPF i Win32</span><span class="sxs-lookup"><span data-stu-id="3a5ab-106">WPF and Win32 Interoperation Basics</span></span>

<span data-ttu-id="3a5ab-107">Istnieją dwie podstawowe techniki komunikacji między programami [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i. [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3a5ab-107">There are two basic techniques for interoperation between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>

- <span data-ttu-id="3a5ab-108">Zawartość [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] hosta[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] w oknie.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-108">Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="3a5ab-109">Dzięki tej metodzie można korzystać z zaawansowanych możliwości [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] grafiki w ramach standardowego [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-109">With this technique, you can use the advanced graphics capabilities of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within the framework of a standard [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window and application.</span></span>

- <span data-ttu-id="3a5ab-110">Hostowanie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] okna w zawartości. [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3a5ab-110">Host a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3a5ab-111">Korzystając z tej techniki, można użyć istniejącej kontrolki [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] niestandardowej w kontekście innej [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości i przekazać dane między granicami.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-111">With this technique, you can use an existing custom [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control in the context of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and pass data across the boundaries.</span></span>

<span data-ttu-id="3a5ab-112">Każda z tych technik jest koncepcyjnie wprowadzana w tym temacie.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-112">Each of these techniques is conceptually introduced in this topic.</span></span> <span data-ttu-id="3a5ab-113">Aby zapoznać się z bardziej zorientowanym na kod ilustracją hostingu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w [programie [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], zobacz Przewodnik: Hosting zawartości WPF w Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-113">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], see [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span> <span data-ttu-id="3a5ab-114">Aby zapoznać się z bardziej zorientowanym na kod ilustracją hostingu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] w [programie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], zobacz Przewodnik: Hostowanie kontrolki Win32 w](walkthrough-hosting-a-win32-control-in-wpf.md)WPF.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-114">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>

<a name="projects"></a>

## <a name="wpf-interoperation-projects"></a><span data-ttu-id="3a5ab-115">Projekty międzyoperacyjności WPF</span><span class="sxs-lookup"><span data-stu-id="3a5ab-115">WPF Interoperation Projects</span></span>

[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="3a5ab-116">Interfejsy API są kodem zarządzanym, ale [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] większość istniejących programów jest zapisywana jako niezarządzana. C++</span><span class="sxs-lookup"><span data-stu-id="3a5ab-116">APIs are managed code, but most existing [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programs are written in unmanaged C++.</span></span>  <span data-ttu-id="3a5ab-117">Nie można wywoływać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] interfejsów API z poziomu prawdziwy program niezarządzany.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-117">You cannot call [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] APIs from a true unmanaged program.</span></span> <span data-ttu-id="3a5ab-118">Jednak korzystając `/clr` [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)] z opcji z kompilatorem, można utworzyć niezarządzany program, który pozwala bezproblemowo mieszać zarządzane i niezarządzane wywołania interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-118">However, by using the `/clr` option with the [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)] compiler, you can create a mixed managed-unmanaged program where you can seamlessly mix managed and unmanaged API calls.</span></span>

<span data-ttu-id="3a5ab-119">Jedną skomplikowanie na poziomie projektu jest to, że nie [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] można kompilować plików C++ w projekcie.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-119">One project-level complication is that you cannot compile [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] files into a C++ project.</span></span>  <span data-ttu-id="3a5ab-120">Istnieje kilka technik dzielenia projektu, aby zrekompensować te.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-120">There are several project division techniques to compensate for this.</span></span>

- <span data-ttu-id="3a5ab-121">Utwórz C# bibliotekę DLL, która zawiera wszystkie [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] strony jako skompilowany zestaw, a następnie Dodaj do C++ pliku wykonywalnego tę bibliotekę DLL jako odwołanie.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-121">Create a C# DLL that contains all your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pages as a compiled assembly, and then have your C++ executable include that DLL as a reference.</span></span>

- <span data-ttu-id="3a5ab-122">Utwórz C# plik wykonywalny dla [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości i odwołuje się do C++ biblioteki DLL, która zawiera [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] zawartość.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-122">Create a C# executable for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and have it reference a C++ DLL that contains the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>

- <span data-ttu-id="3a5ab-123">Użyj <xref:System.Windows.Markup.XamlReader.Load%2A> ,aby[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] załadować dowolne w czasie wykonywania, zamiast kompilować. [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3a5ab-123">Use <xref:System.Windows.Markup.XamlReader.Load%2A> to load any [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at run time, instead of compiling your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>

- <span data-ttu-id="3a5ab-124">Nie używaj [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] wcale i napisz [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] cały kod w kodzie, tworząc drzewo elementów z <xref:System.Windows.Application>.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-124">Do not use [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at all, and write all your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in code, building up the element tree from <xref:System.Windows.Application>.</span></span>

<span data-ttu-id="3a5ab-125">Użyj dowolnych rozwiązań, które najlepiej sprawdzają się.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-125">Use whatever approach works best for you.</span></span>

> [!NOTE]
> <span data-ttu-id="3a5ab-126">Jeśli wcześniej nie korzystasz C++z/CLI, możesz zauważyć kilka słów kluczowych "New", takich `gcnew` jak `nullptr` i w przykładach kodu międzyoperacyjnego.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-126">If you have not used C++/CLI before, you might notice some "new" keywords such as `gcnew` and `nullptr` in the interoperation code examples.</span></span> <span data-ttu-id="3a5ab-127">Te słowa kluczowe zastępują starszej składni podwójnego podkreślenia`__gc`() i zapewniają bardziej naturalną składnię kodu zarządzanego C++w programie.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-127">These keywords supersede the older double-underscore syntax (`__gc`) and provide a more natural syntax for managed code in C++.</span></span>  <span data-ttu-id="3a5ab-128">Aby dowiedzieć się więcej C++o funkcjach zarządzanych przez/CLI, zobacz [rozszerzenia składników dla platform środowiska uruchomieniowego](/cpp/windows/component-extensions-for-runtime-platforms) i [Hello, C++/CLI](https://go.microsoft.com/fwlink/?LinkId=98739).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-128">To learn more about the C++/CLI managed features, see [Component Extensions for Runtime Platforms](/cpp/windows/component-extensions-for-runtime-platforms) and [Hello, C++/CLI](https://go.microsoft.com/fwlink/?LinkId=98739).</span></span>

<a name="hwnds"></a>

## <a name="how-wpf-uses-hwnds"></a><span data-ttu-id="3a5ab-129">Jak WPF używa HWND</span><span class="sxs-lookup"><span data-stu-id="3a5ab-129">How WPF Uses Hwnds</span></span>

<span data-ttu-id="3a5ab-130">Aby najlepiej [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] wykorzystać wartość "HWND Interop", musisz zrozumieć, jak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] używać HWND.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-130">To make the most of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] "HWND interop", you need to understand how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses HWNDs.</span></span> <span data-ttu-id="3a5ab-131">Dla dowolnego elementu HWND nie można mieszać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] renderowania przy użyciu renderowania DirectX lub renderowania GDI/GDI+.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-131">For any HWND, you cannot mix [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering with DirectX rendering or GDI / GDI+ rendering.</span></span> <span data-ttu-id="3a5ab-132">Ma to wiele konsekwencji.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-132">This has a number of implications.</span></span> <span data-ttu-id="3a5ab-133">Przede wszystkim, aby mieszać te modele renderingu, należy utworzyć rozwiązanie międzyoperacyjne i użyć wydzielonych segmentów międzyoperacyjnych dla każdego modelu renderowania, który będzie używany.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-133">Primarily, in order to mix these rendering models at all, you must create an interoperation solution, and use designated segments of interoperation for each rendering model that you choose to use.</span></span> <span data-ttu-id="3a5ab-134">Ponadto zachowanie renderowania tworzy ograniczenie "miejsce do obsługi" dla tego, co może być realizowane w rozwiązaniu międzyoperacyjnym.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-134">Also, the rendering behavior creates an "airspace" restriction for what your interoperation solution can accomplish.</span></span> <span data-ttu-id="3a5ab-135">Pojęcie "miejsce w sieci" jest wyjaśnione szczegółowo w temacie [Omówienie regionów technologicznych](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-135">The "airspace" concept is explained in greater detail in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>

<span data-ttu-id="3a5ab-136">Wszystkie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementy na ekranie są ostatecznie obsługiwane przez właściwość HWND.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-136">All [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements on the screen are ultimately backed by a HWND.</span></span> <span data-ttu-id="3a5ab-137"><xref:System.Windows.Interop.HwndSource> Gdytworzysz<xref:System.Windows.Window> , program [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tworzy właściwość HWND najwyższego poziomu i używa do umieszczania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] i jego zawartości wewnątrz elementu HWND. <xref:System.Windows.Window> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3a5ab-137">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] creates a top-level HWND, and uses an <xref:System.Windows.Interop.HwndSource> to put the <xref:System.Windows.Window> and its [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content inside the HWND.</span></span>  <span data-ttu-id="3a5ab-138">Pozostała część [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości w aplikacji ma udział w pojedynczej wartości HWND.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-138">The rest of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in the application shares that singular HWND.</span></span> <span data-ttu-id="3a5ab-139">Wyjątkiem są menu, listy rozwijane pól kombi i inne wyskakujące okienka.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-139">An exception is menus, combo box drop downs, and other pop-ups.</span></span> <span data-ttu-id="3a5ab-140">Te elementy tworzą własne okno najwyższego poziomu, dlatego [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu może potencjalnie przejść do krawędzi HWND okna, która go zawiera.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-140">These elements create their own top-level window, which is why a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu can potentially go past the edge of the window HWND that contains it.</span></span> <span data-ttu-id="3a5ab-141">Gdy <xref:System.Windows.Interop.HwndHost> używasz, aby umieścić Właściwość HWND wewnątrz [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informuje [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] , jak ustawić położenie nowego elementu podrzędnego HWND względem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-141">When you use <xref:System.Windows.Interop.HwndHost> to put an HWND inside [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informs [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] how to position the new child HWND relative to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span></span>

<span data-ttu-id="3a5ab-142">Koncepcja powiązana z elementem HWND jest przezroczysta w obrębie i między poszczególnymi elementami HWND.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-142">A related concept to HWND is transparency within and between each HWND.</span></span> <span data-ttu-id="3a5ab-143">Jest to również omówione w temacie [Omówienie regionów technologii](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-143">This is also discussed in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>

<a name="hosting_a_wpf_page"></a>

## <a name="hosting-wpf-content-in-a-microsoft-win32-window"></a><span data-ttu-id="3a5ab-144">Hosting zawartości WPF w oknie Microsoft Win32</span><span class="sxs-lookup"><span data-stu-id="3a5ab-144">Hosting WPF Content in a Microsoft Win32 Window</span></span>

<span data-ttu-id="3a5ab-145">Kluczem do hostowania [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] w oknie jest <xref:System.Windows.Interop.HwndSource> Klasa.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-145">The key to hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="3a5ab-146">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Ta klasa otacza [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] zawartość [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna, dzięki czemu zawartośćmożebyćdołączanadooknajakopodrzędnego.[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3a5ab-146">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, so that the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content can be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="3a5ab-147">Poniższe podejście łączy [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w pojedynczej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-147">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>

1. <span data-ttu-id="3a5ab-148">Zaimplementuj [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartość (element główny zawartości) jako klasę zarządzaną.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-148">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (the content root element) as a managed class.</span></span> <span data-ttu-id="3a5ab-149">Zazwyczaj Klasa dziedziczy z jednej z klas, które mogą zawierać wiele elementów podrzędnych i/lub użyć jako elementu głównego, takiego jak <xref:System.Windows.Controls.DockPanel> lub. <xref:System.Windows.Controls.Page></span><span class="sxs-lookup"><span data-stu-id="3a5ab-149">Typically, the class inherits from one of the classes that can contain multiple child elements and/or used as a root element, such as <xref:System.Windows.Controls.DockPanel> or <xref:System.Windows.Controls.Page>.</span></span> <span data-ttu-id="3a5ab-150">W kolejnych krokach Klasa ta jest nazywana [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] klasą zawartości, a wystąpienia klasy są określane jako [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiekty zawartości.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-150">In subsequent steps, this class is referred to as the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class, and instances of the class are referred to as [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content objects.</span></span>

2. <span data-ttu-id="3a5ab-151">Implementowanie aplikacji systemu Windows C++za pomocą/CLI.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-151">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="3a5ab-152">Jeśli zaczynasz od istniejącej niezarządzanej C++ aplikacji, możesz zwykle włączyć ją do wywołania kodu zarządzanego, zmieniając ustawienia projektu w celu uwzględnienia `/clr` flagi kompilatora (pełen zakres tego, co może być niezbędne do obsługi `/clr` kompilacja nie została opisana w tym temacie).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-152">If you are starting with an existing unmanaged C++ application, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag (the full scope of what might be necessary to support `/clr` compilation is not described in this topic).</span></span>

3. <span data-ttu-id="3a5ab-153">Ustaw model wątkowości na Apartament wielowątkowy (STA).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-153">Set the threading model to Single Threaded Apartment (STA).</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="3a5ab-154">używa tego modelu wątków.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-154">uses this threading model.</span></span>

4. <span data-ttu-id="3a5ab-155">Obsługuj powiadomienie WM_CREATE w procedurze okna.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-155">Handle the WM_CREATE notification in your window procedure.</span></span>

5. <span data-ttu-id="3a5ab-156">W ramach procedury obsługi (lub funkcji, która wywołuje program obsługi), wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="3a5ab-156">Within the handler (or a function that the handler calls), do the following:</span></span>

    1. <span data-ttu-id="3a5ab-157">Utwórz nowy <xref:System.Windows.Interop.HwndSource> obiekt z HWND okna nadrzędnego jako jego `parent` parametru.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-157">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window HWND as its `parent` parameter.</span></span>

    2. <span data-ttu-id="3a5ab-158">Utwórz wystąpienie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] klasy zawartości.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-158">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>

    3. <span data-ttu-id="3a5ab-159">Przypisz odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu Content <xref:System.Windows.Interop.HwndSource> do właściwości Object <xref:System.Windows.Interop.HwndSource.RootVisual%2A> .</span><span class="sxs-lookup"><span data-stu-id="3a5ab-159">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property.</span></span>

    4. <span data-ttu-id="3a5ab-160">Właściwość <xref:System.Windows.Interop.HwndSource> Object<xref:System.Windows.Interop.HwndSource.Handle%2A> zawiera uchwyt okna (HWND).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-160">The <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.Handle%2A> property contains the window handle (HWND).</span></span> <span data-ttu-id="3a5ab-161">Aby uzyskać Właściwość HWND, która może być używana w niezarządzanej części aplikacji, Rzutowanie `Handle.ToPointer()` na Właściwość HWND.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-161">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>

6. <span data-ttu-id="3a5ab-162">Zaimplementuj zarządzaną klasę, która zawiera pole statyczne, które przechowuje odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu zawartości.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-162">Implement a managed class that contains a static field that holds a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="3a5ab-163">Ta klasa pozwala uzyskać odwołanie do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu zawartości [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] z kodu, ale co <xref:System.Windows.Interop.HwndSource> ważniejsze, zapobiega przypadkowemu wykorzystaniu elementów bezużytecznych.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-163">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code, but more importantly it prevents your <xref:System.Windows.Interop.HwndSource> from being inadvertently garbage collected.</span></span>

7. <span data-ttu-id="3a5ab-164">Odbieraj powiadomienia z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektu Content, dołączając procedurę obsługi do co najmniej jednego [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zdarzenia obiektu zawartości.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-164">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object events.</span></span>

8. <span data-ttu-id="3a5ab-165">Komunikuj się z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obiektem Content przy użyciu odwołania przechowywanego w polu statycznym, aby ustawić właściwości, wywołać metody itd.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-165">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by using the reference that you stored in the static field to set properties, call methods, etc.</span></span>

> [!NOTE]
> <span data-ttu-id="3a5ab-166">Można wykonać niektóre lub wszystkie [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] definicje klas zawartości dla kroku jeden w [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] , używając domyślnej klasy częściowej klasy zawartości, jeśli tworzysz oddzielny zestaw, a następnie odwołując się do niego.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-166">You can do some or all of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class definition for Step One in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] using the default partial class of the content class, if you produce a separate assembly and then reference it.</span></span> <span data-ttu-id="3a5ab-167">Mimo że zwykle zawierany <xref:System.Windows.Application> jest obiekt w ramach [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] kompilowania do zestawu, nie można zakończyć korzystania z tego <xref:System.Windows.Application> elementu w ramach operacji międzyoperacyjnego. wystarczy użyć co najmniej jednej klasy głównej dla plików o [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] określonych do aplikacji i odwoływanie się do ich klas częściowych.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-167">Although you typically include an <xref:System.Windows.Application> object as part of compiling the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] into an assembly, you do not end up using that <xref:System.Windows.Application> as part of the interoperation, you just use one or more of the root classes for [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] files referred to by the application and reference their partial classes.</span></span> <span data-ttu-id="3a5ab-168">Pozostała część procedury jest zasadniczo podobna do przedstawionej powyżej.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-168">The remainder of the procedure is essentially similar to that outlined above.</span></span>
>
> <span data-ttu-id="3a5ab-169">Każdy z tych kroków ilustruje kod w instruktażu tematu [: Hosting zawartości WPF w Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-169">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span>

<a name="hosting_an_hwnd"></a>

## <a name="hosting-a-microsoft-win32-window-in-wpf"></a><span data-ttu-id="3a5ab-170">Hosting okna środowiska Microsoft Win32 w WPF</span><span class="sxs-lookup"><span data-stu-id="3a5ab-170">Hosting a Microsoft Win32 Window in WPF</span></span>

<span data-ttu-id="3a5ab-171">Kluczem do hostowania [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna w innej [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zawartości jest <xref:System.Windows.Interop.HwndHost> Klasa.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-171">The key to hosting a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window within other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is the <xref:System.Windows.Interop.HwndHost> class.</span></span> <span data-ttu-id="3a5ab-172">Ta klasa otacza okno w [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elemencie, który można dodać [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do drzewa elementów.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-172">This class wraps the window in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element which can be added to a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element tree.</span></span> <span data-ttu-id="3a5ab-173"><xref:System.Windows.Interop.HwndHost>Program obsługuje również interfejsy API, które umożliwiają wykonywanie takich zadań jako komunikatów przetwarzanych dla hostowanego okna.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-173"><xref:System.Windows.Interop.HwndHost> also supports APIs that allow you to do such tasks as process messages for the hosted window.</span></span> <span data-ttu-id="3a5ab-174">Podstawowa procedura:</span><span class="sxs-lookup"><span data-stu-id="3a5ab-174">The basic procedure is:</span></span>

1. <span data-ttu-id="3a5ab-175">Utwórz drzewo elementów dla [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aplikacji (może być za pomocą kodu lub znaczników).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-175">Create an element tree for a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application (can be through code or markup).</span></span> <span data-ttu-id="3a5ab-176">Znajdź odpowiedni i dopuszczalny punkt w drzewie elementów, w którym <xref:System.Windows.Interop.HwndHost> można dodać implementację jako element podrzędny.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-176">Find an appropriate and permissible point in the element tree where the <xref:System.Windows.Interop.HwndHost> implementation can be added as a child element.</span></span> <span data-ttu-id="3a5ab-177">W pozostałej części tych kroków ten element jest określany jako rezerwowy element.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-177">In the remainder of these steps, this element is referred to as the reserving element.</span></span>

2. <span data-ttu-id="3a5ab-178">Utwórz obiekt, który [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] przechowuje zawartość. <xref:System.Windows.Interop.HwndHost></span><span class="sxs-lookup"><span data-stu-id="3a5ab-178">Derive from <xref:System.Windows.Interop.HwndHost> to create an object that holds your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>

3. <span data-ttu-id="3a5ab-179">W tej klasie hosta Zastąp <xref:System.Windows.Interop.HwndHost> metodę. <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A></span><span class="sxs-lookup"><span data-stu-id="3a5ab-179">In that host class, override the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span></span> <span data-ttu-id="3a5ab-180">Zwraca wartość HWND okna hostowanego.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-180">Return the HWND of the hosted window.</span></span> <span data-ttu-id="3a5ab-181">Możesz chcieć otoczyć rzeczywiste formanty jako oknem podrzędnym zwróconego okna; Zawijanie formantów w oknie hosta zapewnia prostą metodę [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] otrzymywania powiadomień z kontrolek.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-181">You might want to wrap the actual control(s) as a child window of the returned window; wrapping the controls in a host window provides a simple way for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to receive notifications from the controls.</span></span> <span data-ttu-id="3a5ab-182">Ta technika ułatwia rozwiązywanie [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] problemów dotyczących obsługi komunikatów na granicy hostowanej kontroli.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-182">This technique helps correct for some [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] issues regarding message handling at the hosted control boundary.</span></span>

4. <span data-ttu-id="3a5ab-183">Zastąp <xref:System.Windows.Interop.HwndHost> metody <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> i <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-183">Override the <xref:System.Windows.Interop.HwndHost> methods <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> and <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span> <span data-ttu-id="3a5ab-184">Zamiarem tego procesu jest przetworzenie oczyszczania i usunięcie odwołań do hostowanej zawartości, szczególnie w przypadku utworzenia odwołań do obiektów niezarządzanych.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-184">The intention here is to process cleanup and remove references to the hosted content, particularly if you created references to unmanaged objects.</span></span>

5. <span data-ttu-id="3a5ab-185">W pliku związanym z kodem Utwórz wystąpienie klasy hostingu kontrolki i Uczyń ją elementem podrzędnym elementu.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-185">In your code-behind file, create an instance of the control hosting class and make it a child of the reserving element.</span></span> <span data-ttu-id="3a5ab-186">Zazwyczaj można użyć programu obsługi zdarzeń, takiego jak <xref:System.Windows.FrameworkElement.Loaded>lub użyć konstruktora klasy częściowej.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-186">Typically you would use an event handler such as <xref:System.Windows.FrameworkElement.Loaded>, or use the partial class constructor.</span></span> <span data-ttu-id="3a5ab-187">Możesz również dodać zawartość międzyoperacyjną za pomocą zachowania środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-187">But you could also add the interoperation content through a runtime behavior.</span></span>

6. <span data-ttu-id="3a5ab-188">Przetwarzaj wybrane komunikaty okna, takie jak powiadomienia sterujące.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-188">Process selected window messages, such as control notifications.</span></span> <span data-ttu-id="3a5ab-189">Istnieją dwie metody.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-189">There are two approaches.</span></span> <span data-ttu-id="3a5ab-190">Oba zapewniają taki sam dostęp do strumienia komunikatów, dzięki czemu wybór jest w dużej mierze wygodnym programowaniem.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-190">Both provide identical access to the message stream, so your choice is largely a matter of programming convenience.</span></span>

    - <span data-ttu-id="3a5ab-191">Zaimplementuj przetwarzanie komunikatów dla wszystkich komunikatów (nie tylko komunikaty zamknięcia) w przesłonięciu <xref:System.Windows.Interop.HwndHost> metody <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-191">Implement message processing for all messages (not just shutdown messages) in your override of the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>

    - <span data-ttu-id="3a5ab-192">Element hostujący [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] przetwarza komunikaty przez <xref:System.Windows.Interop.HwndHost.MessageHook> obsługę zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-192">Have the hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element process the messages by handling the <xref:System.Windows.Interop.HwndHost.MessageHook> event.</span></span> <span data-ttu-id="3a5ab-193">To zdarzenie jest zgłaszane dla każdego komunikatu, który jest wysyłany do procedury okna głównego okna hostowanego.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-193">This event is raised for every message that is sent to the main window procedure of the hosted window.</span></span>

    - <span data-ttu-id="3a5ab-194">Nie można przetwarzać komunikatów z systemu Windows, które nie <xref:System.Windows.Interop.HwndHost.WndProc%2A>są przetwarzane przy użyciu programu.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-194">You cannot process messages from windows that are out of process using <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>

7. <span data-ttu-id="3a5ab-195">Komunikuj się z hostowanym oknem przy użyciu wywołania platformy, aby wywołać `SendMessage` niezarządzaną funkcję.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-195">Communicate with the hosted window by using platform invoke to call the unmanaged `SendMessage` function.</span></span>

<span data-ttu-id="3a5ab-196">Wykonanie tych kroków powoduje utworzenie aplikacji, która współpracuje z myszą wejściową.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-196">Following these steps creates an application that works with mouse input.</span></span> <span data-ttu-id="3a5ab-197">Można dodać obsługę tabulacji dla hostowanego okna przez implementację <xref:System.Windows.Interop.IKeyboardInputSink> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-197">You can add tabbing support for your hosted window by implementing the <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span></span>

<span data-ttu-id="3a5ab-198">Każdy z tych kroków ilustruje kod w instruktażu tematu [: Hostowanie kontrolki Win32 w](walkthrough-hosting-a-win32-control-in-wpf.md)WPF.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-198">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>

### <a name="hwnds-inside-wpf"></a><span data-ttu-id="3a5ab-199">Funkcja HWND wewnątrz WPF</span><span class="sxs-lookup"><span data-stu-id="3a5ab-199">Hwnds Inside WPF</span></span>

<span data-ttu-id="3a5ab-200">Można traktować <xref:System.Windows.Interop.HwndHost> jako specjalną kontrolę.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-200">You can think of <xref:System.Windows.Interop.HwndHost> as a special control.</span></span> <span data-ttu-id="3a5ab-201">(Technicznie <xref:System.Windows.Interop.HwndHost> , <xref:System.Windows.FrameworkElement> jest klasą <xref:System.Windows.Controls.Control> pochodną, a nie klasą pochodną, ale może być traktowana jako kontrolka do celów międzyoperacyjnych). abstrakcyjny podstawowy [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] charakter hostowanej zawartości w taki sposób, że pozostała część [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rozważania hostowanej zawartości jest innym obiektem podobnym do kontrolki, który powinien renderować i przetwarzać dane wejściowe. <xref:System.Windows.Interop.HwndHost></span><span class="sxs-lookup"><span data-stu-id="3a5ab-201">(Technically, <xref:System.Windows.Interop.HwndHost> is a <xref:System.Windows.FrameworkElement> derived class, not a <xref:System.Windows.Controls.Control> derived class, but it can be considered a control for purposes of interoperation.) <xref:System.Windows.Interop.HwndHost> abstracts the underlying [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] nature of the hosted content such that the remainder of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considers the hosted content to be another control-like object, which should render and process input.</span></span> <span data-ttu-id="3a5ab-202"><xref:System.Windows.Interop.HwndHost>zwykle zachowuje się jak inne [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, chociaż istnieją pewne istotne różnice dotyczące danych wyjściowych (rysowania i grafiki) oraz danych wejściowych (myszy i klawiatury) na podstawie ograniczeń, jakie mogą być obsługiwane przez bazowe HWND.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-202"><xref:System.Windows.Interop.HwndHost> generally behaves like any other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, although there are some important differences around output (drawing and graphics) and input (mouse and keyboard) based on limitations of what the underlying HWNDs can support.</span></span>

#### <a name="notable-differences-in-output-behavior"></a><span data-ttu-id="3a5ab-203">Istotne różnice w zachowaniu danych wyjściowych</span><span class="sxs-lookup"><span data-stu-id="3a5ab-203">Notable Differences in Output Behavior</span></span>

- <span data-ttu-id="3a5ab-204"><xref:System.Windows.FrameworkElement>, która jest <xref:System.Windows.Interop.HwndHost> klasą bazową, ma dość kilka właściwości, które oznaczają zmiany w interfejsie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-204"><xref:System.Windows.FrameworkElement>, which is the <xref:System.Windows.Interop.HwndHost> base class, has quite a few properties that imply changes to the UI.</span></span> <span data-ttu-id="3a5ab-205">Należą do nich właściwości, <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>takie jak, które zmieniają układ elementów w tym elemencie jako element nadrzędny.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-205">These include properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, which changes the layout of elements within that element as a parent.</span></span> <span data-ttu-id="3a5ab-206">Jednak większość z tych właściwości nie jest zamapowana na możliwe [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] odpowiedniki, nawet jeśli takie odpowiedniki mogą istnieć.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-206">However, most of these properties are not mapped to possible [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] equivalents, even if such equivalents might exist.</span></span> <span data-ttu-id="3a5ab-207">Zbyt wiele z tych właściwości, a ich znaczenie jest zbyt nieprzydatne, aby mapowania były praktyczne.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-207">Too many of these properties and their meanings are too rendering-technology specific for mappings to be practical.</span></span> <span data-ttu-id="3a5ab-208">W związku z tym Ustawianie właściwości <xref:System.Windows.FrameworkElement.FlowDirection%2A> , <xref:System.Windows.Interop.HwndHost> takich jak on, nie ma żadnego wpływu.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-208">Therefore, setting properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A> on <xref:System.Windows.Interop.HwndHost> has no effect.</span></span>

- <span data-ttu-id="3a5ab-209"><xref:System.Windows.Interop.HwndHost>Przekształcanie nie może być obrócone, skalowane, skośne lub w inny sposób.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-209"><xref:System.Windows.Interop.HwndHost> cannot be rotated, scaled, skewed, or otherwise affected by a Transform.</span></span>

- <span data-ttu-id="3a5ab-210"><xref:System.Windows.Interop.HwndHost>nie obsługuje <xref:System.Windows.UIElement.Opacity%2A> właściwości (Blend alfa).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-210"><xref:System.Windows.Interop.HwndHost> does not support the <xref:System.Windows.UIElement.Opacity%2A> property (alpha blending).</span></span> <span data-ttu-id="3a5ab-211">Jeśli zawartość wewnątrz <xref:System.Windows.Interop.HwndHost> wykonuje <xref:System.Drawing> operacje, które zawierają informacje alfa, które nie są naruszeniem, ale wartość <xref:System.Windows.Interop.HwndHost> jako całość obsługuje tylko nieprzezroczystość = 1,0 (100%).</span><span class="sxs-lookup"><span data-stu-id="3a5ab-211">If content inside the <xref:System.Windows.Interop.HwndHost> performs <xref:System.Drawing> operations that include alpha information, that is itself not a violation, but the <xref:System.Windows.Interop.HwndHost> as a whole only supports Opacity = 1.0 (100%).</span></span>

- <span data-ttu-id="3a5ab-212"><xref:System.Windows.Interop.HwndHost>pojawi się nad innymi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementami w tym samym oknie najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-212"><xref:System.Windows.Interop.HwndHost> will appear on top of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements in the same top-level window.</span></span> <span data-ttu-id="3a5ab-213">Jednak wygenerowane menu jest osobnym oknem najwyższego poziomu i dlatego będzie działać poprawnie z <xref:System.Windows.Interop.HwndHost>. <xref:System.Windows.Controls.ToolTip> <xref:System.Windows.Controls.ContextMenu></span><span class="sxs-lookup"><span data-stu-id="3a5ab-213">However, a <xref:System.Windows.Controls.ToolTip> or <xref:System.Windows.Controls.ContextMenu> generated menu is a separate top-level window, and so will behave correctly with <xref:System.Windows.Interop.HwndHost>.</span></span>

- <span data-ttu-id="3a5ab-214"><xref:System.Windows.Interop.HwndHost>nie respektują regionu wycinka elementu nadrzędnego <xref:System.Windows.UIElement>.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-214"><xref:System.Windows.Interop.HwndHost> does not respect the clipping region of its parent <xref:System.Windows.UIElement>.</span></span> <span data-ttu-id="3a5ab-215">Jest to potencjalnie problem w przypadku próby umieszczenia <xref:System.Windows.Interop.HwndHost> klasy wewnątrz regionu przewijania lub. <xref:System.Windows.Controls.Canvas></span><span class="sxs-lookup"><span data-stu-id="3a5ab-215">This is potentially an issue if you attempt to put an <xref:System.Windows.Interop.HwndHost> class inside a scrolling region or <xref:System.Windows.Controls.Canvas>.</span></span>

#### <a name="notable-differences-in-input-behavior"></a><span data-ttu-id="3a5ab-216">Znaczące różnice w zachowaniu danych wejściowych</span><span class="sxs-lookup"><span data-stu-id="3a5ab-216">Notable Differences in Input Behavior</span></span>

- <span data-ttu-id="3a5ab-217">Ogólnie rzecz biorąc, gdy urządzenia wejściowe są objęte zakresem <xref:System.Windows.Interop.HwndHost> w [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] hostowanym regionie, zdarzenia wejściowe przechodzą bezpośrednio do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3a5ab-217">In general, while input devices are scoped within the <xref:System.Windows.Interop.HwndHost> hosted [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, input events go directly to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span></span>

- <span data-ttu-id="3a5ab-218">Gdy wskaźnik myszy znajduje się nad <xref:System.Windows.Interop.HwndHost>, aplikacja nie odbiera [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] zdarzeń myszy, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] a wartość właściwości <xref:System.Windows.UIElement.IsMouseOver%2A> będzie `false`.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-218">While the mouse is over the <xref:System.Windows.Interop.HwndHost>, your application does not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mouse events, and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsMouseOver%2A> will be `false`.</span></span>

- <span data-ttu-id="3a5ab-219">`false` <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Gdy ma fokus klawiatury, aplikacja nie będzie odbierać zdarzeń klawiatury, a wartość właściwości będzie. <xref:System.Windows.Interop.HwndHost></span><span class="sxs-lookup"><span data-stu-id="3a5ab-219">While the <xref:System.Windows.Interop.HwndHost> has keyboard focus, your application will not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard events and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> will be `false`.</span></span>

- <span data-ttu-id="3a5ab-220">Gdy fokus znajduje się w <xref:System.Windows.Interop.HwndHost> obrębie i zmieni się na inną kontrolkę <xref:System.Windows.Interop.HwndHost>wewnątrz, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aplikacja nie będzie odbierać zdarzeń <xref:System.Windows.UIElement.GotFocus> ani <xref:System.Windows.UIElement.LostFocus>.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-220">When focus is within the <xref:System.Windows.Interop.HwndHost> and changes to another control inside the <xref:System.Windows.Interop.HwndHost>, your application will not receive the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus>.</span></span>

- <span data-ttu-id="3a5ab-221">Powiązane właściwości i zdarzenia pióra są analogiczne i nie raportują informacji, gdy pióro <xref:System.Windows.Interop.HwndHost>jest w stanie.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-221">Related stylus properties and events are analogous, and do not report information while the stylus is over <xref:System.Windows.Interop.HwndHost>.</span></span>

<a name="tabbing_mnemonics_accelerators"></a>

## <a name="tabbing-mnemonics-and-accelerators"></a><span data-ttu-id="3a5ab-222">Tabulacja, skróty i akceleratory</span><span class="sxs-lookup"><span data-stu-id="3a5ab-222">Tabbing, Mnemonics, and Accelerators</span></span>

<span data-ttu-id="3a5ab-223">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Interfejsy i umożliwiają<xref:System.Windows.Interop.IKeyboardInputSite> tworzenie płynnych funkcji klawiatury dla mieszanych i aplikacji: <xref:System.Windows.Interop.IKeyboardInputSink></span><span class="sxs-lookup"><span data-stu-id="3a5ab-223">The <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces allow you to create a seamless keyboard experience for mixed [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications:</span></span>

- <span data-ttu-id="3a5ab-224">Tabulacja między [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] składnikami</span><span class="sxs-lookup"><span data-stu-id="3a5ab-224">Tabbing between [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] components</span></span>

- <span data-ttu-id="3a5ab-225">Skróty i akceleratory, które działają zarówno wtedy, gdy fokus znajduje się w składniku Win32 i gdy znajduje się w składniku WPF.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-225">Mnemonics and accelerators that work both when focus is within a Win32 component and when it is within a WPF component.</span></span>

<span data-ttu-id="3a5ab-226">Klasy <xref:System.Windows.Interop.HwndHost> <xref:System.Windows.Interop.IKeyboardInputSink>i <xref:System.Windows.Interop.HwndSource> umożliwiają implementację programu, ale mogą nie obsługiwać wszystkich komunikatów wejściowych, które są potrzebne w przypadku bardziej zaawansowanych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-226">The <xref:System.Windows.Interop.HwndHost> and <xref:System.Windows.Interop.HwndSource> classes both provide implementations of <xref:System.Windows.Interop.IKeyboardInputSink>, but they may not handle all the input messages that you want for more advanced scenarios.</span></span> <span data-ttu-id="3a5ab-227">Zastąp odpowiednie metody, aby uzyskać żądane zachowanie klawiatury.</span><span class="sxs-lookup"><span data-stu-id="3a5ab-227">Override the appropriate methods to get the keyboard behavior you want.</span></span>

<span data-ttu-id="3a5ab-228">Interfejsy zapewniają obsługę tylko tego [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] , co dzieje się na przejściu między regionami i. [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3a5ab-228">The interfaces only provide support for what happens on the transition between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regions.</span></span> <span data-ttu-id="3a5ab-229">W regionie zachowanie tabulacji jest całkowicie kontrolowane [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] przez zaimplementowaną logikę do tabulacji (jeśli istnieje). [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3a5ab-229">Within the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, tabbing behavior is entirely controlled by the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] implemented logic for tabbing, if any.</span></span>

## <a name="see-also"></a><span data-ttu-id="3a5ab-230">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="3a5ab-230">See also</span></span>

- <xref:System.Windows.Interop.HwndHost>
- <xref:System.Windows.Interop.HwndSource>
- <xref:System.Windows.Interop>
- [<span data-ttu-id="3a5ab-231">Przewodnik: Hosting kontrolki Win32 w WPF</span><span class="sxs-lookup"><span data-stu-id="3a5ab-231">Walkthrough: Hosting a Win32 Control in WPF</span></span>](walkthrough-hosting-a-win32-control-in-wpf.md)
- [<span data-ttu-id="3a5ab-232">Przewodnik: Hosting zawartości WPF w Win32</span><span class="sxs-lookup"><span data-stu-id="3a5ab-232">Walkthrough: Hosting WPF Content in Win32</span></span>](walkthrough-hosting-wpf-content-in-win32.md)
