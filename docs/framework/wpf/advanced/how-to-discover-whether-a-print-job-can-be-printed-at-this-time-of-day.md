---
title: "Jak wykryć czy zadanie drukowania może zostać zrealizowane o tej porze dnia"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
caps.latest.revision: "9"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: ef9da205792823b7069024c5e4a3e9ac80d60a24
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/22/2017
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="a3778-102">Jak wykryć czy zadanie drukowania może zostać zrealizowane o tej porze dnia</span><span class="sxs-lookup"><span data-stu-id="a3778-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="a3778-103">Kolejki wydruku nie zawsze są dostępne przez 24 godziny na dobę.</span><span class="sxs-lookup"><span data-stu-id="a3778-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="a3778-104">Mają one właściwości czasu rozpoczęcia i zakończenia, które można ustawić, aby były niedostępne w pewnych porach dnia.</span><span class="sxs-lookup"><span data-stu-id="a3778-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="a3778-105">Ta funkcja może być używana na przykład zarezerwować drukarek do wyłącznego użytku niektórych działu po 17: 00.</span><span class="sxs-lookup"><span data-stu-id="a3778-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="a3778-106">Działu musi innej kolejki drukarki niż aplikacje innych działów obsługi użycia.</span><span class="sxs-lookup"><span data-stu-id="a3778-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="a3778-107">Czy można ustawić kolejki dla innych działów będzie dostępny od 17: 00, gdy kolejka działu favored można ustawić jako dostępne przez cały czas.</span><span class="sxs-lookup"><span data-stu-id="a3778-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="a3778-108">Ponadto można ustawić zadania drukowania, same do druku tylko w ramach określonego zakresu czasu.</span><span class="sxs-lookup"><span data-stu-id="a3778-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="a3778-109"><xref:System.Printing.PrintQueue> i <xref:System.Printing.PrintSystemJobInfo> klasy widoczne w [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] z [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] umożliwiają zdalne sprawdzania, czy danego zadania drukowania można drukować na danej kolejki w danym momencie.</span><span class="sxs-lookup"><span data-stu-id="a3778-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="a3778-110">Przykład</span><span class="sxs-lookup"><span data-stu-id="a3778-110">Example</span></span>  
 <span data-ttu-id="a3778-111">W poniższym przykładzie jest to przykład przedstawiający diagnozować problemy z zadaniem drukowania.</span><span class="sxs-lookup"><span data-stu-id="a3778-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="a3778-112">Istnieją dwa główne kroki tego rodzaju funkcji w następujący sposób.</span><span class="sxs-lookup"><span data-stu-id="a3778-112">There are two major steps for this kind of function as follows.</span></span>  
  
1.  <span data-ttu-id="a3778-113">Odczyt <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> i <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> właściwości <xref:System.Printing.PrintQueue> do ustalenia, czy bieżący czas jest między nimi.</span><span class="sxs-lookup"><span data-stu-id="a3778-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2.  <span data-ttu-id="a3778-114">Odczyt <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> i <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> właściwości <xref:System.Printing.PrintSystemJobInfo> do ustalenia, czy bieżący czas jest między nimi.</span><span class="sxs-lookup"><span data-stu-id="a3778-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="a3778-115">Ale komplikacji wynikać z faktu, że te właściwości nie są <xref:System.DateTime> obiektów.</span><span class="sxs-lookup"><span data-stu-id="a3778-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="a3778-116">Zamiast tego są one <xref:System.Int32> obiektów, które express godzinę jako liczbę minut od północy.</span><span class="sxs-lookup"><span data-stu-id="a3778-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="a3778-117">Ponadto to nie jest północy w bieżącej strefy czasowej, ale o północy czasu UTC (Coordinated Universal Time).</span><span class="sxs-lookup"><span data-stu-id="a3778-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="a3778-118">W pierwszym przykładzie kodu przedstawiono metody statycznej **ReportQueueAndJobAvailability**, która jest przekazywana <xref:System.Printing.PrintSystemJobInfo> i wywołuje metody pomocnicze, aby określić, czy w danej chwili można drukować zadania i, jeśli nie, jeśli można drukować.</span><span class="sxs-lookup"><span data-stu-id="a3778-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="a3778-119">Zwróć uwagę, że <xref:System.Printing.PrintQueue> nie zostanie przekazany do metody.</span><span class="sxs-lookup"><span data-stu-id="a3778-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="a3778-120">Jest to spowodowane <xref:System.Printing.PrintSystemJobInfo> zawiera odwołanie do kolejki w jego <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="a3778-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="a3778-121">Podrzędny metody obejmują przeciążone **ReportAvailabilityAtThisTime** metodę, która może zająć jedną <xref:System.Printing.PrintQueue> lub <xref:System.Printing.PrintSystemJobInfo> jako parametr.</span><span class="sxs-lookup"><span data-stu-id="a3778-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="a3778-122">Istnieje również **TimeConverter.ConvertToLocalHumanReadableTime**.</span><span class="sxs-lookup"><span data-stu-id="a3778-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="a3778-123">Wszystkie te metody opisano poniżej.</span><span class="sxs-lookup"><span data-stu-id="a3778-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="a3778-124">**ReportQueueAndJobAvailability** metody rozpoczyna się przez sprawdzenie, czy kolejka lub zadanie drukowania jest niedostępny w tej chwili.</span><span class="sxs-lookup"><span data-stu-id="a3778-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="a3778-125">Jeśli jeden z nich jest niedostępny, następnie sprawdza, czy kolejka niedostępny.</span><span class="sxs-lookup"><span data-stu-id="a3778-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="a3778-126">Jeśli nie jest dostępna, metoda zgłasza ten fakt i czasu, gdy kolejka ponownie staną się dostępne.</span><span class="sxs-lookup"><span data-stu-id="a3778-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="a3778-127">Następnie sprawdza zadania i jeśli jest niedostępny, raporty przy następnym span podczas gdy można go wydrukować.</span><span class="sxs-lookup"><span data-stu-id="a3778-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="a3778-128">Na koniec metoda zgłasza najwcześniejszą czas, kiedy zadanie można drukować.</span><span class="sxs-lookup"><span data-stu-id="a3778-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="a3778-129">Jest to po następujące dwa razy.</span><span class="sxs-lookup"><span data-stu-id="a3778-129">This is the later of following two times.</span></span>  
  
-   <span data-ttu-id="a3778-130">Czas, kiedy kolejki wydruku obok jest dostępny.</span><span class="sxs-lookup"><span data-stu-id="a3778-130">The time when the print queue is next available.</span></span>  
  
-   <span data-ttu-id="a3778-131">Czas, kiedy zadanie drukowania obok jest dostępny.</span><span class="sxs-lookup"><span data-stu-id="a3778-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="a3778-132">Podczas raportowania porach dnia, <xref:System.DateTime.ToShortTimeString%2A> metody jest również nazywany, ponieważ ta metoda powoduje pominięcie lat, miesiące i liczba dni korzystania z danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="a3778-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="a3778-133">Nie można ograniczyć dostępności kolejki wydruku lub zadania drukowania do konkretnego lat, miesięcy lub dni.</span><span class="sxs-lookup"><span data-stu-id="a3778-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="a3778-134">Overloads dwa z **ReportAvailabilityAtThisTime** metody są identyczne z wyjątkiem przekazany do nich tylko typ <xref:System.Printing.PrintQueue> wersji znajduje się poniżej.</span><span class="sxs-lookup"><span data-stu-id="a3778-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a3778-135">Fakt, że te metody są identyczne z wyjątkiem typu zgłasza kwestia, dlaczego próbki nie tworzy metody rodzajowej **ReportAvailabilityAtThisTime\<T >**.</span><span class="sxs-lookup"><span data-stu-id="a3778-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="a3778-136">Przyczyną jest to, że taka metoda musi być ograniczone do klasy, która ma **StartTimeOfDay** i **UntilTimeOfDay** właściwości, które wywołuje metodę, ale metoda ogólna tylko może być ograniczone do Pojedyncza klasa i klasy tylko wspólne <xref:System.Printing.PrintQueue> i <xref:System.Printing.PrintSystemJobInfo> jest drzewa dziedziczenia <xref:System.Printing.PrintSystemObject> której nie ma takich właściwości.</span><span class="sxs-lookup"><span data-stu-id="a3778-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="a3778-137">**ReportAvailabilityAtThisTime** — metoda (przedstawione w poniższym przykładzie kodu) rozpoczyna się od zainicjowania <xref:System.Boolean> zmiennej wartownik `true`.</span><span class="sxs-lookup"><span data-stu-id="a3778-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="a3778-138">Zostanie zresetowana do wartości `false`, jeśli kolejka jest niedostępna.</span><span class="sxs-lookup"><span data-stu-id="a3778-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="a3778-139">Następnie metoda sprawdza, czy początek, a "do momentu" czasy są identyczne.</span><span class="sxs-lookup"><span data-stu-id="a3778-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="a3778-140">Jeśli są one kolejki zawsze jest dostępna, więc metoda zwraca `true`.</span><span class="sxs-lookup"><span data-stu-id="a3778-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="a3778-141">Jeśli kolejka nie jest dostępna przez cały czas, metoda używa statycznych <xref:System.DateTime.UtcNow%2A> właściwości, aby uzyskać bieżącą godzinę jako <xref:System.DateTime> obiektu.</span><span class="sxs-lookup"><span data-stu-id="a3778-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="a3778-142">(Firma Microsoft nie muszą czasu lokalnego, ponieważ <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> i <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> właściwości są w formacie UTC.)</span><span class="sxs-lookup"><span data-stu-id="a3778-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="a3778-143">Te dwie właściwości nie są jednak <xref:System.DateTime> obiektów.</span><span class="sxs-lookup"><span data-stu-id="a3778-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="a3778-144">Są one <xref:System.Int32>s wyrażanie czas jako liczba minut po UTC północy.</span><span class="sxs-lookup"><span data-stu-id="a3778-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="a3778-145">A więc musimy przekonwertować naszych <xref:System.DateTime> obiektu minut po północy.</span><span class="sxs-lookup"><span data-stu-id="a3778-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="a3778-146">Po zakończeniu tej operacji metoda sprawdza po prostu do sprawdzenia, czy "teraz" jest między kolejki rozpoczęcia i "godziny, ustawia wartownik na wartość false, jeśli"teraz"nie jest między dwiema wartościami godziny i zwraca wartownik do".</span><span class="sxs-lookup"><span data-stu-id="a3778-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="a3778-147">**TimeConverter.ConvertToLocalHumanReadableTime** — metoda (przedstawione w poniższym przykładzie kodu) nie używa żadnych metod wprowadzone w systemie [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], więc dyskusji jest krótki.</span><span class="sxs-lookup"><span data-stu-id="a3778-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], so the discussion is brief.</span></span> <span data-ttu-id="a3778-148">Metoda ma zadań podwójna konwersja: musi podjąć całkowitą wyrażanie minut po północy i przekonwertować go na czas zrozumiałą dla użytkownika i należy przekonwertować to na czas lokalny.</span><span class="sxs-lookup"><span data-stu-id="a3778-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="a3778-149">Jest to osiągane przez utworzenie <xref:System.DateTime> obiekt, który ma ustawioną wartość północy czasu UTC, a następnie go używa <xref:System.DateTime.AddMinutes%2A> metody w celu dodania minut, które zostały przekazane do metody.</span><span class="sxs-lookup"><span data-stu-id="a3778-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="a3778-150">To polecenie zwróci nowy <xref:System.DateTime> wyrażanie oryginalnego czas, który został przekazany do metody.</span><span class="sxs-lookup"><span data-stu-id="a3778-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="a3778-151"><xref:System.DateTime.ToLocalTime%2A> Metoda następnie konwertuje to na czas lokalny.</span><span class="sxs-lookup"><span data-stu-id="a3778-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="a3778-152">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="a3778-152">See Also</span></span>  
 <xref:System.DateTime>  
 <xref:System.Printing.PrintSystemJobInfo>  
 <xref:System.Printing.PrintQueue>  
 [<span data-ttu-id="a3778-153">Dokumenty w WPF</span><span class="sxs-lookup"><span data-stu-id="a3778-153">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)  
 [<span data-ttu-id="a3778-154">Przegląd drukowania</span><span class="sxs-lookup"><span data-stu-id="a3778-154">Printing Overview</span></span>](../../../../docs/framework/wpf/advanced/printing-overview.md)
