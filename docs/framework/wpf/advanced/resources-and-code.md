---
title: Zasoby i kod
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: 11903a9bae25b0646d944fb11038e07434996015
ms.sourcegitcommit: f8c36054eab877de4d40a705aacafa2552ce70e9
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/31/2019
ms.locfileid: "75559758"
---
# <a name="resources-and-code"></a><span data-ttu-id="a4c67-102">Zasoby i kod</span><span class="sxs-lookup"><span data-stu-id="a4c67-102">Resources and Code</span></span>
<span data-ttu-id="a4c67-103">Ten przegląd koncentruje się na sposobie uzyskiwania dostępu do zasobów [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] lub tworzenia ich przy użyciu kodu, a nie [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] składni.</span><span class="sxs-lookup"><span data-stu-id="a4c67-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="a4c67-104">Aby uzyskać więcej informacji na temat ogólnego użycia zasobów i zasobów z perspektywy [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]ej składni, zobacz [zasoby XAML](xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="a4c67-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](xaml-resources.md).</span></span>  

<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="a4c67-105">Uzyskiwanie dostępu do zasobów z kodu</span><span class="sxs-lookup"><span data-stu-id="a4c67-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="a4c67-106">Klucze identyfikujące zasoby, jeśli są zdefiniowane za pomocą [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] są również używane do pobierania określonych zasobów, Jeśli zażądasz zasobu w kodzie.</span><span class="sxs-lookup"><span data-stu-id="a4c67-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="a4c67-107">Najprostszym sposobem na pobranie zasobu z kodu jest wywołanie <xref:System.Windows.FrameworkElement.FindResource%2A> lub metody <xref:System.Windows.FrameworkElement.TryFindResource%2A> z obiektów poziomu platformy w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a4c67-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="a4c67-108">Różnica między tymi metodami zależy od tego, co się stanie, jeśli nie zostanie znaleziony żądany klucz.</span><span class="sxs-lookup"><span data-stu-id="a4c67-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="a4c67-109"><xref:System.Windows.FrameworkElement.FindResource%2A> zgłasza wyjątek; <xref:System.Windows.FrameworkElement.TryFindResource%2A> nie zgłosi wyjątku, ale zwraca `null`.</span><span class="sxs-lookup"><span data-stu-id="a4c67-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="a4c67-110">Każda metoda przyjmuje klucz zasobu jako parametr wejściowy i zwraca obiekt z swobodnym typem.</span><span class="sxs-lookup"><span data-stu-id="a4c67-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="a4c67-111">Zazwyczaj klucz zasobu jest ciągiem, ale istnieją sporadyczne nieciągi użycia; Aby uzyskać szczegółowe informacje, zobacz sekcję [Używanie obiektów jako kluczy](#objectaskey) .</span><span class="sxs-lookup"><span data-stu-id="a4c67-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="a4c67-112">Zazwyczaj można rzutować zwracany obiekt na typ wymagany przez właściwość, która jest ustawiana podczas żądania zasobu.</span><span class="sxs-lookup"><span data-stu-id="a4c67-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="a4c67-113">Logika wyszukiwania dla rozpoznawania zasobów kodu jest taka sama jak w przypadku odwołania do zasobu dynamicznego [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] przypadku.</span><span class="sxs-lookup"><span data-stu-id="a4c67-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="a4c67-114">Wyszukiwanie zasobów zaczyna się od wywołującego elementu, a następnie kontynuuje kolejne elementy nadrzędne w drzewie logicznym.</span><span class="sxs-lookup"><span data-stu-id="a4c67-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="a4c67-115">Wyszukiwanie jest kontynuowane w zasobach aplikacji, motywach i zasobach systemowych w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="a4c67-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="a4c67-116">Żądanie Code dla zasobu będzie poprawnie uwzględniać zmiany w środowisku uruchomieniowym w słownikach zasobów, które mogły zostać wprowadzone po załadowaniu tego słownika zasobów z [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], a także w przypadku zmian zasobów systemu w czasie rzeczywistym.</span><span class="sxs-lookup"><span data-stu-id="a4c67-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="a4c67-117">Poniżej znajduje się krótki kod przykładowy, który wyszukuje zasób według klucza i używa wartości zwracanej do ustawiania właściwości wdrożonej jako <xref:System.Windows.Controls.Primitives.ButtonBase.Click> obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="a4c67-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="a4c67-118">Alternatywną metodą przypisywania odwołania do zasobu jest <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="a4c67-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="a4c67-119">Ta metoda przyjmuje dwa parametry: klucz zasobu i identyfikator określonej właściwości zależności, która jest obecna w wystąpieniu elementu, do którego ma zostać przypisana wartość zasobu.</span><span class="sxs-lookup"><span data-stu-id="a4c67-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="a4c67-120">Funkcjonalnie ta metoda jest taka sama i ma zalety niewymagające rzutowania wartości zwracanych.</span><span class="sxs-lookup"><span data-stu-id="a4c67-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="a4c67-121">Nadal inny sposób uzyskiwania dostępu do zasobów programowo polega na uzyskiwaniu dostępu do zawartości właściwości <xref:System.Windows.FrameworkElement.Resources%2A> jako słownika.</span><span class="sxs-lookup"><span data-stu-id="a4c67-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="a4c67-122">Dostęp do słownika zawartego w tej właściwości polega na tym, jak dodać nowe zasoby do istniejących kolekcji, sprawdzić, czy dana nazwa klucza została już wprowadzona w kolekcji, oraz innych operacji słownika/kolekcji.</span><span class="sxs-lookup"><span data-stu-id="a4c67-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="a4c67-123">Jeśli piszesz aplikację [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w całości w kodzie, możesz również utworzyć całą kolekcję w kodzie, przypisać do niej klucze, a następnie przypisać ukończoną kolekcję do właściwości <xref:System.Windows.FrameworkElement.Resources%2A> określonego elementu.</span><span class="sxs-lookup"><span data-stu-id="a4c67-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="a4c67-124">Zostanie to opisane w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="a4c67-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="a4c67-125">Można indeksować w ramach danej kolekcji <xref:System.Windows.FrameworkElement.Resources%2A> przy użyciu określonego klucza jako indeksu, ale należy pamiętać, że uzyskanie dostępu do zasobu w ten sposób nie jest zgodne z normalnymi regułami środowiska uruchomieniowego w ramach rozwiązywania zasobów.</span><span class="sxs-lookup"><span data-stu-id="a4c67-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="a4c67-126">Uzyskujesz dostęp do tej konkretnej kolekcji.</span><span class="sxs-lookup"><span data-stu-id="a4c67-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="a4c67-127">Wyszukiwanie zasobów nie przejdzie do zakresu głównego lub aplikacji, jeśli w żądanym kluczu nie znaleziono prawidłowego obiektu.</span><span class="sxs-lookup"><span data-stu-id="a4c67-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="a4c67-128">Jednak takie podejście może mieć precyzyjne zalety wydajności w niektórych przypadkach, ponieważ zakres wyszukiwania klucza jest bardziej ograniczony.</span><span class="sxs-lookup"><span data-stu-id="a4c67-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="a4c67-129">Zapoznaj się z klasą <xref:System.Windows.ResourceDictionary>, aby uzyskać szczegółowe informacje na temat sposobu pracy bezpośrednio z słownikiem zasobów.</span><span class="sxs-lookup"><span data-stu-id="a4c67-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="a4c67-130">Tworzenie zasobów przy użyciu kodu</span><span class="sxs-lookup"><span data-stu-id="a4c67-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="a4c67-131">Jeśli chcesz utworzyć całą aplikację [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] w kodzie, możesz również utworzyć wszystkie zasoby w tej aplikacji w kodzie.</span><span class="sxs-lookup"><span data-stu-id="a4c67-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="a4c67-132">Aby to osiągnąć, Utwórz nowe wystąpienie <xref:System.Windows.ResourceDictionary> a następnie Dodaj wszystkie zasoby do słownika przy użyciu kolejnych wywołań do <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a4c67-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a4c67-133">Następnie użyj <xref:System.Windows.ResourceDictionary> utworzonego w ten sposób, aby ustawić właściwość <xref:System.Windows.FrameworkElement.Resources%2A> dla elementu, który znajduje się w zakresie strony, lub <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a4c67-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a4c67-134">Można również zachować <xref:System.Windows.ResourceDictionary> jako obiekt autonomiczny bez dodawania go do elementu.</span><span class="sxs-lookup"><span data-stu-id="a4c67-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="a4c67-135">Jeśli jednak to zrobisz, musisz uzyskać dostęp do zasobów w ramach klucza elementu, tak jakby były słownikiem ogólnym.</span><span class="sxs-lookup"><span data-stu-id="a4c67-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="a4c67-136"><xref:System.Windows.ResourceDictionary>, który nie jest dołączony do właściwości elementu `Resources` nie istnieje jako część drzewa elementów i nie ma zakresu w sekwencji wyszukiwania, który może być używany przez <xref:System.Windows.FrameworkElement.FindResource%2A> i powiązane metody.</span><span class="sxs-lookup"><span data-stu-id="a4c67-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="a4c67-137">Używanie obiektów jako kluczy</span><span class="sxs-lookup"><span data-stu-id="a4c67-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="a4c67-138">Większość użycia zasobów ustawi klucz zasobu jako ciąg.</span><span class="sxs-lookup"><span data-stu-id="a4c67-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="a4c67-139">Jednak różne funkcje [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] celowo nie używają typu ciągu do określenia kluczy, zamiast tego ten parametr jest obiektem.</span><span class="sxs-lookup"><span data-stu-id="a4c67-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="a4c67-140">Możliwość umieszczania zasobu przez obiekt jest używana przez [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] stylu i obsługi motywów.</span><span class="sxs-lookup"><span data-stu-id="a4c67-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="a4c67-141">Style w motywach, które stają się stylem domyślnym dla kontrolki nieposiadające stylu, są podżądane przez <xref:System.Type> kontrolki, do których mają zastosowanie.</span><span class="sxs-lookup"><span data-stu-id="a4c67-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="a4c67-142">Ustalanie przez typ zapewnia niezawodny mechanizm wyszukiwania, który działa na wystąpieniach domyślnych każdego typu formantu, a typ może być wykrywany przez odbicie i używane do ustawiania stylów klas pochodnych, mimo że typ pochodny nie ma stylu domyślnego.</span><span class="sxs-lookup"><span data-stu-id="a4c67-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="a4c67-143">Możesz określić klucz <xref:System.Type> dla zasobu zdefiniowanego w [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] przy użyciu [rozszerzenia znacznika x:Type —](../../../desktop-wpf/xaml-services/xtype-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="a4c67-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../../desktop-wpf/xaml-services/xtype-markup-extension.md).</span></span> <span data-ttu-id="a4c67-144">Podobne rozszerzenia istnieją dla innych nieciąguowych użycia kluczy, które obsługują funkcje [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], takie jak [rozszerzenie znacznika ComponentResourceKey](componentresourcekey-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="a4c67-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a4c67-145">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="a4c67-145">See also</span></span>

- [<span data-ttu-id="a4c67-146">Zasoby XAML</span><span class="sxs-lookup"><span data-stu-id="a4c67-146">XAML Resources</span></span>](xaml-resources.md)
- [<span data-ttu-id="a4c67-147">Tworzenie szablonów i stylów</span><span class="sxs-lookup"><span data-stu-id="a4c67-147">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
