---
title: Obsługa zdarzeń Visual Basic oraz WPF
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 9a3d579019db4d2b59a0252dbe63b4a6a0468849
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/03/2019
ms.locfileid: "73458301"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="f0641-102">Obsługa zdarzeń Visual Basic oraz WPF</span><span class="sxs-lookup"><span data-stu-id="f0641-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="f0641-103">W przypadku języka Microsoft Visual Basic .NET w konkretnym przypadku można użyć słowa kluczowego `Handles` specyficznego dla języka w celu skojarzenia programów obsługi zdarzeń z wystąpieniami, zamiast dołączać obsługi zdarzeń z atrybutami lub przy użyciu metody <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="f0641-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="f0641-104">Jednak technika `Handles` dołączania programów obsługi do wystąpień ma pewne ograniczenia, ponieważ składnia `Handles` nie może obsługiwać niektórych określonych funkcji zdarzeń kierowanych [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] systemie zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f0641-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="f0641-105">Używanie "dojść" w aplikacji WPF</span><span class="sxs-lookup"><span data-stu-id="f0641-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="f0641-106">Programy obsługi zdarzeń, które są połączone z wystąpieniami i zdarzeniami ze `Handles` muszą być zdefiniowane w deklaracji klasy częściowej wystąpienia, co jest również wymaganiem dla programów obsługi zdarzeń, które są przypisywane za pomocą wartości atrybutów dla elementów.</span><span class="sxs-lookup"><span data-stu-id="f0641-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="f0641-107">Na stronie można określić tylko `Handles` dla elementu, który ma <xref:System.Windows.FrameworkContentElement.Name%2A> wartość właściwości (lub zadeklarowaną [dyrektywę x:Name](../../xaml-services/x-name-directive.md) ).</span><span class="sxs-lookup"><span data-stu-id="f0641-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="f0641-108">Dzieje się tak, ponieważ <xref:System.Windows.FrameworkContentElement.Name%2A> w [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] tworzy odwołanie do wystąpienia, które jest niezbędne do obsługi *wystąpienia.* format odwołania zdarzenia wymagany przez składnię `Handles`.</span><span class="sxs-lookup"><span data-stu-id="f0641-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="f0641-109">Jedynym elementem, który może być używany dla `Handles` bez odwołania <xref:System.Windows.FrameworkContentElement.Name%2A>, jest wystąpienie elementu głównego, które definiuje klasę częściową.</span><span class="sxs-lookup"><span data-stu-id="f0641-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="f0641-110">Tę samą procedurę obsługi można przypisać do wielu elementów, oddzielając *wystąpienia.* odwołania do zdarzeń po `Handles` przecinkami.</span><span class="sxs-lookup"><span data-stu-id="f0641-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="f0641-111">Za pomocą `Handles` można przypisać więcej niż jeden program obsługi do tego samego *wystąpienia.* odwołanie do zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="f0641-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="f0641-112">Nie należy przypisywać żadnej ważności do kolejności, w której procedury obsługi są podawane w odniesieniu do `Handles`; należy założyć, że programy obsługi, które obsługują to samo zdarzenie, mogą być wywoływane w dowolnej kolejności.</span><span class="sxs-lookup"><span data-stu-id="f0641-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="f0641-113">Aby usunąć program obsługi, który został dodany przy użyciu `Handles` w deklaracji, można wywołać <xref:System.Windows.UIElement.RemoveHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="f0641-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="f0641-114">Za pomocą `Handles` można dołączać procedury obsługi dla zdarzeń kierowanych, tak długo, jak program obsługi jest dołączany do wystąpień, które definiują obsłużone zdarzenie w tabelach elementów członkowskich.</span><span class="sxs-lookup"><span data-stu-id="f0641-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="f0641-115">Dla zdarzeń kierowanych programy obsługi, które są dołączone do `Handles` są zgodne z tymi samymi regułami routingu jak programy obsługi, które są dołączone jako atrybuty [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] lub ze wspólną sygnaturą <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="f0641-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="f0641-116">Oznacza to, że jeśli zdarzenie jest już oznaczone jako obsłużone (<xref:System.Windows.RoutedEventArgs.Handled%2A> właściwość w danych zdarzenia jest `True`), a następnie programy obsługi dołączone do `Handles` nie są wywoływane w odpowiedzi na to wystąpienie zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="f0641-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="f0641-117">Zdarzenie może być oznaczone jako obsługiwane przez obsługę wystąpień dla innego elementu w marszrucie lub przez klasę obsługi w bieżącym elemencie lub wcześniejszych elementach na trasie.</span><span class="sxs-lookup"><span data-stu-id="f0641-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="f0641-118">Dla zdarzeń wejściowych, które obsługują sparowane zdarzenia tunelu/bąbelków, trasa tunelowania mogła oznaczać, że jest ona obsługiwana przez parę zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f0641-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="f0641-119">Aby uzyskać więcej informacji na temat zdarzeń kierowanych, zobacz [Omówienie zdarzeń kierowanych](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f0641-119">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="f0641-120">Ograniczenia "dojść" w przypadku dodawania programów obsługi</span><span class="sxs-lookup"><span data-stu-id="f0641-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="f0641-121">`Handles` nie może odwoływać się do programów obsługi dla dołączonych zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f0641-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="f0641-122">Należy użyć metody dostępu `add` dla tego dołączonego zdarzenia lub *atrybutu TypeName. EventName* w [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f0641-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="f0641-123">Aby uzyskać szczegółowe informacje, zobacz [Omówienie zdarzeń kierowanych](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f0641-123">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="f0641-124">W przypadku zdarzeń kierowanych można używać `Handles` do przypisywania programów obsługi dla wystąpień, w których to zdarzenie istnieje w tabeli elementów członkowskich wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="f0641-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="f0641-125">Jednak ze zdarzeniami kierowanymi ogólnie, element nadrzędny może być odbiornikiem zdarzenia z elementów podrzędnych, nawet jeśli element nadrzędny nie ma tego zdarzenia w tabeli elementów członkowskich.</span><span class="sxs-lookup"><span data-stu-id="f0641-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="f0641-126">W składni atrybutów, można ją określić za pomocą atrybutu *TypeName. MemberName* , który jest zgodny z typem w rzeczywistości definiuje zdarzenie, które ma być obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="f0641-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="f0641-127">Na przykład nadrzędna `Page` (bez zdefiniowanego zdarzenia `Click`) może nasłuchiwać zdarzeń kliknięcia przycisku przez przypisanie obsługi atrybutu w `Button.Click`.</span><span class="sxs-lookup"><span data-stu-id="f0641-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="f0641-128">Ale `Handles` nie obsługuje formularza *TypeName. MemberName* , ponieważ musi obsługiwać wystąpienie powodujące konflikt. formularz *zdarzenia* .</span><span class="sxs-lookup"><span data-stu-id="f0641-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="f0641-129">Aby uzyskać szczegółowe informacje, zobacz [Omówienie zdarzeń kierowanych](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f0641-129">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="f0641-130">`Handles` nie może dołączyć programów obsługi, które są wywoływane dla zdarzeń, które są już oznaczone jako obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="f0641-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="f0641-131">Zamiast tego należy użyć kodu i wywoływać `handledEventsToo` Przeciążenie <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="f0641-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f0641-132">Nie należy używać składni `Handles` w kodzie Visual Basic podczas określania programu obsługi zdarzeń dla tego samego zdarzenia w języku XAML.</span><span class="sxs-lookup"><span data-stu-id="f0641-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="f0641-133">W takim przypadku program obsługi zdarzeń jest wywoływany dwukrotnie.</span><span class="sxs-lookup"><span data-stu-id="f0641-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="f0641-134">Jak WPF implementuje funkcje "Handles"</span><span class="sxs-lookup"><span data-stu-id="f0641-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="f0641-135">Po skompilowaniu strony [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] plik pośredni deklaruje `Friend` `WithEvents` odwołań do każdego elementu na stronie, który ma zestaw właściwości <xref:System.Windows.FrameworkContentElement.Name%2A> (lub zadeklarowana [dyrektywa x:Name](../../xaml-services/x-name-directive.md) ).</span><span class="sxs-lookup"><span data-stu-id="f0641-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="f0641-136">Każde nazwane wystąpienie jest potencjalnie elementem, który można przypisać do programu obsługi za pomocą `Handles`.</span><span class="sxs-lookup"><span data-stu-id="f0641-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f0641-137">W programie Visual Studio technologia IntelliSense może pokazać, które elementy są dostępne dla `Handles` odwołanie na stronie.</span><span class="sxs-lookup"><span data-stu-id="f0641-137">Within Visual Studio, IntelliSense can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="f0641-138">Jednak może to potrwać jeden przebieg kompilacji, aby plik pośredni mógł wypełnić wszystkie `Friends` odwołania.</span><span class="sxs-lookup"><span data-stu-id="f0641-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f0641-139">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="f0641-139">See also</span></span>

- <xref:System.Windows.UIElement.AddHandler%2A>
- [<span data-ttu-id="f0641-140">Oznaczanie zdarzeń trasowanych jako obsłużonych oraz obsługa klasy</span><span class="sxs-lookup"><span data-stu-id="f0641-140">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="f0641-141">Przegląd zdarzeń trasowanych</span><span class="sxs-lookup"><span data-stu-id="f0641-141">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="f0641-142">Przegląd XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="f0641-142">XAML Overview (WPF)</span></span>](../../../desktop-wpf/fundamentals/xaml.md)
