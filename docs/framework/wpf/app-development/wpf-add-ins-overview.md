---
title: Przegląd Dodatki WPF
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 2e5d133a4744124723c0373e3d5974b505936190
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/01/2018
ms.locfileid: "43402104"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="93b2b-102">Przegląd Dodatki WPF</span><span class="sxs-lookup"><span data-stu-id="93b2b-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="93b2b-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Obejmuje model dodatku, deweloperzy mogą używać do tworzenia aplikacji, które obsługuje rozszerzalność w dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="93b2b-104">Ten dodatek model umożliwia tworzenie dodatków, które integrują się z oraz rozszerzanie funkcjonalności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="93b2b-105">W niektórych przypadkach aplikacje wymagają także do wyświetlenia [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] są dostarczane przez dodatków. W tym temacie przedstawiono sposób [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozszerzają [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] model w dodatku, aby włączyć te scenariusze, architektura związanych z nim, korzyści i jego pewne ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="93b2b-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="93b2b-106">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="93b2b-106">Prerequisites</span></span>  
 <span data-ttu-id="93b2b-107">Znajomość [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatku model jest wymagany.</span><span class="sxs-lookup"><span data-stu-id="93b2b-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="93b2b-108">Aby uzyskać więcej informacji, zobacz [dodatki i rozszerzalność](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="93b2b-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="93b2b-109">Omówienie dodatków</span><span class="sxs-lookup"><span data-stu-id="93b2b-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="93b2b-110">W celu uniknięcia komplikacje związane z ponowną kompilację aplikacji i ponowne włączenie nowe funkcje, aplikacje zaimplementować rozszerzalności mechanizmów, które umożliwiają deweloperom (firmy Microsoft i innych firm), aby utworzyć inne aplikacje, które Integracja z nich.</span><span class="sxs-lookup"><span data-stu-id="93b2b-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="93b2b-111">Jest najczęstszym sposobem obsługi tego rodzaju rozszerzalność przy użyciu dodatków (znany także jako "dodatki" i "dodatki").</span><span class="sxs-lookup"><span data-stu-id="93b2b-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="93b2b-112">Przykłady rzeczywistych aplikacjach, które uwidaczniają rozszerzalność przy użyciu dodatków:</span><span class="sxs-lookup"><span data-stu-id="93b2b-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="93b2b-113">Dodatki programu Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="93b2b-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="93b2b-114">Dodatki plug-in Windows Media Player.</span><span class="sxs-lookup"><span data-stu-id="93b2b-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="93b2b-115">Visual Studio dodatków.</span><span class="sxs-lookup"><span data-stu-id="93b2b-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="93b2b-116">Na przykład model dodatku Windows Media Player umożliwia deweloperom innej firmy zaimplementować "dodatki", które rozszerzają Windows Media Player na różne sposoby, m.in. tworzenia dekoderów i koderów dla formatów multimediów, które nie są obsługiwane natywnie przez Windows Usługa Media Player (na przykład DVD, MP3), efekty dźwiękowe i skórki.</span><span class="sxs-lookup"><span data-stu-id="93b2b-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="93b2b-117">Każdy model dodatek został opracowany pod kątem udostępniają funkcje, który jest unikatowy dla aplikacji, chociaż istnieje kilka jednostek i zachowania, które są wspólne dla wszystkich modeli dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="93b2b-118">Są trzy główne jednostki rozszerzalności typowy dodatek rozwiązania *umów*, *dodatków*, i *hostowanie aplikacji*.</span><span class="sxs-lookup"><span data-stu-id="93b2b-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="93b2b-119">Kontrakty określają, jak dodatki integracji z aplikacjami hosta na dwa sposoby:</span><span class="sxs-lookup"><span data-stu-id="93b2b-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="93b2b-120">Dodatki integracji z funkcjonalnością, który jest implementowany przez hosta aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="93b2b-121">Hostowanie aplikacji ujawniać funkcjonalność dla dodatków do integracji z.</span><span class="sxs-lookup"><span data-stu-id="93b2b-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="93b2b-122">Aby dodatków do użycia hostowanie aplikacji trzeba je znaleźć i załadować je w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="93b2b-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="93b2b-123">W związku z tym aplikacje, które obsługują dodatki mają następujące dodatkowe obowiązki:</span><span class="sxs-lookup"><span data-stu-id="93b2b-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="93b2b-124">**Odnajdywanie**: znajdowanie dodatków zgodne z kontraktów obsługiwane przez hosta aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="93b2b-125">**Aktywacja**: podczas ładowania, uruchamiania i nawiązywania połączenia z dodatków.</span><span class="sxs-lookup"><span data-stu-id="93b2b-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="93b2b-126">**Izolacja**: za pomocą domen aplikacji lub procesów można ustanowić granic izolacji, które chronić aplikacje przed potencjalne problemy zabezpieczeń i wykonywania za pomocą dodatków.</span><span class="sxs-lookup"><span data-stu-id="93b2b-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="93b2b-127">**Komunikacja**: pozwalając dodatków i hostowanie aplikacji do komunikowania się ze sobą w granicach izolacji, wywoływanie metod i przekazując dane.</span><span class="sxs-lookup"><span data-stu-id="93b2b-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="93b2b-128">**Zarządzanie okresem istnienia**: ładowanie i zwalnianie domeny aplikacji i procesów w sposób zawsze przejrzyste i przewidywalne (zobacz [domen aplikacji](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="93b2b-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="93b2b-129">**Przechowywanie wersji**: zapewnienie, że dodatków i hostowania aplikacji może nadal komunikować się podczas tworzenia nowych wersji jednej.</span><span class="sxs-lookup"><span data-stu-id="93b2b-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="93b2b-130">Ostatecznie tworzenia niezawodnych model dodatku jest trywialny przedsiębiorstwa.</span><span class="sxs-lookup"><span data-stu-id="93b2b-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="93b2b-131">Z tego powodu [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] zapewnia infrastrukturę do tworzenia modeli w dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="93b2b-132">Aby uzyskać bardziej szczegółowe informacje dotyczące dodatków, zobacz [dodatki i rozszerzalność](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="93b2b-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="93b2b-133">Przegląd Model dodatku .NET framework</span><span class="sxs-lookup"><span data-stu-id="93b2b-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="93b2b-134">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Model dodatku, znaleziono w <xref:System.AddIn> przestrzeni nazw, zawiera zestaw typów, które są zaprojektowane w celu uproszczenia opracowywania rozszerzeń w dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="93b2b-135">Podstawową jednostką [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatku model jest *kontraktu*, która definiuje, jak aplikacji hosta i dodatek komunikują się ze sobą.</span><span class="sxs-lookup"><span data-stu-id="93b2b-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="93b2b-136">Kontrakt jest widoczna dla aplikacji hosta, za pomocą hosta aplikacji specyficzne *widoku* kontraktu.</span><span class="sxs-lookup"><span data-stu-id="93b2b-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="93b2b-137">Podobnie, add logującego się *widoku* Umowy ma połączenie dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="93b2b-138">*Karty* służy do umożliwiania hosta aplikacji i Dodaj w komunikacji między swoimi opiniami odpowiedniej umowy.</span><span class="sxs-lookup"><span data-stu-id="93b2b-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="93b2b-139">Kontrakty, widoki i adaptery są określane jako segmenty i stanowi zbiór powiązanych segmentów *potoku*.</span><span class="sxs-lookup"><span data-stu-id="93b2b-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="93b2b-140">Potoki są podstawę, na którym [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatku model obsługuje odnajdywania, aktywacji, izolacji zabezpieczeń, izolacji wykonywania (przy użyciu domeny aplikacji i procesów), komunikacji, zarządzanie okresem istnienia i przechowywania wersji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="93b2b-141">Suma ta obsługa umożliwia deweloperom tworzenie dodatków, które integrują się z funkcjami aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="93b2b-142">Jednak niektóre scenariusze wymagają obsługi aplikacji do wyświetlenia [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] dostarczone przez dodatków. Ponieważ każda technologia prezentacji w [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] ma swój własny model implementowania [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatku model nie obsługuje innych technologii prezentacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="93b2b-143">Zamiast tego [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozszerza [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] model dodatku za pomocą [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] pomocy technicznej dla dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="93b2b-144">Dodatki WPF</span><span class="sxs-lookup"><span data-stu-id="93b2b-144">WPF Add-Ins</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="93b2b-145">, w połączeniu z [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatek modelu pozwala rozwiązać szerokiej gamy scenariuszy, które wymagają obsługi aplikacji do wyświetlenia [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] z dodatków. W szczególności te scenariusze są rozwiązywane przez [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] za pomocą następujących dwóch modelach programowania:</span><span class="sxs-lookup"><span data-stu-id="93b2b-145">, in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="93b2b-146">**Dodatek zwraca interfejs użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="93b2b-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="93b2b-147">Dodatek zwraca [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] aplikacji hosta, za pomocą wywołania metody, zgodnie z definicją w umowie.</span><span class="sxs-lookup"><span data-stu-id="93b2b-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="93b2b-148">W tym scenariuszu jest używany w następujących przypadkach:</span><span class="sxs-lookup"><span data-stu-id="93b2b-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="93b2b-149">Wygląd [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zwracanym przez dodatek jest zależny od danych albo lub warunków, które istnieją tylko w czasie wykonywania, takie jak dynamicznie wygenerowanych raportów.</span><span class="sxs-lookup"><span data-stu-id="93b2b-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="93b2b-150">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Usługi świadczone przez dodatek różni się od [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] aplikacji hosta, które można używać dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="93b2b-151">Dodatek przede wszystkim wykonuje usługi dla aplikacji hosta, a następnie raportuje stan aplikacji hosta, za pomocą [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="93b2b-152">**Dodatek jest interfejsem użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="93b2b-152">**The add-in is a UI**.</span></span> <span data-ttu-id="93b2b-153">Dodatek jest [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], zgodnie z definicją w umowie.</span><span class="sxs-lookup"><span data-stu-id="93b2b-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="93b2b-154">W tym scenariuszu jest używany w następujących przypadkach:</span><span class="sxs-lookup"><span data-stu-id="93b2b-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="93b2b-155">Dodatek nie zapewnia usługami innymi niż są wyświetlane, takich jak reklamy.</span><span class="sxs-lookup"><span data-stu-id="93b2b-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="93b2b-156">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Usługi świadczone przez dodatek jest wspólny dla wszystkich aplikacji hosta, które można użyć tego dodatku, takich jak kalkulatora lub próbnika kolorów.</span><span class="sxs-lookup"><span data-stu-id="93b2b-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="93b2b-157">Scenariusze te wymagają, aby [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] obiekty mogą być przekazywane między aplikacją hosta i domen aplikacji w dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="93b2b-158">Ponieważ [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatku model opiera się na komunikacji zdalnej do komunikowania się między domenami aplikacji, obiekty, które są przekazywane między nimi muszą być może być zastosowana zdalnie.</span><span class="sxs-lookup"><span data-stu-id="93b2b-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="93b2b-159">Obiekt może być zastosowana zdalnie jest wystąpieniem klasy, która wykonuje jedno lub więcej z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="93b2b-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="93b2b-160">Pochodzi od klasy <xref:System.MarshalByRefObject> klasy.</span><span class="sxs-lookup"><span data-stu-id="93b2b-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="93b2b-161">Implementuje <xref:System.Runtime.Serialization.ISerializable> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="93b2b-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="93b2b-162">Ma <xref:System.SerializableAttribute> zastosowany.</span><span class="sxs-lookup"><span data-stu-id="93b2b-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="93b2b-163">Aby uzyskać więcej informacji na temat tworzenia może być zastosowana zdalnie [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] obiekty, zobacz [może być zastosowana zdalnie obiektów wprowadzania](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="93b2b-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="93b2b-164">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Typy nie są wykonywane zdalnie.</span><span class="sxs-lookup"><span data-stu-id="93b2b-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="93b2b-165">Aby rozwiązać ten problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozszerza [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] model w dodatku, aby umożliwić [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] utworzone przez dodatki mają być wyświetlane z hosta aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="93b2b-166">Ta pomoc techniczna jest świadczona przez [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] przez dwa typy: <xref:System.AddIn.Contract.INativeHandleContract> interfejsu i dwa statycznych metod zaimplementowanych przez <xref:System.AddIn.Pipeline.FrameworkElementAdapters> klasy: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="93b2b-167">Na wysokim poziomie te typy i metody są używane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="93b2b-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="93b2b-168"> wymaga, aby [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] dostarczone przez dodatki są klasami, które pochodzą bezpośrednio lub pośrednio z <xref:System.Windows.FrameworkElement>, takich jak kształtów, formantów, kontrolki użytkownika, panele układu i strony.</span><span class="sxs-lookup"><span data-stu-id="93b2b-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="93b2b-169">Wszędzie tam, gdzie kontrakt deklaruje, że interfejs użytkownika będą przekazywane między dodatkiem a aplikacją hosta, musi być zadeklarowany jako <xref:System.AddIn.Contract.INativeHandleContract> (nie <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> jest reprezentacją może być zastosowana zdalnie dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] mogą być przekazywane w granicach izolacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="93b2b-170">Przed przesłaniem z dodatku w domenie aplikacji <xref:System.Windows.FrameworkElement> jest spakowany jako <xref:System.AddIn.Contract.INativeHandleContract> przez wywołanie metody <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="93b2b-171">Po były przekazywane do aplikacji hosta domeny aplikacji, <xref:System.AddIn.Contract.INativeHandleContract> muszą być udostępniane jako <xref:System.Windows.FrameworkElement> przez wywołanie metody <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="93b2b-172">Jak <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> służą zależy od konkretnego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="93b2b-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="93b2b-173">Poniższe sekcje zawierają szczegółowe informacje dla każdego modelu programowania.</span><span class="sxs-lookup"><span data-stu-id="93b2b-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="93b2b-174">Dodatek zwraca interfejs użytkownika</span><span class="sxs-lookup"><span data-stu-id="93b2b-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="93b2b-175">Dla dodatku do zwrócenia [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] dla aplikacji hosta, wymagane są następujące:</span><span class="sxs-lookup"><span data-stu-id="93b2b-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="93b2b-176">Aplikacja hosta i potoku należy utworzyć, zgodnie z opisem w [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [dodatki i rozszerzalność](../../../../docs/framework/add-ins/index.md) dokumentacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="93b2b-177">Kontrakt musi implementować <xref:System.AddIn.Contract.IContract> i zwracać [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], kontrakt musi zadeklarować metody o wartości zwracanego typu <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="93b2b-178">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Jest ono przekazywane między dodatkiem a hostem aplikacji należy bezpośrednio ani pośrednio dziedziczyć <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="93b2b-179">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Zwracanym przez dodatek muszą zostać skonwertowane z <xref:System.Windows.FrameworkElement> do <xref:System.AddIn.Contract.INativeHandleContract> przed przekroczeniem granic izolacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="93b2b-180">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Zwracanym muszą zostać skonwertowane z <xref:System.AddIn.Contract.INativeHandleContract> do <xref:System.Windows.FrameworkElement> po przekroczeniu granic izolacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="93b2b-181">Aplikacja hosta Wyświetla zwracanego <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="93b2b-182">Aby uzyskać przykład, który demonstruje sposób implementacji dodatku, który zwraca [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], zobacz [utworzyć dodatek zwracającego interfejs użytkownika](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="93b2b-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="93b2b-183">Dodatek jest interfejsem użytkownika</span><span class="sxs-lookup"><span data-stu-id="93b2b-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="93b2b-184">Gdy dodatek jest [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], wymagane są następujące:</span><span class="sxs-lookup"><span data-stu-id="93b2b-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="93b2b-185">Aplikacja hosta i potoku należy utworzyć, zgodnie z opisem w [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [dodatki i rozszerzalność](../../../../docs/framework/add-ins/index.md) dokumentacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="93b2b-186">Musi implementować interfejs kontraktu dla dodatku <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="93b2b-187">Dodatek, który jest przekazywany do aplikacji hosta należy bezpośrednio ani pośrednio dziedziczyć <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="93b2b-188">Dodatek muszą zostać skonwertowane z <xref:System.Windows.FrameworkElement> do <xref:System.AddIn.Contract.INativeHandleContract> przed przekroczeniem granic izolacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="93b2b-189">Dodatek muszą zostać skonwertowane z <xref:System.AddIn.Contract.INativeHandleContract> do <xref:System.Windows.FrameworkElement> po przekroczeniu granic izolacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="93b2b-190">Aplikacja hosta Wyświetla zwracanego <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="93b2b-191">Aby uzyskać przykład, który demonstruje sposób implementacji dodatku, który jest [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], zobacz [dodatku oznacza to tworzenie interfejsu użytkownika](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="93b2b-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="93b2b-192">Zwracanie wielu interfejsów użytkownika z dodatku</span><span class="sxs-lookup"><span data-stu-id="93b2b-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="93b2b-193">Dodatki często udostępniają wiele [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] dla aplikacji hosta do wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="93b2b-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="93b2b-194">Rozważmy na przykład dodatku, który jest [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , także zawiera informacje o stanie aplikacji hosta również jako [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="93b2b-195">Dodatek w następujący sposób można zaimplementować przy użyciu kombinacji metod z obu [interfejsu użytkownika dodatku zwraca](#ReturnUIFromAddInContract) i [dodatek jest to interfejs użytkownika](#AddInIsAUI) modeli.</span><span class="sxs-lookup"><span data-stu-id="93b2b-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="93b2b-196">Dodatki i aplikacje przeglądarek XAML</span><span class="sxs-lookup"><span data-stu-id="93b2b-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="93b2b-197">W przykładach do tej pory aplikacji hosta zostało zainstalowane oddzielną aplikację.</span><span class="sxs-lookup"><span data-stu-id="93b2b-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="93b2b-198">Ale [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] może również obsługiwać dodatków, aczkolwiek z następujące dodatkowe wymagania kompilacji i wdrażania:</span><span class="sxs-lookup"><span data-stu-id="93b2b-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="93b2b-199">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Manifest aplikacji musi być skonfigurowany specjalnie do potoku (foldery i zestawy) i zestawu w dodatku, aby pobrać [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] pamięci podręcznej aplikacji na komputerze klienckim, w tym samym folderze co [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="93b2b-200">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Należy użyć kodu wykrycie i załadowanie dodatków [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] pamięci podręcznej aplikacji [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] jako lokalizację potoku i dodatek.</span><span class="sxs-lookup"><span data-stu-id="93b2b-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="93b2b-201">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Należy załadować dodatek do kontekstu zabezpieczeń specjalne, jeśli dodatek odwołuje się luźne pliki, które znajdują się w miejscu pochodzenia; w przypadku hostowania za [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], dodatki mogą odwoływać się tylko luźne pliki, które znajdują się w witrynie aplikacji hosta pochodzenia.</span><span class="sxs-lookup"><span data-stu-id="93b2b-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="93b2b-202">Zadania te są opisane szczegółowo w następujących podsekcjach.</span><span class="sxs-lookup"><span data-stu-id="93b2b-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="93b2b-203">Konfigurowanie potoku i dodatek dla wdrażania ClickOnce</span><span class="sxs-lookup"><span data-stu-id="93b2b-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="93b2b-204"> pobrane i uruchomić z bezpiecznego folderu w [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] wdrożenia w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="93b2b-204"> are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="93b2b-205">Aby [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] do hostowania dodatku, potoku i Dodaj w zestawie musi zostać pobrany do bezpiecznego folderu.</span><span class="sxs-lookup"><span data-stu-id="93b2b-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="93b2b-206">Aby to osiągnąć, należy skonfigurować manifest aplikacji do uwzględnienia w potoku i zestawów w dodatku do pobrania.</span><span class="sxs-lookup"><span data-stu-id="93b2b-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="93b2b-207">Najłatwiej jest to realizowane w [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], mimo że zestawu potoku dodatek i musi być zapisana w hoście [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] folderze głównym projektu, aby [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] wykrywania zestawy potoku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="93b2b-208">W związku z tym, pierwszym krokiem jest utworzenie potoku i zestawów w dodatku do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] korzeniem projektu, ustawiając dane wyjściowe kompilacji, każdy potoku zestawu i Dodaj w projektach zestawu.</span><span class="sxs-lookup"><span data-stu-id="93b2b-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="93b2b-209">W poniższej tabeli przedstawiono kompilacji dane wyjściowe ścieżki projektów zestawu potoku i projekt dodatku zestawu znajdujących się w tym samym folderze rozwiązania i głównego jako host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] projektu.</span><span class="sxs-lookup"><span data-stu-id="93b2b-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="93b2b-210">Tabela 1: Tworzenie ścieżki danych wyjściowych dla zestawów potoku, które są hostowane przez XBAP</span><span class="sxs-lookup"><span data-stu-id="93b2b-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="93b2b-211">Projekt zestawu potoku</span><span class="sxs-lookup"><span data-stu-id="93b2b-211">Pipeline assembly project</span></span>|<span data-ttu-id="93b2b-212">Kompiluj ścieżkę wyjściową</span><span class="sxs-lookup"><span data-stu-id="93b2b-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="93b2b-213">Kontrakt</span><span class="sxs-lookup"><span data-stu-id="93b2b-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="93b2b-214">Widok dodatku</span><span class="sxs-lookup"><span data-stu-id="93b2b-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="93b2b-215">Dodawanie strony karty</span><span class="sxs-lookup"><span data-stu-id="93b2b-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="93b2b-216">Adaptery po stronie hosta</span><span class="sxs-lookup"><span data-stu-id="93b2b-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="93b2b-217">Add-In</span><span class="sxs-lookup"><span data-stu-id="93b2b-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="93b2b-218">Następnym krokiem jest określenie zestawów potoku i zestawów w dodatku, jako [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] zawartości plików w [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] , wykonując następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="93b2b-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="93b2b-219">Łącznie z zestawu potoku i dodatek w projekcie, klikając prawym przyciskiem myszy każdy folder potoku w Eksploratorze rozwiązań i wybierając pozycję **załącz do projektu**.</span><span class="sxs-lookup"><span data-stu-id="93b2b-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="93b2b-220">Ustawienie **Build Action** każdego zestawu potoku i zestawów w dodatku do **zawartości** z **właściwości** okna.</span><span class="sxs-lookup"><span data-stu-id="93b2b-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="93b2b-221">Ostatnim krokiem jest skonfigurowanie manifest aplikacji do uwzględnienia potoku plików zestawu i pliku zestawu w dodatku do pobrania.</span><span class="sxs-lookup"><span data-stu-id="93b2b-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="93b2b-222">Pliki powinny się znajdować w foldery w katalogu głównym folderu w [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] pamięci podręcznej, który [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] zajmuje aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="93b2b-223">Konfigurację można osiągnąć w [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] , wykonując następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="93b2b-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="93b2b-224">Kliknij prawym przyciskiem myszy [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] projektu, kliknij przycisk **właściwości**, kliknij przycisk **Publikuj**, a następnie kliknij przycisk **pliki aplikacji** przycisku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="93b2b-225">W **pliki aplikacji** okno dialogowe, zestaw **stan publikowania** każdego potoku i biblioteki DLL dodatku **Include (Auto)** i ustaw **grupa pobierania** dla każdego potoku dodatku DLL **(wymagane)**.</span><span class="sxs-lookup"><span data-stu-id="93b2b-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="93b2b-226">Przy użyciu potoku i dodać od podstawy aplikacji</span><span class="sxs-lookup"><span data-stu-id="93b2b-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="93b2b-227">Jeśli skonfigurowana potoku i dodać do [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] wdrożenie, są one pobierane do tej samej [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] folder pamięci podręcznej jako [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="93b2b-228">Korzystanie z potoku i dodatek z [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] kodu należy pobrać je z aplikacji podstawowej.</span><span class="sxs-lookup"><span data-stu-id="93b2b-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="93b2b-229">Różne typy i członkowie [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatku model przy użyciu potoków i dodatki obsługi specjalnych dla tego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="93b2b-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="93b2b-230">Po pierwsze, ścieżka jest identyfikowane za pomocą <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> wartości wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="93b2b-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="93b2b-231">Będzie ona używana z przeciążeń odpowiednich członków dodatku dotyczące korzystania z potokiem, które są następujące:</span><span class="sxs-lookup"><span data-stu-id="93b2b-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="93b2b-232">Uzyskiwanie dostępu do witryny pochodzenia hosta</span><span class="sxs-lookup"><span data-stu-id="93b2b-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="93b2b-233">Aby upewnić się, dodatek odwołać się do plików z witryny pochodzenia, dodatek muszą być ładowane izolacji zabezpieczeń, który jest odpowiednikiem aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="93b2b-234">Ten poziom zabezpieczeń jest identyfikowany przez <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> wartość wyliczenia i przekazywane do <xref:System.AddIn.Hosting.AddInToken.Activate%2A> metody, gdy dodatek jest aktywny.</span><span class="sxs-lookup"><span data-stu-id="93b2b-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="93b2b-235">Architektura dodatków WPF</span><span class="sxs-lookup"><span data-stu-id="93b2b-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="93b2b-236">Na najwyższym poziomie jak w związku z czym dostrzegliśmy, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] umożliwia [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dodatków do zaimplementowania [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (który pochodzi bezpośrednio lub pośrednio od <xref:System.Windows.FrameworkElement>) przy użyciu <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="93b2b-237">Wynik jest zwracany jest aplikacja hosta <xref:System.Windows.FrameworkElement> wyświetlonej z [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] w aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="93b2b-238">Dla prostej [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] scenariuszy dodatek jest możliwie szczegółowo jeden z deweloperów musi.</span><span class="sxs-lookup"><span data-stu-id="93b2b-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="93b2b-239">W przypadku bardziej złożonych scenariuszy, szczególnie te, które spróbuj korzystanie z dodatkowych [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] usługi, takie jak układ, zasobów i wiązania danych, szczegółowymi wiedzy na temat [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozszerza [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] model dodatku za pomocą [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Obsługa jest wymagana do zrozumieć jego zalety i ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="93b2b-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="93b2b-240">Zasadniczo [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] nie przeszło [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] z dodatku dla aplikacji hosta; zamiast tego [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] przechodzi uchwyt okna Win32 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] przy użyciu [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] współdziałania.</span><span class="sxs-lookup"><span data-stu-id="93b2b-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="93b2b-241">Jako takie, gdy [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] z dodatku jest przekazywany do aplikacji hosta, zostaną wykonane następujące zadania:</span><span class="sxs-lookup"><span data-stu-id="93b2b-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="93b2b-242">Po stronie dodatku [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] uzyskuje uchwytu okna dla [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] który będzie wyświetlany przez aplikację hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="93b2b-243">Uchwyt okna jest hermetyzowany przez wewnętrzną [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] klasę pochodzącą od <xref:System.Windows.Interop.HwndSource> i implementuje <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="93b2b-244">Wystąpienie tej klasy jest zwracany przez <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> i jest przekazywane z dodatku w domenie aplikacji do aplikacji hosta domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="93b2b-245">Na stronie aplikacji hosta [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] przepakowuje <xref:System.Windows.Interop.HwndSource> jako wewnętrzne [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] klasę pochodzącą od <xref:System.Windows.Interop.HwndHost> i wykorzystuje <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="93b2b-246">Wystąpienie tej klasy jest zwracany przez <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="93b2b-247"><xref:System.Windows.Interop.HwndHost> istnieje w celu wyświetlenia [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identyfikowane przez uchwytów okien z [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="93b2b-248">Aby uzyskać więcej informacji, zobacz [WPF i Win32 — współdziałanie](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="93b2b-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="93b2b-249">Podsumowując <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> pozwalających uchwytu okna dla [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] przekazany z dodatku dla aplikacji hosta, w której jest hermetyzowany przez <xref:System.Windows.Interop.HwndHost> i wyświetlane hosta aplikacji [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="93b2b-250">Ponieważ aplikacja hosta pobiera <xref:System.Windows.Interop.HwndHost>, aplikacji hosta nie można przekonwertować na obiekt, który jest zwracany przez <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> do typu jest implementowana za dodatek (na przykład <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="93b2b-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="93b2b-251">Z natury <xref:System.Windows.Interop.HwndHost> ma pewne ograniczenia, które wpływają na jak aplikacji hosta można z nich korzystać.</span><span class="sxs-lookup"><span data-stu-id="93b2b-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="93b2b-252">Jednak [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozszerza <xref:System.Windows.Interop.HwndHost> możliwości kilku scenariuszach dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="93b2b-253">Te korzyści i ograniczenia są opisane poniżej.</span><span class="sxs-lookup"><span data-stu-id="93b2b-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="93b2b-254">Korzyści z dodatku programu WPF</span><span class="sxs-lookup"><span data-stu-id="93b2b-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="93b2b-255">Ponieważ [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dodatku [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] są wyświetlane w aplikacji hosta, za pomocą klasą wewnętrzną, która pochodzi od klasy <xref:System.Windows.Interop.HwndHost>, w których [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] są ograniczone przez możliwości <xref:System.Windows.Interop.HwndHost> w odniesieniu do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] usługi, takie jak układ, renderowanie, powiązanie danych, style, szablony i zasoby.</span><span class="sxs-lookup"><span data-stu-id="93b2b-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="93b2b-256">Jednak [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozszerzają jego wewnętrznych <xref:System.Windows.Interop.HwndHost> podklasy o dodatkowe funkcje, które obejmują następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="93b2b-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="93b2b-257">Przełączania między aplikacją hosta [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] i dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="93b2b-258">Należy pamiętać, że "dodatek jest [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" modelu programowania wymaga karty Dodaj strony zastąpić <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> włączyć klawiszem TAB, czy dodatek jest w pełni zaufana, czy częściowo zaufany.</span><span class="sxs-lookup"><span data-stu-id="93b2b-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="93b2b-259">Wymagania dotyczące ułatwień dostępu dla dodatku zapewniane [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , zostaną wyświetlone z aplikacją hosta [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="93b2b-260">Włączanie [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] bezpieczne uruchamianie w wielu zastosowaniach domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="93b2b-261">Zapobieganie dostępowi niedozwolone dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] okna obsługi uruchamiania dodatków przy użyciu zabezpieczeń, izolacji (to znaczy piaskownicy częściowego zaufania zabezpieczeń).</span><span class="sxs-lookup"><span data-stu-id="93b2b-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="93b2b-262">Wywoływanie <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> zapewnia to bezpieczeństwo:</span><span class="sxs-lookup"><span data-stu-id="93b2b-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="93b2b-263">Dla "dodatek zwraca [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" model programowania, jedynym sposobem, aby przekazać uchwyt okna dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] na izolację granic jest wywołanie <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="93b2b-264">Dla "dodatek jest [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programowania modelu, zastępowanie <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> na karcie add w side i wywoływania <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (jak pokazano w poprzednich przykładach) jest wymagana, ponieważ wywoływany kartę add w side `QueryContract` implementacji z karty po stronie hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="93b2b-265">Zapewnienie ochrony wykonywania domeny w usłudze wielu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="93b2b-266">Ze względu na ograniczenia z domenami aplikacji nieobsłużonych wyjątków, które są zgłaszane w domenach aplikacji dodatku spowodować całej aplikacji ulega awarii, nawet jeśli istnieje granic izolacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="93b2b-267">Jednak [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] i [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] model dodatku zapewniają prosty sposób do obejścia tego problemu i zwiększenia stabilności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="93b2b-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dodatek, który wyświetla [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] tworzy <xref:System.Windows.Threading.Dispatcher> dla wątku, który domeny aplikacji jest wykonywany, gdy aplikacja hosta jest [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="93b2b-269">Można wykryć wszystkie nieobsługiwane wyjątki, występujących w domenie aplikacji, obsługując <xref:System.Windows.Threading.Dispatcher.UnhandledException> zdarzenia [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dodatku <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="93b2b-270">Możesz uzyskać <xref:System.Windows.Threading.Dispatcher> z <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="93b2b-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="93b2b-271">Ograniczenia dotyczące dodawania WPF</span><span class="sxs-lookup"><span data-stu-id="93b2b-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="93b2b-272">Poza korzyści, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dodaje do zachowania domyślne, dostarczone przez <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>i uchwytów okien są również ograniczenia dotyczące dodatku [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] które są wyświetlane z hosta aplikacji:</span><span class="sxs-lookup"><span data-stu-id="93b2b-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="93b2b-273">Dodatek [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] wyświetlane z hosta aplikacji nie respektują zachowanie wycinka aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="93b2b-274">Pojęcie *powietrznej* w współdziałanie scenariuszy ma również zastosowanie do dodatków (zobacz [regiony technologiczne — Przegląd](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="93b2b-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="93b2b-275">Dla aplikacji hosta [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] usług, takich jak dziedziczenie zasobów, powiązań danych i polecenia, nie są automatycznie dostępne dla dodatku [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="93b2b-276">Aby zapewnić tych usług do dodatku, należy zaktualizować potoku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="93b2b-277">Dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] nie można obracać, skalować, nierówne lub w przeciwnym razie wpływ transformacji (zobacz [przekształca Przegląd](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="93b2b-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="93b2b-278">Zawartość wewnątrz dodatku [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] który jest renderowany za pomocą rysowania operacje z <xref:System.Drawing> przestrzeni nazw może obejmować przenikaniem alfa.</span><span class="sxs-lookup"><span data-stu-id="93b2b-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="93b2b-279">Jednak zarówno dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a aplikacją hosta [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zawierający go musi być nieprzezroczyste 100%; innymi słowy, `Opacity` zarówno właściwość musi być równa 1.</span><span class="sxs-lookup"><span data-stu-id="93b2b-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="93b2b-280">Jeśli <xref:System.Windows.Window.AllowsTransparency%2A> właściwości okna aplikacji hosta, który zawiera dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ustawiono `true`, dodatek jest niewidoczna.</span><span class="sxs-lookup"><span data-stu-id="93b2b-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="93b2b-281">Ta zasada obowiązuje nawet wtedy, gdy dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] jest nieprzezroczysta 100% (czyli `Opacity` właściwość ma wartość 1).</span><span class="sxs-lookup"><span data-stu-id="93b2b-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="93b2b-282">Dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] musi znajdować się na drugim [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elementów w tym samym oknie najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="93b2b-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="93b2b-283">Nie części dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] może być renderowany przy użyciu <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="93b2b-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="93b2b-284">Zamiast tego dodatku mogą utworzyć migawkę wygenerowany [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do utworzenia mapy bitowej, który może być przekazywany do aplikacji hosta, za pomocą metod zdefiniowanych przez umowy.</span><span class="sxs-lookup"><span data-stu-id="93b2b-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="93b2b-285">Pliki multimedialne, nie można odtworzyć z <xref:System.Windows.Controls.MediaElement> w dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="93b2b-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="93b2b-286">Wskaźnik myszy generowane dla dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] nie są odbierane ani zgłoszone przez aplikację hosta i `IsMouseOver` właściwości dla aplikacji hosta [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ma wartość `false`.</span><span class="sxs-lookup"><span data-stu-id="93b2b-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="93b2b-287">Gdy fokus jest przenoszony między kontrolkami w dodatku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], `GotFocus` i `LostFocus` zdarzenia nie są odbierane ani zgłoszone przez aplikację hosta.</span><span class="sxs-lookup"><span data-stu-id="93b2b-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="93b2b-288">Część aplikacji hosta, który zawiera dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] pojawia się białe po wydrukowaniu.</span><span class="sxs-lookup"><span data-stu-id="93b2b-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="93b2b-289">Wszystkie dyspozytorów (zobacz <xref:System.Windows.Threading.Dispatcher>) utworzone przez dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] musi być zamknięty ręcznie przed dodatku właściciel jest zwalniana, gdy aplikacja hosta kontynuuje wykonywanie.</span><span class="sxs-lookup"><span data-stu-id="93b2b-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="93b2b-290">Kontrakt można implementować metody, które umożliwiają aplikacji hosta w celu sygnalizowania, że dodatek przed dodatek jest zwalniany, umożliwiając dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zamknąć jego dystrybucja.</span><span class="sxs-lookup"><span data-stu-id="93b2b-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="93b2b-291">Jeśli dodatek [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] jest <xref:System.Windows.Controls.InkCanvas> lub zawiera <xref:System.Windows.Controls.InkCanvas>, nie można zwolnić dodatku.</span><span class="sxs-lookup"><span data-stu-id="93b2b-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="93b2b-292">Optymalizacja wydajności</span><span class="sxs-lookup"><span data-stu-id="93b2b-292">Performance Optimization</span></span>  
 <span data-ttu-id="93b2b-293">Domyślnie, jeśli używanych jest wiele domen aplikacji różnych [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] zestawów wymaganych przez poszczególne aplikacje są wszystkie załadowane do domeny tej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="93b2b-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="93b2b-294">W rezultacie czas wymagany do tworzenia nowych domen aplikacji i uruchamiania aplikacji w nich może wpłynąć na wydajność.</span><span class="sxs-lookup"><span data-stu-id="93b2b-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="93b2b-295">Jednak [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] umożliwia zmniejszenie czasu uruchomienia przez poinstruowanie aplikacjom udostępnianie zestawów w domenach aplikacji, jeśli są już załadowane.</span><span class="sxs-lookup"><span data-stu-id="93b2b-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="93b2b-296">Możesz to zrobić przy użyciu <xref:System.LoaderOptimizationAttribute> atrybut, który należy zastosować do metody punktu wejścia (`Main`).</span><span class="sxs-lookup"><span data-stu-id="93b2b-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="93b2b-297">W takim przypadku musisz podać tylko kod do implementacji definicji aplikacji (zobacz [Zarządzanie aplikacjami — omówienie](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="93b2b-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="93b2b-298">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="93b2b-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="93b2b-299">Dodatki i rozszerzalność</span><span class="sxs-lookup"><span data-stu-id="93b2b-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="93b2b-300">Domeny aplikacji</span><span class="sxs-lookup"><span data-stu-id="93b2b-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="93b2b-301">Przegląd komunikacji zdalnej programu .NET framework</span><span class="sxs-lookup"><span data-stu-id="93b2b-301">.NET Framework Remoting Overview</span></span>](https://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="93b2b-302">Tworzenie obiektów może być zastosowana zdalnie</span><span class="sxs-lookup"><span data-stu-id="93b2b-302">Making Objects Remotable</span></span>](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="93b2b-303">Tematy z instrukcjami</span><span class="sxs-lookup"><span data-stu-id="93b2b-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
