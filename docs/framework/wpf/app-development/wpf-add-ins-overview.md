---
title: Omówienie dodatków
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 93904e308932ea41c736ca849ce0efb200502a7e
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/24/2020
ms.locfileid: "76738940"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="95fb4-102">Przegląd Dodatki WPF</span><span class="sxs-lookup"><span data-stu-id="95fb4-102">WPF Add-Ins Overview</span></span>

<a name="Introduction"></a><span data-ttu-id="95fb4-103">.NET Framework zawiera model dodatków, za pomocą którego deweloperzy mogą tworzyć aplikacje obsługujące rozszerzalność dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-103">The .NET Framework includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="95fb4-104">Ten model dodatku umożliwia tworzenie dodatków, które integrują się z funkcjonalnością i rozszerzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="95fb4-105">W niektórych scenariuszach aplikacje muszą również wyświetlać interfejsy użytkownika udostępniane przez dodatki. W tym temacie pokazano, w jaki sposób WPF rozszerza model dodatku .NET Framework, aby umożliwić te scenariusze, jego architekturę, korzyści i ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="95fb4-105">In some scenarios, applications also need to display user interfaces that are provided by add-ins. This topic shows how WPF augments the .NET Framework add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>

<a name="Requirements"></a>

## <a name="prerequisites"></a><span data-ttu-id="95fb4-106">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="95fb4-106">Prerequisites</span></span>

<span data-ttu-id="95fb4-107">Wymagana jest znajomość modelu dodatku .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="95fb4-107">Familiarity with the .NET Framework add-in model is required.</span></span> <span data-ttu-id="95fb4-108">Aby uzyskać więcej informacji, zobacz [Dodatki i rozszerzalność](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="95fb4-108">For more information, see [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>

<a name="AddInsOverview"></a>

## <a name="add-ins-overview"></a><span data-ttu-id="95fb4-109">Omówienie dodatków</span><span class="sxs-lookup"><span data-stu-id="95fb4-109">Add-Ins Overview</span></span>

<span data-ttu-id="95fb4-110">Aby uniknąć złożoności ponownej kompilacji i ponownego wdrożenia aplikacji w celu uwzględnienia nowych funkcji, aplikacje implementują mechanizmy rozszerzalności, które umożliwiają deweloperom (podmiotom pierwszej firmy i innej firmy) Tworzenie innych aplikacji, które Zintegruj z nimi.</span><span class="sxs-lookup"><span data-stu-id="95fb4-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="95fb4-111">Najbardziej typowym sposobem obsługi tego typu rozszerzalności jest użycie dodatków (znanych również jako "Dodatki" i "wtyczki").</span><span class="sxs-lookup"><span data-stu-id="95fb4-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="95fb4-112">Przykładowe aplikacje w świecie, które uwidaczniają rozszerzalność z dodatkami, to m.in.:</span><span class="sxs-lookup"><span data-stu-id="95fb4-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>

- <span data-ttu-id="95fb4-113">Dodatki programu Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="95fb4-113">Internet Explorer add-ons.</span></span>

- <span data-ttu-id="95fb4-114">Dodatki plug-in systemu Windows Media Player.</span><span class="sxs-lookup"><span data-stu-id="95fb4-114">Windows Media Player plug-ins.</span></span>

- <span data-ttu-id="95fb4-115">Dodatki programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="95fb4-115">Visual Studio add-ins.</span></span>

<span data-ttu-id="95fb4-116">Na przykład model dodatku systemu Windows Media Player umożliwia deweloperom innych firm implementowanie dodatków plug-in, które poszerzają Media Player systemu Windows na różne sposoby, w tym tworzenie dekoderów i koderów dla formatów multimedialnych, które nie są obsługiwane natywnie przez system Windows Media Player (na przykład DVD, MP3), efekty audio i karnacje.</span><span class="sxs-lookup"><span data-stu-id="95fb4-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="95fb4-117">Każdy model dodatku jest zbudowany w celu udostępnienia funkcji, która jest unikatowa dla aplikacji, chociaż istnieje kilka podmiotów i zachowań, które są wspólne dla wszystkich modeli dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>

<span data-ttu-id="95fb4-118">Trzy główne jednostki typowych rozwiązań rozszerzalności dodatków to *kontrakty*, *Dodatki*i *aplikacje obsługujące hosty*.</span><span class="sxs-lookup"><span data-stu-id="95fb4-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="95fb4-119">Kontrakty definiują sposób integracji dodatków z aplikacjami hosta na dwa sposoby:</span><span class="sxs-lookup"><span data-stu-id="95fb4-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>

- <span data-ttu-id="95fb4-120">Dodatki integrują się z funkcją wdrożoną przez aplikacje hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>

- <span data-ttu-id="95fb4-121">Aplikacje hosta udostępniają funkcje dodatków do integracji z programem.</span><span class="sxs-lookup"><span data-stu-id="95fb4-121">Host applications expose functionality for add-ins to integrate with.</span></span>

<span data-ttu-id="95fb4-122">Aby można było używać dodatków, aplikacje hosta muszą je znaleźć i załadować w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="95fb4-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="95fb4-123">W związku z tym aplikacje obsługujące dodatki mają następujące dodatkowe obowiązki:</span><span class="sxs-lookup"><span data-stu-id="95fb4-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>

- <span data-ttu-id="95fb4-124">**Odnajdywanie**: Znajdowanie dodatków, które są zgodne z kontraktami obsługiwanymi przez aplikacje hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>

- <span data-ttu-id="95fb4-125">**Aktywacja**: ładowanie, uruchamianie i nawiązywanie komunikacji z dodatkami.</span><span class="sxs-lookup"><span data-stu-id="95fb4-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>

- <span data-ttu-id="95fb4-126">**Izolacja**: korzystając z domen lub procesów aplikacji, można ustanowić granice izolacji chroniące aplikacje przed potencjalnymi problemami związanymi z zabezpieczeniami i wykonywaniem.</span><span class="sxs-lookup"><span data-stu-id="95fb4-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>

- <span data-ttu-id="95fb4-127">**Komunikacja**: zezwolenie na dodatki i aplikacje hosta do komunikacji ze sobą w granicach izolacji przez wywoływanie metod i przekazywanie danych.</span><span class="sxs-lookup"><span data-stu-id="95fb4-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>

- <span data-ttu-id="95fb4-128">**Zarządzanie okresem istnienia**: ładowanie i zwalnianie domen i procesów aplikacji w czysty i przewidywalny sposób (zobacz [domeny aplikacji](../../app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="95fb4-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../app-domains/application-domains.md)).</span></span>

- <span data-ttu-id="95fb4-129">**Przechowywanie wersji**: zapewnianie, że aplikacje i dodatki hosta mogą nadal komunikować się po utworzeniu nowych wersji programu.</span><span class="sxs-lookup"><span data-stu-id="95fb4-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>

<span data-ttu-id="95fb4-130">Ostatecznie tworzenie niezawodnego modelu dodatków jest nieuproszczonym przedsiębiorstwem.</span><span class="sxs-lookup"><span data-stu-id="95fb4-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="95fb4-131">Z tego powodu .NET Framework zapewnia infrastrukturę do tworzenia modeli dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-131">For this reason, the .NET Framework provides an infrastructure for building add-in models.</span></span>

> [!NOTE]
> <span data-ttu-id="95fb4-132">Aby uzyskać bardziej szczegółowe informacje na temat dodatków, zobacz [Dodatki i rozszerzalność](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="95fb4-132">For more detailed information on add-ins, see [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>

<a name="NETFrameworkAddInModelOverview"></a>

## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="95fb4-133">Omówienie modelu dodatku .NET Framework</span><span class="sxs-lookup"><span data-stu-id="95fb4-133">.NET Framework Add-In Model Overview</span></span>

<span data-ttu-id="95fb4-134">.NET Framework model dodatku, który znajduje się w przestrzeni nazw <xref:System.AddIn>, zawiera zestaw typów, które są zaprojektowane w celu uproszczenia opracowywania rozszerzalności dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-134">The .NET Framework add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="95fb4-135">Podstawową jednostką modelu dodatku .NET Framework jest *kontrakt*, który definiuje sposób, w jaki aplikacja hosta i dodatek komunikują się ze sobą.</span><span class="sxs-lookup"><span data-stu-id="95fb4-135">The fundamental unit of the .NET Framework add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="95fb4-136">Kontrakt jest udostępniany aplikacji hosta za pomocą *widoku* określonego dla aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="95fb4-137">Podobnie, szczegółowy *Widok* kontraktu jest narażony na dodatek.</span><span class="sxs-lookup"><span data-stu-id="95fb4-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="95fb4-138">*Adapter* służy do zezwalania aplikacji hosta i dodatku do komunikacji między odpowiednimi widokami kontraktu.</span><span class="sxs-lookup"><span data-stu-id="95fb4-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="95fb4-139">Kontrakty, widoki i karty są określane jako segmenty, a zestaw powiązanych segmentów stanowi *potoku*.</span><span class="sxs-lookup"><span data-stu-id="95fb4-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="95fb4-140">Potoki stanowią podstawę, w której model dodatku .NET Framework obsługuje odnajdywanie, aktywację, izolację zabezpieczeń, izolację wykonania (przy użyciu aplikacji i procesów, zarządzania komunikacją, okresem istnienia i przechowywania wersji).</span><span class="sxs-lookup"><span data-stu-id="95fb4-140">Pipelines are the foundation upon which the .NET Framework add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>

<span data-ttu-id="95fb4-141">Suma tej obsługi umożliwia deweloperom tworzenie dodatków, które integrują się z funkcjonalnością aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="95fb4-142">Jednak niektóre scenariusze wymagają, aby aplikacje hosta wyświetlały interfejsy użytkownika udostępniane przez dodatki. Ponieważ każda Technologia prezentacji w .NET Framework ma własny model do implementowania interfejsów użytkownika, .NET Framework model dodatku nie obsługuje żadnej konkretnej technologii prezentacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-142">However, some scenarios require host applications to display user interfaces provided by add-ins. Because each presentation technology in the .NET Framework has its own model for implementing user interfaces, the .NET Framework add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="95fb4-143">Zamiast tego, WPF rozszerza model dodatku .NET Framework z obsługą interfejsu użytkownika dla dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-143">Instead, WPF extends the .NET Framework add-in model with UI support for add-ins.</span></span>

<a name="WPFAddInModel"></a>

## <a name="wpf-add-ins"></a><span data-ttu-id="95fb4-144">Dodatki WPF</span><span class="sxs-lookup"><span data-stu-id="95fb4-144">WPF Add-Ins</span></span>

<span data-ttu-id="95fb4-145">WPF, w połączeniu z modelem dodatku .NET Framework, umożliwia rozwiązywanie różnorodnych scenariuszy, które wymagają, aby aplikacje hosta wyświetlały interfejsy użytkownika z dodatków. W szczególności te scenariusze są rozwiązywane przez WPF z następującymi dwoma modelami programowania:</span><span class="sxs-lookup"><span data-stu-id="95fb4-145">WPF, in conjunction with the .NET Framework add-in model, allows you to address a wide variety of scenarios that require host applications to display user interfaces from add-ins. In particular, these scenarios are addressed by WPF with the following two programming models:</span></span>

1. <span data-ttu-id="95fb4-146">**Dodatek zwraca interfejs użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="95fb4-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="95fb4-147">Dodatek zwraca interfejs użytkownika do aplikacji hosta za pośrednictwem wywołania metody, zgodnie z definicją kontraktu.</span><span class="sxs-lookup"><span data-stu-id="95fb4-147">An add-in returns a UI to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="95fb4-148">Ten scenariusz jest używany w następujących przypadkach:</span><span class="sxs-lookup"><span data-stu-id="95fb4-148">This scenario is used in the following cases:</span></span>

    - <span data-ttu-id="95fb4-149">Wygląd interfejsu użytkownika, który jest zwracany przez dodatek, zależy od danych lub warunków, które istnieją tylko w czasie wykonywania, takich jak raporty generowane dynamicznie.</span><span class="sxs-lookup"><span data-stu-id="95fb4-149">The appearance of a UI that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>

    - <span data-ttu-id="95fb4-150">Interfejs użytkownika dla usług udostępnianych przez dodatek różni się od interfejsu użytkownika aplikacji hosta, które mogą korzystać z dodatku.</span><span class="sxs-lookup"><span data-stu-id="95fb4-150">The UI for services provided by an add-in differs from the UI of the host applications that can use the add-in.</span></span>

    - <span data-ttu-id="95fb4-151">Dodatek wykonuje głównie usługę dla aplikacji hosta i raportuje stan do aplikacji hosta za pomocą interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="95fb4-151">The add-in primarily performs a service for the host application, and reports status to the host application with a UI.</span></span>

2. <span data-ttu-id="95fb4-152">**Dodatek jest interfejsem użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="95fb4-152">**The add-in is a UI**.</span></span> <span data-ttu-id="95fb4-153">Dodatek jest interfejsem użytkownika, zdefiniowanym przez kontrakt.</span><span class="sxs-lookup"><span data-stu-id="95fb4-153">An add-in is a UI, as defined by the contract.</span></span> <span data-ttu-id="95fb4-154">Ten scenariusz jest używany w następujących przypadkach:</span><span class="sxs-lookup"><span data-stu-id="95fb4-154">This scenario is used in the following cases:</span></span>

    - <span data-ttu-id="95fb4-155">Dodatek nie zapewnia usług innych niż wyświetlane, takich jak anonsowanie.</span><span class="sxs-lookup"><span data-stu-id="95fb4-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>

    - <span data-ttu-id="95fb4-156">Interfejs użytkownika dla usług udostępnianych przez dodatek jest wspólny dla wszystkich aplikacji hosta, które mogą korzystać z tego dodatku, takich jak Kalkulator lub selektor kolorów.</span><span class="sxs-lookup"><span data-stu-id="95fb4-156">The UI for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>

<span data-ttu-id="95fb4-157">Te scenariusze wymagają, aby obiekty interfejsu użytkownika mogły być przesyłane między aplikacjami hosta i domenami aplikacji dodatkowych.</span><span class="sxs-lookup"><span data-stu-id="95fb4-157">These scenarios require that UI objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="95fb4-158">Ponieważ model dodatku .NET Framework polega na komunikacji zdalnej między domenami aplikacji, obiekty, które są przekazywane między nimi, muszą być zdalne.</span><span class="sxs-lookup"><span data-stu-id="95fb4-158">Since the .NET Framework add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>

<span data-ttu-id="95fb4-159">Obiekt zdalny jest wystąpieniem klasy, która wykonuje co najmniej jedną z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="95fb4-159">A remotable object is an instance of a class that does one or more of the following:</span></span>

- <span data-ttu-id="95fb4-160">Pochodzi z klasy <xref:System.MarshalByRefObject>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>

- <span data-ttu-id="95fb4-161">Implementuje interfejs <xref:System.Runtime.Serialization.ISerializable>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>

- <span data-ttu-id="95fb4-162">Ma zastosowany atrybut <xref:System.SerializableAttribute>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>

> [!NOTE]
> <span data-ttu-id="95fb4-163">Aby uzyskać więcej informacji na temat tworzenia obiektów .NET Framework zdalnych, zobacz [Tworzenie obiektów zdalnie](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="95fb4-163">For more information regarding the creation of remotable .NET Framework objects, see [Making Objects Remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100)).</span></span>

<span data-ttu-id="95fb4-164">Typy interfejsu użytkownika WPF nie są zdalne.</span><span class="sxs-lookup"><span data-stu-id="95fb4-164">The WPF UI types are not remotable.</span></span> <span data-ttu-id="95fb4-165">Aby rozwiązać ten problem, WPF rozszerza model dodatku .NET Framework, aby umożliwić wyświetlanie interfejsu użytkownika WPF utworzonego przez dodatki do wyświetlania z aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-165">To solve the problem, WPF extends the .NET Framework add-in model to enable WPF UI created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="95fb4-166">To wsparcie jest obsługiwane przez WPF przez dwa typy: interfejs <xref:System.AddIn.Contract.INativeHandleContract> i dwie metody statyczne zaimplementowane przez klasę <xref:System.AddIn.Pipeline.FrameworkElementAdapters>: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-166">This support is provided by WPF by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="95fb4-167">Na wysokim poziomie te typy i metody są używane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="95fb4-167">At a high level, these types and methods are used in the following manner:</span></span>

1. <span data-ttu-id="95fb4-168">WPF wymaga, aby interfejsy użytkownika udostępniane przez dodatki to klasy, które są wyprowadzane bezpośrednio lub pośrednio z <xref:System.Windows.FrameworkElement>, takie jak kształty, formanty, formanty użytkownika, panele układu i strony.</span><span class="sxs-lookup"><span data-stu-id="95fb4-168">WPF requires that user interfaces provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>

2. <span data-ttu-id="95fb4-169">Wszędzie tam, gdzie umowa deklaruje, że interfejs użytkownika zostanie przekazywać między dodatkiem a aplikacją hosta, musi być zadeklarowany jako <xref:System.AddIn.Contract.INativeHandleContract> (nie <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> jest reprezentacją zdalną interfejsu użytkownika dodatku, który można przekazywać między granicami izolacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in UI that can be passed across isolation boundaries.</span></span>

3. <span data-ttu-id="95fb4-170">Przed przekazaniem z domeny aplikacji dodatku <xref:System.Windows.FrameworkElement> jest spakowany jako <xref:System.AddIn.Contract.INativeHandleContract> przez wywołanie <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>

4. <span data-ttu-id="95fb4-171">Po przekazaniu do domeny aplikacji hosta <xref:System.AddIn.Contract.INativeHandleContract> należy ponownie spakować jako <xref:System.Windows.FrameworkElement> przez wywołanie <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>

<span data-ttu-id="95fb4-172">Sposób użycia <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> zależy od konkretnego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="95fb4-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="95fb4-173">Poniższe sekcje zawierają szczegółowe informacje dotyczące każdego modelu programowania.</span><span class="sxs-lookup"><span data-stu-id="95fb4-173">The following sections provide details for each programming model.</span></span>

<a name="ReturnUIFromAddInContract"></a>

## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="95fb4-174">Dodatek zwraca interfejs użytkownika</span><span class="sxs-lookup"><span data-stu-id="95fb4-174">Add-In Returns a User Interface</span></span>

<span data-ttu-id="95fb4-175">Aby dodatek mógł zwrócić interfejs użytkownika do aplikacji hosta, wymagane są następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="95fb4-175">For an add-in to return a UI to a host application, the following are required:</span></span>

1. <span data-ttu-id="95fb4-176">Należy utworzyć aplikację hosta, dodatek i potok, zgodnie z opisem w temacie .NET Framework [Dodatki i dokumentacja rozszerzalności](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) .</span><span class="sxs-lookup"><span data-stu-id="95fb4-176">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>

2. <span data-ttu-id="95fb4-177">Kontrakt musi implementować <xref:System.AddIn.Contract.IContract> i, aby zwrócić interfejs użytkownika, kontrakt musi deklarować metodę z wartością zwracaną typu <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a UI, the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>

3. <span data-ttu-id="95fb4-178">Interfejs użytkownika, który jest przesyłany między dodatkiem a aplikacją hosta, musi bezpośrednio lub pośrednio pochodzić od <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-178">The UI that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>

4. <span data-ttu-id="95fb4-179">Interfejs użytkownika, który jest zwracany przez dodatek, musi zostać przekonwertowany z <xref:System.Windows.FrameworkElement> na <xref:System.AddIn.Contract.INativeHandleContract> przed przekroczeniem granicy izolacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-179">The UI that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>

5. <span data-ttu-id="95fb4-180">Zwracany interfejs użytkownika musi zostać przekonwertowany z <xref:System.AddIn.Contract.INativeHandleContract> na <xref:System.Windows.FrameworkElement> po przekroczeniu granicy izolacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-180">The UI that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>

6. <span data-ttu-id="95fb4-181">Aplikacja hosta wyświetla zwrócone <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>

<span data-ttu-id="95fb4-182">Przykład demonstrujący sposób implementacji dodatku, który zwraca interfejs użytkownika, znajduje się w temacie [Tworzenie dodatku, który zwraca interfejs użytkownika](how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="95fb4-182">For an example that demonstrates how to implement an add-in that returns a UI, see [Create an Add-In That Returns a UI](how-to-create-an-add-in-that-returns-a-ui.md).</span></span>

<a name="AddInIsAUI"></a>

## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="95fb4-183">Dodatek jest interfejsem użytkownika</span><span class="sxs-lookup"><span data-stu-id="95fb4-183">Add-In Is a User Interface</span></span>

<span data-ttu-id="95fb4-184">Gdy dodatek jest interfejsem użytkownika, wymagane są następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="95fb4-184">When an add-in is a UI, the following are required:</span></span>

1. <span data-ttu-id="95fb4-185">Należy utworzyć aplikację hosta, dodatek i potok, zgodnie z opisem w temacie .NET Framework [Dodatki i dokumentacja rozszerzalności](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) .</span><span class="sxs-lookup"><span data-stu-id="95fb4-185">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>

2. <span data-ttu-id="95fb4-186">Interfejs kontraktu dla dodatku musi implementować <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>

3. <span data-ttu-id="95fb4-187">Dodatek, który jest przesyłany do aplikacji hosta, musi bezpośrednio lub pośrednio pochodzić od <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>

4. <span data-ttu-id="95fb4-188">Dodatek musi zostać przekonwertowany z <xref:System.Windows.FrameworkElement> na <xref:System.AddIn.Contract.INativeHandleContract> przed przekroczeniem granicy izolacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>

5. <span data-ttu-id="95fb4-189">Dodatek musi zostać przekonwertowany z <xref:System.AddIn.Contract.INativeHandleContract> na <xref:System.Windows.FrameworkElement> po przekroczeniu granicy izolacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>

6. <span data-ttu-id="95fb4-190">Aplikacja hosta wyświetla zwrócone <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>

<span data-ttu-id="95fb4-191">Aby zapoznać się z przykładem, który ilustruje sposób implementacji dodatku, który jest interfejsem użytkownika, zobacz [Tworzenie dodatku, który jest interfejsem użytkownika](how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="95fb4-191">For an example that demonstrates how to implement an add-in that is a UI, see [Create an Add-In That Is a UI](how-to-create-an-add-in-that-is-a-ui.md).</span></span>

<a name="ReturningMultipleUIsFromAnAddIn"></a>

## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="95fb4-192">Zwracanie wielu interfejsów użytkownika z dodatku</span><span class="sxs-lookup"><span data-stu-id="95fb4-192">Returning Multiple UIs from an Add-In</span></span>

<span data-ttu-id="95fb4-193">Dodatki często udostępniają wiele interfejsów użytkownika do wyświetlania aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-193">Add-ins often provide multiple user interfaces for host applications to display.</span></span> <span data-ttu-id="95fb4-194">Rozważmy na przykład dodatek, który jest interfejsem użytkownika, który udostępnia również informacje o stanie aplikacji hosta, również jako interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="95fb4-194">For example, consider an add-in that is a UI that also provides status information to the host application, also as a UI.</span></span> <span data-ttu-id="95fb4-195">Dodatek podobny do tego można zaimplementować przy użyciu kombinacji technik z obu [dodatków zwraca interfejs użytkownika](#ReturnUIFromAddInContract) , a [dodatek jest modelami interfejsu użytkownika](#AddInIsAUI) .</span><span class="sxs-lookup"><span data-stu-id="95fb4-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>

<a name="AddInsAndXBAPs"></a>

## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="95fb4-196">Dodatki i aplikacje przeglądarki XAML</span><span class="sxs-lookup"><span data-stu-id="95fb4-196">Add-Ins and XAML Browser Applications</span></span>

<span data-ttu-id="95fb4-197">W przykładach do tej pory aplikacja hosta była zainstalowaną aplikacją autonomiczną.</span><span class="sxs-lookup"><span data-stu-id="95fb4-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="95fb4-198">Jednak aplikacje przeglądarki XAML (XBAP) mogą również hostować dodatki, chociaż z następującymi dodatkowymi wymaganiami dotyczącymi kompilacji i implementacji:</span><span class="sxs-lookup"><span data-stu-id="95fb4-198">But XAML browser applications (XBAPs) can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>

- <span data-ttu-id="95fb4-199">Manifest aplikacji XBAP musi być skonfigurowany specjalnie do pobierania potoku (folderów i zestawów) oraz zestawu dodatków do pamięci podręcznej aplikacji ClickOnce na komputerze klienckim, w tym samym folderze, w którym znajduje się aplikacja XBAP.</span><span class="sxs-lookup"><span data-stu-id="95fb4-199">The XBAP application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the ClickOnce application cache on the client machine, in the same folder as the XBAP.</span></span>

- <span data-ttu-id="95fb4-200">Kod XBAP do odnalezienia i załadowania dodatków musi używać pamięci podręcznej aplikacji ClickOnce dla programu XBAP jako lokalizacji potoków i dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-200">The XBAP code to discover and load add-ins must use the ClickOnce application cache for the XBAP as the pipeline and add-in location.</span></span>

- <span data-ttu-id="95fb4-201">Obiekt XBAP musi załadować dodatek do specjalnego kontekstu zabezpieczeń, jeśli dodatek odwołuje się do luźnych plików, które znajdują się w miejscu pochodzenia; w przypadku obsługi przez aplikacje XBAP Dodatki mogą odwoływać się tylko do swobodnych plików, które znajdują się w lokalizacji źródłowej aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-201">The XBAP must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by XBAPs, add-ins can only reference loose files that are located at the host application's site of origin.</span></span>

<span data-ttu-id="95fb4-202">Te zadania są szczegółowo opisane w poniższych podsekcjach.</span><span class="sxs-lookup"><span data-stu-id="95fb4-202">These tasks are described in detail in the following subsections.</span></span>

### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="95fb4-203">Konfigurowanie potoku i dodatku dla wdrożenia ClickOnce</span><span class="sxs-lookup"><span data-stu-id="95fb4-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>

<span data-ttu-id="95fb4-204">Aplikacje XBAP są pobierane do programu i uruchamiane z bezpiecznego folderu w pamięci podręcznej wdrażania ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="95fb4-204">XBAPs are downloaded to and run from a safe folder in the ClickOnce deployment cache.</span></span> <span data-ttu-id="95fb4-205">Aby element XBAP obsługiwał dodatek, należy również pobrać potok i zestaw dodatków do bezpiecznego folderu.</span><span class="sxs-lookup"><span data-stu-id="95fb4-205">In order for an XBAP to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="95fb4-206">Aby to osiągnąć, należy skonfigurować manifest aplikacji w taki sposób, aby obejmował zarówno potok, jak i zestaw dodatków do pobrania.</span><span class="sxs-lookup"><span data-stu-id="95fb4-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="95fb4-207">Jest to najłatwiej wykonywane w programie Visual Studio, chociaż potok i zestaw dodatku muszą znajdować się w folderze głównym aplikacji XBAP hosta, aby program Visual Studio wykrył zestawy potoków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-207">This is most easily done in Visual Studio, although the pipeline and add-in assembly needs to be in the host XBAP project's root folder in order for Visual Studio to detect the pipeline assemblies.</span></span>

<span data-ttu-id="95fb4-208">W związku z tym pierwszym krokiem jest skompilowanie potoku i zestawu dodatków do katalogu głównego projektu XBAP przez ustawienie danych wyjściowych kompilacji dla każdego zestawu potoku i projektów zestawu dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-208">Consequently, the first step is to build the pipeline and add-in assembly to the XBAP project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="95fb4-209">W poniższej tabeli przedstawiono ścieżki wyjściowe kompilacji dla projektów zestawu potoku i projektu zestawu dodatków, które znajdują się w tym samym rozwiązaniu i folderze głównym co projekt XBAP.</span><span class="sxs-lookup"><span data-stu-id="95fb4-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host XBAP project.</span></span>

<span data-ttu-id="95fb4-210">Tabela 1: Tworzenie ścieżek wyjściowych dla zestawów potoku hostowanych przez aplikację XBAP</span><span class="sxs-lookup"><span data-stu-id="95fb4-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>

|<span data-ttu-id="95fb4-211">Projekt zestawu potoku</span><span class="sxs-lookup"><span data-stu-id="95fb4-211">Pipeline assembly project</span></span>|<span data-ttu-id="95fb4-212">Ścieżka wyjściowa kompilacji</span><span class="sxs-lookup"><span data-stu-id="95fb4-212">Build output path</span></span>|
|-------------------------------|-----------------------|
|<span data-ttu-id="95fb4-213">Kontrakt</span><span class="sxs-lookup"><span data-stu-id="95fb4-213">Contract</span></span>|`..\HostXBAP\Contracts\`|
|<span data-ttu-id="95fb4-214">Widok dodatku</span><span class="sxs-lookup"><span data-stu-id="95fb4-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|
|<span data-ttu-id="95fb4-215">Adapter dodatku</span><span class="sxs-lookup"><span data-stu-id="95fb4-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|
|<span data-ttu-id="95fb4-216">Adapter po stronie hosta</span><span class="sxs-lookup"><span data-stu-id="95fb4-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|
|<span data-ttu-id="95fb4-217">Dodatek</span><span class="sxs-lookup"><span data-stu-id="95fb4-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|

<span data-ttu-id="95fb4-218">Następnym krokiem jest określenie zestawów potoków i zestawu dodatków jako plików zawartości XBAP w programie Visual Studio, wykonując następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="95fb4-218">The next step is to specify the pipeline assemblies and add-in assembly as the XBAPs content files in Visual Studio by doing the following:</span></span>

1. <span data-ttu-id="95fb4-219">Uwzględniając potok i zestaw dodatków w projekcie, klikając prawym przyciskiem myszy każdy folder potoku w Eksplorator rozwiązań i wybierając opcję **Dołącz do projektu**.</span><span class="sxs-lookup"><span data-stu-id="95fb4-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>

2. <span data-ttu-id="95fb4-220">Ustawianie **akcji kompilacji** dla każdego zestawu potoku i zestawu dodatków do **zawartości** z okna **Właściwości** .</span><span class="sxs-lookup"><span data-stu-id="95fb4-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>

<span data-ttu-id="95fb4-221">Ostatnim krokiem jest skonfigurowanie manifestu aplikacji w celu uwzględnienia plików zestawu potoku i pliku zestawu dodatku do pobrania.</span><span class="sxs-lookup"><span data-stu-id="95fb4-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="95fb4-222">Pliki powinny znajdować się w folderach w folderze głównym folderu w pamięci podręcznej ClickOnce, w której zajmowana jest aplikacja XBAP.</span><span class="sxs-lookup"><span data-stu-id="95fb4-222">The files should be located in folders at the root of the folder in the ClickOnce cache that the XBAP application occupies.</span></span> <span data-ttu-id="95fb4-223">Konfigurację można uzyskać w programie Visual Studio, wykonując następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="95fb4-223">The configuration can be achieved in Visual Studio by doing the following:</span></span>

1. <span data-ttu-id="95fb4-224">Kliknij prawym przyciskiem myszy projekt XBAP, kliknij pozycję **Właściwości**, kliknij pozycję **Opublikuj**, a następnie kliknij przycisk **pliki aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="95fb4-224">Right-click the XBAP project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>

2. <span data-ttu-id="95fb4-225">W oknie dialogowym **pliki aplikacji** Ustaw **stan publikacji** każdego potoku i dodatku dll na wartość ( **Auto)** i ustaw **grupę pobierania** dla każdego potoku i dodatku dll na **(wymagane)** .</span><span class="sxs-lookup"><span data-stu-id="95fb4-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>

### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="95fb4-226">Korzystanie z potoku i dodatku z bazy aplikacji</span><span class="sxs-lookup"><span data-stu-id="95fb4-226">Using the Pipeline and Add-In from the Application Base</span></span>

<span data-ttu-id="95fb4-227">Gdy potok i dodatek są skonfigurowane pod kątem wdrażania ClickOnce, są one pobierane do tego samego folderu pamięci podręcznej ClickOnce co aplikacje XBAP.</span><span class="sxs-lookup"><span data-stu-id="95fb4-227">When the pipeline and add-in are configured for ClickOnce deployment, they are downloaded to the same ClickOnce cache folder as the XBAP.</span></span> <span data-ttu-id="95fb4-228">Aby użyć potoku i dodatku z programu XBAP, kod XBAP musi pobrać z bazy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-228">To use the pipeline and add-in from the XBAP, the XBAP code must get them from the application base.</span></span> <span data-ttu-id="95fb4-229">Różne typy i elementy członkowskie modelu dodatku .NET Framework na potrzeby używania potoków i dodatków zapewniają specjalną pomoc techniczną dla tego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="95fb4-229">The various types and members of the .NET Framework add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="95fb4-230">Po pierwsze ścieżka jest identyfikowana przez <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> wartość wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="95fb4-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="95fb4-231">Ta wartość jest używana z przeciążeniami odpowiednich członków dodatku, aby używać potoków, które obejmują następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="95fb4-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>

- <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="95fb4-232">Uzyskiwanie dostępu do lokacji hosta pochodzenia</span><span class="sxs-lookup"><span data-stu-id="95fb4-232">Accessing the Host's Site of Origin</span></span>

<span data-ttu-id="95fb4-233">Aby zapewnić, że dodatek może odwoływać się do plików z lokacji źródłowej, dodatek musi być załadowany z izolacją zabezpieczeń, która jest równoważna z aplikacją hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="95fb4-234">Ten poziom zabezpieczeń jest identyfikowany przez <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> wartość wyliczenia i przeszedł do metody <xref:System.AddIn.Hosting.AddInToken.Activate%2A>, gdy dodatek jest aktywowany.</span><span class="sxs-lookup"><span data-stu-id="95fb4-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>

<a name="WPFAddInModelArchitecture"></a>

## <a name="wpf-add-in-architecture"></a><span data-ttu-id="95fb4-235">Architektura dodatku WPF</span><span class="sxs-lookup"><span data-stu-id="95fb4-235">WPF Add-In Architecture</span></span>

<span data-ttu-id="95fb4-236">Na najwyższym poziomie, w miarę jak się widzimy, WPF umożliwia .NET Framework dodatków do implementowania interfejsów użytkownika (które pochodzą bezpośrednio lub pośrednio z <xref:System.Windows.FrameworkElement>) przy użyciu <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-236">At the highest level, as we've seen, WPF enables .NET Framework add-ins to implement user interfaces (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="95fb4-237">Wynika to z tego, że aplikacja hosta zwraca <xref:System.Windows.FrameworkElement>, który jest wyświetlany z interfejsu użytkownika w aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from UI in the host application.</span></span>

<span data-ttu-id="95fb4-238">W przypadku prostych scenariuszy dodatków interfejsu użytkownika jest to tak szczegółowe, jak w przypadku deweloperów.</span><span class="sxs-lookup"><span data-stu-id="95fb4-238">For simple UI add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="95fb4-239">W przypadku bardziej złożonych scenariuszy, szczególnie tych, które próbują korzystać z dodatkowych usług WPF, takich jak układ, zasoby i powiązania danych, bardziej szczegółową wiedzą o tym, jak WPF rozszerza model dodatku .NET Framework z obsługą interfejsu użytkownika, aby zrozumieć jego korzyści i ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="95fb4-239">For more complex scenarios, particularly those that try to utilize additional WPF services such as layout, resources, and data binding, more detailed knowledge of how WPF extends the .NET Framework add-in model with UI support is required to understand its benefits and limitations.</span></span>

<span data-ttu-id="95fb4-240">W rzeczywistości funkcja WPF nie przekazuje interfejsu użytkownika z dodatku do aplikacji hosta. Zamiast tego, WPF przekazuje uchwyt okna Win32 dla interfejsu użytkownika przy użyciu współdziałania WPF.</span><span class="sxs-lookup"><span data-stu-id="95fb4-240">Fundamentally, WPF doesn't pass a UI from an add-in to a host application; instead, WPF passes the Win32 window handle for the UI by using WPF interoperability.</span></span> <span data-ttu-id="95fb4-241">W związku z tym, gdy interfejs użytkownika z dodatku jest przesyłany do aplikacji hosta, występują następujące sytuacje:</span><span class="sxs-lookup"><span data-stu-id="95fb4-241">As such, when a UI from an add-in is passed to a host application, the following occurs:</span></span>

- <span data-ttu-id="95fb4-242">Na stronie dodatku WPF uzyskuje uchwyt okna dla interfejsu użytkownika, który będzie wyświetlany przez aplikację hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-242">On the add-in side, WPF acquires a window handle for the UI that will be displayed by the host application.</span></span> <span data-ttu-id="95fb4-243">Uchwyt okna jest hermetyzowany przez wewnętrzną klasę WPF, która pochodzi z <xref:System.Windows.Interop.HwndSource> i implementuje <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-243">The window handle is encapsulated by an internal WPF class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="95fb4-244">Wystąpienie tej klasy jest zwracane przez <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> i jest organizowane z domeny aplikacji dodatku do domeny aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>

- <span data-ttu-id="95fb4-245">Na stronie aplikacji hosta platforma WPF ponownie pakuje <xref:System.Windows.Interop.HwndSource> jako wewnętrzną klasę WPF, która pochodzi od <xref:System.Windows.Interop.HwndHost> i wykorzystuje <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-245">On the host application side, WPF repackages the <xref:System.Windows.Interop.HwndSource> as an internal WPF class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="95fb4-246">Wystąpienie tej klasy jest zwracane przez <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> do aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>

<span data-ttu-id="95fb4-247"><xref:System.Windows.Interop.HwndHost> istnieje, aby wyświetlić interfejsy użytkownika, identyfikowane przez uchwyty okna, z interfejsów użytkownika WPF.</span><span class="sxs-lookup"><span data-stu-id="95fb4-247"><xref:System.Windows.Interop.HwndHost> exists to display user interfaces, identified by window handles, from WPF user interfaces.</span></span> <span data-ttu-id="95fb4-248">Aby uzyskać więcej informacji, zobacz [WPF i Win32 — współdziałanie](../advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="95fb4-248">For more information, see [WPF and Win32 Interoperation](../advanced/wpf-and-win32-interoperation.md).</span></span>

<span data-ttu-id="95fb4-249">Podsumowując, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>i <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> istnieją, aby zezwolić na przekazywanie uchwytu okna dla interfejsu użytkownika WPF z dodatku do aplikacji hosta, gdzie jest on hermetyzowany przez <xref:System.Windows.Interop.HwndHost> i wyświetla interfejs użytkownika aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a WPF UI to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's UI.</span></span>

> [!NOTE]
> <span data-ttu-id="95fb4-250">Ponieważ aplikacja hosta pobiera <xref:System.Windows.Interop.HwndHost>, aplikacja hosta nie może skonwertować obiektu, który jest zwracany przez <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> do typu, który jest implementowany przez dodatek (na przykład <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="95fb4-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>

<span data-ttu-id="95fb4-251">Z natury <xref:System.Windows.Interop.HwndHost> ma pewne ograniczenia, które mają wpływ na sposób ich używania przez aplikacje hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="95fb4-252">Jednak WPF rozszerza <xref:System.Windows.Interop.HwndHost> z kilkoma funkcjami dla scenariuszy dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-252">However, WPF extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="95fb4-253">Te korzyści i ograniczenia są opisane poniżej.</span><span class="sxs-lookup"><span data-stu-id="95fb4-253">These benefits and limitations are described below.</span></span>

<a name="WPFAddInModelBenefits"></a>

## <a name="wpf-add-in-benefits"></a><span data-ttu-id="95fb4-254">Zalety dodatków WPF</span><span class="sxs-lookup"><span data-stu-id="95fb4-254">WPF Add-In Benefits</span></span>

<span data-ttu-id="95fb4-255">Ponieważ interfejsy użytkownika dodatku WPF są wyświetlane z aplikacji hosta przy użyciu wewnętrznej klasy, która pochodzi od <xref:System.Windows.Interop.HwndHost>, te interfejsy użytkownika są ograniczone przez możliwości <xref:System.Windows.Interop.HwndHost> w odniesieniu do usług interfejsu użytkownika WPF, takich jak układ, renderowanie, powiązanie danych, style, szablony i zasoby.</span><span class="sxs-lookup"><span data-stu-id="95fb4-255">Because WPF add-in user interfaces are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those user interfaces are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to WPF UI services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="95fb4-256">Jednak WPF rozszerza swoją wewnętrzną podklasę <xref:System.Windows.Interop.HwndHost> z dodatkowymi możliwościami, które obejmują następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="95fb4-256">However, WPF augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>

- <span data-ttu-id="95fb4-257">Tabulacja między interfejsem użytkownika aplikacji hosta i interfejsem użytkownika dodatku.</span><span class="sxs-lookup"><span data-stu-id="95fb4-257">Tabbing between a host application's UI and an add-in's UI.</span></span> <span data-ttu-id="95fb4-258">Należy pamiętać, że model programowania "dodatek jest interfejsem użytkownika" wymaga adaptera dodatku, aby przesłonić <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A>, aby włączyć funkcję tabulacji, niezależnie od tego, czy dodatek jest w pełni zaufany, czy częściowo zaufany.</span><span class="sxs-lookup"><span data-stu-id="95fb4-258">Note that the "add-in is a UI" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>

- <span data-ttu-id="95fb4-259">Przestrzeganie wymagań dotyczących ułatwień dostępu dla interfejsów użytkownika dodatku, które są wyświetlane z interfejsów użytkownika aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-259">Honoring accessibility requirements for add-in user interfaces that are displayed from host application user interfaces.</span></span>

- <span data-ttu-id="95fb4-260">Włączanie bezpiecznego działania aplikacji WPF w wielu scenariuszach domen aplikacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-260">Enabling WPF applications to run safely in multiple application domain scenarios.</span></span>

- <span data-ttu-id="95fb4-261">Zapobiegaj nielegalnemu dostępowi do okna interfejsu użytkownika dodatku, gdy dodatki są uruchamiane z izolacją zabezpieczeń (to jest obszar piaskownicy zabezpieczeń częściowego zaufania).</span><span class="sxs-lookup"><span data-stu-id="95fb4-261">Preventing illegal access to add-in UI window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="95fb4-262">Wywołanie <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> zapewnia następujące zabezpieczenia:</span><span class="sxs-lookup"><span data-stu-id="95fb4-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>

  - <span data-ttu-id="95fb4-263">W przypadku modelu programowania "dodatek zwraca interfejs użytkownika" jedynym sposobem przekazania uchwytu okna dla interfejsu użytkownika dodatku w granicach izolacji jest wywołanie <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-263">For the "add-in returns a UI" programming model, the only way to pass the window handle for an add-in UI across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>

  - <span data-ttu-id="95fb4-264">W przypadku modelu programowania "dodatek jest interfejsem użytkownika" zastępowanie <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> na adapterze po stronie dodatku i wywoływanie <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (jak pokazano w powyższych przykładach) jest wymagane, ponieważ wywołuje implementację `QueryContract` z karty sieciowej po stronie hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-264">For the "add-in is a UI" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>

- <span data-ttu-id="95fb4-265">Udostępnianie wielu domen aplikacji ochrony przed wykonywaniem.</span><span class="sxs-lookup"><span data-stu-id="95fb4-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="95fb4-266">Ze względu na ograniczenia dotyczące domen aplikacji Nieobsłużone wyjątki, które są zgłaszane w domenach aplikacji dodatków, powodują awarię całej aplikacji, nawet jeśli istnieje granica izolacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="95fb4-267">Jednak funkcja WPF i .NET Framework model dodatków zapewniają prosty sposób obejścia tego problemu i zwiększenie stabilności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="95fb4-267">However, WPF and the .NET Framework add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="95fb4-268">Dodatek WPF, który wyświetla interfejs użytkownika tworzy <xref:System.Windows.Threading.Dispatcher> wątku, w którym jest uruchomiona domena aplikacji, jeśli aplikacja hosta jest aplikacją WPF.</span><span class="sxs-lookup"><span data-stu-id="95fb4-268">A WPF add-in that displays a UI creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a WPF application.</span></span> <span data-ttu-id="95fb4-269">Można wykryć wszystkie Nieobsłużone wyjątki, które występują w domenie aplikacji przez obsługę zdarzenia <xref:System.Windows.Threading.Dispatcher.UnhandledException> <xref:System.Windows.Threading.Dispatcher>dodatku WPF.</span><span class="sxs-lookup"><span data-stu-id="95fb4-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the WPF add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="95fb4-270"><xref:System.Windows.Threading.Dispatcher> można uzyskać z właściwości <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>

<a name="WPFAddInModelLimitations"></a>

## <a name="wpf-add-in-limitations"></a><span data-ttu-id="95fb4-271">Ograniczenia dodatku WPF</span><span class="sxs-lookup"><span data-stu-id="95fb4-271">WPF Add-In Limitations</span></span>

<span data-ttu-id="95fb4-272">Poza korzyściami, które program WPF dodaje do domyślnych zachowań dostarczonych przez <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>i uchwyty okna, istnieją także ograniczenia dotyczące interfejsów użytkownika dodatku, które są wyświetlane z aplikacji hosta:</span><span class="sxs-lookup"><span data-stu-id="95fb4-272">Beyond the benefits that WPF adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in user interfaces that are displayed from host applications:</span></span>

- <span data-ttu-id="95fb4-273">Interfejsy użytkownika dodatku wyświetlane z aplikacji hosta nie respektują zachowania wycinka aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-273">Add-in user interfaces displayed from a host application do not respect the host application's clipping behavior.</span></span>

- <span data-ttu-id="95fb4-274">Koncepcja *przestrzeni powietrznej* w scenariuszach współdziałania dotyczy również dodatków (zobacz [Omówienie regionów technologicznych](../advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="95fb4-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../advanced/technology-regions-overview.md)).</span></span>

- <span data-ttu-id="95fb4-275">Usługi interfejsu użytkownika aplikacji hosta, takie jak dziedziczenie zasobów, powiązanie danych i polecenia, nie są automatycznie dostępne dla interfejsów użytkowników dodatków.</span><span class="sxs-lookup"><span data-stu-id="95fb4-275">A host application's UI services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in user interfaces.</span></span> <span data-ttu-id="95fb4-276">Aby zapewnić te usługi dla dodatku, należy zaktualizować potoku.</span><span class="sxs-lookup"><span data-stu-id="95fb4-276">To provide these services to the add-in, you need to update the pipeline.</span></span>

- <span data-ttu-id="95fb4-277">Nie można obrócić, przeskalować, obchylać lub w inny sposób przekształceniu (zobacz [Przegląd transformacji](../graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="95fb4-277">An add-in UI cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../graphics-multimedia/transforms-overview.md)).</span></span>

- <span data-ttu-id="95fb4-278">Zawartość wewnątrz interfejsów użytkownika dodatku, które są renderowane przez operacje rysowania z przestrzeni nazw <xref:System.Drawing>, może obejmować mieszanie alfa.</span><span class="sxs-lookup"><span data-stu-id="95fb4-278">Content inside add-in user interfaces that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="95fb4-279">Jednak zarówno interfejs użytkownika dodatku, jak i interfejs użytkownika aplikacji hosta, który go zawiera, muszą być 100% nieprzezroczyste; Innymi słowy Właściwość `Opacity` obu tych wartości musi być ustawiona na 1.</span><span class="sxs-lookup"><span data-stu-id="95fb4-279">However, both an add-in UI and the host application UI that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>

- <span data-ttu-id="95fb4-280">Jeśli właściwość <xref:System.Windows.Window.AllowsTransparency%2A> okna w aplikacji hosta zawierającej interfejs użytkownika dodatku ma wartość `true`, dodatek jest niewidoczny.</span><span class="sxs-lookup"><span data-stu-id="95fb4-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in UI is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="95fb4-281">Jest to prawdziwe, nawet jeśli interfejs użytkownika dodatku ma 100% nieprzezroczysty (oznacza to, że właściwość `Opacity` ma wartość 1).</span><span class="sxs-lookup"><span data-stu-id="95fb4-281">This is true even if the add-in UI is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>

- <span data-ttu-id="95fb4-282">Interfejs użytkownika dodatku musi znajdować się na innych elementach WPF w tym samym oknie najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="95fb4-282">An add-in UI must appear on top of other WPF elements in the same top-level window.</span></span>

- <span data-ttu-id="95fb4-283">Żadna część interfejsu użytkownika dodatku nie może być renderowana przy użyciu <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="95fb4-283">No portion of an add-in's UI can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="95fb4-284">Zamiast tego dodatek może wykonać migawkę wygenerowanego interfejsu użytkownika w celu utworzenia mapy bitowej, która może zostać przeniesiona do aplikacji hosta przy użyciu metod zdefiniowanych przez umowę.</span><span class="sxs-lookup"><span data-stu-id="95fb4-284">Instead, the add-in may take a snapshot of the generated UI to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>

- <span data-ttu-id="95fb4-285">Pliki multimedialne nie mogą być odtwarzane z <xref:System.Windows.Controls.MediaElement> w interfejsie użytkownika dodatku.</span><span class="sxs-lookup"><span data-stu-id="95fb4-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in UI.</span></span>

- <span data-ttu-id="95fb4-286">Zdarzenia myszy wygenerowane dla interfejsu użytkownika dodatku nie są odbierane ani zgłaszane przez aplikację hosta, a właściwość `IsMouseOver` dla interfejsu użytkownika aplikacji hosta ma wartość `false`.</span><span class="sxs-lookup"><span data-stu-id="95fb4-286">Mouse events generated for the add-in UI are neither received nor raised by the host application, and the `IsMouseOver` property for host application UI has a value of `false`.</span></span>

- <span data-ttu-id="95fb4-287">Gdy fokus jest przenoszony między kontrolkami w interfejsie użytkownika dodatku, zdarzenia `GotFocus` i `LostFocus` nie są odbierane ani zgłaszane przez aplikację hosta.</span><span class="sxs-lookup"><span data-stu-id="95fb4-287">When focus shifts between controls in an add-in UI, the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>

- <span data-ttu-id="95fb4-288">Część aplikacji hosta zawierającej interfejs użytkownika dodatku pojawia się biały podczas drukowania.</span><span class="sxs-lookup"><span data-stu-id="95fb4-288">The portion of a host application that contains an add-in UI appears white when printed.</span></span>

- <span data-ttu-id="95fb4-289">Wszystkie dyspozytory (zobacz <xref:System.Windows.Threading.Dispatcher>) utworzone za pomocą interfejsu użytkownika dodatku muszą być zamykane ręcznie przed wyładowaniem dodatku właściciela, jeśli aplikacja hosta kontynuuje wykonywanie.</span><span class="sxs-lookup"><span data-stu-id="95fb4-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in UI must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="95fb4-290">Umowa może implementować metody, które umożliwiają aplikacji hosta zasygnalizowanie dodatku przed usunięciem dodatku, a tym samym dodanie go do interfejsu użytkownika dodatku.</span><span class="sxs-lookup"><span data-stu-id="95fb4-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in UI to shut down its dispatchers.</span></span>

- <span data-ttu-id="95fb4-291">Jeśli interfejs użytkownika dodatku jest <xref:System.Windows.Controls.InkCanvas> lub zawiera <xref:System.Windows.Controls.InkCanvas>, nie można zwolnić dodatku.</span><span class="sxs-lookup"><span data-stu-id="95fb4-291">If an add-in UI is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>

<a name="PerformanceOptimization"></a>

## <a name="performance-optimization"></a><span data-ttu-id="95fb4-292">Optymalizacja wydajności</span><span class="sxs-lookup"><span data-stu-id="95fb4-292">Performance Optimization</span></span>

<span data-ttu-id="95fb4-293">Domyślnie, gdy są używane wiele domen aplikacji, do domeny tej aplikacji są ładowane różne zestawy .NET Framework wymagane przez poszczególne aplikacje.</span><span class="sxs-lookup"><span data-stu-id="95fb4-293">By default, when multiple application domains are used, the various .NET Framework assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="95fb4-294">W związku z tym czas wymagany do tworzenia nowych domen aplikacji i uruchamiania aplikacji w nich może mieć wpływ na wydajność.</span><span class="sxs-lookup"><span data-stu-id="95fb4-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="95fb4-295">Jednak .NET Framework umożliwia skrócenie czasu uruchamiania przez nakazujenie aplikacjom udostępniania zestawów w domenach aplikacji, jeśli są już załadowane.</span><span class="sxs-lookup"><span data-stu-id="95fb4-295">However, the .NET Framework provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="95fb4-296">W tym celu należy użyć atrybutu <xref:System.LoaderOptimizationAttribute>, który należy zastosować do metody punktu wejścia (`Main`).</span><span class="sxs-lookup"><span data-stu-id="95fb4-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="95fb4-297">W takim przypadku należy użyć tylko kodu w celu zaimplementowania definicji aplikacji (zobacz [Omówienie zarządzania aplikacjami](application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="95fb4-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](application-management-overview.md)).</span></span>

## <a name="see-also"></a><span data-ttu-id="95fb4-298">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="95fb4-298">See also</span></span>

- <xref:System.LoaderOptimizationAttribute>
- <span data-ttu-id="95fb4-299">[Dodatki i rozszerzalność](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span><span class="sxs-lookup"><span data-stu-id="95fb4-299">[Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span></span>
- [<span data-ttu-id="95fb4-300">Domeny aplikacji</span><span class="sxs-lookup"><span data-stu-id="95fb4-300">Application Domains</span></span>](../../app-domains/application-domains.md)
- <span data-ttu-id="95fb4-301">[.NET Framework Omówienie usług zdalnych](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/kwdt6w2k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="95fb4-301">[.NET Framework Remoting Overview](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/kwdt6w2k(v=vs.100))</span></span>
- <span data-ttu-id="95fb4-302">[Udostępnianie obiektów zdalnie](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="95fb4-302">[Making Objects Remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))</span></span>
- [<span data-ttu-id="95fb4-303">Tematy z instrukcjami</span><span class="sxs-lookup"><span data-stu-id="95fb4-303">How-to Topics</span></span>](how-to-topics.md)
