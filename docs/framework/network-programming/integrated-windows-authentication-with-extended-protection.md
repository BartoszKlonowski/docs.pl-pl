---
title: Zintegrowane uwierzytelnianie systemu Windows z ochrony rozszerzonej
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 81731998-d5e7-49e4-ad38-c8e6d01689d0
caps.latest.revision: "13"
author: mcleblanc
ms.author: markl
manager: markl
ms.openlocfilehash: a32019a99421cdb2b581f1196a0e477c8e5d30a4
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/21/2017
---
# <a name="integrated-windows-authentication-with-extended-protection"></a><span data-ttu-id="b4d4b-102">Zintegrowane uwierzytelnianie systemu Windows z ochrony rozszerzonej</span><span class="sxs-lookup"><span data-stu-id="b4d4b-102">Integrated Windows Authentication with Extended Protection</span></span>
<span data-ttu-id="b4d4b-103">Wprowadzono ulepszenia, które mają wpływ na sposób zintegrowane z systemem Windows uwierzytelnianie jest obsługiwane przez <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream>, i powiązanych klas w <xref:System.Net> i związanych z przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-103">Enhancements were made that affect how integrated Windows authentication is handled by the <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream>, and related classes in the <xref:System.Net> and related namespaces.</span></span> <span data-ttu-id="b4d4b-104">Dodano obsługę ochrony rozszerzonej zwiększyć bezpieczeństwo.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-104">Support was added for extended protection to enhance security.</span></span>  
  
 <span data-ttu-id="b4d4b-105">Te zmiany mogą wpłynąć na aplikacji, które używają tych klas do żądań sieci web i odbierania odpowiedzi, gdzie jest używane zintegrowane uwierzytelnianie systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-105">These changes can affect applications that use these classes to make web requests and receive responses where integrated Windows authentication is used.</span></span> <span data-ttu-id="b4d4b-106">Ta zmiana może wpłynąć na serwery sieci web i aplikacji klienckich, które są skonfigurowane do korzystania ze zintegrowanego uwierzytelniania systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-106">This change can also impact web servers and client applications that are configured to use integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="b4d4b-107">Te zmiany mogą wpłynąć na aplikacji, które używają tych klas inne rodzaje żądań i odbierania odpowiedzi, gdzie jest używane zintegrowane uwierzytelnianie systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-107">These changes can also affect applications that use these classes to make other types of requests and receive responses where integrated Windows authentication is used.</span></span>  
  
 <span data-ttu-id="b4d4b-108">Zmiany do obsługi ochrony rozszerzonej są dostępne tylko dla aplikacji w systemie Windows 7 i Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-108">The changes to support extended protection are available only for applications on Windows 7 and Windows Server 2008 R2.</span></span> <span data-ttu-id="b4d4b-109">Funkcje ochrony rozszerzonej nie są dostępne w starszych wersjach systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-109">The extended protection features are not available on earlier versions of Windows.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="b4d4b-110">Omówienie</span><span class="sxs-lookup"><span data-stu-id="b4d4b-110">Overview</span></span>  
 <span data-ttu-id="b4d4b-111">Projekt zintegrowane uwierzytelnianie systemu Windows umożliwia niektóre odpowiedzi żądania poświadczeń jako uniwersalny, czyli może być ponownie używane lub przesyłane dalej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-111">The design of integrated Windows authentication allows for some credential challenge responses to be universal, meaning they can be re-used or forwarded.</span></span> <span data-ttu-id="b4d4b-112">Odpowiedzi na żądanie należy konstruować co najmniej z informacjami o określonych docelowych, najlepiej również pewne informacje określonego kanału.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-112">The challenge responses should be constructed at a minimum with target specific information and preferably also with some channel specific information.</span></span> <span data-ttu-id="b4d4b-113">Usługi mogą udzielić im ochrona rozszerzona, aby upewnić się, że poświadczenia odpowiedzi na żądanie zawiera usługi określone informacje takie jak nazwy usługi (SPN).</span><span class="sxs-lookup"><span data-stu-id="b4d4b-113">Services can then provide extended protection to ensure that credential challenge responses contain service specific information such as a Service Principal Name (SPN).</span></span> <span data-ttu-id="b4d4b-114">Dzięki tym informacjom wymiany poświadczeń usługi będą mogli lepiej chronić przed atakami odpowiedzi żądania poświadczeń, które może być niepoprawnie użyte.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-114">With this information in the credential exchanges, services are able to better protect against malicious use of credential challenge responses that might have been improperly used.</span></span>  
  
 <span data-ttu-id="b4d4b-115">Projekt ochrony rozszerzonej jest ulepszeniem protokoły uwierzytelniania w celu złagodzenia ataków przekazywania uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-115">The extended protection design is an enhancement to authentication protocols designed to mitigate authentication relay attacks.</span></span> <span data-ttu-id="b4d4b-116">Dotyczy on tego pojęcie kanału i informacje o powiązaniu usługi.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-116">It revolves around the concept of channel and service binding information.</span></span>  
  
 <span data-ttu-id="b4d4b-117">Ogólnych celów są następujące:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-117">The overall objectives are the following:</span></span>  
  
1.  <span data-ttu-id="b4d4b-118">Jeśli klient zostanie zaktualizowany do obsługi ochrony rozszerzonej, aplikacje powinny dostarczyć wiązania kanałów i informacje o powiązaniu usługi do wszystkich protokołów uwierzytelniania obsługiwanych.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-118">If the client is updated to support the extended protection, applications should supply a channel binding and service binding information to all supported authentication protocols.</span></span> <span data-ttu-id="b4d4b-119">Informacje o powiązaniu kanału można podać tylko po kanał (TLS), aby powiązać.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-119">Channel binding information can only be supplied when there is a channel (TLS) to bind to.</span></span> <span data-ttu-id="b4d4b-120">Informacje o powiązaniu usługi należy zawsze podać.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-120">Service binding information should always be supplied.</span></span>  
  
2.  <span data-ttu-id="b4d4b-121">Zaktualizowano serwerów, które są prawidłowo skonfigurowane i mogą Sprawdź kanału i informacje o powiązaniu usługi, gdy nie jest obecny w tokenie uwierzytelniania klienta i Odrzuć próby uwierzytelnienia, jeśli powiązania kanału nie są zgodne.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-121">Updated servers which are properly configured may verify the channel and service binding information when it is present in the client authentication token and reject the authentication attempt if the channel bindings do not match.</span></span> <span data-ttu-id="b4d4b-122">W zależności od scenariusza wdrażania serwerów mogą sprawdzić powiązania kanałów, powiązania usługi lub oba.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-122">Depending on the deployment scenario, servers may verify channel binding, service binding or both.</span></span>  
  
3.  <span data-ttu-id="b4d4b-123">Zaktualizowano serwery mają możliwość akceptowanie lub odrzucanie żądań klientów niskiego poziomu, które nie zawierają informacje o powiązaniu kanału, na podstawie zasad.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-123">Updated servers have the ability to accept or reject down-level client requests that do not contain the channel binding information based on policy.</span></span>  
  
 <span data-ttu-id="b4d4b-124">Informacje używane przez ochrona rozszerzona składa się z co najmniej jednej z następujących dwóch części:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-124">Information used by extended protection consists of one or both of the following two parts:</span></span>  
  
1.  <span data-ttu-id="b4d4b-125">Powiązanie tokenu kanału lub CBT.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-125">A Channel Binding Token or CBT.</span></span>  
  
2.  <span data-ttu-id="b4d4b-126">Informacje o powiązaniu w postaci główna nazwa usługi lub nazwa SPN usług.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-126">Service Binding information in the form of a Service Principal Name or SPN.</span></span>  
  
 <span data-ttu-id="b4d4b-127">Powiązania usługi informacji jest oznaczenie założeń klienta do uwierzytelniania dla określonego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-127">Service Binding information is an indication of a client’s intent to authenticate to a particular service endpoint.</span></span> <span data-ttu-id="b4d4b-128">Przesyłane z klienta do serwera z następującymi właściwościami:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-128">It is communicated from client to server with the following properties:</span></span>  
  
-   <span data-ttu-id="b4d4b-129">Wartość Nazwa SPN musi być dostępny dla serwera uwierzytelniania klienta w postaci zwykłego tekstu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-129">The SPN value must be available to the server performing client authentication in clear text form.</span></span>  
  
-   <span data-ttu-id="b4d4b-130">Wartość nazwy SPN jest publiczny.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-130">The value of the SPN is public.</span></span>  
  
-   <span data-ttu-id="b4d4b-131">Nazwa SPN muszą być kryptograficznie chronione przesyłania taki sposób, że atak typu man-in--middle nie może wstawić, usunąć lub zmodyfikować jego wartość.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-131">The SPN must be cryptographically protected in transit such that a man-in-the-middle attack cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="b4d4b-132">CBT jest właściwością zewnętrznym bezpiecznego kanału (na przykład TLS) używane do powiązania (bind) do konwersacji za pośrednictwem kanału wewnętrznej, uwierzytelniane przez klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-132">A CBT is a property of the outer secure channel (such as TLS) used to tie (bind) it to a conversation over an inner, client-authenticated channel.</span></span> <span data-ttu-id="b4d4b-133">CBT musi mieć następujące właściwości (również zdefiniowany przez organizację IETF RFC 5056):</span><span class="sxs-lookup"><span data-stu-id="b4d4b-133">The CBT must have the following properties (also defined by IETF RFC 5056):</span></span>  
  
-   <span data-ttu-id="b4d4b-134">Gdy kanał zewnętrznego istnieje, wartość CBT musi być właściwością identyfikowania zewnętrzne kanału lub serwera punktu końcowego, niezależnie dotarły przez klienta i serwera strony konwersacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-134">When an outer channel exists, the value of the CBT must be a property identifying either the outer channel or the server endpoint, independently arrived at by both client and server sides of a conversation.</span></span>  
  
-   <span data-ttu-id="b4d4b-135">Wartość CBT wysłane przez klienta nie może być coś, które osoba atakująca może mieć wpływ.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-135">Value of the CBT sent by the client must not be something an attacker can influence.</span></span>  
  
-   <span data-ttu-id="b4d4b-136">O tajemnicy wartości CBT nie zajdą żadnych gwarancji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-136">No guarantees are made about secrecy of the CBT value.</span></span> <span data-ttu-id="b4d4b-137">Jednak to oznacza, że wartość powiązania usługi, a także informacje o powiązaniu kanału można zawsze badane przez innych, ale serwer uwierzytelniania, jako protokół wykonywania CBT może zaszyfrowanie go.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-137">This does not however mean that the value of the service binding as well as channel binding information can always be examined by any other but the server performing authentication, as the protocol carrying the CBT may be encrypting it.</span></span>  
  
-   <span data-ttu-id="b4d4b-138">CBT musi być kryptograficznie integralności chronione podczas przesyłania w taki sposób, że osoba atakująca nie może wstawić, usunąć lub zmodyfikować jego wartość.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-138">The CBT must be cryptographically integrity protected in transit such that an attacker cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="b4d4b-139">Powiązania kanałów odbywa się przez klienta przesłanie główną nazwę usługi i CBT w sposób tamperproof do serwera.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-139">Channel binding is accomplished by the client transferring the SPN and the CBT to the server in a tamperproof fashion.</span></span> <span data-ttu-id="b4d4b-140">Serwer sprawdza informacje o powiązaniu kanału zgodnie z jego zasad i odrzuca próby uwierzytelnienia, dla których go nie uważa, aby były docelową.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-140">The server validates the channel binding information in accordance with its policy and rejects authentication attempts for which it does not believe itself to have been the intended target.</span></span> <span data-ttu-id="b4d4b-141">W ten sposób dwa kanały kryptograficznie stają się ze sobą powiązane.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-141">This way, the two channels become cryptographically bound together.</span></span>  
  
 <span data-ttu-id="b4d4b-142">Aby zachować zgodność z istniejących klientów i aplikacji, serwer może być skonfigurowane i umożliwiają prób uwierzytelnienia przez klientów, którzy jeszcze nie obsługuje ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-142">To preserve compatibility with existing clients and applications, a server may be configured to allow authentication attempts by clients that do not yet support extended protection.</span></span> <span data-ttu-id="b4d4b-143">Jest to określane jako "chroniony częściowo" Konfiguracja, w przeciwieństwie do "chroniony w pełni" konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-143">This is referred to as a "partially hardened" configuration, in contrast to a "fully hardened" configuration.</span></span>  
  
 <span data-ttu-id="b4d4b-144">Wiele składników w <xref:System.Net> i <xref:System.Net.Security> przestrzenie nazw wykonać zintegrowane uwierzytelnianie systemu Windows w imieniu aplikacji wywołującej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-144">Multiple components in the <xref:System.Net> and <xref:System.Net.Security> namespaces perform integrated Windows authentication on behalf of a calling application.</span></span> <span data-ttu-id="b4d4b-145">W tej sekcji opisano zmiany System.Net składników, aby dodać ochrona rozszerzona w ich używania zintegrowanego uwierzytelniania systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-145">This section describes changes to System.Net components to add extended protection in their use of integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="b4d4b-146">Ochrona rozszerzona jest obecnie obsługiwany w systemie Windows 7.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-146">Extended protection is currently supported on Windows 7.</span></span> <span data-ttu-id="b4d4b-147">Mechanizm jest zapewniana dzięki aplikacji można określić, czy system operacyjny obsługuje rozszerzonej ochrony.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-147">A mechanism is provided so an application can determine if the operating system supports extended protection.</span></span>  
  
## <a name="changes-to-support-extended-protection"></a><span data-ttu-id="b4d4b-148">Zmiany do obsługi ochrony rozszerzonej</span><span class="sxs-lookup"><span data-stu-id="b4d4b-148">Changes to Support Extended Protection</span></span>  
 <span data-ttu-id="b4d4b-149">Proces uwierzytelniania używane z zintegrowane uwierzytelnianie systemu Windows, w zależności od protokołu uwierzytelniania używane, często obejmuje żądanie wystawiony przez komputer docelowy, a następnie wysyłane z powrotem do komputera klienckiego.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-149">The authentication process used with integrated Windows authentication, depending on the authentication protocol used, often includes a challenge issued by the destination computer and sent back to the client computer.</span></span> <span data-ttu-id="b4d4b-150">Ochrona rozszerzona dodaje nowe funkcje do tego procesu uwierzytelniania</span><span class="sxs-lookup"><span data-stu-id="b4d4b-150">Extended protection adds new features to this authentication process</span></span>  
  
 <span data-ttu-id="b4d4b-151"><xref:System.Security.Authentication.ExtendedProtection> Przestrzeń nazw zapewnia obsługę uwierzytelniania przy użyciu ochrony rozszerzonej dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-151">The <xref:System.Security.Authentication.ExtendedProtection> namespace provides support for authentication using extended protection for applications.</span></span> <span data-ttu-id="b4d4b-152"><xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> Klasy w tej przestrzeni nazw reprezentuje powiązania kanałów.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-152">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> class in this namespace represents a channel binding.</span></span> <span data-ttu-id="b4d4b-153"><xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> Klasy w tej przestrzeni nazw reprezentuje zasada ochrony rozszerzonej używana przez serwer do walidacji przychodzących połączeń klientów.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-153">The <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class in this namespace represents the extended protection policy used by the server to validate incoming client connections.</span></span> <span data-ttu-id="b4d4b-154">O innych elementach członkowskich klasy są używane z ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-154">Other class members are used with extended protection.</span></span>  
  
 <span data-ttu-id="b4d4b-155">Dla aplikacji serwerowych tych klas są następujące:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-155">For server applications, these classes include the following:</span></span>  
  
 <span data-ttu-id="b4d4b-156">A <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> mający następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-156">A <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> that has the following elements:</span></span>  
  
-   <span data-ttu-id="b4d4b-157"><xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> Właściwość, która wskazuje, czy system operacyjny obsługuje zintegrowane uwierzytelnianie systemu windows z ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-157">An <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> property that indicates whether the operating system supports integrated windows authentication with extended protection.</span></span>  
  
-   <span data-ttu-id="b4d4b-158">A <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> wartość, która wskazuje, kiedy należy wymusić zasady ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-158">A <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> value that indicates when the extended protection policy should be enforced.</span></span>  
  
-   <span data-ttu-id="b4d4b-159">A <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> wartość, która wskazuje scenariusz wdrażania.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-159">A <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> value that indicates the deployment scenario.</span></span> <span data-ttu-id="b4d4b-160">Ma to wpływ na sposób rozszerzonej ochrony jest zaznaczony.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-160">This influences how extended protection is checked.</span></span>  
  
-   <span data-ttu-id="b4d4b-161">Opcjonalny <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> zawierający listę nazw SPN niestandardową jest używany do dopasowywania SPN dostarczonych przez klienta jako docelową uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-161">An optional <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> that contains the custom SPN list that is used to match against the SPN provided by the client as the intended target of the authentication.</span></span>  
  
-   <span data-ttu-id="b4d4b-162">Opcjonalny <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> zawiera powiązanie niestandardowego kanału do użycia w celu weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-162">An optional <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> that contains a custom channel binding to use for validation.</span></span> <span data-ttu-id="b4d4b-163">Ten scenariusz nie jest często zdarza</span><span class="sxs-lookup"><span data-stu-id="b4d4b-163">This scenario is not a common case</span></span>  
  
 <span data-ttu-id="b4d4b-164"><xref:System.Security.Authentication.ExtendedProtection.Configuration> Przestrzeń nazw zapewnia obsługę konfiguracji uwierzytelniania za pomocą ochrony rozszerzonej dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-164">The <xref:System.Security.Authentication.ExtendedProtection.Configuration> namespace provides support for configuration of authentication using extended protection for applications.</span></span>  
  
 <span data-ttu-id="b4d4b-165">Wprowadzono szereg funkcji zmiany do obsługi ochrony rozszerzonej w istniejących <xref:System.Net> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-165">A number of feature changes were made to support extended protection in the existing <xref:System.Net> namespace.</span></span> <span data-ttu-id="b4d4b-166">Następujące zmiany:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-166">These changes include the following:</span></span>  
  
-   <span data-ttu-id="b4d4b-167">Nowy <xref:System.Net.TransportContext> dodany do klasy <xref:System.Net> przestrzeni nazw, która reprezentuje kontekst transportu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-167">A new <xref:System.Net.TransportContext> class added to the <xref:System.Net> namespace that represents a transport context.</span></span>  
  
-   <span data-ttu-id="b4d4b-168">Nowy <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> i <xref:System.Net.HttpWebRequest.GetRequestStream%2A> przeciążanie metod w <xref:System.Net.HttpWebRequest> klasy, która umożliwia pobieranie <xref:System.Net.TransportContext> do obsługi ochrony rozszerzonej dla aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-168">New <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> and <xref:System.Net.HttpWebRequest.GetRequestStream%2A> overload methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> to support extended protection for client applications.</span></span>  
  
-   <span data-ttu-id="b4d4b-169">Dodatki do <xref:System.Net.HttpListener> i <xref:System.Net.HttpListenerRequest> klasy do obsługi aplikacji serwera.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-169">Additions to the <xref:System.Net.HttpListener> and <xref:System.Net.HttpListenerRequest> classes to support server applications.</span></span>  
  
 <span data-ttu-id="b4d4b-170">Funkcja zmiany do obsługi ochrony rozszerzonej dla aplikacji klienckich SMTP w istniejących <xref:System.Net.Mail> przestrzeni nazw:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-170">A feature change was made to support extended protection for SMTP client applications in the existing <xref:System.Net.Mail> namespace:</span></span>  
  
-   <span data-ttu-id="b4d4b-171">A <xref:System.Net.Mail.SmtpClient.TargetName%2A> właściwości w <xref:System.Net.Mail.SmtpClient> klasa, która reprezentuje nazwę SPN, aby używać do uwierzytelniania w przypadku korzystania z rozszerzonej ochrony klienta SMTP aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-171">A <xref:System.Net.Mail.SmtpClient.TargetName%2A> property in the <xref:System.Net.Mail.SmtpClient> class that represents the SPN to use for authentication when using extended protection for SMTP client applications.</span></span>  
  
 <span data-ttu-id="b4d4b-172">Wprowadzono szereg funkcji zmiany do obsługi ochrony rozszerzonej w istniejących <xref:System.Net.Security> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-172">A number of feature changes were made to support extended protection in the existing <xref:System.Net.Security> namespace.</span></span> <span data-ttu-id="b4d4b-173">Następujące zmiany:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-173">These changes include the following:</span></span>  
  
-   <span data-ttu-id="b4d4b-174">Nowy <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> i <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> przeciążenia metody <xref:System.Net.Security.NegotiateStream> klasy, która umożliwia przekazywanie CBT do obsługi ochrony rozszerzonej dla aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-174">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing a CBT to support extended protection for client applications.</span></span>  
  
-   <span data-ttu-id="b4d4b-175">Nowy <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> i <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> przeciążanie metod w <xref:System.Net.Security.NegotiateStream> klasy, która umożliwia przekazywanie <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> do obsługi ochrony rozszerzonej dla aplikacji serwera.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-175">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> to support extended protection for server applications.</span></span>  
  
-   <span data-ttu-id="b4d4b-176">Nowy <xref:System.Net.Security.SslStream.TransportContext%2A> właściwości w <xref:System.Net.Security.SslStream> klasy do obsługi ochrony rozszerzonej dla klienta i serwera aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-176">A new <xref:System.Net.Security.SslStream.TransportContext%2A> property in the <xref:System.Net.Security.SslStream> class to support extended protection for client and server applications.</span></span>  
  
 <span data-ttu-id="b4d4b-177">A <xref:System.Net.Configuration.SmtpNetworkElement> właściwość została dodana do obsługi konfiguracji ochrony rozszerzonej dla klientów SMTP w <xref:System.Net.Security> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-177">A <xref:System.Net.Configuration.SmtpNetworkElement> property was added to support configuration of extended protection for SMTP clients in the <xref:System.Net.Security> namespace.</span></span>  
  
## <a name="extended-protection-for-client-applications"></a><span data-ttu-id="b4d4b-178">Ochrona rozszerzona na potrzeby aplikacji klienckich</span><span class="sxs-lookup"><span data-stu-id="b4d4b-178">Extended Protection for Client Applications</span></span>  
 <span data-ttu-id="b4d4b-179">Ochrona rozszerzona obsługa większości aplikacji klienckich odbywa się automatycznie.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-179">Extended protection support for most client applications happens automatically.</span></span> <span data-ttu-id="b4d4b-180"><xref:System.Net.HttpWebRequest> i <xref:System.Net.Mail.SmtpClient> klasy obsługuje rozszerzonej ochrony, gdy podstawowej wersji systemu Windows obsługuje rozszerzonej ochrony.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-180">The <xref:System.Net.HttpWebRequest> and <xref:System.Net.Mail.SmtpClient> classes support extended protection whenever the underlying version of Windows supports extended protection.</span></span> <span data-ttu-id="b4d4b-181"><xref:System.Net.HttpWebRequest> Wystąpienia wysyła nazwę SPN utworzone na podstawie <xref:System.Uri>.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-181">An <xref:System.Net.HttpWebRequest> instance sends an SPN constructed from the <xref:System.Uri>.</span></span> <span data-ttu-id="b4d4b-182">Domyślnie <xref:System.Net.Mail.SmtpClient> wystąpienia wysyła nazwę SPN utworzone na podstawie nazwy hosta serwera poczty SMTP.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-182">By default, an <xref:System.Net.Mail.SmtpClient> instance sends an SPN constructed from the host name of the SMTP mail server.</span></span>  
  
 <span data-ttu-id="b4d4b-183">Niestandardowe aplikacje klienckie mogą używać, <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> lub <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> metod w <xref:System.Net.HttpWebRequest> klasy, która umożliwia pobieranie <xref:System.Net.TransportContext> i używanie CBT <xref:System.Net.TransportContext.GetChannelBinding%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-183">For custom authentication, client applications can use the <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> or <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> and the CBT using the <xref:System.Net.TransportContext.GetChannelBinding%2A> method.</span></span>  
  
 <span data-ttu-id="b4d4b-184">Nazwę SPN, aby używać zintegrowanego uwierzytelniania systemu Windows, wysyłane przez <xref:System.Net.HttpWebRequest> wystąpienie danej usługi może zostać zastąpione przez ustawienie <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-184">The SPN to use for integrated Windows authentication sent by an <xref:System.Net.HttpWebRequest> instance to a given service can be overridden by setting the <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> property.</span></span>  
  
 <span data-ttu-id="b4d4b-185"><xref:System.Net.Mail.SmtpClient.TargetName%2A> Właściwości można ustawić niestandardowe nazwę SPN, aby używać zintegrowanego uwierzytelniania systemu Windows dla połączeń SMTP.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-185">The <xref:System.Net.Mail.SmtpClient.TargetName%2A> property can be used to set a custom SPN to use for integrated Windows authentication for the SMTP connection.</span></span>  
  
## <a name="extended-protection-for-server-applications"></a><span data-ttu-id="b4d4b-186">Ochrona rozszerzona na potrzeby aplikacji serwera</span><span class="sxs-lookup"><span data-stu-id="b4d4b-186">Extended Protection for Server Applications</span></span>  
 <span data-ttu-id="b4d4b-187"><xref:System.Net.HttpListener>automatycznie zapewnia mechanizmów sprawdzania poprawności powiązania, przeprowadzania uwierzytelniania HTTP.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-187"><xref:System.Net.HttpListener> automatically provides mechanisms for validating service bindings when performing HTTP authentication.</span></span>  
  
 <span data-ttu-id="b4d4b-188">Najbezpieczniejszą scenariusz jest umożliwienie ochrona rozszerzona na potrzeby prefiksy HTTPS://.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-188">The most secure scenario is to enable extended protection for HTTPS:// prefixes.</span></span> <span data-ttu-id="b4d4b-189">W takim przypadku należy ustawić <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> do <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> z <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> ustawioną <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> lub <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, i <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> ustawioną <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> wartość <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> umieszcza <xref:System.Net.HttpListener> w trybie zaostrzonym częściowo podczas <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> odpowiada pełni zaostrzony tryb.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-189">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="b4d4b-190">W tej konfiguracji po wysłaniu żądania do serwera za pośrednictwem bezpiecznego kanału zewnętrzne zewnętrzne kanału zostanie zapytany o powiązania kanałów.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-190">In this configuration when a request is made to the server through an outer secure channel, the outer channel is queried for a channel binding.</span></span> <span data-ttu-id="b4d4b-191">Tego powiązania kanału jest przekazywany do wywołania interfejsu SSPI uwierzytelniania, których sprawdzanie poprawności, które powiązania kanałów w dopasowań blob uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-191">This channel binding is passed to the authentication SSPI calls, which validate that the channel binding in the authentication blob matches.</span></span> <span data-ttu-id="b4d4b-192">Istnieją trzy możliwe wyniki:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-192">There are three possible outcomes:</span></span>  
  
1.  <span data-ttu-id="b4d4b-193">System operacyjny serwera nie obsługuje ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-193">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="b4d4b-194">Żądanie nie będzie ona widoczna dla aplikacji, a nieautoryzowanego odpowiedzi (401) zostanie zwrócony do klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-194">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b4d4b-195">Wiadomości są rejestrowane <xref:System.Net.HttpListener> źródło śladu Określanie przyczynę błędu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-195">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2.  <span data-ttu-id="b4d4b-196">Wywołanie SSPI nie powiedzie się wskazującą, czy klient określono powiązania kanału, który nie odpowiada oczekiwanej wartości pobierane z zewnętrznego kanału lub klient nie może dostarczyć powiązanie kanału, gdy skonfigurowano zasady ochrony rozszerzonej na serwerze Aby uzyskać <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-196">The SSPI call fails indicating that either the client specified a channel binding that did not match the expected value retrieved from the outer channel or the client failed to supply a channel binding when the extended protection policy on the server was configured for <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span></span> <span data-ttu-id="b4d4b-197">W obu przypadkach żądania nie będzie ona widoczna dla aplikacji, a odpowiedź (401) nieautoryzowane zostanie zwrócony do klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-197">In both cases, the request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b4d4b-198">Wiadomości są rejestrowane <xref:System.Net.HttpListener> źródło śladu Określanie przyczynę błędu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-198">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3.  <span data-ttu-id="b4d4b-199">Klient określa powiązania kanałów poprawne lub może nawiązać połączenie bez określenia powiązania kanału, ponieważ zasada ochrony rozszerzonej na serwerze skonfigurowano <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> żądania jest zwracana do aplikacji w celu przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-199">The client specifies the correct channel binding or is allowed to connect without specifying a channel binding since the extended protection policy on the server is configured with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> The request is returned to the application for processing.</span></span> <span data-ttu-id="b4d4b-200">Bez sprawdzania nazwy usługi odbywa się automatycznie.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-200">No service name check is performed automatically.</span></span> <span data-ttu-id="b4d4b-201">Aplikacji może wybrać przeprowadzić własne usługi nazwa weryfikacji przy użyciu <xref:System.Net.HttpListenerRequest.ServiceName%2A> właściwości, ale w tych warunkach jest nadmiarowy.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-201">An application may choose to perform its own service name validation using the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property, but under these circumstances it is redundant.</span></span>  
  
 <span data-ttu-id="b4d4b-202">Jeśli aplikacja sprawia, że jego własnej wywołania interfejsu SSPI, aby wykonać uwierzytelnianie oparte na obiekty BLOB i z powrotem przekazany w treści żądania HTTP i chce obsługuje powiązań kanałów, należy go pobrać powiązania kanałów oczekiwanego z zewnętrznym bezpiecznego kanału, za pomocą <xref:System.Net.HttpListener> aby przekazywanie ich do natywnego Win32 [działanie funkcji AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) funkcji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-202">If an application makes its own SSPI calls to perform authentication based on blobs passed back and forth within the body of an HTTP request and wishes to support channel binding, it needs to retrieve the expected channel binding from the outer secure channel using <xref:System.Net.HttpListener> in order to pass it to native Win32 [AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) function.</span></span> <span data-ttu-id="b4d4b-203">Aby to zrobić, użyj <xref:System.Net.HttpListenerRequest.TransportContext%2A> właściwości i wywołanie <xref:System.Net.TransportContext.GetChannelBinding%2A> metoda pobierania CBT.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-203">To do this, use the <xref:System.Net.HttpListenerRequest.TransportContext%2A> property and call <xref:System.Net.TransportContext.GetChannelBinding%2A> method to retrieve the CBT.</span></span> <span data-ttu-id="b4d4b-204">Są obsługiwane tylko powiązania punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-204">Only endpoint bindings are supported.</span></span> <span data-ttu-id="b4d4b-205">Jeśli wszystko inne <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> jest określony, <xref:System.NotSupportedException> zostanie wygenerowany.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-205">If anything other <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> is specified, a <xref:System.NotSupportedException> will be thrown.</span></span> <span data-ttu-id="b4d4b-206">Jeśli system operacyjny obsługuje powiązania kanałów <xref:System.Net.TransportContext.GetChannelBinding%2A> metoda zwróci <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> <xref:System.Runtime.InteropServices.SafeHandle> zawijania wskaźnik do powiązania odpowiednie do przekazania do kanału [działanie funkcji AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) — funkcja jako pvBuffer elementu członkowskiego struktury SecBuffer przekazano `pInput` parametru.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-206">If the underlying operating system supports channel binding, the <xref:System.Net.TransportContext.GetChannelBinding%2A> method will return a <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding><xref:System.Runtime.InteropServices.SafeHandle> wrapping a pointer to a channel binding suitable for passing to [AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) function as the pvBuffer member of a SecBuffer structure passed in the `pInput` parameter.</span></span> <span data-ttu-id="b4d4b-207"><xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> Właściwość zawiera długość w bajtach powiązania kanałów.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-207">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> property contains the length, in bytes, of the channel binding.</span></span> <span data-ttu-id="b4d4b-208">Jeśli system operacyjny nie obsługuje powiązań kanałów, funkcja zwróci `null`.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-208">If the underlying operating system does not support channel bindings, the function will return `null`.</span></span>  
  
 <span data-ttu-id="b4d4b-209">Inny możliwy scenariusz jest umożliwienie ochrona rozszerzona na potrzeby prefiksy HTTP://, gdy serwery proxy nie są używane.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-209">Another possible scenario is to enable extended protection for HTTP:// prefixes when proxies are not used.</span></span> <span data-ttu-id="b4d4b-210">W takim przypadku należy ustawić <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> do <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> z <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> ustawioną <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> lub <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, i <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> ustawioną <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> wartość <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> umieszcza <xref:System.Net.HttpListener> w trybie zaostrzonym częściowo podczas <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> odpowiada pełni zaostrzony tryb.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-210">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="b4d4b-211">Domyślną listę nazw usług dozwolonych jest tworzone w oparciu prefiksów, które zostały zarejestrowane w <xref:System.Net.HttpListener>.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-211">A default list of allowed service names is created based on the prefixes which have been registered with the <xref:System.Net.HttpListener>.</span></span> <span data-ttu-id="b4d4b-212">Ta lista domyślne można zbadać za pomocą <xref:System.Net.HttpListener.DefaultServiceNames%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-212">This default list can be examined through the <xref:System.Net.HttpListener.DefaultServiceNames%2A> property.</span></span> <span data-ttu-id="b4d4b-213">Jeśli ta lista nie jest wyczerpująca, aplikację można określić Kolekcja nazw usług niestandardowych w Konstruktorze <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> klasy, która będzie używana zamiast domyślnej listy nazwy usługi.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-213">If this list is not comprehensive, an application can specify a custom service name collection in the constructor for the <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class which will be used instead of the default service name list.</span></span>  
  
 <span data-ttu-id="b4d4b-214">W tej konfiguracji po wysłaniu żądania do serwera bez zewnętrznym bezpiecznego uwierzytelniania kanału przetwarzane w zwykły sposób bez sprawdzania powiązania kanałów.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-214">In this configuration, when a request is made to the server without an outer secure channel authentication proceeds normally without a channel binding check.</span></span> <span data-ttu-id="b4d4b-215">Jeśli uwierzytelnianie się powiedzie, kontekst zostanie zapytany o nazwę usługi, że klient podane ani weryfikowana pod kątem lista akceptowalnych nazw usług.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-215">If the authentication succeeds, the context is queried for the service name that the client provided and validated against the list of acceptable service names.</span></span> <span data-ttu-id="b4d4b-216">Istnieją cztery możliwe wyniki:</span><span class="sxs-lookup"><span data-stu-id="b4d4b-216">There are four possible outcomes:</span></span>  
  
1.  <span data-ttu-id="b4d4b-217">System operacyjny serwera nie obsługuje ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-217">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="b4d4b-218">Żądanie nie będzie ona widoczna dla aplikacji, a nieautoryzowanego odpowiedzi (401) zostanie zwrócony do klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-218">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b4d4b-219">Wiadomości są rejestrowane <xref:System.Net.HttpListener> źródło śladu Określanie przyczynę błędu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-219">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2.  <span data-ttu-id="b4d4b-220">System operacyjny klienta nie obsługuje ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-220">The client’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="b4d4b-221">W <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> konfiguracji, próba uwierzytelniania powiedzie się i żądanie zostanie zwrócony do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-221">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> configuration, the authentication attempt will succeed and the request will be returned to the application.</span></span> <span data-ttu-id="b4d4b-222">W <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> konfiguracji, uwierzytelnianie nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-222">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> configuration, the authentication attempt will fail.</span></span> <span data-ttu-id="b4d4b-223">Żądanie nie będzie ona widoczna dla aplikacji, a nieautoryzowanego odpowiedzi (401) zostanie zwrócony do klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-223">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b4d4b-224">Wiadomości są rejestrowane <xref:System.Net.HttpListener> źródło śladu Określanie przyczynę błędu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-224">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3.  <span data-ttu-id="b4d4b-225">System operacyjny klienta obsługuje rozszerzonej ochrony, ale nie określono powiązania usługi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-225">The client’s underlying operating system supports extended protection, but the application did not specify a service binding.</span></span> <span data-ttu-id="b4d4b-226">Żądanie nie będzie ona widoczna dla aplikacji, a nieautoryzowanego odpowiedzi (401) zostanie zwrócony do klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-226">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b4d4b-227">Wiadomości są rejestrowane <xref:System.Net.HttpListener> źródło śladu Określanie przyczynę błędu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-227">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
4.  <span data-ttu-id="b4d4b-228">Klient określone powiązanie usługi.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-228">The client specified a service binding.</span></span> <span data-ttu-id="b4d4b-229">Powiązanie usługi jest porównywany do listy dozwolonych powiązania.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-229">The service binding is compared to the list of allowed service bindings.</span></span> <span data-ttu-id="b4d4b-230">Jeśli jest on zgodny, żądanie jest zwracana do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-230">If it matches, the request is returned to the application.</span></span> <span data-ttu-id="b4d4b-231">W przeciwnym razie żądania nie będzie ona widoczna dla aplikacji i nieautoryzowanym odpowiedzi (401) automatycznie powróci do klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-231">Otherwise, the request will not be exposed to the application, and an unauthorized (401) response will be automatically returned to the client.</span></span> <span data-ttu-id="b4d4b-232">Wiadomości są rejestrowane <xref:System.Net.HttpListener> źródło śladu Określanie przyczynę błędu.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-232">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
 <span data-ttu-id="b4d4b-233">Jeśli takie podejście proste za pomocą listy dozwolonych akceptowalnych nazw usług jest niewystarczająca, aplikacja może dostarcza własną Sprawdzanie nazwy usługi badając <xref:System.Net.HttpListenerRequest.ServiceName%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-233">If this simple approach using an allowed list of acceptable service names is insufficient, an application may provide its own service name validation by querying the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property.</span></span> <span data-ttu-id="b4d4b-234">W przypadku 1 i 2. powyżej, właściwość, którą będzie zwracać `null`.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-234">In cases 1 and 2 above, the property will return `null`.</span></span> <span data-ttu-id="b4d4b-235">W przypadku 3 zwróci ciąg pusty.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-235">In case 3, it will return an empty string.</span></span> <span data-ttu-id="b4d4b-236">W przypadku 4 zostanie zwrócony z nazwą usługi określoną przez klienta.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-236">In case 4, the service name specified by the client will be returned.</span></span>  
  
 <span data-ttu-id="b4d4b-237">Te funkcje ochrony rozszerzonej mogą również przez aplikacje serwera do uwierzytelniania przy użyciu innych typów żądań i zaufanych serwerów proxy są używane.</span><span class="sxs-lookup"><span data-stu-id="b4d4b-237">These extended protection features can also be used by server applications for authentication with other types of requests and when trusted proxies are used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b4d4b-238">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="b4d4b-238">See Also</span></span>  
 <xref:System.Security.Authentication.ExtendedProtection>  
 <xref:System.Security.Authentication.ExtendedProtection.Configuration>
