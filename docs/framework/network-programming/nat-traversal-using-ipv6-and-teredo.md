---
title: Przechodzenie translatora adresów sieciowych przy użyciu protokołu IPv6 i Teredo
ms.date: 03/30/2017
ms.assetid: 568cd245-3300-49ef-a995-d81bf845d961
ms.openlocfilehash: a6448ddf117e1f454338869820751ae5d9e0070e
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/26/2020
ms.locfileid: "96258624"
---
# <a name="nat-traversal-using-ipv6-and-teredo"></a><span data-ttu-id="27b38-102">Przechodzenie translatora adresów sieciowych przy użyciu protokołu IPv6 i Teredo</span><span class="sxs-lookup"><span data-stu-id="27b38-102">NAT Traversal using IPv6 and Teredo</span></span>

<span data-ttu-id="27b38-103">Wprowadzono ulepszenia zapewniające obsługę przechodzenia do translacji adresów sieciowych (NAT).</span><span class="sxs-lookup"><span data-stu-id="27b38-103">Enhancements were made that provide support for Network Address Translation (NAT) traversal.</span></span> <span data-ttu-id="27b38-104">Te zmiany są przeznaczone do użycia z protokołami IPv6 i Teredo, ale mają zastosowanie również do innych technologii tunelowania IP.</span><span class="sxs-lookup"><span data-stu-id="27b38-104">These changes are designed for use with IPv6 and Teredo, but they are also applicable to other IP tunneling technologies.</span></span> <span data-ttu-id="27b38-105">Te ulepszenia wpływają na klasy w <xref:System.Net> i powiązanych przestrzeniach nazw.</span><span class="sxs-lookup"><span data-stu-id="27b38-105">These enhancements affect classes in the <xref:System.Net> and related namespaces.</span></span>  
  
 <span data-ttu-id="27b38-106">Te zmiany mogą mieć wpływ na aplikacje klienta i serwera, które zaplanowali korzystanie z technologii tunelowania IP.</span><span class="sxs-lookup"><span data-stu-id="27b38-106">These changes can affect client and server applications that plan to use IP tunneling technologies.</span></span>  
  
 <span data-ttu-id="27b38-107">Zmiany obsługujące przechodzenie do translatora adresów sieciowych są dostępne tylko dla aplikacji korzystających z programu .NET Framework w wersji 4.</span><span class="sxs-lookup"><span data-stu-id="27b38-107">The changes to support NAT traversal are available only for applications using .NET Framework version 4.</span></span> <span data-ttu-id="27b38-108">Te funkcje nie są dostępne we wcześniejszych wersjach .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="27b38-108">These features are not available on earlier versions of the .NET Framework.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="27b38-109">Omówienie</span><span class="sxs-lookup"><span data-stu-id="27b38-109">Overview</span></span>  

 <span data-ttu-id="27b38-110">Protokół internetowy w wersji 4 (IPv4) definiuje adres IPv4 jako 32 bitów Long.</span><span class="sxs-lookup"><span data-stu-id="27b38-110">The Internet Protocol version 4 (IPv4) defined an IPv4 address as 32 bits long.</span></span> <span data-ttu-id="27b38-111">W efekcie protokół IPv4 obsługuje około 4 000 000 000 unikatowych adresów IP (2 ^ 32).</span><span class="sxs-lookup"><span data-stu-id="27b38-111">As a result, IPv4 supports approximately 4 billion unique IP addresses (2^32).</span></span> <span data-ttu-id="27b38-112">Ponieważ liczba komputerów i urządzeń sieciowych w sieci Internet rozwiniętych w 1990s, limity przestrzeni adresów IPv4 stały się widoczne.</span><span class="sxs-lookup"><span data-stu-id="27b38-112">As the number of computers and network devices on the Internet expanded in the 1990s, the limits of the IPv4 address space became apparent.</span></span>  
  
 <span data-ttu-id="27b38-113">Jedną z kilku technik służących do rozbudowania okresu istnienia protokołu IPv4 jest wdrożenie translatora adresów sieciowych w celu zezwolenia na użycie jednego unikatowego publicznego adresu IP do reprezentowania dużej liczby prywatnych adresów IP (prywatnego intranetu).</span><span class="sxs-lookup"><span data-stu-id="27b38-113">One of several techniques used to extend the lifetime of IPv4 has been to deploy NAT to allow a single unique public IP address to represent a large number of private IP addresses (private Intranet).</span></span> <span data-ttu-id="27b38-114">Prywatne adresy IP znajdujące się za urządzeniem NAT współdzielą jeden publiczny adres IPv4.</span><span class="sxs-lookup"><span data-stu-id="27b38-114">The private IP addresses behind the NAT device share the single public IPv4 address.</span></span> <span data-ttu-id="27b38-115">Urządzenie NAT może być dedykowanym urządzeniem sprzętowym (na przykład niedrogim punktem dostępu bezprzewodowego i routerem) lub komputerem z uruchomioną usługą w celu zapewnienia translatora adresów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="27b38-115">The NAT device may be a dedicated hardware device (an inexpensive Wireless Access Point and router, for example) or a computer running a service to provide NAT.</span></span> <span data-ttu-id="27b38-116">Urządzenie lub usługa dla tego publicznego adresu IP tłumaczy pakiety sieciowe IP między publicznym Internetem a prywatnym intranetem.</span><span class="sxs-lookup"><span data-stu-id="27b38-116">A device or service for this public IP address translates IP network packets between the public Internet and the private Intranet.</span></span>  
  
 <span data-ttu-id="27b38-117">Ten schemat działa dobrze w przypadku aplikacji klienckich działających w prywatnym intranecie, które wysyłają żądania do innych adresów IP (zazwyczaj serwerów) w Internecie.</span><span class="sxs-lookup"><span data-stu-id="27b38-117">This scheme works well for client applications running on the private Intranet that send requests to other IP addresses (usually servers) on the Internet.</span></span> <span data-ttu-id="27b38-118">Urządzenie NAT lub serwer może zachować mapowanie żądań klientów, aby w przypadku zwrócenia odpowiedzi wiadomość o miejscu, w którym ma zostać wysłana odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="27b38-118">The NAT device or server can keep a mapping of client requests so when a response is returned it knows where to send the response.</span></span> <span data-ttu-id="27b38-119">Jednak ten schemat nakłada problemy dla aplikacji działających w prywatnym intranecie za urządzeniem NAT, które chcą zapewnić usługi, nasłuchiwanie pakietów i reagowanie na nie.</span><span class="sxs-lookup"><span data-stu-id="27b38-119">But this scheme poses problems for applications running in the private Intranet behind the NAT device that want to provide services, listen for packets, and respond.</span></span> <span data-ttu-id="27b38-120">Jest to szczególnie przypadek w przypadku aplikacji równorzędnych.</span><span class="sxs-lookup"><span data-stu-id="27b38-120">This is particularly the case for peer-to-peer applications.</span></span>  
  
 <span data-ttu-id="27b38-121">Protokół IPv6 definiuje adres IPv4 jako 128 bitów.</span><span class="sxs-lookup"><span data-stu-id="27b38-121">The IPv6 protocol defined an IPv4 address as 128 bits long.</span></span> <span data-ttu-id="27b38-122">W efekcie protokół IPv6 obsługuje bardzo dużą przestrzeń adresów IP wynoszącą 3,2 x 10 ^ 38 unikatowych adresów (2 ^ 128).</span><span class="sxs-lookup"><span data-stu-id="27b38-122">As a result, IPv6 supports very a large IP address space of 3.2 x 10^38 unique addresses (2^128).</span></span> <span data-ttu-id="27b38-123">Mając przestrzeń adresową tego rozmiaru, jest możliwe, aby każde urządzenie połączone z Internetem miało unikatowy adres.</span><span class="sxs-lookup"><span data-stu-id="27b38-123">With an address space of this size, it is possible for every device connected to the Internet to be given a unique address.</span></span> <span data-ttu-id="27b38-124">Występują problemy.</span><span class="sxs-lookup"><span data-stu-id="27b38-124">But there are problems.</span></span> <span data-ttu-id="27b38-125">Większość świata nadal używa tylko protokołu IPv4.</span><span class="sxs-lookup"><span data-stu-id="27b38-125">Much of the world is still using only IPv4.</span></span> <span data-ttu-id="27b38-126">W szczególności wiele istniejących routerów i punktów dostępu bezprzewodowego używanych przez małe firmy, organizacje i gospodarstwa domowe nie obsługują protokołu IPv6.</span><span class="sxs-lookup"><span data-stu-id="27b38-126">In particular, many of the existing routers and wireless access points used by small companies, organizations, and households do not support IPv6.</span></span> <span data-ttu-id="27b38-127">Niektórzy dostawcy usług internetowych, którzy obsługują tych klientów, nie obsługują lub nie skonfigurowali obsługi protokołu IPv6.</span><span class="sxs-lookup"><span data-stu-id="27b38-127">Also some Internet service providers that serve these customers either do not support or have not configured support for IPv6.</span></span>  
  
 <span data-ttu-id="27b38-128">W pakiecie IPv4 opracowano kilka technologii przejściowych IPv6 do tunelowania adresów IPv6.</span><span class="sxs-lookup"><span data-stu-id="27b38-128">Several IPv6 transition technologies have been developed to tunnel IPv6 addresses in an IPv4 packet.</span></span> <span data-ttu-id="27b38-129">Technologie te obejmują tunele 6to4, ISATAP i Teredo, które zapewniają przypisanie adresu i automatyczne tunelowanie do ruchu IPv6 emisji pojedynczej, gdy hosty IPv6 muszą przechodzą sieci IP4, aby dotrzeć do innych sieci IPv6.</span><span class="sxs-lookup"><span data-stu-id="27b38-129">These technologies include 6to4, ISATAP, and Teredo tunnels that provide address assignment and host-to-host automatic tunneling for unicast IPv6 traffic when IPv6 hosts must traverse IP4 networks to reach other IPv6 networks.</span></span> <span data-ttu-id="27b38-130">Pakiety IPv6 są wysyłane jako pakiety IPv4.</span><span class="sxs-lookup"><span data-stu-id="27b38-130">IPv6 packets are sent tunneled as IPv4 packets.</span></span> <span data-ttu-id="27b38-131">Używane są kilka technik tunelowania, które umożliwiają przechodzenie translatora adresów sieciowych do adresów IPv6 za pomocą urządzenia NAT.</span><span class="sxs-lookup"><span data-stu-id="27b38-131">Several tunneling techniques are being used that allow NAT traversal for IPv6 addresses through a NAT device.</span></span>  
  
 <span data-ttu-id="27b38-132">Protokół Teredo jest jedną z technologii przejściowych IPv6, która zapewnia łączność IPv6 z sieciami IPv4.</span><span class="sxs-lookup"><span data-stu-id="27b38-132">Teredo is one of the IPv6 transition technologies which brings IPv6 connectivity to IPv4 networks.</span></span> <span data-ttu-id="27b38-133">Protokół Teredo jest udokumentowany w dokumencie RFC 4380 opublikowanym przez Internet Engineering Task Force (IETF).</span><span class="sxs-lookup"><span data-stu-id="27b38-133">Teredo is documented in RFC 4380 published by the Internet Engineering Task Force (IETF).</span></span> <span data-ttu-id="27b38-134">System Windows XP z dodatkiem SP2 lub nowszy zapewnia obsługę wirtualnej karty Teredo, która umożliwia udostępnienie publicznego adresu IPv6 w zakresie 2001:0::/32.</span><span class="sxs-lookup"><span data-stu-id="27b38-134">Windows XP SP2 and later provide support for a virtual Teredo adapter which can provide a public IPv6 address in the range 2001:0::/32.</span></span> <span data-ttu-id="27b38-135">Tego adresu IPv6 można użyć do nasłuchiwania połączeń przychodzących z Internetu i można je dostarczyć klientom obsługującym protokół IPv6, którzy chcą połączyć się z usługą nasłuchiwania.</span><span class="sxs-lookup"><span data-stu-id="27b38-135">This IPv6 address can be used to listen for incoming connections from the Internet and can be provided to IPv6 enabled clients that wish to connect to the listening service.</span></span> <span data-ttu-id="27b38-136">Spowoduje to zwolnienie aplikacji o sposobie rozwiązywania problemów z komputerem za urządzeniem NAT, ponieważ aplikacja może po prostu połączyć się z nim przy użyciu adresu IPv6 protokołu Teredo.</span><span class="sxs-lookup"><span data-stu-id="27b38-136">This frees an application from worrying about how to address a computer behind a NAT device, since the application can just connect to it using its IPv6 Teredo address.</span></span>  
  
## <a name="enhancements-to-support-nat-traversal-and-teredo"></a><span data-ttu-id="27b38-137">Ulepszenia obsługi przechodzenia NAT i Teredo</span><span class="sxs-lookup"><span data-stu-id="27b38-137">Enhancements to Support NAT Traversal and Teredo</span></span>  

 <span data-ttu-id="27b38-138">Ulepszenia są dodawane do <xref:System.Net> <xref:System.Net.NetworkInformation> przestrzeni nazw, i i <xref:System.Net.Sockets> obsługują przechodzenie NAT przy użyciu protokołu IPv6 i Teredo.</span><span class="sxs-lookup"><span data-stu-id="27b38-138">Enhancements are added to the <xref:System.Net>, <xref:System.Net.NetworkInformation>, and <xref:System.Net.Sockets> namespaces for supporting NAT traversal using IPv6 and Teredo.</span></span>  
  
 <span data-ttu-id="27b38-139">Do klasy dodawane są kilka metod w <xref:System.Net.NetworkInformation.IPGlobalProperties?displayProperty=nameWithType> celu uzyskania listy adresów IP emisji pojedynczej na hoście.</span><span class="sxs-lookup"><span data-stu-id="27b38-139">Several methods are added to the <xref:System.Net.NetworkInformation.IPGlobalProperties?displayProperty=nameWithType> class to get the list of unicast IP addresses on the host.</span></span> <span data-ttu-id="27b38-140"><xref:System.Net.NetworkInformation.IPGlobalProperties.BeginGetUnicastAddresses%2A>Metoda rozpoczyna asynchroniczne żądanie pobrania stabilnej tabeli adresów IP emisji pojedynczej na komputerze lokalnym.</span><span class="sxs-lookup"><span data-stu-id="27b38-140">The <xref:System.Net.NetworkInformation.IPGlobalProperties.BeginGetUnicastAddresses%2A> method begins an asynchronous request to retrieve the stable unicast IP address table on the local computer.</span></span> <span data-ttu-id="27b38-141"><xref:System.Net.NetworkInformation.IPGlobalProperties.EndGetUnicastAddresses%2A>Metoda przerywa oczekujące asynchroniczne żądanie, aby pobrać stabilną tabelę adresów IP emisji pojedynczej na komputerze lokalnym.</span><span class="sxs-lookup"><span data-stu-id="27b38-141">The <xref:System.Net.NetworkInformation.IPGlobalProperties.EndGetUnicastAddresses%2A> method ends a pending asynchronous request to retrieve the stable unicast IP address table on the local computer.</span></span> <span data-ttu-id="27b38-142"><xref:System.Net.NetworkInformation.IPGlobalProperties.GetUnicastAddresses%2A>Metoda jest żądaniem synchronicznym, aby pobrać stabilną tabelę adresów IP emisji pojedynczej na komputerze lokalnym, czekając na zastabilizację tabeli adresów w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="27b38-142">The <xref:System.Net.NetworkInformation.IPGlobalProperties.GetUnicastAddresses%2A> method is a synchronous request to retrieve the stable unicast IP address table on the local computer, waiting until the address table stabilizes if necessary.</span></span>  
  
 <span data-ttu-id="27b38-143"><xref:System.Net.IPAddress.IsIPv6Teredo%2A?displayProperty=nameWithType>Właściwość może służyć do określenia, czy <xref:System.Net.IPAddress> jest adresem IPv6 protokołu Teredo.</span><span class="sxs-lookup"><span data-stu-id="27b38-143">The <xref:System.Net.IPAddress.IsIPv6Teredo%2A?displayProperty=nameWithType> property can be used to determine if an <xref:System.Net.IPAddress> is an IPv6 Teredo address.</span></span>  
  
 <span data-ttu-id="27b38-144">Korzystanie z tych nowych <xref:System.Net.NetworkInformation.IPGlobalProperties> metod klasy w połączeniu z <xref:System.Net.IPAddress.IsIPv6Teredo%2A> właściwością umożliwia aplikacji Łatwe znajdowanie adresu Teredo.</span><span class="sxs-lookup"><span data-stu-id="27b38-144">Using these new <xref:System.Net.NetworkInformation.IPGlobalProperties> class methods in combination with the <xref:System.Net.IPAddress.IsIPv6Teredo%2A> property allows an application to easily find the Teredo address.</span></span> <span data-ttu-id="27b38-145">Aplikacja zwykle musi znać lokalny adres Teredo, jeśli komunikuje się te informacje z aplikacjami zdalnymi.</span><span class="sxs-lookup"><span data-stu-id="27b38-145">An application normally only needs to know the local Teredo address if it is communicating this information to remote applications.</span></span> <span data-ttu-id="27b38-146">Na przykład aplikacja równorzędna może wysyłać wszystkie adresy IPv6 do serwera Matchmaking, który następnie przekazuje je do innych elementów równorzędnych w celu włączenia komunikacji bezpośredniej.</span><span class="sxs-lookup"><span data-stu-id="27b38-146">For example, a peer-to-peer application might send all of its IPv6 addresses to a matchmaking server which can then forward them to others peers to enable direct communication.</span></span>  
  
 <span data-ttu-id="27b38-147">Aplikacja powinna zwykle ustawić nasłuchiwanie usługi nasłuchujących <xref:System.Net.IPAddress.IPv6Any?displayProperty=nameWithType> , a nie na lokalnym adresie Teredo.</span><span class="sxs-lookup"><span data-stu-id="27b38-147">An application should normally set its listening service to listen on <xref:System.Net.IPAddress.IPv6Any?displayProperty=nameWithType> rather than on the local Teredo address.</span></span> <span data-ttu-id="27b38-148">Dlatego jeśli Klient zdalny lub węzeł równorzędny mają bezpośrednią trasę IPv6 do hosta usługi nasłuchiwania, klient lub element równorzędny może połączyć się bezpośrednio przy użyciu protokołu IPv6 i nie musi używać protokołu Teredo do tunelowania pakietów.</span><span class="sxs-lookup"><span data-stu-id="27b38-148">So if a remote client or peer has a direct IPv6 route to the host of the listening service, the client or peer can connect directly using IPv6 and not have to use Teredo to tunnel packets.</span></span>  
  
 <span data-ttu-id="27b38-149">W przypadku aplikacji TCP <xref:System.Net.Sockets.TcpListener?displayProperty=nameWithType> Klasa ma metodę umożliwiającą <xref:System.Net.Sockets.TcpListener.AllowNatTraversal%2A> Przechodzenie translatora adresów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="27b38-149">For TCP applications, the <xref:System.Net.Sockets.TcpListener?displayProperty=nameWithType> class has an <xref:System.Net.Sockets.TcpListener.AllowNatTraversal%2A> method to enable NAT traversal.</span></span> <span data-ttu-id="27b38-150">W przypadku aplikacji UDP <xref:System.Net.Sockets.UdpClient?displayProperty=nameWithType> Klasa ma metodę umożliwiającą <xref:System.Net.Sockets.UdpClient.AllowNatTraversal%2A> Przechodzenie translatora adresów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="27b38-150">For UDP applications, the <xref:System.Net.Sockets.UdpClient?displayProperty=nameWithType> class has an <xref:System.Net.Sockets.UdpClient.AllowNatTraversal%2A> method to enable NAT traversal.</span></span>  
  
 <span data-ttu-id="27b38-151">W przypadku aplikacji korzystających z <xref:System.Net.Sockets.Socket?displayProperty=nameWithType> klas i pokrewnych <xref:System.Net.Sockets.Socket.GetSocketOption%2A> <xref:System.Net.Sockets.Socket.SetSocketOption%2A> metody i mogą być używane z <xref:System.Net.Sockets.SocketOptionName.IPProtectionLevel?displayProperty=nameWithType> opcją Socket, aby wysyłać zapytania, włączać lub wyłączać przechodzenie translatora adresów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="27b38-151">For applications that use the <xref:System.Net.Sockets.Socket?displayProperty=nameWithType> and related classes, the <xref:System.Net.Sockets.Socket.GetSocketOption%2A> and <xref:System.Net.Sockets.Socket.SetSocketOption%2A> methods can be used with the <xref:System.Net.Sockets.SocketOptionName.IPProtectionLevel?displayProperty=nameWithType> socket option to query, enable, or disable NAT traversal.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="27b38-152">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="27b38-152">See also</span></span>

- <xref:System.Net.IPAddress.IsIPv6Teredo%2A?displayProperty=nameWithType>
- <xref:System.Net.NetworkInformation.IPGlobalProperties.BeginGetUnicastAddresses%2A?displayProperty=nameWithType>
- <xref:System.Net.NetworkInformation.IPGlobalProperties.EndGetUnicastAddresses%2A?displayProperty=nameWithType>
- <xref:System.Net.NetworkInformation.IPGlobalProperties.GetUnicastAddresses%2A?displayProperty=nameWithType>
- <xref:System.Net.Sockets.IPProtectionLevel?displayProperty=nameWithType>
- <xref:System.Net.Sockets.Socket.SetIPProtectionLevel%2A?displayProperty=nameWithType>
- <xref:System.Net.Sockets.TcpListener.AllowNatTraversal%2A?displayProperty=nameWithType>
- <xref:System.Net.Sockets.UdpClient.AllowNatTraversal%2A?displayProperty=nameWithType>
