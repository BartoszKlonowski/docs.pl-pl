---
title: Wyjątki
ms.date: 03/30/2017
ms.assetid: 065205cc-52dd-4f30-9578-b17d8d113136
ms.openlocfilehash: 53cc8e3e27e131c5c2a9f8271851a0d8d7e0cbd7
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/26/2020
ms.locfileid: "96280211"
---
# <a name="exceptions"></a><span data-ttu-id="ed958-102">Wyjątki</span><span class="sxs-lookup"><span data-stu-id="ed958-102">Exceptions</span></span>

<span data-ttu-id="ed958-103">Przepływy pracy mogą używać <xref:System.Activities.Statements.TryCatch> działania do obsługi wyjątków, które są wywoływane podczas wykonywania przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="ed958-103">Workflows can use the <xref:System.Activities.Statements.TryCatch> activity to handle exceptions that are raised during the execution of a workflow.</span></span> <span data-ttu-id="ed958-104">Te wyjątki mogą być obsługiwane lub mogą być ponownie zgłaszane przy użyciu <xref:System.Activities.Statements.Rethrow> działania.</span><span class="sxs-lookup"><span data-stu-id="ed958-104">These exceptions can be handled or they can be re-thrown using the <xref:System.Activities.Statements.Rethrow> activity.</span></span> <span data-ttu-id="ed958-105">Działania w <xref:System.Activities.Statements.TryCatch.Finally%2A> sekcji są wykonywane <xref:System.Activities.Statements.TryCatch.Try%2A> , gdy sekcja lub <xref:System.Activities.Statements.TryCatch.Catches%2A> sekcja zostanie ukończona.</span><span class="sxs-lookup"><span data-stu-id="ed958-105">Activities in the <xref:System.Activities.Statements.TryCatch.Finally%2A> section are executed when either the <xref:System.Activities.Statements.TryCatch.Try%2A> section or the <xref:System.Activities.Statements.TryCatch.Catches%2A> section completes.</span></span> <span data-ttu-id="ed958-106">Przepływy pracy hostowane przez <xref:System.Activities.WorkflowApplication> wystąpienie mogą również używać <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> programu obsługi zdarzeń do obsługi wyjątków, które nie są obsługiwane przez <xref:System.Activities.Statements.TryCatch> działanie.</span><span class="sxs-lookup"><span data-stu-id="ed958-106">Workflows hosted by a <xref:System.Activities.WorkflowApplication> instance can also use the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> event handler to handle exceptions that are not handled by a <xref:System.Activities.Statements.TryCatch> activity.</span></span>  
  
## <a name="causes-of-exceptions"></a><span data-ttu-id="ed958-107">Przyczyny wyjątków</span><span class="sxs-lookup"><span data-stu-id="ed958-107">Causes of Exceptions</span></span>  

 <span data-ttu-id="ed958-108">W przepływie pracy wyjątki mogą być generowane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="ed958-108">In a workflow, exceptions can be generated in the following ways:</span></span>  
  
- <span data-ttu-id="ed958-109">Limit czasu transakcji w <xref:System.Activities.Statements.TransactionScope> .</span><span class="sxs-lookup"><span data-stu-id="ed958-109">A time-out of transactions in <xref:System.Activities.Statements.TransactionScope>.</span></span>  
  
- <span data-ttu-id="ed958-110">Jawny wyjątek zgłoszony przez przepływ pracy przy użyciu <xref:System.Activities.Statements.Throw> działania.</span><span class="sxs-lookup"><span data-stu-id="ed958-110">An explicit exception thrown by the workflow using the <xref:System.Activities.Statements.Throw> activity.</span></span>  
  
- <span data-ttu-id="ed958-111">[!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)]Zgłoszono wyjątek z działania.</span><span class="sxs-lookup"><span data-stu-id="ed958-111">A [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] exception thrown from an activity.</span></span>  
  
- <span data-ttu-id="ed958-112">Wyjątek zgłoszony przez kod zewnętrzny, taki jak biblioteki, składniki lub usługi, które są używane w przepływie pracy.</span><span class="sxs-lookup"><span data-stu-id="ed958-112">An exception thrown from external code, such as libraries, components, or services that are used in the workflow.</span></span>  
  
## <a name="handling-exceptions"></a><span data-ttu-id="ed958-113">Obsługa wyjątków</span><span class="sxs-lookup"><span data-stu-id="ed958-113">Handling Exceptions</span></span>  

 <span data-ttu-id="ed958-114">Jeśli wyjątek jest zgłaszany przez działanie i jest nieobsługiwany, domyślnym zachowaniem jest zakończenie wystąpienia przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="ed958-114">If an exception is thrown by an activity and is unhandled, the default behavior is to terminate the workflow instance.</span></span> <span data-ttu-id="ed958-115">Jeśli istnieje niestandardowa <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> obsługa, może ona zastąpić to zachowanie domyślne.</span><span class="sxs-lookup"><span data-stu-id="ed958-115">If a custom <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is present, it can override this default behavior.</span></span> <span data-ttu-id="ed958-116">Ta procedura obsługi umożliwia tworzenie przez hosta przepływu pracy odpowiedniej obsługi, takiej jak rejestrowanie niestandardowe, przerywanie przepływu pracy, Anulowanie przepływu pracy lub kończenie przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="ed958-116">This handler gives the workflow host author an opportunity to provide the appropriate handling, such as custom logging, aborting the workflow, canceling the workflow, or terminating the workflow.</span></span>  <span data-ttu-id="ed958-117">Jeśli przepływ pracy zgłasza wyjątek, który nie jest obsługiwany, <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> zostanie wywołana procedura obsługi.</span><span class="sxs-lookup"><span data-stu-id="ed958-117">If a workflow raises an exception that is not handled, the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is invoked.</span></span> <span data-ttu-id="ed958-118">Istnieją trzy możliwe akcje, które zostały zwrócone przez <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> określenie końcowego wyniku przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="ed958-118">There are three possible actions returned from <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> which determine the final outcome of the workflow.</span></span>  
  
- <span data-ttu-id="ed958-119">**Anuluj** — anulowane wystąpienie przepływu pracy to bezpieczne zakończenie wykonywania gałęzi.</span><span class="sxs-lookup"><span data-stu-id="ed958-119">**Cancel** - A cancelled workflow instance is a graceful exit of a branch execution.</span></span> <span data-ttu-id="ed958-120">Można modelować zachowanie anulowania (na przykład przy użyciu działania CancellationScope).</span><span class="sxs-lookup"><span data-stu-id="ed958-120">You can model cancelation behavior (for example, by using a CancellationScope activity).</span></span> <span data-ttu-id="ed958-121">Zakończona procedura obsługi jest wywoływana, gdy zakończy się proces anulowania.</span><span class="sxs-lookup"><span data-stu-id="ed958-121">The Completed handler is invoked when the cancellation process completes.</span></span> <span data-ttu-id="ed958-122">Anulowany przepływ pracy jest w stanie anulowania.</span><span class="sxs-lookup"><span data-stu-id="ed958-122">A cancelled workflow is in the Cancelled state.</span></span>  
  
- <span data-ttu-id="ed958-123">**Zakończenie** — nie można wznowić ani uruchomić przerwanego wystąpienia przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="ed958-123">**Terminate** - A terminated workflow instance cannot be resumed or restarted.</span></span>  <span data-ttu-id="ed958-124">Powoduje to wyzwolenie zdarzenia zakończonego, w którym można podać wyjątek jako powód przerwania.</span><span class="sxs-lookup"><span data-stu-id="ed958-124">This triggers the Completed event in which you can provide an exception as the reason it was terminated.</span></span> <span data-ttu-id="ed958-125">Zakończona procedura obsługi jest wywoływana po zakończeniu procesu kończenia.</span><span class="sxs-lookup"><span data-stu-id="ed958-125">The Terminated handler is invoked when the termination process completes.</span></span> <span data-ttu-id="ed958-126">Przerwany przepływ pracy jest w stanie awarii.</span><span class="sxs-lookup"><span data-stu-id="ed958-126">A terminated workflow is in the Faulted state.</span></span>  
  
- <span data-ttu-id="ed958-127">**Przerwanie** — przerwane wystąpienia przepływu pracy można wznowić tylko wtedy, gdy zostało skonfigurowane jako trwałe.</span><span class="sxs-lookup"><span data-stu-id="ed958-127">**Abort** - An aborted workflow instances can be resumed only if it has been configured to be persistent.</span></span>  <span data-ttu-id="ed958-128">Bez trwałości przepływ pracy nie może zostać wznowiony.</span><span class="sxs-lookup"><span data-stu-id="ed958-128">Without persistence, a workflow cannot be resumed.</span></span>  <span data-ttu-id="ed958-129">W momencie przerwania przepływu pracy wszystkie wykonane prace (w pamięci) od momentu ostatniego punktu trwałości zostaną utracone.</span><span class="sxs-lookup"><span data-stu-id="ed958-129">At the point a workflow is aborted, any work done (in memory) since the last persistence point will be lost.</span></span> <span data-ttu-id="ed958-130">W przypadku przerwanego przepływu pracy procedura obsługi przerwana jest wywoływana przy użyciu wyjątku jako przyczyny zakończenia procesu przerywania.</span><span class="sxs-lookup"><span data-stu-id="ed958-130">For an aborted workflow, the Aborted handler is invoked using the exception as the reason when the abort process completes.</span></span> <span data-ttu-id="ed958-131">Jednak, w przeciwieństwie do anulowanych i zakończonych, ukończona procedura obsługi nie zostanie wywołana.</span><span class="sxs-lookup"><span data-stu-id="ed958-131">However, unlike Cancelled and Terminated, the Completed handler is not invoked.</span></span> <span data-ttu-id="ed958-132">Przerwany przepływ pracy jest w stanie przerwania.</span><span class="sxs-lookup"><span data-stu-id="ed958-132">An aborted workflow is in an Aborted state.</span></span>  
  
 <span data-ttu-id="ed958-133">Poniższy przykład wywołuje przepływ pracy, który zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="ed958-133">The following example invokes a workflow that throws an exception.</span></span> <span data-ttu-id="ed958-134">Wyjątek jest nieobsługiwany przez przepływ pracy i <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> wywoływany jest program obsługi.</span><span class="sxs-lookup"><span data-stu-id="ed958-134">The exception is unhandled by the workflow and the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is invoked.</span></span> <span data-ttu-id="ed958-135"><xref:System.Activities.WorkflowApplicationUnhandledExceptionEventArgs>Są one sprawdzane w celu podania informacji o wyjątku, a przepływ pracy zostaje zakończony.</span><span class="sxs-lookup"><span data-stu-id="ed958-135">The <xref:System.Activities.WorkflowApplicationUnhandledExceptionEventArgs> are inspected to provide information about the exception, and the workflow is terminated.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#1)]  
  
### <a name="handling-exceptions-with-the-trycatch-activity"></a><span data-ttu-id="ed958-136">Obsługa wyjątków przy użyciu działania TryCatch</span><span class="sxs-lookup"><span data-stu-id="ed958-136">Handling Exceptions with the TryCatch Activity</span></span>  

 <span data-ttu-id="ed958-137">Obsługa wyjątków w przepływie pracy odbywa się przy użyciu <xref:System.Activities.Statements.TryCatch> działania.</span><span class="sxs-lookup"><span data-stu-id="ed958-137">Handling exceptions inside a workflow is performed with the <xref:System.Activities.Statements.TryCatch> activity.</span></span> <span data-ttu-id="ed958-138"><xref:System.Activities.Statements.TryCatch>Działanie zawiera <xref:System.Activities.Statements.TryCatch.Catches%2A> kolekcję <xref:System.Activities.Statements.Catch> działań, które są skojarzone z określonym <xref:System.Exception> typem.</span><span class="sxs-lookup"><span data-stu-id="ed958-138">The <xref:System.Activities.Statements.TryCatch> activity has a <xref:System.Activities.Statements.TryCatch.Catches%2A> collection of <xref:System.Activities.Statements.Catch> activities that are each associated with a specific <xref:System.Exception> type.</span></span> <span data-ttu-id="ed958-139">Jeśli wyjątek zgłoszony przez działanie zawarte w <xref:System.Activities.Statements.TryCatch.Try%2A> sekcji <xref:System.Activities.Statements.TryCatch> działania jest zgodny z wyjątkiem <xref:System.Activities.Statements.Catch%601> działania w <xref:System.Activities.Statements.TryCatch.Catches%2A> kolekcji, wyjątek jest obsługiwany.</span><span class="sxs-lookup"><span data-stu-id="ed958-139">If the exception thrown by an activity that is contained in the <xref:System.Activities.Statements.TryCatch.Try%2A> section of a <xref:System.Activities.Statements.TryCatch> activity matches the exception of a <xref:System.Activities.Statements.Catch%601> activity in the <xref:System.Activities.Statements.TryCatch.Catches%2A> collection, then the exception is handled.</span></span> <span data-ttu-id="ed958-140">Jeśli wyjątek jest jawnie ponownie zgłaszany lub zostanie wygenerowany nowy wyjątek, ten wyjątek przekazuje działanie nadrzędne.</span><span class="sxs-lookup"><span data-stu-id="ed958-140">If the exception is explicitly re-thrown or a new exception is thrown then this exception passes up to the parent activity.</span></span> <span data-ttu-id="ed958-141">Poniższy przykład kodu pokazuje <xref:System.Activities.Statements.TryCatch> działanie, które obsługuje zdarzenie <xref:System.ApplicationException> , które jest zgłaszane w <xref:System.Activities.Statements.TryCatch.Try%2A> sekcji przez <xref:System.Activities.Statements.Throw> działanie.</span><span class="sxs-lookup"><span data-stu-id="ed958-141">The following code example shows a <xref:System.Activities.Statements.TryCatch> activity that handles an <xref:System.ApplicationException> that is thrown in the <xref:System.Activities.Statements.TryCatch.Try%2A> section by a <xref:System.Activities.Statements.Throw> activity.</span></span> <span data-ttu-id="ed958-142">Komunikat wyjątku jest zapisywana w konsoli przez <xref:System.Activities.Statements.Catch%601> działanie, a następnie jest zapisywana w konsoli w <xref:System.Activities.Statements.TryCatch.Finally%2A> sekcji.</span><span class="sxs-lookup"><span data-stu-id="ed958-142">The exception's message is written to the console by the <xref:System.Activities.Statements.Catch%601> activity, and then a message is written to the console in the <xref:System.Activities.Statements.TryCatch.Finally%2A> section.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#33](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#33)]  
  
 <span data-ttu-id="ed958-143">Działania w <xref:System.Activities.Statements.TryCatch.Finally%2A> sekcji są wykonywane, gdy <xref:System.Activities.Statements.TryCatch.Try%2A> sekcja lub <xref:System.Activities.Statements.TryCatch.Catches%2A> sekcja zostanie pomyślnie ukończona.</span><span class="sxs-lookup"><span data-stu-id="ed958-143">The activities in the <xref:System.Activities.Statements.TryCatch.Finally%2A> section are executed when either the <xref:System.Activities.Statements.TryCatch.Try%2A> section or the <xref:System.Activities.Statements.TryCatch.Catches%2A> section successfully completes.</span></span> <span data-ttu-id="ed958-144"><xref:System.Activities.Statements.TryCatch.Try%2A>Sekcja została zakończona pomyślnie, jeśli nie zgłoszono żadnych wyjątków, a <xref:System.Activities.Statements.TryCatch.Catches%2A> sekcja została pomyślnie ukończona, jeśli nie zostaną zgłoszone lub ponownie zgłoszone wyjątki.</span><span class="sxs-lookup"><span data-stu-id="ed958-144">The <xref:System.Activities.Statements.TryCatch.Try%2A> section successfully completes if no exceptions are thrown from it, and the <xref:System.Activities.Statements.TryCatch.Catches%2A> section successfully completes if no exceptions are thrown or rethrown from it.</span></span> <span data-ttu-id="ed958-145">Jeśli wyjątek jest zgłaszany w <xref:System.Activities.Statements.TryCatch.Try%2A> sekcji a <xref:System.Activities.Statements.TryCatch> i nie jest obsługiwany przez <xref:System.Activities.Statements.Catch%601> w <xref:System.Activities.Statements.TryCatch.Catches%2A> sekcji lub jest ponownie zgłaszany z <xref:System.Activities.Statements.TryCatch.Catches%2A> , działania w ramach <xref:System.Activities.Statements.TryCatch.Finally%2A> nie zostaną wykonane, chyba że wystąpi jedno z poniższych.</span><span class="sxs-lookup"><span data-stu-id="ed958-145">If an exception is thrown in the <xref:System.Activities.Statements.TryCatch.Try%2A> section of a <xref:System.Activities.Statements.TryCatch> and is either not handled by a <xref:System.Activities.Statements.Catch%601> in the <xref:System.Activities.Statements.TryCatch.Catches%2A> section, or is rethrown from the <xref:System.Activities.Statements.TryCatch.Catches%2A>, the activities in the <xref:System.Activities.Statements.TryCatch.Finally%2A> will not be executed unless the one of the following occurs.</span></span>  
  
- <span data-ttu-id="ed958-146">Wyjątek jest przechwytywany przez działanie wyższego poziomu <xref:System.Activities.Statements.TryCatch> w przepływie pracy, niezależnie od tego, czy jest on ponownie zgłaszany na wyższym poziomie <xref:System.Activities.Statements.TryCatch> .</span><span class="sxs-lookup"><span data-stu-id="ed958-146">The exception is caught by a higher level <xref:System.Activities.Statements.TryCatch> activity in the workflow, regardless of whether it is rethrown from that higher level <xref:System.Activities.Statements.TryCatch>.</span></span>  
  
- <span data-ttu-id="ed958-147">Wyjątek nie jest obsługiwany przez wyższy poziom <xref:System.Activities.Statements.TryCatch> , wyprowadza element główny przepływu pracy, a przepływ pracy jest skonfigurowany do anulowania, a nie przerwanie lub przerywanie.</span><span class="sxs-lookup"><span data-stu-id="ed958-147">The exception is not handled by a higher level <xref:System.Activities.Statements.TryCatch>, escapes the root of the workflow, and the workflow is configured to cancel instead of terminate or abort.</span></span> <span data-ttu-id="ed958-148">Przepływy pracy hostowane przy użyciu programu <xref:System.Activities.WorkflowApplication> mogą konfigurować je przez obsługę <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> i zwracanie <xref:System.Activities.UnhandledExceptionAction.Cancel> .</span><span class="sxs-lookup"><span data-stu-id="ed958-148">Workflows hosted using <xref:System.Activities.WorkflowApplication> can configure this by handling <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> and returning <xref:System.Activities.UnhandledExceptionAction.Cancel>.</span></span> <span data-ttu-id="ed958-149">Przykład obsługi <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> jest podany wcześniej w tym temacie.</span><span class="sxs-lookup"><span data-stu-id="ed958-149">An example of handling <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> is provided previously in this topic.</span></span> <span data-ttu-id="ed958-150">Usługi przepływu pracy można skonfigurować przy użyciu <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> i określania <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel> .</span><span class="sxs-lookup"><span data-stu-id="ed958-150">Workflow services can configure this by using <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> and specifying <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel>.</span></span> <span data-ttu-id="ed958-151">Przykład konfiguracji można znaleźć w <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> temacie [Rozszerzalność hosta usługi przepływu pracy](../wcf/feature-details/workflow-service-host-extensibility.md).</span><span class="sxs-lookup"><span data-stu-id="ed958-151">For an example of configuring <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior>, see [Workflow Service Host Extensibility](../wcf/feature-details/workflow-service-host-extensibility.md).</span></span>  
  
## <a name="exception-handling-versus-compensation"></a><span data-ttu-id="ed958-152">Obsługa wyjątków w porównaniu z wynagrodzeniem</span><span class="sxs-lookup"><span data-stu-id="ed958-152">Exception Handling versus Compensation</span></span>  

 <span data-ttu-id="ed958-153">Różnica między obsługą wyjątków a kompensacją polega na tym, że obsługa wyjątków odbywa się podczas wykonywania działania.</span><span class="sxs-lookup"><span data-stu-id="ed958-153">The difference between exception handling and compensation is that exception handling occurs during the execution of an activity.</span></span> <span data-ttu-id="ed958-154">Kompensacja występuje po pomyślnym ukończeniu działania.</span><span class="sxs-lookup"><span data-stu-id="ed958-154">Compensation occurs after an activity has successfully completed.</span></span> <span data-ttu-id="ed958-155">Obsługa wyjątków umożliwia wyczyszczenie, gdy działanie podnosi wyjątek, natomiast kompensacja zapewnia mechanizm, za pomocą którego pomyślnie ukończona pracy wykonanego wcześniej działania można cofnąć.</span><span class="sxs-lookup"><span data-stu-id="ed958-155">Exception handling provides an opportunity to clean up after the activity raises the exception, whereas compensation provides a mechanism by which the successfully completed work of a previously completed activity can be undone.</span></span> <span data-ttu-id="ed958-156">Aby uzyskać więcej informacji, zobacz [kompensacja](compensation.md).</span><span class="sxs-lookup"><span data-stu-id="ed958-156">For more information, see [Compensation](compensation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ed958-157">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="ed958-157">See also</span></span>

- <xref:System.Activities.Statements.TryCatch>
- <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>
- <xref:System.Activities.Statements.CompensableActivity>
