---
title: Działanie zablokowanego wyjątku wystąpienia
ms.date: 03/30/2017
ms.assetid: 164a5419-315c-4987-ad72-54cbdb88d402
ms.openlocfilehash: 3554975589bb6d55cef3611320d25687d1ee9ba6
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/26/2020
ms.locfileid: "96279860"
---
# <a name="instance-locked-exception-action"></a>Działanie zablokowanego wyjątku wystąpienia

<xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A>Właściwość magazynu wystąpień przepływu pracy SQL pozwala określić akcję, którą powinien wykonać dostawca trwałości SQL po odebraniu <xref:System.Runtime.DurableInstancing.InstanceLockedException> . Dostawca trwałości odbiera ten wyjątek, gdy próbuje zablokować wystąpienie usługi przepływu pracy, które jest aktualnie zablokowane przez innego hosta usługi. Wartości tej właściwości to <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.NoRetry> , <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.BasicRetry> i <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.AggressiveRetry> . Wartość domyślna to <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.NoRetry>. Na poniższej liście opisano trzy opcje:  
  
- <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.NoRetry>. Host usługi nie próbuje zablokować wystąpienia usługi przepływu pracy i przekazuje <xref:System.Runtime.DurableInstancing.InstanceLockedException> do obiektu wywołującego.  Jeśli przepływ pracy pozostaje w pamięci przez okres przekraczający 60 sekund, użyj <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.NoRetry> jako ponownych prób. Wartość domyślna to <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.NoRetry>.  
  
- <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.BasicRetry>. Host usługi ponawia próbę zablokowania wystąpienia usługi przepływu pracy z interwałem liniowym między ponownymi próbami i przekazaniem <xref:System.Runtime.DurableInstancing.InstanceLockedException> do obiektu wywołującego na końcu sekwencji. Jeśli przepływ pracy pozostaje w pamięci około 5-60 sekund, a komunikaty docierają do partii, w których bardziej prawdopodobnie komunikaty są wysyłane do tego samego wystąpienia na tym samym hoście, aby przetwarzać wszystkie komunikaty przed zwolnieniem przepływu pracy, należy użyć <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.BasicRetry> do osiągnięcia najlepszego opóźnienia bez marnowania zasobów.  
  
- <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.AggressiveRetry>. Host usługi ponawia próbę zablokowania wystąpienia usługi przepływu pracy z wykładniczym interwałem wycofywania między ponownymi próbami i przekazuje wyjątek do obiektu wywołującego na końcu sekwencji. Jeśli przepływ pracy pozostaje w pamięci przez bardzo krótki czas (mniej niż 5 sekund) lub farma sieci Web jest duża i szansa na ten sam komunikat jest dostarczana do tego samego hosta, w <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.AggressiveRetry> celu osiągnięcia najlepszego opóźnienia.  
  
 Funkcja akcji zablokowanego wyjątku wystąpienia obsługuje następujące scenariusze. We wszystkich scenariuszach, jeśli właściwość instanceLockedExceptionAction obiekt SqlWorkflowInstanceStore jest ustawiona na <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.BasicRetry> lub <xref:System.Activities.DurableInstancing.InstanceLockedExceptionAction.AggressiveRetry> , host w sposób niewidoczny ponownie próbuje uzyskać blokadę w wystąpieniach okresowo.  
  
1. **Włączenie bezpiecznego zamykania i nakładanie się powtórnego odtwarzania domen aplikacji.** Załóżmy, że obiekt **AppDomain** z uruchomionym wystąpieniem usługi przepływu pracy jest odtwarzany, a nowa **domena aplikacji** jest w stanie obsłużyć nowe żądania równolegle, podczas gdy stara **domena AppDomain** zostanie bezpiecznie wyłączona. Wyłączenie czeka, aż wystąpienia usługi przepływu pracy są bezczynne, a następnie utrwala i zwalnia wystąpienia. Wszystkie próby zablokowania wystąpienia przez hosty w nowej **domenie AppDomain** spowodują wystąpienie elementu <xref:System.Runtime.DurableInstancing.InstanceLockedException> .  
  
2. **Skalowanie w poziomie trwałe przepływy pracy w jednorodnej farmie serwerów.** Załóżmy, że węzeł farmy serwerów, na którym jest uruchomione wystąpienie przepływu pracy, nie może usunąć blokad w wystąpieniu, które jest uruchomione. Gdy host usługi uruchomiony w innym węźle farmy odbiera komunikat dla tego wystąpienia przepływu pracy, próbuje uzyskać blokady w tych wystąpieniach, które otrzyma <xref:System.Runtime.DurableInstancing.InstanceLockedException> . Blokady wygasną po pewnym czasie, ponieważ Host, który miał zostać odnowiony, już nie istnieje.  
  
     **Skalowanie w poziomie trwałe przepływy pracy w jednorodnej farmie serwerów.**  Załóżmy, że chcesz skalować w poziomie przepływ pracy trwałej przy użyciu wielu hostów za NLB (Load Balancer sieci). host przepływu pracy uruchomiony w jednym węźle farmy ładuje wystąpienie przepływu pracy i przetwarza komunikat, a następny komunikat do wystąpienia jest kierowany do hosta, który jest uruchomiony w innym węźle, ponieważ Równoważenie obciążenia sieciowego nie ma algorytmu routingu do dostarczania komunikatów do hosta, na którym jest już uruchomione wystąpienie. Po odebraniu komunikatu drugi host próbuje załadować wystąpienie przepływu pracy i odbiera, <xref:System.Runtime.DurableInstancing.InstanceLockedException> ponieważ pierwszy host ma blokadę wystąpienia. Pierwszy Host odblokowuje wystąpienie po zakończeniu przetwarzania pierwszego komunikatu, a drugi Host uzyskuje blokadę po ponownym ponowieniu próby, załaduje wystąpienie i przetworzy drugi komunikat.
