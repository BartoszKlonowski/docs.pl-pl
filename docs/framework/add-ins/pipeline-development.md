---
title: Opracowywanie potoku
ms.date: 03/30/2017
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: f981d667f3cbf35ab010ac5bd26a9ecd5c2aae11
ms.sourcegitcommit: ccd8c36b0d74d99291d41aceb14cf98d74dc9d2b
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/10/2018
ms.locfileid: "53151346"
---
# <a name="pipeline-development"></a><span data-ttu-id="21d64-102">Opracowywanie potoku</span><span class="sxs-lookup"><span data-stu-id="21d64-102">Pipeline Development</span></span>
<span data-ttu-id="21d64-103">Potok dodatku jest ścieżka segmenty potoku, których aplikacja hosta i jego dodatku musi komunikować się ze sobą.</span><span class="sxs-lookup"><span data-stu-id="21d64-103">The add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.</span></span>  
  
 <span data-ttu-id="21d64-104">Na poniższej ilustracji przedstawiono potok komunikacji i jego segmentów.</span><span class="sxs-lookup"><span data-stu-id="21d64-104">The following illustration shows the communication pipeline and its segments.</span></span>  
  
 <span data-ttu-id="21d64-105">![Dodaj&#45;w modelu potoku. ](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span><span class="sxs-lookup"><span data-stu-id="21d64-105">![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span></span>  
<span data-ttu-id="21d64-106">Potok dodatku</span><span class="sxs-lookup"><span data-stu-id="21d64-106">Add-in pipeline</span></span>  
  
 <span data-ttu-id="21d64-107">Aplikacja hosta jest na jednym końcu potoku i dodatek jest na końcu.</span><span class="sxs-lookup"><span data-stu-id="21d64-107">The host application is at one end of the pipeline and the add-in is at the other end.</span></span> <span data-ttu-id="21d64-108">Począwszy od zakończenia każdego przenoszenie kierunku środka, zarówno aplikacji hosta, jak i dodatku się abstrakcyjna klasa bazowa, definiujący widok modelu obiektów, które współużytkują one zarówno.</span><span class="sxs-lookup"><span data-stu-id="21d64-108">Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share.</span></span> <span data-ttu-id="21d64-109">Te typy (grupy) tworzą segmentów potoku dodatku widoku oraz widoku hosta segmentów potoku dodatku.</span><span class="sxs-lookup"><span data-stu-id="21d64-109">These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment.</span></span> <span data-ttu-id="21d64-110">Segmentów potoku dodatku widoku często zawiera więcej niż jednej klasy abstrakcyjnej, ale klasa, która dodatek dziedziczy jest znany jako podstawowy dodatek.</span><span class="sxs-lookup"><span data-stu-id="21d64-110">The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.</span></span>  
  
 <span data-ttu-id="21d64-111">Segment potoku karty add w side i Konwertuj segment potoku adaptery po stronie hosta przepływu typów między ich segmenty potoku widoku i segmentów potoku kontraktu.</span><span class="sxs-lookup"><span data-stu-id="21d64-111">The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment.</span></span> <span data-ttu-id="21d64-112">Centralna segmentów potoku jest kontraktu, który jest tworzony na podstawie <xref:System.AddIn.Contract.IContract> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="21d64-112">The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface.</span></span> <span data-ttu-id="21d64-113">Ten kontrakt definiuje metody, które aplikacja hosta i jego dodatek zarówno użyje.</span><span class="sxs-lookup"><span data-stu-id="21d64-113">This contract defines the methods that the host application and its add-in will both use.</span></span>  
  
 <span data-ttu-id="21d64-114">Jeśli załadujesz hostem a dodatkiem do domen aplikacji w oddzielnych, masz izolującą granicę oddzielający zakresu aplikacji hosta z zakresu od dodatku.</span><span class="sxs-lookup"><span data-stu-id="21d64-114">If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in.</span></span> <span data-ttu-id="21d64-115">Kontrakt jest tylko zestaw, który jest załadowany do hosta i domen aplikacji w dodatku.</span><span class="sxs-lookup"><span data-stu-id="21d64-115">The contract is the only assembly that is loaded in both the host and add-in application domains.</span></span> <span data-ttu-id="21d64-116">Hosta i Dodaj do każdego dotyczą tylko swój widok metody kontraktu.</span><span class="sxs-lookup"><span data-stu-id="21d64-116">The host and the add-in each refer only to their view of the contract methods.</span></span> <span data-ttu-id="21d64-117">W związku z tym są rozdzielone przez warstwę abstrakcji z umowy.</span><span class="sxs-lookup"><span data-stu-id="21d64-117">Therefore, they are separated by a layer of abstraction from the contract.</span></span>  
  
 <span data-ttu-id="21d64-118">Aby opracować segmenty potoku, należy utworzyć strukturę katalogów, która będzie zawierać je.</span><span class="sxs-lookup"><span data-stu-id="21d64-118">To develop pipeline segments, you must create a directory structure that will contain them.</span></span> <span data-ttu-id="21d64-119">Aby uzyskać więcej informacji o wymaganiach dotyczących tworzenia i wytyczne dotyczące zakresu, zobacz [wymagania dotyczące opracowywania potoku](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span><span class="sxs-lookup"><span data-stu-id="21d64-119">For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span></span>  
  
 <span data-ttu-id="21d64-120">Poniższa ilustracja przedstawia typy, które tworzą segmenty potoku.</span><span class="sxs-lookup"><span data-stu-id="21d64-120">The following illustration shows the types that make up the pipeline segments.</span></span> <span data-ttu-id="21d64-121">Nazwy typów przedstawiono na rysunku są dowolne, ale wszystkich typów, z wyjątkiem hosta i hosta wyświetlić atrybutów wymagają dodatku, dzięki czemu mogą oni zostać odnalezieni za pomocą metod, które konstruowania Magazyn informacji.</span><span class="sxs-lookup"><span data-stu-id="21d64-121">The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.</span></span>  
  
 <span data-ttu-id="21d64-122">![Dodaj&#45;w modelu z wymaganych atrybutów dla typów. ](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span><span class="sxs-lookup"><span data-stu-id="21d64-122">![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span></span>  
<span data-ttu-id="21d64-123">Potok dodatku z typami</span><span class="sxs-lookup"><span data-stu-id="21d64-123">Add-in pipeline with types</span></span>  
  
 <span data-ttu-id="21d64-124">W poniższej tabeli opisano segmenty potoku do aktywacji dodatku.</span><span class="sxs-lookup"><span data-stu-id="21d64-124">The following table describes the pipeline segments for activating an add-in.</span></span> <span data-ttu-id="21d64-125">Aby uzyskać więcej informacji na temat tych segmentach zobacz [kontrakty, widoki i adaptery](https://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span><span class="sxs-lookup"><span data-stu-id="21d64-125">For more information about these segments, see [Contracts, Views, and Adapters](https://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span></span>  
  
|<span data-ttu-id="21d64-126">Segment potoku</span><span class="sxs-lookup"><span data-stu-id="21d64-126">Pipeline segment</span></span>|<span data-ttu-id="21d64-127">Opis</span><span class="sxs-lookup"><span data-stu-id="21d64-127">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="21d64-128">Host</span><span class="sxs-lookup"><span data-stu-id="21d64-128">Host</span></span>|<span data-ttu-id="21d64-129">Zestaw aplikacji, który tworzy wystąpienie klasy dodatku.</span><span class="sxs-lookup"><span data-stu-id="21d64-129">The application assembly that creates an instance of an add-in.</span></span>|  
|<span data-ttu-id="21d64-130">Widok hosta dodatków</span><span class="sxs-lookup"><span data-stu-id="21d64-130">Host view of the add-in</span></span>|<span data-ttu-id="21d64-131">Reprezentuje widok aplikacji hosta typy obiektów i metod używanych do komunikowania się z dodatku.</span><span class="sxs-lookup"><span data-stu-id="21d64-131">Represents the host application's view of the object types and methods used to communicate with the add-in.</span></span> <span data-ttu-id="21d64-132">Widok hosta jest abstrakcyjna klasa bazowa lub interfejs.</span><span class="sxs-lookup"><span data-stu-id="21d64-132">The host view is an abstract base class or interface.</span></span>|  
|<span data-ttu-id="21d64-133">Adaptery po stronie hosta</span><span class="sxs-lookup"><span data-stu-id="21d64-133">Host-side adapter</span></span>|<span data-ttu-id="21d64-134">Zestaw z co najmniej jedną klasę, która dostosowuje się metody do i z umowy.</span><span class="sxs-lookup"><span data-stu-id="21d64-134">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="21d64-135">Ten segment potoku jest identyfikowany przy użyciu <xref:System.AddIn.Pipeline.HostAdapterAttribute> atrybutu.</span><span class="sxs-lookup"><span data-stu-id="21d64-135">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="21d64-136">Zestawy wielu modułów są nieobsługiwane.</span><span class="sxs-lookup"><span data-stu-id="21d64-136">Multi-module assemblies are not supported.</span></span>|  
|<span data-ttu-id="21d64-137">Kontrakt</span><span class="sxs-lookup"><span data-stu-id="21d64-137">Contract</span></span>|<span data-ttu-id="21d64-138">Interfejs, który jest tworzony na podstawie <xref:System.AddIn.Contract.IContract> interfejsu i który definiuje protokół komunikacji typów między hostem a jego dodatku.</span><span class="sxs-lookup"><span data-stu-id="21d64-138">An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in.</span></span><br /><br /> <span data-ttu-id="21d64-139">Ten segment potoku jest identyfikowany przez ustawienie <xref:System.AddIn.Pipeline.AddInContractAttribute> atrybutu.</span><span class="sxs-lookup"><span data-stu-id="21d64-139">This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute.</span></span>|  
|<span data-ttu-id="21d64-140">Dodawanie strony karty</span><span class="sxs-lookup"><span data-stu-id="21d64-140">Add-in-side adapter</span></span>|<span data-ttu-id="21d64-141">Zestaw z co najmniej jedną klasę, która dostosowuje się metody do i z umowy.</span><span class="sxs-lookup"><span data-stu-id="21d64-141">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="21d64-142">Ten segment potoku jest identyfikowany przy użyciu <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atrybutu.</span><span class="sxs-lookup"><span data-stu-id="21d64-142">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="21d64-143">Każdego zestawu w katalogu karty Dodaj strony, który zawiera typ, który ma <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atrybutu jest ładowany do dodatku w domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="21d64-143">Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain.</span></span><br /><br /> <span data-ttu-id="21d64-144">Każdego zestawu w katalogu add w side jest ładowany w domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="21d64-144">Each assembly in the add-in-side directory is loaded in its own application domain.</span></span><br /><br /> <span data-ttu-id="21d64-145">Zestawy wielu modułu nie są obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="21d64-145">Multi-module assemblies are not supported</span></span>|  
|<span data-ttu-id="21d64-146">Widok dodatku</span><span class="sxs-lookup"><span data-stu-id="21d64-146">Add-in view</span></span>|<span data-ttu-id="21d64-147">Zestaw, który reprezentuje Widok dodatku typy obiektów i metod, które są używane do komunikacji z hostem.</span><span class="sxs-lookup"><span data-stu-id="21d64-147">An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host.</span></span> <span data-ttu-id="21d64-148">Widok dodatku jest abstrakcyjna klasa bazowa lub interfejs.</span><span class="sxs-lookup"><span data-stu-id="21d64-148">The add-in view is an abstract base class or interface.</span></span><br /><br /> <span data-ttu-id="21d64-149">Ten segment potoku jest identyfikowany przy użyciu <xref:System.AddIn.Pipeline.AddInBaseAttribute> atrybutu.</span><span class="sxs-lookup"><span data-stu-id="21d64-149">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="21d64-150">Każdego zestawu w katalogu AddInViews, który zawiera typ, który ma <xref:System.AddIn.Pipeline.AddInBaseAttribute> atrybutu jest ładowany do dodatku w domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="21d64-150">Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain.</span></span>|  
|<span data-ttu-id="21d64-151">Dodatek</span><span class="sxs-lookup"><span data-stu-id="21d64-151">Add-in</span></span>|<span data-ttu-id="21d64-152">Skonkretyzowany typ, który wykonuje usług dla hosta.</span><span class="sxs-lookup"><span data-stu-id="21d64-152">An instantiated type that performs a service for the host.</span></span>|  
  
## <a name="pipeline-activation-path"></a><span data-ttu-id="21d64-153">Ścieżka aktywacji potoku</span><span class="sxs-lookup"><span data-stu-id="21d64-153">Pipeline Activation Path</span></span>  
 <span data-ttu-id="21d64-154">Poniższa ilustracja przedstawia aktywacji typów, gdy dodatek jest aktywny.</span><span class="sxs-lookup"><span data-stu-id="21d64-154">The following illustration shows the activation of types when an add-in is activated.</span></span> <span data-ttu-id="21d64-155">Zawiera również przekazywanie obiektów do hosta, takie jak wyniki obliczeń lub kolekcji obiektów.</span><span class="sxs-lookup"><span data-stu-id="21d64-155">It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects.</span></span> <span data-ttu-id="21d64-156">Jest to najbardziej typowym scenariuszem.</span><span class="sxs-lookup"><span data-stu-id="21d64-156">This is the most typical scenario.</span></span>  
  
 <span data-ttu-id="21d64-157">![Dodaj&#45;w modelu przy użyciu ścieżki aktywacji. ](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span><span class="sxs-lookup"><span data-stu-id="21d64-157">![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span></span>  
<span data-ttu-id="21d64-158">Ścieżka aktywacji w dodatku do hosta</span><span class="sxs-lookup"><span data-stu-id="21d64-158">Activation path from the add-in to the host</span></span>  
  
 <span data-ttu-id="21d64-159">Ścieżka aktywacji potoku odbywa się w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="21d64-159">The activation path of the pipeline occurs as follows:</span></span>  
  
1.  <span data-ttu-id="21d64-160">Aplikacja hosta aktywuje dodatek za pomocą <xref:System.AddIn.Hosting.AddInToken.Activate%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="21d64-160">The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method.</span></span>  
  
2.  <span data-ttu-id="21d64-161">Widok dodatku, dodatek, karta add w side i zestawy umowy są ładowane do dodatku w domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="21d64-161">The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.</span></span>  
  
3.  <span data-ttu-id="21d64-162">Przy użyciu widoku dodatku, tworzone jest wystąpienie karty add w side (przy użyciu klasy identyfikowane przez <xref:System.AddIn.Pipeline.AddInBaseAttribute> atrybutu) jako jego konstruktora.</span><span class="sxs-lookup"><span data-stu-id="21d64-162">An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor.</span></span> <span data-ttu-id="21d64-163">Karta Dodaj w side dziedziczy z umowy.</span><span class="sxs-lookup"><span data-stu-id="21d64-163">The add-in-side adapter inherits from the contract.</span></span>  
  
4.  <span data-ttu-id="21d64-164">Karty Dodaj strony, która jest jako wpisana nazwa kontraktu, jest przekazywany przez granicę izolacji (opcjonalnie) do konstruktora adapter po stronie hosta.</span><span class="sxs-lookup"><span data-stu-id="21d64-164">The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.</span></span>  
  
5.  <span data-ttu-id="21d64-165">Widok hosta karty dodatku, po stronie hosta i zestawy umowy są ładowane do domeny aplikacji hosta.</span><span class="sxs-lookup"><span data-stu-id="21d64-165">The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.</span></span>  
  
6.  <span data-ttu-id="21d64-166">Tworzone jest wystąpienie adapter po stronie hosta, za pomocą umowy jako jej konstruktora.</span><span class="sxs-lookup"><span data-stu-id="21d64-166">An instance of the host-side adapter is created using the contract as its constructor.</span></span> <span data-ttu-id="21d64-167">Adaptery po stronie hosta dziedziczy widok hosta dodatków.</span><span class="sxs-lookup"><span data-stu-id="21d64-167">The host-side adapter inherits from the host view of the add-in.</span></span>  
  
7.  <span data-ttu-id="21d64-168">Host ma dodatku, którego typem hosta Widok dodatku i można kontynuować wywoływania jego metody.</span><span class="sxs-lookup"><span data-stu-id="21d64-168">The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.</span></span>  
  
## <a name="walkthroughs"></a><span data-ttu-id="21d64-169">Wskazówki</span><span class="sxs-lookup"><span data-stu-id="21d64-169">Walkthroughs</span></span>  
 <span data-ttu-id="21d64-170">Istnieją trzy instruktaże, które zawierają opis sposobu tworzenia potoków przy użyciu programu Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="21d64-170">There are three walkthrough topics that describe how to create pipelines using Visual Studio:</span></span>  
  
-   [<span data-ttu-id="21d64-171">Wskazówki: Tworzenie aplikacji rozszerzalnej</span><span class="sxs-lookup"><span data-stu-id="21d64-171">Walkthrough: Creating an Extensible Application</span></span>](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     <span data-ttu-id="21d64-172">W tym artykule opisano dodatek Kalkulator, który wykonuje Dodawanie, odejmowanie, mnożenie i dzielenie obliczeń dla hosta.</span><span class="sxs-lookup"><span data-stu-id="21d64-172">Describes a calculator add-in that performs addition, subtraction, multiplication, and division calculations for the host.</span></span>  
  
-   [<span data-ttu-id="21d64-173">Wskazówki: Włączanie zgodności z poprzednimi wersjami w miarę zmieniania hosta</span><span class="sxs-lookup"><span data-stu-id="21d64-173">Walkthrough: Enabling Backward Compatibility as Your Host Changes</span></span>](https://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     <span data-ttu-id="21d64-174">W tym artykule opisano Kalkulator dodatek za pomocą obliczeń rozszerzone możliwości oraz sposobu utrzymania zgodności z pierwszą Kalkulator dodatku programu.</span><span class="sxs-lookup"><span data-stu-id="21d64-174">Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.</span></span>  
  
-   [<span data-ttu-id="21d64-175">Wskazówki: Przekazywanie kolekcji między hostami i dodatkami</span><span class="sxs-lookup"><span data-stu-id="21d64-175">Walkthrough: Passing Collections Between Hosts and Add-Ins</span></span>](https://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     <span data-ttu-id="21d64-176">W tym artykule opisano sposób przekazywania zbierania danych przez potok przy użyciu scenariusza magazynu książki.</span><span class="sxs-lookup"><span data-stu-id="21d64-176">Describes how to pass data collections over the pipeline using a book store scenario.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="21d64-177">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="21d64-177">See Also</span></span>  
- [<span data-ttu-id="21d64-178">Scenariusze potoku dodatku</span><span class="sxs-lookup"><span data-stu-id="21d64-178">Add-in Pipeline Scenarios</span></span>](https://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
- [<span data-ttu-id="21d64-179">Dodatki i rozszerzalność</span><span class="sxs-lookup"><span data-stu-id="21d64-179">Add-ins and Extensibility</span></span>](../../../docs/framework/add-ins/index.md)
