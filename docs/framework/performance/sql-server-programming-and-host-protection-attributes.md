---
title: Atrybuty ochrony hosta i programowanie SQL Server
description: Rozpocznij pracę z SQL Server programowaniem i atrybutami ochrony hosta. Zapoznaj się z tematem SQL Server zestawy uprawnień i ograniczenia modelu programowania.
ms.date: 03/30/2017
helpviewer_keywords:
- SQL Server [.NET Framework]
- permission sets, SQL Server
- SQL Server Programming and Host Protection Attributes
- managed code, SQL Server
- reliability [.NET Framework]
- writing reliable code
- hosts, reliability
- host protection attributes
- HostProtectionAttribute class, reliability
ms.assetid: 7dfa36b4-e773-4c75-a3ff-ff1af3ce4c4f
ms.openlocfilehash: 33db32897d2f49d2c10f94dc73aeae728c17db73
ms.sourcegitcommit: cf5a800a33de64d0aad6d115ffcc935f32375164
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/20/2020
ms.locfileid: "86474205"
---
# <a name="sql-server-programming-and-host-protection-attributes"></a>Atrybuty ochrony hosta i programowanie SQL Server
Możliwość ładowania i wykonywania kodu zarządzanego na hoście SQL Server wymaga spełnienia wymagań hosta zarówno w zakresie zabezpieczeń dostępu kodu, jak i ochrony zasobów hosta.  Wymagania dotyczące zabezpieczeń dostępu kodu są określone przez jeden z trzech SQL Serverch zestawów uprawnień: bezpieczny, zewnętrzny — dostęp lub niebezpieczny. Kod wykonywany w ramach zestawów uprawnień bezpiecznego lub z dostępem do zasobów zewnętrznych musi unikać niektórych typów lub elementów członkowskich, do których <xref:System.Security.Permissions.HostProtectionAttribute> zastosowano ten atrybut. <xref:System.Security.Permissions.HostProtectionAttribute>Nie jest to uprawnienie zabezpieczeń, tak jak w przypadku gwarancji niezawodności w celu zidentyfikowania określonych konstrukcji kodu, typów lub metod, które mogą być niedozwolone dla hosta.  Użycie <xref:System.Security.Permissions.HostProtectionAttribute> wymusza model programowania, który pomaga chronić stabilność hosta.  
  
## <a name="host-protection-attributes"></a>Atrybuty ochrony hosta  
 Atrybuty ochrony hosta identyfikują typy lub elementy członkowskie, które nie pasują do modelu programowania hosta i reprezentują następujące zwiększone poziomy zagrożenia niezawodności:  
  
- Są niegroźne.  
  
- Może prowadzić do destabilizacji kodu użytkownika zarządzanego przez serwer.  
  
- Może prowadzić do destabilizacji samego procesu serwera.  
  
 SQL Server nie zezwala na użycie typu lub elementu członkowskiego, który <xref:System.Security.Permissions.HostProtectionAttribute> określa <xref:System.Security.Permissions.HostProtectionResource> wartość <xref:System.Security.Permissions.HostProtectionResource.SharedState> , <xref:System.Security.Permissions.HostProtectionResource.Synchronization> , <xref:System.Security.Permissions.HostProtectionResource.MayLeakOnAbort> lub <xref:System.Security.Permissions.HostProtectionResource.ExternalProcessMgmt> . Zapobiega to wywoływaniu przez zestawy elementów członkowskich, które włączają stan udostępniania, przeprowadzania synchronizacji, mogą powodować wycieki zasobów na zakończenie lub wpływają na integralność procesu SQL Server.  
  
### <a name="disallowed-types-and-members"></a>Niedozwolone typy i elementy członkowskie  
 W poniższej tabeli przedstawiono typy i elementy członkowskie, których <xref:System.Security.Permissions.HostProtectionResource> wartości są niedozwolone przez SQL Server.  
  
|Przestrzeń nazw|Typ lub element członkowski|  
|---------------|--------------------|  
|`Microsoft.Win32`|Klasa <xref:Microsoft.Win32.PowerModeChangedEventArgs><br /><br /> <xref:Microsoft.Win32.PowerModeChangedEventHandler>Wierz<br /><br /> Klasa <xref:Microsoft.Win32.SessionEndedEventArgs><br /><br /> <xref:Microsoft.Win32.SessionEndedEventHandler>Wierz<br /><br /> Klasa <xref:Microsoft.Win32.SessionEndingEventArgs><br /><br /> <xref:Microsoft.Win32.SessionEndingEventHandler>Wierz<br /><br /> Klasa <xref:Microsoft.Win32.SessionSwitchEventArgs><br /><br /> <xref:Microsoft.Win32.SessionSwitchEventHandler>Wierz<br /><br /> Klasa <xref:Microsoft.Win32.SystemEvents><br /><br /> Klasa <xref:Microsoft.Win32.TimerElapsedEventArgs><br /><br /> <xref:Microsoft.Win32.TimerElapsedEventHandler>Wierz<br /><br /> Klasa <xref:Microsoft.Win32.UserPreferenceChangedEventArgs><br /><br /> Klasa <xref:Microsoft.Win32.UserPreferenceChangingEventArgs>|  
|`System.Collections`|Metoda <xref:System.Collections.ArrayList.Synchronized%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Collections.Hashtable.Synchronized%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Collections.Queue.Synchronized%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Collections.SortedList.Synchronized%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Collections.Stack.Synchronized%2A?displayProperty=nameWithType>|  
|`System.ComponentModel`|Klasa <xref:System.ComponentModel.AddingNewEventArgs><br /><br /> <xref:System.ComponentModel.AddingNewEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.ArrayConverter><br /><br /> Klasa <xref:System.ComponentModel.AsyncCompletedEventArgs><br /><br /> <xref:System.ComponentModel.AsyncCompletedEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.AsyncOperation><br /><br /> Klasa <xref:System.ComponentModel.AsyncOperationManager><br /><br /> Klasa <xref:System.ComponentModel.AttributeCollection><br /><br /> Klasa <xref:System.ComponentModel.BackgroundWorker><br /><br /> Klasa <xref:System.ComponentModel.BaseNumberConverter><br /><br /> Klasa <xref:System.ComponentModel.BindingList%601><br /><br /> Klasa <xref:System.ComponentModel.BooleanConverter><br /><br /> Klasa <xref:System.ComponentModel.ByteConverter><br /><br /> Klasa <xref:System.ComponentModel.CancelEventArgs><br /><br /> <xref:System.ComponentModel.CancelEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.CharConverter><br /><br /> Klasa <xref:System.ComponentModel.CollectionChangeEventArgs><br /><br /> <xref:System.ComponentModel.CollectionChangeEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.CollectionConverter><br /><br /> Klasa <xref:System.ComponentModel.ComponentCollection><br /><br /> Klasa <xref:System.ComponentModel.ComponentConverter><br /><br /> Klasa <xref:System.ComponentModel.ComponentEditor><br /><br /> Klasa <xref:System.ComponentModel.ComponentResourceManager><br /><br /> Klasa <xref:System.ComponentModel.Container><br /><br /> Klasa <xref:System.ComponentModel.ContainerFilterService><br /><br /> Klasa <xref:System.ComponentModel.CultureInfoConverter><br /><br /> Klasa <xref:System.ComponentModel.CustomTypeDescriptor><br /><br /> Klasa <xref:System.ComponentModel.DateTimeConverter><br /><br /> Klasa <xref:System.ComponentModel.DecimalConverter><br /><br /> Klasa <xref:System.ComponentModel.Design.ActiveDesignerEventArgs><br /><br /> <xref:System.ComponentModel.Design.ActiveDesignerEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.CheckoutException><br /><br /> Klasa <xref:System.ComponentModel.Design.CommandID><br /><br /> Klasa <xref:System.ComponentModel.Design.ComponentChangedEventArgs><br /><br /> <xref:System.ComponentModel.Design.ComponentChangedEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.ComponentChangingEventArgs><br /><br /> <xref:System.ComponentModel.Design.ComponentChangingEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.ComponentEventArgs><br /><br /> <xref:System.ComponentModel.Design.ComponentEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.ComponentRenameEventArgs><br /><br /> <xref:System.ComponentModel.Design.ComponentRenameEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.DesignerCollection><br /><br /> Klasa <xref:System.ComponentModel.Design.DesignerEventArgs><br /><br /> <xref:System.ComponentModel.Design.DesignerEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.DesignerOptionService><br /><br /> Klasa <xref:System.ComponentModel.Design.DesignerTransaction><br /><br /> Klasa <xref:System.ComponentModel.Design.DesignerTransactionCloseEventArgs><br /><br /> <xref:System.ComponentModel.Design.DesignerTransactionCloseEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.DesignerVerb><br /><br /> Klasa <xref:System.ComponentModel.Design.DesignerVerbCollection><br /><br /> Klasa <xref:System.ComponentModel.Design.DesigntimeLicenseContext><br /><br /> Klasa <xref:System.ComponentModel.Design.DesigntimeLicenseContextSerializer><br /><br /> Klasa <xref:System.ComponentModel.Design.MenuCommand><br /><br /> Klasa <xref:System.ComponentModel.Design.Serialization.ComponentSerializationService><br /><br /> Klasa <xref:System.ComponentModel.Design.Serialization.ContextStack><br /><br /> Klasa <xref:System.ComponentModel.Design.Serialization.DesignerLoader><br /><br /> Klasa <xref:System.ComponentModel.Design.Serialization.InstanceDescriptor><br /><br /> Klasa <xref:System.ComponentModel.Design.Serialization.MemberRelationshipService><br /><br /> Klasa <xref:System.ComponentModel.Design.Serialization.ResolveNameEventArgs><br /><br /> <xref:System.ComponentModel.Design.Serialization.ResolveNameEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.Serialization.SerializationStore><br /><br /> Klasa <xref:System.ComponentModel.Design.ServiceContainer><br /><br /> <xref:System.ComponentModel.Design.ServiceCreatorCallback>Wierz<br /><br /> Klasa <xref:System.ComponentModel.Design.StandardCommands><br /><br /> Klasa <xref:System.ComponentModel.Design.StandardToolWindows><br /><br /> Klasa <xref:System.ComponentModel.DoubleConverter><br /><br /> Klasa <xref:System.ComponentModel.DoWorkEventArgs><br /><br /> <xref:System.ComponentModel.DoWorkEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.EnumConverter><br /><br /> Klasa <xref:System.ComponentModel.EventDescriptor><br /><br /> Klasa <xref:System.ComponentModel.EventDescriptorCollection><br /><br /> Klasa <xref:System.ComponentModel.EventHandlerList><br /><br /> Klasa <xref:System.ComponentModel.ExpandableObjectConverter><br /><br /> Klasa <xref:System.ComponentModel.HandledEventArgs><br /><br /> <xref:System.ComponentModel.HandledEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.InstanceCreationEditor><br /><br /> Klasa <xref:System.ComponentModel.Int16Converter><br /><br /> Klasa <xref:System.ComponentModel.Int32Converter><br /><br /> Klasa <xref:System.ComponentModel.Int64Converter><br /><br /> Klasa <xref:System.ComponentModel.InvalidAsynchronousStateException><br /><br /> Klasa <xref:System.ComponentModel.InvalidEnumArgumentException><br /><br /> Metoda <xref:System.ComponentModel.ISynchronizeInvoke.BeginInvoke%2A><br /><br /> Klasa <xref:System.ComponentModel.License><br /><br /> Klasa <xref:System.ComponentModel.LicenseContext><br /><br /> Klasa <xref:System.ComponentModel.LicenseException><br /><br /> Klasa <xref:System.ComponentModel.LicenseManager><br /><br /> Klasa <xref:System.ComponentModel.LicenseProvider><br /><br /> Klasa <xref:System.ComponentModel.LicFileLicenseProvider><br /><br /> Klasa <xref:System.ComponentModel.ListChangedEventArgs><br /><br /> <xref:System.ComponentModel.ListChangedEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.ListSortDescription><br /><br /> Klasa <xref:System.ComponentModel.ListSortDescriptionCollection><br /><br /> Klasa <xref:System.ComponentModel.MaskedTextProvider><br /><br /> Klasa <xref:System.ComponentModel.MemberDescriptor><br /><br /> Klasa <xref:System.ComponentModel.MultilineStringConverter><br /><br /> Klasa <xref:System.ComponentModel.NestedContainer><br /><br /> Klasa <xref:System.ComponentModel.NullableConverter><br /><br /> Klasa <xref:System.ComponentModel.ProgressChangedEventArgs><br /><br /> <xref:System.ComponentModel.ProgressChangedEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.PropertyChangedEventArgs><br /><br /> <xref:System.ComponentModel.PropertyChangedEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.PropertyDescriptor><br /><br /> Klasa <xref:System.ComponentModel.PropertyDescriptorCollection><br /><br /> Klasa <xref:System.ComponentModel.ReferenceConverter><br /><br /> Klasa <xref:System.ComponentModel.RefreshEventArgs><br /><br /> <xref:System.ComponentModel.RefreshEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.RunWorkerCompletedEventArgs><br /><br /> <xref:System.ComponentModel.RunWorkerCompletedEventHandler>Wierz<br /><br /> Klasa <xref:System.ComponentModel.SByteConverter><br /><br /> Klasa <xref:System.ComponentModel.SingleConverter><br /><br /> Klasa <xref:System.ComponentModel.StringConverter><br /><br /> Klasa <xref:System.ComponentModel.SyntaxCheck><br /><br /> Klasa <xref:System.ComponentModel.TimeSpanConverter><br /><br /> Klasa <xref:System.ComponentModel.TypeConverter><br /><br /> Klasa <xref:System.ComponentModel.TypeDescriptionProvider><br /><br /> Klasa <xref:System.ComponentModel.TypeDescriptor><br /><br /> Klasa <xref:System.ComponentModel.TypeListConverter><br /><br /> Klasa <xref:System.ComponentModel.UInt16Converter><br /><br /> Klasa <xref:System.ComponentModel.UInt32Converter><br /><br /> Klasa <xref:System.ComponentModel.UInt64Converter><br /><br /> Klasa <xref:System.ComponentModel.WarningException><br /><br /> Klasa <xref:System.ComponentModel.Win32Exception>|  
|`System.Diagnostics`|<xref:System.Diagnostics.Debug.Listeners%2A?displayProperty=nameWithType>wartość<br /><br /> <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType>wartość<br /><br /> <xref:System.Diagnostics.EventLog.SynchronizingObject%2A?displayProperty=nameWithType>wartość<br /><br /> Klasa <xref:System.Diagnostics.ConsoleTraceListener><br /><br /> Klasa <xref:System.Diagnostics.DefaultTraceListener><br /><br /> Klasa <xref:System.Diagnostics.DelimitedListTraceListener><br /><br /> Klasa <xref:System.Diagnostics.EventLogTraceListener><br /><br /> Klasa <xref:System.Diagnostics.PerformanceCounter><br /><br /> Klasa <xref:System.Diagnostics.PerformanceCounterCategory><br /><br /> Klasa <xref:System.Diagnostics.Process><br /><br /> Klasa <xref:System.Diagnostics.ProcessStartInfo><br /><br /> Klasa <xref:System.Diagnostics.TextWriterTraceListener><br /><br /> Klasa <xref:System.Diagnostics.TraceListener><br /><br /> Klasa <xref:System.Diagnostics.XmlWriterTraceListener><br /><br /> <xref:System.Diagnostics.TraceSource.Listeners%2A?displayProperty=nameWithType>wartość|  
|`System.IO`|Metoda <xref:System.IO.Stream.Synchronized%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.IO.TextReader.Synchronized%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.IO.TextWriter.Synchronized%2A?displayProperty=nameWithType>|  
|`System.Reflection.Emit`|Klasa <xref:System.Reflection.Emit.ConstructorBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.EventBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.FieldBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.MethodBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.CustomAttributeBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.MethodRental><br /><br /> Klasa <xref:System.Reflection.Emit.ModuleBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.PropertyBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.TypeBuilder><br /><br /> Klasa <xref:System.Reflection.Emit.UnmanagedMarshal>|  
|`System.Text`|Metoda <xref:System.Text.RegularExpressions.Group.Synchronized%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Text.RegularExpressions.Match.Synchronized%2A?displayProperty=nameWithType>|  
|`System.Threading`|Klasa <xref:System.Threading.AutoResetEvent><br /><br /> Klasa <xref:System.Threading.EventWaitHandle><br /><br /> Klasa <xref:System.Threading.ManualResetEvent><br /><br /> Klasa <xref:System.Threading.Monitor><br /><br /> Klasa <xref:System.Threading.Mutex><br /><br /> Klasa <xref:System.Threading.ReaderWriterLock><br /><br /> Klasa <xref:System.Threading.Semaphore><br /><br /> Metoda <xref:System.Threading.Thread.AllocateNamedDataSlot%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.BeginCriticalRegion%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.EndCriticalRegion%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.FreeNamedDataSlot%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.GetData%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.Join%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.SetData%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.SpinWait%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType><br /><br /> Metoda <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType><br /><br /> Klasa <xref:System.Threading.ThreadPool><br /><br /> Klasa <xref:System.Threading.Timer>|  
|`System.Timers`|Klasa <xref:System.Timers.Timer>|  
|`System.Web.Configuration`|Klasa <xref:System.Web.Configuration.MachineKeyValidationConverter>|  
|`System.Windows.Forms`|<xref:System.Windows.Forms.AutoCompleteStringCollection.SyncRoot%2A?displayProperty=nameWithType>wartość|  
  
## <a name="sql-server-permission-sets"></a>SQL Server zestawy uprawnień  
 SQL Server umożliwia użytkownikom Określanie wymagań dotyczących niezawodności dla kodu wdrożonego w bazie danych. Po przekazaniu zestawów do bazy danych autor zestawu może określić jeden z trzech zestawów uprawnień dla tego zestawu: bezpieczny, zewnętrzny — dostęp lub niebezpieczny.  
  
|Zestaw uprawnień|SEJF|DOSTĘP ZEWNĘTRZNY|NIEBEZPIECZNE|  
|--------------------|----------|----------------------|------------|  
|Zabezpieczenia dostępu kodu|Tylko wykonaj|Wykonywanie i dostęp do zasobów zewnętrznych|Bez ograniczeń|  
|Ograniczenia modelu programowania|Tak|Tak|Brak ograniczeń|  
|Wymagania dotyczące weryfikacji|Tak|Tak|Nie|  
|Możliwość wywoływania kodu natywnego|Nie|Nie|Yes|  
  
 Bezpieczeństwo jest najbardziej niezawodnym i bezpiecznym trybem ze skojarzonymi ograniczeniami zgodnie z dozwolonym modelem programowania. BEZPIECZNY kod ma duże funkcje zapewniające niezawodność i zabezpieczenia. BEZPIECZNE zestawy mają wystarczające uprawnienia do uruchamiania, wykonywania obliczeń i uzyskiwania dostępu do lokalnej bazy danych. BEZPIECZNE zestawy muszą być sprawdzane jako bezpieczne i nie mogą wywoływać kodu niezarządzanego.  
  
 DOSTĘP zewnętrzny zapewnia pośrednią opcję zabezpieczeń, umożliwiając kodowi dostęp do zasobów zewnętrznych z bazy danych, ale nadal zapewnia niezawodność i bezpieczeństwo.  
  
 NIEBEZPIECZNE dotyczy wysoce zaufanego kodu, który może być tworzony tylko przez administratorów bazy danych. Ten zaufany kod nie ma ograniczeń dostępu kodu i może wywołać niezarządzany (natywny) kod.  
  
 SQL Server używa warstwy zasad zabezpieczeń dostępu kodu na poziomie hosta w celu skonfigurowania zasad hosta, które przydzielą jeden z trzech zestawów uprawnień na podstawie zestawu uprawnień przechowywanych w katalogach SQL Server. Kod zarządzany uruchomiony wewnątrz bazy danych zawsze otrzymuje jeden z tych zestawów uprawnień dostępu do kodu.  
  
## <a name="programming-model-restrictions"></a>Ograniczenia modelu programowania  
 Model programowania dla kodu zarządzanego w SQL Server wymaga funkcji, procedur i typów, które nie wymagają użycia stanu przechowywanego w wielu wywołaniach lub udostępniania stanu w wielu sesjach użytkowników. Ponadto, zgodnie z wcześniejszym opisem, obecność udostępnionego stanu może spowodować krytyczne wyjątki, które mają wpływ na skalowalność i niezawodność aplikacji.  
  
 Biorąc pod uwagę te zagadnienia, SQL Server nie zezwala na używanie zmiennych statycznych i statycznych elementów członkowskich danych. W przypadku zestawów bezpiecznego i zewnętrznego dostępu SQL Server sprawdza metadane zestawu przy tworzeniu czasu montażu i nie może utworzyć takich zestawów, jeśli znajdzie użycie statycznych elementów członkowskich danych i zmiennych.  
  
## <a name="see-also"></a>Zobacz także

- <xref:System.Security.Permissions.HostProtectionAttribute>
- <xref:System.Security.Permissions.HostProtectionResource>
