---
title: Problemy związane z zabezpieczeniami w emisji odbicia
ms.date: 03/30/2017
helpviewer_keywords:
- partially trusted code
- emitting dynamic assemblies, security
- reflection emit, security
- reflection emit, partial trust scenarios
- partial trust,emitting dynamic methods
- anonymously hosted dynamic methods [.NET Framework]
- emitting dynamic assemblies,partial trust scenarios
- dynamic assemblies, security
ms.assetid: 0f8bf8fa-b993-478f-87ab-1a1a7976d298
ms.openlocfilehash: d1b6994f7ee9efa9f6472deffb2f3d869606e182
ms.sourcegitcommit: 62285ec11fa8e8424bab00511a90760c60e63c95
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/20/2020
ms.locfileid: "81644204"
---
# <a name="security-issues-in-reflection-emit"></a><span data-ttu-id="7f7be-102">Problemy związane z zabezpieczeniami w emisji odbicia</span><span class="sxs-lookup"><span data-stu-id="7f7be-102">Security Issues in Reflection Emit</span></span>
<span data-ttu-id="7f7be-103">.NET Framework udostępnia trzy sposoby emisji języka pośredniego firmy Microsoft (MSIL), z których każdy ma własne problemy z zabezpieczeniami:</span><span class="sxs-lookup"><span data-stu-id="7f7be-103">The .NET Framework provides three ways to emit Microsoft intermediate language (MSIL), each with its own security issues:</span></span>  
  
- [<span data-ttu-id="7f7be-104">Zestawy dynamiczne</span><span class="sxs-lookup"><span data-stu-id="7f7be-104">Dynamic assemblies</span></span>](#Dynamic_Assemblies)  
  
- [<span data-ttu-id="7f7be-105">Anonimowo hostowane metody dynamiczne</span><span class="sxs-lookup"><span data-stu-id="7f7be-105">Anonymously hosted dynamic methods</span></span>](#Anonymously_Hosted_Dynamic_Methods)  
  
- [<span data-ttu-id="7f7be-106">Metody dynamiczne skojarzone z istniejącymi zestawami</span><span class="sxs-lookup"><span data-stu-id="7f7be-106">Dynamic methods associated with existing assemblies</span></span>](#Dynamic_Methods_Associated_with_Existing_Assemblies)  
  
 <span data-ttu-id="7f7be-107">Niezależnie od sposobu generowania kodu dynamicznego wykonywanie wygenerowanego kodu wymaga wszystkich uprawnień, które są wymagane przez typy i metody używane przez wygenerowany kod.</span><span class="sxs-lookup"><span data-stu-id="7f7be-107">Regardless of the way you generate dynamic code, executing the generated code requires all the permissions that are required by the types and methods the generated code uses.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-108">Uprawnienia, które są wymagane do odzwierciedlenia kodu i emitowania kodu, zostały zmienione wraz z pomyślnymi wersjami .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7f7be-108">The permissions that are required for reflecting on code and emitting code have changed with succeeding releases of the .NET Framework.</span></span> <span data-ttu-id="7f7be-109">[Informacje o wersji](#Version_Information)znajdują się w dalszej części tego tematu.</span><span class="sxs-lookup"><span data-stu-id="7f7be-109">See [Version Information](#Version_Information), later in this topic.</span></span>  
  
<a name="Dynamic_Assemblies"></a>
## <a name="dynamic-assemblies"></a><span data-ttu-id="7f7be-110">Zestawy dynamiczne</span><span class="sxs-lookup"><span data-stu-id="7f7be-110">Dynamic Assemblies</span></span>  
 <span data-ttu-id="7f7be-111">Zestawy dynamiczne są tworzone przy użyciu przeciążenia <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="7f7be-111">Dynamic assemblies are created by using overloads of the <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="7f7be-112">Większość przeciążeń tej metody jest przestarzałych w .NET Framework 4 z powodu usunięcia zasad zabezpieczeń dla całego komputera.</span><span class="sxs-lookup"><span data-stu-id="7f7be-112">Most overloads of this method are deprecated in the .NET Framework 4, because of the elimination of machine-wide security policy.</span></span> <span data-ttu-id="7f7be-113">(Zobacz [zmiany zabezpieczeń](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes)). Pozostałe przeciążenia mogą być wykonywane przez dowolny kod niezależnie od poziomu zaufania.</span><span class="sxs-lookup"><span data-stu-id="7f7be-113">(See [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).) The remaining overloads can be executed by any code, regardless of trust level.</span></span> <span data-ttu-id="7f7be-114">Te przeciążenia dzielą się na dwie grupy: te, które określają listę atrybutów, które mają być stosowane do zestawu dynamicznego podczas jego tworzenia, a te, które nie.</span><span class="sxs-lookup"><span data-stu-id="7f7be-114">These overloads fall into two groups: those that specify a list of attributes to apply to the dynamic assembly when it is created, and those that do not.</span></span> <span data-ttu-id="7f7be-115">Jeśli nie określisz modelu przezroczystości dla zestawu, stosując <xref:System.Security.SecurityRulesAttribute> atrybut podczas tworzenia, model przezroczystości jest Dziedziczony z zestawu emitującego.</span><span class="sxs-lookup"><span data-stu-id="7f7be-115">If you do not specify the transparency model for the assembly, by applying the <xref:System.Security.SecurityRulesAttribute> attribute when you create it, the transparency model is inherited from the emitting assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-116">Atrybuty, które są stosowane do zestawu dynamicznego po jego utworzeniu przy użyciu <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> metody, nie są uwzględniane do momentu zapisania zestawu na dysku i ponownego załadowania do pamięci.</span><span class="sxs-lookup"><span data-stu-id="7f7be-116">Attributes that you apply to the dynamic assembly after it is created, by using the <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> method, do not take effect until the assembly has been saved to disk and loaded into memory again.</span></span>  
  
 <span data-ttu-id="7f7be-117">Kod w zestawie dynamicznym ma dostęp do widocznych typów i elementów członkowskich w innych zestawach.</span><span class="sxs-lookup"><span data-stu-id="7f7be-117">Code in a dynamic assembly can access visible types and members in other assemblies.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-118">Zestawy dynamiczne nie używają flag <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> i <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> , które umożliwiają metodom dynamicznym dostęp do niepublicznych typów i elementów członkowskich.</span><span class="sxs-lookup"><span data-stu-id="7f7be-118">Dynamic assemblies do not use the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> and <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flags that allow dynamic methods to access nonpublic types and members.</span></span>  
  
 <span data-ttu-id="7f7be-119">Przejściowe zestawy dynamiczne są tworzone w pamięci i nigdy nie są zapisywane na dysku, więc nie wymagają uprawnień dostępu do plików.</span><span class="sxs-lookup"><span data-stu-id="7f7be-119">Transient dynamic assemblies are created in memory and never saved to disk, so they require no file access permissions.</span></span> <span data-ttu-id="7f7be-120">Zapisywanie dynamicznego zestawu na dysku wymaga <xref:System.Security.Permissions.FileIOPermission> odpowiedniej flagi.</span><span class="sxs-lookup"><span data-stu-id="7f7be-120">Saving a dynamic assembly to disk requires <xref:System.Security.Permissions.FileIOPermission> with the appropriate flags.</span></span>  
  
### <a name="generating-dynamic-assemblies-from-partially-trusted-code"></a><span data-ttu-id="7f7be-121">Generowanie zestawów dynamicznych przy użyciu częściowo zaufanego kodu</span><span class="sxs-lookup"><span data-stu-id="7f7be-121">Generating Dynamic Assemblies from Partially Trusted Code</span></span>  
 <span data-ttu-id="7f7be-122">Rozważ warunki, w których zestaw z uprawnieniami internetowymi może generować tymczasowy dynamiczny zestaw i wykonać swój kod:</span><span class="sxs-lookup"><span data-stu-id="7f7be-122">Consider the conditions in which an assembly with Internet permissions can generate a transient dynamic assembly and execute its code:</span></span>  
  
- <span data-ttu-id="7f7be-123">W zestawie dynamicznym są stosowane tylko typy publiczne i elementy członkowskie innych zestawów.</span><span class="sxs-lookup"><span data-stu-id="7f7be-123">The dynamic assembly uses only public types and members of other assemblies.</span></span>  
  
- <span data-ttu-id="7f7be-124">Uprawnienia wymagane przez te typy i członków są zawarte w zestawie uprawnień częściowo zaufanego zestawu.</span><span class="sxs-lookup"><span data-stu-id="7f7be-124">The permissions demanded by those types and members are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="7f7be-125">Zestaw nie został zapisany na dysku.</span><span class="sxs-lookup"><span data-stu-id="7f7be-125">The assembly is not saved to disk.</span></span>  
  
- <span data-ttu-id="7f7be-126">Symbole debugowania nie są generowane.</span><span class="sxs-lookup"><span data-stu-id="7f7be-126">Debug symbols are not generated.</span></span> <span data-ttu-id="7f7be-127">(`Internet` i `LocalIntranet` zestawy uprawnień nie obejmują wymaganych uprawnień).</span><span class="sxs-lookup"><span data-stu-id="7f7be-127">(`Internet` and `LocalIntranet` permission sets do not include the necessary permissions.)</span></span>  
  
<a name="Anonymously_Hosted_Dynamic_Methods"></a>
## <a name="anonymously-hosted-dynamic-methods"></a><span data-ttu-id="7f7be-128">Anonimowo hostowane metody dynamiczne</span><span class="sxs-lookup"><span data-stu-id="7f7be-128">Anonymously Hosted Dynamic Methods</span></span>  
 <span data-ttu-id="7f7be-129">Anonimowo hostowane metody dynamiczne są tworzone przy użyciu dwóch <xref:System.Reflection.Emit.DynamicMethod> konstruktorów, które nie określają skojarzonego typu lub modułu, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> i <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="7f7be-129">Anonymously hosted dynamic methods are created by using the two <xref:System.Reflection.Emit.DynamicMethod> constructors that do not specify an associated type or module, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> and <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span></span> <span data-ttu-id="7f7be-130">Te konstruktory umieszczają metody dynamiczne w wbudowanym, w pełni zaufanym, nieprzezroczystym zestawie zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="7f7be-130">These constructors place the dynamic methods in a system-provided, fully trusted, security-transparent assembly.</span></span> <span data-ttu-id="7f7be-131">Do korzystania z tych konstruktorów lub do emitowania kodu dla metod dynamicznych nie są wymagane żadne uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="7f7be-131">No permissions are required to use these constructors or to emit code for the dynamic methods.</span></span>  
  
 <span data-ttu-id="7f7be-132">Zamiast tego, gdy tworzona jest anonimowo obsługiwana metoda dynamiczna, stos wywołań jest przechwytywany.</span><span class="sxs-lookup"><span data-stu-id="7f7be-132">Instead, when an anonymously hosted dynamic method is created, the call stack is captured.</span></span> <span data-ttu-id="7f7be-133">Gdy metoda jest zbudowana, wymagania dotyczące zabezpieczeń są wykonywane względem przechwyconego stosu wywołań.</span><span class="sxs-lookup"><span data-stu-id="7f7be-133">When the method is constructed, security demands are made against the captured call stack.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-134">Koncepcje są wykonywane w czasie konstruowania metody.</span><span class="sxs-lookup"><span data-stu-id="7f7be-134">Conceptually, demands are made during the construction of the method.</span></span> <span data-ttu-id="7f7be-135">Oznacza to, że żądania mogą zostać wykonane, ponieważ każda instrukcja MSIL jest emitowana.</span><span class="sxs-lookup"><span data-stu-id="7f7be-135">That is, demands could be made as each MSIL instruction is emitted.</span></span> <span data-ttu-id="7f7be-136">W bieżącej implementacji wszystkie wymagania są wykonywane, gdy wywoływana jest <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> Metoda lub gdy wywoływany jest kompilator just-in-Time (JIT), jeśli metoda jest wywoływana bez wywoływania <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span><span class="sxs-lookup"><span data-stu-id="7f7be-136">In the current implementation, all demands are made when the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> method is called or when the just-in-time (JIT) compiler is invoked, if the method is invoked without calling <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span></span>  
  
 <span data-ttu-id="7f7be-137">Jeśli domena aplikacji zezwoli na to, anonimowo hostowane metody dynamiczne mogą pominąć sprawdzanie widoczności JIT, z zastrzeżeniem następującego ograniczenia: typy niepubliczne i elementy członkowskie, do których uzyskuje się anonimowo hostowana metoda dynamiczna, muszą znajdować się w zestawach, których zbiory przydziału są równe lub podzbiory, przydzielny stos wywołań.</span><span class="sxs-lookup"><span data-stu-id="7f7be-137">If the application domain permits it, anonymously hosted dynamic methods can skip JIT visibility checks, subject to the following restriction: The nonpublic types and members accessed by an anonymously hosted dynamic method must be in assemblies whose grant sets are equal to, or subsets of, the grant set of the emitting call stack.</span></span> <span data-ttu-id="7f7be-138">Ta ograniczona możliwość pomijania sprawdzania widoczności JIT jest włączona, jeśli domena aplikacji przyznaje <xref:System.Security.Permissions.ReflectionPermission> z <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flagą.</span><span class="sxs-lookup"><span data-stu-id="7f7be-138">This restricted ability to skip JIT visibility checks is enabled if the application domain grants <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="7f7be-139">Jeśli metoda używa tylko typów publicznych i członków, podczas konstruowania nie są wymagane żadne uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="7f7be-139">If your method uses only public types and members, no permissions are required during construction.</span></span>  
  
- <span data-ttu-id="7f7be-140">Jeśli określisz, że testy widoczności JIT powinny być pomijane, żądanie, które jest wykonywane, gdy metoda jest zbudowana <xref:System.Security.Permissions.ReflectionPermission> , obejmuje <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flagę i zestaw dotacji zestawu, który zawiera niepubliczny element członkowski, do którego jest uzyskiwany dostęp.</span><span class="sxs-lookup"><span data-stu-id="7f7be-140">If you specify that JIT visibility checks should be skipped, the demand that is made when the method is constructed includes <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag and the grant set of the assembly that contains the nonpublic member that is being accessed.</span></span>  
  
 <span data-ttu-id="7f7be-141">Ze względu na to, że dla niepublicznego elementu członkowskiego jest brany pod uwagę, częściowo zaufany kod <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> , który został udzielony, nie może podwyższyć poziomu uprawnień, wykonując niepubliczne elementy członkowskie zaufanych zestawów.</span><span class="sxs-lookup"><span data-stu-id="7f7be-141">Because the grant set of the nonpublic member is taken into consideration, partially trusted code that has been granted <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> cannot elevate its privileges by executing nonpublic members of trusted assemblies.</span></span>  
  
 <span data-ttu-id="7f7be-142">Podobnie jak w przypadku każdego innego emitowanego kodu, wykonanie metody dynamicznej wymaga dowolnych uprawnień wymaganych przez metodę dynamiczną.</span><span class="sxs-lookup"><span data-stu-id="7f7be-142">As with any other emitted code, executing the dynamic method requires whatever permissions are demanded by the methods the dynamic method uses.</span></span>  
  
 <span data-ttu-id="7f7be-143">Zestaw systemowy, który hostuje anonimowo obsługiwane metody dynamiczne, <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> korzysta z modelu przezroczystości, który jest modelem przezroczystości, który został użyty w .NET Framework przed .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="7f7be-143">The system assembly that hosts anonymously-hosted dynamic methods uses the <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> transparency model, which is the transparency model that was used in the .NET Framework before the .NET Framework 4.</span></span>  
  
 <span data-ttu-id="7f7be-144">Aby uzyskać więcej informacji, zobacz <xref:System.Reflection.Emit.DynamicMethod> Klasa.</span><span class="sxs-lookup"><span data-stu-id="7f7be-144">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-anonymously-hosted-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="7f7be-145">Generowanie anonimowo obsługiwanych metod dynamicznych z poziomu częściowo zaufanego kodu</span><span class="sxs-lookup"><span data-stu-id="7f7be-145">Generating Anonymously Hosted Dynamic Methods from Partially Trusted Code</span></span>  
 <span data-ttu-id="7f7be-146">Rozważ warunki, w których zestaw z uprawnieniami internetowymi może generować anonimowo hostowaną metodę dynamiczną i wykonać ją:</span><span class="sxs-lookup"><span data-stu-id="7f7be-146">Consider the conditions in which an assembly with Internet permissions can generate an anonymously hosted dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="7f7be-147">Metoda dynamiczna używa tylko typów publicznych i elementów członkowskich.</span><span class="sxs-lookup"><span data-stu-id="7f7be-147">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="7f7be-148">Jeśli jego zestaw uprawnień zawiera <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, może używać typów niepublicznych i elementów członkowskich dowolnego zestawu, którego przydzielenie jest równe lub podzestawu zestawu, który emitujący zestaw.</span><span class="sxs-lookup"><span data-stu-id="7f7be-148">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, it can use nonpublic types and members of any assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="7f7be-149">Uprawnienia, które są wymagane przez wszystkie typy i elementy członkowskie używane przez metodę dynamiczną, są uwzględniane w zestawie uprawnień częściowo zaufanego zestawu.</span><span class="sxs-lookup"><span data-stu-id="7f7be-149">The permissions that are required by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-150">Metody dynamiczne nie obsługują symboli debugowania.</span><span class="sxs-lookup"><span data-stu-id="7f7be-150">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Dynamic_Methods_Associated_with_Existing_Assemblies"></a>
## <a name="dynamic-methods-associated-with-existing-assemblies"></a><span data-ttu-id="7f7be-151">Metody dynamiczne skojarzone z istniejącymi zestawami</span><span class="sxs-lookup"><span data-stu-id="7f7be-151">Dynamic Methods Associated with Existing Assemblies</span></span>  
 <span data-ttu-id="7f7be-152">Aby skojarzyć metodę dynamiczną z typem lub modułem w istniejącym zestawie, użyj dowolnego <xref:System.Reflection.Emit.DynamicMethod> konstruktora, który określa skojarzony typ lub moduł.</span><span class="sxs-lookup"><span data-stu-id="7f7be-152">To associate a dynamic method with a type or module in an existing assembly, use any of the <xref:System.Reflection.Emit.DynamicMethod> constructors that specify the associated type or module.</span></span> <span data-ttu-id="7f7be-153">Uprawnienia, które są wymagane do wywołania tych konstruktorów, różnią się, ponieważ kojarzenie metody dynamicznej z istniejącym typem lub modułem zapewnia metodę dynamiczną dostęp do typów niepublicznych i członków:</span><span class="sxs-lookup"><span data-stu-id="7f7be-153">The permissions that are required to call these constructors vary, because associating a dynamic method with an existing type or module gives the dynamic method access to nonpublic types and members:</span></span>  
  
- <span data-ttu-id="7f7be-154">Metoda dynamiczna, która jest skojarzona z typem, ma dostęp do wszystkich elementów członkowskich tego typu, nawet prywatnych składowych i wszystkich typów wewnętrznych i członków zestawu, który zawiera skojarzony typ.</span><span class="sxs-lookup"><span data-stu-id="7f7be-154">A dynamic method that is associated with a type has access to all members of that type, even private members, and to all internal types and members in the assembly that contains the associated type.</span></span>  
  
- <span data-ttu-id="7f7be-155">Metoda dynamiczna skojarzona z modułem ma dostęp do wszystkich `internal` typów i elementów członkowskich (`Friend` w Visual Basic `assembly` w metadanych środowiska uruchomieniowego języka wspólnego) w module.</span><span class="sxs-lookup"><span data-stu-id="7f7be-155">A dynamic method that is associated with a module has access to all the `internal` types and members (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the module.</span></span>  
  
 <span data-ttu-id="7f7be-156">Ponadto można użyć konstruktora, który określa możliwość pomijania kontroli widoczności kompilatora JIT.</span><span class="sxs-lookup"><span data-stu-id="7f7be-156">In addition, you can use a constructor that specifies the ability to skip the visibility checks of the JIT compiler.</span></span> <span data-ttu-id="7f7be-157">Dzięki temu metoda dynamiczna zapewnia dostęp do wszystkich typów i elementów członkowskich we wszystkich zestawach, niezależnie od poziomu dostępu.</span><span class="sxs-lookup"><span data-stu-id="7f7be-157">Doing so gives your dynamic method access to all types and members in all assemblies, regardless of access level.</span></span>  
  
 <span data-ttu-id="7f7be-158">Uprawnienia wymagane przez konstruktora zależą od tego, jak dużo dostępu decyduje o przydzieleniu metody dynamicznej:</span><span class="sxs-lookup"><span data-stu-id="7f7be-158">The permissions demanded by the constructor depend on how much access you decide to give your dynamic method:</span></span>  
  
- <span data-ttu-id="7f7be-159">Jeśli metoda używa tylko typów publicznych i elementów członkowskich i kojarzy ją z własnym typem lub własnym modułem, nie są wymagane żadne uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="7f7be-159">If your method uses only public types and members, and you associate it with your own type or your own module, no permissions are required.</span></span>  
  
- <span data-ttu-id="7f7be-160">Jeśli określisz, że testy widoczności JIT powinny być pomijane, Konstruktor wymaga <xref:System.Security.Permissions.ReflectionPermission> <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flagi z flagą.</span><span class="sxs-lookup"><span data-stu-id="7f7be-160">If you specify that JIT visibility checks should be skipped, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="7f7be-161">Jeśli metoda dynamiczna zostanie skojarzona z innym typem, nawet innym typem we własnym zestawie <xref:System.Security.Permissions.ReflectionPermission> , Konstruktor wymaga <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flagi i <xref:System.Security.Permissions.SecurityPermission> z <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flagą.</span><span class="sxs-lookup"><span data-stu-id="7f7be-161">If you associate the dynamic method with another type, even another type in your own assembly, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag and <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="7f7be-162">Jeśli metoda dynamiczna zostanie skojarzona z typem lub modułem w innym zestawie, Konstruktor wymaga dwóch rzeczy: <xref:System.Security.Permissions.ReflectionPermission> ze <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flagą i zestawem przydzielenia zestawu zawierającego inny moduł.</span><span class="sxs-lookup"><span data-stu-id="7f7be-162">If you associate the dynamic method with a type or module in another assembly, the constructor demands two things: <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and the grant set of the assembly that contains the other module.</span></span> <span data-ttu-id="7f7be-163">Oznacza to, że stos wywołań musi zawierać wszystkie uprawnienia w zestawie przyznawania modułu docelowego, a także <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="7f7be-163">That is, your call stack must include all the permissions in the grant set of the target module, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="7f7be-164">W celu zapewnienia zgodności z poprzednimi wersjami, jeśli żądanie dotyczące <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> zestawu dotacji docelowej Plus nie <xref:System.Security.Permissions.SecurityPermission> powiedzie <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> się, Konstruktor wymaga flagi z flagą.</span><span class="sxs-lookup"><span data-stu-id="7f7be-164">For backward compatibility, if the demand for the target grant set plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fails, the constructor demands <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
 <span data-ttu-id="7f7be-165">Chociaż elementy znajdujące się na tej liście są opisane w artykule dotyczącym zestawu emisji, należy pamiętać, że żądania są wykonywane względem pełnego stosu wywołań, w tym granicy domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7f7be-165">Although the items in this list are described in terms of the grant set of the emitting assembly, remember that the demands are made against the full call stack, including the application domain boundary.</span></span>  
  
 <span data-ttu-id="7f7be-166">Aby uzyskać więcej informacji, zobacz <xref:System.Reflection.Emit.DynamicMethod> Klasa.</span><span class="sxs-lookup"><span data-stu-id="7f7be-166">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="7f7be-167">Generowanie metod dynamicznych z częściowo zaufanego kodu</span><span class="sxs-lookup"><span data-stu-id="7f7be-167">Generating Dynamic Methods from Partially Trusted Code</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-168">Zalecanym sposobem generowania metod dynamicznych z częściowo zaufanego kodu jest użycie [anonimowo obsługiwanych metod dynamicznych](#Anonymously_Hosted_Dynamic_Methods).</span><span class="sxs-lookup"><span data-stu-id="7f7be-168">The recommended way to generate dynamic methods from partially trusted code is to use [anonymously hosted dynamic methods](#Anonymously_Hosted_Dynamic_Methods).</span></span>  
  
 <span data-ttu-id="7f7be-169">Rozważ warunki, w których zestaw z uprawnieniami internetowymi może generować metodę dynamiczną i wykonać ją:</span><span class="sxs-lookup"><span data-stu-id="7f7be-169">Consider the conditions in which an assembly with Internet permissions can generate a dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="7f7be-170">Metoda dynamiczna jest skojarzona z modułem lub typem, który emituje go, lub jego zestaw przydzielenia zawiera <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> i jest skojarzony z modułem w zestawie, którego przystawka jest równa lub podzbiorowi przydzielonego zestawu emisji.</span><span class="sxs-lookup"><span data-stu-id="7f7be-170">Either the dynamic method is associated with the module or type that emits it, or its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="7f7be-171">Metoda dynamiczna używa tylko typów publicznych i elementów członkowskich.</span><span class="sxs-lookup"><span data-stu-id="7f7be-171">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="7f7be-172">Jeśli zestaw przyznanych <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> elementów zawiera i jest skojarzony z modułem w zestawie, którego przystawka jest równa lub podzbiorem zestawu, można użyć typów i członków oznaczonych `internal` (`Friend` w Visual Basic `assembly` w metadanych środowiska uruchomieniowego języka wspólnego) w skojarzonym module.</span><span class="sxs-lookup"><span data-stu-id="7f7be-172">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly, it can use types and members marked `internal` (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the associated module.</span></span>  
  
- <span data-ttu-id="7f7be-173">Uprawnienia wymagane przez wszystkie typy i elementy członkowskie używane przez metodę dynamiczną są zawarte w zestawie uprawnień częściowo zaufanego zestawu.</span><span class="sxs-lookup"><span data-stu-id="7f7be-173">The permissions demanded by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="7f7be-174">Metoda dynamiczna nie pomija sprawdzania widoczności JIT.</span><span class="sxs-lookup"><span data-stu-id="7f7be-174">The dynamic method does not skip JIT visibility checks.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-175">Metody dynamiczne nie obsługują symboli debugowania.</span><span class="sxs-lookup"><span data-stu-id="7f7be-175">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Version_Information"></a>
## <a name="version-information"></a><span data-ttu-id="7f7be-176">Informacje o wersji</span><span class="sxs-lookup"><span data-stu-id="7f7be-176">Version Information</span></span>  
 <span data-ttu-id="7f7be-177">Począwszy od .NET Framework 4, zasady zabezpieczeń dla całego komputera są eliminowane i przezroczystość zabezpieczeń staną się domyślnym mechanizmem wymuszania.</span><span class="sxs-lookup"><span data-stu-id="7f7be-177">Starting with the .NET Framework 4, machine-wide security policy is eliminated and security transparency becomes the default enforcement mechanism.</span></span> <span data-ttu-id="7f7be-178">Zobacz [zmiany zabezpieczeń](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span><span class="sxs-lookup"><span data-stu-id="7f7be-178">See [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span></span>  
  
 <span data-ttu-id="7f7be-179">Począwszy od .NET Framework 2,0 z dodatkiem Service Pack <xref:System.Security.Permissions.ReflectionPermission> 1, <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> z flagą nie jest już wymagane w przypadku emitowania zestawów dynamicznych i metod dynamicznych.</span><span class="sxs-lookup"><span data-stu-id="7f7be-179">Starting with the .NET Framework 2.0 Service Pack 1, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is no longer required when emitting dynamic assemblies and dynamic methods.</span></span> <span data-ttu-id="7f7be-180">Ta flaga jest wymagana we wszystkich wcześniejszych wersjach .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7f7be-180">This flag is required in all earlier versions of the .NET Framework.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7f7be-181"><xref:System.Security.Permissions.ReflectionPermission>z <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flagą jest uwzględniana domyślnie w zestawach uprawnień `FullTrust` i `LocalIntranet` nazwanych, ale nie w `Internet` zestawie uprawnień.</span><span class="sxs-lookup"><span data-stu-id="7f7be-181"><xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is included by default in the `FullTrust` and `LocalIntranet` named permission sets, but not in the `Internet` permission set.</span></span> <span data-ttu-id="7f7be-182">W związku z tym we wcześniejszych wersjach .NET Framework Biblioteka może być używana z uprawnieniami internetowymi tylko wtedy, gdy jest wykonywana <xref:System.Security.PermissionSet.Assert%2A> przez <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span><span class="sxs-lookup"><span data-stu-id="7f7be-182">Therefore, in earlier versions of the .NET Framework, a library can be used with Internet permissions only if it executes an <xref:System.Security.PermissionSet.Assert%2A> for <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span></span> <span data-ttu-id="7f7be-183">Takie biblioteki wymagają starannej oceny zabezpieczeń, ponieważ błędy kodowania mogą spowodować powstanie luk w zabezpieczeniach.</span><span class="sxs-lookup"><span data-stu-id="7f7be-183">Such libraries require careful security review because coding errors could result in security holes.</span></span> <span data-ttu-id="7f7be-184">Program .NET Framework 2,0 z dodatkiem SP1 umożliwia emitowanie kodu w scenariuszach częściowej relacji zaufania bez wydawania jakichkolwiek wymagań dotyczących zabezpieczeń, ponieważ generowanie kodu nie jest z założenia uprzywilejowanej operacji.</span><span class="sxs-lookup"><span data-stu-id="7f7be-184">The .NET Framework 2.0 SP1 allows code to be emitted in partial trust scenarios without issuing any security demands, because generating code is not inherently a privileged operation.</span></span> <span data-ttu-id="7f7be-185">Oznacza to, że wygenerowany kod nie ma więcej uprawnień niż zestaw, który emituje go.</span><span class="sxs-lookup"><span data-stu-id="7f7be-185">That is, the generated code has no more permissions than the assembly that emits it.</span></span> <span data-ttu-id="7f7be-186">Pozwala to na używanie bibliotek, które emitują kod jako przezroczysty i eliminuje konieczność potwierdzenia <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, co upraszcza zadanie pisania bezpiecznej biblioteki.</span><span class="sxs-lookup"><span data-stu-id="7f7be-186">This allows libraries that emit code to be security transparent and removes the need to assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, which simplifies the task of writing a secure library.</span></span>  
  
 <span data-ttu-id="7f7be-187">Ponadto w .NET Framework 2,0 SP1 wprowadzono <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flagę uzyskiwania dostępu do niepublicznych typów i członków z częściowo zaufanych metod dynamicznych.</span><span class="sxs-lookup"><span data-stu-id="7f7be-187">In addition, the .NET Framework 2.0 SP1 introduces the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag for accessing nonpublic types and members from partially trusted dynamic methods.</span></span> <span data-ttu-id="7f7be-188">Wcześniejsze wersje .NET Framework wymagają <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flagi metod dynamicznych, które uzyskują dostęp do typów niepublicznych i członków; jest to uprawnienie, które nigdy nie powinno zostać przyznane do częściowo zaufanego kodu.</span><span class="sxs-lookup"><span data-stu-id="7f7be-188">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for dynamic methods that access nonpublic types and members; this is a permission that should never be granted to partially trusted code.</span></span>  
  
 <span data-ttu-id="7f7be-189">Na koniec .NET Framework 2,0 z dodatkiem SP1 wprowadza anonimowo hostowane metody.</span><span class="sxs-lookup"><span data-stu-id="7f7be-189">Finally, the .NET Framework 2.0 SP1 introduces anonymously hosted methods.</span></span>  
  
### <a name="obtaining-information-on-types-and-members"></a><span data-ttu-id="7f7be-190">Uzyskiwanie informacji na temat typów i członków</span><span class="sxs-lookup"><span data-stu-id="7f7be-190">Obtaining Information on Types and Members</span></span>  
 <span data-ttu-id="7f7be-191">Począwszy od .NET Framework 2,0, żadne uprawnienia nie są wymagane do uzyskania informacji na temat typów niepublicznych i członków.</span><span class="sxs-lookup"><span data-stu-id="7f7be-191">Starting with the .NET Framework 2.0, no permissions are required to obtain information about nonpublic types and members.</span></span> <span data-ttu-id="7f7be-192">Odbicie służy do uzyskiwania informacji niezbędnych do emitowania metod dynamicznych.</span><span class="sxs-lookup"><span data-stu-id="7f7be-192">Reflection is used to obtain information needed to emit dynamic methods.</span></span> <span data-ttu-id="7f7be-193">Na przykład <xref:System.Reflection.MethodInfo> obiekty są używane do emisji wywołań metod.</span><span class="sxs-lookup"><span data-stu-id="7f7be-193">For example, <xref:System.Reflection.MethodInfo> objects are used to emit method calls.</span></span> <span data-ttu-id="7f7be-194">Wcześniejsze wersje .NET Framework wymagają <xref:System.Security.Permissions.ReflectionPermission> <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flagi z flagą.</span><span class="sxs-lookup"><span data-stu-id="7f7be-194">Earlier versions of the .NET Framework require <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="7f7be-195">Aby uzyskać więcej informacji, zobacz [zagadnienia dotyczące zabezpieczeń dotyczące odbicia](security-considerations-for-reflection.md).</span><span class="sxs-lookup"><span data-stu-id="7f7be-195">For more information, see [Security Considerations for Reflection](security-considerations-for-reflection.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7f7be-196">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="7f7be-196">See also</span></span>

- [<span data-ttu-id="7f7be-197">Zagadnienia dotyczące zabezpieczeń dla odbicia</span><span class="sxs-lookup"><span data-stu-id="7f7be-197">Security Considerations for Reflection</span></span>](security-considerations-for-reflection.md)
- [<span data-ttu-id="7f7be-198">Emitowanie dynamicznych metod i zestawów</span><span class="sxs-lookup"><span data-stu-id="7f7be-198">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)
