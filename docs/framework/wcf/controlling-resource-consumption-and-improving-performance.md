---
title: Kontrolowanie zużycia zasobów i zwiększanie wydajności
ms.date: 03/30/2017
ms.assetid: 9a829669-5f76-4c88-80ec-92d0c62c0660
ms.openlocfilehash: 16d6f29235455ff30e115b7aff3425412bc7ba6a
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802259"
---
# <a name="controlling-resource-consumption-and-improving-performance"></a><span data-ttu-id="9ac38-102">Kontrolowanie zużycia zasobów i zwiększanie wydajności</span><span class="sxs-lookup"><span data-stu-id="9ac38-102">Controlling Resource Consumption and Improving Performance</span></span>
<span data-ttu-id="9ac38-103">W tym temacie opisano różne właściwości w różnych obszarach architektury Windows Communication Foundation (WCF), które działają w celu kontrolowania zużycia zasobów i wpływają na metryki wydajności.</span><span class="sxs-lookup"><span data-stu-id="9ac38-103">This topic describes various properties in different areas of the Windows Communication Foundation (WCF) architecture that work to control resource consumption and affect performance metrics.</span></span>

## <a name="properties-that-constrain-resource-consumption-in-wcf"></a><span data-ttu-id="9ac38-104">Właściwości ograniczające użycie zasobów w programie WCF</span><span class="sxs-lookup"><span data-stu-id="9ac38-104">Properties that Constrain Resource Consumption in WCF</span></span>
 <span data-ttu-id="9ac38-105">Windows Communication Foundation (WCF) stosuje ograniczenia dotyczące niektórych typów procesów w celu zapewnienia bezpieczeństwa lub wydajności.</span><span class="sxs-lookup"><span data-stu-id="9ac38-105">Windows Communication Foundation (WCF) applies constraints on certain types of processes for either security or performance purposes.</span></span> <span data-ttu-id="9ac38-106">Te ograniczenia są dostępne w dwóch głównych formularzach — przydziałach i ograniczeniach.</span><span class="sxs-lookup"><span data-stu-id="9ac38-106">These constraints come in two main forms, either quotas and throttles.</span></span> <span data-ttu-id="9ac38-107">Limity *przydziału* są limitami, które po osiągnięciu lub przekroczeniu wyzwalają natychmiastowy wyjątek w pewnym momencie w systemie.</span><span class="sxs-lookup"><span data-stu-id="9ac38-107">*Quotas* are limits that when reached or exceeded trigger an immediate exception at some point in the system.</span></span> <span data-ttu-id="9ac38-108">*Ograniczenia* są ograniczone, które nie powodują natychmiastowego zgłoszenia wyjątku.</span><span class="sxs-lookup"><span data-stu-id="9ac38-108">*Throttles* are limits that do not immediately cause an exception to be thrown.</span></span> <span data-ttu-id="9ac38-109">Zamiast tego, po osiągnięciu limitu ograniczania, przetwarzanie jest kontynuowane, ale w ramach limitów ustawionych przez wartość ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="9ac38-109">Instead, when a throttle limit is reached, processing continues but within the limits set by that throttle value.</span></span> <span data-ttu-id="9ac38-110">To ograniczone przetwarzanie może wyzwolić wyjątek w innym miejscu, ale jest to zależne od aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9ac38-110">This limited processing might trigger an exception elsewhere, but this depends upon the application.</span></span>

 <span data-ttu-id="9ac38-111">Oprócz rozróżnienia między przydziałami i ograniczeniami, pewne właściwości ograniczające się na poziomie serializacji, na poziomie transportu, a także na poziomie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9ac38-111">In addition to the distinction between quotas and throttles, some constraining properties are located at the serialization level, some at the transport level, and some at the application level.</span></span> <span data-ttu-id="9ac38-112">Na przykład <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>przydziału, który jest implementowany przez wszystkie elementy powiązania transportu dostarczone przez system, jest domyślnie ustawiony na 65 536 bajtów, aby utrudnić złośliwym klientom zaangażowanie się w atak typu "odmowa usługi" na usługę, powodując nadmierne użycie pamięci.</span><span class="sxs-lookup"><span data-stu-id="9ac38-112">For example, the quota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, which is implemented by all system-supplied transport binding elements, is set to 65,536 bytes by default to hinder malicious clients from engaging in denial-of-service attacks against a service by causing excessive memory consumption.</span></span> <span data-ttu-id="9ac38-113">(Zazwyczaj można zwiększyć wydajność, obniżając tę wartość).</span><span class="sxs-lookup"><span data-stu-id="9ac38-113">(Typically, you can increase performance by lowering this value.)</span></span>

 <span data-ttu-id="9ac38-114">Przykładem przydziału serializacji jest właściwość <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>, która określa maksymalną liczbę obiektów serializowanych lub deserializacji serializatora w jednym wywołaniu metody <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A>.</span><span class="sxs-lookup"><span data-stu-id="9ac38-114">An example of a serialization quota is the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property, which specifies the maximum number of objects that the serializer serializes or deserializes in a single <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> method call.</span></span> <span data-ttu-id="9ac38-115">Przykładem ograniczenia poziomu aplikacji jest właściwość <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType>, która domyślnie ogranicza liczbę współbieżnych połączeń sesji do 10.</span><span class="sxs-lookup"><span data-stu-id="9ac38-115">An example of an application-level throttle is the <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> property, which by default restricts the number of concurrent sessionful channel connections to 10.</span></span> <span data-ttu-id="9ac38-116">(W przeciwieństwie do przydziałów, jeśli wartość tego ograniczenia zostanie osiągnięta, aplikacja kontynuuje przetwarzanie, ale nie akceptuje żadnych nowych kanałów sesji, co oznacza, że nowi klienci nie będą mogli nawiązywać połączeń do momentu zakończenia jednego z pozostałych kanałów sesji).</span><span class="sxs-lookup"><span data-stu-id="9ac38-116">(Unlike the quotas, if this throttle value is reached, the application continues processing but accepts no new sessionful channels, which means that new clients cannot connect until one of the other sessionful channels is ended.)</span></span>

 <span data-ttu-id="9ac38-117">Te kontrolki zostały zaprojektowane w celu zapewnienia gotowego do użycia środków zaradczych przed niektórymi typami ataków lub w celu poprawienia metryk wydajności, takich jak rozmiary pamięci, czas rozpoczęcia i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="9ac38-117">These controls are designed to provide an out-of-the-box mitigation against certain types of attacks or to improve performance metrics such as memory footprint, start-up time, and so on.</span></span> <span data-ttu-id="9ac38-118">Jednak w zależności od aplikacji te kontrolki mogą utrudniać wydajność aplikacji usług lub uniemożliwić działanie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9ac38-118">However, depending on the application, these controls can impede service application performance or prevent the application from working at all.</span></span> <span data-ttu-id="9ac38-119">Na przykład aplikacja zaprojektowana na potrzeby przesyłania strumieniowego wideo może łatwo przekroczyć domyślną właściwość <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="9ac38-119">For example, an application designed to stream video can easily exceed the default <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="9ac38-120">Ten temat zawiera omówienie różnych kontrolek stosowanych do aplikacji na wszystkich poziomach programu WCF, opis różnych sposobów uzyskania dodatkowych informacji na temat tego, czy ustawienie przeszkadza w aplikacji, oraz opisuje sposoby rozwiązywania różnych problemów.</span><span class="sxs-lookup"><span data-stu-id="9ac38-120">This topic provides an overview of the various controls applied to applications at all levels of WCF, describes various ways to obtain more information about whether a setting is hindering your application, and describes ways to correct various problems.</span></span> <span data-ttu-id="9ac38-121">Większość ograniczania przepustowości i niektórych przydziałów są dostępne na poziomie aplikacji, nawet jeśli właściwość podstawowa jest ograniczeniem serializacji lub transportu.</span><span class="sxs-lookup"><span data-stu-id="9ac38-121">Most throttles and some quotas are available at the application level, even when the base property is a serialization or transport constraint.</span></span> <span data-ttu-id="9ac38-122">Na przykład można ustawić właściwość <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> przy użyciu właściwości <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> w klasie usługi.</span><span class="sxs-lookup"><span data-stu-id="9ac38-122">For example, you can set the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property using the <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property on the service class.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac38-123">W przypadku konkretnego problemu należy najpierw przeczytać [Przewodnik Szybki Start dotyczący rozwiązywania problemów z usługą WCF](wcf-troubleshooting-quickstart.md) , aby sprawdzić, czy na liście znajduje się problem (i rozwiązanie).</span><span class="sxs-lookup"><span data-stu-id="9ac38-123">If you have a particular problem, you should first read the [WCF Troubleshooting Quickstart](wcf-troubleshooting-quickstart.md) to see whether your problem (and a solution) is listed there.</span></span>

 <span data-ttu-id="9ac38-124">Właściwości ograniczające procesy serializacji są wymienione w temacie [zagadnienia dotyczące zabezpieczeń danych](./feature-details/security-considerations-for-data.md).</span><span class="sxs-lookup"><span data-stu-id="9ac38-124">Properties that restrict serialization processes are listed in [Security Considerations for Data](./feature-details/security-considerations-for-data.md).</span></span> <span data-ttu-id="9ac38-125">Właściwości ograniczające użycie zasobów związanych z transportami są wymienione w obszarze [przydziały transportu](./feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="9ac38-125">Properties that restrict the consumption of resources related to transports are listed in [Transport Quotas](./feature-details/transport-quotas.md).</span></span> <span data-ttu-id="9ac38-126">Właściwości ograniczające użycie zasobów w warstwie aplikacji są elementami członkowskimi klasy <xref:System.ServiceModel.Dispatcher.ServiceThrottle>.</span><span class="sxs-lookup"><span data-stu-id="9ac38-126">Properties that restrict the consumption of resources at the application layer are the members of the <xref:System.ServiceModel.Dispatcher.ServiceThrottle> class.</span></span>

## <a name="detecting-application-and-performance-issues-related-to-quota-settings"></a><span data-ttu-id="9ac38-127">Wykrywanie problemów z aplikacjami i wydajnością związanych z ustawieniami limitu przydziału</span><span class="sxs-lookup"><span data-stu-id="9ac38-127">Detecting Application and Performance Issues Related to Quota Settings</span></span>
 <span data-ttu-id="9ac38-128">Ustawienia domyślne powyższych wartości zostały wybrane w celu włączenia podstawowej funkcjonalności aplikacji dla szerokiego zakresu typów aplikacji, a jednocześnie zapewnia podstawową ochronę przed typowymi problemami z zabezpieczeniami.</span><span class="sxs-lookup"><span data-stu-id="9ac38-128">The defaults of the preceding values have been chosen to enable basic application functionality across a wide range of application types while providing basic protection against common security issues.</span></span> <span data-ttu-id="9ac38-129">Jednak różne projekty aplikacji mogą przekroczyć jedno lub więcej ustawień ograniczania, chociaż aplikacja jest bezpieczna i będzie działała zgodnie z założeniami.</span><span class="sxs-lookup"><span data-stu-id="9ac38-129">However, different application designs might exceed one or more throttle settings although the application otherwise is secure and would work as designed.</span></span> <span data-ttu-id="9ac38-130">W takich przypadkach należy określić, które wartości ograniczania przepustowości są przewyższane i na jakim poziomie, i podjąć decyzję o odpowiednim czasie działania, aby zwiększyć przepływność aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9ac38-130">In these cases, you must identify which throttle values are being exceeded and at what level, and decide on the appropriate course of action to increase application throughput.</span></span>

 <span data-ttu-id="9ac38-131">Zazwyczaj podczas pisania aplikacji i debugowania należy ustawić właściwość <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> na `true` w pliku konfiguracyjnym lub programowo.</span><span class="sxs-lookup"><span data-stu-id="9ac38-131">Typically, when writing the application and debugging it, you set the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property to `true` in the configuration file or programmatically.</span></span> <span data-ttu-id="9ac38-132">Powoduje to zwrócenie przez program WCF śladów stosu wyjątków usługi do aplikacji klienckiej w celu wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="9ac38-132">This instructs WCF to return service exception stack traces to the client application for viewing.</span></span> <span data-ttu-id="9ac38-133">Ta funkcja raportuje większość wyjątków poziomu aplikacji w taki sposób, aby wyświetlić ustawienia przydziałów, które mogą być uwzględnione, jeśli jest to problem.</span><span class="sxs-lookup"><span data-stu-id="9ac38-133">This feature reports most application-level exceptions in such a way as to display which quota settings might be involved, if that is the problem.</span></span>

 <span data-ttu-id="9ac38-134">Niektóre wyjątki występują w czasie wykonywania poniżej widoczności warstwy aplikacji i nie są zwracane przy użyciu tego mechanizmu i mogą nie być obsługiwane przez niestandardową implementację <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="9ac38-134">Some exceptions happen at run time below the visibility of the application layer and are not returned using this mechanism, and they might not be handled by a custom <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="9ac38-135">Jeśli jesteś w środowisku deweloperskim, takim jak Microsoft Visual Studio, większość z tych wyjątków jest wyświetlana automatycznie.</span><span class="sxs-lookup"><span data-stu-id="9ac38-135">If you are in a development environment like Microsoft Visual Studio, most of these exceptions are displayed automatically.</span></span> <span data-ttu-id="9ac38-136">Niektóre wyjątki mogą jednak być maskowane przez ustawienia środowiska programistycznego, takie jak [tylko mój kod](/visualstudio/debugger/just-my-code) Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="9ac38-136">However, some exceptions can be masked by development environment settings such as [Just My Code](/visualstudio/debugger/just-my-code) Visual Studio.</span></span>

 <span data-ttu-id="9ac38-137">Niezależnie od możliwości środowiska programistycznego można używać funkcji śledzenia i rejestrowania komunikatów w programie WCF w celu debugowania wszystkich wyjątków i dostrajania wydajności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9ac38-137">Regardless of the capabilities of your development environment, you can use capabilities of WCF tracing and message logging to debug all exceptions and tune the performance of your applications.</span></span> <span data-ttu-id="9ac38-138">Aby uzyskać więcej informacji, zobacz [Używanie śledzenia w celu rozwiązywania problemów z aplikacją](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span><span class="sxs-lookup"><span data-stu-id="9ac38-138">For more information, see [Using Tracing to Troubleshoot Your Application](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span></span>

## <a name="performance-issues-and-xmlserializer"></a><span data-ttu-id="9ac38-139">Problemy z wydajnością i XmlSerializer</span><span class="sxs-lookup"><span data-stu-id="9ac38-139">Performance Issues and XmlSerializer</span></span>
 <span data-ttu-id="9ac38-140">Usługi i aplikacje klienckie korzystające z typów danych, które można serializować przy użyciu <xref:System.Xml.Serialization.XmlSerializer> generują i kompilują kod serializacji dla tych typów danych w czasie wykonywania, co może spowodować spowolnienie wydajności.</span><span class="sxs-lookup"><span data-stu-id="9ac38-140">Services and client applications that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at run time, which can result in slow start-up performance.</span></span>

> [!NOTE]
> <span data-ttu-id="9ac38-141">Wstępnie wygenerowany kod serializacji może być używany tylko w aplikacjach klienckich, a nie w usługach.</span><span class="sxs-lookup"><span data-stu-id="9ac38-141">Pre-generated serialization code can be used only in client applications and not in services.</span></span>

 <span data-ttu-id="9ac38-142">[Narzędzie do przesyłania metadanych modelu ServiceModel (Svcutil. exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) może zwiększyć wydajność uruchamiania tych aplikacji, generując wymagany kod serializacji z skompilowanych zestawów dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9ac38-142">The [ServiceModel Metadata Utility Tool (Svcutil.exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application.</span></span> <span data-ttu-id="9ac38-143">Aby uzyskać więcej informacji, zobacz [How to: ulepszanie czasu uruchamiania aplikacji klienckich WCF przy użyciu elementu XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span><span class="sxs-lookup"><span data-stu-id="9ac38-143">For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span></span>

## <a name="performance-issues-when-hosting-wcf-services-under-aspnet"></a><span data-ttu-id="9ac38-144">Problemy z wydajnością podczas hostowania usług WCF w obszarze ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9ac38-144">Performance Issues When Hosting WCF Services Under ASP.NET</span></span>

<span data-ttu-id="9ac38-145">Gdy usługa WCF jest hostowana w usługach IIS i ASP.NET, ustawienia konfiguracji usług IIS i ASP.NET mogą mieć wpływ na przepływność i ilość pamięci usługi WCF.</span><span class="sxs-lookup"><span data-stu-id="9ac38-145">When a WCF service is hosted under IIS and ASP.NET, the configuration settings of IIS and ASP.NET can affect the throughput and memory footprint of the WCF service.</span></span>  <span data-ttu-id="9ac38-146">Aby uzyskać więcej informacji na temat wydajności ASP.NET, zobacz [Poprawianie wydajności ASP.NET](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="9ac38-146">For more information about ASP.NET performance, see [Improving ASP.NET Performance](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span></span> <span data-ttu-id="9ac38-147">Jedno ustawienie, które może mieć niezamierzone konsekwencje, jest <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, które jest właściwością <xref:System.Web.Configuration.ProcessModelSection>.</span><span class="sxs-lookup"><span data-stu-id="9ac38-147">One setting that might have unintended consequences is <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, which is a property of the <xref:System.Web.Configuration.ProcessModelSection>.</span></span> <span data-ttu-id="9ac38-148">Jeśli aplikacja ma ustaloną lub małą liczbę klientów, ustawienie <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> na 2 może zapewnić zwiększenie przepływności na komputerze wieloprocesorowym, który ma wykorzystanie procesora w pobliżu 100%.</span><span class="sxs-lookup"><span data-stu-id="9ac38-148">If your application has a fixed or small number of clients, setting <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> to 2 might provide a throughput boost on a multiprocessor machine that has a CPU utilization close to 100%.</span></span> <span data-ttu-id="9ac38-149">Ten wzrost wydajności obejmuje koszt: spowoduje to również zwiększenie użycia pamięci, co może obniżyć skalowalność.</span><span class="sxs-lookup"><span data-stu-id="9ac38-149">This increase in performance comes with a cost: it will also cause an increase in memory usage, which could reduce scalability.</span></span>

## <a name="see-also"></a><span data-ttu-id="9ac38-150">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="9ac38-150">See also</span></span>

- [<span data-ttu-id="9ac38-151">Administracja i diagnostyka</span><span class="sxs-lookup"><span data-stu-id="9ac38-151">Administration and Diagnostics</span></span>](./diagnostics/index.md)
- [<span data-ttu-id="9ac38-152">Duże ilości danych i przesyłanie strumieniowe</span><span class="sxs-lookup"><span data-stu-id="9ac38-152">Large Data and Streaming</span></span>](./feature-details/large-data-and-streaming.md)
