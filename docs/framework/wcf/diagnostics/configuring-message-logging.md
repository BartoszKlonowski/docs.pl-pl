---
title: Konfigurowanie rejestrowania komunikatów
description: Dowiedz się, jak skonfigurować rejestrowanie komunikatów, w tym informacje na temat włączania rejestrowania, poziomów rejestrowania, filtrów komunikatów i konfigurowania odbiornika niestandardowego w programie WCF.
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: 5203f19a18e5fa6b0ed7f68e1d1de0447da41abd
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/23/2020
ms.locfileid: "85247665"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="aa50a-103">Konfigurowanie rejestrowania komunikatów</span><span class="sxs-lookup"><span data-stu-id="aa50a-103">Configuring Message Logging</span></span>

<span data-ttu-id="aa50a-104">W tym temacie opisano, jak można skonfigurować rejestrowanie komunikatów dla różnych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="aa50a-104">This topic describes how you can configure message logging for different scenarios.</span></span>

## <a name="enabling-message-logging"></a><span data-ttu-id="aa50a-105">Włączanie rejestrowania komunikatów</span><span class="sxs-lookup"><span data-stu-id="aa50a-105">Enabling Message Logging</span></span>

<span data-ttu-id="aa50a-106">Windows Communication Foundation (WCF) nie rejestruje komunikatów domyślnie.</span><span class="sxs-lookup"><span data-stu-id="aa50a-106">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="aa50a-107">Aby uaktywnić rejestrowanie komunikatów, należy dodać odbiornik śledzenia do `System.ServiceModel.MessageLogging` źródła śledzenia i ustawić atrybuty dla `<messagelogging>` elementu w pliku konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-107">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>

<span data-ttu-id="aa50a-108">Poniższy przykład pokazuje, jak włączyć rejestrowanie i określić dodatkowe opcje.</span><span class="sxs-lookup"><span data-stu-id="aa50a-108">The following example shows how to enable logging and specify additional options.</span></span>

```xml
<system.diagnostics>
  <sources>
    <source name="System.ServiceModel.MessageLogging">
      <listeners>
         <add name="messages"
              type="System.Diagnostics.XmlWriterTraceListener"
              initializeData="c:\logs\messages.svclog" />
        </listeners>
    </source>
  </sources>
</system.diagnostics>

<system.serviceModel>
  <diagnostics>
    <messageLogging
         logEntireMessage="true"
         logMalformedMessages="false"
         logMessagesAtServiceLevel="true"
         logMessagesAtTransportLevel="false"
         maxMessagesToLog="3000"
         maxSizeOfMessageToLog="2000"/>
  </diagnostics>
</system.serviceModel>
```

<span data-ttu-id="aa50a-109">Aby uzyskać więcej informacji na temat ustawień rejestrowania komunikatów, zobacz [zalecane ustawienia śledzenia i rejestrowania komunikatów](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="aa50a-109">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>

<span data-ttu-id="aa50a-110">Możesz użyć, `add` Aby określić nazwę i typ odbiornika, którego chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="aa50a-110">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="aa50a-111">W przykładowej konfiguracji odbiornik ma nazwę "Messages" i dodaje odbiornik standardowego .NET Framework śledzenia ( `System.Diagnostics.XmlWriterTraceListener` ) jako typ do użycia.</span><span class="sxs-lookup"><span data-stu-id="aa50a-111">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="aa50a-112">Jeśli używasz `System.Diagnostics.XmlWriterTraceListener` , musisz określić lokalizację i nazwę pliku wyjściowego w pliku konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-112">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="aa50a-113">Można to zrobić, ustawiając `initializeData` nazwę pliku dziennika.</span><span class="sxs-lookup"><span data-stu-id="aa50a-113">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="aa50a-114">W przeciwnym razie system zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="aa50a-114">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="aa50a-115">Możesz również zaimplementować niestandardowy odbiornik, który emituje dzienniki do pliku domyślnego.</span><span class="sxs-lookup"><span data-stu-id="aa50a-115">You can also implement a custom listener that emits logs to a default file.</span></span>

> [!NOTE]
> <span data-ttu-id="aa50a-116">Ponieważ rejestrowanie komunikatów uzyskuje dostęp do miejsca na dysku, należy ograniczyć liczbę wiadomości, które są zapisywane na dysku dla określonej usługi.</span><span class="sxs-lookup"><span data-stu-id="aa50a-116">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="aa50a-117">Po osiągnięciu limitu komunikatów zostaje wygenerowany ślad na poziomie informacji i wszystkie działania związane z rejestrowaniem komunikatów zostaną zatrzymane.</span><span class="sxs-lookup"><span data-stu-id="aa50a-117">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>

<span data-ttu-id="aa50a-118">Poziom rejestrowania, a także opcje dodatkowe są omówione w sekcji poziom rejestrowania i opcje.</span><span class="sxs-lookup"><span data-stu-id="aa50a-118">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>

<span data-ttu-id="aa50a-119">`switchValue`Atrybut elementu `source` jest prawidłowy tylko dla śledzenia.</span><span class="sxs-lookup"><span data-stu-id="aa50a-119">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="aa50a-120">Jeśli określisz `switchValue` atrybut dla `System.ServiceModel.MessageLogging` źródła śledzenia w następujący sposób, nie ma to żadnego efektu.</span><span class="sxs-lookup"><span data-stu-id="aa50a-120">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>

```xml
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">
</source>
```

<span data-ttu-id="aa50a-121">Jeśli chcesz wyłączyć źródło śledzenia, `logMessagesAtServiceLevel` zamiast tego należy użyć `logMalformedMessages` atrybutów, i `logMessagesAtTransportLevel` `messageLogging` .</span><span class="sxs-lookup"><span data-stu-id="aa50a-121">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="aa50a-122">Należy ustawić wszystkie te atrybuty na `false` .</span><span class="sxs-lookup"><span data-stu-id="aa50a-122">You should set all these attributes to `false`.</span></span> <span data-ttu-id="aa50a-123">Można to zrobić za pomocą pliku konfiguracji w poprzednim przykładzie kodu, za pomocą interfejsu użytkownika edytora konfiguracji lub przy użyciu usługi WMI.</span><span class="sxs-lookup"><span data-stu-id="aa50a-123">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="aa50a-124">Aby uzyskać więcej informacji o narzędziu Edytor konfiguracji, zobacz [Narzędzie edytora konfiguracji (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="aa50a-124">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="aa50a-125">Aby uzyskać więcej informacji na temat usługi WMI, zobacz [używanie Instrumentacja zarządzania Windows do diagnostyki](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="aa50a-125">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

## <a name="logging-levels-and-options"></a><span data-ttu-id="aa50a-126">Poziomy rejestrowania i opcje</span><span class="sxs-lookup"><span data-stu-id="aa50a-126">Logging Levels and Options</span></span>

<span data-ttu-id="aa50a-127">W przypadku wiadomości przychodzących rejestrowanie odbywa się natychmiast po utworzeniu komunikatu, bezpośrednio przed wprowadzeniem komunikatu do kodu użytkownika na poziomie usługi i po wykryciu źle sformułowanych komunikatów.</span><span class="sxs-lookup"><span data-stu-id="aa50a-127">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>

<span data-ttu-id="aa50a-128">W przypadku wiadomości wychodzących rejestrowanie odbywa się natychmiast po opuszczeniu przez komunikat kodu użytkownika i natychmiast przed wysłaniem komunikatu do sieci.</span><span class="sxs-lookup"><span data-stu-id="aa50a-128">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>

<span data-ttu-id="aa50a-129">Usługa WCF rejestruje komunikaty na dwóch różnych poziomach, usługach i transportach.</span><span class="sxs-lookup"><span data-stu-id="aa50a-129">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="aa50a-130">Rejestrowane są również źle sformułowane komunikaty.</span><span class="sxs-lookup"><span data-stu-id="aa50a-130">Malformed messages are also logged.</span></span> <span data-ttu-id="aa50a-131">Trzy kategorie są niezależne od siebie i można je aktywować osobno w konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-131">The three categories are independent from each other and can be activated separately in configuration.</span></span>

<span data-ttu-id="aa50a-132">Poziom rejestrowania można kontrolować przez ustawienie `logMessagesAtServiceLevel` `logMalformedMessages` atrybutów elementu,, i `logMessagesAtTransportLevel` `messageLogging` .</span><span class="sxs-lookup"><span data-stu-id="aa50a-132">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>

### <a name="service-level"></a><span data-ttu-id="aa50a-133">Poziom usług</span><span class="sxs-lookup"><span data-stu-id="aa50a-133">Service Level</span></span>

<span data-ttu-id="aa50a-134">Komunikaty zarejestrowane w tej warstwie mają na celu wprowadzenie (przy odbiorze) lub pozostawienie (przy wysyłaniu) kodu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="aa50a-134">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="aa50a-135">Jeśli filtry zostały zdefiniowane, rejestrowane są tylko komunikaty zgodne z filtrami.</span><span class="sxs-lookup"><span data-stu-id="aa50a-135">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="aa50a-136">W przeciwnym razie zostaną zarejestrowane wszystkie komunikaty na poziomie usługi.</span><span class="sxs-lookup"><span data-stu-id="aa50a-136">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="aa50a-137">Komunikaty infrastruktury (transakcje, kanał równorzędny i zabezpieczenia) są również rejestrowane na tym poziomie, z wyjątkiem komunikatów o niezawodnej komunikacji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-137">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="aa50a-138">W przypadku komunikatów przesyłanych strumieniowo rejestrowane są tylko nagłówki.</span><span class="sxs-lookup"><span data-stu-id="aa50a-138">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="aa50a-139">Ponadto na tym poziomie są zaszyfrowane bezpieczne komunikaty.</span><span class="sxs-lookup"><span data-stu-id="aa50a-139">In addition, secure messages are logged decrypted at this level.</span></span>

### <a name="transport-level"></a><span data-ttu-id="aa50a-140">Poziom transportu</span><span class="sxs-lookup"><span data-stu-id="aa50a-140">Transport Level</span></span>

<span data-ttu-id="aa50a-141">Komunikaty zarejestrowane w tej warstwie są gotowe do zakodowania lub dekodowania dla lub po transporcie w sieci.</span><span class="sxs-lookup"><span data-stu-id="aa50a-141">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="aa50a-142">Jeśli filtry zostały zdefiniowane, rejestrowane są tylko komunikaty zgodne z filtrami.</span><span class="sxs-lookup"><span data-stu-id="aa50a-142">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="aa50a-143">W przeciwnym razie wszystkie komunikaty w warstwie transportowej są rejestrowane.</span><span class="sxs-lookup"><span data-stu-id="aa50a-143">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="aa50a-144">Wszystkie komunikaty infrastruktury są rejestrowane w tej warstwie, w tym komunikaty niezawodnej obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="aa50a-144">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="aa50a-145">W przypadku komunikatów przesyłanych strumieniowo rejestrowane są tylko nagłówki.</span><span class="sxs-lookup"><span data-stu-id="aa50a-145">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="aa50a-146">Ponadto bezpieczne wiadomości są rejestrowane jako zaszyfrowane na tym poziomie, z wyjątkiem tego, czy jest używany bezpieczny transport, taki jak HTTPS.</span><span class="sxs-lookup"><span data-stu-id="aa50a-146">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>

### <a name="malformed-level"></a><span data-ttu-id="aa50a-147">Źle skonstruowany poziom</span><span class="sxs-lookup"><span data-stu-id="aa50a-147">Malformed Level</span></span>

<span data-ttu-id="aa50a-148">Źle sformułowane komunikaty to komunikaty odrzucone przez stos WCF na dowolnym etapie przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="aa50a-148">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="aa50a-149">Źle sformułowane komunikaty są rejestrowane jako: zaszyfrowane, jeśli tak, z nieprawidłowym kodem XML i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="aa50a-149">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> <span data-ttu-id="aa50a-150">`maxSizeOfMessageToLog`zdefiniowano rozmiar wiadomości, która ma zostać zarejestrowana jako CDATA.</span><span class="sxs-lookup"><span data-stu-id="aa50a-150">`maxSizeOfMessageToLog` defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="aa50a-151">Domyślnie `maxSizeOfMessageToLog` jest równa 256 k.</span><span class="sxs-lookup"><span data-stu-id="aa50a-151">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="aa50a-152">Więcej informacji o tym atrybucie zawiera sekcja inne opcje.</span><span class="sxs-lookup"><span data-stu-id="aa50a-152">For more information about this attribute, see the Other Options section.</span></span>

### <a name="other-options"></a><span data-ttu-id="aa50a-153">Inne opcje</span><span class="sxs-lookup"><span data-stu-id="aa50a-153">Other Options</span></span>

<span data-ttu-id="aa50a-154">Oprócz poziomów rejestrowania użytkownik może określić następujące opcje:</span><span class="sxs-lookup"><span data-stu-id="aa50a-154">In addition to the logging levels, the user can specify the following options:</span></span>

- <span data-ttu-id="aa50a-155">Rejestruj cały komunikat ( `logEntireMessage` atrybut): Ta wartość określa, czy cały komunikat (nagłówek i treść wiadomości) jest rejestrowany.</span><span class="sxs-lookup"><span data-stu-id="aa50a-155">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="aa50a-156">Wartość domyślna to `false` , co oznacza, że tylko nagłówek jest rejestrowany.</span><span class="sxs-lookup"><span data-stu-id="aa50a-156">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="aa50a-157">To ustawienie ma wpływ na poziomy rejestrowania komunikatów usługi i transportu..</span><span class="sxs-lookup"><span data-stu-id="aa50a-157">This setting affects service and transport message logging levels..</span></span>

- <span data-ttu-id="aa50a-158">Maksymalna liczba komunikatów do zarejestrowania ( `maxMessagesToLog` atrybut): Ta wartość określa maksymalną liczbę komunikatów do zarejestrowania.</span><span class="sxs-lookup"><span data-stu-id="aa50a-158">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="aa50a-159">Wszystkie komunikaty (usługa, transport i źle sformułowane komunikaty) są zliczane do tego przydziału.</span><span class="sxs-lookup"><span data-stu-id="aa50a-159">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="aa50a-160">Po osiągnięciu limitu przydziału ślad jest emitowany i nie jest rejestrowany żaden dodatkowy komunikat.</span><span class="sxs-lookup"><span data-stu-id="aa50a-160">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="aa50a-161">Wartość domyślna to 10000.</span><span class="sxs-lookup"><span data-stu-id="aa50a-161">The default value is 10000.</span></span>

- <span data-ttu-id="aa50a-162">Maksymalny rozmiar komunikatu do zarejestrowania ( `maxSizeOfMessageToLog` atrybut): Ta wartość określa maksymalny rozmiar komunikatów, które mają być rejestrowane w bajtach.</span><span class="sxs-lookup"><span data-stu-id="aa50a-162">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="aa50a-163">Komunikaty przekraczające limit rozmiaru nie są rejestrowane i żadne inne działanie nie jest wykonywane dla tego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="aa50a-163">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="aa50a-164">To ustawienie ma wpływ na wszystkie poziomy śledzenia.</span><span class="sxs-lookup"><span data-stu-id="aa50a-164">This setting affects all trace levels.</span></span> <span data-ttu-id="aa50a-165">Jeśli śledzenie ServiceModel jest włączone, ślad poziomu ostrzeżeń jest emitowany w pierwszym punkcie rejestrowania (ServiceModelSend \* lub TransportReceive) w celu powiadomienia użytkownika.</span><span class="sxs-lookup"><span data-stu-id="aa50a-165">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="aa50a-166">Wartość domyślna dla komunikatów poziomu usługi i na poziomie transportu to 256 K, podczas gdy wartość domyślna dla źle sformułowanych komunikatów to 4K.</span><span class="sxs-lookup"><span data-stu-id="aa50a-166">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>

  > [!CAUTION]
  > <span data-ttu-id="aa50a-167">Rozmiar komunikatu, który jest obliczany do porównania, `maxSizeOfMessageToLog` jest rozmiarem komunikatu w pamięci przed serializacji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-167">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="aa50a-168">Ten rozmiar może różnić się od rzeczywistej długości rejestrowanego ciągu komunikatu, a w wielu przypadkach jest większy niż rzeczywisty rozmiar.</span><span class="sxs-lookup"><span data-stu-id="aa50a-168">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="aa50a-169">W związku z tym komunikaty mogą nie być rejestrowane.</span><span class="sxs-lookup"><span data-stu-id="aa50a-169">As a result, messages may not be logged.</span></span> <span data-ttu-id="aa50a-170">Możesz obsłużyć ten fakt, określając `maxSizeOfMessageToLog` atrybut, który ma być 10% większy niż oczekiwany rozmiar wiadomości.</span><span class="sxs-lookup"><span data-stu-id="aa50a-170">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="aa50a-171">Ponadto w przypadku zarejestrowania źle sformułowanych komunikatów rzeczywista ilość miejsca na dysku wykorzystana przez dzienniki komunikatów może być maksymalnie 5 razy większa niż wartość określona przez `maxSizeOfMessageToLog` .</span><span class="sxs-lookup"><span data-stu-id="aa50a-171">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>

<span data-ttu-id="aa50a-172">Jeśli żaden odbiornik śledzenia nie jest zdefiniowany w pliku konfiguracji, żadne dane wyjściowe rejestrowania nie są generowane niezależnie od określonego poziomu rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="aa50a-172">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>

<span data-ttu-id="aa50a-173">Opcje rejestrowania komunikatów, takie jak atrybuty opisane w tej sekcji, można zmienić w czasie wykonywania przy użyciu Instrumentacja zarządzania Windows (WMI).</span><span class="sxs-lookup"><span data-stu-id="aa50a-173">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="aa50a-174">Można to zrobić, uzyskując dostęp do wystąpienia [AppDomainInfo](./wmi/appdomaininfo.md) , które uwidacznia następujące właściwości logiczne: `LogMessagesAtServiceLevel` , `LogMessagesAtTransportLevel` , i `LogMalformedMessages` .</span><span class="sxs-lookup"><span data-stu-id="aa50a-174">This can be done by accessing the [AppDomainInfo](./wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="aa50a-175">W związku z tym, jeśli skonfigurujesz odbiornik śledzenia do rejestrowania komunikatów, ale ustawisz te opcje `false` w konfiguracji, możesz później zmienić je na, `true` gdy aplikacja jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="aa50a-175">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="aa50a-176">Pozwala to efektywnie rejestrować komunikaty w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="aa50a-176">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="aa50a-177">Podobnie, jeśli włączysz rejestrowanie komunikatów w pliku konfiguracji, możesz go wyłączyć w czasie wykonywania za pomocą usługi WMI.</span><span class="sxs-lookup"><span data-stu-id="aa50a-177">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="aa50a-178">Aby uzyskać więcej informacji, zobacz [używanie Instrumentacja zarządzania Windows do diagnostyki](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="aa50a-178">For more information, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

<span data-ttu-id="aa50a-179">`source`Pole w dzienniku komunikatów określa, w którym kontekście komunikat jest rejestrowany: podczas wysyłania/otrzymywania komunikatu żądania, dla żądania żądanie-odpowiedź lub 1-kierunkowego, w modelu usług lub warstwie transportowej lub w przypadku nieprawidłowo sformułowanego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="aa50a-179">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>

<span data-ttu-id="aa50a-180">W przypadku źle sformułowanych komunikatów `source` jest równa `Malformed` .</span><span class="sxs-lookup"><span data-stu-id="aa50a-180">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="aa50a-181">W przeciwnym razie źródło ma następujące wartości na podstawie kontekstu.</span><span class="sxs-lookup"><span data-stu-id="aa50a-181">Otherwise, source has the following values based on the context.</span></span>

<span data-ttu-id="aa50a-182">Dla żądania/odpowiedzi</span><span class="sxs-lookup"><span data-stu-id="aa50a-182">For Request/Reply</span></span>

||<span data-ttu-id="aa50a-183">Wyślij żądanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-183">Send Request</span></span>|<span data-ttu-id="aa50a-184">Żądanie odebrania</span><span class="sxs-lookup"><span data-stu-id="aa50a-184">Receive Request</span></span>|<span data-ttu-id="aa50a-185">Wyślij odpowiedź</span><span class="sxs-lookup"><span data-stu-id="aa50a-185">Send Reply</span></span>|<span data-ttu-id="aa50a-186">Odbierz odpowiedź</span><span class="sxs-lookup"><span data-stu-id="aa50a-186">Receive Reply</span></span>|
|-|------------------|---------------------|----------------|-------------------|
|<span data-ttu-id="aa50a-187">Warstwa modelu usług</span><span class="sxs-lookup"><span data-stu-id="aa50a-187">Service Model layer</span></span>|<span data-ttu-id="aa50a-188">Usługa</span><span class="sxs-lookup"><span data-stu-id="aa50a-188">Service</span></span><br /><br /> <span data-ttu-id="aa50a-189">Poziom</span><span class="sxs-lookup"><span data-stu-id="aa50a-189">Level</span></span><br /><br /> <span data-ttu-id="aa50a-190">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-190">Send</span></span><br /><br /> <span data-ttu-id="aa50a-191">Żądanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-191">Request</span></span>|<span data-ttu-id="aa50a-192">Usługa</span><span class="sxs-lookup"><span data-stu-id="aa50a-192">Service</span></span><br /><br /> <span data-ttu-id="aa50a-193">Poziom</span><span class="sxs-lookup"><span data-stu-id="aa50a-193">Level</span></span><br /><br /> <span data-ttu-id="aa50a-194">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="aa50a-194">Receive</span></span><br /><br /> <span data-ttu-id="aa50a-195">Żądanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-195">Request</span></span>|<span data-ttu-id="aa50a-196">Usługa</span><span class="sxs-lookup"><span data-stu-id="aa50a-196">Service</span></span><br /><br /> <span data-ttu-id="aa50a-197">Poziom</span><span class="sxs-lookup"><span data-stu-id="aa50a-197">Level</span></span><br /><br /> <span data-ttu-id="aa50a-198">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-198">Send</span></span><br /><br /> <span data-ttu-id="aa50a-199">Odpowiedz</span><span class="sxs-lookup"><span data-stu-id="aa50a-199">Reply</span></span>|<span data-ttu-id="aa50a-200">Usługa</span><span class="sxs-lookup"><span data-stu-id="aa50a-200">Service</span></span><br /><br /> <span data-ttu-id="aa50a-201">Poziom</span><span class="sxs-lookup"><span data-stu-id="aa50a-201">Level</span></span><br /><br /> <span data-ttu-id="aa50a-202">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="aa50a-202">Receive</span></span><br /><br /> <span data-ttu-id="aa50a-203">Odpowiedz</span><span class="sxs-lookup"><span data-stu-id="aa50a-203">Reply</span></span>|
|<span data-ttu-id="aa50a-204">Warstwa transportu</span><span class="sxs-lookup"><span data-stu-id="aa50a-204">Transport layer</span></span>|<span data-ttu-id="aa50a-205">Transport</span><span class="sxs-lookup"><span data-stu-id="aa50a-205">Transport</span></span><br /><br /> <span data-ttu-id="aa50a-206">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-206">Send</span></span>|<span data-ttu-id="aa50a-207">Transport</span><span class="sxs-lookup"><span data-stu-id="aa50a-207">Transport</span></span><br /><br /> <span data-ttu-id="aa50a-208">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="aa50a-208">Receive</span></span>|<span data-ttu-id="aa50a-209">Transport</span><span class="sxs-lookup"><span data-stu-id="aa50a-209">Transport</span></span><br /><br /> <span data-ttu-id="aa50a-210">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-210">Send</span></span>|<span data-ttu-id="aa50a-211">Transport</span><span class="sxs-lookup"><span data-stu-id="aa50a-211">Transport</span></span><br /><br /> <span data-ttu-id="aa50a-212">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="aa50a-212">Receive</span></span>|

<span data-ttu-id="aa50a-213">Dla żądania jednokierunkowego</span><span class="sxs-lookup"><span data-stu-id="aa50a-213">For One-way Request</span></span>

||<span data-ttu-id="aa50a-214">Wyślij żądanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-214">Send Request</span></span>|<span data-ttu-id="aa50a-215">Żądanie odebrania</span><span class="sxs-lookup"><span data-stu-id="aa50a-215">Receive Request</span></span>|
|-|------------------|---------------------|
|<span data-ttu-id="aa50a-216">Warstwa modelu usług</span><span class="sxs-lookup"><span data-stu-id="aa50a-216">Service Model layer</span></span>|<span data-ttu-id="aa50a-217">Usługa</span><span class="sxs-lookup"><span data-stu-id="aa50a-217">Service</span></span><br /><br /> <span data-ttu-id="aa50a-218">Poziom</span><span class="sxs-lookup"><span data-stu-id="aa50a-218">Level</span></span><br /><br /> <span data-ttu-id="aa50a-219">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-219">Send</span></span><br /><br /> <span data-ttu-id="aa50a-220">Odebran</span><span class="sxs-lookup"><span data-stu-id="aa50a-220">Datagram</span></span>|<span data-ttu-id="aa50a-221">Usługa</span><span class="sxs-lookup"><span data-stu-id="aa50a-221">Service</span></span><br /><br /> <span data-ttu-id="aa50a-222">Poziom</span><span class="sxs-lookup"><span data-stu-id="aa50a-222">Level</span></span><br /><br /> <span data-ttu-id="aa50a-223">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="aa50a-223">Receive</span></span><br /><br /> <span data-ttu-id="aa50a-224">Odebran</span><span class="sxs-lookup"><span data-stu-id="aa50a-224">Datagram</span></span>|
|<span data-ttu-id="aa50a-225">Warstwa transportu</span><span class="sxs-lookup"><span data-stu-id="aa50a-225">Transport layer</span></span>|<span data-ttu-id="aa50a-226">Transport</span><span class="sxs-lookup"><span data-stu-id="aa50a-226">Transport</span></span><br /><br /> <span data-ttu-id="aa50a-227">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="aa50a-227">Send</span></span>|<span data-ttu-id="aa50a-228">Transport</span><span class="sxs-lookup"><span data-stu-id="aa50a-228">Transport</span></span><br /><br /> <span data-ttu-id="aa50a-229">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="aa50a-229">Receive</span></span>|

## <a name="message-filters"></a><span data-ttu-id="aa50a-230">Filtry komunikatów</span><span class="sxs-lookup"><span data-stu-id="aa50a-230">Message Filters</span></span>

<span data-ttu-id="aa50a-231">Filtry komunikatów są zdefiniowane w `messageLogging` elemencie Configuration `diagnostics` sekcji konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-231">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="aa50a-232">Są one stosowane na poziomie usługi i transportu.</span><span class="sxs-lookup"><span data-stu-id="aa50a-232">They are applied at the service and transport level.</span></span> <span data-ttu-id="aa50a-233">Jeśli zdefiniowano co najmniej jeden filtr, rejestrowane są tylko komunikaty zgodne z co najmniej jednym filtrem.</span><span class="sxs-lookup"><span data-stu-id="aa50a-233">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="aa50a-234">Jeśli żaden filtr nie jest zdefiniowany, wszystkie komunikaty są przekazywane.</span><span class="sxs-lookup"><span data-stu-id="aa50a-234">If no filter is defined, all messages pass through.</span></span>

<span data-ttu-id="aa50a-235">Filtry obsługują pełną składnię XPath i są stosowane w kolejności, w której pojawiają się w pliku konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-235">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="aa50a-236">Składnia nieprawidłowego filtru powoduje wyjątek w konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="aa50a-236">A syntactically incorrect filter results in a configuration exception.</span></span>

<span data-ttu-id="aa50a-237">Filtry zapewniają również funkcję bezpieczeństwa przy użyciu `nodeQuota` atrybutu, który ogranicza maksymalną liczbę węzłów w Dom XPath, które można sprawdzić w celu dopasowania do filtru.</span><span class="sxs-lookup"><span data-stu-id="aa50a-237">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>

<span data-ttu-id="aa50a-238">Poniższy przykład pokazuje, jak skonfigurować filtr, który rejestruje tylko wiadomości, które mają sekcję nagłówka SOAP.</span><span class="sxs-lookup"><span data-stu-id="aa50a-238">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>

```xml
<messageLogging logEntireMessage="true"
    logMalformedMessages="true"
    logMessagesAtServiceLevel="true"
    logMessagesAtTransportLevel="true"
    maxMessagesToLog="420">
    <filters>
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
                 /soap:Envelope/soap:Header
        </add>
     </filters>
</messageLogging>
```

<span data-ttu-id="aa50a-239">Nie można zastosować filtrów do treści komunikatu.</span><span class="sxs-lookup"><span data-stu-id="aa50a-239">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="aa50a-240">Filtry, które próbują manipulować treścią wiadomości, są usuwane z listy filtrów.</span><span class="sxs-lookup"><span data-stu-id="aa50a-240">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="aa50a-241">Jest również emitowane zdarzenie wskazujące na to.</span><span class="sxs-lookup"><span data-stu-id="aa50a-241">An event is also emitted that indicates this.</span></span> <span data-ttu-id="aa50a-242">Na przykład następujący filtr zostałby usunięty z tabeli filtrów.</span><span class="sxs-lookup"><span data-stu-id="aa50a-242">For example, the following filter would be removed from the filter table.</span></span>

```xml
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>
```

## <a name="configuring-a-custom-listener"></a><span data-ttu-id="aa50a-243">Konfigurowanie odbiornika niestandardowego</span><span class="sxs-lookup"><span data-stu-id="aa50a-243">Configuring a Custom Listener</span></span>

<span data-ttu-id="aa50a-244">Możesz również skonfigurować odbiornik niestandardowy z dodatkowymi opcjami.</span><span class="sxs-lookup"><span data-stu-id="aa50a-244">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="aa50a-245">Odbiornik niestandardowy może być przydatny do filtrowania elementów samodzielnych specyficznych dla aplikacji z komunikatów przed zarejestrowaniem.</span><span class="sxs-lookup"><span data-stu-id="aa50a-245">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="aa50a-246">Poniższy przykład demonstruje konfigurację odbiorników niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="aa50a-246">The following example demonstrates a custom listener configuration.</span></span>

```xml
<system.diagnostics>
   <sources>
     <source name="System.ServiceModel.MessageLogging">
           <listeners>
             <add name="MyListener"
                    type="YourCustomListener"
                    initializeData="c:\logs\messages.svclog"
                    maxDiskSpace="1000"/>
           </listeners>
     </source>
   </sources>
</system.diagnostics>
```

<span data-ttu-id="aa50a-247">Należy pamiętać, że `type` atrybut powinien być ustawiony na kwalifikowaną nazwę zestawu typu.</span><span class="sxs-lookup"><span data-stu-id="aa50a-247">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>

## <a name="see-also"></a><span data-ttu-id="aa50a-248">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="aa50a-248">See also</span></span>

- [\<messageLogging>](../../configure-apps/file-schema/wcf/messagelogging.md)
- [<span data-ttu-id="aa50a-249">Rejestrowanie komunikatów</span><span class="sxs-lookup"><span data-stu-id="aa50a-249">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="aa50a-250">Zalecane ustawienia śledzenia i rejestrowania komunikatów</span><span class="sxs-lookup"><span data-stu-id="aa50a-250">Recommended Settings for Tracing and Message Logging</span></span>](./tracing/recommended-settings-for-tracing-and-message-logging.md)
