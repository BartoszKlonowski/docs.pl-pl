---
title: Konfigurowanie rejestrowania komunikatów
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: 283f43239d6cf5aea5ea668397a52313ff526e2a
ms.sourcegitcommit: 59e36e65ac81cdd094a5a84617625b2a0ff3506e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/27/2020
ms.locfileid: "80345184"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="48cc2-102">Konfigurowanie rejestrowania komunikatów</span><span class="sxs-lookup"><span data-stu-id="48cc2-102">Configuring Message Logging</span></span>

<span data-ttu-id="48cc2-103">W tym temacie opisano, jak można skonfigurować rejestrowanie wiadomości dla różnych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="48cc2-103">This topic describes how you can configure message logging for different scenarios.</span></span>

## <a name="enabling-message-logging"></a><span data-ttu-id="48cc2-104">Włączanie rejestrowania wiadomości</span><span class="sxs-lookup"><span data-stu-id="48cc2-104">Enabling Message Logging</span></span>

<span data-ttu-id="48cc2-105">Windows Communication Foundation (WCF) domyślnie nie rejestruje komunikatów.</span><span class="sxs-lookup"><span data-stu-id="48cc2-105">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="48cc2-106">Aby aktywować rejestrowanie wiadomości, należy dodać `System.ServiceModel.MessageLogging` odbiornik śledzenia do źródła `<messagelogging>` śledzenia i ustawić atrybuty elementu w pliku konfiguracyjnym.</span><span class="sxs-lookup"><span data-stu-id="48cc2-106">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>

<span data-ttu-id="48cc2-107">W poniższym przykładzie pokazano, jak włączyć rejestrowanie i określić dodatkowe opcje.</span><span class="sxs-lookup"><span data-stu-id="48cc2-107">The following example shows how to enable logging and specify additional options.</span></span>

```xml
<system.diagnostics>
  <sources>
    <source name="System.ServiceModel.MessageLogging">
      <listeners>
         <add name="messages"
              type="System.Diagnostics.XmlWriterTraceListener"
              initializeData="c:\logs\messages.svclog" />
        </listeners>
    </source>
  </sources>
</system.diagnostics>

<system.serviceModel>
  <diagnostics>
    <messageLogging
         logEntireMessage="true"
         logMalformedMessages="false"
         logMessagesAtServiceLevel="true"
         logMessagesAtTransportLevel="false"
         maxMessagesToLog="3000"
         maxSizeOfMessageToLog="2000"/>
  </diagnostics>
</system.serviceModel>
```

<span data-ttu-id="48cc2-108">Aby uzyskać więcej informacji na temat ustawień rejestrowania wiadomości, zobacz [Zalecane ustawienia śledzenia i rejestrowania wiadomości](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="48cc2-108">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>

<span data-ttu-id="48cc2-109">Można użyć `add` do określenia nazwy i typu odbiornika, którego chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="48cc2-109">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="48cc2-110">W przykładowej konfiguracji odbiornik nosi nazwę "wiadomości" i dodaje standardowy`System.Diagnostics.XmlWriterTraceListener`odbiornik śledzenia programu .NET Framework ( ) jako typ do użycia.</span><span class="sxs-lookup"><span data-stu-id="48cc2-110">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="48cc2-111">W przypadku `System.Diagnostics.XmlWriterTraceListener`użycia należy określić lokalizację i nazwę pliku wyjściowego w pliku konfiguracyjnym.</span><span class="sxs-lookup"><span data-stu-id="48cc2-111">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="48cc2-112">Odbywa się to `initializeData` przez ustawienie nazwy pliku dziennika.</span><span class="sxs-lookup"><span data-stu-id="48cc2-112">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="48cc2-113">W przeciwnym razie system zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="48cc2-113">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="48cc2-114">Można również zaimplementować niestandardowy odbiornik, który emituje dzienniki do pliku domyślnego.</span><span class="sxs-lookup"><span data-stu-id="48cc2-114">You can also implement a custom listener that emits logs to a default file.</span></span>

> [!NOTE]
> <span data-ttu-id="48cc2-115">Ponieważ rejestrowanie wiadomości uzyskuje dostęp do miejsca na dysku, należy ograniczyć liczbę wiadomości, które są zapisywane na dysku dla określonej usługi.</span><span class="sxs-lookup"><span data-stu-id="48cc2-115">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="48cc2-116">Po osiągnięciu limitu wiadomości jest produkowany śledzenia na poziomie informacji i wszystkie działania rejestrowania wiadomości zatrzymać.</span><span class="sxs-lookup"><span data-stu-id="48cc2-116">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>

<span data-ttu-id="48cc2-117">Poziom rejestrowania, a także dodatkowe opcje, są omówione w logging level i opcje sekcji.</span><span class="sxs-lookup"><span data-stu-id="48cc2-117">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>

<span data-ttu-id="48cc2-118">Atrybut `switchValue` a jest `source` prawidłowy tylko dla śledzenia.</span><span class="sxs-lookup"><span data-stu-id="48cc2-118">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="48cc2-119">Jeśli określisz `switchValue` atrybut dla `System.ServiceModel.MessageLogging` źródła śledzenia w następujący sposób, nie ma wpływu.</span><span class="sxs-lookup"><span data-stu-id="48cc2-119">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>

```xml
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">
</source>
```

<span data-ttu-id="48cc2-120">Jeśli chcesz wyłączyć źródło śledzenia, należy `logMessagesAtServiceLevel`użyć `logMalformedMessages`, `logMessagesAtTransportLevel` i `messageLogging` atrybuty elementu zamiast.</span><span class="sxs-lookup"><span data-stu-id="48cc2-120">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="48cc2-121">Wszystkie te atrybuty `false`należy ustawić na .</span><span class="sxs-lookup"><span data-stu-id="48cc2-121">You should set all these attributes to `false`.</span></span> <span data-ttu-id="48cc2-122">Można to zrobić za pomocą pliku konfiguracji w poprzednim przykładzie kodu, za pośrednictwem interfejsu użytkownika Edytora konfiguracji lub przy użyciu usługi WMI.</span><span class="sxs-lookup"><span data-stu-id="48cc2-122">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="48cc2-123">Aby uzyskać więcej informacji na temat narzędzia Edytor konfiguracji, zobacz [Narzędzie edytora konfiguracji (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="48cc2-123">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="48cc2-124">Aby uzyskać więcej informacji na temat usługi WMI, zobacz [Korzystanie z instrumentacji zarządzania windowsem dla diagnostyki](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="48cc2-124">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

## <a name="logging-levels-and-options"></a><span data-ttu-id="48cc2-125">Poziomy i opcje rejestrowania</span><span class="sxs-lookup"><span data-stu-id="48cc2-125">Logging Levels and Options</span></span>

<span data-ttu-id="48cc2-126">W przypadku wiadomości przychodzących rejestrowanie odbywa się natychmiast po utworzeniu wiadomości, bezpośrednio przed wiadomości dostaje się do kodu użytkownika na poziomie usługi i po wykryciu nieprawidłowo sformułowanych wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-126">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>

<span data-ttu-id="48cc2-127">W przypadku wiadomości wychodzących rejestrowanie odbywa się natychmiast po opuszczeniu kodu użytkownika i bezpośrednio przed przesłaniem wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-127">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>

<span data-ttu-id="48cc2-128">WCF rejestruje komunikaty na dwóch różnych poziomach, usługi i transportu.</span><span class="sxs-lookup"><span data-stu-id="48cc2-128">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="48cc2-129">Nieprawidłowo sformułowane wiadomości są również rejestrowane.</span><span class="sxs-lookup"><span data-stu-id="48cc2-129">Malformed messages are also logged.</span></span> <span data-ttu-id="48cc2-130">Trzy kategorie są niezależne od siebie i mogą być aktywowane oddzielnie w konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="48cc2-130">The three categories are independent from each other and can be activated separately in configuration.</span></span>

<span data-ttu-id="48cc2-131">Poziom rejestrowania można kontrolować, `logMessagesAtServiceLevel`ustawiając `logMalformedMessages` `logMessagesAtTransportLevel` atrybuty `messageLogging` elementu i atrybuty elementu.</span><span class="sxs-lookup"><span data-stu-id="48cc2-131">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>

### <a name="service-level"></a><span data-ttu-id="48cc2-132">Poziom usług</span><span class="sxs-lookup"><span data-stu-id="48cc2-132">Service Level</span></span>

<span data-ttu-id="48cc2-133">Wiadomości rejestrowane w tej warstwie mają zamiar wprowadzić (po otrzymaniu) lub pozostawić (przy wysyłaniu) kod użytkownika.</span><span class="sxs-lookup"><span data-stu-id="48cc2-133">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="48cc2-134">Jeśli filtry zostały zdefiniowane, rejestrowane są tylko komunikaty pasujące do filtrów.</span><span class="sxs-lookup"><span data-stu-id="48cc2-134">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="48cc2-135">W przeciwnym razie wszystkie komunikaty na poziomie usługi są rejestrowane.</span><span class="sxs-lookup"><span data-stu-id="48cc2-135">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="48cc2-136">Komunikaty infrastruktury (transakcje, kanał równorzędny i zabezpieczenia) są również rejestrowane na tym poziomie, z wyjątkiem komunikatów niezawodnej obsługi wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-136">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="48cc2-137">W wiadomościach przesyłanych strumieniowo rejestrowane są tylko nagłówki.</span><span class="sxs-lookup"><span data-stu-id="48cc2-137">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="48cc2-138">Ponadto bezpieczne wiadomości są rejestrowane odszyfrowywane na tym poziomie.</span><span class="sxs-lookup"><span data-stu-id="48cc2-138">In addition, secure messages are logged decrypted at this level.</span></span>

### <a name="transport-level"></a><span data-ttu-id="48cc2-139">Poziom transportu</span><span class="sxs-lookup"><span data-stu-id="48cc2-139">Transport Level</span></span>

<span data-ttu-id="48cc2-140">Wiadomości rejestrowane w tej warstwie są gotowe do zakodowania lub dekodowania dla lub po transporcie w sieci.</span><span class="sxs-lookup"><span data-stu-id="48cc2-140">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="48cc2-141">Jeśli filtry zostały zdefiniowane, rejestrowane są tylko komunikaty pasujące do filtrów.</span><span class="sxs-lookup"><span data-stu-id="48cc2-141">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="48cc2-142">W przeciwnym razie wszystkie komunikaty w warstwie transportu są rejestrowane.</span><span class="sxs-lookup"><span data-stu-id="48cc2-142">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="48cc2-143">Wszystkie komunikaty infrastruktury są rejestrowane w tej warstwie, w tym wiadomości niezawodne wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-143">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="48cc2-144">W wiadomościach przesyłanych strumieniowo rejestrowane są tylko nagłówki.</span><span class="sxs-lookup"><span data-stu-id="48cc2-144">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="48cc2-145">Ponadto bezpieczne wiadomości są rejestrowane jako zaszyfrowane na tym poziomie, z wyjątkiem, jeśli używany jest bezpieczny transport, taki jak HTTPS.</span><span class="sxs-lookup"><span data-stu-id="48cc2-145">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>

### <a name="malformed-level"></a><span data-ttu-id="48cc2-146">Nieprawidłowo uformowany poziom</span><span class="sxs-lookup"><span data-stu-id="48cc2-146">Malformed Level</span></span>

<span data-ttu-id="48cc2-147">Nieprawidłowo sformułowane wiadomości są wiadomości, które są odrzucane przez stos WCF na dowolnym etapie przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="48cc2-147">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="48cc2-148">Nieprawidłowo sformułowane wiadomości są rejestrowane jako — jest: szyfrowane, jeśli tak jest, z nienaskładanym kodem XML i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="48cc2-148">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> <span data-ttu-id="48cc2-149">`maxSizeOfMessageToLog`zdefiniował rozmiar wiadomości, która ma być zarejestrowana jako CDATA.</span><span class="sxs-lookup"><span data-stu-id="48cc2-149">`maxSizeOfMessageToLog` defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="48cc2-150">Domyślnie `maxSizeOfMessageToLog` jest równa 256K.</span><span class="sxs-lookup"><span data-stu-id="48cc2-150">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="48cc2-151">Aby uzyskać więcej informacji na temat tego atrybutu, zobacz sekcję Inne opcje.</span><span class="sxs-lookup"><span data-stu-id="48cc2-151">For more information about this attribute, see the Other Options section.</span></span>

### <a name="other-options"></a><span data-ttu-id="48cc2-152">Inne opcje</span><span class="sxs-lookup"><span data-stu-id="48cc2-152">Other Options</span></span>

<span data-ttu-id="48cc2-153">Oprócz poziomów rejestrowania użytkownik może określić następujące opcje:</span><span class="sxs-lookup"><span data-stu-id="48cc2-153">In addition to the logging levels, the user can specify the following options:</span></span>

- <span data-ttu-id="48cc2-154">Log Entire`logEntireMessage` Message (atrybut): Ta wartość określa, czy cała wiadomość (nagłówek wiadomości i treść) jest rejestrowana.</span><span class="sxs-lookup"><span data-stu-id="48cc2-154">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="48cc2-155">Wartością domyślną jest `false`, co oznacza, że tylko nagłówek jest rejestrowany.</span><span class="sxs-lookup"><span data-stu-id="48cc2-155">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="48cc2-156">To ustawienie ma wpływ na poziomy rejestrowania komunikatów usługi i transportu..</span><span class="sxs-lookup"><span data-stu-id="48cc2-156">This setting affects service and transport message logging levels..</span></span>

- <span data-ttu-id="48cc2-157">Maksymalna liczba`maxMessagesToLog` komunikatów do zarejestrowania (atrybut): Ta wartość określa maksymalną liczbę wiadomości do zarejestrowania.</span><span class="sxs-lookup"><span data-stu-id="48cc2-157">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="48cc2-158">Wszystkie wiadomości (usługa, transport i nieprawidłowo sformułowane wiadomości) są wliczane do tego przydziału.</span><span class="sxs-lookup"><span data-stu-id="48cc2-158">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="48cc2-159">Po osiągnięciu przydziału jest emitowany śledzenia i nie jest rejestrowany żaden dodatkowy komunikat.</span><span class="sxs-lookup"><span data-stu-id="48cc2-159">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="48cc2-160">Wartość domyślna to 10000.</span><span class="sxs-lookup"><span data-stu-id="48cc2-160">The default value is 10000.</span></span>

- <span data-ttu-id="48cc2-161">Maksymalny rozmiar wiadomości`maxSizeOfMessageToLog` do dziennika (atrybut): Ta wartość określa maksymalny rozmiar wiadomości do logowania bajtów.</span><span class="sxs-lookup"><span data-stu-id="48cc2-161">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="48cc2-162">Komunikaty, które przekraczają limit rozmiaru nie są rejestrowane i nie jest wykonywane żadne inne działanie dla tej wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-162">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="48cc2-163">To ustawienie ma wpływ na wszystkie poziomy śledzenia.</span><span class="sxs-lookup"><span data-stu-id="48cc2-163">This setting affects all trace levels.</span></span> <span data-ttu-id="48cc2-164">Jeśli śledzenie ServiceModel jest włączone, śledzenie poziomu ostrzeżenia jest emitowane w pierwszym punkcie rejestrowania (ServiceModelSend\* lub TransportReceive), aby powiadomić użytkownika.</span><span class="sxs-lookup"><span data-stu-id="48cc2-164">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="48cc2-165">Domyślną wartością komunikatów poziomu usługi i poziomu transportu jest 256K, podczas gdy domyślną wartością dla nieprawidłowo sformułowanych komunikatów jest 4K.</span><span class="sxs-lookup"><span data-stu-id="48cc2-165">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>

  > [!CAUTION]
  > <span data-ttu-id="48cc2-166">Rozmiar wiadomości, który jest obliczany do porównania z `maxSizeOfMessageToLog` jest rozmiar wiadomości w pamięci przed serializacji.</span><span class="sxs-lookup"><span data-stu-id="48cc2-166">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="48cc2-167">Ten rozmiar może się różnić od rzeczywistej długości ciągu wiadomości, który jest rejestrowany, a w wielu przypadkach jest większy niż rzeczywisty rozmiar.</span><span class="sxs-lookup"><span data-stu-id="48cc2-167">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="48cc2-168">W rezultacie wiadomości mogą nie być rejestrowane.</span><span class="sxs-lookup"><span data-stu-id="48cc2-168">As a result, messages may not be logged.</span></span> <span data-ttu-id="48cc2-169">Można uwzględnić ten fakt, `maxSizeOfMessageToLog` określając atrybut jest o 10% większy niż oczekiwany rozmiar wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-169">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="48cc2-170">Ponadto w przypadku rejestrowania nieprawidłowo sformułowanych komunikatów rzeczywiste miejsce na dysku wykorzystywane przez dzienniki komunikatów może `maxSizeOfMessageToLog`być nawet 5 razy większe od rozmiaru wartości określonej przez program .</span><span class="sxs-lookup"><span data-stu-id="48cc2-170">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>

<span data-ttu-id="48cc2-171">Jeśli w pliku konfiguracyjnym nie zdefiniowano żadnego odbiornika śledzenia, nie jest generowane żadne dane wyjściowe rejestrowania niezależnie od określonego poziomu rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="48cc2-171">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>

<span data-ttu-id="48cc2-172">Opcje rejestrowania komunikatów, takie jak atrybuty opisane w tej sekcji, można zmienić w czasie wykonywania przy użyciu instrumentacji zarządzania windowsem (WMI).</span><span class="sxs-lookup"><span data-stu-id="48cc2-172">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="48cc2-173">Można to zrobić, uzyskując dostęp do [wystąpienia AppDomainInfo,](./wmi/appdomaininfo.md) które `LogMessagesAtServiceLevel` `LogMessagesAtTransportLevel`udostępnia `LogMalformedMessages`te właściwości logiczne: , i .</span><span class="sxs-lookup"><span data-stu-id="48cc2-173">This can be done by accessing the [AppDomainInfo](./wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="48cc2-174">W związku z tym jeśli skonfigurujesz odbiornik śledzenia do `false` rejestrowania wiadomości, ale ustaw `true` te opcje w konfiguracji, można później zmienić je na gdy aplikacja jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="48cc2-174">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="48cc2-175">To skutecznie umożliwia rejestrowanie wiadomości w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="48cc2-175">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="48cc2-176">Podobnie po włączeniu rejestrowania wiadomości w pliku konfiguracji, można go wyłączyć w czasie wykonywania przy użyciu usługi WMI.</span><span class="sxs-lookup"><span data-stu-id="48cc2-176">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="48cc2-177">Aby uzyskać więcej informacji, zobacz [Korzystanie z instrumentacji zarządzania windowsem dla diagnostyki](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="48cc2-177">For more information, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

<span data-ttu-id="48cc2-178">Pole `source` w dzienniku wiadomości określa, w którym kontekście wiadomość jest rejestrowana: podczas wysyłania/odbierania wiadomości żądania, dla żądania odpowiedzi lub żądania 1-drogowego, w modelu usługi lub warstwy transportu lub w przypadku nieprawidłowo sformułowanej wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-178">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>

<span data-ttu-id="48cc2-179">W przypadku nieprawidłowo `source` sformułowanych `Malformed`wiadomości jest równa .</span><span class="sxs-lookup"><span data-stu-id="48cc2-179">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="48cc2-180">W przeciwnym razie źródło ma następujące wartości na podstawie kontekstu.</span><span class="sxs-lookup"><span data-stu-id="48cc2-180">Otherwise, source has the following values based on the context.</span></span>

<span data-ttu-id="48cc2-181">Na wniosek/odpowiedź</span><span class="sxs-lookup"><span data-stu-id="48cc2-181">For Request/Reply</span></span>

||<span data-ttu-id="48cc2-182">Wyślij żądanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-182">Send Request</span></span>|<span data-ttu-id="48cc2-183">Otrzymaj żądanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-183">Receive Request</span></span>|<span data-ttu-id="48cc2-184">Wyślij odpowiedź</span><span class="sxs-lookup"><span data-stu-id="48cc2-184">Send Reply</span></span>|<span data-ttu-id="48cc2-185">Odbierz odpowiedź</span><span class="sxs-lookup"><span data-stu-id="48cc2-185">Receive Reply</span></span>|
|-|------------------|---------------------|----------------|-------------------|
|<span data-ttu-id="48cc2-186">Warstwa modelu usługi</span><span class="sxs-lookup"><span data-stu-id="48cc2-186">Service Model layer</span></span>|<span data-ttu-id="48cc2-187">Usługa</span><span class="sxs-lookup"><span data-stu-id="48cc2-187">Service</span></span><br /><br /> <span data-ttu-id="48cc2-188">Poziom</span><span class="sxs-lookup"><span data-stu-id="48cc2-188">Level</span></span><br /><br /> <span data-ttu-id="48cc2-189">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-189">Send</span></span><br /><br /> <span data-ttu-id="48cc2-190">Żądanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-190">Request</span></span>|<span data-ttu-id="48cc2-191">Usługa</span><span class="sxs-lookup"><span data-stu-id="48cc2-191">Service</span></span><br /><br /> <span data-ttu-id="48cc2-192">Poziom</span><span class="sxs-lookup"><span data-stu-id="48cc2-192">Level</span></span><br /><br /> <span data-ttu-id="48cc2-193">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="48cc2-193">Receive</span></span><br /><br /> <span data-ttu-id="48cc2-194">Żądanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-194">Request</span></span>|<span data-ttu-id="48cc2-195">Usługa</span><span class="sxs-lookup"><span data-stu-id="48cc2-195">Service</span></span><br /><br /> <span data-ttu-id="48cc2-196">Poziom</span><span class="sxs-lookup"><span data-stu-id="48cc2-196">Level</span></span><br /><br /> <span data-ttu-id="48cc2-197">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-197">Send</span></span><br /><br /> <span data-ttu-id="48cc2-198">Odpowiedz</span><span class="sxs-lookup"><span data-stu-id="48cc2-198">Reply</span></span>|<span data-ttu-id="48cc2-199">Usługa</span><span class="sxs-lookup"><span data-stu-id="48cc2-199">Service</span></span><br /><br /> <span data-ttu-id="48cc2-200">Poziom</span><span class="sxs-lookup"><span data-stu-id="48cc2-200">Level</span></span><br /><br /> <span data-ttu-id="48cc2-201">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="48cc2-201">Receive</span></span><br /><br /> <span data-ttu-id="48cc2-202">Odpowiedz</span><span class="sxs-lookup"><span data-stu-id="48cc2-202">Reply</span></span>|
|<span data-ttu-id="48cc2-203">Warstwa transportowa</span><span class="sxs-lookup"><span data-stu-id="48cc2-203">Transport layer</span></span>|<span data-ttu-id="48cc2-204">Transport</span><span class="sxs-lookup"><span data-stu-id="48cc2-204">Transport</span></span><br /><br /> <span data-ttu-id="48cc2-205">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-205">Send</span></span>|<span data-ttu-id="48cc2-206">Transport</span><span class="sxs-lookup"><span data-stu-id="48cc2-206">Transport</span></span><br /><br /> <span data-ttu-id="48cc2-207">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="48cc2-207">Receive</span></span>|<span data-ttu-id="48cc2-208">Transport</span><span class="sxs-lookup"><span data-stu-id="48cc2-208">Transport</span></span><br /><br /> <span data-ttu-id="48cc2-209">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-209">Send</span></span>|<span data-ttu-id="48cc2-210">Transport</span><span class="sxs-lookup"><span data-stu-id="48cc2-210">Transport</span></span><br /><br /> <span data-ttu-id="48cc2-211">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="48cc2-211">Receive</span></span>|

<span data-ttu-id="48cc2-212">Dla żądania jednokierunkowego</span><span class="sxs-lookup"><span data-stu-id="48cc2-212">For One-way Request</span></span>

||<span data-ttu-id="48cc2-213">Wyślij żądanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-213">Send Request</span></span>|<span data-ttu-id="48cc2-214">Otrzymaj żądanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-214">Receive Request</span></span>|
|-|------------------|---------------------|
|<span data-ttu-id="48cc2-215">Warstwa modelu usługi</span><span class="sxs-lookup"><span data-stu-id="48cc2-215">Service Model layer</span></span>|<span data-ttu-id="48cc2-216">Usługa</span><span class="sxs-lookup"><span data-stu-id="48cc2-216">Service</span></span><br /><br /> <span data-ttu-id="48cc2-217">Poziom</span><span class="sxs-lookup"><span data-stu-id="48cc2-217">Level</span></span><br /><br /> <span data-ttu-id="48cc2-218">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-218">Send</span></span><br /><br /> <span data-ttu-id="48cc2-219">Datagram</span><span class="sxs-lookup"><span data-stu-id="48cc2-219">Datagram</span></span>|<span data-ttu-id="48cc2-220">Usługa</span><span class="sxs-lookup"><span data-stu-id="48cc2-220">Service</span></span><br /><br /> <span data-ttu-id="48cc2-221">Poziom</span><span class="sxs-lookup"><span data-stu-id="48cc2-221">Level</span></span><br /><br /> <span data-ttu-id="48cc2-222">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="48cc2-222">Receive</span></span><br /><br /> <span data-ttu-id="48cc2-223">Datagram</span><span class="sxs-lookup"><span data-stu-id="48cc2-223">Datagram</span></span>|
|<span data-ttu-id="48cc2-224">Warstwa transportowa</span><span class="sxs-lookup"><span data-stu-id="48cc2-224">Transport layer</span></span>|<span data-ttu-id="48cc2-225">Transport</span><span class="sxs-lookup"><span data-stu-id="48cc2-225">Transport</span></span><br /><br /> <span data-ttu-id="48cc2-226">Wysyłanie</span><span class="sxs-lookup"><span data-stu-id="48cc2-226">Send</span></span>|<span data-ttu-id="48cc2-227">Transport</span><span class="sxs-lookup"><span data-stu-id="48cc2-227">Transport</span></span><br /><br /> <span data-ttu-id="48cc2-228">Odbieranie</span><span class="sxs-lookup"><span data-stu-id="48cc2-228">Receive</span></span>|

## <a name="message-filters"></a><span data-ttu-id="48cc2-229">Filtry komunikatów</span><span class="sxs-lookup"><span data-stu-id="48cc2-229">Message Filters</span></span>

<span data-ttu-id="48cc2-230">Filtry komunikatów są `messageLogging` definiowane `diagnostics` w elemencie konfiguracji sekcji konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="48cc2-230">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="48cc2-231">Są one stosowane na poziomie usług i transportu.</span><span class="sxs-lookup"><span data-stu-id="48cc2-231">They are applied at the service and transport level.</span></span> <span data-ttu-id="48cc2-232">Gdy zdefiniowano jeden lub więcej filtrów, rejestrowane są tylko komunikaty, które pasują do co najmniej jednego z filtrów.</span><span class="sxs-lookup"><span data-stu-id="48cc2-232">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="48cc2-233">Jeśli żaden filtr nie jest zdefiniowany, wszystkie komunikaty przechodzą przez.</span><span class="sxs-lookup"><span data-stu-id="48cc2-233">If no filter is defined, all messages pass through.</span></span>

<span data-ttu-id="48cc2-234">Filtry obsługują pełną składnię XPath i są stosowane w kolejności, w jakiej pojawiają się w pliku konfiguracyjnym.</span><span class="sxs-lookup"><span data-stu-id="48cc2-234">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="48cc2-235">Niepoprawny syntaktycznie filtr powoduje wyjątek konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="48cc2-235">A syntactically incorrect filter results in a configuration exception.</span></span>

<span data-ttu-id="48cc2-236">Filtry zapewniają również funkcję `nodeQuota` bezpieczeństwa przy użyciu atrybutu, który ogranicza maksymalną liczbę węzłów w XPath DOM, które mogą być badane w celu dopasowania filtru.</span><span class="sxs-lookup"><span data-stu-id="48cc2-236">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>

<span data-ttu-id="48cc2-237">W poniższym przykładzie pokazano, jak skonfigurować filtr, który rejestruje tylko wiadomości, które mają sekcję nagłówka PROTOKOŁU SOAP.</span><span class="sxs-lookup"><span data-stu-id="48cc2-237">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>

```xml
<messageLogging logEntireMessage="true"
    logMalformedMessages="true"
    logMessagesAtServiceLevel="true"
    logMessagesAtTransportLevel="true"
    maxMessagesToLog="420">
    <filters>
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
                 /soap:Envelope/soap:Header
        </add>
     </filters>
</messageLogging>
```

<span data-ttu-id="48cc2-238">Filtrów nie można zastosować do treści wiadomości.</span><span class="sxs-lookup"><span data-stu-id="48cc2-238">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="48cc2-239">Filtry, które próbują manipulować treścią wiadomości, są usuwane z listy filtrów.</span><span class="sxs-lookup"><span data-stu-id="48cc2-239">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="48cc2-240">Emitowane jest również zdarzenie, które wskazuje to.</span><span class="sxs-lookup"><span data-stu-id="48cc2-240">An event is also emitted that indicates this.</span></span> <span data-ttu-id="48cc2-241">Na przykład następujący filtr zostanie usunięty z tabeli filtrów.</span><span class="sxs-lookup"><span data-stu-id="48cc2-241">For example, the following filter would be removed from the filter table.</span></span>

```xml
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>
```

## <a name="configuring-a-custom-listener"></a><span data-ttu-id="48cc2-242">Konfigurowanie odbiornika niestandardowego</span><span class="sxs-lookup"><span data-stu-id="48cc2-242">Configuring a Custom Listener</span></span>

<span data-ttu-id="48cc2-243">Można również skonfigurować odbiornik niestandardowy z dodatkowymi opcjami.</span><span class="sxs-lookup"><span data-stu-id="48cc2-243">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="48cc2-244">Niestandardowy odbiornik może być przydatne w filtrowaniu elementów pii specyficzne dla aplikacji z wiadomości przed rejestrowaniem.</span><span class="sxs-lookup"><span data-stu-id="48cc2-244">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="48cc2-245">W poniższym przykładzie przedstawiono niestandardową konfigurację odbiornika.</span><span class="sxs-lookup"><span data-stu-id="48cc2-245">The following example demonstrates a custom listener configuration.</span></span>

```xml
<system.diagnostics>
   <sources>
     <source name="System.ServiceModel.MessageLogging">
           <listeners>
             <add name="MyListener"
                    type="YourCustomListener"
                    initializeData="c:\logs\messages.svclog"
                    maxDiskSpace="1000"/>
           </listeners>
     </source>
   </sources>
</system.diagnostics>
```

<span data-ttu-id="48cc2-246">Należy pamiętać, że `type` atrybut powinien być ustawiony na nazwę zestawu kwalifikowanego typu.</span><span class="sxs-lookup"><span data-stu-id="48cc2-246">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>

## <a name="see-also"></a><span data-ttu-id="48cc2-247">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="48cc2-247">See also</span></span>

- [<span data-ttu-id="48cc2-248">\<>rejestrowania wiadomości</span><span class="sxs-lookup"><span data-stu-id="48cc2-248">\<messageLogging></span></span>](../../configure-apps/file-schema/wcf/messagelogging.md)
- [<span data-ttu-id="48cc2-249">Rejestrowanie komunikatów</span><span class="sxs-lookup"><span data-stu-id="48cc2-249">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="48cc2-250">Zalecane ustawienia śledzenia i rejestrowania komunikatów</span><span class="sxs-lookup"><span data-stu-id="48cc2-250">Recommended Settings for Tracing and Message Logging</span></span>](./tracing/recommended-settings-for-tracing-and-message-logging.md)
