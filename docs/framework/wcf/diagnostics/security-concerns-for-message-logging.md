---
title: Uwagi dotyczące zabezpieczeń rejestrowania komunikatów
ms.date: 03/30/2017
ms.assetid: 21f513f2-815b-47f3-85a6-03c008510038
ms.openlocfilehash: c5db9fbf0dfb91ecb903660ebfb42c33f55b27bc
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/22/2019
ms.locfileid: "69933613"
---
# <a name="security-concerns-for-message-logging"></a><span data-ttu-id="ecb8b-102">Uwagi dotyczące zabezpieczeń rejestrowania komunikatów</span><span class="sxs-lookup"><span data-stu-id="ecb8b-102">Security Concerns for Message Logging</span></span>
<span data-ttu-id="ecb8b-103">W tym temacie opisano, jak można chronić poufne dane przed ujawnieniem w dziennikach komunikatów, a także zdarzenia generowane przez funkcję rejestrowania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-103">This topic describes how you can protect sensitive data from being exposed in message logs, as well as events generated by message logging.</span></span>  
  
## <a name="security-concerns"></a><span data-ttu-id="ecb8b-104">Zagadnienia dotyczące zabezpieczeń</span><span class="sxs-lookup"><span data-stu-id="ecb8b-104">Security Concerns</span></span>  
  
### <a name="logging-sensitive-information"></a><span data-ttu-id="ecb8b-105">Rejestrowanie poufnych informacji</span><span class="sxs-lookup"><span data-stu-id="ecb8b-105">Logging Sensitive Information</span></span>  
 <span data-ttu-id="ecb8b-106">Windows Communication Foundation (WCF) nie modyfikuje żadnych danych w nagłówkach i treści specyficznych dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-106">Windows Communication Foundation (WCF) does not modify any data in application-specific headers and body.</span></span> <span data-ttu-id="ecb8b-107">Funkcja WCF nie śledzi również informacji osobistych w nagłówkach lub danych treści specyficznych dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-107">WCF also does not track personal information in application-specific headers or body data.</span></span>  
  
 <span data-ttu-id="ecb8b-108">Po włączeniu rejestrowania komunikatów informacje osobiste w nagłówkach specyficznych dla aplikacji, takie jak ciąg zapytania; i informacje o treści, takie jak numer karty kredytowej, mogą stać się widoczne w dziennikach.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-108">When message logging is enabled, personal information in application-specific headers, such as, a query string; and body information, such as, a credit card number, can become visible in the logs.</span></span> <span data-ttu-id="ecb8b-109">Narzędzie wdrażania aplikacji jest odpowiedzialne za wymuszanie kontroli dostępu do plików konfiguracyjnych i dzienników.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-109">The application deployer is responsible for enforcing access control on the configuration and log files.</span></span> <span data-ttu-id="ecb8b-110">Jeśli nie chcesz, aby ten rodzaj informacji był widoczny, należy wyłączyć rejestrowanie lub przefiltrować część danych, jeśli chcesz udostępnić dzienniki.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-110">If you do not want this kind of information to be visible, you should disable logging, or filter out part of the data if you want to share the logs.</span></span>  
  
 <span data-ttu-id="ecb8b-111">Poniższe porady mogą pomóc zapobiec przypadkowemu ujawnieniu zawartości pliku dziennika:</span><span class="sxs-lookup"><span data-stu-id="ecb8b-111">The following tips can help you to prevent the content of a log file from being exposed unintentionally:</span></span>  
  
- <span data-ttu-id="ecb8b-112">Upewnij się, że pliki dziennika są chronione za pomocą list Access Control (ACL) zarówno w scenariuszach hosta sieci Web, jak i z dowolnego hosta.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-112">Ensure that the log files are protected by Access Control Lists (ACL) both in Web-host and self-host scenarios.</span></span>  
  
- <span data-ttu-id="ecb8b-113">Wybierz rozszerzenie pliku, którego nie można łatwo obsłużyć przy użyciu żądania sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-113">Choose a file extension that cannot be easily served using a Web request.</span></span> <span data-ttu-id="ecb8b-114">Na przykład rozszerzenie pliku XML nie jest bezpiecznym wyborem.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-114">For example, the .xml file extension is not a safe choice.</span></span> <span data-ttu-id="ecb8b-115">Aby wyświetlić listę rozszerzeń, które mogą być obsługiwane, można sprawdzić Przewodnik administrowania Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="ecb8b-115">You can check the Internet Information Services (IIS) administration guide to see a list of extensions that can be served.</span></span>  
  
- <span data-ttu-id="ecb8b-116">Określ ścieżkę bezwzględną dla lokalizacji pliku dziennika, która powinna znajdować się poza katalogiem publicznym wirtualnego katalogu głównego hosta sieci Web, aby uniemożliwić dostęp do niej przez stronę zewnętrzną przy użyciu przeglądarki sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-116">Specify an absolute path for the log file location, which should be outside of the Web host vroot public directory to prevent it from being accessed by an external party using a Web browser.</span></span>  
  
 <span data-ttu-id="ecb8b-117">Domyślnie klucze i dane osobowe, takie jak nazwa użytkownika i hasło, nie są rejestrowane w śladach i zarejestrowanych komunikatach.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-117">By default, keys and personally identifiable information (PII) such as username and password are not logged in traces and logged messages.</span></span> <span data-ttu-id="ecb8b-118">Administrator komputera może jednak użyć `enableLoggingKnownPII` atrybutu `machineSettings` w pliku Machine. config, aby zezwolić aplikacjom działającym na maszynie na rejestrowanie znanych informacji osobistych.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-118">A machine administrator, however, can use the `enableLoggingKnownPII` attribute in the `machineSettings` element of the Machine.config file to permit applications running on the machine to log known personally identifiable information (PII).</span></span> <span data-ttu-id="ecb8b-119">W poniższej konfiguracji pokazano, jak to zrobić:</span><span class="sxs-lookup"><span data-stu-id="ecb8b-119">The following configuration demonstrates how to do this:</span></span>  
  
```xml  
<configuration>  
   <system.serviceModel>  
      <machineSettings enableLoggingKnownPii="true"/>  
   </system.serviceModel>  
</configuration>   
```  
  
 <span data-ttu-id="ecb8b-120">Narzędzie do wdrażania aplikacji może następnie użyć `logKnownPii` atrybutu w pliku App. config lub Web. config, aby umożliwić logowanie do Internetu w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="ecb8b-120">An application deployer can then use the `logKnownPii` attribute in either the App.config or Web.config file to enable PII logging as follows:</span></span>  
  
```xml  
<system.diagnostics>  
  <sources>  
      <source name="System.ServiceModel.MessageLogging"  
        logKnownPii="true">  
        <listeners>  
                 <add name="messages"  
                 type="System.Diagnostics.XmlWriterTraceListener"  
                 initializeData="c:\logs\messages.svclog" />  
          </listeners>  
      </source>  
    </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="ecb8b-121">Tylko wtedy, gdy oba `true` ustawienia są włączone do rejestrowania przez dane osobowe.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-121">Only when both settings are `true` is PII logging enabled.</span></span> <span data-ttu-id="ecb8b-122">Kombinacja dwóch przełączników pozwala elastycznie rejestrować znane dane OSOBowe dla każdej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-122">The combination of two switches allows the flexibility to log known PII for each application.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="ecb8b-123">[!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] `true` We flagach `logKnownPii` `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`i należy również ustawić w pliku Web. config lub pliku App. config, aby umożliwić rejestrowanie danych osobowych, jak pokazano w poniższym przykładzie. `logEntireMessage`</span><span class="sxs-lookup"><span data-stu-id="ecb8b-123">In [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] the `logEntireMessage` and `logKnownPii` flags must also be set to `true` in the Web.config file or the App.config file to enable PII logging, as show in the following example `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`.</span></span>  
  
 <span data-ttu-id="ecb8b-124">Należy pamiętać, że w przypadku określenia co najmniej dwóch źródeł niestandardowych w pliku konfiguracyjnym odczytywane są tylko atrybuty pierwszego źródła.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-124">You should be aware that if you specify two or more custom sources in a configuration file, only the attributes of the first source are read.</span></span> <span data-ttu-id="ecb8b-125">Pozostałe są ignorowane.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-125">The others are ignored.</span></span> <span data-ttu-id="ecb8b-126">Oznacza to, że w przypadku następującego pliku App. config plik, dane OSOBowe nie są rejestrowane dla obu źródeł, nawet gdy rejestrowanie danych osobowych jest jawnie włączone dla drugiego źródła.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-126">This means that, for the following App.config, file, PII is not logged for both sources even though PII logging is explicitly enabled for the second source.</span></span>  
  
```xml  
<system.diagnostics>  
   <sources>  
      <source name="System.ServiceModel.MessageLogging"  
              logKnownPii="false">  
              <listeners>  
                 <add name="messages"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\messages.svclog" />  
              </listeners>  
            </source>  
      <source name="System.ServiceModel"   
              logKnownPii="true">  
              <listeners>  
                 <add name="traces"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\traces.svclog" />  
              </listeners>  
      </source>  
   </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="ecb8b-127">Jeśli element istnieje poza plikiem Machine. config, system <xref:System.Configuration.ConfigurationErrorsException>zgłasza. `<machineSettings enableLoggingKnownPii="Boolean"/>`</span><span class="sxs-lookup"><span data-stu-id="ecb8b-127">If the `<machineSettings enableLoggingKnownPii="Boolean"/>` element exists outside the Machine.config file, the system throws a <xref:System.Configuration.ConfigurationErrorsException>.</span></span>  
  
 <span data-ttu-id="ecb8b-128">Zmiany są skuteczne tylko wtedy, gdy aplikacja jest uruchamiana lub uruchamiana ponownie.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-128">The changes are effective only when the application starts or restarts.</span></span> <span data-ttu-id="ecb8b-129">Zdarzenie jest rejestrowane przy uruchamianiu, gdy oba atrybuty są ustawione `true`na.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-129">An event is logged at startup when both attributes are set to `true`.</span></span> <span data-ttu-id="ecb8b-130">Zdarzenie jest rejestrowane również wtedy, `logKnownPii` gdy jest ustawione `true` na `enableLoggingKnownPii` , `false`ale jest.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-130">An event is also logged if `logKnownPii` is set to `true` but `enableLoggingKnownPii` is `false`.</span></span>  
  
 <span data-ttu-id="ecb8b-131">W przypadku korzystania z tych dwóch przełączników administrator komputera i narzędzie wdrażania aplikacji powinny mieć wyjątkową ostrożność.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-131">The machine administrator and application deployer should exercise extreme caution when using these two switches.</span></span> <span data-ttu-id="ecb8b-132">W przypadku włączenia rejestrowania przez dane OSOBowe są rejestrowane klucze zabezpieczeń i dane OSOBowe.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-132">If PII logging is enabled, security keys and PII are logged.</span></span> <span data-ttu-id="ecb8b-133">Jeśli jest wyłączona, poufne i specyficzne dla aplikacji dane są nadal rejestrowane w nagłówkach i treściach komunikatów.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-133">If it is disabled, sensitive and application-specific data is still logged in message headers and bodies.</span></span> <span data-ttu-id="ecb8b-134">Bardziej szczegółowe omówienie ochrony prywatności i ochrony danych osobowych przed ujawnieniem można znaleźć w temacie [prywatność użytkowników](https://go.microsoft.com/fwlink/?LinkID=94647).</span><span class="sxs-lookup"><span data-stu-id="ecb8b-134">For a more thorough discussion about privacy and protecting PII from being exposed, see [User Privacy](https://go.microsoft.com/fwlink/?LinkID=94647).</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="ecb8b-135">Dane OSOBowe nie są ukryte w źle sformułowanych wiadomościach.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-135">PII is not hidden in malformed messages.</span></span> <span data-ttu-id="ecb8b-136">Takie komunikaty są rejestrowane bez żadnych modyfikacji.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-136">Such messaged are logged as-is without any modification.</span></span> <span data-ttu-id="ecb8b-137">Opisane wcześniej atrybuty nie mają wpływu na to.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-137">Attributes mentioned previously have no effect on this.</span></span>  
  
### <a name="custom-trace-listener"></a><span data-ttu-id="ecb8b-138">Odbiornik śledzenia niestandardowego</span><span class="sxs-lookup"><span data-stu-id="ecb8b-138">Custom Trace Listener</span></span>  
 <span data-ttu-id="ecb8b-139">Dodawanie niestandardowego odbiornika śledzenia do źródła śledzenia rejestrowania komunikatów jest uprawnieniem, które powinno być ograniczone do administratora.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-139">Adding a custom trace listener on the Message Logging trace source is a privilege that should be restricted to the administrator.</span></span> <span data-ttu-id="ecb8b-140">Jest to spowodowane tym, że złośliwe niestandardowe odbiorniki można skonfigurować do zdalnego wysyłania wiadomości, co prowadzi do ujawnienia poufnych informacji.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-140">This is because malicious custom listeners can be configured to send messages remotely, which leads to sensitive information disclosure.</span></span> <span data-ttu-id="ecb8b-141">Ponadto, jeśli skonfigurujesz odbiornik niestandardowy do wysyłania komunikatów do sieci, takich jak, do zdalnej bazy danych, należy wymusić odpowiednią kontrolę dostępu do dzienników komunikatów na komputerze zdalnym.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-141">In addition, if you configure a custom listener to send messages on the wire, such as, to a remote database, you should enforce proper access control on the message logs in the remote machine.</span></span>  
  
## <a name="events-triggered-by-message-logging"></a><span data-ttu-id="ecb8b-142">Zdarzenia wyzwalane przez rejestrowanie komunikatów</span><span class="sxs-lookup"><span data-stu-id="ecb8b-142">Events Triggered by Message Logging</span></span>  
 <span data-ttu-id="ecb8b-143">Poniżej wymieniono wszystkie zdarzenia emitowane przez funkcję rejestrowania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-143">The following lists all the events emitted by message logging.</span></span>  
  
- <span data-ttu-id="ecb8b-144">Rejestrowanie komunikatów: To zdarzenie jest emitowane, gdy rejestrowanie komunikatów jest włączone w konfiguracji lub za pomocą usługi WMI.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-144">Message logging on: This event is emitted when message logging is enabled in configuration, or through WMI.</span></span> <span data-ttu-id="ecb8b-145">Zawartość zdarzenia to "rejestrowanie komunikatów zostało włączone.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-145">The content of the event is "Message logging has been turned on.</span></span> <span data-ttu-id="ecb8b-146">Poufne informacje mogą być rejestrowane w postaci zwykłego tekstu, nawet jeśli zostały zaszyfrowane w sieci, na przykład treści wiadomości ".</span><span class="sxs-lookup"><span data-stu-id="ecb8b-146">Sensitive information may be logged in clear text, even if they were encrypted on the wire, for example, message bodies."</span></span>  
  
- <span data-ttu-id="ecb8b-147">Wylogowanie komunikatu: To zdarzenie jest emitowane, gdy rejestrowanie komunikatów jest wyłączone za pomocą usługi WMI.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-147">Message logging off: This event is emitted when message logging is disabled through WMI.</span></span> <span data-ttu-id="ecb8b-148">Zawartość zdarzenia to "rejestrowanie komunikatów zostało wyłączone".</span><span class="sxs-lookup"><span data-stu-id="ecb8b-148">The content of the event is "Message logging has been turned off."</span></span>  
  
- <span data-ttu-id="ecb8b-149">Rejestruj znane dane OSOBowe na: To zdarzenie jest emitowane, gdy jest włączone rejestrowanie znanego elementu dane OSOBowe.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-149">Log Known PII On: This event is emitted when logging of known PII is enabled.</span></span> <span data-ttu-id="ecb8b-150">Dzieje się tak, `enableLoggingKnownPii` gdy atrybut `machineSettings` w elemencie pliku Machine. config jest `logKnownPii` ustawiony na `true`, a atrybut `source` elementu w pliku App. config lub Web. config jest ustawiony na `true`.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-150">This happens when the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `true`, and the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`.</span></span>  
  
- <span data-ttu-id="ecb8b-151">Znane dane OSOBowe nie są dozwolone w dzienniku: To zdarzenie jest emitowane, gdy rejestrowanie znanego elementu dane OSOBowe jest niedozwolone.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-151">Log Known PII Not Allowed: This event is emitted when logging of known PII is not allowed.</span></span> <span data-ttu-id="ecb8b-152">Dzieje się tak, `logKnownPii` gdy atrybut `source` elementu w pliku App. config lub Web. config jest `enableLoggingKnownPii` ustawiony na `true`, ale atrybut w `machineSettings` elemencie Machine. config jest ustawiony na `false`.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-152">This happens when the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`, but the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `false`.</span></span> <span data-ttu-id="ecb8b-153">Nie zgłoszono żadnego wyjątku.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-153">No exception is thrown.</span></span>  
  
 <span data-ttu-id="ecb8b-154">Te zdarzenia można wyświetlać w narzędziu Podgląd zdarzeń, które są dostarczane z systemem Windows.</span><span class="sxs-lookup"><span data-stu-id="ecb8b-154">These events can be viewed in the Event Viewer tool that comes with Windows.</span></span> <span data-ttu-id="ecb8b-155">Aby uzyskać więcej informacji na ten temat, zobacz [Rejestrowanie zdarzeń](../../../../docs/framework/wcf/diagnostics/event-logging/index.md).</span><span class="sxs-lookup"><span data-stu-id="ecb8b-155">For more information on this, see [Event Logging](../../../../docs/framework/wcf/diagnostics/event-logging/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ecb8b-156">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="ecb8b-156">See also</span></span>

- [<span data-ttu-id="ecb8b-157">Rejestrowanie komunikatów</span><span class="sxs-lookup"><span data-stu-id="ecb8b-157">Message Logging</span></span>](../../../../docs/framework/wcf/diagnostics/message-logging.md)
- [<span data-ttu-id="ecb8b-158">Problemy dotyczące zabezpieczeń i przydatne porady na temat śledzenia</span><span class="sxs-lookup"><span data-stu-id="ecb8b-158">Security Concerns and Useful Tips for Tracing</span></span>](../../../../docs/framework/wcf/diagnostics/tracing/security-concerns-and-useful-tips-for-tracing.md)
