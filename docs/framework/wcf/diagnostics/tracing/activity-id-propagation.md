---
title: Propagacja identyfikatora działania
ms.date: 03/30/2017
ms.assetid: cd1c1ae5-cc8a-4f51-90c9-f7b476bcfe70
ms.openlocfilehash: 0f0478b16bf2ca0975ae0290a8855756ecfc383e
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/26/2020
ms.locfileid: "96236107"
---
# <a name="activity-id-propagation"></a><span data-ttu-id="e1fb6-102">Propagacja identyfikatora działania</span><span class="sxs-lookup"><span data-stu-id="e1fb6-102">Activity ID Propagation</span></span>

<span data-ttu-id="e1fb6-103">Propagacja jest wykonywana, gdy włączone jest śledzenie aktywności ServiceModel (Propagacja elementu ServiceModel) lub wyłączone (Propagacja działań użytkownika do użytkownika).</span><span class="sxs-lookup"><span data-stu-id="e1fb6-103">Propagation happens when ServiceModel activity tracing is enabled (ServiceModel propagation) or disabled (User-to-User activity propagation).</span></span>  
  
## <a name="servicemodel-activity-tracing-is-enabled"></a><span data-ttu-id="e1fb6-104">Śledzenie działań ServiceModel jest włączone</span><span class="sxs-lookup"><span data-stu-id="e1fb6-104">ServiceModel Activity Tracing is Enabled</span></span>  

 <span data-ttu-id="e1fb6-105">Jeśli ServiceModel ActivityTracing jest włączony, Propagacja odbywa się między działaniami ProcessAction.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-105">If ServiceModel ActivityTracing is enabled, propagation happens between ProcessAction activities.</span></span>  
  
### <a name="server"></a><span data-ttu-id="e1fb6-106">Serwer</span><span class="sxs-lookup"><span data-stu-id="e1fb6-106">Server</span></span>  

 <span data-ttu-id="e1fb6-107">Gdy `propagateActivity` atrybut jest ustawiony na `true` zarówno na kliencie, jak i na serwerze, identyfikator `ProcessAction` działania na serwerze jest IDENTYCZNy z identyfikatorem w `ActivityId` nagłówku propagowanych komunikatów.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-107">When the `propagateActivity` attribute is set to `true` on both the client and server, the ID of the `ProcessAction` activity in the server is identical to the ID in the propagated `ActivityId` message header.</span></span>  
  
 <span data-ttu-id="e1fb6-108">Gdy `ActivityId` w komunikacie nie występuje nagłówek (czyli `propagateActivity` = `false` na kliencie) lub `propagateActivity` = `false` na serwerze, serwer generuje nowy identyfikator działania.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-108">When no `ActivityId` header is present in the message (that is, `propagateActivity`=`false` on the client), or when `propagateActivity`=`false` on the server, the server generates a new activity ID.</span></span>  
  
### <a name="client"></a><span data-ttu-id="e1fb6-109">Klient</span><span class="sxs-lookup"><span data-stu-id="e1fb6-109">Client</span></span>  

 <span data-ttu-id="e1fb6-110">Jeśli klient jest synchronicznie pojedynczym wątkiem, klient nie uwzględnia żadnych ustawień `propagateActivity` na kliencie lub serwerze.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-110">If the client is synchronously single threaded, the client disregards any settings of `propagateActivity` at the client or server.</span></span> <span data-ttu-id="e1fb6-111">Zamiast tego odpowiedź jest obsługiwana w działaniu żądania.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-111">Instead, the response is handled in the request activity.</span></span> <span data-ttu-id="e1fb6-112">Jeśli klient jest asynchroniczny lub synchronicznie wielowątkowy, `propagateActivity` = `true` na kliencie i istnieje nagłówek identyfikatora działania w komunikacie wysyłanym przez serwer, klient Pobiera identyfikator działania z komunikatu i przesyła do działania procesu działania, które zawiera identyfikator propagowanej aktywności.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-112">If the client is asynchronous or synchronous multithreaded, `propagateActivity`=`true` in the client, and there is an activity ID header in the message sent by the server, the client retrieves the activity ID from the message, and transfers to the Process Action activity that contains the propagated activity ID.</span></span> <span data-ttu-id="e1fb6-113">W przeciwnym razie klient przesyła z działania Process Message do nowego działania akcji procesu.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-113">Otherwise, the client transfers from Process Message activity to a new Process Action activity.</span></span> <span data-ttu-id="e1fb6-114">Ten dodatkowy transfer do nowego działania akcji procesu jest wykonywany w celu zapewnienia spójności.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-114">This extra transfer to a new Process Action activity is done for consistency.</span></span> <span data-ttu-id="e1fb6-115">W ramach tego działania klient Pobiera identyfikator aktywności działania BeginCall z lokalnego kontekstu wątku, gdy wątek zostanie przydzielony do przetwarzania komunikatów odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-115">Inside this activity, the client retrieves the activity ID of the BeginCall activity from the local thread context, when the thread is allocated for response message processing.</span></span> <span data-ttu-id="e1fb6-116">Następnie przenosi do działania początkowej akcji proces.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-116">It then transfers to the initial Process Action activity.</span></span>  
  
 <span data-ttu-id="e1fb6-117">Jeśli klient jest w trybie dupleksu, klient działa jako serwer podczas odbioru wiadomości.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-117">If the client is duplex, the client acts as server on receiving the message.</span></span>  
  
### <a name="propagation-in-fault-messages"></a><span data-ttu-id="e1fb6-118">Propagacja w komunikatach o błędach</span><span class="sxs-lookup"><span data-stu-id="e1fb6-118">Propagation in Fault Messages</span></span>  

 <span data-ttu-id="e1fb6-119">Nie ma różnicy w obsłudze komunikatów prawidłowych i błędów.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-119">There is no difference in handling valid and fault messages.</span></span> <span data-ttu-id="e1fb6-120">Jeśli `propagateActivity` = `true` identyfikator działania dodany do nagłówka komunikatu o błędzie protokołu SOAP jest identyczny z działaniem otoczenia.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-120">If `propagateActivity`=`true`, the activity ID added to the SOAP fault message headers is identical to the ambient activity.</span></span>  
  
## <a name="servicemodel-activity-tracing-is-disabled"></a><span data-ttu-id="e1fb6-121">Śledzenie działań ServiceModel jest wyłączone</span><span class="sxs-lookup"><span data-stu-id="e1fb6-121">ServiceModel Activity Tracing is Disabled</span></span>  

 <span data-ttu-id="e1fb6-122">Jeśli ServiceModel ActivityTracing jest wyłączony, Propagacja odbywa się między działaniami kodu użytkownika bezpośrednio bez przechodzenia przez działania programu ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-122">If ServiceModel ActivityTracing is disabled, propagation occurs between user code activities directly without going through ServiceModel activities.</span></span> <span data-ttu-id="e1fb6-123">Identyfikator działania zdefiniowany przez użytkownika jest również propagowany za pomocą nagłówka identyfikatora działania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-123">A user-defined activity ID is also propagated through the message activity ID header.</span></span>  
  
 <span data-ttu-id="e1fb6-124">Jeśli `propagateActivity` = `true` i `ActivityTracing` = `off` dla odbiornika śledzenia ServiceModel (bez względu na to, czy funkcja śledzenia jest włączona na modelu ServiceModel), na kliencie lub serwerze:</span><span class="sxs-lookup"><span data-stu-id="e1fb6-124">If `propagateActivity`=`true` and `ActivityTracing`=`off` for a ServiceModel trace listener (regardless of whether tracing is enabled on ServiceModel), the following happen on either the client or server:</span></span>  
  
- <span data-ttu-id="e1fb6-125">W przypadku żądania operacji lub wysyłania odpowiedzi, identyfikator działania w protokole TLS jest propagowany z kodu użytkownika do momentu, gdy wiadomość zostanie utworzona.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-125">On operation request or sending response, the activity ID in TLS is propagated out of user code until a message is formed.</span></span> <span data-ttu-id="e1fb6-126">Nagłówek identyfikatora działania jest również wstawiany do komunikatu przed jego wysłaniem.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-126">An activity ID header is also inserted into the message before it is sent.</span></span>  
  
- <span data-ttu-id="e1fb6-127">W przypadku odebrania żądania lub odebrania odpowiedzi identyfikator działania jest pobierany z nagłówka wiadomości zaraz po utworzeniu odebranego obiektu wiadomości.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-127">On receiving request or receiving response, the activity ID is retrieved from the message header as soon as the received message object is created.</span></span> <span data-ttu-id="e1fb6-128">Identyfikator działania w protokole TLS jest propagowany zaraz po osiągnięciu przez niego komunikatu z zakresu, dopóki nie zostanie osiągnięty kod użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-128">The activity ID in TLS is propagated as soon as the message disappears from scope until user code is reached.</span></span>  
  
 <span data-ttu-id="e1fb6-129">Te akcje gwarantują, że ślady użytkownika będą wyświetlane w tym samym działaniu, gdy Propagacja jest włączona.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-129">These actions guarantee that user traces will appear in the same activity if propagation is on.</span></span> <span data-ttu-id="e1fb6-130">Nie ma jednak gwarancji na ślady ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-130">However, it makes no guarantee on ServiceModel traces.</span></span> <span data-ttu-id="e1fb6-131">Ślady ServiceModel występują w działaniu kodu użytkownika tylko wtedy, gdy przetwarzanie tych śladów jest wykonywane w tym samym wątku, w którym ustawiono działanie kod użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-131">ServiceModel traces occur in a user code activity only if the processing of those traces is executed on the same thread where the user code activity was set.</span></span>  
  
 <span data-ttu-id="e1fb6-132">Ogólnie rzecz biorąc, ślady elementu ServiceModel można zaobserwować w następujących miejscach:</span><span class="sxs-lookup"><span data-stu-id="e1fb6-132">In general, ServiceModel traces can be observed in the following places:</span></span>  
  
- <span data-ttu-id="e1fb6-133">Jeśli śledzenie ServiceModel jest wyłączone, wszystkie emitowane ślady pojawiają się w działaniach użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-133">If ServiceModel tracing is disabled, all emitted traces appear in user activities.</span></span> <span data-ttu-id="e1fb6-134">Jeśli Propagacja jest włączona zarówno na serwerze, jak i na kliencie, te ślady będą znajdować się w tym samym działaniu.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-134">If propagation is enabled at both the server and client, these traces will be in the same activity.</span></span>  
  
- <span data-ttu-id="e1fb6-135">Jeśli śledzenie ServiceModel jest włączone, ale ActivityTracing jest wyłączone, ślady użytkownika są wyświetlane w tym samym działaniu, jeśli Propagacja jest włączona na obu końcach.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-135">If ServiceModel tracing is enabled, but ActivityTracing is disabled, user traces appear in the same activity if propagation is enabled on both ends.</span></span> <span data-ttu-id="e1fb6-136">Ślady ServiceModel pojawiają się w domyślnym działaniu 0000, chyba że występują w tym samym wątku co przetwarzanie kodu użytkownika, w którym działanie jest początkowo ustawione.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-136">ServiceModel traces appear in the default 0000 activity, unless they occur in the same thread as the user code processing where the activity is initially set.</span></span>  
  
- <span data-ttu-id="e1fb6-137">Jeśli włączone są zarówno śledzenie ServiceModel, jak i ActivityTracing, ślady użytkownika są wyświetlane w działaniach zdefiniowanych przez użytkownika, a ślady ServiceModel są wyświetlane w działaniach zdefiniowanych przez program ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-137">If both ServiceModel tracing and ActivityTracing are enabled, user traces appear in user-defined activities, and ServiceModel traces appear in ServiceModel-defined activities.</span></span> <span data-ttu-id="e1fb6-138">Propagacja odbywa się na poziomie elementu ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="e1fb6-138">Propagation happens at ServiceModel level.</span></span>
