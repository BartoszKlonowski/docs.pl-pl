---
title: 'Instrukcje: importowanie niestandardowych asercji zasad'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 1f41d787-accb-4a10-bfc6-a807671d1581
ms.openlocfilehash: 4510eac2d9c1b3bb64420b0678b3a47a90887188
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/07/2019
ms.locfileid: "70795622"
---
# <a name="how-to-import-custom-policy-assertions"></a><span data-ttu-id="864b4-102">Instrukcje: importowanie niestandardowych asercji zasad</span><span class="sxs-lookup"><span data-stu-id="864b4-102">How to: Import Custom Policy Assertions</span></span>
<span data-ttu-id="864b4-103">Potwierdzenia zasad opisują możliwości i wymagania punktu końcowego usługi.</span><span class="sxs-lookup"><span data-stu-id="864b4-103">Policy assertions describe the capabilities and requirements of a service endpoint.</span></span>  <span data-ttu-id="864b4-104">Aplikacje klienckie mogą używać potwierdzeń zasad w metadanych usługi, aby skonfigurować powiązanie klienta lub dostosować kontrakt usługi dla punktu końcowego usługi.</span><span class="sxs-lookup"><span data-stu-id="864b4-104">Client applications can use policy assertions in service metadata to configure the client binding or to customize the service contract for a service endpoint.</span></span>  
  
 <span data-ttu-id="864b4-105">Niestandardowe potwierdzenia zasad są importowane przez implementację <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> interfejsu i przekazanie tego obiektu do systemu metadanych lub przez zarejestrowanie typu implementacji w pliku konfiguracyjnym aplikacji.</span><span class="sxs-lookup"><span data-stu-id="864b4-105">Custom policy assertions are imported by implementing the <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> interface and passing that object to the metadata system or by registering the implementation type in your application configuration file.</span></span>  <span data-ttu-id="864b4-106">Implementacje <xref:System.ServiceModel.Description.IPolicyImportExtension> interfejsu muszą udostępniać Konstruktor bez parametrów.</span><span class="sxs-lookup"><span data-stu-id="864b4-106">Implementations of the <xref:System.ServiceModel.Description.IPolicyImportExtension> interface must provide a parameterless constructor.</span></span>  
  
### <a name="to-import-custom-policy-assertions"></a><span data-ttu-id="864b4-107">Aby zaimportować potwierdzenia zasad niestandardowych</span><span class="sxs-lookup"><span data-stu-id="864b4-107">To import custom policy assertions</span></span>  
  
1. <span data-ttu-id="864b4-108">Zaimplementuj <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> interfejs w klasie.</span><span class="sxs-lookup"><span data-stu-id="864b4-108">Implement the <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> interface on a class.</span></span> <span data-ttu-id="864b4-109">Zapoznaj się z poniższymi procedurami.</span><span class="sxs-lookup"><span data-stu-id="864b4-109">See the following procedures.</span></span>  
  
2. <span data-ttu-id="864b4-110">Wstaw importera zasad niestandardowych przez:</span><span class="sxs-lookup"><span data-stu-id="864b4-110">Insert the custom policy importer either by:</span></span>  
  
3. <span data-ttu-id="864b4-111">Przy użyciu pliku konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="864b4-111">Using a configuration file.</span></span> <span data-ttu-id="864b4-112">Zapoznaj się z poniższymi procedurami.</span><span class="sxs-lookup"><span data-stu-id="864b4-112">See the following procedures.</span></span>  
  
4. <span data-ttu-id="864b4-113">Korzystanie z pliku konfiguracji z [narzędziem do przesyłania metadanych programu ServiceModel (Svcutil. exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="864b4-113">Using a configuration file with [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="864b4-114">Zapoznaj się z poniższymi procedurami.</span><span class="sxs-lookup"><span data-stu-id="864b4-114">See the following procedures.</span></span>  
  
5. <span data-ttu-id="864b4-115">Programowe Wstawianie importera zasad.</span><span class="sxs-lookup"><span data-stu-id="864b4-115">Programmatically inserting the policy importer.</span></span> <span data-ttu-id="864b4-116">Zapoznaj się z poniższymi procedurami.</span><span class="sxs-lookup"><span data-stu-id="864b4-116">See the following procedures.</span></span>  
  
### <a name="to-implement-the-systemservicemodeldescriptionipolicyimportextension-interface-on-any-class"></a><span data-ttu-id="864b4-117">Aby zaimplementować interfejs System. ServiceModel. Description. IPolicyImportExtension dla dowolnej klasy</span><span class="sxs-lookup"><span data-stu-id="864b4-117">To implement the System.ServiceModel.Description.IPolicyImportExtension interface on any class</span></span>  
  
1. <span data-ttu-id="864b4-118">W przypadku poszczególnych interesujących Cię zasad Znajdź potwierdzenia zasad, które chcesz zaimportować, wywołując odpowiednią metodę (w zależności od wymaganego zakresu potwierdzenia) <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType> w obiekcie przekazaną do elementu <xref:System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy%2A?displayProperty=nameWithType> Method.</span><span class="sxs-lookup"><span data-stu-id="864b4-118">In the <xref:System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy%2A?displayProperty=nameWithType> method, for each policy subject that you are interested in, find the policy assertions that you want to import by calling the appropriate method (depending upon the scope of the assertion that you want) on the <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType> object passed to the method.</span></span> <span data-ttu-id="864b4-119">Poniższy przykład kodu pokazuje, jak za pomocą <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> metody zlokalizować potwierdzenie zasad niestandardowych i usunąć je z kolekcji w jednym kroku.</span><span class="sxs-lookup"><span data-stu-id="864b4-119">The following code example shows how to use the <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> method to locate the custom policy assertion and remove it from the collection in one step.</span></span> <span data-ttu-id="864b4-120">Jeśli używasz metody Remove do lokalizowania i usuwania potwierdzenia, nie musisz wykonywać kroku 4.</span><span class="sxs-lookup"><span data-stu-id="864b4-120">If you use the remove method to locate and remove the assertion, you do not have to perform step 4.</span></span>  
  
     [!code-csharp[CustomPolicySample#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/policyimporter.cs#9)]
     [!code-vb[CustomPolicySample#9](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/custompolicysample/vb/policyimporter.vb#9)]  
  
2. <span data-ttu-id="864b4-121">Przetwarzanie potwierdzeń zasad.</span><span class="sxs-lookup"><span data-stu-id="864b4-121">Process the policy assertions.</span></span> <span data-ttu-id="864b4-122">Należy pamiętać, że system zasad nie normalizuje zasad zagnieżdżonych `wsp:optional`i.</span><span class="sxs-lookup"><span data-stu-id="864b4-122">Note that the policy system does not normalize nested policies and `wsp:optional`.</span></span> <span data-ttu-id="864b4-123">Należy przetwarzać te konstrukcje w implementacji rozszerzenia importu zasad.</span><span class="sxs-lookup"><span data-stu-id="864b4-123">You must process these constructs in your policy import extension implementation.</span></span>  
  
3. <span data-ttu-id="864b4-124">Wykonaj dostosowanie do powiązania lub kontraktu, który obsługuje możliwości lub wymagania określone przez potwierdzenie zasad.</span><span class="sxs-lookup"><span data-stu-id="864b4-124">Perform the customization to the binding or contract that supports the capability or requirement specified by the policy assertion.</span></span> <span data-ttu-id="864b4-125">Zazwyczaj potwierdzenia wskazują, że powiązanie wymaga określonej konfiguracji lub określonego elementu powiązania.</span><span class="sxs-lookup"><span data-stu-id="864b4-125">Typically assertions indicate that a binding requires a particular configuration or a specific binding element.</span></span> <span data-ttu-id="864b4-126">Wprowadź te modyfikacje, uzyskując dostęp <xref:System.ServiceModel.Description.PolicyConversionContext.BindingElements%2A?displayProperty=nameWithType> do właściwości.</span><span class="sxs-lookup"><span data-stu-id="864b4-126">Make these modifications by accessing the <xref:System.ServiceModel.Description.PolicyConversionContext.BindingElements%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="864b4-127">Inne potwierdzenia wymagają zmodyfikowania kontraktu.</span><span class="sxs-lookup"><span data-stu-id="864b4-127">Other assertions require that you modify the contract.</span></span>  <span data-ttu-id="864b4-128">Możesz uzyskać dostęp do kontraktu i zmodyfikować go przy <xref:System.ServiceModel.Description.PolicyConversionContext.Contract%2A?displayProperty=nameWithType> użyciu właściwości.</span><span class="sxs-lookup"><span data-stu-id="864b4-128">You can access and modify the contract using the <xref:System.ServiceModel.Description.PolicyConversionContext.Contract%2A?displayProperty=nameWithType> property.</span></span>  <span data-ttu-id="864b4-129">Należy zauważyć, że importer zasad może być wywoływany wiele razy dla tego samego powiązania i kontraktu, ale różne alternatywy dla zasad, jeśli Importowanie alternatywy zasad zakończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="864b4-129">Note that your policy importer may get called multiple times for the same binding and contract, but different policy alternatives if importing a policy alternative fails.</span></span> <span data-ttu-id="864b4-130">Kod powinien być odporny na to zachowanie.</span><span class="sxs-lookup"><span data-stu-id="864b4-130">Your code should be resilient to this behavior.</span></span>  
  
4. <span data-ttu-id="864b4-131">Usuń potwierdzenie zasad niestandardowych z kolekcji potwierdzenia.</span><span class="sxs-lookup"><span data-stu-id="864b4-131">Remove the custom policy assertion from the assertion collection.</span></span> <span data-ttu-id="864b4-132">Jeśli nie usuniesz Windows Communication Foundation potwierdzenia (WCF), przyjęto założenie, że import zasad nie powiódł się i nie importuje skojarzonego powiązania.</span><span class="sxs-lookup"><span data-stu-id="864b4-132">If you do not remove the assertion Windows Communication Foundation (WCF) assumes that the policy import was unsuccessful and does not import the associated binding.</span></span> <span data-ttu-id="864b4-133">Jeśli użyto <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> metody, aby zlokalizować potwierdzenie zasad niestandardowych i usunąć je z kolekcji w jednym kroku, nie musisz wykonywać tego kroku.</span><span class="sxs-lookup"><span data-stu-id="864b4-133">If you used the <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> method to locate the custom policy assertion and remove it from the collection in one step you do not have to perform this step.</span></span>  
  
### <a name="to-insert-the-custom-policy-importer-into-the-metadata-system-using-a-configuration-file"></a><span data-ttu-id="864b4-134">Aby wstawić importera zasad niestandardowych do systemu metadanych przy użyciu pliku konfiguracji</span><span class="sxs-lookup"><span data-stu-id="864b4-134">To insert the custom policy importer into the metadata System using a configuration file</span></span>  
  
1. <span data-ttu-id="864b4-135">Dodaj typ importera do `<extensions>` elementu [ \<wewnątrz elementu policyImporters >](../../configure-apps/file-schema/wcf/policyimporters.md) w pliku konfiguracji klienta.</span><span class="sxs-lookup"><span data-stu-id="864b4-135">Add the importer type to the `<extensions>` element inside the [\<policyImporters>](../../configure-apps/file-schema/wcf/policyimporters.md) element in the client configuration file.</span></span>  
  
     [!code-xml[CustomPolicySample#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/client.exe.config#7)]   
  
2. <span data-ttu-id="864b4-136">W aplikacji klienckiej Użyj <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType> lub <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> , aby rozwiązać metadane, a importer jest wywoływany automatycznie.</span><span class="sxs-lookup"><span data-stu-id="864b4-136">In the client application, use the <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> to resolve the metadata and the importer is invoked automatically.</span></span>  
  
     [!code-csharp[CustomPolicySample#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/client.cs#10)]
     [!code-vb[CustomPolicySample#10](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/custompolicysample/vb/client.vb#10)]  
  
### <a name="to-insert-the-custom-policy-importer-into-the-metadata-system-using-svcutilexe"></a><span data-ttu-id="864b4-137">Aby wstawić importera zasad niestandardowych do systemu metadanych przy użyciu programu Svcutil. exe</span><span class="sxs-lookup"><span data-stu-id="864b4-137">To insert the custom policy importer into the metadata system using Svcutil.exe</span></span>  
  
1. <span data-ttu-id="864b4-138">Dodaj typ importera do `<extensions>` elementu [ \<wewnątrz elementu policyImporters >](../../configure-apps/file-schema/wcf/policyimporters.md) w pliku konfiguracyjnym Svcutil. exe. config.</span><span class="sxs-lookup"><span data-stu-id="864b4-138">Add the importer type to the `<extensions>` element inside the [\<policyImporters>](../../configure-apps/file-schema/wcf/policyimporters.md) element in the Svcutil.exe.config configuration file.</span></span> <span data-ttu-id="864b4-139">Możesz również wskazać Svcutil. exe, aby załadować typy importerów zasad zarejestrowane w innym pliku konfiguracji przy użyciu `/svcutilConfig` opcji.</span><span class="sxs-lookup"><span data-stu-id="864b4-139">You can also point Svcutil.exe to load policy importer types registered in a different configuration file by using the `/svcutilConfig` option.</span></span>  
  
2. <span data-ttu-id="864b4-140">Użyj [Narzędzia do przesyłania metadanych ServiceModel (Svcutil. exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) w celu zaimportowania metadanych, a importer jest wywoływany automatycznie.</span><span class="sxs-lookup"><span data-stu-id="864b4-140">Use [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) to import the metadata and the importer is invoked automatically.</span></span>  
  
### <a name="to-insert-the-custom-policy-importer-into-the-metadata-system-programmatically"></a><span data-ttu-id="864b4-141">Aby programowo wstawić importera zasad niestandardowych do systemu metadanych</span><span class="sxs-lookup"><span data-stu-id="864b4-141">To insert the custom policy importer into the metadata system programmatically</span></span>  
  
1. <span data-ttu-id="864b4-142">Dodaj importera do <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A?displayProperty=nameWithType> właściwości (na przykład jeśli <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType>używasz) przed zaimportowaniem metadanych.</span><span class="sxs-lookup"><span data-stu-id="864b4-142">Add the importer to the <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A?displayProperty=nameWithType> property (for example, if you are using the <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType>) prior to importing the metadata.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="864b4-143">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="864b4-143">See also</span></span>

- <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType>
- <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType>
- <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType>
- [<span data-ttu-id="864b4-144">Rozszerzanie systemu metadanych</span><span class="sxs-lookup"><span data-stu-id="864b4-144">Extending the Metadata System</span></span>](extending-the-metadata-system.md)
