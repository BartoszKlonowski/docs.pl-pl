---
title: Niestandardowe kodery
ms.date: 03/30/2017
ms.assetid: fa0e1d7f-af36-4bf4-aac9-cd4eab95bc4f
ms.openlocfilehash: d553859ed622cefffc946bca94796204b2fe6456
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/28/2019
ms.locfileid: "64587284"
---
# <a name="custom-encoders"></a><span data-ttu-id="d50ce-102">Niestandardowe kodery</span><span class="sxs-lookup"><span data-stu-id="d50ce-102">Custom Encoders</span></span>
<span data-ttu-id="d50ce-103">W tym temacie omówiono, jak utworzyć niestandardowe kodery.</span><span class="sxs-lookup"><span data-stu-id="d50ce-103">This topic discusses how to create custom encoders.</span></span>  
  
 <span data-ttu-id="d50ce-104">W konsoli Windows Communication Foundation (WCF), możesz użyć *powiązania* do określenia sposobu transferu danych za pośrednictwem sieci między punktami końcowymi.</span><span class="sxs-lookup"><span data-stu-id="d50ce-104">In Windows Communication Foundation (WCF), you use a *binding* to specify how to transfer data across a network between endpoints.</span></span> <span data-ttu-id="d50ce-105">Powiązanie składa się z sekwencji *elementów wiązania*.</span><span class="sxs-lookup"><span data-stu-id="d50ce-105">A binding is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="d50ce-106">Powiązanie zawiera elementy powiązania protokołu opcjonalne takie jak zabezpieczenia wymaganą *koder komunikatów* element powiązania, a element powiązania transportu wymagane.</span><span class="sxs-lookup"><span data-stu-id="d50ce-106">A binding includes optional protocol binding elements such as security, a required *Message Encoder* binding element, and a required transport binding element.</span></span> <span data-ttu-id="d50ce-107">Koder komunikatów jest reprezentowany przez element powiązania kodowania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-107">A message encoder is represented by a message encoding binding element.</span></span> <span data-ttu-id="d50ce-108">Trzy koderów komunikat znajdują się w programie WCF: Plik binarny mechanizmu optymalizacji transmisji wiadomości (MTOM) i tekst.</span><span class="sxs-lookup"><span data-stu-id="d50ce-108">Three message encoders are included in WCF: Binary, Message Transmission Optimization Mechanism (MTOM), and Text.</span></span>  
  
 <span data-ttu-id="d50ce-109">Kodowanie elementu powiązania serializuje wychodzący komunikat <xref:System.ServiceModel.Channels.Message> i przekazuje go do transportu, lub odbiera serializowane postaci wiadomość z transportu i przekazuje go do warstwy protokołu, jeśli jest obecna, lub do aplikacji, jeśli nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="d50ce-109">A message encoding binding element serializes an outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport, or receives the serialized form of a message from the transport and passes it to the protocol layer if present, or to the application, if not present.</span></span>  
  
 <span data-ttu-id="d50ce-110">Przekształcanie komunikatów koderów <xref:System.ServiceModel.Channels.Message> wystąpień do i z reprezentacji o komunikacji sieciowej.</span><span class="sxs-lookup"><span data-stu-id="d50ce-110">Message encoders transform <xref:System.ServiceModel.Channels.Message> instances to and from a wire representation.</span></span> <span data-ttu-id="d50ce-111">Mimo że koderów są określane jako siedzenie powyżej warstwy transportu w stosie kanału, zostaną one umieszczone w warstwie transportowej.</span><span class="sxs-lookup"><span data-stu-id="d50ce-111">Although encoders are described as sitting above the transport layer in the channel stack, they reside inside the transport layer.</span></span> <span data-ttu-id="d50ce-112">Wiadomość zgodnie z wymaganiami standardu transportu w formacie transportów (na przykład HTTP).</span><span class="sxs-lookup"><span data-stu-id="d50ce-112">Transports (for example HTTP) format the message according to the requirements of the transport standard.</span></span> <span data-ttu-id="d50ce-113">Kodery (na przykład tekst Xml) po prostu kodowania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-113">Encoders (for example Text Xml) just encode the message.</span></span>  
  
 <span data-ttu-id="d50ce-114">Podczas łączenia z istniejących klienta lub serwera, możesz nie mieć wyboru — informacje przy użyciu określonego komunikatu kodowania.</span><span class="sxs-lookup"><span data-stu-id="d50ce-114">When connecting to a preexisting client or server, you may not have a choice about using a particular message encoding.</span></span> <span data-ttu-id="d50ce-115">Jednak usług WCF mogą być dostępne za pośrednictwem wielu punktów końcowych, każdy z użyciem kodera inny komunikat.</span><span class="sxs-lookup"><span data-stu-id="d50ce-115">However, WCF services can be made accessible through multiple endpoints, each with a different message encoder.</span></span> <span data-ttu-id="d50ce-116">W przypadku pojedynczego kodera nie obejmuje całego odbiorców dla Twojej usługi, należy rozważyć, udostępnianie usługi za pośrednictwem wielu punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="d50ce-116">When a single encoder does not cover the entire audience for your service, consider exposing your service over multiple endpoints.</span></span> <span data-ttu-id="d50ce-117">Aplikacje klienckie można określić punktu końcowego, który jest najlepsze dla nich.</span><span class="sxs-lookup"><span data-stu-id="d50ce-117">Client applications can then choose the endpoint that is best for them.</span></span> <span data-ttu-id="d50ce-118">Za pomocą wielu punktów końcowych pozwala połączyć zalety koderów inny komunikat z innymi elementami powiązania.</span><span class="sxs-lookup"><span data-stu-id="d50ce-118">Using multiple endpoints allows you to combine the advantages of different message encoders with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="d50ce-119">Kodery dostarczane przez system</span><span class="sxs-lookup"><span data-stu-id="d50ce-119">System-Provided Encoders</span></span>  
 <span data-ttu-id="d50ce-120">Usługi WCF zapewnia kilka powiązania dostarczane przez system, które są przeznaczone do najbardziej typowych scenariuszy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d50ce-120">WCF provides several system-provided bindings that are designed to cover the most common application scenarios.</span></span> <span data-ttu-id="d50ce-121">Połącz każdego z tych powiązań, transport, koder komunikatów i inne opcje (na przykład zabezpieczenia).</span><span class="sxs-lookup"><span data-stu-id="d50ce-121">Each of these bindings combine a transport, message encoder, and other options (security, for example).</span></span> <span data-ttu-id="d50ce-122">W tym temacie opisano, jak rozszerzyć `Text`, `Binary`, i `MTOM` koderów, które znajdują się w usłudze WCF lub utworzyć niestandardowy koder komunikatów.</span><span class="sxs-lookup"><span data-stu-id="d50ce-122">This topic describes how to extend the `Text`, `Binary`, and `MTOM` message encoders that are included in WCF, or create your own custom encoder.</span></span> <span data-ttu-id="d50ce-123">Koder komunikatu tekstowego obsługuje zarówno zwykłe Kodowanie XML oraz kodowania SOAP.</span><span class="sxs-lookup"><span data-stu-id="d50ce-123">The text message encoder supports both a plain XML encoding as well as SOAP encodings.</span></span> <span data-ttu-id="d50ce-124">Zwykły tryb kodowania XML koder komunikatu tekstowego nosi nazwę kodera POX "Zwykłe stare XML (") w odróżnieniu od oparte na tekście kodowaniem SOAP.</span><span class="sxs-lookup"><span data-stu-id="d50ce-124">The plain XML encoding mode of the text message encoder is called the POX ("Plain Old XML") encoder to distinguish it from the text-based SOAP encoding.</span></span>  
  
 <span data-ttu-id="d50ce-125">Aby uzyskać więcej informacji na temat kombinacji elementy powiązania dostarczane przez powiązania dostarczane przez system, zobacz odpowiedniej sekcji w [Wybieranie transportu](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="d50ce-125">For more information about the combinations of binding elements provided by the system-provided bindings, see the corresponding section in [Choosing a Transport](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span></span>  
  
## <a name="how-to-work-with-system-provided-encoders"></a><span data-ttu-id="d50ce-126">Jak pracować z koderów dostarczane przez System</span><span class="sxs-lookup"><span data-stu-id="d50ce-126">How to Work with System-Provided Encoders</span></span>  
 <span data-ttu-id="d50ce-127">Kodowanie jest dodawany do powiązania przy użyciu klasy pochodzącej od <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="d50ce-127">An encoding is added to a binding using a class derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
 <span data-ttu-id="d50ce-128">WCF zawiera następujące elementy powiązania pochodną <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> klasy, która może zapewnić tekstowych, plik binarny i kodowanie komunikatu transmisji optymalizacji mechanizm (MTOM):</span><span class="sxs-lookup"><span data-stu-id="d50ce-128">WCF provides the following types of binding elements derived from the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> class that can provide for text, binary and Message Transmission Optimization Mechanism (MTOM) encoding:</span></span>  
  
- <span data-ttu-id="d50ce-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: Najbardziej międzyoperacyjnych, ale co najmniej wydajne kodera komunikatów XML.</span><span class="sxs-lookup"><span data-stu-id="d50ce-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: The most interoperable, but the least efficient encoder for XML messages.</span></span> <span data-ttu-id="d50ce-130">Usługi sieci Web lub klient usługi sieci Web zazwyczaj może zrozumieć tekstowych XML.</span><span class="sxs-lookup"><span data-stu-id="d50ce-130">A Web service or Web service client can generally understand textual XML.</span></span> <span data-ttu-id="d50ce-131">Przesyłanie dużych bloków danych binarnych jako tekst nie jest jednak wydajne.</span><span class="sxs-lookup"><span data-stu-id="d50ce-131">However, transmitting large blocks of binary data as text is not efficient.</span></span>  
  
- <span data-ttu-id="d50ce-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Reprezentuje element powiązania, który określa kodowanie znaków i wiadomości versioning używany dla wiadomości XML na podstawie pliku binarnego.</span><span class="sxs-lookup"><span data-stu-id="d50ce-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for binary-based XML messages.</span></span> <span data-ttu-id="d50ce-133">Jest to najbardziej efektywny sposób opcji kodowania, ale co najmniej międzyoperacyjnych, ponieważ jest ona obsługiwana tylko przez punktami końcowymi programu WCF.</span><span class="sxs-lookup"><span data-stu-id="d50ce-133">This is most efficient of the encoding options, but the least interoperable, because it is only supported by WCF endpoints.</span></span>  
  
- <span data-ttu-id="d50ce-134"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>: Reprezentuje element powiązania, który określa kodowanie znaków i wersji komunikatu używany dla wiadomości przy użyciu kodowania komunikatu transmisji optymalizacji mechanizm (MTOM).</span><span class="sxs-lookup"><span data-stu-id="d50ce-134"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for a message using a Message Transmission Optimization Mechanism (MTOM) encoding.</span></span> <span data-ttu-id="d50ce-135">MTOM to technologia wydajne przekazywania danych binarnych w wiadomościach WCF.</span><span class="sxs-lookup"><span data-stu-id="d50ce-135">MTOM is an efficient technology for transmitting binary data in WCF messages.</span></span> <span data-ttu-id="d50ce-136">Koder MTOM próbuje zachować równowagę między współdziałania i wydajność.</span><span class="sxs-lookup"><span data-stu-id="d50ce-136">The MTOM encoder attempts to balance between efficiency and interoperability.</span></span> <span data-ttu-id="d50ce-137">Kodowanie MTOM przesyła większość kodu XML w postaci tekstowej, ale optymalizuje dużych bloków danych binarnych, przekazywania ich jako — jest bez konwersji na tekst.</span><span class="sxs-lookup"><span data-stu-id="d50ce-137">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span>  
  
 <span data-ttu-id="d50ce-138">Element powiązania tworzy plik binarny, MTOM lub tekst <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span><span class="sxs-lookup"><span data-stu-id="d50ce-138">The binding element creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span></span> <span data-ttu-id="d50ce-139">Fabryka tworzy plik binarny, MTOM lub tekst <xref:System.ServiceModel.Channels.MessageEncoderFactory> wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="d50ce-139">The factory creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory> instance.</span></span> <span data-ttu-id="d50ce-140">Zazwyczaj jest tylko jedno wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="d50ce-140">Typically, there is only a single instance.</span></span> <span data-ttu-id="d50ce-141">Jednak sesji są używane, mogą być udostępniane do każdej sesji kodera innego.</span><span class="sxs-lookup"><span data-stu-id="d50ce-141">However if sessions are used, a different encoder may be provided to each session.</span></span> <span data-ttu-id="d50ce-142">Kodera binarnego sprawia, że użycie tego do zapewnienia koordynacji słowników dynamiczne (patrz infrastruktury XML).</span><span class="sxs-lookup"><span data-stu-id="d50ce-142">The Binary encoder makes use of this to coordinate dynamic dictionaries (see XML Infrastructure).</span></span>  
  
 <span data-ttu-id="d50ce-143"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> i <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> metody stanowią podstawę koderów.</span><span class="sxs-lookup"><span data-stu-id="d50ce-143">The <xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> and <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> methods are the core of the encoders.</span></span> <span data-ttu-id="d50ce-144">Metody zapewnienia czytania wiadomości ze strumienia lub z <xref:System.Byte> tablicy.</span><span class="sxs-lookup"><span data-stu-id="d50ce-144">The methods provide for reading a message from a stream or from a <xref:System.Byte> array.</span></span> <span data-ttu-id="d50ce-145">Tablice typu byte są używane, gdy transport działają w trybie buforowanego.</span><span class="sxs-lookup"><span data-stu-id="d50ce-145">Byte arrays are used when the transport is operating in buffered mode.</span></span> <span data-ttu-id="d50ce-146">Komunikaty są zawsze zapisywane do strumieni.</span><span class="sxs-lookup"><span data-stu-id="d50ce-146">Messages are always written to streams.</span></span> <span data-ttu-id="d50ce-147">Jeśli transport buffer, wiadomości, zapewnia strumienia, który obsługuje buforowania.</span><span class="sxs-lookup"><span data-stu-id="d50ce-147">If the transport must buffer the message, it provides a stream that does the buffering.</span></span>  
  
 <span data-ttu-id="d50ce-148">Pozostałe elementy członkowskie pracować obsługi zawartości, typy nośników, a <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span><span class="sxs-lookup"><span data-stu-id="d50ce-148">The rest of the members work with support content, media types, and <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span></span> <span data-ttu-id="d50ce-149">Transport wywołuje te metody kodera, aby sprawdzić, czy przychodzący komunikat może zostać odczytany przez niego lub do określenia, czy komunikatu wychodzącego jest nieprawidłowa dla tego kodera.</span><span class="sxs-lookup"><span data-stu-id="d50ce-149">The transport calls these encoder methods to test whether the incoming message can be decoded by it, or to determine if the outgoing message is valid for this encoder.</span></span>  
  
 <span data-ttu-id="d50ce-150">Każda z trzech implementacji kodera dodaje właściwości, które mają zastosowanie do określonego kodowania i jest w pełni konfigurowalne.</span><span class="sxs-lookup"><span data-stu-id="d50ce-150">Each of the three encoder implementations adds properties that are relevant to the specific encodings and is fully configurable.</span></span> <span data-ttu-id="d50ce-151">Kodery również ujawnić przydziały czytnika, które mają wartości domyślne bezpieczne.</span><span class="sxs-lookup"><span data-stu-id="d50ce-151">The encoders also expose reader quotas that have secure defaults.</span></span> <span data-ttu-id="d50ce-152">Dyskusję na temat limitów przydziału można znaleźć w infrastrukturze XML.</span><span class="sxs-lookup"><span data-stu-id="d50ce-152">See XML Infrastructure for a discussion of the quotas.</span></span>  
  
## <a name="features-of-system-provided-encoders"></a><span data-ttu-id="d50ce-153">Funkcje koderów dostarczane przez System</span><span class="sxs-lookup"><span data-stu-id="d50ce-153">Features of System-Provided Encoders</span></span>  
 <span data-ttu-id="d50ce-154">Istnieje kilka funkcji oferowanych przez koderów dostarczane przez system.</span><span class="sxs-lookup"><span data-stu-id="d50ce-154">There are a number of features provided by the system-provided encoders.</span></span>  
  
### <a name="pooling"></a><span data-ttu-id="d50ce-155">Buforowanie</span><span class="sxs-lookup"><span data-stu-id="d50ce-155">Pooling</span></span>  
 <span data-ttu-id="d50ce-156">Każda z implementacji kodera próbuje jak najszerzej w puli.</span><span class="sxs-lookup"><span data-stu-id="d50ce-156">Each of the encoder implementations tries to pool as much as possible.</span></span> <span data-ttu-id="d50ce-157">Zmniejszenie alokacji jest kluczowe sposób poprawienia wydajności kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="d50ce-157">Reducing allocations is a key way to improve the performance of managed code.</span></span> <span data-ttu-id="d50ce-158">Aby wykonać tej buforowanie, należy użyć implementacji `SynchronizedPool` klasy.</span><span class="sxs-lookup"><span data-stu-id="d50ce-158">To accomplish this pooling, the implementations use the `SynchronizedPool` class.</span></span> <span data-ttu-id="d50ce-159">C# Plik zawiera opis dodatkowe optymalizacje używane przez tę klasę.</span><span class="sxs-lookup"><span data-stu-id="d50ce-159">The C# file contains a description of the additional optimizations used by this class.</span></span>  
  
 <span data-ttu-id="d50ce-160"><xref:System.Xml.XmlDictionaryReader> i <xref:System.Xml.XmlDictionaryWriter> wystąpienia są w puli i ponownie zainicjować w celu zapobieżenia alokowania nowe dla każdego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-160"><xref:System.Xml.XmlDictionaryReader> and <xref:System.Xml.XmlDictionaryWriter> instances are pooled and reinitialized to prevent allocating new ones for each message.</span></span> <span data-ttu-id="d50ce-161">Czytniki `OnClose` wywołania zwrotnego odzyskuje czytnik podczas `Close()` jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="d50ce-161">For the readers, an `OnClose` callback reclaims the reader when `Close()` is called.</span></span> <span data-ttu-id="d50ce-162">Koder odtwarza również niektóre obiekty stan komunikatu używany podczas tworzenia wiadomości.</span><span class="sxs-lookup"><span data-stu-id="d50ce-162">The encoder also recycles some message state objects used when constructing messages.</span></span> <span data-ttu-id="d50ce-163">Rozmiary te pule są konfigurowane przez `MaxReadPoolSize` i `MaxWritePoolSize` właściwości na wszystkich trzech klasach pochodnych <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="d50ce-163">The sizes of these pools are configurable by the `MaxReadPoolSize` and `MaxWritePoolSize` properties on each of the three classes derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
### <a name="binary-encoding"></a><span data-ttu-id="d50ce-164">Kodowanie binarne</span><span class="sxs-lookup"><span data-stu-id="d50ce-164">Binary Encoding</span></span>  
 <span data-ttu-id="d50ce-165">Gdy binarny sesje używa kodowania, ciąg dynamiczny słownik muszą przekazane odbiorcy wiadomości.</span><span class="sxs-lookup"><span data-stu-id="d50ce-165">When binary encoding uses sessions, the dynamic dictionary string must be communicated to the receiver of the message.</span></span> <span data-ttu-id="d50ce-166">Odbywa się to przez dodanie przedrostka wiadomości z ciągami dynamiczny słownik.</span><span class="sxs-lookup"><span data-stu-id="d50ce-166">This is done by prefixing the message with the dynamic dictionary strings.</span></span> <span data-ttu-id="d50ce-167">Odbiornik paski Wyłącz ciągi, dodaje je do sesji i przetwarza wiadomości.</span><span class="sxs-lookup"><span data-stu-id="d50ce-167">The receiver strips off the strings, adds them to the session, and processes the message.</span></span> <span data-ttu-id="d50ce-168">Poprawnie przekazywanie ciągów w słowniku wymaga buforowane transportu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-168">Correctly passing dictionary strings requires that the transport be buffered.</span></span>  
  
 <span data-ttu-id="d50ce-169">Ciągi są dołączane do komunikatów przez wewnętrzną `AddSessionInformationToMessage` metody.</span><span class="sxs-lookup"><span data-stu-id="d50ce-169">The strings are appended to the message by an internal `AddSessionInformationToMessage` method.</span></span> <span data-ttu-id="d50ce-170">Dodaje ciągi jako UTF-8 na początku wiadomości prefiksem ich długości.</span><span class="sxs-lookup"><span data-stu-id="d50ce-170">It adds the strings as UTF-8 to the front of the message prefixed with their length.</span></span> <span data-ttu-id="d50ce-171">Nagłówek słownika całego następnie jest poprzedzony znakiem długość jego danych.</span><span class="sxs-lookup"><span data-stu-id="d50ce-171">The entire dictionary header is then prefixed with the length of its data.</span></span> <span data-ttu-id="d50ce-172">Odwrotna operacja odbywa się przez wewnętrzną `ExtractSessionInformationFromMessage` metody.</span><span class="sxs-lookup"><span data-stu-id="d50ce-172">The reverse operation is performed by an internal `ExtractSessionInformationFromMessage` method.</span></span>  
  
 <span data-ttu-id="d50ce-173">Oprócz przetwarzania dynamiczny słownik kluczy, buforowane sesji komunikaty są odbierane w nietypowy sposób.</span><span class="sxs-lookup"><span data-stu-id="d50ce-173">In addition to processing dynamic dictionary keys, buffered sessionful messages are received in a unique way.</span></span> <span data-ttu-id="d50ce-174">Zamiast tworzenia modułu odczytującego za pośrednictwem dokumentu, a następnie przetwarza go, używa wewnętrznego kodera binarnego `MessagePatterns` klasy dekonstruować strumień danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="d50ce-174">Instead of creating a reader over the document and processing it, the binary encoder uses the internal `MessagePatterns` class to deconstruct the binary stream.</span></span> <span data-ttu-id="d50ce-175">Chodzi o to, że większość komunikaty mają zestaw nagłówków, które pojawiają się w określonej kolejności podczas generowania przez architekturę WCF.</span><span class="sxs-lookup"><span data-stu-id="d50ce-175">The idea is that most messages have a certain set of headers that show up in a certain order when generated by WCF.</span></span> <span data-ttu-id="d50ce-176">System wzorzec przerywa komunikatu od siebie na podstawie jego oczekuje.</span><span class="sxs-lookup"><span data-stu-id="d50ce-176">The pattern system breaks the message apart based on what it expects.</span></span> <span data-ttu-id="d50ce-177">Jeśli to się powiodło, inicjuje <xref:System.ServiceModel.Channels.MessageHeaders> obiekt bez analiza kodu XML.</span><span class="sxs-lookup"><span data-stu-id="d50ce-177">If it is successful, it initializes a <xref:System.ServiceModel.Channels.MessageHeaders> object without parsing the XML.</span></span> <span data-ttu-id="d50ce-178">W przeciwnym razie nastąpi powrót do standardową metodę.</span><span class="sxs-lookup"><span data-stu-id="d50ce-178">If not, it falls back to the standard method.</span></span>  
  
### <a name="mtom-encoding"></a><span data-ttu-id="d50ce-179">Kodowanie MTOM</span><span class="sxs-lookup"><span data-stu-id="d50ce-179">MTOM Encoding</span></span>  
 <span data-ttu-id="d50ce-180"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> Klasa ma właściwość dodatkowe czynności konfiguracyjne o nazwie <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement.MaxBufferSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="d50ce-180">The <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> class has an additional configuration property called <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement.MaxBufferSize%2A>.</span></span> <span data-ttu-id="d50ce-181">Te umieszcza górną granicę na ile danych jest ona dozwolona do zbuforowania podczas odczytywania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="d50ce-181">This places an upper bound on how much data it is allowed to buffer during the process of reading a message.</span></span> <span data-ttu-id="d50ce-182">XML informacji o zestawie (zestaw informacji) lub innych części MIME może być konieczne buforowane odtworzyć wszystkie części MIME w pojedynczym komunikacie.</span><span class="sxs-lookup"><span data-stu-id="d50ce-182">The XML Information Set (Infoset), or other MIME parts, may need to be buffered to reassemble all the MIME parts into a single message.</span></span>  
  
 <span data-ttu-id="d50ce-183">Działała prawidłowo, za pośrednictwem protokołu HTTP, wewnętrzny klasy koder MTOM wiadomości zawiera niektórych wewnętrznych interfejsów API dla `GetContentType` (jest to również wewnętrznego) i `WriteMessage`, która jest publiczna i może zostać zastąpiona.</span><span class="sxs-lookup"><span data-stu-id="d50ce-183">To work correctly with HTTP, the internal MTOM message encoder class provides some internal APIs for `GetContentType` (which is also internal) and `WriteMessage`, which is public and can be overridden.</span></span> <span data-ttu-id="d50ce-184">Więcej komunikacji musi wystąpić, aby upewnić się, że wartości w nagłówkach HTTP zgadza się z wartości nagłówków MIME.</span><span class="sxs-lookup"><span data-stu-id="d50ce-184">More communication must occur to ensure values in the HTTP headers agree with values in the MIME headers.</span></span>  
  
 <span data-ttu-id="d50ce-185">Wewnętrznie MTOM koder komunikatów używa czytelnicy tekst firmy WCF i jest podobna do koder tekstu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-185">Internally, the MTOM message encoder uses WCF's text readers, and is similar to the Text encoder.</span></span> <span data-ttu-id="d50ce-186">Główną różnicą jest optymalizowany duże zestawy danych binarnych lub "Duże obiekty binarne" (BLOB), nie konwertowania go na potrzeby kodowania Base-64 przed są osadzone w bajtów wiadomości.</span><span class="sxs-lookup"><span data-stu-id="d50ce-186">The main difference is that it optimizes large chunks of binary, or "Binary Large Objects" (BLOBs), by not converting them to Base-64 encoding prior to being embedded into the message bytes.</span></span> <span data-ttu-id="d50ce-187">Zamiast tego tych obiektów blob są utrzymywane na wyodrębniony i do którego istnieje odwołanie jako załączniki MIME.</span><span class="sxs-lookup"><span data-stu-id="d50ce-187">Instead, these BLOBs are kept extracted, and referenced as the MIME attachments.</span></span>  
  
## <a name="writing-your-own-encoder"></a><span data-ttu-id="d50ce-188">Pisanie własnego kodera</span><span class="sxs-lookup"><span data-stu-id="d50ce-188">Writing your own Encoder</span></span>  
 <span data-ttu-id="d50ce-189">Aby zaimplementować własny niestandardowy koder komunikatów, należy podać niestandardowych implementacji abstrakcyjnych klas bazowych:</span><span class="sxs-lookup"><span data-stu-id="d50ce-189">To implement your own custom message encoder, you must provide custom implementations of the following abstract base classes:</span></span>  
  
- <xref:System.ServiceModel.Channels.MessageEncoder>  
  
- <xref:System.ServiceModel.Channels.MessageEncoderFactory>  
  
- <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>  
  
 <span data-ttu-id="d50ce-190">Konwertowanie z reprezentacji w pamięci, wiadomości na reprezentację w postaci, które mogą być zapisywane do strumienia jest zhermetyzowany wewnątrz <xref:System.ServiceModel.Channels.MessageEncoder> klasy, która służy jako fabrykę dla XML czytników i składników zapisywania XML, które obsługują określone typy kodowania XML.</span><span class="sxs-lookup"><span data-stu-id="d50ce-190">Converting from the in-memory representation of a message to a representation that can be written to a stream is encapsulated within the <xref:System.ServiceModel.Channels.MessageEncoder> class, which serves as a factory for XML readers and XML writers that support specific types of XML encodings.</span></span>  
  
- <span data-ttu-id="d50ce-191">Klucza metody tej klasy, które musisz przesłonić to:</span><span class="sxs-lookup"><span data-stu-id="d50ce-191">The key methods of this class that you must override are:</span></span>  
  
- <span data-ttu-id="d50ce-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> który bierze <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> obiektu i zapisuje go do <xref:System.IO.Stream> obiektu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> which takes a <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> object and writes it into a <xref:System.IO.Stream> object.</span></span>  
  
- <span data-ttu-id="d50ce-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> który bierze <xref:System.IO.Stream> obiektu i rozmiar maksymalny nagłówka i zwraca <xref:System.ServiceModel.Channels.Message> obiektu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> which takes a <xref:System.IO.Stream> object and a maximum header size and returns a <xref:System.ServiceModel.Channels.Message> object.</span></span>  
  
 <span data-ttu-id="d50ce-194">Jest kod napisany w tych metodach, który obsługuje konwersję między protokołu transportowego standardowe i niestandardowe kodowania.</span><span class="sxs-lookup"><span data-stu-id="d50ce-194">It is the code you write in these methods that handles conversion between the standard transport protocol, and your customized encoding.</span></span>  
  
 <span data-ttu-id="d50ce-195">Następnie trzeba klasę fabryki, która tworzy niestandardowy koder kodu.</span><span class="sxs-lookup"><span data-stu-id="d50ce-195">Next you need to code a factory class that creates your custom encoder.</span></span> <span data-ttu-id="d50ce-196">Zastąp <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> do zwrócenia wystąpienia niestandardowego <xref:System.ServiceModel.Channels.MessageEncoder>.</span><span class="sxs-lookup"><span data-stu-id="d50ce-196">Override the <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> to return an instance of your custom <xref:System.ServiceModel.Channels.MessageEncoder>.</span></span>  
  
 <span data-ttu-id="d50ce-197">Następnie połącz niestandardowe <xref:System.ServiceModel.Channels.MessageEncoderFactory> stosu element powiązania, używany do konfigurowania usługi lub klienta przez zastąpienie <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> metodę, aby zwrócić wystąpienia tej fabryki.</span><span class="sxs-lookup"><span data-stu-id="d50ce-197">Then connect your custom <xref:System.ServiceModel.Channels.MessageEncoderFactory> to the binding element stack used to configure the service or client by overriding the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> method to return an instance of this factory.</span></span>  
  
 <span data-ttu-id="d50ce-198">Istnieją dwa przykłady dostarczane z programem WCF, które ilustrują ten proces za pomocą przykładowego kodu: [Niestandardowy koder komunikatów: Niestandardowy koder tekstu](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) i [niestandardowy koder komunikatów: Koder kompresji](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="d50ce-198">There are two samples provided with WCF that illustrate this process with sample code: [Custom Message Encoder: Custom Text Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) and [Custom Message Encoder: Compression Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d50ce-199">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="d50ce-199">See also</span></span>

- <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>
- <xref:System.ServiceModel.Channels.MessageEncoderFactory>
- <xref:System.ServiceModel.Channels.MessageEncoder>
- [<span data-ttu-id="d50ce-200">Omówienie architektury transferu danych</span><span class="sxs-lookup"><span data-stu-id="d50ce-200">Data Transfer Architectural Overview</span></span>](../../../../docs/framework/wcf/feature-details/data-transfer-architectural-overview.md)
- [<span data-ttu-id="d50ce-201">Wybieranie kodera komunikatów</span><span class="sxs-lookup"><span data-stu-id="d50ce-201">Choosing a Message Encoder</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-message-encoder.md)
- [<span data-ttu-id="d50ce-202">Wybieranie transportu</span><span class="sxs-lookup"><span data-stu-id="d50ce-202">Choosing a Transport</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md)
