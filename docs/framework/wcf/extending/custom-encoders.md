---
title: Niestandardowe kodery
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: fa0e1d7f-af36-4bf4-aac9-cd4eab95bc4f
caps.latest.revision: "15"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 2b1370adc510b26b14bff0dec45d83513a2f13b3
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/02/2017
---
# <a name="custom-encoders"></a><span data-ttu-id="55759-102">Niestandardowe kodery</span><span class="sxs-lookup"><span data-stu-id="55759-102">Custom Encoders</span></span>
<span data-ttu-id="55759-103">W tym temacie omówiono tworzenie niestandardowe kodery.</span><span class="sxs-lookup"><span data-stu-id="55759-103">This topic discusses how to create custom encoders.</span></span>  
  
 <span data-ttu-id="55759-104">W [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], możesz użyć *powiązania* do określenia sposobu transferu danych za pośrednictwem sieci między punktami końcowymi.</span><span class="sxs-lookup"><span data-stu-id="55759-104">In [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], you use a *binding* to specify how to transfer data across a network between endpoints.</span></span> <span data-ttu-id="55759-105">Powiązanie składa się z sekwencji *elementów wiązania*.</span><span class="sxs-lookup"><span data-stu-id="55759-105">A binding is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="55759-106">Powiązanie zawiera opcjonalne protokołu powiązania elementów, takich jak zabezpieczeń wymaganą *kodera wiadomości* element powiązania, a element powiązania transportu wymagane.</span><span class="sxs-lookup"><span data-stu-id="55759-106">A binding includes optional protocol binding elements such as security, a required *Message Encoder* binding element, and a required transport binding element.</span></span> <span data-ttu-id="55759-107">Koder komunikatów jest reprezentowana przez powiązanie element kodowania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="55759-107">A message encoder is represented by a message encoding binding element.</span></span> <span data-ttu-id="55759-108">Trzy koderów wiadomości są uwzględnione w [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]: Binary, mechanizmu optymalizacji transmisji wiadomości (MTOM) i tekstu.</span><span class="sxs-lookup"><span data-stu-id="55759-108">Three message encoders are included in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]: Binary, Message Transmission Optimization Mechanism (MTOM), and Text.</span></span>  
  
 <span data-ttu-id="55759-109">Komunikat kodowania element powiązania serializuje wychodzące <xref:System.ServiceModel.Channels.Message> i przekazuje je do transportu, lub odbiera serializacji formę komunikat z transportu i przekazuje ją do warstwy protokołu, jeśli istnieje, lub do aplikacji, jeśli nie są zainstalowane.</span><span class="sxs-lookup"><span data-stu-id="55759-109">A message encoding binding element serializes an outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport, or receives the serialized form of a message from the transport and passes it to the protocol layer if present, or to the application, if not present.</span></span>  
  
 <span data-ttu-id="55759-110">Przekształć koderów komunikat <xref:System.ServiceModel.Channels.Message> wystąpień do i z reprezentacji danych przesyłanych w sieci.</span><span class="sxs-lookup"><span data-stu-id="55759-110">Message encoders transform <xref:System.ServiceModel.Channels.Message> instances to and from a wire representation.</span></span> <span data-ttu-id="55759-111">Mimo że koderów są nazywane siedzącą powyżej warstwy transportu w stosie kanału, znajdują się one wewnątrz warstwy transportowej.</span><span class="sxs-lookup"><span data-stu-id="55759-111">Although encoders are described as sitting above the transport layer in the channel stack, they reside inside the transport layer.</span></span> <span data-ttu-id="55759-112">Wiadomość zgodnie z wymaganiami standardu transportu w formacie transportów (na przykład HTTP).</span><span class="sxs-lookup"><span data-stu-id="55759-112">Transports (for example HTTP) format the message according to the requirements of the transport standard.</span></span> <span data-ttu-id="55759-113">Kodery (na przykład tekstu Xml) tylko kodowania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="55759-113">Encoders (for example Text Xml) just encode the message.</span></span>  
  
 <span data-ttu-id="55759-114">Podczas łączenia z istniejących klienta lub serwera, możesz nie mieć wybór o przy użyciu określonego komunikatu kodowania.</span><span class="sxs-lookup"><span data-stu-id="55759-114">When connecting to a preexisting client or server, you may not have a choice about using a particular message encoding.</span></span> <span data-ttu-id="55759-115">Jednak [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] usług można udostępnić za pośrednictwem wiele punktów końcowych, każde z nich koder inny komunikat.</span><span class="sxs-lookup"><span data-stu-id="55759-115">However, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services can be made accessible through multiple endpoints, each with a different message encoder.</span></span> <span data-ttu-id="55759-116">Gdy jeden koder nie obejmuje całego odbiorców dla usługi, należy wziąć pod uwagę udostępnianie usługi przez wiele punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="55759-116">When a single encoder does not cover the entire audience for your service, consider exposing your service over multiple endpoints.</span></span> <span data-ttu-id="55759-117">Aplikacje klienckie można wybrać punkt końcowy, który jest najlepsze dla nich.</span><span class="sxs-lookup"><span data-stu-id="55759-117">Client applications can then choose the endpoint that is best for them.</span></span> <span data-ttu-id="55759-118">Przy użyciu wielu punktów końcowych pozwala na połączenie korzyści wynikające z koderów inny komunikat z innymi elementami powiązania.</span><span class="sxs-lookup"><span data-stu-id="55759-118">Using multiple endpoints allows you to combine the advantages of different message encoders with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="55759-119">Kodery dostarczane przez system</span><span class="sxs-lookup"><span data-stu-id="55759-119">System-Provided Encoders</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="55759-120">udostępnia kilka powiązania dostarczane przez system, które są zaprojektowane tak, aby pokrywał najbardziej typowych scenariuszy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="55759-120"> provides several system-provided bindings that are designed to cover the most common application scenarios.</span></span> <span data-ttu-id="55759-121">Każdy z tych powiązań połączenie transportu, kodera wiadomości i inne opcje (na przykład zabezpieczeń).</span><span class="sxs-lookup"><span data-stu-id="55759-121">Each of these bindings combine a transport, message encoder, and other options (security, for example).</span></span> <span data-ttu-id="55759-122">W tym temacie opisano, jak rozszerzyć `Text`, `Binary`, i `MTOM` komunikatu koderów, które znajdują się w [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], lub utworzyć niestandardowego kodera.</span><span class="sxs-lookup"><span data-stu-id="55759-122">This topic describes how to extend the `Text`, `Binary`, and `MTOM` message encoders that are included in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], or create your own custom encoder.</span></span> <span data-ttu-id="55759-123">Tekst koder komunikatów obsługuje zarówno zwykły Kodowanie XML oraz kodowania protokołu SOAP.</span><span class="sxs-lookup"><span data-stu-id="55759-123">The text message encoder supports both a plain XML encoding as well as SOAP encodings.</span></span> <span data-ttu-id="55759-124">Zwykły tryb kodowania XML kodera wiadomości tekstowych nosi nazwę kodera POX ("XML starego zwykły") odróżniający go od tekstowych kodowaniu protokołu SOAP.</span><span class="sxs-lookup"><span data-stu-id="55759-124">The plain XML encoding mode of the text message encoder is called the POX ("Plain Old XML") encoder to distinguish it from the text-based SOAP encoding.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="55759-125">kombinacje dostarczonych przez powiązania dostarczane przez system elementów powiązania w sekcji odpowiednie w [Wybieranie transportu](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="55759-125"> the combinations of binding elements provided by the system-provided bindings, see the corresponding section in [Choosing a Transport](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span></span>  
  
## <a name="how-to-work-with-system-provided-encoders"></a><span data-ttu-id="55759-126">Jak pracować z koderów dostarczane przez System</span><span class="sxs-lookup"><span data-stu-id="55759-126">How to Work with System-Provided Encoders</span></span>  
 <span data-ttu-id="55759-127">Kodowanie jest dodawany do powiązania za pomocą klasy pochodzącej od <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="55759-127">An encoding is added to a binding using a class derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="55759-128">udostępnia następujące elementy powiązania pochodną <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> klasy, która może zapewnić tekstu, dane binarne i kodowanie mechanizmu optymalizacji transmisji wiadomości (MTOM):</span><span class="sxs-lookup"><span data-stu-id="55759-128"> provides the following types of binding elements derived from the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> class that can provide for text, binary and Message Transmission Optimization Mechanism (MTOM) encoding:</span></span>  
  
-   <span data-ttu-id="55759-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: Najbardziej współdziałanie, ale najmniej wydajne koder komunikatów XML.</span><span class="sxs-lookup"><span data-stu-id="55759-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: The most interoperable, but the least efficient encoder for XML messages.</span></span> <span data-ttu-id="55759-130">Usługa sieci Web lub klient usługi sieci Web zwykle zrozumieć tekstowy XML.</span><span class="sxs-lookup"><span data-stu-id="55759-130">A Web service or Web service client can generally understand textual XML.</span></span> <span data-ttu-id="55759-131">Jednak przesyłania dużych bloków danych binarnych jako tekst nie jest skuteczne.</span><span class="sxs-lookup"><span data-stu-id="55759-131">However, transmitting large blocks of binary data as text is not efficient.</span></span>  
  
-   <span data-ttu-id="55759-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Reprezentuje element powiązania, który określa kodowanie znaków i komunikatu versioning używanego w formacie binarnym komunikatów XML.</span><span class="sxs-lookup"><span data-stu-id="55759-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for binary-based XML messages.</span></span> <span data-ttu-id="55759-133">Jest to najbardziej efektywny opcji kodowania, ale najmniej interoperacyjne, ponieważ jest obsługiwany tylko przez [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="55759-133">This is most efficient of the encoding options, but the least interoperable, because it is only supported by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoints.</span></span>  
  
-   <span data-ttu-id="55759-134"><<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement -->`System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`>: reprezentuje element powiązania, który określa kodowanie znaków i wersji komunikatu używany przy użyciu mechanizmu optymalizacji transmisji wiadomości (MTOM) kodowania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="55759-134"><<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`>: Represents the binding element that specifies the character encoding and message versioning used for a message using a Message Transmission Optimization Mechanism (MTOM) encoding.</span></span> <span data-ttu-id="55759-135">MTOM jest technologią wydajne przekazywania danych binarnych w [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] wiadomości.</span><span class="sxs-lookup"><span data-stu-id="55759-135">MTOM is an efficient technology for transmitting binary data in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] messages.</span></span> <span data-ttu-id="55759-136">Koder MTOM próbuje równowaga między wydajności i współdziałanie.</span><span class="sxs-lookup"><span data-stu-id="55759-136">The MTOM encoder attempts to balance between efficiency and interoperability.</span></span> <span data-ttu-id="55759-137">Kodowanie MTOM przesyła większości XML w postaci tekstowej, ale optymalizuje dużych bloków danych binarnych, przekazując je jako — Brak konwersji na tekst.</span><span class="sxs-lookup"><span data-stu-id="55759-137">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span>  
  
 <span data-ttu-id="55759-138">Tworzy element powiązania pliku binarnego, MTOM lub tekst <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span><span class="sxs-lookup"><span data-stu-id="55759-138">The binding element creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span></span> <span data-ttu-id="55759-139">Tworzy fabrykę pliku binarnego, MTOM lub tekst <xref:System.ServiceModel.Channels.MessageEncoderFactory> wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="55759-139">The factory creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory> instance.</span></span> <span data-ttu-id="55759-140">Zazwyczaj jest tylko jedno wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="55759-140">Typically, there is only a single instance.</span></span> <span data-ttu-id="55759-141">Jednak sesji są używane, mogą być dostarczane do każdej sesji kodera innego.</span><span class="sxs-lookup"><span data-stu-id="55759-141">However if sessions are used, a different encoder may be provided to each session.</span></span> <span data-ttu-id="55759-142">Kodera binarnego sprawia, że użycie tego do koordynowania słowniki dynamiczne (patrz infrastruktury XML).</span><span class="sxs-lookup"><span data-stu-id="55759-142">The Binary encoder makes use of this to coordinate dynamic dictionaries (see XML Infrastructure).</span></span>  
  
 <span data-ttu-id="55759-143"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> i <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> metody są podstawowe koderów.</span><span class="sxs-lookup"><span data-stu-id="55759-143">The <xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> and <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> methods are the core of the encoders.</span></span> <span data-ttu-id="55759-144">Metody zapewnienia czytania wiadomości z strumienia lub <xref:System.Byte> tablicy.</span><span class="sxs-lookup"><span data-stu-id="55759-144">The methods provide for reading a message from a stream or from a <xref:System.Byte> array.</span></span> <span data-ttu-id="55759-145">Tablice typu byte są używane podczas transportu działa w trybie buforowanego.</span><span class="sxs-lookup"><span data-stu-id="55759-145">Byte arrays are used when the transport is operating in buffered mode.</span></span> <span data-ttu-id="55759-146">Wiadomości są zawsze zapisywane do strumieni.</span><span class="sxs-lookup"><span data-stu-id="55759-146">Messages are always written to streams.</span></span> <span data-ttu-id="55759-147">Jeśli transport musi buforu wiadomości, zapewnia strumienia, który wykonuje buforowania.</span><span class="sxs-lookup"><span data-stu-id="55759-147">If the transport must buffer the message, it provides a stream that does the buffering.</span></span>  
  
 <span data-ttu-id="55759-148">Pozostałe elementy pracy z zawartości, typów nośników pomocy technicznej i <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span><span class="sxs-lookup"><span data-stu-id="55759-148">The rest of the members work with support content, media types, and <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span></span> <span data-ttu-id="55759-149">Transport wymaga tych metod kodera, aby sprawdzić, czy komunikat przychodzący może zostać odczytany przez ten lub w celu ustalenia, czy komunikatu wychodzącego jest prawidłowy dla tego kodera.</span><span class="sxs-lookup"><span data-stu-id="55759-149">The transport calls these encoder methods to test whether the incoming message can be decoded by it, or to determine if the outgoing message is valid for this encoder.</span></span>  
  
 <span data-ttu-id="55759-150">Każda z trzech implementacji kodera dodaje właściwości, które mają zastosowanie do określonego kodowania i jest w pełni konfigurowalne.</span><span class="sxs-lookup"><span data-stu-id="55759-150">Each of the three encoder implementations adds properties that are relevant to the specific encodings and is fully configurable.</span></span> <span data-ttu-id="55759-151">Kodery uwidacznia również czytnika przydziałów, które mają bezpieczne ustawienia domyślne.</span><span class="sxs-lookup"><span data-stu-id="55759-151">The encoders also expose reader quotas that have secure defaults.</span></span> <span data-ttu-id="55759-152">Zobacz infrastruktura XML Omówienie przydziałów.</span><span class="sxs-lookup"><span data-stu-id="55759-152">See XML Infrastructure for a discussion of the quotas.</span></span>  
  
## <a name="features-of-system-provided-encoders"></a><span data-ttu-id="55759-153">Funkcje koderów dostarczane przez System</span><span class="sxs-lookup"><span data-stu-id="55759-153">Features of System-Provided Encoders</span></span>  
 <span data-ttu-id="55759-154">Istnieje szereg funkcji udostępnianych przez kodery dostarczane przez system.</span><span class="sxs-lookup"><span data-stu-id="55759-154">There are a number of features provided by the system-provided encoders.</span></span>  
  
### <a name="pooling"></a><span data-ttu-id="55759-155">Buforowanie</span><span class="sxs-lookup"><span data-stu-id="55759-155">Pooling</span></span>  
 <span data-ttu-id="55759-156">Każda z implementacji kodera próbuje puli, jak to możliwe.</span><span class="sxs-lookup"><span data-stu-id="55759-156">Each of the encoder implementations tries to pool as much as possible.</span></span> <span data-ttu-id="55759-157">Zmniejszenie alokacji jest klucza sposób, aby poprawić wydajność kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="55759-157">Reducing allocations is a key way to improve the performance of managed code.</span></span> <span data-ttu-id="55759-158">Do wykonania tej puli, użyj implementacje `SynchronizedPool` klasy.</span><span class="sxs-lookup"><span data-stu-id="55759-158">To accomplish this pooling, the implementations use the `SynchronizedPool` class.</span></span> <span data-ttu-id="55759-159">C# plik zawiera opis dodatkowe optymalizacje używane przez tę klasę.</span><span class="sxs-lookup"><span data-stu-id="55759-159">The C# file contains a description of the additional optimizations used by this class.</span></span>  
  
 <span data-ttu-id="55759-160">`XmlDictionaryReader`i `XmlDictionaryWriter` wystąpienia są grupowane w pulach i ponownie zainicjowano zapobiegające przydzielania nowych dla każdego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="55759-160">`XmlDictionaryReader` and `XmlDictionaryWriter` instances are pooled and reinitialized to prevent allocating new ones for each message.</span></span> <span data-ttu-id="55759-161">Czytniki `OnClose` wywołania zwrotnego zwraca czytnik podczas `Close()` jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="55759-161">For the readers, an `OnClose` callback reclaims the reader when `Close()` is called.</span></span> <span data-ttu-id="55759-162">Koder odtwarza także niektóre obiekty stanu komunikatów używana podczas tworzenia wiadomości.</span><span class="sxs-lookup"><span data-stu-id="55759-162">The encoder also recycles some message state objects used when constructing messages.</span></span> <span data-ttu-id="55759-163">Rozmiary te pule są konfigurowane przez `MaxReadPoolSize` i `MaxWritePoolSize` właściwości dla wszystkich trzech klas pochodnych <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="55759-163">The sizes of these pools are configurable by the `MaxReadPoolSize` and `MaxWritePoolSize` properties on each of the three classes derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
### <a name="binary-encoding"></a><span data-ttu-id="55759-164">Kodowanie binarne</span><span class="sxs-lookup"><span data-stu-id="55759-164">Binary Encoding</span></span>  
 <span data-ttu-id="55759-165">Gdy binarny kodowanie używane sesje, ciąg dynamiczny słownik powiadamia odbiorcy wiadomości.</span><span class="sxs-lookup"><span data-stu-id="55759-165">When binary encoding uses sessions, the dynamic dictionary string must be communicated to the receiver of the message.</span></span> <span data-ttu-id="55759-166">Jest to realizowane przez prefiksu wiadomości z ciągami dynamiczny słownik.</span><span class="sxs-lookup"><span data-stu-id="55759-166">This is done by prefixing the message with the dynamic dictionary strings.</span></span> <span data-ttu-id="55759-167">Odbiornik taśmy poza ciągi, dodaje je do sesji i przetwarza wiadomość.</span><span class="sxs-lookup"><span data-stu-id="55759-167">The receiver strips off the strings, adds them to the session, and processes the message.</span></span> <span data-ttu-id="55759-168">Poprawnie przesłaniem słownika wymaga buforowane transportu.</span><span class="sxs-lookup"><span data-stu-id="55759-168">Correctly passing dictionary strings requires that the transport be buffered.</span></span>  
  
 <span data-ttu-id="55759-169">Ciągi są dołączane do wiadomości przez wewnętrznego `AddSessionInformationToMessage` metody.</span><span class="sxs-lookup"><span data-stu-id="55759-169">The strings are appended to the message by an internal `AddSessionInformationToMessage` method.</span></span> <span data-ttu-id="55759-170">Dodaje ciągi jako UTF-8 na początku prefiksem ich długość komunikatu.</span><span class="sxs-lookup"><span data-stu-id="55759-170">It adds the strings as UTF-8 to the front of the message prefixed with their length.</span></span> <span data-ttu-id="55759-171">Nagłówek słownika całego jest następnie prefiksem długość danych.</span><span class="sxs-lookup"><span data-stu-id="55759-171">The entire dictionary header is then prefixed with the length of its data.</span></span> <span data-ttu-id="55759-172">Odwrotna operacja została wykonana przez wewnętrznego `ExtractSessionInformationFromMessage` metody.</span><span class="sxs-lookup"><span data-stu-id="55759-172">The reverse operation is performed by an internal `ExtractSessionInformationFromMessage` method.</span></span>  
  
 <span data-ttu-id="55759-173">Oprócz przetwarzania dynamiczny słownik kluczy, buforowane sesyjnych komunikaty są odbierane w unikatowy sposób.</span><span class="sxs-lookup"><span data-stu-id="55759-173">In addition to processing dynamic dictionary keys, buffered sessionful messages are received in a unique way.</span></span> <span data-ttu-id="55759-174">Zamiast tworzenia modułu odczytującego za pośrednictwem dokumentu i przetwarzania go, używa wewnętrznej kodera binarnego `MessagePatterns` klasy deconstruct strumienia danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="55759-174">Instead of creating a reader over the document and processing it, the binary encoder uses the internal `MessagePatterns` class to deconstruct the binary stream.</span></span> <span data-ttu-id="55759-175">Pomysł jest większość komunikatów w określonym zestawie nagłówków, które pojawiają się w określonej kolejności podczas generowania przez [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="55759-175">The idea is that most messages have a certain set of headers that show up in a certain order when generated by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span></span> <span data-ttu-id="55759-176">System wzorzec dzieli komunikat od siebie oparte na go oczekuje.</span><span class="sxs-lookup"><span data-stu-id="55759-176">The pattern system breaks the message apart based on what it expects.</span></span> <span data-ttu-id="55759-177">Jeśli ten zakończy się powodzeniem, inicjuje <xref:System.ServiceModel.Channels.MessageHeaders> obiektu bez podczas analizowania pliku XML.</span><span class="sxs-lookup"><span data-stu-id="55759-177">If it is successful, it initializes a <xref:System.ServiceModel.Channels.MessageHeaders> object without parsing the XML.</span></span> <span data-ttu-id="55759-178">Jeśli nie, nastąpi powrót do standardowej metody.</span><span class="sxs-lookup"><span data-stu-id="55759-178">If not, it falls back to the standard method.</span></span>  
  
### <a name="mtom-encoding"></a><span data-ttu-id="55759-179">Kodowanie MTOM</span><span class="sxs-lookup"><span data-stu-id="55759-179">MTOM Encoding</span></span>  
 <span data-ttu-id="55759-180"><<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`> Klasa ma właściwość dodatkowe czynności konfiguracyjne o nazwie <<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`. Wartość MaxBufferSize 2A % >.</span><span class="sxs-lookup"><span data-stu-id="55759-180">The <<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`> class has an additional configuration property called <<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`.MaxBufferSize%2A>.</span></span> <span data-ttu-id="55759-181">Górna granica zostanie umieszczone w ilości danych jest dozwolone do zbuforowania podczas odczytywania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="55759-181">This places an upper bound on how much data it is allowed to buffer during the process of reading a message.</span></span> <span data-ttu-id="55759-182">XML informacji o zestawie (obiekt typu Infoset) lub innych części MIME może być konieczne buforowane odtworzyć wszystkie części MIME w pojedynczym komunikacie.</span><span class="sxs-lookup"><span data-stu-id="55759-182">The XML Information Set (Infoset), or other MIME parts, may need to be buffered to reassemble all the MIME parts into a single message.</span></span>  
  
 <span data-ttu-id="55759-183">Działała prawidłowo, protokołu HTTP, Wewnętrzna klasa koder komunikatu MTOM zapewnia niektórych wewnętrznych interfejsów API dla `GetContentType` (która jest również wewnętrznego) i `WriteMessage`, który nie jest publiczny i może zostać zastąpiona.</span><span class="sxs-lookup"><span data-stu-id="55759-183">To work correctly with HTTP, the internal MTOM message encoder class provides some internal APIs for `GetContentType` (which is also internal) and `WriteMessage`, which is public and can be overridden.</span></span> <span data-ttu-id="55759-184">Więcej komunikacji należy przeprowadzić, aby upewnić się, że wartości w nagłówkach HTTP zgodne z wartościami w nagłówkach MIME.</span><span class="sxs-lookup"><span data-stu-id="55759-184">More communication must occur to ensure values in the HTTP headers agree with values in the MIME headers.</span></span>  
  
 <span data-ttu-id="55759-185">Wewnętrznie, MTOM koder komunikatów używa [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]na tekst czytelników i jest podobny do kodera tekstu.</span><span class="sxs-lookup"><span data-stu-id="55759-185">Internally, the MTOM message encoder uses [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]'s text readers, and is similar to the Text encoder.</span></span> <span data-ttu-id="55759-186">Główną różnicą jest optymalizowany duże zestawy danych binarnych lub "Duże obiekty binarne" (BLOB), konwertując nie je przed osadzona w bajtach komunikat kodowanie Base-64.</span><span class="sxs-lookup"><span data-stu-id="55759-186">The main difference is that it optimizes large chunks of binary, or "Binary Large Objects" (BLOBs), by not converting them to Base-64 encoding prior to being embedded into the message bytes.</span></span> <span data-ttu-id="55759-187">Zamiast tego te obiekty BLOB są przechowywane wyodrębnionego i do którego istnieje odwołanie jako załączniki MIME.</span><span class="sxs-lookup"><span data-stu-id="55759-187">Instead, these BLOBs are kept extracted, and referenced as the MIME attachments.</span></span>  
  
## <a name="writing-your-own-encoder"></a><span data-ttu-id="55759-188">Pisanie własnych kodera</span><span class="sxs-lookup"><span data-stu-id="55759-188">Writing your own Encoder</span></span>  
 <span data-ttu-id="55759-189">Aby wdrożyć własny niestandardowy koder komunikatów, należy podać niestandardowy implementacje abstrakcyjnych klas podstawowych:</span><span class="sxs-lookup"><span data-stu-id="55759-189">To implement your own custom message encoder, you must provide custom implementations of the following abstract base classes:</span></span>  
  
-   <xref:System.ServiceModel.Channels.MessageEncoder>  
  
-   <xref:System.ServiceModel.Channels.MessageEncoderFactory>  
  
-   <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>  
  
 <span data-ttu-id="55759-190">Konwertowanie z reprezentacji w pamięci wiadomości do reprezentacji, które mogą być zapisywane do strumienia jest hermetyzowany wewnątrz <xref:System.ServiceModel.Channels.MessageEncoder> klasy, która służy jako fabrykę dla czytników XML i zapisywania XML, które obsługują określone typy kodowań XML.</span><span class="sxs-lookup"><span data-stu-id="55759-190">Converting from the in-memory representation of a message to a representation that can be written to a stream is encapsulated within the <xref:System.ServiceModel.Channels.MessageEncoder> class, which serves as a factory for XML readers and XML writers that support specific types of XML encodings.</span></span>  
  
-   <span data-ttu-id="55759-191">Klucza metody tej klasy, który należy zastąpić to:</span><span class="sxs-lookup"><span data-stu-id="55759-191">The key methods of this class that you must override are:</span></span>  
  
-   <span data-ttu-id="55759-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A>który bierze <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> obiektu i zapisuje go w <xref:System.IO.Stream> obiektu.</span><span class="sxs-lookup"><span data-stu-id="55759-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> which takes a <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> object and writes it into a <xref:System.IO.Stream> object.</span></span>  
  
-   <span data-ttu-id="55759-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A>który bierze <xref:System.IO.Stream> obiektu i rozmiar maksymalny nagłówka i zwraca <xref:System.ServiceModel.Channels.Message> obiektu.</span><span class="sxs-lookup"><span data-stu-id="55759-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> which takes a <xref:System.IO.Stream> object and a maximum header size and returns a <xref:System.ServiceModel.Channels.Message> object.</span></span>  
  
 <span data-ttu-id="55759-194">Jest kod napisany w tych metod, obsługujący konwersja między protokołu transportu standardowe i niestandardowe kodowania.</span><span class="sxs-lookup"><span data-stu-id="55759-194">It is the code you write in these methods that handles conversion between the standard transport protocol, and your customized encoding.</span></span>  
  
 <span data-ttu-id="55759-195">Następnie należy kodu klasy fabryki, która tworzy niestandardowego kodera.</span><span class="sxs-lookup"><span data-stu-id="55759-195">Next you need to code a factory class that creates your custom encoder.</span></span> <span data-ttu-id="55759-196">Zastąpienie <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> można zwrócić wystąpienia niestandardowego <xref:System.ServiceModel.Channels.MessageEncoder>.</span><span class="sxs-lookup"><span data-stu-id="55759-196">Override the <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> to return an instance of your custom <xref:System.ServiceModel.Channels.MessageEncoder>.</span></span>  
  
 <span data-ttu-id="55759-197">Następnie podłącz niestandardowe <xref:System.ServiceModel.Channels.MessageEncoderFactory> stosu element powiązania, używany do konfigurowania usługi lub klienta przez zastąpienie <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> metodę, aby zwrócić wystąpienia tej fabryki.</span><span class="sxs-lookup"><span data-stu-id="55759-197">Then connect your custom <xref:System.ServiceModel.Channels.MessageEncoderFactory> to the binding element stack used to configure the service or client by overriding the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> method to return an instance of this factory.</span></span>  
  
 <span data-ttu-id="55759-198">Istnieją dwa przykłady z [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] który zilustrowanie tego procesu z przykładowym kodzie: [niestandardowy koder komunikatów: niestandardowy koder tekstu](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) i [niestandardowy koder komunikatów: koder kompresji](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="55759-198">There are two samples provided with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] that illustrate this process with sample code: [Custom Message Encoder: Custom Text Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) and [Custom Message Encoder: Compression Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="55759-199">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="55759-199">See Also</span></span>  
 <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>  
 <xref:System.ServiceModel.Channels.MessageEncoderFactory>  
 <xref:System.ServiceModel.Channels.MessageEncoder>  
 [<span data-ttu-id="55759-200">Omówienie architektury transferu danych</span><span class="sxs-lookup"><span data-stu-id="55759-200">Data Transfer Architectural Overview</span></span>](../../../../docs/framework/wcf/feature-details/data-transfer-architectural-overview.md)  
 [<span data-ttu-id="55759-201">Wybieranie kodera komunikatów</span><span class="sxs-lookup"><span data-stu-id="55759-201">Choosing a Message Encoder</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-message-encoder.md)  
 [<span data-ttu-id="55759-202">Wybieranie transportu</span><span class="sxs-lookup"><span data-stu-id="55759-202">Choosing a Transport</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md)
