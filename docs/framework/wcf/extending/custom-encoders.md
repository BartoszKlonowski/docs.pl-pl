---
title: Niestandardowe kodery
ms.date: 03/30/2017
ms.assetid: fa0e1d7f-af36-4bf4-aac9-cd4eab95bc4f
ms.openlocfilehash: 586207af0bfbe106512dfb61ee7439d4f5ce64c6
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/07/2019
ms.locfileid: "70797218"
---
# <a name="custom-encoders"></a><span data-ttu-id="80ee1-102">Niestandardowe kodery</span><span class="sxs-lookup"><span data-stu-id="80ee1-102">Custom Encoders</span></span>
<span data-ttu-id="80ee1-103">W tym temacie omówiono sposób tworzenia koderów niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="80ee1-103">This topic discusses how to create custom encoders.</span></span>  
  
 <span data-ttu-id="80ee1-104">W programie Windows Communication Foundation (WCF) można użyć *powiązania* , aby określić sposób transferu danych między punktami końcowymi.</span><span class="sxs-lookup"><span data-stu-id="80ee1-104">In Windows Communication Foundation (WCF), you use a *binding* to specify how to transfer data across a network between endpoints.</span></span> <span data-ttu-id="80ee1-105">Powiązanie składa się z sekwencji *elementów powiązania*.</span><span class="sxs-lookup"><span data-stu-id="80ee1-105">A binding is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="80ee1-106">Powiązanie obejmuje opcjonalne elementy powiązania protokołów, takie jak zabezpieczenia, wymagany element powiązania *kodera komunikatów* i wymagany element powiązania transportu.</span><span class="sxs-lookup"><span data-stu-id="80ee1-106">A binding includes optional protocol binding elements such as security, a required *Message Encoder* binding element, and a required transport binding element.</span></span> <span data-ttu-id="80ee1-107">Koder komunikatów jest reprezentowany przez element powiązania kodowania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="80ee1-107">A message encoder is represented by a message encoding binding element.</span></span> <span data-ttu-id="80ee1-108">W programie WCF są zawarte trzy kodery komunikatów: Plik binarny, mechanizm optymalizacji transmisji wiadomości (MTOM) i tekst.</span><span class="sxs-lookup"><span data-stu-id="80ee1-108">Three message encoders are included in WCF: Binary, Message Transmission Optimization Mechanism (MTOM), and Text.</span></span>  
  
 <span data-ttu-id="80ee1-109">Element powiązania kodowania komunikatu serializować wychodzące <xref:System.ServiceModel.Channels.Message> i przekazuje je do transportu lub otrzymuje serializowaną postać komunikatu z transportu i przekazuje go do warstwy protokołu, jeśli jest obecny lub do aplikacji, jeśli nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="80ee1-109">A message encoding binding element serializes an outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport, or receives the serialized form of a message from the transport and passes it to the protocol layer if present, or to the application, if not present.</span></span>  
  
 <span data-ttu-id="80ee1-110">Kodery komunikatów przekształcają <xref:System.ServiceModel.Channels.Message> wystąpienia na i z reprezentacji przewodowej.</span><span class="sxs-lookup"><span data-stu-id="80ee1-110">Message encoders transform <xref:System.ServiceModel.Channels.Message> instances to and from a wire representation.</span></span> <span data-ttu-id="80ee1-111">Chociaż kodery są opisane jako miejsce powyżej warstwy transportu w stosie kanałów, znajdują się wewnątrz warstwy transportowej.</span><span class="sxs-lookup"><span data-stu-id="80ee1-111">Although encoders are described as sitting above the transport layer in the channel stack, they reside inside the transport layer.</span></span> <span data-ttu-id="80ee1-112">Transporty (na przykład HTTP) formatują komunikat zgodnie z wymaganiami standardu transportowego.</span><span class="sxs-lookup"><span data-stu-id="80ee1-112">Transports (for example HTTP) format the message according to the requirements of the transport standard.</span></span> <span data-ttu-id="80ee1-113">Kodery (na przykład tekstowe XML) po prostu kodują komunikat.</span><span class="sxs-lookup"><span data-stu-id="80ee1-113">Encoders (for example Text Xml) just encode the message.</span></span>  
  
 <span data-ttu-id="80ee1-114">Podczas nawiązywania połączenia z istniejącym klientem lub serwerem może nie być możliwe wybranie określonego kodowania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="80ee1-114">When connecting to a preexisting client or server, you may not have a choice about using a particular message encoding.</span></span> <span data-ttu-id="80ee1-115">Jednak usługi WCF można udostępnić za pomocą wielu punktów końcowych, z których każdy ma inny koder komunikatów.</span><span class="sxs-lookup"><span data-stu-id="80ee1-115">However, WCF services can be made accessible through multiple endpoints, each with a different message encoder.</span></span> <span data-ttu-id="80ee1-116">Gdy pojedynczy koder nie obejmuje wszystkich odbiorców usługi, należy rozważyć udostępnienie usługi w wielu punktach końcowych.</span><span class="sxs-lookup"><span data-stu-id="80ee1-116">When a single encoder does not cover the entire audience for your service, consider exposing your service over multiple endpoints.</span></span> <span data-ttu-id="80ee1-117">Aplikacje klienckie mogą następnie wybrać punkt końcowy, który jest najlepszy dla nich.</span><span class="sxs-lookup"><span data-stu-id="80ee1-117">Client applications can then choose the endpoint that is best for them.</span></span> <span data-ttu-id="80ee1-118">Używanie wielu punktów końcowych pozwala łączyć zalety różnych koderów komunikatów z innymi elementami powiązania.</span><span class="sxs-lookup"><span data-stu-id="80ee1-118">Using multiple endpoints allows you to combine the advantages of different message encoders with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="80ee1-119">Kodery dostarczone przez system</span><span class="sxs-lookup"><span data-stu-id="80ee1-119">System-Provided Encoders</span></span>  
 <span data-ttu-id="80ee1-120">Funkcja WCF udostępnia kilka powiązań dostarczonych przez system, które są przeznaczone do obsługi najpopularniejszych scenariuszy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="80ee1-120">WCF provides several system-provided bindings that are designed to cover the most common application scenarios.</span></span> <span data-ttu-id="80ee1-121">Każde z tych powiązań łączy transport, koder komunikatów i inne opcje (na przykład zabezpieczenia).</span><span class="sxs-lookup"><span data-stu-id="80ee1-121">Each of these bindings combine a transport, message encoder, and other options (security, for example).</span></span> <span data-ttu-id="80ee1-122">W tym temacie opisano sposób `Text`, w jaki można rozmieścić kodery, `Binary`, i `MTOM` , które znajdują się w programie WCF, lub utworzyć własny koder niestandardowy.</span><span class="sxs-lookup"><span data-stu-id="80ee1-122">This topic describes how to extend the `Text`, `Binary`, and `MTOM` message encoders that are included in WCF, or create your own custom encoder.</span></span> <span data-ttu-id="80ee1-123">Koder wiadomości SMS obsługuje zarówno zwykłe Kodowanie XML, jak i kodowania SOAP.</span><span class="sxs-lookup"><span data-stu-id="80ee1-123">The text message encoder supports both a plain XML encoding as well as SOAP encodings.</span></span> <span data-ttu-id="80ee1-124">Tryb zwykłego kodowania XML kodera wiadomości tekstowej nazywa się koderem POX ("zwykłym starym XML") w celu odróżnienia go od tekstowego kodowania SOAP.</span><span class="sxs-lookup"><span data-stu-id="80ee1-124">The plain XML encoding mode of the text message encoder is called the POX ("Plain Old XML") encoder to distinguish it from the text-based SOAP encoding.</span></span>  
  
 <span data-ttu-id="80ee1-125">Aby uzyskać więcej informacji na temat kombinacji elementów powiązania dostarczonych przez powiązania dostarczone przez system, zapoznaj się z odpowiednią sekcją w temacie [Wybieranie transportu](../feature-details/choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="80ee1-125">For more information about the combinations of binding elements provided by the system-provided bindings, see the corresponding section in [Choosing a Transport](../feature-details/choosing-a-transport.md).</span></span>  
  
## <a name="how-to-work-with-system-provided-encoders"></a><span data-ttu-id="80ee1-126">Jak korzystać z koderów dostarczonych przez system</span><span class="sxs-lookup"><span data-stu-id="80ee1-126">How to Work with System-Provided Encoders</span></span>  
 <span data-ttu-id="80ee1-127">Kodowanie jest dodawane do powiązania przy użyciu klasy pochodnej z <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="80ee1-127">An encoding is added to a binding using a class derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
 <span data-ttu-id="80ee1-128">Funkcja WCF udostępnia następujące typy elementów powiązania, które pochodzą z <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> klasy, która może zapewniać kodowanie tekstu, binarnego i mechanizmu optymalizacji transmisji wiadomości (MTOM):</span><span class="sxs-lookup"><span data-stu-id="80ee1-128">WCF provides the following types of binding elements derived from the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> class that can provide for text, binary and Message Transmission Optimization Mechanism (MTOM) encoding:</span></span>  
  
- <span data-ttu-id="80ee1-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: Najbardziej interoperacyjny, ale najmniej wydajny koder dla wiadomości XML.</span><span class="sxs-lookup"><span data-stu-id="80ee1-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: The most interoperable, but the least efficient encoder for XML messages.</span></span> <span data-ttu-id="80ee1-130">Usługa sieci Web lub klient usługi sieci Web może ogólnie zrozumieć tekst XML.</span><span class="sxs-lookup"><span data-stu-id="80ee1-130">A Web service or Web service client can generally understand textual XML.</span></span> <span data-ttu-id="80ee1-131">Jednak przesyłanie dużych bloków danych binarnych jako tekstu nie jest wydajne.</span><span class="sxs-lookup"><span data-stu-id="80ee1-131">However, transmitting large blocks of binary data as text is not efficient.</span></span>  
  
- <span data-ttu-id="80ee1-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Reprezentuje element powiązania, który określa kodowanie znaków i przechowywanie wersji komunikatów używanych dla binarnych komunikatów XML.</span><span class="sxs-lookup"><span data-stu-id="80ee1-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for binary-based XML messages.</span></span> <span data-ttu-id="80ee1-133">Jest to najbardziej wydajne Opcje kodowania, ale najmniej interoperacyjności, ponieważ są obsługiwane tylko przez punkty końcowe WCF.</span><span class="sxs-lookup"><span data-stu-id="80ee1-133">This is most efficient of the encoding options, but the least interoperable, because it is only supported by WCF endpoints.</span></span>  
  
- <span data-ttu-id="80ee1-134"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>: Reprezentuje element powiązania, który określa kodowanie znaków i przechowywanie wersji komunikatów używanej przez komunikat przy użyciu mechanizmu optymalizacji transmisji wiadomości (MTOM).</span><span class="sxs-lookup"><span data-stu-id="80ee1-134"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for a message using a Message Transmission Optimization Mechanism (MTOM) encoding.</span></span> <span data-ttu-id="80ee1-135">MTOM to wydajna technologia przesyłania danych binarnych w komunikatach programu WCF.</span><span class="sxs-lookup"><span data-stu-id="80ee1-135">MTOM is an efficient technology for transmitting binary data in WCF messages.</span></span> <span data-ttu-id="80ee1-136">Koder MTOM próbuje zrównoważyć wydajność i współdziałanie.</span><span class="sxs-lookup"><span data-stu-id="80ee1-136">The MTOM encoder attempts to balance between efficiency and interoperability.</span></span> <span data-ttu-id="80ee1-137">Kodowanie MTOM przesyła większość XML w postaci tekstowej, ale optymalizuje duże bloki danych binarnych przez przesłanie ich bez konwersji do tekstu.</span><span class="sxs-lookup"><span data-stu-id="80ee1-137">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span>  
  
 <span data-ttu-id="80ee1-138">Element Binding tworzy dane binarne, MTOM lub text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span><span class="sxs-lookup"><span data-stu-id="80ee1-138">The binding element creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span></span> <span data-ttu-id="80ee1-139">Fabryka tworzy wystąpienie binarne, MTOM lub text <xref:System.ServiceModel.Channels.MessageEncoderFactory> .</span><span class="sxs-lookup"><span data-stu-id="80ee1-139">The factory creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory> instance.</span></span> <span data-ttu-id="80ee1-140">Zazwyczaj istnieje tylko jedno wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="80ee1-140">Typically, there is only a single instance.</span></span> <span data-ttu-id="80ee1-141">Jeśli jednak są używane sesje, do każdej sesji może być określony inny koder.</span><span class="sxs-lookup"><span data-stu-id="80ee1-141">However if sessions are used, a different encoder may be provided to each session.</span></span> <span data-ttu-id="80ee1-142">Koder binarny służy do koordynowania słowników dynamicznych (zobacz infrastruktura XML).</span><span class="sxs-lookup"><span data-stu-id="80ee1-142">The Binary encoder makes use of this to coordinate dynamic dictionaries (see XML Infrastructure).</span></span>  
  
 <span data-ttu-id="80ee1-143">Metody <xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> i<xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> są rdzeńmi koderów.</span><span class="sxs-lookup"><span data-stu-id="80ee1-143">The <xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> and <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> methods are the core of the encoders.</span></span> <span data-ttu-id="80ee1-144">Metody zapewniają odczytywanie wiadomości ze strumienia lub z <xref:System.Byte> tablicy.</span><span class="sxs-lookup"><span data-stu-id="80ee1-144">The methods provide for reading a message from a stream or from a <xref:System.Byte> array.</span></span> <span data-ttu-id="80ee1-145">Tablice bajtowe są używane, gdy transport działa w trybie buforowanym.</span><span class="sxs-lookup"><span data-stu-id="80ee1-145">Byte arrays are used when the transport is operating in buffered mode.</span></span> <span data-ttu-id="80ee1-146">Komunikaty są zawsze zapisywane w strumieniach.</span><span class="sxs-lookup"><span data-stu-id="80ee1-146">Messages are always written to streams.</span></span> <span data-ttu-id="80ee1-147">Jeśli transport musi buforować komunikat, zapewnia strumień, który wykonuje buforowanie.</span><span class="sxs-lookup"><span data-stu-id="80ee1-147">If the transport must buffer the message, it provides a stream that does the buffering.</span></span>  
  
 <span data-ttu-id="80ee1-148">Pozostała część elementów członkowskich współpracuje z obsługą zawartości, typami nośników <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>i.</span><span class="sxs-lookup"><span data-stu-id="80ee1-148">The rest of the members work with support content, media types, and <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span></span> <span data-ttu-id="80ee1-149">Transport wywołuje te metody kodera, aby sprawdzić, czy może być zdekodowany komunikat przychodzący lub określić, czy komunikat wychodzący jest prawidłowy dla tego kodera.</span><span class="sxs-lookup"><span data-stu-id="80ee1-149">The transport calls these encoder methods to test whether the incoming message can be decoded by it, or to determine if the outgoing message is valid for this encoder.</span></span>  
  
 <span data-ttu-id="80ee1-150">Każdy z trzech implementacji kodera dodaje właściwości, które są istotne dla określonych kodowań i jest w pełni konfigurowalny.</span><span class="sxs-lookup"><span data-stu-id="80ee1-150">Each of the three encoder implementations adds properties that are relevant to the specific encodings and is fully configurable.</span></span> <span data-ttu-id="80ee1-151">Kodery ujawniają również przydziały czytnika, które mają bezpieczne ustawienia domyślne.</span><span class="sxs-lookup"><span data-stu-id="80ee1-151">The encoders also expose reader quotas that have secure defaults.</span></span> <span data-ttu-id="80ee1-152">Zobacz infrastruktura XML, aby zapoznać się z omówieniem przydziałów.</span><span class="sxs-lookup"><span data-stu-id="80ee1-152">See XML Infrastructure for a discussion of the quotas.</span></span>  
  
## <a name="features-of-system-provided-encoders"></a><span data-ttu-id="80ee1-153">Funkcje koderów dostarczonych przez system</span><span class="sxs-lookup"><span data-stu-id="80ee1-153">Features of System-Provided Encoders</span></span>  
 <span data-ttu-id="80ee1-154">Kodery dostarczone przez system zapewniają wiele funkcji.</span><span class="sxs-lookup"><span data-stu-id="80ee1-154">There are a number of features provided by the system-provided encoders.</span></span>  
  
### <a name="pooling"></a><span data-ttu-id="80ee1-155">Buforowanie</span><span class="sxs-lookup"><span data-stu-id="80ee1-155">Pooling</span></span>  
 <span data-ttu-id="80ee1-156">Każda implementacja kodera próbuje być pulą, jak to możliwe.</span><span class="sxs-lookup"><span data-stu-id="80ee1-156">Each of the encoder implementations tries to pool as much as possible.</span></span> <span data-ttu-id="80ee1-157">Zmniejszenie alokacji jest najważniejszym sposobem na zwiększenie wydajności kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="80ee1-157">Reducing allocations is a key way to improve the performance of managed code.</span></span> <span data-ttu-id="80ee1-158">W celu osiągnięcia tej puli, implementacje używają `SynchronizedPool` klasy.</span><span class="sxs-lookup"><span data-stu-id="80ee1-158">To accomplish this pooling, the implementations use the `SynchronizedPool` class.</span></span> <span data-ttu-id="80ee1-159">C# Plik zawiera opis dodatkowych optymalizacji używanych przez tę klasę.</span><span class="sxs-lookup"><span data-stu-id="80ee1-159">The C# file contains a description of the additional optimizations used by this class.</span></span>  
  
 <span data-ttu-id="80ee1-160"><xref:System.Xml.XmlDictionaryReader>a <xref:System.Xml.XmlDictionaryWriter> wystąpienia są w puli i ponownie inicjowane, aby zapobiec przydzieleniu nowych dla każdego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="80ee1-160"><xref:System.Xml.XmlDictionaryReader> and <xref:System.Xml.XmlDictionaryWriter> instances are pooled and reinitialized to prevent allocating new ones for each message.</span></span> <span data-ttu-id="80ee1-161">W przypadku czytników `OnClose` wywołanie zwrotne przejmuje czytelnika `Close()` po wywołaniu.</span><span class="sxs-lookup"><span data-stu-id="80ee1-161">For the readers, an `OnClose` callback reclaims the reader when `Close()` is called.</span></span> <span data-ttu-id="80ee1-162">Koder odtwarza także obiekty stanu komunikatów używane podczas konstruowania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="80ee1-162">The encoder also recycles some message state objects used when constructing messages.</span></span> <span data-ttu-id="80ee1-163">Rozmiary tych pul można konfigurować za pomocą `MaxReadPoolSize` właściwości i `MaxWritePoolSize` dla każdej z trzech klas pochodnych od <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="80ee1-163">The sizes of these pools are configurable by the `MaxReadPoolSize` and `MaxWritePoolSize` properties on each of the three classes derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
### <a name="binary-encoding"></a><span data-ttu-id="80ee1-164">Kodowanie binarne</span><span class="sxs-lookup"><span data-stu-id="80ee1-164">Binary Encoding</span></span>  
 <span data-ttu-id="80ee1-165">Gdy kodowanie binarne używa sesji, ciąg słownika dynamicznego musi być przekazywany do odbiorcy wiadomości.</span><span class="sxs-lookup"><span data-stu-id="80ee1-165">When binary encoding uses sessions, the dynamic dictionary string must be communicated to the receiver of the message.</span></span> <span data-ttu-id="80ee1-166">W tym celu należy utworzyć prefiks komunikatu z ciągami słownika dynamicznego.</span><span class="sxs-lookup"><span data-stu-id="80ee1-166">This is done by prefixing the message with the dynamic dictionary strings.</span></span> <span data-ttu-id="80ee1-167">Odbiornik rozłączy ciągi, dodaje je do sesji i przetwarza komunikat.</span><span class="sxs-lookup"><span data-stu-id="80ee1-167">The receiver strips off the strings, adds them to the session, and processes the message.</span></span> <span data-ttu-id="80ee1-168">Poprawne przekazywanie ciągów słownika wymaga, aby transport był buforowany.</span><span class="sxs-lookup"><span data-stu-id="80ee1-168">Correctly passing dictionary strings requires that the transport be buffered.</span></span>  
  
 <span data-ttu-id="80ee1-169">Ciągi są dołączane do komunikatu przez wewnętrzną `AddSessionInformationToMessage` metodę.</span><span class="sxs-lookup"><span data-stu-id="80ee1-169">The strings are appended to the message by an internal `AddSessionInformationToMessage` method.</span></span> <span data-ttu-id="80ee1-170">Dodaje ciągi jako UTF-8 na początku wiadomości poprzedzonej ich długością.</span><span class="sxs-lookup"><span data-stu-id="80ee1-170">It adds the strings as UTF-8 to the front of the message prefixed with their length.</span></span> <span data-ttu-id="80ee1-171">Cały nagłówek słownika jest następnie poprzedzony długością jego danych.</span><span class="sxs-lookup"><span data-stu-id="80ee1-171">The entire dictionary header is then prefixed with the length of its data.</span></span> <span data-ttu-id="80ee1-172">Operacja odwrotna jest wykonywana przez wewnętrzną `ExtractSessionInformationFromMessage` metodę.</span><span class="sxs-lookup"><span data-stu-id="80ee1-172">The reverse operation is performed by an internal `ExtractSessionInformationFromMessage` method.</span></span>  
  
 <span data-ttu-id="80ee1-173">Oprócz przetwarzania kluczy słownika dynamicznego w unikatowy sposób odbierane są buforowane komunikaty sesji.</span><span class="sxs-lookup"><span data-stu-id="80ee1-173">In addition to processing dynamic dictionary keys, buffered sessionful messages are received in a unique way.</span></span> <span data-ttu-id="80ee1-174">Zamiast tworzyć czytniki nad dokumentem i go przetwarzać, koder binarny używa wewnętrznej `MessagePatterns` klasy do dekonstrukcji strumienia binarnego.</span><span class="sxs-lookup"><span data-stu-id="80ee1-174">Instead of creating a reader over the document and processing it, the binary encoder uses the internal `MessagePatterns` class to deconstruct the binary stream.</span></span> <span data-ttu-id="80ee1-175">Najlepszym pomysłem jest to, że większość komunikatów ma określony zestaw nagłówków, który jest wyświetlany w określonej kolejności, gdy jest generowany przez funkcję WCF.</span><span class="sxs-lookup"><span data-stu-id="80ee1-175">The idea is that most messages have a certain set of headers that show up in a certain order when generated by WCF.</span></span> <span data-ttu-id="80ee1-176">System wzorzec dzieli komunikat niezależnie od oczekiwań.</span><span class="sxs-lookup"><span data-stu-id="80ee1-176">The pattern system breaks the message apart based on what it expects.</span></span> <span data-ttu-id="80ee1-177">Jeśli operacja się powiedzie, inicjuje <xref:System.ServiceModel.Channels.MessageHeaders> obiekt bez analizowania kodu XML.</span><span class="sxs-lookup"><span data-stu-id="80ee1-177">If it is successful, it initializes a <xref:System.ServiceModel.Channels.MessageHeaders> object without parsing the XML.</span></span> <span data-ttu-id="80ee1-178">W przeciwnym razie powraca do standardowej metody.</span><span class="sxs-lookup"><span data-stu-id="80ee1-178">If not, it falls back to the standard method.</span></span>  
  
### <a name="mtom-encoding"></a><span data-ttu-id="80ee1-179">Kodowanie MTOM</span><span class="sxs-lookup"><span data-stu-id="80ee1-179">MTOM Encoding</span></span>  
 <span data-ttu-id="80ee1-180">Klasa ma dodatkową właściwość konfiguracji o nazwie <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement.MaxBufferSize%2A>. <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement></span><span class="sxs-lookup"><span data-stu-id="80ee1-180">The <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> class has an additional configuration property called <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement.MaxBufferSize%2A>.</span></span> <span data-ttu-id="80ee1-181">Powoduje to górną granicę ilości danych, które może buforować podczas procesu odczytywania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="80ee1-181">This places an upper bound on how much data it is allowed to buffer during the process of reading a message.</span></span> <span data-ttu-id="80ee1-182">Zestaw informacji XML (sprawdzonych) lub inne części MIME mogą wymagać buforowania w celu ponownego zebrania wszystkich części MIME w jednej wiadomości.</span><span class="sxs-lookup"><span data-stu-id="80ee1-182">The XML Information Set (Infoset), or other MIME parts, may need to be buffered to reassemble all the MIME parts into a single message.</span></span>  
  
 <span data-ttu-id="80ee1-183">Aby można było poprawnie działać przy użyciu protokołu HTTP, wewnętrzna Klasa kodera komunikatów MTOM udostępnia `GetContentType` wewnętrzne interfejsy API dla (, które `WriteMessage`są również wewnętrzne) i, które są publiczne i mogą zostać zastąpione.</span><span class="sxs-lookup"><span data-stu-id="80ee1-183">To work correctly with HTTP, the internal MTOM message encoder class provides some internal APIs for `GetContentType` (which is also internal) and `WriteMessage`, which is public and can be overridden.</span></span> <span data-ttu-id="80ee1-184">Aby zapewnić, że wartości w nagłówkach HTTP są zgodne z wartościami w nagłówkach MIME, należy wykonać więcej komunikacji.</span><span class="sxs-lookup"><span data-stu-id="80ee1-184">More communication must occur to ensure values in the HTTP headers agree with values in the MIME headers.</span></span>  
  
 <span data-ttu-id="80ee1-185">Wewnętrznie koder komunikatów MTOM używa czytelników tekstu WCF i jest podobny do kodera tekstu.</span><span class="sxs-lookup"><span data-stu-id="80ee1-185">Internally, the MTOM message encoder uses WCF's text readers, and is similar to the Text encoder.</span></span> <span data-ttu-id="80ee1-186">Główna różnica polega na tym, że optymalizuje duże fragmenty danych binarnych lub "duże obiekty binarne" (BLOB), nie konwertując ich na kodowanie Base-64 przed osadzeniem w bajtach komunikatów.</span><span class="sxs-lookup"><span data-stu-id="80ee1-186">The main difference is that it optimizes large chunks of binary, or "Binary Large Objects" (BLOBs), by not converting them to Base-64 encoding prior to being embedded into the message bytes.</span></span> <span data-ttu-id="80ee1-187">Zamiast tego obiekty blob są rozpakowywane i przywoływane jako załączniki MIME.</span><span class="sxs-lookup"><span data-stu-id="80ee1-187">Instead, these BLOBs are kept extracted, and referenced as the MIME attachments.</span></span>  
  
## <a name="writing-your-own-encoder"></a><span data-ttu-id="80ee1-188">Pisanie własnego kodera</span><span class="sxs-lookup"><span data-stu-id="80ee1-188">Writing your own Encoder</span></span>  
 <span data-ttu-id="80ee1-189">Aby zaimplementować własny niestandardowy koder komunikatów, należy dostarczyć niestandardowe implementacje następujących abstrakcyjnych klas podstawowych:</span><span class="sxs-lookup"><span data-stu-id="80ee1-189">To implement your own custom message encoder, you must provide custom implementations of the following abstract base classes:</span></span>  
  
- <xref:System.ServiceModel.Channels.MessageEncoder>  
  
- <xref:System.ServiceModel.Channels.MessageEncoderFactory>  
  
- <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>  
  
 <span data-ttu-id="80ee1-190">Konwersja z reprezentacji w pamięci komunikatu na reprezentację, która może być zapisywana w strumieniu, jest hermetyzowana w <xref:System.ServiceModel.Channels.MessageEncoder> obrębie klasy, która służy jako fabryka dla czytników XML i autorów XML, które obsługują określone typy kodowania XML.</span><span class="sxs-lookup"><span data-stu-id="80ee1-190">Converting from the in-memory representation of a message to a representation that can be written to a stream is encapsulated within the <xref:System.ServiceModel.Channels.MessageEncoder> class, which serves as a factory for XML readers and XML writers that support specific types of XML encodings.</span></span>  
  
- <span data-ttu-id="80ee1-191">Kluczowymi metodami tej klasy, które należy zastąpić, są:</span><span class="sxs-lookup"><span data-stu-id="80ee1-191">The key methods of this class that you must override are:</span></span>  
  
- <span data-ttu-id="80ee1-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A>który pobiera <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> obiekt i zapisuje go <xref:System.IO.Stream> w obiekcie.</span><span class="sxs-lookup"><span data-stu-id="80ee1-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> which takes a <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> object and writes it into a <xref:System.IO.Stream> object.</span></span>  
  
- <span data-ttu-id="80ee1-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A>który pobiera <xref:System.IO.Stream> obiekt i maksymalny rozmiar nagłówka i <xref:System.ServiceModel.Channels.Message> zwraca obiekt.</span><span class="sxs-lookup"><span data-stu-id="80ee1-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> which takes a <xref:System.IO.Stream> object and a maximum header size and returns a <xref:System.ServiceModel.Channels.Message> object.</span></span>  
  
 <span data-ttu-id="80ee1-194">Jest to kod napisany w ramach tych metod, który obsługuje konwersję między standardowym protokołem transportowym i dostosowanym kodowaniem.</span><span class="sxs-lookup"><span data-stu-id="80ee1-194">It is the code you write in these methods that handles conversion between the standard transport protocol, and your customized encoding.</span></span>  
  
 <span data-ttu-id="80ee1-195">Następnie należy zakodować klasę fabryki, która tworzy koder niestandardowy.</span><span class="sxs-lookup"><span data-stu-id="80ee1-195">Next you need to code a factory class that creates your custom encoder.</span></span> <span data-ttu-id="80ee1-196">Zastąp <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> , aby zwracało wystąpienie niestandardowe <xref:System.ServiceModel.Channels.MessageEncoder>.</span><span class="sxs-lookup"><span data-stu-id="80ee1-196">Override the <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> to return an instance of your custom <xref:System.ServiceModel.Channels.MessageEncoder>.</span></span>  
  
 <span data-ttu-id="80ee1-197">Następnie połącz niestandardowe <xref:System.ServiceModel.Channels.MessageEncoderFactory> z stosem elementów powiązania używanym do konfigurowania usługi lub klienta, <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> zastępując metodę w celu zwrócenia wystąpienia tej fabryki.</span><span class="sxs-lookup"><span data-stu-id="80ee1-197">Then connect your custom <xref:System.ServiceModel.Channels.MessageEncoderFactory> to the binding element stack used to configure the service or client by overriding the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> method to return an instance of this factory.</span></span>  
  
 <span data-ttu-id="80ee1-198">Istnieją dwa przykłady dostarczone z programem WCF, które ilustrują ten proces za pomocą przykładowego kodu: [Niestandardowy koder komunikatów: Niestandardowy koder](../samples/custom-message-encoder-custom-text-encoder.md) tekstowy i [niestandardowy koder komunikatów: Koder](../samples/custom-message-encoder-compression-encoder.md)kompresji.</span><span class="sxs-lookup"><span data-stu-id="80ee1-198">There are two samples provided with WCF that illustrate this process with sample code: [Custom Message Encoder: Custom Text Encoder](../samples/custom-message-encoder-custom-text-encoder.md) and [Custom Message Encoder: Compression Encoder](../samples/custom-message-encoder-compression-encoder.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="80ee1-199">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="80ee1-199">See also</span></span>

- <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>
- <xref:System.ServiceModel.Channels.MessageEncoderFactory>
- <xref:System.ServiceModel.Channels.MessageEncoder>
- [<span data-ttu-id="80ee1-200">Omówienie architektury transferu danych</span><span class="sxs-lookup"><span data-stu-id="80ee1-200">Data Transfer Architectural Overview</span></span>](../feature-details/data-transfer-architectural-overview.md)
- [<span data-ttu-id="80ee1-201">Wybieranie kodera komunikatów</span><span class="sxs-lookup"><span data-stu-id="80ee1-201">Choosing a Message Encoder</span></span>](../feature-details/choosing-a-message-encoder.md)
- [<span data-ttu-id="80ee1-202">Wybieranie transportu</span><span class="sxs-lookup"><span data-stu-id="80ee1-202">Choosing a Transport</span></span>](../feature-details/choosing-a-transport.md)
