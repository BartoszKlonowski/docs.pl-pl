---
title: Wybieranie platformy wymiany komunikatów
ms.date: 03/30/2017
ms.assetid: 0f502ca1-6a8e-4607-ba15-59198c0e6146
ms.openlocfilehash: 518a21ef34d52ef4b70871ba8bad7876374dd319
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/22/2019
ms.locfileid: "69951861"
---
# <a name="choosing-a-message-exchange-pattern"></a><span data-ttu-id="28f4c-102">Wybieranie platformy wymiany komunikatów</span><span class="sxs-lookup"><span data-stu-id="28f4c-102">Choosing a Message Exchange Pattern</span></span>
<span data-ttu-id="28f4c-103">Pierwszym krokiem w przypadku tworzenia niestandardowego transportu jest podjęcie decyzji, które *wzorce wymiany komunikatów* (lub MEPs) są wymagane dla opracowywanego kanału.</span><span class="sxs-lookup"><span data-stu-id="28f4c-103">The first step in writing a custom transport is to decide which *message exchange patterns* (or MEPs) are required for the channel you are developing.</span></span> <span data-ttu-id="28f4c-104">W tym temacie opisano dostępne opcje i omówiono różne wymagania.</span><span class="sxs-lookup"><span data-stu-id="28f4c-104">This topic describes the options available and discusses the various requirements.</span></span> <span data-ttu-id="28f4c-105">Jest to pierwsze zadanie na liście zadań opracowywania kanału opisane w temacie [Tworzenie kanałów](../../../../docs/framework/wcf/extending/developing-channels.md).</span><span class="sxs-lookup"><span data-stu-id="28f4c-105">This is the first task in the channel development task list described in [Developing Channels](../../../../docs/framework/wcf/extending/developing-channels.md).</span></span>  
  
## <a name="six-message-exchange-patterns"></a><span data-ttu-id="28f4c-106">Wzorce wymiany komunikatów 6</span><span class="sxs-lookup"><span data-stu-id="28f4c-106">Six Message Exchange Patterns</span></span>  
 <span data-ttu-id="28f4c-107">Istnieją trzy MEPs do wyboru:</span><span class="sxs-lookup"><span data-stu-id="28f4c-107">There are three MEPs to choose from:</span></span>  
  
- <span data-ttu-id="28f4c-108">Datagram (<xref:System.ServiceModel.Channels.IInputChannel> i <xref:System.ServiceModel.Channels.IOutputChannel>)</span><span class="sxs-lookup"><span data-stu-id="28f4c-108">Datagram (<xref:System.ServiceModel.Channels.IInputChannel> and <xref:System.ServiceModel.Channels.IOutputChannel>)</span></span>  
  
     <span data-ttu-id="28f4c-109">W przypadku korzystania z unikatowy MEP datagramu klient wysyła komunikat przy użyciu *ognia i zapomni* wymianę.</span><span class="sxs-lookup"><span data-stu-id="28f4c-109">When using a datagram MEP, a client sends a message using a *fire and forget* exchange.</span></span> <span data-ttu-id="28f4c-110">Usługa Fire i zapomnij wymiany jest taka, która wymaga potwierdzenia pomyślnego dostarczenia poza pasmem.</span><span class="sxs-lookup"><span data-stu-id="28f4c-110">A fire and forget exchange is one that requires out-of-band confirmation of successful delivery.</span></span> <span data-ttu-id="28f4c-111">Komunikat może zostać utracony podczas przesyłania i nigdy nie docierał do usługi.</span><span class="sxs-lookup"><span data-stu-id="28f4c-111">The message might be lost in transit and never reach the service.</span></span> <span data-ttu-id="28f4c-112">Jeśli operacja wysyłania zostanie zakończona pomyślnie na końcu klienta, nie gwarantuje to, że zdalny punkt końcowy odebrał komunikat.</span><span class="sxs-lookup"><span data-stu-id="28f4c-112">If the send operation completes successfully at the client end, it does not guarantee that the remote endpoint has received the message.</span></span> <span data-ttu-id="28f4c-113">Datagram jest podstawowym blokiem konstrukcyjnym do obsługi komunikatów, ponieważ można tworzyć własne protokoły na jego podstawie — w tym niezawodne protokoły i bezpieczne protokoły.</span><span class="sxs-lookup"><span data-stu-id="28f4c-113">The datagram is a fundamental building block for messaging, as you can build your own protocols on top of it—including reliable protocols and secure protocols.</span></span> <span data-ttu-id="28f4c-114">Kanały datagramów klienta <xref:System.ServiceModel.Channels.IOutputChannel> implementują interfejs i kanały datadatagramu usługi <xref:System.ServiceModel.Channels.IInputChannel> implementują interfejsy.</span><span class="sxs-lookup"><span data-stu-id="28f4c-114">Client datagram channels implement the <xref:System.ServiceModel.Channels.IOutputChannel> interface and service datagram channels implement the <xref:System.ServiceModel.Channels.IInputChannel> interface.</span></span>  
  
- <span data-ttu-id="28f4c-115">Żądanie-odpowiedź (<xref:System.ServiceModel.Channels.IRequestChannel> i <xref:System.ServiceModel.Channels.IReplyChannel>)</span><span class="sxs-lookup"><span data-stu-id="28f4c-115">Request-Response (<xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>)</span></span>  
  
     <span data-ttu-id="28f4c-116">W tym unikatowy MEP komunikat jest wysyłany, a odpowiedź zostanie odebrana.</span><span class="sxs-lookup"><span data-stu-id="28f4c-116">In this MEP, a message is sent, and a reply is received.</span></span> <span data-ttu-id="28f4c-117">Wzorzec składa się z par żądanie-odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="28f4c-117">The pattern consists of request-response pairs.</span></span> <span data-ttu-id="28f4c-118">Przykłady wywołań żądania-odpowiedź to zdalne wywołania procedury (RPC) i żądania GET przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="28f4c-118">Examples of request-response calls are remote procedure calls (RPC) and browser GET requests.</span></span> <span data-ttu-id="28f4c-119">Ten wzorzec jest również znany jako półdupleks.</span><span class="sxs-lookup"><span data-stu-id="28f4c-119">This pattern is also known as half-duplex.</span></span> <span data-ttu-id="28f4c-120">W tym unikatowy MEP zaimplementowano kanały <xref:System.ServiceModel.Channels.IRequestChannel> klienta i zaimplementowano <xref:System.ServiceModel.Channels.IReplyChannel>kanały usług.</span><span class="sxs-lookup"><span data-stu-id="28f4c-120">In this MEP, client channels implement <xref:System.ServiceModel.Channels.IRequestChannel> and service channels implement <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span>  
  
- <span data-ttu-id="28f4c-121">Duplex (<xref:System.ServiceModel.Channels.IDuplexChannel>)</span><span class="sxs-lookup"><span data-stu-id="28f4c-121">Duplex (<xref:System.ServiceModel.Channels.IDuplexChannel>)</span></span>  
  
     <span data-ttu-id="28f4c-122">UNIKATOWY MEP dupleks umożliwia wysyłanie dowolnej liczby komunikatów przez klienta i odbieranie ich w dowolnej kolejności.</span><span class="sxs-lookup"><span data-stu-id="28f4c-122">The duplex MEP allows an arbitrary number of messages to be sent by a client and received in any order.</span></span> <span data-ttu-id="28f4c-123">UNIKATOWY MEP dupleks jest taka sama jak rozmowa telefoniczna, gdzie każdy wypowiadany wyraz jest komunikatem.</span><span class="sxs-lookup"><span data-stu-id="28f4c-123">The duplex MEP is like a phone conversation, where each word being spoken is a message.</span></span> <span data-ttu-id="28f4c-124">Ponieważ obie strony mogą wysyłać i odbierać dane w tym unikatowy MEP, interfejs zaimplementowany przez klienta i kanały usług to <xref:System.ServiceModel.Channels.IDuplexChannel>.</span><span class="sxs-lookup"><span data-stu-id="28f4c-124">Because both sides can send and receive in this MEP, the interface implemented by the client and service channels is <xref:System.ServiceModel.Channels.IDuplexChannel>.</span></span>  
  
 <span data-ttu-id="28f4c-125">![Wybieranie wzorca wymiany komunikatów](../../../../docs/framework/wcf/extending/media/wcfc-basicthreemepsc.gif "wcfc_BasicThreeMEPsc")</span><span class="sxs-lookup"><span data-stu-id="28f4c-125">![Choosing a message exchange pattern](../../../../docs/framework/wcf/extending/media/wcfc-basicthreemepsc.gif "wcfc_BasicThreeMEPsc")</span></span>  
<span data-ttu-id="28f4c-126">Trzy podstawowe wzorce wymiany komunikatów.</span><span class="sxs-lookup"><span data-stu-id="28f4c-126">The three basic message exchange patterns.</span></span> <span data-ttu-id="28f4c-127">Od góry do dołu: datagram, żądanie-odpowiedź i dupleks.</span><span class="sxs-lookup"><span data-stu-id="28f4c-127">Top to bottom: datagram, request-response, and duplex.</span></span>  
  
 <span data-ttu-id="28f4c-128">Każdy z tych MEPs może również obsługiwać *sesje*.</span><span class="sxs-lookup"><span data-stu-id="28f4c-128">Each of these MEPs can also support *sessions*.</span></span> <span data-ttu-id="28f4c-129">Sesja (i implementacja <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> typu <xref:System.ServiceModel.Channels.ISession?displayProperty=nameWithType>) umożliwia skorelowanie wszystkich komunikatów wysłanych i odebranych w kanale.</span><span class="sxs-lookup"><span data-stu-id="28f4c-129">A session (and implementation of <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> of type <xref:System.ServiceModel.Channels.ISession?displayProperty=nameWithType>) correlates all messages sent and received on a channel.</span></span> <span data-ttu-id="28f4c-130">Wzorzec żądanie-odpowiedź jest autonomiczną sesją dwustronicową, ponieważ żądanie i odpowiedź są skorelowane.</span><span class="sxs-lookup"><span data-stu-id="28f4c-130">The request-response pattern is a stand-alone two-message session, as the request and reply are correlated.</span></span> <span data-ttu-id="28f4c-131">Z kolei wzorzec żądanie-odpowiedź, który obsługuje sesje, oznacza, że wszystkie pary żądanie/odpowiedź w tym kanale są skorelowane ze sobą.</span><span class="sxs-lookup"><span data-stu-id="28f4c-131">In contrast, the request-response pattern that supports sessions implies that all request/response pairs on that channel are correlated with each other.</span></span> <span data-ttu-id="28f4c-132">Zapewnia to sześć MEPs do wyboru:</span><span class="sxs-lookup"><span data-stu-id="28f4c-132">This gives you a total of six MEPs to choose from:</span></span>  
  
- <span data-ttu-id="28f4c-133">Odebran</span><span class="sxs-lookup"><span data-stu-id="28f4c-133">Datagram</span></span>  
  
- <span data-ttu-id="28f4c-134">Żądanie-odpowiedź</span><span class="sxs-lookup"><span data-stu-id="28f4c-134">Request-response</span></span>  
  
- <span data-ttu-id="28f4c-135">Dupleks</span><span class="sxs-lookup"><span data-stu-id="28f4c-135">Duplex</span></span>  
  
- <span data-ttu-id="28f4c-136">Datagram z sesjami</span><span class="sxs-lookup"><span data-stu-id="28f4c-136">Datagram with sessions</span></span>  
  
- <span data-ttu-id="28f4c-137">Żądanie-odpowiedź z sesjami</span><span class="sxs-lookup"><span data-stu-id="28f4c-137">Request-response with sessions</span></span>  
  
- <span data-ttu-id="28f4c-138">Dupleks z sesjami</span><span class="sxs-lookup"><span data-stu-id="28f4c-138">Duplex with sessions</span></span>  
  
> [!NOTE]
> <span data-ttu-id="28f4c-139">W przypadku transportu UDP jedyną obsługiwaną unikatowy MEPą jest datagram, ponieważ protokół UDP jest z natury i zapomnij.</span><span class="sxs-lookup"><span data-stu-id="28f4c-139">For the UDP transport, the only MEP that is supported is datagram, because UDP is inherently a fire and forget protocol.</span></span>  
  
## <a name="sessions-and-sessionful-channels"></a><span data-ttu-id="28f4c-140">Sesje i kanały sesji</span><span class="sxs-lookup"><span data-stu-id="28f4c-140">Sessions and Sessionful Channels</span></span>  
 <span data-ttu-id="28f4c-141">W świecie sieci dostępne są protokoły zorientowane na połączenia (na przykład TCP) i protokoły bez połączenia (na przykład UDP).</span><span class="sxs-lookup"><span data-stu-id="28f4c-141">In the networking world, there are connection-oriented protocols (for example, TCP) and connection-less protocols (for example, UDP).</span></span> <span data-ttu-id="28f4c-142">Funkcja WCF używa sesji do oznaczania logicznego abstrakcji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-142">WCF uses the term session to mean a connection-like logical abstraction.</span></span> <span data-ttu-id="28f4c-143">Protokoły WCF w sesji są podobne do protokołów sieciowych zorientowanych na połączenia, a protokoły WCF bez sesji są podobne do protokołów sieciowych bez połączenia.</span><span class="sxs-lookup"><span data-stu-id="28f4c-143">Sessionful WCF protocols are similar to connection-oriented network protocols and sessionless WCF protocols are similar to connection-less network protocols.</span></span>  
  
 <span data-ttu-id="28f4c-144">W modelu obiektu kanału każdy manifest sesji logicznej jest wystąpieniem kanału sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-144">In the channel object model, each logical session manifests as an instance of a sessionful channel.</span></span> <span data-ttu-id="28f4c-145">W związku z tym każda nowa sesja utworzona przez klienta i zaakceptowana w usłudze odnosi się do nowego kanału sesji na każdej stronie.</span><span class="sxs-lookup"><span data-stu-id="28f4c-145">Therefore every new session created by the client, and accepted on the service, corresponds to a new sessionful channel on each side.</span></span> <span data-ttu-id="28f4c-146">Na poniższym diagramie pokazano, w górnej części, struktura kanałów bezsesyjnych i na dole, struktura kanałów sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-146">The following diagram shows, on the top, the structure of sessionless channels, and on the bottom, the structure of sessionful channels.</span></span>  
  
 <span data-ttu-id="28f4c-147">![Wybieranie wzorca wymiany komunikatów](../../../../docs/framework/wcf/extending/media/wcfc-sessionandsessionlesschannelsc.gif "wcfc_SessionAndSessionlessChannelsc")</span><span class="sxs-lookup"><span data-stu-id="28f4c-147">![Choosing a message exchange pattern](../../../../docs/framework/wcf/extending/media/wcfc-sessionandsessionlesschannelsc.gif "wcfc_SessionAndSessionlessChannelsc")</span></span>  
  
 <span data-ttu-id="28f4c-148">Klient tworzy nowy kanał sesji i wysyła komunikat.</span><span class="sxs-lookup"><span data-stu-id="28f4c-148">A client creates a new sessionful channel and sends a message.</span></span> <span data-ttu-id="28f4c-149">Po stronie usługi odbiornik kanału otrzymuje ten komunikat i wykryje, że należy on do nowej sesji, aby utworzyć nowy kanał sesji i skontaktować się z nim do aplikacji (w odpowiedzi na aplikację wywołującą AcceptChannel na odbiorniku kanału).</span><span class="sxs-lookup"><span data-stu-id="28f4c-149">On the service side, the channel listener receives this message and detects that it belongs to a new session so it creates a new sessionful channel and hands it to the application (in response to the application calling AcceptChannel on the channel listener).</span></span> <span data-ttu-id="28f4c-150">Następnie aplikacja odbiera ten komunikat i wszystkie kolejne komunikaty wysyłane w ramach tej samej sesji za pośrednictwem tego samego kanału sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-150">The application then receives this message and all subsequent messages sent in the same session through the same sessionful channel.</span></span>  
  
 <span data-ttu-id="28f4c-151">Inny klient (lub ten sam Klient) tworzy nową sesję i wysyła komunikat.</span><span class="sxs-lookup"><span data-stu-id="28f4c-151">Another client (or the same client) creates a new sessionful and sends a message.</span></span> <span data-ttu-id="28f4c-152">Odbiornik kanału wykrywa, że ten komunikat jest w nowej sesji i tworzy nowy kanał sesji, a proces powtarza się.</span><span class="sxs-lookup"><span data-stu-id="28f4c-152">The channel listener detects this message is in a new session and creates a new sessionful channel and the process repeats.</span></span>  
  
 <span data-ttu-id="28f4c-153">Bez sesji nie ma korelacji między kanałami i sesjami.</span><span class="sxs-lookup"><span data-stu-id="28f4c-153">Without sessions, there is no correlation between channels and sessions.</span></span> <span data-ttu-id="28f4c-154">W związku z tym odbiornik kanału tworzy tylko jeden kanał, za pośrednictwem którego wszystkie odebrane komunikaty są dostarczane do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-154">Therefore a channel listener creates only one channel through which all received messages are delivered to the application.</span></span> <span data-ttu-id="28f4c-155">Nie ma również kolejności komunikatów, ponieważ nie ma sesji, w której ma być zachowana kolejność komunikatów.</span><span class="sxs-lookup"><span data-stu-id="28f4c-155">There is also no message ordering because there is no session within which to maintain message order.</span></span> <span data-ttu-id="28f4c-156">W górnej części poprzedniej ilustracji przedstawiono wymianę komunikatów bezsesyjnych.</span><span class="sxs-lookup"><span data-stu-id="28f4c-156">The top portion of the preceding graphic illustrates a sessionless message exchange.</span></span>  
  
## <a name="starting-and-terminating-sessions"></a><span data-ttu-id="28f4c-157">Uruchamianie i przerywanie sesji</span><span class="sxs-lookup"><span data-stu-id="28f4c-157">Starting and Terminating Sessions</span></span>  
 <span data-ttu-id="28f4c-158">Sesje są uruchamiane na kliencie przez po prostu utworzenie nowego kanału sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-158">Sessions are started on the client by simply creating a new sessionful channel.</span></span> <span data-ttu-id="28f4c-159">Są one uruchamiane w usłudze, gdy usługa otrzymuje komunikat wysłany w nowej sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-159">They are started on the service when the service receives a message that was sent in a new session.</span></span> <span data-ttu-id="28f4c-160">Podobnie sesje są kończone przez zamknięcie lub przerwanie kanału sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-160">Likewise, sessions are terminated by closing or aborting a sessionful channel.</span></span>  
  
 <span data-ttu-id="28f4c-161">Wyjątkiem jest <xref:System.ServiceModel.Channels.IDuplexSessionChannel> to, który jest używany do wysyłania i otrzymywania wiadomości w postaci dwustronnego, wzorca komunikacji z sesją.</span><span class="sxs-lookup"><span data-stu-id="28f4c-161">The exception to this is <xref:System.ServiceModel.Channels.IDuplexSessionChannel> which is used for both sending and receiving messages in a duplex, sessionful communication pattern.</span></span> <span data-ttu-id="28f4c-162">Istnieje możliwość, że jedna strona będzie zatrzymywać wysyłanie komunikatów, ale nadal otrzymuje komunikaty, w związku <xref:System.ServiceModel.Channels.IDuplexSessionChannel> z czym jest mechanizm, który umożliwia zamknięcie sesji wyjściowej wskazującej, że nie wyśle więcej komunikatów, ale utrzymuje sesję wejściową otwarte, co pozwoli na kontynuowanie odbierania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="28f4c-162">It is possible that one side will want to stop sending messages but continue to receive messages therefore when using <xref:System.ServiceModel.Channels.IDuplexSessionChannel> there is a mechanism that lets you close the output session indicating you will not send any more messages but keep the input session opened allowing you to continue to receive messages.</span></span>  
  
 <span data-ttu-id="28f4c-163">Ogólnie rzecz biorąc, sesje są zamknięte po stronie wychodzącej, a nie na stronie przychodzącej.</span><span class="sxs-lookup"><span data-stu-id="28f4c-163">In general, sessions are closed on the outgoing side and not on the incoming side.</span></span> <span data-ttu-id="28f4c-164">Oznacza to, że kanały wyjściowe sesji można zamknąć, co oznacza całkowite zakończenie sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-164">That is, sessionful output channels can be closed, thereby cleanly terminating the session.</span></span> <span data-ttu-id="28f4c-165">Zamknięcie kanału wyjściowego sesji powoduje, że odpowiedni kanał wejściowy sesji zwraca wartość null do aplikacji wywołującej <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> <xref:System.ServiceModel.Channels.IDuplexSessionChannel>na.</span><span class="sxs-lookup"><span data-stu-id="28f4c-165">Closing a sessionful output channel causes the corresponding sessionful input channel to return null to the application calling <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span>  
  
 <span data-ttu-id="28f4c-166">Jednak kanały wejściowe sesji nie powinny być zamknięte, chyba <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> że <xref:System.ServiceModel.Channels.IDuplexSessionChannel> na zwraca wartość null, wskazując, że sesja jest już zamknięta.</span><span class="sxs-lookup"><span data-stu-id="28f4c-166">However sessionful input channels should not be closed unless <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel> returns null, indicating that the session is already closed.</span></span> <span data-ttu-id="28f4c-167"><xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> Jeśli<xref:System.ServiceModel.Channels.IDuplexSessionChannel> na serwerze nie zwrócono wartości null, zamknięcie kanału wejściowego sesji może zgłosić wyjątek, ponieważ może on otrzymywać nieoczekiwane komunikaty podczas zamykania.</span><span class="sxs-lookup"><span data-stu-id="28f4c-167">If <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel> has not returned null, closing a sessionful input channel may throw an exception because it may receive unexpected messages while closing.</span></span> <span data-ttu-id="28f4c-168">Jeśli odbiorca chce zakończyć sesję przed wykonaniem nadawcy, powinien wywołać <xref:System.ServiceModel.ICommunicationObject.Abort%2A> kanał wejściowy, który nagle kończy sesję.</span><span class="sxs-lookup"><span data-stu-id="28f4c-168">If a receiver wishes to terminate a session before the sender does, it should call <xref:System.ServiceModel.ICommunicationObject.Abort%2A> on the input channel, which abruptly terminates the session.</span></span>  
  
## <a name="writing-sessionful-channels"></a><span data-ttu-id="28f4c-169">Zapisywanie kanałów sesji</span><span class="sxs-lookup"><span data-stu-id="28f4c-169">Writing Sessionful Channels</span></span>  
 <span data-ttu-id="28f4c-170">Jako autor kanału sesji, istnieje kilka rzeczy, które musi wykonać kanał, aby zapewnić sesje.</span><span class="sxs-lookup"><span data-stu-id="28f4c-170">As a sessionful channel author, there are a few things your channel must do to provide sessions.</span></span> <span data-ttu-id="28f4c-171">Na stronie wysyłanie kanał musi:</span><span class="sxs-lookup"><span data-stu-id="28f4c-171">On the send side, your channel needs to:</span></span>  
  
- <span data-ttu-id="28f4c-172">Dla każdego nowego kanału Utwórz nową sesję i skojarz ją z nowym identyfikatorem sesji, który jest unikatowym ciągiem.</span><span class="sxs-lookup"><span data-stu-id="28f4c-172">For each new channel, create a new session and associate it with a new session id which is a unique string.</span></span> <span data-ttu-id="28f4c-173">Lub Uzyskaj nową sesję z kanału sesji poniżej użytkownika w stosie.</span><span class="sxs-lookup"><span data-stu-id="28f4c-173">Or obtain a new session from the sessionful channel below you in the stack.</span></span>  
  
- <span data-ttu-id="28f4c-174">Dla każdego komunikatu wysyłanego za pomocą tego kanału, jeśli Kanał utworzył sesję (w przeciwieństwie do uzyskania jej z warstwy poniżej), należy skojarzyć komunikat z sesją.</span><span class="sxs-lookup"><span data-stu-id="28f4c-174">For each message sent using this channel, if your channel created the session (as opposed to obtaining it from the layer below you), you need to associate the message with the session.</span></span> <span data-ttu-id="28f4c-175">W przypadku kanałów protokołu zwykle odbywa się to przez dodanie nagłówka SOAP.</span><span class="sxs-lookup"><span data-stu-id="28f4c-175">For protocol channels, this is typically done by adding a SOAP header.</span></span> <span data-ttu-id="28f4c-176">W przypadku kanałów transportowych zwykle odbywa się to przez utworzenie nowego połączenia transportowego lub dodanie informacji o sesji do protokołu ramek.</span><span class="sxs-lookup"><span data-stu-id="28f4c-176">For transport channels, this is typically done by creating a new transport connection or adding session information to the framing protocol.</span></span>  
  
- <span data-ttu-id="28f4c-177">Dla każdej wiadomości wysyłanej przy użyciu tego kanału należy podać gwarancje dostarczenia wymienione powyżej.</span><span class="sxs-lookup"><span data-stu-id="28f4c-177">For each message sent using this channel, you need to provide the delivery guarantees mentioned above.</span></span> <span data-ttu-id="28f4c-178">Jeśli korzystasz z kanału poniżej, aby zapewnić sesję, ten kanał zapewni również gwarancje dostarczenia.</span><span class="sxs-lookup"><span data-stu-id="28f4c-178">If you are relying on the channel below you to provide the session, that channel will also provide the delivery guarantees.</span></span> <span data-ttu-id="28f4c-179">Jeśli sesja jest dostarczana samodzielnie, należy zaimplementować te gwarancje jako część protokołu.</span><span class="sxs-lookup"><span data-stu-id="28f4c-179">If you’re providing the session yourself, you need to implement those guarantees as part of your protocol.</span></span> <span data-ttu-id="28f4c-180">Ogólnie rzecz biorąc, jeśli piszesz kanał protokołu, który przyjmuje WCF na obu stronach, może być konieczne przetransport TCP lub kanał niezawodnej obsługi komunikatów i poleganie na jednym z nich w celu zapewnienia sesji.</span><span class="sxs-lookup"><span data-stu-id="28f4c-180">In general, if you are writing a protocol channel that assumes WCF on both sides you may require the TCP transport or the Reliable Messaging channel and rely on either one to provide a session.</span></span>  
  
- <span data-ttu-id="28f4c-181">Gdy <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> jest wywoływana w kanale, należy wykonać niezbędne czynności, aby zamknąć sesję przy użyciu określonego limitu czasu lub wartości domyślnej.</span><span class="sxs-lookup"><span data-stu-id="28f4c-181">When <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> is called on your channel, perform the necessary work to close the session using either the specified timeout or the default one.</span></span> <span data-ttu-id="28f4c-182">Może to być równie proste, jak <xref:System.ServiceModel.ICommunicationObject.Close%2A> wywołanie w kanale poniżej (Jeśli właśnie uzyskano sesję) lub wysłanie specjalnego komunikatu protokołu SOAP lub zamknięcie połączenia transportowego.</span><span class="sxs-lookup"><span data-stu-id="28f4c-182">This can be as simple as calling <xref:System.ServiceModel.ICommunicationObject.Close%2A> on the channel below you (if you just obtained the session from it) or sending a special SOAP message or closing a transport connection.</span></span>  
  
- <span data-ttu-id="28f4c-183">Gdy <xref:System.ServiceModel.ICommunicationObject.Abort%2A> jest wywoływana w kanale, Przerwij sesję w nieoczekiwany sposób bez wykonywania operacji we/wy.</span><span class="sxs-lookup"><span data-stu-id="28f4c-183">When <xref:System.ServiceModel.ICommunicationObject.Abort%2A> is called on your channel, terminate the session abruptly without performing I/O.</span></span> <span data-ttu-id="28f4c-184">Może to oznaczać, że nic się nie dzieje, lub może dotyczyć przerwania połączenia sieciowego lub innego zasobu.</span><span class="sxs-lookup"><span data-stu-id="28f4c-184">This may mean doing nothing or may involve aborting a network connection or some other resource.</span></span>  
  
 <span data-ttu-id="28f4c-185">Na stronie odbierającej Twój kanał musi:</span><span class="sxs-lookup"><span data-stu-id="28f4c-185">On the receive side, your channel needs to:</span></span>  
  
- <span data-ttu-id="28f4c-186">Dla każdego komunikatu przychodzącego odbiornik kanału musi wykryć sesję, do której należy.</span><span class="sxs-lookup"><span data-stu-id="28f4c-186">For each incoming message, the channel listener must detect the session it belongs to.</span></span> <span data-ttu-id="28f4c-187">Jeśli jest to pierwszy komunikat w sesji, odbiornik kanału musi utworzyć nowy kanał i zwrócić go z wywołania do <xref:System.ServiceModel.Channels.IChannelListener%601.AcceptChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="28f4c-187">If this is the first message in the session, the channel listener must create a new channel and return it from the call to <xref:System.ServiceModel.Channels.IChannelListener%601.AcceptChannel%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="28f4c-188">W przeciwnym razie odbiornik kanału musi znaleźć istniejący kanał odpowiadający sesji i dostarczyć komunikat za pośrednictwem tego kanału.</span><span class="sxs-lookup"><span data-stu-id="28f4c-188">Otherwise the channel listener must find the existing channel that corresponds to the session and deliver the message through that channel.</span></span>  
  
- <span data-ttu-id="28f4c-189">Jeśli kanał udostępnia sesję (wraz z wymaganymi gwarancjami dostarczania), strona odbierająca może być wymagana do wykonania niektórych akcji, takich jak zmiana kolejności komunikatów lub wysyłanie potwierdzeń.</span><span class="sxs-lookup"><span data-stu-id="28f4c-189">If your channel is providing the session (along with the required delivery guarantees) the receive side may be required to perform some actions such as re-order messages or send acknowledgements.</span></span>  
  
- <span data-ttu-id="28f4c-190">Gdy <xref:System.ServiceModel.ICommunicationObject.Close%2A> jest wywoływana w kanale, należy wykonać niezbędne czynności, aby zamknąć sesję albo określony limit czasu, albo wartość domyślną.</span><span class="sxs-lookup"><span data-stu-id="28f4c-190">When <xref:System.ServiceModel.ICommunicationObject.Close%2A> is called on your channel, perform the necessary work to close the session either the specified timeout or the default one.</span></span> <span data-ttu-id="28f4c-191">Może to powodować wyjątki, jeśli kanał odbiera komunikat podczas oczekiwania na wygaśnięcie limitu czasu zamykania.</span><span class="sxs-lookup"><span data-stu-id="28f4c-191">This could result in exceptions if the channel receives a message while waiting for the close timeout to expire.</span></span> <span data-ttu-id="28f4c-192">Dzieje się tak, ponieważ kanał będzie znajdował się w stanie zamykającym, gdy odbierze komunikat, który mógłby zgłosić.</span><span class="sxs-lookup"><span data-stu-id="28f4c-192">That’s because the channel will be in the Closing state when it receives a message so it would throw.</span></span>  
  
- <span data-ttu-id="28f4c-193">Gdy <xref:System.ServiceModel.ICommunicationObject.Abort%2A> jest wywoływana w kanale, Przerwij sesję w nieoczekiwany sposób bez wykonywania operacji we/wy.</span><span class="sxs-lookup"><span data-stu-id="28f4c-193">When <xref:System.ServiceModel.ICommunicationObject.Abort%2A> is called on your channel, terminate the session abruptly without performing I/O.</span></span> <span data-ttu-id="28f4c-194">Może to oznaczać, że nic się nie dzieje, lub może pociągać za sobą przerwanie połączenia sieciowego lub innego zasobu.</span><span class="sxs-lookup"><span data-stu-id="28f4c-194">Again, this may mean doing nothing or may involve aborting a network connection or some other resource.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="28f4c-195">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="28f4c-195">See also</span></span>

- [<span data-ttu-id="28f4c-196">Przegląd modelu kanału</span><span class="sxs-lookup"><span data-stu-id="28f4c-196">Channel Model Overview</span></span>](../../../../docs/framework/wcf/extending/channel-model-overview.md)
