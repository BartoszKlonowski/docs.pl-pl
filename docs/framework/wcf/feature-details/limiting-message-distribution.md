---
title: Ograniczanie dystrybucji komunikatów
ms.date: 03/30/2017
ms.assetid: 8b5ec4b8-1ce9-45ef-bb90-2c840456bcc1
ms.openlocfilehash: d09a2be4a59a08a4bddbb1e0f4d038cd2c5ff3e2
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/18/2019
ms.locfileid: "59130224"
---
# <a name="limiting-message-distribution"></a><span data-ttu-id="2fc9a-102">Ograniczanie dystrybucji komunikatów</span><span class="sxs-lookup"><span data-stu-id="2fc9a-102">Limiting Message Distribution</span></span>
<span data-ttu-id="2fc9a-103">Kanał elementu równorzędnego jest celowe emisji siatki.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-103">Peer Channel is by design a broadcast mesh.</span></span> <span data-ttu-id="2fc9a-104">Jego podstawowy model powodziom obejmuje dystrybucja każdy komunikat wysyłany przez dowolnego członka siatki dla wszystkich członków tej siatki.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-104">Its basic flooding model involves distributing each message sent by any member of a mesh to all other members of that mesh.</span></span> <span data-ttu-id="2fc9a-105">Jest to idealne rozwiązanie w sytuacjach, w którym każdy komunikat generowany przez element członkowski ma zastosowanie i jest przydatne do wszystkich innych elementów członkowskich (na przykład pokoju rozmów).</span><span class="sxs-lookup"><span data-stu-id="2fc9a-105">This is ideal in situations where every message generated by a member is relevant and useful to all other members (for example, a chat room).</span></span> <span data-ttu-id="2fc9a-106">Jednak wiele aplikacji mają sporadyczne potrzebę ograniczanie dystrybucji komunikatów.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-106">However, many applications have an occasional need for limiting message distribution.</span></span> <span data-ttu-id="2fc9a-107">Na przykład jeśli nowy element członkowski sprzężenia siatki i chce, aby pobrać ostatnią wiadomością wysłaną za pośrednictwem sieci, to żądanie nie trzeba propagowane do każdego członka siatkę.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-107">For example, if a new member joins a mesh and wants to retrieve the last message sent through the mesh, this request does not need to be flooded to every member of the mesh.</span></span> <span data-ttu-id="2fc9a-108">Żądanie może być ograniczona do umieszczonej blisko sąsiadów lub odfiltrowane wiadomości wygenerowaną lokalnie. Komunikaty mogą być również wysyłane do jednego węzła na siatkę.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-108">The request could be limited to near neighbors, or locally generated messages can be filtered out. Messages can also be sent to an individual node on the mesh.</span></span> <span data-ttu-id="2fc9a-109">W tym temacie omówiono użycie liczba przeskoków, filtr Propagacja komunikatów, Filtr lokalny lub bezpośrednie połączenie do kontrolowania, jak wiadomości są przekazywane w całej sieci i zapewnia ogólne wskazówki dotyczące wybierania podejście.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-109">This topic discusses using Hop Count, a Message Propagation Filter, a local filter, or a direct connection to control how messages are forwarded throughout the mesh, and provides general guidelines for choosing an approach.</span></span>  
  
## <a name="hop-counts"></a><span data-ttu-id="2fc9a-110">Liczba przeskoków</span><span class="sxs-lookup"><span data-stu-id="2fc9a-110">Hop Counts</span></span>  
 <span data-ttu-id="2fc9a-111">Pojęcie `PeerHopCount` jest podobny do czasu wygaśnięcia (Time-To-Live) używane w protokole IP.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-111">The concept of `PeerHopCount` is similar to TTL (Time-To-Live) used in IP protocol.</span></span> <span data-ttu-id="2fc9a-112">Wartość `PeerHopCount` jest powiązany z wystąpienia wiadomości i określa, ile razy komunikat powinien zostać przekazany pakiet przed porzucana.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-112">The value of `PeerHopCount` is tied to a message instance, and it specifies how many times a message should be forwarded before being dropped.</span></span> <span data-ttu-id="2fc9a-113">Każdorazowo, wiadomość zostaje odebrana przez kanał elementu równorzędnego klienta, klient sprawdza, czy komunikat, aby sprawdzić, czy `PeerHopCount` jest określony.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-113">Each time a message is received by a Peer Channel client, the client examines the message to see if `PeerHopCount` is specified.</span></span> <span data-ttu-id="2fc9a-114">Jeśli zostanie określony, następnie zmniejsza klienta przeskok wartości liczby za pomocą jednej przed przekazaniem wiadomości do sąsiedniego węzłów.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-114">If it is specified, then the client decrements the hop count value by one before forwarding the message to neighboring nodes.</span></span> <span data-ttu-id="2fc9a-115">Kiedy klient otrzymuje komunikat, liczba przeskoków wartość zero, klient przetworzy komunikat, ale nie przekazuje komunikat do sąsiadów.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-115">When a client receives a message with a hop count value of zero, the client processes the message, but does not forward the message to neighbors.</span></span>  
  
 <span data-ttu-id="2fc9a-116">Liczba przeskoków mogą być dodawane do wiadomości, dodając `PeerHopCount` jako atrybut do odpowiednich właściwości lub pól w implementacji klasy wiadomości.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-116">Hop count may be added to a message by adding `PeerHopCount` as an attribute to the applicable property or field in the implementation of the message class.</span></span> <span data-ttu-id="2fc9a-117">Możesz ustawić określoną wartość przed wysłaniem wiadomości do siatki.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-117">You can set this to a specific value before sending the message to the mesh.</span></span> <span data-ttu-id="2fc9a-118">W ten sposób można użyć liczby przeskoków ograniczyć rozłożenia komunikatów w całej sieci, gdy jest to konieczne, potencjalnie unikanie duplikowania zbędnych komunikatów.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-118">In this manner, you can use hop count to limit distribution of messages throughout the mesh when necessary, potentially avoiding unnecessary message duplication.</span></span> <span data-ttu-id="2fc9a-119">Jest to przydatne w przypadkach, w którym siatkę znajduje wysokiej ilość nadmiarowych danych lub wysyłania komunikatu do natychmiastowego sąsiadów lub sąsiadów w obrębie kilka przeskoków.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-119">This is useful in cases where the mesh contains a high amount of redundant data, or for sending a message to immediate neighbors, or neighbors within a few hops.</span></span>  
  
-   <span data-ttu-id="2fc9a-120">Fragmenty kodu i powiązane informacje, zobacz [blogu kanał elementu równorzędnego](https://go.microsoft.com/fwlink/?LinkID=114531).</span><span class="sxs-lookup"><span data-stu-id="2fc9a-120">For code snippets and related information, see the [Peer Channel blog](https://go.microsoft.com/fwlink/?LinkID=114531).</span></span>  
  
## <a name="message-propagation-filter"></a><span data-ttu-id="2fc9a-121">Filtr Propagacja komunikatów</span><span class="sxs-lookup"><span data-stu-id="2fc9a-121">Message Propagation Filter</span></span>  
 <span data-ttu-id="2fc9a-122">`MessagePropagationFilter` może służyć do niestandardowych kontroli komunikat o przepełnieniu, szczególnie w przypadku, gdy treść komunikatu lub innych określonych scenariuszy określają propagacji.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-122">`MessagePropagationFilter` can be used for customized control of message flooding, especially when the content of the message or other specific scenarios determine propagation.</span></span> <span data-ttu-id="2fc9a-123">Filtr podejmuje decyzje propagacji dla każdego komunikatu, który przechodzi przez węzeł.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-123">The filter makes propagation decisions for every message that passes through the node.</span></span> <span data-ttu-id="2fc9a-124">Ta zasada obowiązuje dla komunikatów pochodzących gdzie indziej w siatce, Twój węzeł otrzymał oraz komunikaty tworzone przez testowaną aplikację.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-124">This is true for messages that originated elsewhere in the mesh that your node has received as well as messages created by your application.</span></span> <span data-ttu-id="2fc9a-125">Filtr ma dostęp do wiadomości i jego pochodzenia, więc decyzji dotyczących przekazywania lub porzuca wiadomość może bazować na pełne informacje dostępne.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-125">The filter has access to both the message and its origination, so decisions about forwarding or dropping the message can be based on the full information available.</span></span>  
  
 <span data-ttu-id="2fc9a-126"><xref:System.ServiceModel.PeerMessagePropagationFilter> jest abstrakcyjna klasa bazowa przy użyciu funkcji pojedynczego, <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-126"><xref:System.ServiceModel.PeerMessagePropagationFilter> is a base abstract class with a single function, <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span></span> <span data-ttu-id="2fc9a-127">Pierwszy argument wywołania metody które przekazuje pełną kopię wiadomości.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-127">The first argument of the method call passes in a full copy of the message.</span></span> <span data-ttu-id="2fc9a-128">Wszelkie zmiany wprowadzone do wiadomości nie wpływają na komunikat rzeczywiste.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-128">Any changes made to the message do not affect the actual message.</span></span> <span data-ttu-id="2fc9a-129">Ostatni argument wywołania metody które określa źródło wiadomości (`PeerMessageOrigination.Local` lub `PeerMessageOrigination.Remote`).</span><span class="sxs-lookup"><span data-stu-id="2fc9a-129">The last argument of the method call identifies the origin of the message (`PeerMessageOrigination.Local` or `PeerMessageOrigination.Remote`).</span></span> <span data-ttu-id="2fc9a-130">Konkretne implementacje tej metody musi zwracać stałej z <xref:System.ServiceModel.PeerMessagePropagation> wyliczenie co oznacza, że wiadomości były przekazywane do aplikacji lokalnej (`Local`), są przekazywane z klientami zdalnymi (`Remote`), zarówno (`LocalAndRemote`), żaden z tych (`None`).</span><span class="sxs-lookup"><span data-stu-id="2fc9a-130">Concrete implementations of this method must return a constant from the <xref:System.ServiceModel.PeerMessagePropagation> enumeration indicating that the message is to be forwarded to the local application (`Local`), forwarded to remote clients (`Remote`), both (`LocalAndRemote`), or neither (`None`).</span></span> <span data-ttu-id="2fc9a-131">Ten filtr można zastosować, uzyskując dostęp do odpowiednich `PeerNode` obiektu i określając wystąpienia pochodne propagacji filtrowania klasy w `PeerNode.MessagePropagationFilter` właściwości.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-131">This filter can be applied by accessing the corresponding `PeerNode` object and specifying an instance of the derived propagation filter class in the `PeerNode.MessagePropagationFilter` property.</span></span> <span data-ttu-id="2fc9a-132">Upewnij się, że filtr propagacji jest dołączony przed otwarciem kanał elementu równorzędnego.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-132">Ensure that the propagation filter is attached before opening the Peer Channel.</span></span>  
  
-   <span data-ttu-id="2fc9a-133">Fragmenty kodu i powiązane informacje, zobacz [blogu kanał elementu równorzędnego](https://go.microsoft.com/fwlink/?LinkID=114532).</span><span class="sxs-lookup"><span data-stu-id="2fc9a-133">For code snippets and related information, see the [Peer Channel blog](https://go.microsoft.com/fwlink/?LinkID=114532).</span></span>  
  
## <a name="contacting-an-individual-node-in-the-mesh"></a><span data-ttu-id="2fc9a-134">Nawiązywanie kontaktu z poszczególnych węzłów w siatce</span><span class="sxs-lookup"><span data-stu-id="2fc9a-134">Contacting an Individual Node in the Mesh</span></span>  
 <span data-ttu-id="2fc9a-135">Można się skontaktować poszczególnych węzeł w siatce, konfigurując Filtr lokalny lub przez ustawienie bezpośredniego połączenia z programem.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-135">An individual node in a mesh can be contacted by setting up a local filter, or by setting up a direct connection.</span></span>  
  
 <span data-ttu-id="2fc9a-136">Jeśli węzły w siatce każdego Identyfikatora poszczególnych, można określić identyfikator docelowego w implementacji wiadomości.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-136">If the nodes in a mesh each have an individual ID, a destination ID can be specified in the implementation of your message.</span></span> <span data-ttu-id="2fc9a-137">Filtr lokalny można skonfigurować pod kątem przez pisanie funkcji w swojej kontraktu komunikatu, które będą wyświetlane tylko wiadomości do bieżącego węzła, jeśli określony identyfikator docelowy pasuje do Identyfikatora.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-137">A local filter can be set up by writing a function in your message contract that will only display the message to the current node if its ID matches the destination ID you specified.</span></span> <span data-ttu-id="2fc9a-138">Siatkę służy do transportu komunikatów, dzięki czemu obciążenie Konfigurowanie nowego połączenia nie musi być naliczane.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-138">The mesh transports the message, so the overhead of setting up a new connection does not have to be incurred.</span></span> <span data-ttu-id="2fc9a-139">Jednak istnieje utraty wydajności, ponieważ komunikat jest wysyłany wiele razy w całej sieci.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-139">However, there is a loss of efficiency since the message is sent many times throughout the mesh.</span></span> <span data-ttu-id="2fc9a-140">Działa to dobrze w przypadku wysyłania wiadomości do poszczególnych elementów siatki, tak długo, jak długo komunikaty nie są zbyt duże ani zbyt często.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-140">This works well for sending messages to individual members of a mesh as long as the messages are neither too big nor too frequent.</span></span>  
  
 <span data-ttu-id="2fc9a-141">W przypadku długotrwałych i dużej przepustowości połączeń bezpośrednich połączeń są preferowane w porównaniu.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-141">For long-lasting, high-bandwidth connections, direct connections are preferable.</span></span> <span data-ttu-id="2fc9a-142">Możesz wysłać informacje dotyczące połączenia za pośrednictwem sieci i następnie skonfigurować połączenie bezpośrednie Wybieranie funkcję wysyłania i odbierania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-142">You can send connection information over the mesh, and then set up a direct connection of your choosing to send/receive messages.</span></span>  
  
## <a name="choosing-an-approach-for-limiting-message-distribution"></a><span data-ttu-id="2fc9a-143">Wybieranie podejścia do ograniczanie dystrybucji komunikatów</span><span class="sxs-lookup"><span data-stu-id="2fc9a-143">Choosing an Approach for Limiting Message Distribution</span></span>  
 <span data-ttu-id="2fc9a-144">Po odnalezieniu scenariusz, w której chcesz ograniczyć dystrybucji komunikatów odpowiedzieć sobie na następujące pytania:</span><span class="sxs-lookup"><span data-stu-id="2fc9a-144">When you discover a scenario in which you need to limit message distribution, ask yourself the following questions:</span></span>  
  
-   <span data-ttu-id="2fc9a-145">**Kto** musi otrzymać wiadomość?</span><span class="sxs-lookup"><span data-stu-id="2fc9a-145">**Who** needs to receive the message?</span></span> <span data-ttu-id="2fc9a-146">Sąsiadujące tylko jeden węzeł?</span><span class="sxs-lookup"><span data-stu-id="2fc9a-146">Just one neighbor node?</span></span> <span data-ttu-id="2fc9a-147">Węzeł gdzieś w sieci?</span><span class="sxs-lookup"><span data-stu-id="2fc9a-147">A node somewhere else in the mesh?</span></span> <span data-ttu-id="2fc9a-148">Połowa siatki?</span><span class="sxs-lookup"><span data-stu-id="2fc9a-148">Half the mesh?</span></span>  
  
-   <span data-ttu-id="2fc9a-149">**Jak często** będzie można wysłać tej wiadomości?</span><span class="sxs-lookup"><span data-stu-id="2fc9a-149">**How often** will this message be sent?</span></span>  
  
-   <span data-ttu-id="2fc9a-150">Jakiego rodzaju elementu **przepustowości** użyje tej wiadomości?</span><span class="sxs-lookup"><span data-stu-id="2fc9a-150">What kind of **bandwidth** will this message use?</span></span>  
  
 <span data-ttu-id="2fc9a-151">Odpowiedzi na te pytania mogą pomóc w określeniu, czy ma być używany, liczba przeskoków, filtr Propagacja komunikatów, Filtr lokalny lub bezpośrednie połączenie.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-151">The answers to these questions can help you determine whether to use Hop Count, a Message Propagation Filter, a local filter, or a direct connection.</span></span> <span data-ttu-id="2fc9a-152">Należy rozważyć następujące ogólne wytyczne:</span><span class="sxs-lookup"><span data-stu-id="2fc9a-152">Consider the following general guidelines:</span></span>  
  
-   <span data-ttu-id="2fc9a-153">**Kto**</span><span class="sxs-lookup"><span data-stu-id="2fc9a-153">**Who**</span></span>  
  
    -   <span data-ttu-id="2fc9a-154">*Pojedynczych węzłów*:  Filtr lokalny lub bezpośrednie połączenie.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-154">*Individual node*:  Local filter or direct connection.</span></span>  
  
    -   <span data-ttu-id="2fc9a-155">*Sąsiadów w niektórych sąsiedztwa*:  PeerHopCount.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-155">*Neighbors within a certain vicinity*:  PeerHopCount.</span></span>  
  
    -   <span data-ttu-id="2fc9a-156">*Złożone podzbiór siatkę*:  MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-156">*Complex subset of the mesh*:  MessagePropagationFilter.</span></span>  
  
-   <span data-ttu-id="2fc9a-157">**Jak często**</span><span class="sxs-lookup"><span data-stu-id="2fc9a-157">**How often**</span></span>  
  
    -   <span data-ttu-id="2fc9a-158">*Bardzo często*:  Bezpośrednie połączenie, PeerHopCount, MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-158">*Very frequent*:  Direct connection, PeerHopCount, MessagePropagationFilter.</span></span>  
  
    -   <span data-ttu-id="2fc9a-159">*Sporadyczne*:  Filtr lokalny.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-159">*Occasional*:  Local filter.</span></span>  
  
-   <span data-ttu-id="2fc9a-160">**Wykorzystanie przepustowości**</span><span class="sxs-lookup"><span data-stu-id="2fc9a-160">**Bandwidth use**</span></span>  
  
    -   <span data-ttu-id="2fc9a-161">*Wysoka*:  Bezpośrednie połączenie, mniej wskazane zastosowanie MessagePropagationFilter lub lokalnego filtru.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-161">*High*:  Direct connection, less advisable to use MessagePropagationFilter or local filter.</span></span>  
  
    -   <span data-ttu-id="2fc9a-162">*Niska*:  Istnieje bezpośrednie połączenie prawdopodobnie nie jest wymagane.</span><span class="sxs-lookup"><span data-stu-id="2fc9a-162">*Low*:  Any, direct connection probably not needed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2fc9a-163">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="2fc9a-163">See also</span></span>

- [<span data-ttu-id="2fc9a-164">Tworzenie aplikacji kanału równorzędnego</span><span class="sxs-lookup"><span data-stu-id="2fc9a-164">Building a Peer Channel Application</span></span>](../../../../docs/framework/wcf/feature-details/building-a-peer-channel-application.md)
