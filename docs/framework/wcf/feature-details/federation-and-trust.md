---
title: Federacja i zaufanie
ms.date: 03/30/2017
helpviewer_keywords:
- federation [WCF], and trust
ms.assetid: 4bdec4f2-f8a2-4512-bdcf-14ef54b5877a
ms.openlocfilehash: 95c50ac5f402114925d3350f258f03caca4592ba
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/22/2019
ms.locfileid: "69948068"
---
# <a name="federation-and-trust"></a><span data-ttu-id="395b6-102">Federacja i zaufanie</span><span class="sxs-lookup"><span data-stu-id="395b6-102">Federation and Trust</span></span>
<span data-ttu-id="395b6-103">W tym temacie omówiono różne aspekty związane z aplikacjami federacyjnymi, granicami zaufania i konfiguracją oraz korzystanie z wystawionych tokenów w programie Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="395b6-103">This topic covers various aspects related to federated applications, trust boundaries and configuration, and use of issued tokens in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="services-security-token-services-and-trust"></a><span data-ttu-id="395b6-104">Usługi, usługi tokenów zabezpieczających i relacje zaufania</span><span class="sxs-lookup"><span data-stu-id="395b6-104">Services, Security Token Services, and Trust</span></span>  
 <span data-ttu-id="395b6-105">Usługi, które uwidaczniają federacyjne punkty końcowe zwykle, oczekują klientom na uwierzytelnianie przy użyciu tokenu dostarczonego przez określonego wystawcy.</span><span class="sxs-lookup"><span data-stu-id="395b6-105">Services that expose federated endpoints typically expect clients to authenticate using a token provided by a specific issuer.</span></span> <span data-ttu-id="395b6-106">Należy pamiętać, że usługa jest skonfigurowana z prawidłowymi poświadczeniami dla wystawcy. w przeciwnym razie nie będzie można sprawdzić podpisów wystawionych tokenów i klient nie będzie mógł komunikować się z usługą.</span><span class="sxs-lookup"><span data-stu-id="395b6-106">It is important that the service is configured with the correct credentials for the issuer; otherwise, it will not be able to verify signatures over the issued tokens, and the client will be unable to communicate with the service.</span></span> <span data-ttu-id="395b6-107">Aby uzyskać więcej informacji na temat konfigurowania poświadczeń wystawcy w [usłudze, zobacz How to: Skonfiguruj poświadczenia na usługa federacyjna](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).</span><span class="sxs-lookup"><span data-stu-id="395b6-107">For more information about configuring issuer credentials on the service, see [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).</span></span>  
  
 <span data-ttu-id="395b6-108">Podobnie w przypadku używania kluczy symetrycznych klucze są szyfrowane dla usługi docelowej, dlatego należy skonfigurować usługę tokenu zabezpieczającego z prawidłowymi poświadczeniami dla usługi docelowej. w przeciwnym razie nie będzie można zaszyfrować klucza dla usługi docelowej, a następnie klient nie będzie mógł nawiązać połączenia z usługą.</span><span class="sxs-lookup"><span data-stu-id="395b6-108">Similarly, when using symmetric keys, the keys are encrypted for the target service, so you must configure the security token service with the correct credentials for the target service; otherwise, it will be unable to encrypt the key for the target service, and again, the client will be unable to communicate with the service.</span></span>  
  
 <span data-ttu-id="395b6-109">Usługi WCF używają wartości <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> właściwości w [elementu SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) , aby umożliwić pochylenie zegara między klientem i usługą.</span><span class="sxs-lookup"><span data-stu-id="395b6-109">WCF services use the value of the <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> property on the [SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) to allow for clock skew between the client and service.</span></span> <span data-ttu-id="395b6-110">W Federacji `MaxClockSkew` ustawienie ma zastosowanie do obchylania zegara między klientem a usługą tokenu zabezpieczającego, z poziomu którego klient uzyskał wystawiony token.</span><span class="sxs-lookup"><span data-stu-id="395b6-110">In federation, the `MaxClockSkew` setting applies to clock skews between both the client and the security token service from where the client obtained the issued token.</span></span> <span data-ttu-id="395b6-111">W związku z tym usługi tokenu zabezpieczającego nie muszą naliczać się na opóźnienie naliczania zegara podczas ustawiania czasu obowiązywania i wygaśnięcia wystawionego tokenu.</span><span class="sxs-lookup"><span data-stu-id="395b6-111">Therefore, security token services need not make clock-skew allowances when setting the issued token's effective and expiration times.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="395b6-112">Znaczenie pochylenia zegara zwiększa się w miarę skrócenia okresu istnienia wystawionego tokenu.</span><span class="sxs-lookup"><span data-stu-id="395b6-112">The importance of clock skew increases as the lifetime of the issued token shortens.</span></span> <span data-ttu-id="395b6-113">W większości przypadków pochylenie zegara nie jest istotnym problemem, jeśli okres istnienia tokenu wynosi 30 minut lub dłużej.</span><span class="sxs-lookup"><span data-stu-id="395b6-113">In most cases, clock skew is not a significant issue if the token lifetime is 30 minutes or more.</span></span> <span data-ttu-id="395b6-114">Scenariusze o krótszych okresach istnienia lub o dokładnym czasie ważności tokenu należy zastanowić się, aby przechylić do konta.</span><span class="sxs-lookup"><span data-stu-id="395b6-114">Scenarios with shorter lifetimes or where the exact validity time of the token is important should be designed to take clock skew into account.</span></span>  
  
## <a name="federated-endpoints-and-time-outs"></a><span data-ttu-id="395b6-115">Federacyjne punkty końcowe i limity czasu</span><span class="sxs-lookup"><span data-stu-id="395b6-115">Federated Endpoints and Time-Outs</span></span>  
 <span data-ttu-id="395b6-116">Gdy klient komunikuje się z federacyjnym punktem końcowym, musi najpierw uzyskać odpowiedni token z usługi tokenu zabezpieczającego.</span><span class="sxs-lookup"><span data-stu-id="395b6-116">When a client communicates with a federated endpoint, it must first acquire an appropriate token from a security token service.</span></span> <span data-ttu-id="395b6-117">Jeśli usługa token zabezpieczający ujawnia federacyjny punkt końcowy, klient musi najpierw uzyskać token z wystawcy dla tego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="395b6-117">If the security token service exposes a federated endpoint, the client must first obtain a token from the issuer for that endpoint.</span></span> <span data-ttu-id="395b6-118">Każdy pozyskiwanie tokenu trwa, a ten czas jest uzależniony od całkowitego limitu czasu wysyłania rzeczywistej wiadomości do końcowego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="395b6-118">Each token acquisition takes time, and that time is subject to the overall time-out for sending the actual message to the final endpoint.</span></span>  
  
 <span data-ttu-id="395b6-119">Na przykład limit czasu w kanale po stronie klienta jest ustawiony na 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="395b6-119">For example, the time-out on the client-side channel is set to 30 seconds.</span></span> <span data-ttu-id="395b6-120">Dwa wystawcy tokenów należy wywołać, aby pobrać tokeny przed wysłaniem komunikatu do końcowego punktu końcowego, a każdy z nich zajmie 15 sekund, aby wystawić token.</span><span class="sxs-lookup"><span data-stu-id="395b6-120">Two token issuers need to be called to retrieve tokens before sending the message to the final endpoint, and each takes 15 seconds to issue a token.</span></span> <span data-ttu-id="395b6-121">W takim przypadku próba zakończy się niepowodzeniem i <xref:System.TimeoutException> zostanie zgłoszony.</span><span class="sxs-lookup"><span data-stu-id="395b6-121">In this case, the attempt will fail and a <xref:System.TimeoutException> is thrown.</span></span> <span data-ttu-id="395b6-122">W tym celu należy ustawić <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> wartość w kanale klienta na wartość wystarczającą do uwzględnienia czasu pobrania wszystkich wystawionych tokenów.</span><span class="sxs-lookup"><span data-stu-id="395b6-122">Thus, you need to set the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> value on the client channel to a value large enough to include the time taken to retrieve all issued tokens.</span></span> <span data-ttu-id="395b6-123">W przypadku <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> , gdy wartość nie jest określona dla właściwości, Właściwośćlubwłaściwość(lubobie)musibyćustawionanawartośćwystarczającoduża,abyuwzględnićczaspotrzebnydopobraniawszystkichwystawionychtokenów.<xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A></span><span class="sxs-lookup"><span data-stu-id="395b6-123">In the case where a value is not specified for the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> property, the <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> property or the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> property (or both) need to be set to a value large enough to include the time taken to retrieve all issued tokens.</span></span>  
  
## <a name="token-lifetime-and-renewal"></a><span data-ttu-id="395b6-124">Okres istnienia tokenu i odnowienie</span><span class="sxs-lookup"><span data-stu-id="395b6-124">Token Lifetime and Renewal</span></span>  
 <span data-ttu-id="395b6-125">Klienci WCF nie sprawdzają wystawionego tokenu podczas wykonywania początkowego żądania do usługi.</span><span class="sxs-lookup"><span data-stu-id="395b6-125">WCF clients do not check the issued token when making an initial request to a service.</span></span>  <span data-ttu-id="395b6-126">Zamiast tego WCF ufa usłudze tokenu zabezpieczającego, aby wystawić token z odpowiednimi godzinami obowiązywania i wygaśnięcia.</span><span class="sxs-lookup"><span data-stu-id="395b6-126">Rather, WCF trusts the security token service to issue a token with appropriate effective and expiration times.</span></span> <span data-ttu-id="395b6-127">Jeśli token jest buforowany przez klienta i ponownie używany, okres istnienia tokenu jest sprawdzany w kolejnych żądaniach, a klient automatycznie odnawia token w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="395b6-127">If the token is cached by the client and reused, the token lifetime is checked on subsequent requests and the client automatically renews the token if necessary.</span></span> <span data-ttu-id="395b6-128">Aby uzyskać więcej informacji na temat buforowania tokenów, zobacz [How to: Utwórz klienta](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)federacyjnego.</span><span class="sxs-lookup"><span data-stu-id="395b6-128">For more information about token caching, see [How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md).</span></span>  
  
 <span data-ttu-id="395b6-129">Określenie krótkich okresów istnienia, w kolejności od 30 sekund lub mniej dla wystawionych tokenów lub tokenów kontekstu zabezpieczeń, może spowodować przekroczenie limitu czasu negocjacji lub innych wyjątków zgłaszanych przez klientów programu WCF podczas żądania wystawionych tokenów lub podczas negocjowania lub odnawiania zabezpieczeń tokeny kontekstu.</span><span class="sxs-lookup"><span data-stu-id="395b6-129">Specifying short lifetimes, on the order of 30 seconds or less for issued tokens or security context tokens, may result in negotiation time-outs or other exceptions being thrown by WCF clients when requesting issued tokens or when negotiating or renewing security context tokens.</span></span>  
  
## <a name="issued-tokens-and-inclusionmode"></a><span data-ttu-id="395b6-130">Wystawione tokeny i przełączenie</span><span class="sxs-lookup"><span data-stu-id="395b6-130">Issued Tokens and InclusionMode</span></span>  
 <span data-ttu-id="395b6-131">Czy wystawiony token jest serializowany w wiadomości wysyłanej z klienta do federacyjnego punktu końcowego lub nie jest kontrolowany przez ustawienie <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> właściwości <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> klasy.</span><span class="sxs-lookup"><span data-stu-id="395b6-131">Whether an issued token is serialized in a message sent from a client to a federated endpoint or not is controlled by setting the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> property of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> class.</span></span> <span data-ttu-id="395b6-132">Tę właściwość można ustawić na jedną z <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> wartości wyliczenia, ale nie jest ona przydatna w większości scenariuszy federacyjnych.</span><span class="sxs-lookup"><span data-stu-id="395b6-132">This property can be set to one of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> enumeration values, but it is not useful in most federated scenarios.</span></span> <span data-ttu-id="395b6-133">Wartości `SecurityTokenInclusionMode.Never` i`SecurityTokenInclusionMode.AlwaysToInitiator` powodują, że klient wysyła odwołanie do tokenu wystawionego przez usługę tokenu zabezpieczeń dla jednostki uzależnionej.</span><span class="sxs-lookup"><span data-stu-id="395b6-133">The `SecurityTokenInclusionMode.Never` and `SecurityTokenInclusionMode.AlwaysToInitiator` values cause the client to send a reference to the token issued by the security token service to the relying party.</span></span> <span data-ttu-id="395b6-134">Jeśli jednostka uzależniona nie posiada kopii wystawionego tokenu, uwierzytelnienie nie powiedzie się, ponieważ nie można rozpoznać odwołania do tokenu.</span><span class="sxs-lookup"><span data-stu-id="395b6-134">Unless the relying party possesses a copy of the issued token, authentication will fail because the token reference is not resolvable.</span></span> <span data-ttu-id="395b6-135">WCF traktuje `SecurityTokenInclusionMode.Once` się `SecurityTokenInclusionMode.AlwaysToRecipient`jako równoważne.</span><span class="sxs-lookup"><span data-stu-id="395b6-135">WCF treats `SecurityTokenInclusionMode.Once` as equivalent to `SecurityTokenInclusionMode.AlwaysToRecipient`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="395b6-136">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="395b6-136">See also</span></span>

- <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>
- [<span data-ttu-id="395b6-137">Instrukcje: Tworzenie klienta federacyjnego</span><span class="sxs-lookup"><span data-stu-id="395b6-137">How to: Create a Federated Client</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)
- [<span data-ttu-id="395b6-138">Instrukcje: Konfigurowanie poświadczeń na usługa federacyjna</span><span class="sxs-lookup"><span data-stu-id="395b6-138">How to: Configure Credentials on a Federation Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)
- [<span data-ttu-id="395b6-139">Instrukcje: Utwórz WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="395b6-139">How to: Create a WSFederationHttpBinding</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-wsfederationhttpbinding.md)
