---
title: Rozszerzalność hosta usługi przepływu pracy
ms.date: 03/30/2017
ms.assetid: c0e8f7bb-cb13-49ec-852f-b85d7c23972f
ms.openlocfilehash: 3393843e6be75e122c3993b3ccfb7c56d63cebad
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
---
# <a name="workflow-service-host-extensibility"></a><span data-ttu-id="5eef1-102">Rozszerzalność hosta usługi przepływu pracy</span><span class="sxs-lookup"><span data-stu-id="5eef1-102">Workflow Service Host Extensibility</span></span>
[!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)]<span data-ttu-id="5eef1-103"> udostępnia <xref:System.ServiceModel.Activities.WorkflowServiceHost> klasy do hostowania usług przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-103"> provides the <xref:System.ServiceModel.Activities.WorkflowServiceHost> class for hosting workflow services.</span></span> <span data-ttu-id="5eef1-104">Ta klasa jest używana, gdy są samodzielnej obsługi usługi przepływu pracy w zarządzanej aplikacji lub usługi systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="5eef1-104">This class is used when you are self-hosting a workflow service in a managed application or a Windows service.</span></span> <span data-ttu-id="5eef1-105">Ta klasa służy również odnośnie do hostowania usługi przepływu pracy za pomocą usług Internet Information Services (IIS) lub usługi aktywacji procesów systemu Windows (WAS).</span><span class="sxs-lookup"><span data-stu-id="5eef1-105">This class is also used when hosting a workflow service with Internet Information Services (IIS) or Windows Process Activation Service (WAS).</span></span> <span data-ttu-id="5eef1-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> Klasa udostępnia punkty rozszerzenia, dzięki którym można dodać niestandardowe rozszerzenia zmianę zachowania bezczynności i obsługi innych niż usługowe przepływów pracy (przepływy pracy, które nie należy używać działania obsługi komunikatów).</span><span class="sxs-lookup"><span data-stu-id="5eef1-106">The <xref:System.ServiceModel.Activities.WorkflowServiceHost> class provides extension points that allow you to add custom extensions, change the idle behavior, and host non-service workflows (workflows that do not use messaging activities).</span></span>  
  
## <a name="workflow-service-host-extensions"></a><span data-ttu-id="5eef1-107">Rozszerzenia hosta usługi przepływu pracy</span><span class="sxs-lookup"><span data-stu-id="5eef1-107">Workflow Service Host Extensions</span></span>  
 <span data-ttu-id="5eef1-108"><xref:System.ServiceModel.Activities.WorkflowServiceHost> Zawiera <xref:System.ServiceModel.Activities.WorkflowServiceHost.WorkflowExtensions%2A> właściwości typu <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager> zapewnia metody do dodawania rozszerzenia do <xref:System.ServiceModel.Activities.WorkflowServiceHost>.</span><span class="sxs-lookup"><span data-stu-id="5eef1-108">The <xref:System.ServiceModel.Activities.WorkflowServiceHost> contains a <xref:System.ServiceModel.Activities.WorkflowServiceHost.WorkflowExtensions%2A> property of type <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager> that provides methods to add extensions to the <xref:System.ServiceModel.Activities.WorkflowServiceHost>.</span></span> <span data-ttu-id="5eef1-109">Użyj <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> metodę, aby dodać rozszerzenie dla każdego wystąpienia usługi przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-109">Use the <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> method to add an extension for each workflow service instance.</span></span> <span data-ttu-id="5eef1-110">Delegat określony nazywa się do utworzenia nowego rozszerzenia, gdy wystąpienie usługi przepływu pracy jest utworzony lub załadowany z magazynu.</span><span class="sxs-lookup"><span data-stu-id="5eef1-110">The delegate specified is called to create a new extension when a workflow service instance is created or loaded from a persistence store.</span></span> <span data-ttu-id="5eef1-111">Użyj <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> metodę, aby dodać rozszerzenie dla każdego hosta usługi przepływu pracy, jedno wystąpienie rozszerzenia jest współdzielona przez wszystkie wystąpienia usługi przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-111">Use the <xref:System.Activities.Hosting.WorkflowInstanceExtensionManager.Add%2A> method to add an extension for each workflow service host, one instance of the extension is shared for all workflow service instances.</span></span>  
  
## <a name="react-to-unhandled-exceptions"></a><span data-ttu-id="5eef1-112">Reagowanie na nieobsługiwanych wyjątków</span><span class="sxs-lookup"><span data-stu-id="5eef1-112">React to Unhandled Exceptions</span></span>  
 <span data-ttu-id="5eef1-113"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> Umożliwia określenie akcji do wykonania, jeśli wystąpi nieobsługiwany wyjątek w ramach usługi przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-113">The <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> enables you to specify the action to take if an unhandled exception occurs within a workflow service.</span></span> <span data-ttu-id="5eef1-114"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior.Action%2A> Właściwość określa jeden z <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction> wartości:</span><span class="sxs-lookup"><span data-stu-id="5eef1-114">The <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior.Action%2A> property specifies one of the <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction> values:</span></span>  
  
-   <span data-ttu-id="5eef1-115"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Abandon> — Przerywa wystąpienie usługi przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-115"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Abandon> – Aborts the workflow service instance.</span></span>  
  
-   <span data-ttu-id="5eef1-116"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.AbandonAndSuspend> — Przywraca do ostatniego utrwalonego stanu i wstrzymuje wystąpienie usługi przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-116"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.AbandonAndSuspend> – Rolls back to the last persisted state and suspends the workflow service instance.</span></span> <span data-ttu-id="5eef1-117">To tylko wtedy, gdy przepływ pracy jest już co najmniej raz utrwalone.</span><span class="sxs-lookup"><span data-stu-id="5eef1-117">This only occurs if the workflow has already been persisted at least once.</span></span> <span data-ttu-id="5eef1-118">Jeśli nie jest wystąpieniem przepływu pracy zostało przerwane.</span><span class="sxs-lookup"><span data-stu-id="5eef1-118">If not the workflow instance is aborted.</span></span>  
  
-   <span data-ttu-id="5eef1-119"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel> — Umożliwia anulowanie tego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="5eef1-119"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel> – Cancels the instance.</span></span>  
  
-   <span data-ttu-id="5eef1-120"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Terminate> — Kończy wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="5eef1-120"><xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Terminate> – Terminates the instance.</span></span>  
  
 <span data-ttu-id="5eef1-121">To zachowanie można skonfigurować w kodzie, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="5eef1-121">This behavior can be configured in code as shown in the following example.</span></span>  
  
```csharp  
host.Description.Behaviors.Add(new WorkflowUnhandledExceptionBehavior { Action = WorkflowUnhandledExceptionAction.Abandon });  
```  
  
 <span data-ttu-id="5eef1-122">Go można również skonfigurować w pliku konfiguracji, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="5eef1-122">It can also be configured in a configuration file as shown in the following example.</span></span>  
  
```xml
<behaviors>  
      <serviceBehaviors>  
        <behavior>  
          <serviceMetadata httpGetEnabled="True"/>  
          <serviceDebug includeExceptionDetailInFaults="False" />  
          <workflowUnhandledExceptionBehavior action="Abandon" />        
        </behavior>  
      </serviceBehaviors>  
```  
  
## <a name="hosting-non-service-workflows"></a><span data-ttu-id="5eef1-123">Hosting innych niż usługowe przepływów pracy</span><span class="sxs-lookup"><span data-stu-id="5eef1-123">Hosting Non-Service Workflows</span></span>  
 <span data-ttu-id="5eef1-124"><xref:System.ServiceModel.Activities.WorkflowServiceHost> może służyć do obsługi przepływów pracy z systemem innym niż usługi lub przepływy pracy, które albo zaczyna się od <xref:System.ServiceModel.Activities.Receive> działania lub przepływów pracy, które nie korzystają z działania obsługi wiadomości.</span><span class="sxs-lookup"><span data-stu-id="5eef1-124"><xref:System.ServiceModel.Activities.WorkflowServiceHost> can be used to host non-service workflows, or workflows that either do not begin with a <xref:System.ServiceModel.Activities.Receive> activity or workflows that do not use the messaging activities.</span></span> <span data-ttu-id="5eef1-125">Usługi przepływu pracy, ale zwykle zaczynać <xref:System.ServiceModel.Activities.Receive> działania.</span><span class="sxs-lookup"><span data-stu-id="5eef1-125">Workflow services normally begin with a <xref:System.ServiceModel.Activities.Receive> activity.</span></span> <span data-ttu-id="5eef1-126">Gdy <xref:System.ServiceModel.Activities.WorkflowServiceHost> odbiera komunikat dla usługi przepływu pracy, jeśli nie jest jeszcze uruchomiona (lub utrwalone) nowego wystąpienia usługi przepływu pracy jest tworzona.</span><span class="sxs-lookup"><span data-stu-id="5eef1-126">When the <xref:System.ServiceModel.Activities.WorkflowServiceHost> receives a message for a workflow service, if it is not already running (or persisted) a new workflow service instance is created.</span></span> <span data-ttu-id="5eef1-127">Jeśli przepływ pracy nie zaczyna się od działania Receive, nie można uruchomić wysyłając wiadomość, ponieważ nie istnieje żadne działania do odbierania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="5eef1-127">If a workflow does not begin with a Receive activity, it cannot be started by sending a message because there is no activity to receive the message.</span></span> <span data-ttu-id="5eef1-128">Do obsługi innych niż usługowe przepływu pracy, klasa wyprowadzona z <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> i zastąpić <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A>, <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A>, i <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A>.</span><span class="sxs-lookup"><span data-stu-id="5eef1-128">To host a non-service workflow, derive a class from <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint> and override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A>, <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A>, and <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A>.</span></span> <span data-ttu-id="5eef1-129">Zastąpienie <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A> aby Podaj identyfikator wystąpienia preferowany.</span><span class="sxs-lookup"><span data-stu-id="5eef1-129">Override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetInstanceId%2A> if you want to provide a preferred instance ID.</span></span> <span data-ttu-id="5eef1-130">Zastąpienie <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A> można utworzyć kontekstu Tworzenie niestandardowego przepływu pracy lub wypełnić istniejące wystąpienie <xref:System.ServiceModel.Activities.WorkflowCreationContext>.</span><span class="sxs-lookup"><span data-stu-id="5eef1-130">Override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnGetCreationContext%2A> to create a custom workflow creation context or populate an instance of the existing <xref:System.ServiceModel.Activities.WorkflowCreationContext>.</span></span> <span data-ttu-id="5eef1-131">Zastąpienie <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A> ręcznie wyodrębnić zakładki z komunikatu przychodzącego.</span><span class="sxs-lookup"><span data-stu-id="5eef1-131">Override <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint.OnResolveBookmark%2A> to manually extract the bookmark from the incoming message.</span></span> <span data-ttu-id="5eef1-132">Jeśli przesłonięcia tej metody należy wywołać <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> w jego treści, tak aby odpowiedzieć na wiadomość wysłana do WorkflowHostingEndpoint.</span><span class="sxs-lookup"><span data-stu-id="5eef1-132">If you override this method, you must invoke <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> in its body so as to respond to the message sent to the WorkflowHostingEndpoint.</span></span> <span data-ttu-id="5eef1-133">Jeśli to zrobisz, <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> limit może zostać przekroczony po pewnym czasie.</span><span class="sxs-lookup"><span data-stu-id="5eef1-133">If you do not do so, a <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> limit may be eventually exceeded.</span></span> <span data-ttu-id="5eef1-134">W kontrakty dwukierunkowe, można wykryć niewykonanie wywołania <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> ze względu na błąd klienta odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="5eef1-134">In two-way contracts, you may be able to detect your   failure to invoke <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> because of the client’s failure to receive a response.</span></span> <span data-ttu-id="5eef1-135">W kontraktach jednokierunkowe nie może rozpoznać błąd do wywołania, które uległy awarii <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> momentu za późno po <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> został przekroczony limit przepustnicy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-135">In one-way contracts, you may not recognize the mistake of failing to call <xref:System.ServiceModel.Activities.WorkflowHostingResponseContext.SendResponse%2A> until it’s too late, after the <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentCalls%2A> throttle limit is exceeded.</span></span> <span data-ttu-id="5eef1-136">Aby uzyskać więcej informacji, zobacz [WorkflowHostingEndpoint Wznów zakładki](../../../../docs/framework/windows-workflow-foundation/samples/workflowhostingendpoint-resume-bookmark.md)do utworzenia nowego wystąpienia przepływu pracy z systemem innym niż usługi, należy zadeklarować kontraktu usługi, który definiuje operację, która tworzy nowe wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="5eef1-136">For more information, please see the [WorkflowHostingEndpoint Resume Bookmark](../../../../docs/framework/windows-workflow-foundation/samples/workflowhostingendpoint-resume-bookmark.md)To create a new instance of a non-service workflow, declare a service contract that defines an operation that creates a new instance.</span></span> <span data-ttu-id="5eef1-137">Operacja tworzenia powinno zająć IDictionary\<string, object > do przekazania wszelkie wymagane parametry przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-137">The creation operation should take an IDictionary\<string, object> to pass any required workflow parameters.</span></span> <span data-ttu-id="5eef1-138">Ten kontrakt niejawnie jest implementowany przez <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>-klasy.</span><span class="sxs-lookup"><span data-stu-id="5eef1-138">This contract is implicitly implemented by the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>-derived class.</span></span> <span data-ttu-id="5eef1-139">Odnośnie do hostowania przepływu pracy, dodaje wystąpienie <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>-pochodnej klasy do hosta przez wywołanie metody <xref:System.ServiceModel.Activities.WorkflowServiceHost.AddServiceEndpoint%2A> i Wywołaj <!--zz xref:System.ServiceModel.Activities.WorkflowServiceHost.Open%2A--> `System.ServiceModel.Activities.WorkflowServiceHost.Open`.</span><span class="sxs-lookup"><span data-stu-id="5eef1-139">When hosting the workflow, add an instance of the <xref:System.ServiceModel.Activities.WorkflowHostingEndpoint>-derived class to the host by calling <xref:System.ServiceModel.Activities.WorkflowServiceHost.AddServiceEndpoint%2A> and call <!--zz xref:System.ServiceModel.Activities.WorkflowServiceHost.Open%2A--> `System.ServiceModel.Activities.WorkflowServiceHost.Open`.</span></span> <span data-ttu-id="5eef1-140">Aby utworzyć wystąpienie przepływu pracy, należy utworzyć <xref:System.ServiceModel.ChannelFactory%601> typ kontraktu usługi i wywołania <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A>.</span><span class="sxs-lookup"><span data-stu-id="5eef1-140">To create an instance of the workflow, create a <xref:System.ServiceModel.ChannelFactory%601> of your service contract type and call <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A>.</span></span> <span data-ttu-id="5eef1-141">Następnie można wywołać operacji tworzenia zdefiniowane w umowy serwisowej.</span><span class="sxs-lookup"><span data-stu-id="5eef1-141">You can then call the create operation defined in your service contract.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5eef1-142">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="5eef1-142">See Also</span></span>  
 [<span data-ttu-id="5eef1-143">Usługi przepływu pracy</span><span class="sxs-lookup"><span data-stu-id="5eef1-143">Workflow Services</span></span>](../../../../docs/framework/wcf/feature-details/workflow-services.md)  
 [<span data-ttu-id="5eef1-144">Działania dotyczące komunikatów</span><span class="sxs-lookup"><span data-stu-id="5eef1-144">Messaging Activities</span></span>](../../../../docs/framework/wcf/feature-details/messaging-activities.md)
