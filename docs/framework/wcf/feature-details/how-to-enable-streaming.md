---
title: 'Instrukcje: Włączanie przesyłania strumieniowego'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 6ca2cf4b-c7a1-49d8-a79b-843a90556ba4
ms.openlocfilehash: 1d1eaa1ebf41ef86478dda795b3b199239cd37b4
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/12/2020
ms.locfileid: "79184935"
---
# <a name="how-to-enable-streaming"></a><span data-ttu-id="d0597-102">Instrukcje: Włączanie przesyłania strumieniowego</span><span class="sxs-lookup"><span data-stu-id="d0597-102">How to: Enable Streaming</span></span>
<span data-ttu-id="d0597-103">Windows Communication Foundation (WCF) może wysyłać wiadomości przy użyciu buforowanych lub przesyłanych strumieniowo.</span><span class="sxs-lookup"><span data-stu-id="d0597-103">Windows Communication Foundation (WCF) can send messages using either buffered or streamed transfers.</span></span> <span data-ttu-id="d0597-104">W domyślnym trybie buforowanego transferu wiadomość musi zostać całkowicie dostarczona, zanim odbiorca będzie mógł ją odczytać.</span><span class="sxs-lookup"><span data-stu-id="d0597-104">In the default buffered-transfer mode, a message must be completely delivered before a receiver can read it.</span></span> <span data-ttu-id="d0597-105">W trybie przesyłania strumieniowego odbiorca może rozpocząć przetwarzanie wiadomości, zanim zostanie całkowicie dostarczona.</span><span class="sxs-lookup"><span data-stu-id="d0597-105">In streaming transfer mode, the receiver can begin to process the message before it is completely delivered.</span></span> <span data-ttu-id="d0597-106">Tryb przesyłania strumieniowego jest przydatne, gdy informacje, które są przekazywane jest długa i mogą być przetwarzane szeregowo.</span><span class="sxs-lookup"><span data-stu-id="d0597-106">The streaming mode is useful when the information that is passed is lengthy and can be processed serially.</span></span> <span data-ttu-id="d0597-107">Tryb przesyłania strumieniowego jest również przydatne, gdy wiadomość jest zbyt duża, aby być całkowicie buforowane.</span><span class="sxs-lookup"><span data-stu-id="d0597-107">Streaming mode is also useful when the message is too large to be entirely buffered.</span></span>  
  
 <span data-ttu-id="d0597-108">Aby włączyć przesyłanie `OperationContract` strumieniowe, należy zdefiniować odpowiednio i włączyć przesyłanie strumieniowe na poziomie transportu.</span><span class="sxs-lookup"><span data-stu-id="d0597-108">To enable streaming, define the `OperationContract` appropriately and enable streaming at the transport level.</span></span>  
  
### <a name="to-stream-data"></a><span data-ttu-id="d0597-109">Aby przesyłać strumieniowo dane</span><span class="sxs-lookup"><span data-stu-id="d0597-109">To stream data</span></span>  
  
1. <span data-ttu-id="d0597-110">Aby przesyłać `OperationContract` strumieniowo dane, usługa musi spełniać dwa wymagania:</span><span class="sxs-lookup"><span data-stu-id="d0597-110">To stream data, the `OperationContract` for the service must satisfy two requirements:</span></span>  
  
    1. <span data-ttu-id="d0597-111">Parametr, który przechowuje dane do przesyłania strumieniowego musi być jedynym parametrem w metodzie.</span><span class="sxs-lookup"><span data-stu-id="d0597-111">The parameter that holds the data to be streamed must be the only parameter in the method.</span></span> <span data-ttu-id="d0597-112">Na przykład jeśli komunikat wejściowy jest ten, który ma być przesyłany strumieniowo, operacja musi mieć dokładnie jeden parametr wejściowy.</span><span class="sxs-lookup"><span data-stu-id="d0597-112">For example, if the input message is the one to be streamed, the operation must have exactly one input parameter.</span></span> <span data-ttu-id="d0597-113">Podobnie jeśli komunikat wyjściowy ma być przesyłany strumieniowo, operacja musi mieć dokładnie jeden parametr wyjściowy lub wartość zwracaną.</span><span class="sxs-lookup"><span data-stu-id="d0597-113">Similarly, if the output message is to be streamed, the operation must have either exactly one output parameter or a return value.</span></span>  
  
    2. <span data-ttu-id="d0597-114">Co najmniej jeden z typów parametru i wartości <xref:System.IO.Stream> <xref:System.ServiceModel.Channels.Message>zwracanej <xref:System.Xml.Serialization.IXmlSerializable>musi być albo , lub .</span><span class="sxs-lookup"><span data-stu-id="d0597-114">At least one of the types of the parameter and return value must be either <xref:System.IO.Stream>, <xref:System.ServiceModel.Channels.Message>, or <xref:System.Xml.Serialization.IXmlSerializable>.</span></span>  
  
     <span data-ttu-id="d0597-115">Poniżej przedstawiono przykład kontraktu dla przesyłanych strumieniowo danych.</span><span class="sxs-lookup"><span data-stu-id="d0597-115">The following is an example of a contract for streamed data.</span></span>  
  
     [!code-csharp[c_HowTo_EnableStreaming#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_enablestreaming/cs/service.cs#1)]
     [!code-vb[c_HowTo_EnableStreaming#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howto_enablestreaming/vb/service.vb#1)]  
  
     <span data-ttu-id="d0597-116">Operacja `GetStream` odbiera niektóre buforowane dane `string`wejściowe jako , który `Stream`jest buforowany i zwraca , który jest przesyłany strumieniowo.</span><span class="sxs-lookup"><span data-stu-id="d0597-116">The `GetStream` operation receives some buffered input data as a `string`, which is buffered, and returns a `Stream`, which is streamed.</span></span> <span data-ttu-id="d0597-117">Z `UploadStream` drugiej strony `Stream` przyjmuje (przesyłane `bool` strumieniowo) i zwraca (buforowane).</span><span class="sxs-lookup"><span data-stu-id="d0597-117">Conversely `UploadStream` takes in a `Stream` (streamed) and returns a `bool` (buffered).</span></span> <span data-ttu-id="d0597-118">`EchoStream`pobiera i `Stream` zwraca i jest przykładem operacji, której komunikaty wejściowe i wyjściowe są przesyłane strumieniowo.</span><span class="sxs-lookup"><span data-stu-id="d0597-118">`EchoStream` takes and returns `Stream` and is an example of an operation whose input and output messages are both streamed.</span></span> <span data-ttu-id="d0597-119">Na koniec `GetReversedStream` nie pobiera żadnych `Stream` danych wejściowych i zwraca (przesyłane strumieniowo).</span><span class="sxs-lookup"><span data-stu-id="d0597-119">Finally, `GetReversedStream` takes no inputs and returns a `Stream` (streamed).</span></span>  
  
2. <span data-ttu-id="d0597-120">Przesyłanie strumieniowe musi być włączone w powiązaniu.</span><span class="sxs-lookup"><span data-stu-id="d0597-120">Streaming must be enabled on the binding.</span></span> <span data-ttu-id="d0597-121">Można ustawić `TransferMode` właściwość, która może przyjmować jedną z następujących wartości:</span><span class="sxs-lookup"><span data-stu-id="d0597-121">You set a `TransferMode` property, which can take one of the following values:</span></span>  
  
    1. <span data-ttu-id="d0597-122">`Buffered`,</span><span class="sxs-lookup"><span data-stu-id="d0597-122">`Buffered`,</span></span>  
  
    2. <span data-ttu-id="d0597-123">`Streamed`, który umożliwia przesyłanie strumieniowe w obu kierunkach.</span><span class="sxs-lookup"><span data-stu-id="d0597-123">`Streamed`, which enables streaming communication in both directions.</span></span>  
  
    3. <span data-ttu-id="d0597-124">`StreamedRequest`, który umożliwia przesyłanie strumieniowe tylko żądania.</span><span class="sxs-lookup"><span data-stu-id="d0597-124">`StreamedRequest`, which enables streaming the request only.</span></span>  
  
    4. <span data-ttu-id="d0597-125">`StreamedResponse`, który umożliwia przesyłanie strumieniowe tylko odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="d0597-125">`StreamedResponse`, which enables streaming the response only.</span></span>  
  
     <span data-ttu-id="d0597-126">Udostępnia `BasicHttpBinding` `TransferMode` właściwość na powiązanie, `NetTcpBinding` podobnie `NetNamedPipeBinding`jak i .</span><span class="sxs-lookup"><span data-stu-id="d0597-126">The `BasicHttpBinding` exposes the `TransferMode` property on the binding, as does `NetTcpBinding` and `NetNamedPipeBinding`.</span></span> <span data-ttu-id="d0597-127">Właściwość `TransferMode` można również ustawić na element wiązania transportu i używane w niestandardowe powiązanie.</span><span class="sxs-lookup"><span data-stu-id="d0597-127">The `TransferMode` property can also be set on the transport binding element and used in a custom binding.</span></span>  
  
     <span data-ttu-id="d0597-128">Poniższe przykłady pokazują, `TransferMode` jak ustawić za pomocą kodu i zmieniając plik konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="d0597-128">The following samples show how to set `TransferMode` by code and by changing the configuration file.</span></span> <span data-ttu-id="d0597-129">Przykłady również ustawić `maxReceivedMessageSize` właściwość do 64 MB, co umieszcza limit na maksymalny dozwolony rozmiar wiadomości na odbieranie.</span><span class="sxs-lookup"><span data-stu-id="d0597-129">The samples also both set the `maxReceivedMessageSize` property to 64 MB, which places a cap on the maximum allowable size of messages on receive.</span></span> <span data-ttu-id="d0597-130">Wartość `maxReceivedMessageSize` domyślna to 64 KB, która jest zwykle zbyt niska dla scenariuszy przesyłania strumieniowego.</span><span class="sxs-lookup"><span data-stu-id="d0597-130">The default `maxReceivedMessageSize` is 64 KB, which is usually too low for streaming scenarios.</span></span> <span data-ttu-id="d0597-131">Ustaw to ustawienie przydziału jako odpowiednie w zależności od maksymalnego rozmiaru wiadomości, które aplikacja oczekuje od otrzymania.</span><span class="sxs-lookup"><span data-stu-id="d0597-131">Set this quota setting as appropriate depending on the maximum size of messages your application expects to receive.</span></span> <span data-ttu-id="d0597-132">Należy również `maxBufferSize` zauważyć, że kontroluje maksymalny rozmiar, który jest buforowany i ustawić go odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d0597-132">Also note that `maxBufferSize` controls the maximum size that is buffered, and set it appropriately.</span></span>  
  
    1. <span data-ttu-id="d0597-133">Poniższy fragment kodu konfiguracji z przykładu `TransferMode` pokazuje ustawienie `basicHttpBinding` właściwości do przesyłania strumieniowego na i niestandardowe powiązanie HTTP.</span><span class="sxs-lookup"><span data-stu-id="d0597-133">The following configuration snippet from the sample shows setting the `TransferMode` property to streaming on the `basicHttpBinding` and a custom HTTP binding.</span></span>  
  
         [!code-xml[c_HowTo_EnableStreaming#103](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_enablestreaming/common/app.config#103)]
  
    2. <span data-ttu-id="d0597-134">Poniższy fragment kodu pokazuje ustawienie `TransferMode` właściwości do `basicHttpBinding` przesyłania strumieniowego na i niestandardowe powiązanie HTTP.</span><span class="sxs-lookup"><span data-stu-id="d0597-134">The following code snippet shows setting the `TransferMode` property to streaming on the `basicHttpBinding` and a custom HTTP binding.</span></span>  
  
         [!code-csharp[c_HowTo_EnableStreaming_code#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_enablestreaming_code/cs/c_howto_enablestreaming_code.cs#2)]
         [!code-vb[c_HowTo_EnableStreaming_code#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howto_enablestreaming_code/vb/c_howto_enablestreaming_code.vb#2)]  
  
    3. <span data-ttu-id="d0597-135">Poniższy fragment kodu pokazuje ustawienie `TransferMode` właściwości do przesyłania strumieniowego na niestandardowe powiązanie TCP.</span><span class="sxs-lookup"><span data-stu-id="d0597-135">The following code snippet shows setting the `TransferMode` property to streaming on a custom TCP binding.</span></span>  
  
         [!code-csharp[c_HowTo_EnableStreaming_code#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_enablestreaming_code/cs/c_howto_enablestreaming_code.cs#3)]
         [!code-vb[c_HowTo_EnableStreaming_code#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howto_enablestreaming_code/vb/c_howto_enablestreaming_code.vb#3)]  
  
3. <span data-ttu-id="d0597-136">Operacje `GetStream`, `UploadStream`i `EchoStream` wszystkie zajmują się wysyłaniem danych bezpośrednio z pliku lub zapisywania odebranych danych bezpośrednio do pliku.</span><span class="sxs-lookup"><span data-stu-id="d0597-136">The operations `GetStream`, `UploadStream`, and `EchoStream` all deal with sending data directly from a file or saving received data directly to a file.</span></span> <span data-ttu-id="d0597-137">Poniższy kod `GetStream`jest dla .</span><span class="sxs-lookup"><span data-stu-id="d0597-137">The following code is for `GetStream`.</span></span>  
  
     [!code-csharp[c_HowTo_EnableStreaming#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_enablestreaming/cs/service.cs#4)]
     [!code-vb[c_HowTo_EnableStreaming#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howto_enablestreaming/vb/service.vb#4)]  
  
### <a name="writing-a-custom-stream"></a><span data-ttu-id="d0597-138">Zapisywanie strumienia niestandardowego</span><span class="sxs-lookup"><span data-stu-id="d0597-138">Writing a custom stream</span></span>  
  
1. <span data-ttu-id="d0597-139">Aby wykonać specjalne przetwarzanie na każdym fragmencie strumienia danych, który jest <xref:System.IO.Stream>wysyłany lub odbierany, należy wyprowadzić niestandardową klasę strumienia z pliku .</span><span class="sxs-lookup"><span data-stu-id="d0597-139">To do special processing on each chunk of a data stream as it is being sent or received, derive a custom stream class from <xref:System.IO.Stream>.</span></span> <span data-ttu-id="d0597-140">Jako przykład strumienia niestandardowego poniższy `GetReversedStream` kod zawiera `ReverseStream` metodę i klasę.</span><span class="sxs-lookup"><span data-stu-id="d0597-140">As an example of a custom stream, the following code contains a `GetReversedStream` method and a `ReverseStream` class-.</span></span>  
  
     <span data-ttu-id="d0597-141">`GetReversedStream`tworzy i zwraca nowe `ReverseStream`wystąpienie .</span><span class="sxs-lookup"><span data-stu-id="d0597-141">`GetReversedStream` creates and returns a new instance of `ReverseStream`.</span></span> <span data-ttu-id="d0597-142">Rzeczywiste przetwarzanie odbywa się w `ReverseStream` systemie odczytuje z obiektu.</span><span class="sxs-lookup"><span data-stu-id="d0597-142">The actual processing happens as the system reads from the `ReverseStream` object.</span></span> <span data-ttu-id="d0597-143">Metoda `ReverseStream.Read` odczytuje fragment bajtów z pliku źródłowego, odwraca je, a następnie zwraca odwrócone bajty.</span><span class="sxs-lookup"><span data-stu-id="d0597-143">The `ReverseStream.Read` method reads a chunk of bytes from the underlying file, reverses them, then returns the reversed bytes.</span></span> <span data-ttu-id="d0597-144">Ta metoda nie odwraca całej zawartości pliku; odwraca jeden fragment bajtów naraz.</span><span class="sxs-lookup"><span data-stu-id="d0597-144">This method does not reverse the entire file content; it reverses one chunk of bytes at a time.</span></span> <span data-ttu-id="d0597-145">W tym przykładzie pokazano, jak można wykonać przetwarzanie strumienia, jak zawartość jest odczytywany lub zapisywany ze strumienia.</span><span class="sxs-lookup"><span data-stu-id="d0597-145">This example shows how you can perform stream processing as the content is being read to or written from the stream.</span></span>  
  
     [!code-csharp[c_HowTo_EnableStreaming#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_howto_enablestreaming/cs/service.cs#2)]
     [!code-vb[c_HowTo_EnableStreaming#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_howto_enablestreaming/vb/service.vb#2)]  
  
## <a name="see-also"></a><span data-ttu-id="d0597-146">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="d0597-146">See also</span></span>

- [<span data-ttu-id="d0597-147">Duże ilości danych i przesyłanie strumieniowe</span><span class="sxs-lookup"><span data-stu-id="d0597-147">Large Data and Streaming</span></span>](../../../../docs/framework/wcf/feature-details/large-data-and-streaming.md)
- [<span data-ttu-id="d0597-148">Strumień</span><span class="sxs-lookup"><span data-stu-id="d0597-148">Stream</span></span>](../../../../docs/framework/wcf/samples/stream.md)
