---
title: Filtry komunikatów
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- routing [WCF], message filters
ms.assetid: cb33ba49-8b1f-4099-8acb-240404a46d9a
caps.latest.revision: 8
author: wadepickett
ms.author: wpickett
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: bd5019668e865d2fea835b450d992d45b5273ed7
ms.sourcegitcommit: b750a8e3979749b214e7e10c82efb0a0524dfcb1
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/10/2018
---
# <a name="message-filters"></a><span data-ttu-id="3cffb-102">Filtry komunikatów</span><span class="sxs-lookup"><span data-stu-id="3cffb-102">Message Filters</span></span>
<span data-ttu-id="3cffb-103">Do wdrożenia na podstawie zawartości routingu, usługa routingu używa <xref:System.ServiceModel.Dispatcher.MessageFilter> implementacje sprawdzić określonych sekcji wiadomości, takie jak adres, nazwa punktu końcowego lub określonych instrukcji XPath.</span><span class="sxs-lookup"><span data-stu-id="3cffb-103">To implement content-based routing, the Routing Service uses <xref:System.ServiceModel.Dispatcher.MessageFilter> implementations that inspect specific sections of a message, such as the address, endpoint name, or a specific XPath statement.</span></span> <span data-ttu-id="3cffb-104">Jeśli żaden komunikat filtrów nie podany z [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] spełnia Twoich potrzeb, można utworzyć niestandardowy filtr przez utworzenie nowego wdrożenia podstawy <xref:System.ServiceModel.Dispatcher.MessageFilter> klasy.</span><span class="sxs-lookup"><span data-stu-id="3cffb-104">If none of the message filters provided with [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] meet your needs, you can create a custom filter by creating a new implementation of the base <xref:System.ServiceModel.Dispatcher.MessageFilter> class.</span></span>  
  
 <span data-ttu-id="3cffb-105">Podczas konfigurowania usługi routingu, należy zdefiniować filtr elementy (<xref:System.ServiceModel.Routing.Configuration.FilterElement> obiektów) opisują typ **MessageFilter** i obsługi dane wymagane do utworzenia filtru, takie jak wartości określonego ciągu wyszukiwania dla wiadomości.</span><span class="sxs-lookup"><span data-stu-id="3cffb-105">When configuring the Routing Service, you must define filter elements (<xref:System.ServiceModel.Routing.Configuration.FilterElement> objects) that describe the type of **MessageFilter** and any supporting data required to create the filter, such as specific string values to search for within the message.</span></span> <span data-ttu-id="3cffb-106">Należy pamiętać, że tylko tworzenie elementów filtr definiuje filtry poszczególnych komunikatów. Aby użyć filtrów w celu oceny i trasy wiadomości musi także definiować tabelę filtru (<xref:System.ServiceModel.Routing.Configuration.FilterTableEntryCollection>).</span><span class="sxs-lookup"><span data-stu-id="3cffb-106">Note that creating the filter elements only defines the individual message filters; to use the filters to evaluate and route messages you must also define a filter table (<xref:System.ServiceModel.Routing.Configuration.FilterTableEntryCollection>).</span></span>  
  
 <span data-ttu-id="3cffb-107">Każdy wpis w tabeli filtru odwołuje się do elementu filtru i umożliwia określenie punktu końcowego klienta, który wiadomości będą kierowane do Jeśli komunikat jest zgodny z filtrem.</span><span class="sxs-lookup"><span data-stu-id="3cffb-107">Each entry in the filter table references a filter element and specifies the client endpoint that a message will be routed to if the message matches the filter.</span></span> <span data-ttu-id="3cffb-108">Wpisy tabeli filtrów pozwalają również określić kolekcję punktów końcowych kopii zapasowej (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>), który definiuje listę punktów końcowych, które wiadomości zostaną przekazane w przypadku niepowodzenia przesyłania przy wysyłaniu do podstawowego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3cffb-108">The filter table entries also allow you to specify a collection of backup endpoints (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>), which defines a list of endpoints that the message will be transmitted to in the event of a transmission failure when sending to the primary endpoint.</span></span> <span data-ttu-id="3cffb-109">Te punkty końcowe zostaną sprawdzone w kolejności określonej aż do znalezienia właściwego konta.</span><span class="sxs-lookup"><span data-stu-id="3cffb-109">These endpoints will be tried in the order specified until one succeeds.</span></span>  
  
## <a name="message-filters"></a><span data-ttu-id="3cffb-110">Filtry komunikatów</span><span class="sxs-lookup"><span data-stu-id="3cffb-110">Message Filters</span></span>  
 <span data-ttu-id="3cffb-111">Filtry komunikatów używane przez usługę Routing Podaj typowe funkcje wybór wiadomości, takie jak nazwa punktu końcowego, że wiadomość została wysłana do akcji SOAP lub adres lub prefiks adresu, który wiadomość została wysłana do oceny.</span><span class="sxs-lookup"><span data-stu-id="3cffb-111">The message filters used by the Routing Service provide common message selection functionality, such as evaluating the name of the endpoint that a message was sent to, the SOAP action, or the address or address prefix that the message was sent to.</span></span> <span data-ttu-id="3cffb-112">Filtry można również łączyć z `AND` warunek, dzięki czemu wiadomości tylko będą kierowane do punktu końcowego, jeśli komunikat jest zgodny zarówno filtrów.</span><span class="sxs-lookup"><span data-stu-id="3cffb-112">Filters can also be joined with an `AND` condition, so that messages will only be routed to an endpoint if the message matches both filters.</span></span> <span data-ttu-id="3cffb-113">Można również utworzyć filtry niestandardowe, tworząc własne wykonania <xref:System.ServiceModel.Dispatcher.MessageFilter>.</span><span class="sxs-lookup"><span data-stu-id="3cffb-113">You can also create custom filters by creating your own implementation of <xref:System.ServiceModel.Dispatcher.MessageFilter>.</span></span>  
  
 <span data-ttu-id="3cffb-114">W poniższej tabeli wymieniono <xref:System.ServiceModel.Routing.Configuration.FilterType> używane przez usługę Routing klasy, która implementuje filtr określonego komunikatu i wymaganych <xref:System.ServiceModel.Routing.Configuration.FilterElement.FilterData%2A> parametrów.</span><span class="sxs-lookup"><span data-stu-id="3cffb-114">The following table lists the <xref:System.ServiceModel.Routing.Configuration.FilterType> used by the Routing Service, the class that implements the specific message filter, and the required <xref:System.ServiceModel.Routing.Configuration.FilterElement.FilterData%2A> parameters.</span></span>  
  
|<span data-ttu-id="3cffb-115">Typ filtru</span><span class="sxs-lookup"><span data-stu-id="3cffb-115">Filter  Type</span></span>|<span data-ttu-id="3cffb-116">Opis</span><span class="sxs-lookup"><span data-stu-id="3cffb-116">Description</span></span>|<span data-ttu-id="3cffb-117">Znaczenie danych filtru</span><span class="sxs-lookup"><span data-stu-id="3cffb-117">Filter Data Meaning</span></span>|<span data-ttu-id="3cffb-118">Przykład filtru</span><span class="sxs-lookup"><span data-stu-id="3cffb-118">Example Filter</span></span>|  
|------------------|-----------------|-------------------------|--------------------|  
|<span data-ttu-id="3cffb-119">Akcja</span><span class="sxs-lookup"><span data-stu-id="3cffb-119">Action</span></span>|<span data-ttu-id="3cffb-120">Używa <xref:System.ServiceModel.Dispatcher.ActionMessageFilter> klasę wiadomości zawierające określonej akcji.</span><span class="sxs-lookup"><span data-stu-id="3cffb-120">Uses the <xref:System.ServiceModel.Dispatcher.ActionMessageFilter> class to match messages containing a specific action.</span></span>|<span data-ttu-id="3cffb-121">Akcja filtrowania na.</span><span class="sxs-lookup"><span data-stu-id="3cffb-121">The action to filter upon.</span></span>|<span data-ttu-id="3cffb-122">\<filter name="action1" filterType="Action" filterData="http://namespace/contract/operation" /></span><span class="sxs-lookup"><span data-stu-id="3cffb-122">\<filter name="action1" filterType="Action" filterData="http://namespace/contract/operation" /></span></span>|  
|<span data-ttu-id="3cffb-123">EndpointAddress</span><span class="sxs-lookup"><span data-stu-id="3cffb-123">EndpointAddress</span></span>|<span data-ttu-id="3cffb-124">Używa <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter> klasy, z <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter.IncludeHostNameInComparison%2A>  ==  `true` odpowiadające wiadomości zawierające określonego adresu.</span><span class="sxs-lookup"><span data-stu-id="3cffb-124">Uses the <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter> class, with <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter.IncludeHostNameInComparison%2A> == `true` to match messages containing a specific address.</span></span>|<span data-ttu-id="3cffb-125">Adres do filtrowania po (w nagłówku do).</span><span class="sxs-lookup"><span data-stu-id="3cffb-125">The address to filter upon (in the To header).</span></span>|<span data-ttu-id="3cffb-126">\<filter name="address1" filterType="EndpointAddress" filterData="http://host/vdir/s.svc/b"  /></span><span class="sxs-lookup"><span data-stu-id="3cffb-126">\<filter name="address1" filterType="EndpointAddress" filterData="http://host/vdir/s.svc/b"  /></span></span>|  
|<span data-ttu-id="3cffb-127">EndpointAddressPrefix</span><span class="sxs-lookup"><span data-stu-id="3cffb-127">EndpointAddressPrefix</span></span>|<span data-ttu-id="3cffb-128">Używa <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter> klasy, z <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter.IncludeHostNameInComparison%2A>  ==  `true` odpowiadające wiadomości zawierające prefiksu określonego adresu.</span><span class="sxs-lookup"><span data-stu-id="3cffb-128">Uses the <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter> class, with <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter.IncludeHostNameInComparison%2A> == `true` to match messages containing a specific address prefix.</span></span>|<span data-ttu-id="3cffb-129">Adres do filtrowania przy użyciu najdłuższe dopasowanie prefiksów.</span><span class="sxs-lookup"><span data-stu-id="3cffb-129">The address to filter upon using longest prefix matching.</span></span>|<span data-ttu-id="3cffb-130">\<filter name="prefix1" filterType="EndpointAddressPrefix" filterData="http://host/" /></span><span class="sxs-lookup"><span data-stu-id="3cffb-130">\<filter name="prefix1" filterType="EndpointAddressPrefix" filterData="http://host/" /></span></span>|  
|<span data-ttu-id="3cffb-131">I</span><span class="sxs-lookup"><span data-stu-id="3cffb-131">And</span></span>|<span data-ttu-id="3cffb-132">Używa <xref:System.ServiceModel.Dispatcher.StrictAndMessageFilter> klasy, która zawsze ocenia oba warunki przed zwróceniem.</span><span class="sxs-lookup"><span data-stu-id="3cffb-132">Uses the <xref:System.ServiceModel.Dispatcher.StrictAndMessageFilter> class that always evaluates both conditions before returning.</span></span>|<span data-ttu-id="3cffb-133">danych filtru nie jest używany; Zamiast tego Filtr1 i filtr2 mają nazwy odpowiedniego komunikatu filtrów (również w tabeli), które powinny być **i**ed razem.</span><span class="sxs-lookup"><span data-stu-id="3cffb-133">filterData is not used; instead filter1 and filter2 have the names of the corresponding message filters (also in the table), which should be **AND**ed together.</span></span>|<span data-ttu-id="3cffb-134">\<filter name="and1" filterType="And" filter1="address1" filter2="action1" /></span><span class="sxs-lookup"><span data-stu-id="3cffb-134">\<filter name="and1" filterType="And" filter1="address1" filter2="action1" /></span></span>|  
|<span data-ttu-id="3cffb-135">Niestandardowe</span><span class="sxs-lookup"><span data-stu-id="3cffb-135">Custom</span></span>|<span data-ttu-id="3cffb-136">Zdefiniowane przez użytkownika typu, rozszerzający <xref:System.ServiceModel.Dispatcher.MessageFilter> klasy i ma konstruktor przyjmujący ciąg.</span><span class="sxs-lookup"><span data-stu-id="3cffb-136">A user-defined type that extends the <xref:System.ServiceModel.Dispatcher.MessageFilter> class and has a constructor taking a string.</span></span>|<span data-ttu-id="3cffb-137">Customtype — atrybut jest typu w pełni kwalifikowaną nazwę klasy w celu utworzenia; danych filtru jest parametry do przekazania do konstruktora podczas tworzenia filtru.</span><span class="sxs-lookup"><span data-stu-id="3cffb-137">The customType attribute is the fully qualified type name of the class to create; filterData is the string to pass to the constructor when creating the filter.</span></span>|<span data-ttu-id="3cffb-138">\<filter name="custom1" filterType="Custom" customType="CustomAssembly.CustomMsgFilter, CustomAssembly" filterData="Custom Data" /></span><span class="sxs-lookup"><span data-stu-id="3cffb-138">\<filter name="custom1" filterType="Custom" customType="CustomAssembly.CustomMsgFilter, CustomAssembly" filterData="Custom Data" /></span></span>|  
|<span data-ttu-id="3cffb-139">EndpointName</span><span class="sxs-lookup"><span data-stu-id="3cffb-139">EndpointName</span></span>|<span data-ttu-id="3cffb-140">Używa <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter> klasę wiadomości na podstawie nazwy przybyły na punktu końcowego usługi.</span><span class="sxs-lookup"><span data-stu-id="3cffb-140">Uses the <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter> class to match messages based on the name of the service endpoint they arrived on.</span></span>|<span data-ttu-id="3cffb-141">Nazwa punktu końcowego usługi, na przykład: "serviceEndpoint1".</span><span class="sxs-lookup"><span data-stu-id="3cffb-141">The name of the service endpoint, for example: "serviceEndpoint1".</span></span>  <span data-ttu-id="3cffb-142">Powinno to być jeden z punktów końcowych, narażone na usługi routingu.</span><span class="sxs-lookup"><span data-stu-id="3cffb-142">This should be one of the endpoints exposed on the Routing Service.</span></span>|<span data-ttu-id="3cffb-143">\<filter name="stock1" filterType="Endpoint" filterData="SvcEndpoint" /></span><span class="sxs-lookup"><span data-stu-id="3cffb-143">\<filter name="stock1" filterType="Endpoint" filterData="SvcEndpoint" /></span></span>|  
|<span data-ttu-id="3cffb-144">MatchAll</span><span class="sxs-lookup"><span data-stu-id="3cffb-144">MatchAll</span></span>|<span data-ttu-id="3cffb-145">Używa <xref:System.ServiceModel.Dispatcher.MatchAllMessageFilter> klasy.</span><span class="sxs-lookup"><span data-stu-id="3cffb-145">Uses the <xref:System.ServiceModel.Dispatcher.MatchAllMessageFilter> class.</span></span> <span data-ttu-id="3cffb-146">Ten filtr dopasowuje wszystkie komunikaty o nadchodzących.</span><span class="sxs-lookup"><span data-stu-id="3cffb-146">This filter matches all arriving messages.</span></span>|<span data-ttu-id="3cffb-147">danych filtru nie jest używany.</span><span class="sxs-lookup"><span data-stu-id="3cffb-147">filterData is not used.</span></span> <span data-ttu-id="3cffb-148">Ten filtr będzie zawsze zgodna wszystkie komunikaty.</span><span class="sxs-lookup"><span data-stu-id="3cffb-148">This filter will always match all messages.</span></span>|<span data-ttu-id="3cffb-149">\<filter name="matchAll1" filterType="MatchAll" /></span><span class="sxs-lookup"><span data-stu-id="3cffb-149">\<filter name="matchAll1" filterType="MatchAll" /></span></span>|  
|<span data-ttu-id="3cffb-150">XPath</span><span class="sxs-lookup"><span data-stu-id="3cffb-150">XPath</span></span>|<span data-ttu-id="3cffb-151">Używa <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> klasy do dopasowania określonej kwerendy XPath w komunikacie.</span><span class="sxs-lookup"><span data-stu-id="3cffb-151">Uses the <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> class to match specific XPath queries within the message.</span></span>|<span data-ttu-id="3cffb-152">Zapytanie XPath do użycia podczas dopasowywania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="3cffb-152">The XPath query to use when matching messages.</span></span>|<span data-ttu-id="3cffb-153">\<filter name="XPath1" filterType="XPath" filterData="//ns:element" /></span><span class="sxs-lookup"><span data-stu-id="3cffb-153">\<filter name="XPath1" filterType="XPath" filterData="//ns:element" /></span></span>|  
  
 <span data-ttu-id="3cffb-154">W poniższym przykładzie zdefiniowano filtru wpisów, które należy używać filtrów wiadomości XPath, EndpointName i PrefixEndpointAddress.</span><span class="sxs-lookup"><span data-stu-id="3cffb-154">The following example defines filter entries that use the XPath, EndpointName, and PrefixEndpointAddress message filters.</span></span> <span data-ttu-id="3cffb-155">W przykładzie pokazano także przy użyciu niestandardowego filtru dla wpisów RoundRobinFilter1 i RoundRobinFilter2.</span><span class="sxs-lookup"><span data-stu-id="3cffb-155">This example also demonstrates using a custom filter for the RoundRobinFilter1 and RoundRobinFilter2 entries.</span></span>  
  
```xml  
<filters>  
     <filter name="XPathFilter" filterType="XPath"   
             filterData="/s12:Envelope/s12:Header/custom:RoundingCalculator = 1"/>  
     <filter name="EndpointNameFilter" filterType="EndpointName"   
             filterData="calculatorEndpoint"/>  
     <filter name="PrefixAddressFilter" filterType="PrefixEndpointAddress"   
             filterData="http://localhost/routingservice/router/rounding/"/>  
     <filter name="RoundRobinFilter1" filterType="Custom"   
             customType="RoutingServiceFilters.RoundRobinMessageFilter,   
             RoutingService" filterData="group1"/>  
     <filter name="RoundRobinFilter2" filterType="Custom"   
             customType="RoutingServiceFilters.RoundRobinMessageFilter,   
             RoutingService" filterData="group1"/>  
</filters>  
```  
  
> [!NOTE]
>  <span data-ttu-id="3cffb-156">Po prostu Definiowanie filtru nie powoduje wiadomości ma zostać obliczone dla filtru.</span><span class="sxs-lookup"><span data-stu-id="3cffb-156">Simply defining a filter does not cause messages to be evaluated against the filter.</span></span> <span data-ttu-id="3cffb-157">Filtr musi zostać dodany do tabeli filtr, który jest następnie skojarzone z punktem końcowym usługi udostępniane przez usługi routingu.</span><span class="sxs-lookup"><span data-stu-id="3cffb-157">The filter must be added to a filter table, which is then associated with the service endpoint exposed by the Routing Service.</span></span>  
  
### <a name="namespace-table"></a><span data-ttu-id="3cffb-158">Namespace tabeli</span><span class="sxs-lookup"><span data-stu-id="3cffb-158">Namespace Table</span></span>  
 <span data-ttu-id="3cffb-159">Podczas korzystania z filtrów XPath, dane filtr zawiera zapytanie XPath może stać się bardzo dużą z powodu używania przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="3cffb-159">When using an XPath filter, the filter data that contains the XPath query can become extremely large due to the use of namespaces.</span></span> <span data-ttu-id="3cffb-160">Aby rozwiązanie tego problemu usługa routingu udostępnia możliwość definiowania własnych prefiksy przestrzeni nazw przy użyciu tabeli nazw.</span><span class="sxs-lookup"><span data-stu-id="3cffb-160">To alleviate this problem the Routing Service provides the ability to define your own namespace prefixes by using the namespace table.</span></span>  
  
 <span data-ttu-id="3cffb-161">Tabela nazw jest kolekcją <xref:System.ServiceModel.Routing.Configuration.NamespaceElement> obiektów, które definiuje prefiksy przestrzeni nazw dla typowych przestrzenie nazw, które mogą być używane w elemencie XPath.</span><span class="sxs-lookup"><span data-stu-id="3cffb-161">The namespace table is a collection of <xref:System.ServiceModel.Routing.Configuration.NamespaceElement> objects that defines the namespace prefixes for common namespaces that can be used in an XPath.</span></span> <span data-ttu-id="3cffb-162">Poniżej przedstawiono domyślne obszary nazw i przestrzeni nazw prefiksów, które znajdują się w tabeli nazw.</span><span class="sxs-lookup"><span data-stu-id="3cffb-162">The following are the default namespaces and namespace prefixes that are contained in the namespace table.</span></span>  
  
|<span data-ttu-id="3cffb-163">Prefiks</span><span class="sxs-lookup"><span data-stu-id="3cffb-163">Prefix</span></span>|<span data-ttu-id="3cffb-164">Przestrzeń nazw</span><span class="sxs-lookup"><span data-stu-id="3cffb-164">Namespace</span></span>|  
|------------|---------------|  
|<span data-ttu-id="3cffb-165">s11</span><span class="sxs-lookup"><span data-stu-id="3cffb-165">s11</span></span>|http://schemas.xmlsoap.org/soap/envelope|  
|<span data-ttu-id="3cffb-166">s12</span><span class="sxs-lookup"><span data-stu-id="3cffb-166">s12</span></span>|http://www.w3.org/2003/05/soap-envelope|  
|<span data-ttu-id="3cffb-167">wsaAugust2004</span><span class="sxs-lookup"><span data-stu-id="3cffb-167">wsaAugust2004</span></span>|http://schemas.xmlsoap.org/ws/2004/08/addressing|  
|<span data-ttu-id="3cffb-168">wsa10</span><span class="sxs-lookup"><span data-stu-id="3cffb-168">wsa10</span></span>|http://www.w3.org/2005/08/addressing|  
|<span data-ttu-id="3cffb-169">sm</span><span class="sxs-lookup"><span data-stu-id="3cffb-169">sm</span></span>|http://schemas.microsoft.com/serviceModel/2004/05/xpathfunctions|  
|<span data-ttu-id="3cffb-170">tempuri</span><span class="sxs-lookup"><span data-stu-id="3cffb-170">tempuri</span></span>|http://tempuri.org|  
|<span data-ttu-id="3cffb-171">ser</span><span class="sxs-lookup"><span data-stu-id="3cffb-171">ser</span></span>|http://schemas.microsoft.com/2003/10/Serialization|  
  
 <span data-ttu-id="3cffb-172">Gdy wiesz, że będziesz używać określonego obszaru nazw zapytania XPath, można dodać go do tabeli przestrzeni nazw, wraz z prefiksem unikatową przestrzeń nazw i Użyj prefiksu w każde zapytanie XPath zamiast pełnej przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="3cffb-172">When you know that you will be using a specific namespace in your XPath queries, you can add it to the namespace table along with a unique namespace prefix and use the prefix in any XPath query instead of the full namespace.</span></span> <span data-ttu-id="3cffb-173">W poniższym przykładzie zdefiniowano prefiksu "custom" dla przestrzeni nazw "http://my.custom.namespace", który następnie jest używany w zapytaniu XPath zawarte w danych filtru.</span><span class="sxs-lookup"><span data-stu-id="3cffb-173">The following example defines a prefix of "custom" for the namespace "http://my.custom.namespace", which is then used in the XPath query contained in filterData.</span></span>  
  
```xml  
<namespaceTable>  
     <add prefix="custom" namespace="http://my.custom.namespace/"/>  
</namespaceTable>  
<filters>  
     <filter name="XPathFilter" filterType="XPath" filterData="/s12:Envelope/s12:Header/custom:RoundingCalculator = 1"/>  
</filters>  
```  
  
## <a name="filter-tables"></a><span data-ttu-id="3cffb-174">Tabele filtru</span><span class="sxs-lookup"><span data-stu-id="3cffb-174">Filter Tables</span></span>  
 <span data-ttu-id="3cffb-175">Podczas każdego elementu filtr definiuje logicznej porównanie, które mogą być stosowane do wiadomości, tabeli filtru zawiera skojarzenie elementu filtr docelowy punkt końcowy klienta.</span><span class="sxs-lookup"><span data-stu-id="3cffb-175">While each filter element defines a logical comparison that can be applied to a message, the filter table provides the association between the filter element and the destination client endpoint.</span></span> <span data-ttu-id="3cffb-176">Tabela Filtr jest nazwanej kolekcji <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement> obiekty, które określają skojarzenie między filtru, punkt końcowy miejsce docelowe głównej i listę alternatywnej kopii zapasowej punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3cffb-176">A filter table is a named collection of <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement> objects that define the association between a filter, a primary destination endpoint, and a list of alternative backup endpoints.</span></span> <span data-ttu-id="3cffb-177">Wpisy tabeli filtrów pozwalają również określić opcjonalny priorytet dla każdego warunku filtru.</span><span class="sxs-lookup"><span data-stu-id="3cffb-177">The filter table entries also allow you to specify an optional priority for each filter condition.</span></span> <span data-ttu-id="3cffb-178">W poniższym przykładzie definiuje dwa filtry i następnie definiuje tabeli filtrów, które kojarzy każdego filtru z docelowym punktem końcowym.</span><span class="sxs-lookup"><span data-stu-id="3cffb-178">The following example defines two filters and then defines a filter table that associates each filter with a destination endpoint.</span></span>  
  
```xml  
<routing>  
     <filters>  
       <filter name="AddAction" filterType="Action" filterData="Add" />  
       <filter name="SubtractAction" filterType="Action" filterData="Subtract" />  
     </filters>  
     <filterTables>  
       <table name="routingTable1">  
         <filters>  
           <add filterName="AddAction" endpointName="Addition" />  
           <add filterName="SubtractAction" endpointName="Subtraction" />  
         </filters>  
       </table>  
     </filterTables>      
</routing>  
```  
  
### <a name="filter-evaluation-priority"></a><span data-ttu-id="3cffb-179">Priorytet oceny filtru</span><span class="sxs-lookup"><span data-stu-id="3cffb-179">Filter Evaluation Priority</span></span>  
 <span data-ttu-id="3cffb-180">Domyślnie wszystkie wpisy w tabeli filtru są oceniane jednocześnie, a komunikat oceniane jest kierowany do punktów końcowych skojarzonych z każdego pasującego wpisu filtru.</span><span class="sxs-lookup"><span data-stu-id="3cffb-180">By default, all entries in the filter table are evaluated simultaneously, and the message being evaluated is routed to the endpoint(s) associated with each matching filter entry.</span></span> <span data-ttu-id="3cffb-181">Jeśli mają wiele filtrów `true`i wiadomość jest jednokierunkowa lub dupleks, wiadomość jest multiemisji do punktów końcowych dla wszystkie filtry zgodne.</span><span class="sxs-lookup"><span data-stu-id="3cffb-181">If multiple filters evaluate to `true`, and the message is one-way or duplex, the message is multicast to the endpoints for all matching filters.</span></span> <span data-ttu-id="3cffb-182">Komunikaty żądanie odpowiedź nie może być multiemisji, ponieważ tylko jedną odpowiedź może być zwracany do klienta.</span><span class="sxs-lookup"><span data-stu-id="3cffb-182">Request-reply messages cannot be multicast because only one reply can be returned to the client.</span></span>  
  
 <span data-ttu-id="3cffb-183">Bardziej złożonej logiki routingu może być zaimplementowany przez określenie priorytetów dla każdego filtru; Usługa routingu najpierw sprawdza wszystkie filtry na najwyższym poziomie priorytetu.</span><span class="sxs-lookup"><span data-stu-id="3cffb-183">More complex routing logic can be implemented by specifying priority levels for each filter; the Routing Service evaluates all filters at the highest priority level first.</span></span> <span data-ttu-id="3cffb-184">Jeśli komunikat jest zgodny z filtrem tego poziomu, są przetwarzane żadnych filtrów o niższym priorytecie.</span><span class="sxs-lookup"><span data-stu-id="3cffb-184">If a message matches a filter of this level, no filters of a lower priority are processed.</span></span> <span data-ttu-id="3cffb-185">Na przykład przychodzącego komunikatu jednokierunkowego najpierw jest porównywany wszystkie filtry o priorytecie 2.</span><span class="sxs-lookup"><span data-stu-id="3cffb-185">For example, an incoming one-way message is first evaluated against all filters with a priority of 2.</span></span> <span data-ttu-id="3cffb-186">Komunikat nie pasuje do żadnego filtru na tym poziomie priorytetu, więc obok komunikatu jest porównywana filtry o priorytecie 1.</span><span class="sxs-lookup"><span data-stu-id="3cffb-186">The message does not match any filter at this priority level, so next the message is compared against filters with a priority of 1.</span></span> <span data-ttu-id="3cffb-187">Dwa filtry o priorytecie 1 zgodny komunikat, a ponieważ jest on komunikat jednokierunkowy jest kierowany do punktów końcowych zarówno docelowego.</span><span class="sxs-lookup"><span data-stu-id="3cffb-187">Two priority 1 filters match the message, and because it is a one-way message it is routed to both destination endpoints.</span></span>  <span data-ttu-id="3cffb-188">Ponieważ między filtry o priorytecie 1 znaleziono dopasowania, są oceniane żadnych filtrów priorytet 0.</span><span class="sxs-lookup"><span data-stu-id="3cffb-188">Because a match was found among the priority 1 filters, no filters of priority 0 are evaluated.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3cffb-189">Jeśli jest określony żaden priorytet, jest używany domyślny priorytet 0.</span><span class="sxs-lookup"><span data-stu-id="3cffb-189">If no priority is specified, the default priority of 0 is used.</span></span>  
  
 <span data-ttu-id="3cffb-190">W poniższym przykładzie zdefiniowano filtru tabeli, która określa priorytety 2, 1 i 0 dla filtrów odwołuje się do tabeli.</span><span class="sxs-lookup"><span data-stu-id="3cffb-190">The following example defines a filter table that specifies priorities of 2, 1, and 0 for the filters referenced in the table.</span></span>  
  
```xml  
<filterTables>  
     <filterTable name="filterTable1">  
          <add filterName="XPathFilter" endpointName="roundingCalcEndpoint"   
               priority="2"/>  
          <add filterName="EndpointNameFilter" endpointName="regularCalcEndpoint"   
               priority="1"/>  
          <add filterName="PrefixAddressFilter" endpointName="roundingCalcEndpoint"   
               priority="1"/>  
          <add filterName="MatchAllMessageFilter" endpointName="defaultCalcEndpoint"   
               priority="0"/>  
     </filterTable>  
</filterTables>  
```  
  
 <span data-ttu-id="3cffb-191">W poprzednim przykładzie Jeśli obiekt XPathFilter dopasuje komunikat o stanie, zostaną przesłane roundingCalcEndpoint i żadne dodatkowe filtry w tabeli zostanie obliczone, ponieważ wszystkie pozostałe filtry o niższym priorytecie.</span><span class="sxs-lookup"><span data-stu-id="3cffb-191">In the preceding example, if a message matches the XPathFilter, it will be routed to the roundingCalcEndpoint and no further filters in the table will be evaluated because all other filters are of a lower priority.</span></span> <span data-ttu-id="3cffb-192">Jednak jeśli komunikat jest niezgodny obiekt XPathFilter następnie jest szacowana wszystkie filtry dalej niższego priorytetu, EndpointNameFilter i PrefixAddressFilter.</span><span class="sxs-lookup"><span data-stu-id="3cffb-192">However, if the message does not match the XPathFilter it will then be evaluated against all filters of the next lower priority, EndpointNameFilter and PrefixAddressFilter.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3cffb-193">Jeśli to możliwe, należy używać filtrów wyłącznego zamiast określania priorytet, ponieważ obliczanie priorytetu może spowodować obniżenie wydajności.</span><span class="sxs-lookup"><span data-stu-id="3cffb-193">When possible, use exclusive filters instead of specifying a priority because priority evaluation can result in performance degradation.</span></span>  
  
### <a name="backup-lists"></a><span data-ttu-id="3cffb-194">Listy kopii zapasowej</span><span class="sxs-lookup"><span data-stu-id="3cffb-194">Backup Lists</span></span>  
 <span data-ttu-id="3cffb-195">Każdy filtr w tabeli filtrów można opcjonalnie określić listy kopii zapasowych, który jest nazywany kolekcją punktów końcowych (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>).</span><span class="sxs-lookup"><span data-stu-id="3cffb-195">Each filter in the filter table can optionally specify a backup list, which is a named collection of endpoints (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>).</span></span> <span data-ttu-id="3cffb-196">Ta kolekcja zawiera uporządkowaną listę punktów końcowych, które wiadomości zostaną przekazane w przypadku <xref:System.ServiceModel.CommunicationException> przy wysyłaniu do podstawowy punkt końcowy określony w <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement.EndpointName%2A>.</span><span class="sxs-lookup"><span data-stu-id="3cffb-196">This collection contains an ordered list of endpoints that the message will be transmitted to in the event of a <xref:System.ServiceModel.CommunicationException> when sending to the primary endpoint specified in <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement.EndpointName%2A>.</span></span> <span data-ttu-id="3cffb-197">W poniższym przykładzie zdefiniowano listy kopii zapasowych o nazwie "backupServiceEndpoints", który zawiera dwa punkty końcowe.</span><span class="sxs-lookup"><span data-stu-id="3cffb-197">The following example defines a backup list named "backupServiceEndpoints" that contains two endpoints.</span></span>  
  
```xml  
<filterTables>  
     <filterTable name="filterTable1">  
          <add filterName="MatchAllFilter1" endpointName="Destination" backupList="backupEndpointList"/>  
     </filterTable>  
</filterTables>  
<backupLists>  
     <backupList name="backupEndpointList">  
          <add endpointName="backupServiceQueue" />  
          <add endpointName="alternateServiceQueue" />  
     </backupList>  
</backupLists>  
```  
  
 <span data-ttu-id="3cffb-198">W poprzednim przykładzie, jeśli wysyłania do podstawowego punktu końcowego "Miejsce docelowe" zakończy się niepowodzeniem, usługa routingu spróbuje wysyłane do każdego punktu końcowego w sekwencji, są one wyświetlane, najpierw wysyłane do backupServiceQueue i następnie wysyłanie do alternateServiceQueue, jeśli Wyślij do backupServiceQueue kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="3cffb-198">In the preceding example, if a send to the primary endpoint "Destination" fails, the Routing Service will try sending to each endpoint in the sequence they are listed, first sending to backupServiceQueue and subsequently sending to alternateServiceQueue if the send to backupServiceQueue fails.</span></span> <span data-ttu-id="3cffb-199">Jeśli wszystkie punkty końcowe kopii zapasowej zakończą się niepowodzeniem, zostanie zwrócony błąd.</span><span class="sxs-lookup"><span data-stu-id="3cffb-199">If all backup endpoints fail, a fault is returned.</span></span>
