---
title: Współużytkowanie portów w składniku Net.TCP
description: Dowiedz się więcej na temat protokołu opartego na protokole TCP na potrzeby komunikacji o wysokiej wydajności i usługi umożliwiającej współużytkowanie portów przez wiele procesów użytkownika w programie WCF.
ms.date: 03/30/2017
helpviewer_keywords:
- port activation [WCF]
- port sharing [WCF]
ms.assetid: f13692ee-a179-4439-ae72-50db9534eded
ms.openlocfilehash: 37e2c1de4516cbde58970db685422c5c65e25fb3
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/26/2020
ms.locfileid: "96248100"
---
# <a name="nettcp-port-sharing"></a><span data-ttu-id="ff53f-103">Współużytkowanie portów w składniku Net.TCP</span><span class="sxs-lookup"><span data-stu-id="ff53f-103">Net.TCP Port Sharing</span></span>

<span data-ttu-id="ff53f-104">Windows Communication Foundation (WCF) udostępnia nowy protokół sieciowy oparty na protokole TCP (NET. TCP://) na potrzeby komunikacji o wysokiej wydajności.</span><span class="sxs-lookup"><span data-stu-id="ff53f-104">Windows Communication Foundation (WCF) provides a new TCP-based network protocol (net.tcp://) for high-performance communication.</span></span> <span data-ttu-id="ff53f-105">W programie WCF wprowadzono również nowy składnik systemu, usługę udostępniania portów Net. TCP, która umożliwia współużytkowanie portów Net. TCP między wieloma procesami użytkownika.</span><span class="sxs-lookup"><span data-stu-id="ff53f-105">WCF also introduces a new system component, the Net.TCP Port Sharing Service that enables net.tcp ports to be shared across multiple user processes.</span></span>  
  
## <a name="background-and-motivation"></a><span data-ttu-id="ff53f-106">Tło i motywacja</span><span class="sxs-lookup"><span data-stu-id="ff53f-106">Background and Motivation</span></span>  

 <span data-ttu-id="ff53f-107">Po pierwszym wprowadzeniu protokołu TCP/IP jest używana tylko niewielka liczba protokołów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ff53f-107">When the TCP/IP protocol was first introduced, only a small number of application protocols made use of it.</span></span> <span data-ttu-id="ff53f-108">Protokół TCP/IP używa numerów portów do rozróżniania między aplikacjami przez przypisanie unikatowego numeru portu 16-bitowego do każdego protokołu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ff53f-108">TCP/IP used port numbers to differentiate between applications by assigning a unique 16-bit port number to each application protocol.</span></span> <span data-ttu-id="ff53f-109">Na przykład obecnie ruch HTTP jest standardem używanym do korzystania z portu TCP 80, SMTP używa portu 25 TCP, a FTP używa portów TCP 20 i 21.</span><span class="sxs-lookup"><span data-stu-id="ff53f-109">For example, HTTP traffic today is standardized to use TCP port 80, SMTP uses TCP port 25, and FTP uses TCP ports 20 and 21.</span></span> <span data-ttu-id="ff53f-110">Inne aplikacje korzystające z protokołu TCP jako transportu mogą wybrać inny dostępny numer portu (według Konwencji lub do formalnej normalizacji).</span><span class="sxs-lookup"><span data-stu-id="ff53f-110">Other applications using TCP as a transport can choose another available port number, either by convention or through formal standardization.</span></span>  
  
 <span data-ttu-id="ff53f-111">Używanie numerów portów do rozróżniania między aplikacjami ma problemy z zabezpieczeniami.</span><span class="sxs-lookup"><span data-stu-id="ff53f-111">Using port numbers to distinguish between applications had security problems.</span></span> <span data-ttu-id="ff53f-112">Zapory są zwykle skonfigurowane do blokowania ruchu TCP na wszystkich portach z wyjątkiem kilku dobrze znanych punktów wejścia, dlatego wdrożenie aplikacji używającej niestandardowego portu jest często skomplikowane lub nawet niemożliwe ze względu na obecność firmowych i osobistych zapór.</span><span class="sxs-lookup"><span data-stu-id="ff53f-112">Firewalls are generally configured to block TCP traffic on all ports except for a few well-known entry points, so deploying an application that uses a non-standard port is often complicated or even impossible due to the presence of corporate and personal firewalls.</span></span> <span data-ttu-id="ff53f-113">Aplikacje, które mogą komunikować się za pośrednictwem standardowych, dobrze znanych portów, które są już dozwolone, zmniejszają powierzchnię zewnętrznego ataku.</span><span class="sxs-lookup"><span data-stu-id="ff53f-113">Applications that can communicate over standard, well-known ports that are already permitted, reduce the external attack surface.</span></span> <span data-ttu-id="ff53f-114">Wiele aplikacji sieciowych korzysta z protokołu HTTP, ponieważ większość zapór jest domyślnie skonfigurowanych do zezwalania na ruch na porcie TCP 80.</span><span class="sxs-lookup"><span data-stu-id="ff53f-114">Many network applications make use of the HTTP protocol because most firewalls are configured by default to allow traffic on TCP port 80.</span></span>  
  
 <span data-ttu-id="ff53f-115">Model HTTP.SYS, w którym ruch dla wielu różnych aplikacji HTTP jest przybierany na jeden port TCP, stał się standardem na platformie systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="ff53f-115">The HTTP.SYS model in which traffic for many different HTTP applications is multiplexed onto a single TCP port has become standard on the Windows platform.</span></span> <span data-ttu-id="ff53f-116">Zapewnia to typowy punkt kontroli administratorów zapory, a jednocześnie pozwala deweloperom aplikacji zminimalizować koszty wdrożenia nowych aplikacji, które mogą korzystać z sieci.</span><span class="sxs-lookup"><span data-stu-id="ff53f-116">This provides a common point of control for firewall administrators while allowing application developers to minimize the deployment cost of building new applications that can make use of the network.</span></span>  
  
 <span data-ttu-id="ff53f-117">Możliwość udostępniania portów w wielu aplikacjach HTTP była funkcją Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="ff53f-117">The ability to share ports across multiple HTTP applications has long been a feature of Internet Information Services (IIS).</span></span> <span data-ttu-id="ff53f-118">Jednak było to tylko wprowadzenie HTTP.SYS (odbiornik protokołu HTTP trybu jądra) z usługami IIS 6,0, że ta infrastruktura była w pełni uogólniona.</span><span class="sxs-lookup"><span data-stu-id="ff53f-118">However, it was only with the introduction of HTTP.SYS (the kernel-mode HTTP protocol listener) with IIS 6.0 that this infrastructure was fully generalized.</span></span> <span data-ttu-id="ff53f-119">W efekcie HTTP.SYS zezwala dowolnym procesom użytkownika na współużytkowanie portów TCP dedykowanych dla ruchu HTTP.</span><span class="sxs-lookup"><span data-stu-id="ff53f-119">In effect, HTTP.SYS allows arbitrary user processes to share the TCP ports dedicated to HTTP traffic.</span></span> <span data-ttu-id="ff53f-120">Ta funkcja pozwala wielu aplikacjom HTTP współistnieć na tym samym komputerze fizycznym w oddzielnych, izolowanych procesach, udostępniając infrastrukturę sieci wymaganą do wysyłania i odbierania ruchu przez port TCP 80.</span><span class="sxs-lookup"><span data-stu-id="ff53f-120">This capability allows many HTTP applications to coexist on the same physical machine in separate, isolated processes while sharing the network infrastructure required to send and receive traffic over TCP port 80.</span></span> <span data-ttu-id="ff53f-121">Usługa udostępniania portów Net. TCP włącza ten sam typ udostępniania portów dla aplikacji net. TCP.</span><span class="sxs-lookup"><span data-stu-id="ff53f-121">The Net.TCP Port Sharing Service enables the same type of port sharing for net.tcp applications.</span></span>  
  
## <a name="port-sharing-architecture"></a><span data-ttu-id="ff53f-122">Architektura udostępniania portów</span><span class="sxs-lookup"><span data-stu-id="ff53f-122">Port Sharing Architecture</span></span>  

 <span data-ttu-id="ff53f-123">Architektura udostępniania portów w programie WCF ma trzy główne składniki:</span><span class="sxs-lookup"><span data-stu-id="ff53f-123">The Port Sharing architecture in WCF has three main components:</span></span>  
  
- <span data-ttu-id="ff53f-124">Proces roboczy: każdy proces komunikuje się za pośrednictwem net. TCP://przy użyciu portów udostępnionych.</span><span class="sxs-lookup"><span data-stu-id="ff53f-124">A Worker Process: Any process communicating over net.tcp:// using shared ports.</span></span>  
  
- <span data-ttu-id="ff53f-125">Transport TCP WCF: implementuje protokół net. TCP://Protocol.</span><span class="sxs-lookup"><span data-stu-id="ff53f-125">The WCF TCP transport: Implements the net.tcp:// protocol.</span></span>  
  
- <span data-ttu-id="ff53f-126">Usługa udostępniania portów Net. TCP: umożliwia wielu procesom roboczym współużytkowanie tego samego portu TCP.</span><span class="sxs-lookup"><span data-stu-id="ff53f-126">The Net.TCP Port Sharing Service: Allows many worker processes to share the same TCP port.</span></span>  
  
 <span data-ttu-id="ff53f-127">Usługa udostępniania portów Net. TCP to usługa systemu Windows w trybie użytkownika akceptująca net. TCP://Connections w imieniu procesów roboczych, które nawiązują połączenie.</span><span class="sxs-lookup"><span data-stu-id="ff53f-127">The Net.TCP Port Sharing Service is a user-mode Windows service that accepts net.tcp:// connections on behalf of the worker processes that connect through it.</span></span> <span data-ttu-id="ff53f-128">Po nadejściu połączenia gniazda usługa udostępniania portów sprawdza strumień komunikatów przychodzących, aby uzyskać swój adres docelowy.</span><span class="sxs-lookup"><span data-stu-id="ff53f-128">When a socket connection arrives, the port sharing service inspects the incoming message stream to obtain its destination address.</span></span> <span data-ttu-id="ff53f-129">Na podstawie tego adresu usługa udostępniania portów może kierować strumień danych do aplikacji, która ostatecznie ją przetwarza.</span><span class="sxs-lookup"><span data-stu-id="ff53f-129">Based on this address, the port sharing service can route the data stream to the application that ultimately processes it.</span></span>  
  
 <span data-ttu-id="ff53f-130">W przypadku otwarcia usługi WCF korzystającej z programu net. TCP://przydzielania portów Infrastruktura transportu TCP programu WCF nie otwiera bezpośrednio gniazda TCP w procesie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ff53f-130">When a WCF service that uses net.tcp:// port sharing opens, the WCF TCP transport infrastructure does not directly open a TCP socket in the application process.</span></span> <span data-ttu-id="ff53f-131">Zamiast tego infrastruktura transportowa rejestruje adres podstawowy usługi Uniform Resource Identifier (URI) za pomocą usługi udostępniania portów Net. TCP i czeka na nasłuchiwanie przez usługę udostępniania portów komunikatów w jej imieniu.</span><span class="sxs-lookup"><span data-stu-id="ff53f-131">Instead, the transport infrastructure registers the service’s base address Uniform Resource Identifier (URI) with the Net.TCP Port Sharing Service and waits for the port sharing service to listen for messages on its behalf.</span></span>  <span data-ttu-id="ff53f-132">Usługa udostępniania portów wysyła komunikaty do usługi aplikacji podczas ich odbierania.</span><span class="sxs-lookup"><span data-stu-id="ff53f-132">The port sharing service dispatches messages addressed to the application service as they arrive.</span></span>  
  
## <a name="installing-port-sharing"></a><span data-ttu-id="ff53f-133">Instalowanie udostępniania portów</span><span class="sxs-lookup"><span data-stu-id="ff53f-133">Installing Port Sharing</span></span>  

 <span data-ttu-id="ff53f-134">Usługa udostępniania portów Net. TCP jest dostępna we wszystkich systemach operacyjnych, które obsługują model WinFX, ale usługa nie jest domyślnie włączona.</span><span class="sxs-lookup"><span data-stu-id="ff53f-134">The Net.TCP Port Sharing Service is available on all operating systems that support WinFX, but the service is not enabled by default.</span></span> <span data-ttu-id="ff53f-135">Ze względów bezpieczeństwa administrator musi ręcznie włączyć usługę udostępniania portów Net. TCP przed pierwszym użyciem.</span><span class="sxs-lookup"><span data-stu-id="ff53f-135">As a security precaution, an administrator must manually enable the Net.TCP Port Sharing Service prior to first use.</span></span> <span data-ttu-id="ff53f-136">Usługa udostępniania portów Net. TCP udostępnia opcje konfiguracji, które umożliwiają manipulowanie wieloma charakterystykami gniazd sieciowych należących do usługi udostępniania portów.</span><span class="sxs-lookup"><span data-stu-id="ff53f-136">The Net.TCP Port Sharing Service exposes configuration options that allow you to manipulate several characteristics of the network sockets owned by the port sharing service.</span></span> <span data-ttu-id="ff53f-137">Aby uzyskać więcej informacji, zobacz [jak: Włączanie usługi udostępniania portów Net. TCP](how-to-enable-the-net-tcp-port-sharing-service.md).</span><span class="sxs-lookup"><span data-stu-id="ff53f-137">For more information, see [How to: Enable the Net.TCP Port Sharing Service](how-to-enable-the-net-tcp-port-sharing-service.md).</span></span>  
  
## <a name="using-nettcp-port-sharing-in-an-application"></a><span data-ttu-id="ff53f-138">Używanie udostępniania portów Net. TCP w aplikacji</span><span class="sxs-lookup"><span data-stu-id="ff53f-138">Using Net.tcp Port Sharing in an Application</span></span>  

 <span data-ttu-id="ff53f-139">Najprostszym sposobem korzystania z usługi net. TCP://udostępniania portów w aplikacji WCF jest udostępnienie usługi przy użyciu, <xref:System.ServiceModel.NetTcpBinding> a następnie umożliwienie usłudze udostępniania portów Net. TCP przy użyciu <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="ff53f-139">The easiest way to use net.tcp:// port sharing in your WCF application is to expose a service using the <xref:System.ServiceModel.NetTcpBinding> and then to enable Net.TCP Port Sharing Service using the <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> property.</span></span>  
  
 <span data-ttu-id="ff53f-140">Aby uzyskać więcej informacji o tym, jak to zrobić, zobacz [jak: Konfigurowanie usługi WCF do korzystania z udostępniania portów](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span><span class="sxs-lookup"><span data-stu-id="ff53f-140">For more information about how to do this, see [How to: Configure a WCF Service to Use Port Sharing](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span></span>  
  
## <a name="security-implications-of-port-sharing"></a><span data-ttu-id="ff53f-141">Implikacje zabezpieczeń dotyczące udostępniania portów</span><span class="sxs-lookup"><span data-stu-id="ff53f-141">Security Implications of Port Sharing</span></span>  

 <span data-ttu-id="ff53f-142">Mimo że usługa udostępniania portów Net. TCP zapewnia warstwę przetwarzania między aplikacjami i siecią, aplikacje korzystające z udostępniania portów powinny nadal być zabezpieczone tak, jakby były bezpośrednio nasłuchiwani w sieci.</span><span class="sxs-lookup"><span data-stu-id="ff53f-142">Although the Net.TCP Port Sharing Service provides a layer of processing between applications and the network, applications that use port sharing should still be secured as if they were directly listening on the network.</span></span> <span data-ttu-id="ff53f-143">W przypadku aplikacji korzystających z udostępniania portów należy oszacować uprawnienia procesu, w których są uruchamiane.</span><span class="sxs-lookup"><span data-stu-id="ff53f-143">Specifically, applications that use port sharing should evaluate the process privileges under which they run.</span></span> <span data-ttu-id="ff53f-144">Rozważ uruchomienie aplikacji przy użyciu wbudowanego konta usługi sieciowej, które działa z minimalnym zestawem uprawnień procesu wymaganych do komunikacji sieciowej.</span><span class="sxs-lookup"><span data-stu-id="ff53f-144">Consider running your application using the built-in Network Service account, which runs with the minimal set of process privileges required for network communication.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ff53f-145">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="ff53f-145">See also</span></span>

- [<span data-ttu-id="ff53f-146">Konfigurowanie usługi współużytkowania portów Net.TCP</span><span class="sxs-lookup"><span data-stu-id="ff53f-146">Configuring the Net.TCP Port Sharing Service</span></span>](configuring-the-net-tcp-port-sharing-service.md)
- [<span data-ttu-id="ff53f-147">Hosting</span><span class="sxs-lookup"><span data-stu-id="ff53f-147">Hosting</span></span>](hosting.md)
- [<span data-ttu-id="ff53f-148">Instrukcje: konfigurowanie usługi WCF na potrzeby współużytkowania portów</span><span class="sxs-lookup"><span data-stu-id="ff53f-148">How to: Configure a WCF Service to Use Port Sharing</span></span>](how-to-configure-a-wcf-service-to-use-port-sharing.md)
- [<span data-ttu-id="ff53f-149">Instrukcje: włączanie usługi współużytkowania portów Net.TCP</span><span class="sxs-lookup"><span data-stu-id="ff53f-149">How to: Enable the Net.TCP Port Sharing Service</span></span>](how-to-enable-the-net-tcp-port-sharing-service.md)
