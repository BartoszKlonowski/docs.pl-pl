---
title: Zasady ochrony rozszerzonej
ms.date: 03/30/2017
ms.assetid: e2616a10-317e-4c34-8023-0c015a80a82f
ms.openlocfilehash: 59a377a94978741f3f116bab819dff77d8b0fee4
ms.sourcegitcommit: 3c1c3ba79895335ff3737934e39372555ca7d6d0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/05/2018
ms.locfileid: "43785456"
---
# <a name="extended-protection-policy"></a><span data-ttu-id="a9d27-102">Zasady ochrony rozszerzonej</span><span class="sxs-lookup"><span data-stu-id="a9d27-102">Extended Protection Policy</span></span>
<span data-ttu-id="a9d27-103">Rozszerzona ochrona jest inicjatywy zabezpieczeń, ochrony przed atakami typu man-in--middle (MITM).</span><span class="sxs-lookup"><span data-stu-id="a9d27-103">Extended Protection is a security initiative for protecting against man-in-the-middle (MITM) attacks.</span></span> <span data-ttu-id="a9d27-104">Ataki MITM to zagrożenie bezpieczeństwa, w którym MITM przyjmuje poświadczeń klienta i przekazuje je do serwera.</span><span class="sxs-lookup"><span data-stu-id="a9d27-104">A MITM attack is a security threat in which a MITM takes a client’s credentials and forwards it to a server.</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="a9d27-105">Demonstracje</span><span class="sxs-lookup"><span data-stu-id="a9d27-105">Demonstrates</span></span>  
 <span data-ttu-id="a9d27-106">Ochrona rozszerzona</span><span class="sxs-lookup"><span data-stu-id="a9d27-106">Extended protection</span></span>  
  
## <a name="discussion"></a><span data-ttu-id="a9d27-107">Dyskusja</span><span class="sxs-lookup"><span data-stu-id="a9d27-107">Discussion</span></span>  
 <span data-ttu-id="a9d27-108">Aplikacje uwierzytelniania przy użyciu protokołu Kerberos, szyfrowane lub NTLM przy użyciu protokołu HTTPS, ustanawiania kanału zabezpieczeń TLS (Transport Level), a następnie uwierzytelnianie odbywa się przy użyciu bezpiecznego kanału.</span><span class="sxs-lookup"><span data-stu-id="a9d27-108">When applications authenticate using Kerberos, Digest or NTLM using HTTPS, a Transport Level Security (TLS) channel is first established and then authentication takes place using the secure channel.</span></span> <span data-ttu-id="a9d27-109">Jednakże nie istnieje żadne powiązanie między kluczem sesji, wygenerowane za pomocą protokołu SSL i klucza sesji generowane podczas uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="a9d27-109">However, there is no binding between the session key generated by SSL and the session key generated during authentication.</span></span> <span data-ttu-id="a9d27-110">Wszelkie MITM mogą nawiązać się między klientem a serwerem i Rozpocznij przekazywanie żądania od klienta, nawet wtedy, gdy sam kanał transportu jest bezpieczne, ponieważ serwer nie ma żadnej możliwość określenia, czy została ustanowiona bezpieczny kanał między klientem lub MITM.</span><span class="sxs-lookup"><span data-stu-id="a9d27-110">Any MITM can establish itself between the client and the server and start forwarding the requests from the client, even when the transport channel itself is secure, because the server has no way of knowing whether the secure channel has been established from the client or a MITM.</span></span> <span data-ttu-id="a9d27-111">Rozwiązania, w tym scenariuszu ma powiązania zewnętrzne kanał TLS z kanałem wewnętrznego uwierzytelniania w taki sposób, że serwer może wykryć, czy MITM.</span><span class="sxs-lookup"><span data-stu-id="a9d27-111">The solution in this scenario is to bind the outer TLS channel with the inner authentication channel such that the server can detect if there is a MITM.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a9d27-112">W tym przykładzie tylko działa w przypadku hostowania w usługach IIS i nie może działać na Cassini — serwera wdrożeniowego Visual Studio, ponieważ Cassini nie obsługuje protokołu HTTPS.</span><span class="sxs-lookup"><span data-stu-id="a9d27-112">This sample only works when hosted on IIS and cannot work on Cassini – Visual Studio Development Server because Cassini does not support HTTPS.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a9d27-113">Ta funkcja tylko jest obecnie dostępna w systemie Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a9d27-113">This feature is currently only available on Windows 7.</span></span> <span data-ttu-id="a9d27-114">Poniższe kroki są specyficzne dla Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a9d27-114">The following steps are specific to Windows 7.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="a9d27-115">Aby skonfigurować, tworzenie i uruchamianie aplikacji przykładowej</span><span class="sxs-lookup"><span data-stu-id="a9d27-115">To set up, build, and run the sample</span></span>  
  
1.  <span data-ttu-id="a9d27-116">Zainstalować Internetowe usługi informacyjne z **Panel sterowania**, **dodawania/usuwania programów**, **funkcji Windows**.</span><span class="sxs-lookup"><span data-stu-id="a9d27-116">Install Internet Information Services from **Control Panel**, **Add/Remove Programs**, **Windows Features**.</span></span>  
  
2.  <span data-ttu-id="a9d27-117">Zainstaluj **uwierzytelniania Windows** w **funkcji Windows**, **Internetowe usługi informacyjne**, **usługi World Wide Web**,  **Zabezpieczenia**, i **uwierzytelniania Windows**.</span><span class="sxs-lookup"><span data-stu-id="a9d27-117">Install **Windows Authentication** in **Windows Features**, **Internet Information Services**, **World Wide Web Services**, **Security**, and **Windows Authentication**.</span></span>  
  
3.  <span data-ttu-id="a9d27-118">Zainstaluj **Windows Communication Foundation HTTP aktywacji** w **funkcji Windows**, **Microsoft .NET Framework 3.5.1**, i **komunikacji Windows Aktywacja Foundation HTTP**.</span><span class="sxs-lookup"><span data-stu-id="a9d27-118">Install **Windows Communication Foundation HTTP Activation** in **Windows Features**, **Microsoft .NET Framework 3.5.1**, and **Windows Communication Foundation HTTP Activation**.</span></span>  
  
4.  <span data-ttu-id="a9d27-119">Ten przykładowy skrypt wymaga klienta do nawiązania bezpiecznego kanału z serwerem, dzięki czemu wymaga obecności certyfikatu serwera, które mogą być instalowane z Menedżera usług Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="a9d27-119">This sample requires the client to establish a secure channel with the server, so it requires the presence of a server certificate which can be installed from Internet Information Services (IIS) Manager.</span></span>  
  
    1.  <span data-ttu-id="a9d27-120">Otwórz Menedżera usług IIS.</span><span class="sxs-lookup"><span data-stu-id="a9d27-120">Open IIS Manager.</span></span> <span data-ttu-id="a9d27-121">Otwórz **certyfikaty serwera**, który pojawia się w **widok funkcji** karcie po wybraniu węzła głównego (nazwa komputera).</span><span class="sxs-lookup"><span data-stu-id="a9d27-121">Open **Server certificates**, which appears in the **Feature View** tab when the root node (machine name) is selected.</span></span>  
  
    2.  <span data-ttu-id="a9d27-122">Na potrzeby testowania w tym przykładzie, należy utworzyć certyfikat z podpisem własnym.</span><span class="sxs-lookup"><span data-stu-id="a9d27-122">For the purpose of testing this sample, create a self-signed certificate.</span></span> <span data-ttu-id="a9d27-123">Jeśli chcesz, aby program Internet Explorer będzie wyświetlany monit o certyfikat nie jest bezpieczne, należy zainstalować certyfikat w magazynie zaufanego certyfikatu głównego urzędu.</span><span class="sxs-lookup"><span data-stu-id="a9d27-123">If you do not want Internet Explorer to prompt you about the certificate not being secure, install the certificate in the Trusted Certificate Root authority store.</span></span>  
  
5.  <span data-ttu-id="a9d27-124">Otwórz **akcje** okienko dla domyślnej witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a9d27-124">Open the **Actions** pane for the default Web site.</span></span> <span data-ttu-id="a9d27-125">Kliknij przycisk **edytowanie witryny**, **powiązania**.</span><span class="sxs-lookup"><span data-stu-id="a9d27-125">Click **Edit Site**, **Bindings**.</span></span> <span data-ttu-id="a9d27-126">Dodawanie protokół HTTPS jako typu Jeśli nie są jeszcze zainstalowane, numer portu 443.</span><span class="sxs-lookup"><span data-stu-id="a9d27-126">Add HTTPS as a type if not already present, with port number 443.</span></span> <span data-ttu-id="a9d27-127">Przypisz certyfikat SSL utworzony w poprzednim kroku.</span><span class="sxs-lookup"><span data-stu-id="a9d27-127">Assign the SSL certificate created in the preceding step.</span></span>  
  
6.  <span data-ttu-id="a9d27-128">Tworzenie usługi.</span><span class="sxs-lookup"><span data-stu-id="a9d27-128">Build the service.</span></span> <span data-ttu-id="a9d27-129">Tworzy katalog wirtualny w usługach IIS i kopiuje pliki .dll i .svc .config zgodnie z wymaganiami dla usługa jest hostowana w sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a9d27-129">This creates a virtual directory in IIS, and copies the .dll, .svc and .config files as required for the service to be Web hosted.</span></span>  
  
7.  <span data-ttu-id="a9d27-130">Otwórz Menedżera usług IIS.</span><span class="sxs-lookup"><span data-stu-id="a9d27-130">Open IIS Manager.</span></span> <span data-ttu-id="a9d27-131">Kliknij prawym przyciskiem myszy katalog wirtualny (**ExtendedProtection**), która została utworzona w poprzednim kroku.</span><span class="sxs-lookup"><span data-stu-id="a9d27-131">Right-click the virtual directory (**ExtendedProtection**), which was created in the preceding step.</span></span> <span data-ttu-id="a9d27-132">Wybierz **Konwertuj na aplikację**.</span><span class="sxs-lookup"><span data-stu-id="a9d27-132">Select **Convert to Application**.</span></span>  
  
8.  <span data-ttu-id="a9d27-133">Otwórz **uwierzytelniania** modułu w Menedżerze usług IIS dla tego katalogu wirtualnego i Włącz **uwierzytelniania Windows**.</span><span class="sxs-lookup"><span data-stu-id="a9d27-133">Open the **Authentication** module in IIS Manager for this virtual directory and enable **Windows Authentication**.</span></span>  
  
9. <span data-ttu-id="a9d27-134">Otwórz **Zaawansowane ustawienia** w obszarze **uwierzytelniania Windows** dla tego katalogu wirtualnego i ustaw ją na **wymagane**.</span><span class="sxs-lookup"><span data-stu-id="a9d27-134">Open **Advanced Settings** under **Windows Authentication** for this virtual directory and set it to **Required**.</span></span>  
  
10. <span data-ttu-id="a9d27-135">Można testować usługę, uzyskując dostęp do adresu URL HTTPS w oknie przeglądarki (podaj w pełni kwalifikowaną nazwą domeny).</span><span class="sxs-lookup"><span data-stu-id="a9d27-135">You can test the service by accessing the HTTPS URL from a browser window (Provide a fully-qualified domain name).</span></span> <span data-ttu-id="a9d27-136">Jeśli chcesz, aby przejść do tego adresu URL z komputera zdalnego, upewnij się, że Zapora jest otwarta dla wszystkich połączeń przychodzących HTTP i HTTPS.</span><span class="sxs-lookup"><span data-stu-id="a9d27-136">If you want to access this URL from a remote machine, make sure that the firewall is opened for all incoming HTTP and HTTPS connections.</span></span>  
  
11. <span data-ttu-id="a9d27-137">Otwórz plik konfiguracji klienta i podaj w pełni kwalifikowanej nazwy domeny dla atrybutu adresów klienta lub punkt końcowy, który zastępuje `<<full_machine_name>>`.</span><span class="sxs-lookup"><span data-stu-id="a9d27-137">Open the client configuration file and provide a fully-qualified domain name for the client or endpoint address attribute that replaces `<<full_machine_name>>`.</span></span>  
  
12. <span data-ttu-id="a9d27-138">Uruchom klienta.</span><span class="sxs-lookup"><span data-stu-id="a9d27-138">Run the client.</span></span> <span data-ttu-id="a9d27-139">Klient komunikuje się z usługi, która ustanawia bezpiecznego kanału i używa ochrony rozszerzonej.</span><span class="sxs-lookup"><span data-stu-id="a9d27-139">The client communicates with the service, which establishes a secure channel and uses extended protection.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a9d27-140">Przykłady może już być zainstalowany na tym komputerze.</span><span class="sxs-lookup"><span data-stu-id="a9d27-140">The samples may already be installed on your machine.</span></span> <span data-ttu-id="a9d27-141">Przed kontynuowaniem sprawdź, czy są dostępne dla następującego katalogu (ustawienie domyślne).</span><span class="sxs-lookup"><span data-stu-id="a9d27-141">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="a9d27-142">Jeśli ten katalog nie istnieje, przejdź do strony [Windows Communication Foundation (WCF) i przykłady Windows Workflow Foundation (WF) dla platformy .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) do pobierania wszystkich Windows Communication Foundation (WCF) i [!INCLUDE[wf1](../../../../includes/wf1-md.md)] przykładów.</span><span class="sxs-lookup"><span data-stu-id="a9d27-142">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="a9d27-143">W tym przykładzie znajduje się w następującym katalogu.</span><span class="sxs-lookup"><span data-stu-id="a9d27-143">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Services\Security\ExtendedProtection`
