---
title: Implementacja dostawcy automatyzacji interfejsu użytkownika po stronie serwera
description: Dowiedz się, jak zaimplementować dostawcę automatyzacji interfejsu użytkownika po stronie serwera dla kontrolki niestandardowej w programie .NET. Implementacja dla WPF i elementów innych niż WPF jest inna.
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: ea1b5e668e29d854233d4dde4c0e6152d591da97
ms.sourcegitcommit: 3824ff187947572b274b9715b60c11269335c181
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/17/2020
ms.locfileid: "84903899"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="3cb6b-104">Implementacja dostawcy automatyzacji interfejsu użytkownika po stronie serwera</span><span class="sxs-lookup"><span data-stu-id="3cb6b-104">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="3cb6b-105">Ta dokumentacja jest przeznaczona dla .NET Framework deweloperów, którzy chcą korzystać z zarządzanych [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] klas zdefiniowanych w <xref:System.Windows.Automation> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="3cb6b-106">Aby uzyskać najnowsze informacje na temat [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , zobacz [interfejs API usługi Windows Automation: Automatyzacja interfejsu użytkownika](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="3cb6b-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="3cb6b-107">W tej sekcji opisano sposób implementacji dostawcy automatyzacji interfejsu użytkownika po stronie serwera dla kontrolki niestandardowej.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-107">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="3cb6b-108">Implementacja elementów Windows Presentation Foundation (WPF) i elementów innych niż WPF (takich jak te zaprojektowane dla Windows Forms) różni się zasadniczo.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-108">The implementation for Windows Presentation Foundation (WPF) elements and non-WPF elements (such as those designed for Windows Forms) is fundamentally different.</span></span> <span data-ttu-id="3cb6b-109">Elementy WPF zapewniają obsługę [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] za pośrednictwem klasy pochodnej <xref:System.Windows.Automation.Peers.AutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-109">WPF elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="3cb6b-110">Elementy inne niż WPF zapewniają obsługę za pomocą implementacji interfejsów dostawcy.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-110">Non-WPF elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="3cb6b-111">Zagadnienia związane z zabezpieczeniami</span><span class="sxs-lookup"><span data-stu-id="3cb6b-111">Security Considerations</span></span>

<span data-ttu-id="3cb6b-112">Należy napisać dostawców, aby mogły one działać w środowisku częściowego zaufania.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-112">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="3cb6b-113">Ponieważ UIAutomationClient.dll nie jest skonfigurowany do uruchamiania w ramach częściowej relacji zaufania, kod dostawcy nie powinien odwoływać się do tego zestawu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-113">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="3cb6b-114">W takim przypadku kod może działać w środowisku z pełnym zaufaniem, ale kończy się niepowodzeniem w środowisku częściowego zaufania.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-114">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="3cb6b-115">W szczególności nie należy używać pól z klas w UIAutomationClient.dll, takich jak te w <xref:System.Windows.Automation.AutomationElement> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-115">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="3cb6b-116">Zamiast tego należy użyć odpowiednich pól z klas w UIAutomationTypes.dll, takich jak <xref:System.Windows.Automation.AutomationElementIdentifiers> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-116">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="3cb6b-117">Implementacja dostawcy przez Windows Presentation Foundation elementy</span><span class="sxs-lookup"><span data-stu-id="3cb6b-117">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="3cb6b-118">Aby uzyskać więcej informacji na temat tego tematu, zobacz [Automatyzacja interfejsu użytkownika dla kontrolki NIESTANDARDOWEJ WPF](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span><span class="sxs-lookup"><span data-stu-id="3cb6b-118">For more information on this topic, please see [UI Automation of a WPF Custom Control](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="3cb6b-119">Implementacja dostawcy przez elementy inne niż WPF</span><span class="sxs-lookup"><span data-stu-id="3cb6b-119">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="3cb6b-120">Niestandardowe kontrolki, które nie są częścią platformy WPF Framework, ale są zapisywane w kodzie zarządzanym (najczęściej są to Windows Forms kontrolki), zapewniają obsługę [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] przez Implementowanie interfejsów.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-120">Custom controls that are not part of the WPF framework, but that are written in managed code (most often these are Windows Forms controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="3cb6b-121">Każdy element musi implementować co najmniej jeden interfejs wymieniony w pierwszej tabeli w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-121">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="3cb6b-122">Ponadto, jeśli element obsługuje jeden lub więcej wzorców kontrolek, musi zaimplementować odpowiedni interfejs dla każdego wzorca kontroli.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-122">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="3cb6b-123">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]Projekt dostawcy musi odwoływać się do następujących zestawów:</span><span class="sxs-lookup"><span data-stu-id="3cb6b-123">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="3cb6b-124">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="3cb6b-124">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="3cb6b-125">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="3cb6b-125">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="3cb6b-126">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="3cb6b-126">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="3cb6b-127">Interfejsy dostawcy</span><span class="sxs-lookup"><span data-stu-id="3cb6b-127">Provider Interfaces</span></span>

<span data-ttu-id="3cb6b-128">Każdy [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dostawca musi implementować jeden z następujących interfejsów.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-128">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="3cb6b-129">Interfejs</span><span class="sxs-lookup"><span data-stu-id="3cb6b-129">Interface</span></span>|<span data-ttu-id="3cb6b-130">Opis</span><span class="sxs-lookup"><span data-stu-id="3cb6b-130">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="3cb6b-131">Oferuje funkcje prostej kontrolki hostowanej w oknie, w tym obsługę wzorców i właściwości formantów.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-131">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="3cb6b-132">Dziedziczy z <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="3cb6b-133">Dodaje funkcje dla elementu w kontrolce złożonej, w tym nawigację w obrębie fragmentu, ustawienie fokusu i zwrócenie obwiedni elementu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-133">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="3cb6b-134">Dziedziczy z <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-134">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="3cb6b-135">Dodaje funkcje dla elementu głównego w kontrolce złożonej, w tym lokalizowanie elementu podrzędnego w określonych współrzędnych i Ustawianie stanu fokusu dla całej kontrolki.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-135">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="3cb6b-136">Poniższe interfejsy oferują dodane funkcje, ale nie są wymagane do wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-136">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="3cb6b-137">Interfejs</span><span class="sxs-lookup"><span data-stu-id="3cb6b-137">Interface</span></span>|<span data-ttu-id="3cb6b-138">Opis</span><span class="sxs-lookup"><span data-stu-id="3cb6b-138">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="3cb6b-139">Umożliwia dostawcy śledzenie żądań zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-139">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="3cb6b-140">Umożliwia zmianę położenia elementów opartych na oknach w [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] drzewie fragmentu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-140">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="3cb6b-141">Wszystkie inne interfejsy w <xref:System.Windows.Automation.Provider> przestrzeni nazw są przeznaczone do obsługi wzorców kontrolek.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-141">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="3cb6b-142">Wymagania dla dostawców nienależących do platformy WPF</span><span class="sxs-lookup"><span data-stu-id="3cb6b-142">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="3cb6b-143">W celu komunikowania się z programem [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] Kontrola musi implementować następujące główne obszary funkcjonalności:</span><span class="sxs-lookup"><span data-stu-id="3cb6b-143">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="3cb6b-144">Funkcjonalność</span><span class="sxs-lookup"><span data-stu-id="3cb6b-144">Functionality</span></span>|<span data-ttu-id="3cb6b-145">Implementacja</span><span class="sxs-lookup"><span data-stu-id="3cb6b-145">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="3cb6b-146">Uwidacznianie dostawcy[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3cb6b-146">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="3cb6b-147">W odpowiedzi na WM_GETOBJECT komunikat wysyłany do okna sterowania zwracają obiekt implementujący <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (lub interfejs pochodny).</span><span class="sxs-lookup"><span data-stu-id="3cb6b-147">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="3cb6b-148">Dla fragmentów, musi to być dostawca dla katalogu głównego fragmentów.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-148">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="3cb6b-149">Podaj wartości właściwości</span><span class="sxs-lookup"><span data-stu-id="3cb6b-149">Provide property values</span></span>|<span data-ttu-id="3cb6b-150">Zaimplementuj <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> , aby podać lub zastąpić wartości.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-150">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="3cb6b-151">Zezwalaj klientowi na współpracującie z kontrolką</span><span class="sxs-lookup"><span data-stu-id="3cb6b-151">Enable the client to interact with the control</span></span>|<span data-ttu-id="3cb6b-152">Implementuj interfejsy obsługujące wzorce kontroli, takie jak <xref:System.Windows.Automation.Provider.IInvokeProvider> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-152">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="3cb6b-153">Zwróć tych dostawców wzorców w implementacji programu <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-153">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="3cb6b-154">Zgłoś zdarzenia</span><span class="sxs-lookup"><span data-stu-id="3cb6b-154">Raise events</span></span>|<span data-ttu-id="3cb6b-155">Wywołaj jedną z metod statycznych, <xref:System.Windows.Automation.Provider.AutomationInteropProvider> Aby zgłosić zdarzenie, dla którego klient może nasłuchiwać.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-155">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="3cb6b-156">Włączanie nawigacji i skoncentrowanie się na fragmentach</span><span class="sxs-lookup"><span data-stu-id="3cb6b-156">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="3cb6b-157">Zaimplementuj <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> dla każdego elementu w fragmencie.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-157">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="3cb6b-158">(Niepotrzebne dla elementów, które nie są częścią fragmentu).</span><span class="sxs-lookup"><span data-stu-id="3cb6b-158">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="3cb6b-159">Włącz skoncentrowanie i lokalizację elementu podrzędnego w fragmencie</span><span class="sxs-lookup"><span data-stu-id="3cb6b-159">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="3cb6b-160">Implementacja <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-160">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="3cb6b-161">(Niepotrzebne dla elementów, które nie mają fragmentów głównych).</span><span class="sxs-lookup"><span data-stu-id="3cb6b-161">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="3cb6b-162">Wartości właściwości w dostawcach spoza WPF</span><span class="sxs-lookup"><span data-stu-id="3cb6b-162">Property Values in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3cb6b-163">dostawcy formantów niestandardowych muszą obsługiwać pewne właściwości, które mogą być używane przez system automatyzacji, a także przez aplikacje klienckie.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-163">providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="3cb6b-164">W przypadku elementów, które są hostowane w systemie Windows (HWND), program [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] może pobrać niektóre właściwości z domyślnego dostawcy okien, ale muszą uzyskać innych od dostawcy niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-164">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="3cb6b-165">Dostawcy formantów opartych na HWND nie muszą zazwyczaj podawać następujących właściwości (identyfikowanych przez wartości pól):</span><span class="sxs-lookup"><span data-stu-id="3cb6b-165">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="3cb6b-166">W oknie <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> uzyskano prosty element lub fragment, który znajduje się w oknie, ale elementy fragmentów znajdujące się poniżej elementu głównego (takie jak elementy listy w polu listy) muszą podawać własne identyfikatory.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="3cb6b-167">Aby uzyskać więcej informacji, zobacz <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-167">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="3cb6b-168"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>Powinna zostać zwrócona dla dostawców hostowanych w kontrolce Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="3cb6b-169">W takim przypadku domyślny dostawca okna może nie być w stanie pobrać poprawnej wartości.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-169">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="3cb6b-170"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>Jest zazwyczaj dostarczany przez dostawcę hosta.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-170">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="3cb6b-171">Na przykład, Jeśli kontrolka niestandardowa pochodzi od <xref:System.Windows.Forms.Control> , nazwa pochodzi od `Text` właściwości formantu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-171">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="3cb6b-172">Na przykład kod, zobacz [zwracają właściwości z dostawcy automatyzacji interfejsu użytkownika](return-properties-from-a-ui-automation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3cb6b-172">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="3cb6b-173">Zdarzenia w dostawcach innych niż WPF</span><span class="sxs-lookup"><span data-stu-id="3cb6b-173">Events in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3cb6b-174">dostawcy powinni zgłaszać zdarzenia w celu powiadomienia aplikacji klienckich o zmianach w stanie interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-174">providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="3cb6b-175">Następujące metody są używane do wywoływania zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-175">The following methods are used to raise events.</span></span>

|<span data-ttu-id="3cb6b-176">Metoda</span><span class="sxs-lookup"><span data-stu-id="3cb6b-176">Method</span></span>|<span data-ttu-id="3cb6b-177">Opis</span><span class="sxs-lookup"><span data-stu-id="3cb6b-177">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="3cb6b-178">Wywołuje różne zdarzenia, w tym zdarzenia wyzwalane przez wzorce kontrolek.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-178">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="3cb6b-179">Podnosi zdarzenie po [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] zmianie właściwości.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-179">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="3cb6b-180">Podnosi zdarzenie po [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] zmianie struktury drzewa, na przykład przez usunięcie lub dodanie elementu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-180">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="3cb6b-181">Celem zdarzenia jest powiadomienie klienta o jakimś miejscu [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] , niezależnie od tego, czy działanie jest wyzwalane przez [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] sam system.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-181">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="3cb6b-182">Na przykład zdarzenie identyfikowane przez <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> powinna być wywoływane za każdym razem, gdy kontrolka jest wywoływana, przez bezpośrednie dane wejściowe użytkownika lub przez wywołanie aplikacji klienckiej <xref:System.Windows.Automation.InvokePattern.Invoke%2A> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-182">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="3cb6b-183">Aby zoptymalizować wydajność, dostawca może wybiórczo zgłaszać zdarzenia lub nie zgłaszać żadnych zdarzeń, jeśli żadna aplikacja kliencka nie zostanie zarejestrowana.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-183">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="3cb6b-184">Następujące metody są używane do optymalizacji.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-184">The following methods are used for optimization.</span></span>

|<span data-ttu-id="3cb6b-185">Metoda</span><span class="sxs-lookup"><span data-stu-id="3cb6b-185">Method</span></span>|<span data-ttu-id="3cb6b-186">Opis</span><span class="sxs-lookup"><span data-stu-id="3cb6b-186">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="3cb6b-187">Ta właściwość statyczna określa, czy wszystkie aplikacje klienckie subskrybują [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-187">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="3cb6b-188">Implementacja tego interfejsu w ramach dostawcy w katalogu głównym fragmentów umożliwia jego doradzanie, gdy klienci rejestrują i wyrejestrowujeją programy obsługi zdarzeń dla zdarzeń w fragmencie.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-188">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="3cb6b-189">Nawigacja dostawcy spoza WPF</span><span class="sxs-lookup"><span data-stu-id="3cb6b-189">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="3cb6b-190">Dostawcy formantów prostych, takich jak niestandardowy przycisk hostowany w oknie (HWND), nie muszą obsługiwać nawigowania w obrębie [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] drzewa.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-190">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="3cb6b-191">Nawigacja do i z elementu jest obsługiwana przez domyślnego dostawcę okna hosta, który jest określony w implementacji <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-191">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="3cb6b-192">W przypadku zaimplementowania dostawcy dla złożonej kontrolki niestandardowej, należy jednak obsługiwać nawigację między węzłem głównym fragmentu i jego elementami podrzędnymi oraz między węzłami elementów równorzędnych.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-192">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="3cb6b-193">Elementy fragmentu innego niż główny muszą zwracać `null` odwołanie z <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> , ponieważ nie są bezpośrednio hostowane w oknie, a żaden dostawca domyślny nie może obsługiwać nawigowania do i z nich.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-193">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="3cb6b-194">Struktura fragmentu jest określana przez implementację programu <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-194">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="3cb6b-195">Dla każdego możliwego kierunku z każdego fragmentu ta metoda zwraca obiekt dostawcy dla elementu w tym kierunku.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-195">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="3cb6b-196">Jeśli w tym kierunku nie ma elementu, metoda zwraca `null` odwołanie.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-196">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="3cb6b-197">Element główny fragmentu obsługuje nawigację tylko do elementów podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-197">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="3cb6b-198">Na przykład pole listy zwraca pierwszy element na liście, gdy kierunek jest <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild> i ostatni element, gdy kierunek jest <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild> .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-198">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="3cb6b-199">Element główny fragmentu nie obsługuje nawigacji do elementów nadrzędnych ani równorzędnych; jest to obsługiwane przez dostawcę okna hosta.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-199">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="3cb6b-200">Elementy fragmentu, który nie jest elementem głównym, muszą obsługiwać nawigację do elementu nadrzędnego oraz do wszelkich elementów równorzędnych i ich elementów podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-200">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="3cb6b-201">Obiekt nadrzędny dostawcy spoza platformy WPF</span><span class="sxs-lookup"><span data-stu-id="3cb6b-201">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="3cb6b-202">Okna podręczne są w rzeczywistości oknami najwyższego poziomu, a więc domyślnie są wyświetlane w [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] drzewie jako elementy podrzędne pulpitu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-202">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="3cb6b-203">W wielu przypadkach okna podręczne są jednak logicznie elementami podrzędnymi innej kontrolki.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-203">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="3cb6b-204">Na przykład lista rozwijana pola kombi jest logicznie elementem podrzędnym pola kombi.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-204">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="3cb6b-205">Analogicznie, okno podręczne menu jest logicznie elementem podrzędnym menu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-205">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3cb6b-206">zapewnia pomoc techniczną do ponownego nadrzędnego wyskakujących okienek, aby były one elementami podrzędnymi powiązanej kontrolki.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-206">provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="3cb6b-207">Aby zmienić nadrzędny okna podręcznego:</span><span class="sxs-lookup"><span data-stu-id="3cb6b-207">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="3cb6b-208">Utwórz dostawcę dla okna podręcznego.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-208">Create a provider for the pop-up window.</span></span> <span data-ttu-id="3cb6b-209">Wymaga to, aby Klasa okna podręcznego była znana z góry.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-209">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="3cb6b-210">Zaimplementuj wszystkie właściwości i wzorce w zwykły sposób dla tego okna podręcznego, tak jakby były one kontrolką we własnym zakresie.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-210">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="3cb6b-211">Zaimplementuj <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> Właściwość, aby zwracała wartość uzyskaną z <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A> , gdzie parametr jest dojściem okna podręcznego.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-211">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="3cb6b-212">Zaimplementuj <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> dla okna podręcznego i jego elementu nadrzędnego, aby Nawigacja była prawidłowo obsługiwana z logicznego elementu nadrzędnego do logicznych elementów podrzędnych i między równorzędnymi elementami podrzędnymi.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-212">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="3cb6b-213">Gdy [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] pojawia się okno podręczne, rozpoznaje, że nawigacja jest zastępowana domyślnie, i pomija okna podręcznego, gdy zostanie on wyświetlony jako element podrzędny pulpitu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-213">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="3cb6b-214">Zamiast tego węzeł będzie dostępny tylko za pomocą fragmentu.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-214">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="3cb6b-215">Obiekt nadrzędny nie jest odpowiedni dla przypadków, gdy kontrolka może obsługiwać okno dowolnej klasy.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-215">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="3cb6b-216">Na przykład paska pomocniczego może hostować dowolny typ HWND w swoich pasmach.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-216">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="3cb6b-217">Aby obsłużyć te przypadki, program [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] obsługuje alternatywną formę relokacji elementu HWND, jak opisano w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-217">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="3cb6b-218">Zmiana położenia dostawcy spoza WPF</span><span class="sxs-lookup"><span data-stu-id="3cb6b-218">Non-WPF Provider Repositioning</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3cb6b-219">fragmenty mogą zawierać co najmniej dwa elementy, które są zawarte w oknie (HWND).</span><span class="sxs-lookup"><span data-stu-id="3cb6b-219">fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="3cb6b-220">Ponieważ każdy HWND ma własnego domyślnego dostawcę, który uważa, że właściwość HWND ma być elementem podrzędnym zawierającej HWND, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] drzewo domyślnie pokaże HWND w fragmencie jako elementy podrzędne okna nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-220">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="3cb6b-221">W większości przypadków jest to pożądane zachowanie, ale czasami może prowadzić do pomyłki, ponieważ nie pasuje do struktury logicznej [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3cb6b-221">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="3cb6b-222">Dobrym przykładem jest formant paska pomocniczego.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-222">A good example of this is a rebar control.</span></span> <span data-ttu-id="3cb6b-223">Paska pomocniczego zawiera pasma, z których każdy może z kolei zawierać kontrolkę opartą na elemencie HWND, taką jak pasek narzędzi, pole edycji lub pole kombi.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-223">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="3cb6b-224">Domyślny dostawca okna dla paska pomocniczego HWND widzi kontrolki przedziału jako elementy podrzędne, a dostawca paska pomocniczego widzi paski jako elementy podrzędne.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-224">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="3cb6b-225">Ze względu na to, że dostawca HWND i dostawca paska pomocniczego działają wspólnie i łącząc ich elementy podrzędne, zarówno te, jak i kontrolki oparte na elemencie HWND, są wyświetlane jako elementy podrzędne paska pomocniczego.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-225">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="3cb6b-226">Logicznie jednak tylko paski powinny być wyświetlane jako elementy podrzędne paska pomocniczego, a każdy dostawca pasm powinien być połączony z domyślnym dostawcą HWND dla kontrolki, która zawiera.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-226">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="3cb6b-227">Aby to osiągnąć, główny dostawca fragmentów dla paska pomocniczego uwidacznia zestaw elementów podrzędnych reprezentujących pasma.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-227">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="3cb6b-228">Każda grupa ma jednego dostawcę, który może uwidaczniać właściwości i wzorce.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-228">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="3cb6b-229">W jego implementacji <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> dostawca pasma zwraca domyślnego dostawcę okna dla elementu HWND formantu, który uzyskuje przez wywołanie <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A> , przekazanie do uchwytu okna kontrolki.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-229">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="3cb6b-230">Na koniec główny dostawca fragmentów paska pomocniczego implementuje <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interfejs, a w jego implementacji <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> zwraca odpowiedniego dostawcę pasma dla kontrolki zawartej w określonym elemencie HWND.</span><span class="sxs-lookup"><span data-stu-id="3cb6b-230">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="3cb6b-231">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="3cb6b-231">See also</span></span>

- [<span data-ttu-id="3cb6b-232">Przegląd dostawców automatyzacji interfejsu użytkownika</span><span class="sxs-lookup"><span data-stu-id="3cb6b-232">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="3cb6b-233">Udostępnianie dostawcy automatyzacji interfejsu użytkownika po stronie serwera</span><span class="sxs-lookup"><span data-stu-id="3cb6b-233">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="3cb6b-234">Zwracanie właściwości od dostawcy automatyzacji interfejsu użytkownika</span><span class="sxs-lookup"><span data-stu-id="3cb6b-234">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="3cb6b-235">Wywoływanie zdarzeń od dostawcy automatyzacji interfejsu użytkownika</span><span class="sxs-lookup"><span data-stu-id="3cb6b-235">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="3cb6b-236">Włączanie nawigacji w dostawcy fragmentu automatyzacji interfejsu użytkownika</span><span class="sxs-lookup"><span data-stu-id="3cb6b-236">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="3cb6b-237">Obsługa wzorców formantów dostawcy automatyzacji interfejsu użytkownika</span><span class="sxs-lookup"><span data-stu-id="3cb6b-237">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
