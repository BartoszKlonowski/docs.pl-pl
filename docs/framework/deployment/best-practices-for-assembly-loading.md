---
title: Najlepsze praktyki dotyczące ładowania zestawu
ms.date: 03/30/2017
helpviewer_keywords:
- assemblies,binding
- LoadFrom method
- default load context
- TypeLoadException class,causes
- assembly loading errors
- load contexts
- assemblies,loading
- LoadWithPartialName method
- load-from context
ms.assetid: 68d1c539-6a47-4614-ab59-4b071c9d4b4c
author: mairaw
ms.author: mairaw
ms.openlocfilehash: b05ec604f8493ba773d9de9af19acc70c023b8bf
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
ms.locfileid: "33394156"
---
# <a name="best-practices-for-assembly-loading"></a><span data-ttu-id="ec8f2-102">Najlepsze praktyki dotyczące ładowania zestawu</span><span class="sxs-lookup"><span data-stu-id="ec8f2-102">Best Practices for Assembly Loading</span></span>
<span data-ttu-id="ec8f2-103">W tym artykule opisano sposób, aby uniknąć problemów tożsamości typu, który może prowadzić do <xref:System.InvalidCastException>, <xref:System.MissingMethodException>oraz innych błędów.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-103">This article discusses ways to avoid problems of type identity that can lead to <xref:System.InvalidCastException>, <xref:System.MissingMethodException>, and other errors.</span></span> <span data-ttu-id="ec8f2-104">W tym artykule omówiono następujące zalecenia:</span><span class="sxs-lookup"><span data-stu-id="ec8f2-104">The article discusses the following recommendations:</span></span>  
  
-   [<span data-ttu-id="ec8f2-105">Zrozumieć zalety i wady konteksty ładowania</span><span class="sxs-lookup"><span data-stu-id="ec8f2-105">Understand the advantages and disadvantages of load contexts</span></span>](#load_contexts)  
  
-   [<span data-ttu-id="ec8f2-106">Unikaj powiązanie nazwy zestawu z częściowa</span><span class="sxs-lookup"><span data-stu-id="ec8f2-106">Avoid binding on partial assembly names</span></span>](#avoid_partial_names)  
  
-   [<span data-ttu-id="ec8f2-107">Unikaj ładowania zestawu do wielu kontekstów</span><span class="sxs-lookup"><span data-stu-id="ec8f2-107">Avoid loading an assembly into multiple contexts</span></span>](#avoid_loading_into_multiple_contexts)  
  
-   [<span data-ttu-id="ec8f2-108">Unikaj ładowania wielu wersji zestawu do tego samego kontekstu</span><span class="sxs-lookup"><span data-stu-id="ec8f2-108">Avoid loading multiple versions of an assembly into the same context</span></span>](#avoid_loading_multiple_versions)  
  
-   [<span data-ttu-id="ec8f2-109">Rozważ przejście na domyślnym kontekście ładowania</span><span class="sxs-lookup"><span data-stu-id="ec8f2-109">Consider switching to the default load context</span></span>](#switch_to_default)  
  
 <span data-ttu-id="ec8f2-110">Pierwszy zalecenie [zrozumieć zalety i wady kontekstów obciążenia](#load_contexts), przedstawiono ogólne informacje dla innych zaleceń, ponieważ wszystkie one są zależne od wiedzy kontekstów obciążenia.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-110">The first recommendation, [understand the advantages and disadvantages of load contexts](#load_contexts), provides background information for the other recommendations, because they all depend on a knowledge of load contexts.</span></span>  
  
<a name="load_contexts"></a>   
## <a name="understand-the-advantages-and-disadvantages-of-load-contexts"></a><span data-ttu-id="ec8f2-111">Zrozumieć zalety i wady konteksty ładowania</span><span class="sxs-lookup"><span data-stu-id="ec8f2-111">Understand the Advantages and Disadvantages of Load Contexts</span></span>  
 <span data-ttu-id="ec8f2-112">W domenie aplikacji zestawy może być załadowany do jednego z trzech kontekstów lub może być załadowany bez kontekstu:</span><span class="sxs-lookup"><span data-stu-id="ec8f2-112">Within an application domain, assemblies can be loaded into one of three contexts, or they can be loaded without context:</span></span>  
  
-   <span data-ttu-id="ec8f2-113">Domyślnym kontekście ładowania zawiera zestawy znalezione przez sondowanie globalnej pamięci podręcznej zestawów, magazynie zestawów hosta, jeśli środowisko uruchomieniowe jest hostowana (na przykład w programie SQL Server) i <xref:System.AppDomainSetup.ApplicationBase%2A> i <xref:System.AppDomainSetup.PrivateBinPath%2A> domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-113">The default load context contains assemblies found by probing the global assembly cache, the host assembly store if the runtime is hosted (for example, in SQL Server), and the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> of the application domain.</span></span> <span data-ttu-id="ec8f2-114">Większość przeciążeń <xref:System.Reflection.Assembly.Load%2A> metody Ładuj zestawy w tym kontekście.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-114">Most overloads of the <xref:System.Reflection.Assembly.Load%2A> method load assemblies into this context.</span></span>  
  
-   <span data-ttu-id="ec8f2-115">Kontekst load-from zawiera zestawy, które są ładowane z lokalizacji, które nie są przeszukiwane przez moduł ładujący.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-115">The load-from context contains assemblies that are loaded from locations that are not searched by the loader.</span></span> <span data-ttu-id="ec8f2-116">Na przykład dodatków mogą być zainstalowane w katalogu, który nie znajduje się w ścieżce aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-116">For example, add-ins might be installed in a directory that is not under the application path.</span></span> <span data-ttu-id="ec8f2-117"><xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>, <xref:System.AppDomain.CreateInstanceFrom%2A?displayProperty=nameWithType>, i <xref:System.AppDomain.ExecuteAssembly%2A?displayProperty=nameWithType> przedstawiono metody, które są ładowane przez ścieżkę.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-117"><xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>, <xref:System.AppDomain.CreateInstanceFrom%2A?displayProperty=nameWithType>, and <xref:System.AppDomain.ExecuteAssembly%2A?displayProperty=nameWithType> are examples of methods that load by path.</span></span>  
  
-   <span data-ttu-id="ec8f2-118">Kontekstu reflection-only zawiera zestawy ładowane z <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A> i <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-118">The reflection-only context contains assemblies loaded with the <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A> and <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A> methods.</span></span> <span data-ttu-id="ec8f2-119">Kod w tym kontekście nie można wykonać, nie została omówiona w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-119">Code in this context cannot be executed, so it is not discussed here.</span></span> <span data-ttu-id="ec8f2-120">Aby uzyskać więcej informacji, zobacz [porady: zestawy obciążenia w kontekście Reflection-Only](../../../docs/framework/reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md).</span><span class="sxs-lookup"><span data-stu-id="ec8f2-120">For more information, see [How to: Load Assemblies into the Reflection-Only Context](../../../docs/framework/reflection-and-codedom/how-to-load-assemblies-into-the-reflection-only-context.md).</span></span>  
  
-   <span data-ttu-id="ec8f2-121">Jeśli zestawu przejściowego dynamicznej jest generowany przy użyciu odbicia emisji, zestaw nie znajduje się w dowolnym kontekście.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-121">If you generated a transient dynamic assembly by using reflection emit, the assembly is not in any context.</span></span> <span data-ttu-id="ec8f2-122">Ponadto większość zestawów, które są ładowane przy użyciu <xref:System.Reflection.Assembly.LoadFile%2A> metody zostały załadowane bez kontekstu i zestawy, które są ładowane z tablic bajtowych zostały załadowane bez kontekstu, chyba że ich tożsamość (po zastosowaniu zasad) ustanawia muszą znajdować się w Globalna pamięć podręczna zestawów.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-122">In addition, most assemblies that are loaded by using the <xref:System.Reflection.Assembly.LoadFile%2A> method are loaded without context, and assemblies that are loaded from byte arrays are loaded without context unless their identity (after policy is applied) establishes that they are in the global assembly cache.</span></span>  
  
 <span data-ttu-id="ec8f2-123">Kontekst wykonywania ma zalety i wady, zgodnie z opisem w poniższych sekcjach.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-123">The execution contexts have advantages and disadvantages, as discussed in the following sections.</span></span>  
  
### <a name="default-load-context"></a><span data-ttu-id="ec8f2-124">Domyślnym kontekście ładowania</span><span class="sxs-lookup"><span data-stu-id="ec8f2-124">Default Load Context</span></span>  
 <span data-ttu-id="ec8f2-125">Gdy zestawy są ładowane w domyślnym kontekście ładowania, ich zależności są ładowane automatycznie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-125">When assemblies are loaded into the default load context, their dependencies are loaded automatically.</span></span> <span data-ttu-id="ec8f2-126">Zależności, które są ładowane w domyślnym kontekście ładowania znajdują się automatycznie dla zestawów w domyślnym kontekście ładowania lub kontekst load-from.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-126">Dependencies that are loaded into the default load context are found automatically for assemblies in the default load context or the load-from context.</span></span> <span data-ttu-id="ec8f2-127">Ładowanie przez tożsamość w zestawie zwiększenie stabilności aplikacji przez zapewnienie im nieznany wersje zestawów nie są używane (zobacz [uniknąć wiązanie częściowe nazwy zestawu](#avoid_partial_names) sekcji).</span><span class="sxs-lookup"><span data-stu-id="ec8f2-127">Loading by assembly identity increases the stability of applications by ensuring that unknown versions of assemblies are not used (see the [Avoid Binding on Partial Assembly Names](#avoid_partial_names) section).</span></span>  
  
 <span data-ttu-id="ec8f2-128">Przy użyciu domyślnym kontekście ładowania ma następujące wady:</span><span class="sxs-lookup"><span data-stu-id="ec8f2-128">Using the default load context has the following disadvantages:</span></span>  
  
-   <span data-ttu-id="ec8f2-129">Zależności, które są ładowane do innych kontekstach nie są dostępne.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-129">Dependencies that are loaded into other contexts are not available.</span></span>  
  
-   <span data-ttu-id="ec8f2-130">Nie można załadować zestawów z lokalizacji poza ścieżki próbkowania w domyślnym kontekście ładowania.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-130">You cannot load assemblies from locations outside the probing path into the default load context.</span></span>  
  
### <a name="load-from-context"></a><span data-ttu-id="ec8f2-131">Kontekst Load-From</span><span class="sxs-lookup"><span data-stu-id="ec8f2-131">Load-From Context</span></span>  
 <span data-ttu-id="ec8f2-132">Kontekst load-from umożliwia załadowania zestawu z ścieżki, która nie znajduje się w ścieżce aplikacji, a zatem nie są objęte sondowanie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-132">The load-from context lets you load an assembly from a path that is not under the application path, and therefore is not included in probing.</span></span> <span data-ttu-id="ec8f2-133">Umożliwia ona zależności zlokalizowanie i załadować z tej ścieżki, ponieważ informacje o ścieżce są obsługiwane przez kontekst.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-133">It enables dependencies to be located and loaded from that path, because the path information is maintained by the context.</span></span> <span data-ttu-id="ec8f2-134">Ponadto zestawy, w tym kontekście użyć zależności, które są ładowane w domyślnym kontekście ładowania.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-134">In addition, assemblies in this context can use dependencies that are loaded into the default load context.</span></span>  
  
 <span data-ttu-id="ec8f2-135">Ładowanie zestawów przy użyciu <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> metody lub jednej z metod, które są ładowane przez ścieżkę, ma następujące wady:</span><span class="sxs-lookup"><span data-stu-id="ec8f2-135">Loading assemblies by using the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method, or one of the other methods that load by path, has the following disadvantages:</span></span>  
  
-   <span data-ttu-id="ec8f2-136">Jeśli zestaw o tej samej tożsamości jest już załadowany, <xref:System.Reflection.Assembly.LoadFrom%2A> zwraca załadowany zestaw nawet wtedy, gdy określono inną ścieżkę.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-136">If an assembly with the same identity is already loaded, <xref:System.Reflection.Assembly.LoadFrom%2A> returns the loaded assembly even if a different path was specified.</span></span>  
  
-   <span data-ttu-id="ec8f2-137">Jeśli zestaw jest ładowany z <xref:System.Reflection.Assembly.LoadFrom%2A>i później próbuje załadować samego zestawu według nazwy wyświetlanej zestawu w domyślnym kontekście ładowania, próba załadowania kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-137">If an assembly is loaded with <xref:System.Reflection.Assembly.LoadFrom%2A>, and later an assembly in the default load context tries to load the same assembly by display name, the load attempt fails.</span></span> <span data-ttu-id="ec8f2-138">Taka sytuacja może wystąpić, gdy zestaw jest deserializacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-138">This can occur when an assembly is deserialized.</span></span>  
  
-   <span data-ttu-id="ec8f2-139">Jeśli zestaw jest ładowany z <xref:System.Reflection.Assembly.LoadFrom%2A>, i ścieżki próbkowania zawiera zestaw o tej samej tożsamości, ale w innej lokalizacji, <xref:System.InvalidCastException>, <xref:System.MissingMethodException>, lub mogą występować inne nieoczekiwane zachowania.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-139">If an assembly is loaded with <xref:System.Reflection.Assembly.LoadFrom%2A>, and the probing path includes an assembly with the same identity but in a different location, an <xref:System.InvalidCastException>, <xref:System.MissingMethodException>, or other unexpected behavior can occur.</span></span>  
  
-   <span data-ttu-id="ec8f2-140"><xref:System.Reflection.Assembly.LoadFrom%2A> wymagania <xref:System.Security.Permissions.FileIOPermissionAccess.Read?displayProperty=nameWithType> i <xref:System.Security.Permissions.FileIOPermissionAccess.PathDiscovery?displayProperty=nameWithType>, lub <xref:System.Net.WebPermission>, w określonej ścieżce.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-140"><xref:System.Reflection.Assembly.LoadFrom%2A> demands <xref:System.Security.Permissions.FileIOPermissionAccess.Read?displayProperty=nameWithType> and <xref:System.Security.Permissions.FileIOPermissionAccess.PathDiscovery?displayProperty=nameWithType>, or <xref:System.Net.WebPermission>, on the specified path.</span></span>  
  
-   <span data-ttu-id="ec8f2-141">Jeśli zestaw obrazu macierzystego, nie jest używane.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-141">If a native image exists for the assembly, it is not used.</span></span>  
  
-   <span data-ttu-id="ec8f2-142">Nie można załadować zestawu jako neutralne dla domen.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-142">The assembly cannot be loaded as domain-neutral.</span></span>  
  
-   <span data-ttu-id="ec8f2-143">W wersji systemu .NET Framework 1.0 i 1.1 nie są stosowane zasady.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-143">In the .NET Framework versions 1.0 and 1.1, policy is not applied.</span></span>  
  
### <a name="no-context"></a><span data-ttu-id="ec8f2-144">Brak kontekstu</span><span class="sxs-lookup"><span data-stu-id="ec8f2-144">No Context</span></span>  
 <span data-ttu-id="ec8f2-145">Ładowanie bez kontekstu jest jedyną opcją dla przejściowej zestawy, które są generowane z odbiciem emisji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-145">Loading without context is the only option for transient assemblies that are generated with reflection emit.</span></span> <span data-ttu-id="ec8f2-146">Ładowanie bez kontekstu jest jedynym sposobem, aby załadować wielu zestawów, które mają taką samą tożsamość w domenie jedną aplikację.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-146">Loading without context is the only way to load multiple assemblies that have the same identity into one application domain.</span></span> <span data-ttu-id="ec8f2-147">Unika się koszt sondowanie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-147">The cost of probing is avoided.</span></span>  
  
 <span data-ttu-id="ec8f2-148">Zestawy, które są ładowane z tablic bajtowych są ładowane bez kontekstu, chyba że tożsamość zestawu, na którym jest nawiązywane po zastosowaniu zasad, odpowiada tożsamości zestawu w pamięci podręcznej GAC; w takim przypadku zestaw jest załadowany z pamięci podręcznej GAC.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-148">Assemblies that are loaded from byte arrays are loaded without context unless the identity of the assembly, which is established when policy is applied, matches the identity of an assembly in the global assembly cache; in that case, the assembly is loaded from the global assembly cache.</span></span>  
  
 <span data-ttu-id="ec8f2-149">Ładowanie zestawów bez kontekstu ma następujące wady:</span><span class="sxs-lookup"><span data-stu-id="ec8f2-149">Loading assemblies without context has the following disadvantages:</span></span>  
  
-   <span data-ttu-id="ec8f2-150">Inne zestawy nie można powiązać z zestawów, które zostały załadowane bez kontekstu, o ile nie można obsłużyć <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-150">Other assemblies cannot bind to assemblies that are loaded without context, unless you handle the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>  
  
-   <span data-ttu-id="ec8f2-151">Zależności nie są ładowane automatycznie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-151">Dependencies are not loaded automatically.</span></span> <span data-ttu-id="ec8f2-152">Można wstępnie je bez kontekstu, wstępnie je w domyślnym kontekście ładowania lub załadować ich obsługa <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-152">You can preload them without context, preload them into the default load context, or load them by handling the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>  
  
-   <span data-ttu-id="ec8f2-153">Wiele zestawów o tej samej tożsamości bez kontekstu ładowania może spowodować problemy tożsamości typu podobne do spowodowanych przez ładowanie zestawów o tej samej tożsamości do wielu kontekstów.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-153">Loading multiple assemblies with the same identity without context can cause type identity problems similar to those caused by loading assemblies with the same identity into multiple contexts.</span></span> <span data-ttu-id="ec8f2-154">Zobacz [uniknąć podczas ładowania zestawu do wielu kontekstów](#avoid_loading_into_multiple_contexts).</span><span class="sxs-lookup"><span data-stu-id="ec8f2-154">See [Avoid Loading an Assembly into Multiple Contexts](#avoid_loading_into_multiple_contexts).</span></span>  
  
-   <span data-ttu-id="ec8f2-155">Jeśli zestaw obrazu macierzystego, nie jest używane.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-155">If a native image exists for the assembly, it is not used.</span></span>  
  
-   <span data-ttu-id="ec8f2-156">Nie można załadować zestawu jako neutralne dla domen.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-156">The assembly cannot be loaded as domain-neutral.</span></span>  
  
-   <span data-ttu-id="ec8f2-157">W wersji systemu .NET Framework 1.0 i 1.1 nie są stosowane zasady.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-157">In the .NET Framework versions 1.0 and 1.1, policy is not applied.</span></span>  
  
<a name="avoid_partial_names"></a>   
## <a name="avoid-binding-on-partial-assembly-names"></a><span data-ttu-id="ec8f2-158">Unikaj powiązanie nazwy zestawu z częściowa</span><span class="sxs-lookup"><span data-stu-id="ec8f2-158">Avoid Binding on Partial Assembly Names</span></span>  
 <span data-ttu-id="ec8f2-159">Powiązanie z częściowa nazwa występuje po określeniu tylko części nazwy wyświetlanej zestawu (<xref:System.Reflection.Assembly.FullName%2A>) podczas ładowania zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-159">Partial name binding occurs when you specify only part of the assembly display name (<xref:System.Reflection.Assembly.FullName%2A>) when you load an assembly.</span></span> <span data-ttu-id="ec8f2-160">Na przykład może wywołać <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> metody za pomocą tylko prosta nazwa zestawu, pomijając wersję, kulturę i token klucza publicznego.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-160">For example, you might call the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method with only the simple name of the assembly, omitting the version, culture, and public key token.</span></span> <span data-ttu-id="ec8f2-161">Lub może wywołać <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> metody, który po raz pierwszy wywołuje <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> metody i w przypadku niepowodzenia można znaleźć zestawu wyszukiwania w pamięci podręcznej GAC i ładuje najnowszej dostępnej wersji zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-161">Or you might call the <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> method, which first calls the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method and, if that fails to locate the assembly, searches the global assembly cache and loads the latest available version of the assembly.</span></span>  
  
 <span data-ttu-id="ec8f2-162">Powiązanie z częściowa nazwa może spowodować wiele problemów, takie jak następujące:</span><span class="sxs-lookup"><span data-stu-id="ec8f2-162">Partial name binding can cause many problems, including the following:</span></span>  
  
-   <span data-ttu-id="ec8f2-163"><xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> Metody może załadować inny zestaw o tej samej prostej nazwie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-163">The <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType> method might load a different assembly with the same simple name.</span></span> <span data-ttu-id="ec8f2-164">Na przykład dwie aplikacje mogą zainstalować dwóch zupełnie różnych zestawów czy mają prostą nazwę `GraphicsLibrary` w globalnej pamięci podręcznej zestawów.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-164">For example, two applications might install two completely different assemblies that both have the simple name `GraphicsLibrary` into the global assembly cache.</span></span>  
  
-   <span data-ttu-id="ec8f2-165">Zestaw został załadowany w rzeczywistości może nie być zgodny z poprzednimi wersjami.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-165">The assembly that is actually loaded might not be backward-compatible.</span></span> <span data-ttu-id="ec8f2-166">Na przykład nieokreślenie wersji może spowodować ładowanie dużo nowszą wersję niż wersja programu został początkowo zapisywane do użycia.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-166">For example, not specifying the version might result in the loading of a much later version than the version your program was originally written to use.</span></span> <span data-ttu-id="ec8f2-167">Zmiany w nowszej wersji może spowodować błędy w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-167">Changes in the later version might cause errors in your application.</span></span>  
  
-   <span data-ttu-id="ec8f2-168">Zestaw został załadowany w rzeczywistości może nie być zgodne z nowszymi.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-168">The assembly that is actually loaded might not be forward-compatible.</span></span> <span data-ttu-id="ec8f2-169">Na przykład może mieć wbudowane i przetestować aplikację do najnowszej wersji zestawu, ale powiązanie z częściowa może załadować znacznie starszą wersję, która nie zawiera funkcje, które korzysta z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-169">For example, you might have built and tested your application with the latest version of an assembly, but partial binding might load a much earlier version that lacks features your application uses.</span></span>  
  
-   <span data-ttu-id="ec8f2-170">Instalowanie nowej aplikacji mogą być dzielone istniejących aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-170">Installing new applications can break existing applications.</span></span> <span data-ttu-id="ec8f2-171">Aplikacja, która używa <xref:System.Reflection.Assembly.LoadWithPartialName%2A> — metoda może przerwane przez instalację nowszej, niezgodnej wersji zestaw udostępnionego.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-171">An application that uses the <xref:System.Reflection.Assembly.LoadWithPartialName%2A> method can be broken by installing a newer, incompatible version of a shared assembly.</span></span>  
  
-   <span data-ttu-id="ec8f2-172">Może wystąpić nieoczekiwany zależności ładowania.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-172">Unexpected dependency loading can occur.</span></span> <span data-ttu-id="ec8f2-173">Załadować tego udziału zależność ładowaniem ich z częściowa powiązania może spowodować w jednym zestawie za pomocą składnika, który nie był dwa zestawy wbudowanych lub przetestowana.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-173">It you load two assemblies that share a dependency, loading them with partial binding might result in one assembly using a component that it was not built or tested with.</span></span>  
  
 <span data-ttu-id="ec8f2-174">Z powodu problemów może spowodować <xref:System.Reflection.Assembly.LoadWithPartialName%2A> metody zostało oznaczone jako przestarzałe.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-174">Because of the problems it can cause, the <xref:System.Reflection.Assembly.LoadWithPartialName%2A> method has been marked obsolete.</span></span> <span data-ttu-id="ec8f2-175">Firma Microsoft zaleca użycie <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> — metoda i określ nazwy wyświetlane pełnego zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-175">We recommend that you use the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method instead, and specify full assembly display names.</span></span> <span data-ttu-id="ec8f2-176">Zobacz [zrozumieć zalety i wady kontekstów obciążenia](#load_contexts) i [rozważ przejście na domyślnym kontekście ładowania](#switch_to_default).</span><span class="sxs-lookup"><span data-stu-id="ec8f2-176">See [Understand the Advantages and Disadvantages of Load Contexts](#load_contexts) and [Consider Switching to the Default Load Context](#switch_to_default).</span></span>  
  
 <span data-ttu-id="ec8f2-177">Jeśli chcesz użyć <xref:System.Reflection.Assembly.LoadWithPartialName%2A> — metoda ponieważ zapewnia łatwe i ładowania zestawu należy wziąć pod uwagę że o aplikacji zakończyć się niepowodzeniem z komunikatem o błędzie, który identyfikuje brakujący zestaw prawdopodobnie lepsze środowisko pracy użytkownika niż automatycznie za pomocą Nieznana wersja zestawu, który może spowodować nieprzewidywalne zachowanie i zabezpieczeń luk.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-177">If you want to use the <xref:System.Reflection.Assembly.LoadWithPartialName%2A> method because it makes assembly loading easy, consider that having your application fail with an error message that identifies the missing assembly is likely to provide a better user experience than automatically using an unknown version of the assembly, which might cause unpredictable behavior and security holes.</span></span>  
  
<a name="avoid_loading_into_multiple_contexts"></a>   
## <a name="avoid-loading-an-assembly-into-multiple-contexts"></a><span data-ttu-id="ec8f2-178">Unikaj ładowania zestawu do wielu kontekstów</span><span class="sxs-lookup"><span data-stu-id="ec8f2-178">Avoid Loading an Assembly into Multiple Contexts</span></span>  
 <span data-ttu-id="ec8f2-179">Podczas ładowania zestawu do wielu kontekstów może spowodować problemy tożsamości typu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-179">Loading an assembly into multiple contexts can cause type identity problems.</span></span> <span data-ttu-id="ec8f2-180">Jeśli ten sam typ jest załadowany z tego samego zestawu do dwóch różnych kontekstach, są tak, jakby został załadowany dwa różne typy o takiej samej nazwie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-180">If the same type is loaded from the same assembly into two different contexts, it is as if two different types with the same name had been loaded.</span></span> <span data-ttu-id="ec8f2-181"><xref:System.InvalidCastException> Jest generowany przy próbie rzutowania typu do innych komunikatem mylące wpisz `MyType` nie można rzutować na typ `MyType`.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-181">An <xref:System.InvalidCastException> is thrown if you try to cast one type to the other, with the confusing message that type `MyType` cannot be cast to type `MyType`.</span></span>  
  
 <span data-ttu-id="ec8f2-182">Na przykład, załóżmy, że `ICommunicate` interfejsu jest zadeklarowany w zestawie o nazwie `Utility`, który jest przywoływany przez program, a także innych zestawów ładowanych w programie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-182">For example, suppose that the `ICommunicate` interface is declared in an assembly named `Utility`, which is referenced by your program and also by other assemblies that your program loads.</span></span> <span data-ttu-id="ec8f2-183">Typy implementujące zawierają inne zestawy `ICommunicate` interfejsu, dzięki czemu program z nich korzystać.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-183">These other assemblies contain types that implement the `ICommunicate` interface, allowing your program to use them.</span></span>  
  
 <span data-ttu-id="ec8f2-184">Teraz należy rozważyć, co się stanie po uruchomieniu programu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-184">Now consider what happens when your program is run.</span></span> <span data-ttu-id="ec8f2-185">Zestawy, do których odwołuje się program zostały załadowane w domyślnym kontekście ładowania.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-185">Assemblies that are referenced by your program are loaded into the default load context.</span></span> <span data-ttu-id="ec8f2-186">Załadowanie zestawu docelowego przez swoją tożsamość, za pomocą <xref:System.Reflection.Assembly.Load%2A> metody, będzie w domyślnym kontekście ładowania, a więc będzie jego zależności.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-186">If you load a target assembly by its identity, using the <xref:System.Reflection.Assembly.Load%2A> method, it will be in the default load context, and so will its dependencies.</span></span> <span data-ttu-id="ec8f2-187">Zarówno program i zestaw docelowy będzie używać tego samego `Utility` zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-187">Both your program and the target assembly will use the same `Utility` assembly.</span></span>  
  
 <span data-ttu-id="ec8f2-188">Jednak Załóżmy, że ładowanie zestawu docelowego za pomocą ścieżki pliku za pomocą <xref:System.Reflection.Assembly.LoadFile%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-188">However, suppose you load the target assembly by its file path, using the <xref:System.Reflection.Assembly.LoadFile%2A> method.</span></span> <span data-ttu-id="ec8f2-189">Zestaw jest załadowany bez żadnego kontekstu, więc jego zależności nie są ładowane automatycznie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-189">The assembly is loaded without any context, so its dependencies are not automatically loaded.</span></span> <span data-ttu-id="ec8f2-190">Program obsługi może być <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> zdarzenie, aby podać zależności, a może załadować `Utility` zestawu z żadnego kontekstu za pomocą <xref:System.Reflection.Assembly.LoadFile%2A> — metoda.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-190">You might have a handler for the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event to supply the dependency, and it might load the `Utility` assembly with no context by using the <xref:System.Reflection.Assembly.LoadFile%2A> method.</span></span> <span data-ttu-id="ec8f2-191">Teraz podczas tworzenia wystąpienia typu, który jest zawarty w zestawie docelowym i spróbuj przypisać je do zmiennej typu `ICommunicate`, <xref:System.InvalidCastException> jest generowany, gdy uzna środowiska uruchomieniowego `ICommunicate` interfejsy w dwóch kopii `Utility` zestawu do różnych typów.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-191">Now when you create an instance of a type that is contained in the target assembly and try to assign it to a variable of type `ICommunicate`, an <xref:System.InvalidCastException> is thrown because the runtime considers the `ICommunicate` interfaces in the two copies of the `Utility` assembly to be different types.</span></span>  
  
 <span data-ttu-id="ec8f2-192">Istnieje wiele innych scenariuszy, w których może być załadowany do wielu kontekstów zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-192">There are many other scenarios in which an assembly can be loaded into multiple contexts.</span></span> <span data-ttu-id="ec8f2-193">Najlepszym rozwiązaniem jest unikanie konfliktów przemieszczanie zestawu docelowego w ścieżce aplikacji, a następnie użyć <xref:System.Reflection.Assembly.Load%2A> metodę o nazwie wyświetlanej pełna.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-193">The best approach is to avoid conflicts by relocating the target assembly in your application path and using the <xref:System.Reflection.Assembly.Load%2A> method with the full display name.</span></span> <span data-ttu-id="ec8f2-194">Zestaw jest następnie ładowany w domyślnym kontekście ładowania, a oba zestawy używać tego samego `Utility` zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-194">The assembly is then loaded into the default load context, and both assemblies use the same `Utility` assembly.</span></span>  
  
 <span data-ttu-id="ec8f2-195">Jeśli zestaw docelowy musi pozostać poza ścieżki aplikacji, możesz użyć <xref:System.Reflection.Assembly.LoadFrom%2A> metodę, aby załadować do kontekst load-from.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-195">If the target assembly must remain outside your application path, you can use the <xref:System.Reflection.Assembly.LoadFrom%2A> method to load it into the load-from context.</span></span> <span data-ttu-id="ec8f2-196">Jeśli zestaw docelowy został skompilowany z odwołaniem do aplikacji `Utility` zestawu, zostanie użyty `Utility` zestawu, który aplikacja została załadowana w domyślnym kontekście ładowania.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-196">If the target assembly was compiled with a reference to your application's `Utility` assembly, it will use the `Utility` assembly that your application has loaded into the default load context.</span></span> <span data-ttu-id="ec8f2-197">Należy pamiętać, że mogą wystąpić problemy, jeśli zestaw docelowy ma zależność kopii `Utility` zestawu znajdujących się poza ścieżki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-197">Note that problems can occur if the target assembly has a dependency on a copy of the `Utility` assembly located outside your application path.</span></span> <span data-ttu-id="ec8f2-198">Jeśli ten zestaw jest ładowany w kontekście ładowania z przed obciążenia Twojej aplikacji `Utility` zestawu, obciążenia aplikacji nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-198">If that assembly is loaded into the load-from context before your application loads the `Utility` assembly, your application's load will fail.</span></span>  
  
 <span data-ttu-id="ec8f2-199">[Rozważ przełączenie do kontekstu ładowania domyślne](#switch_to_default) sekcji omówiono rozwiązań alternatywnych, takich jak przy użyciu obciążeń ścieżka pliku <xref:System.Reflection.Assembly.LoadFile%2A> i <xref:System.Reflection.Assembly.LoadFrom%2A>.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-199">The [Consider Switching to the Default Load Context](#switch_to_default) section discusses alternatives to using file path loads such as <xref:System.Reflection.Assembly.LoadFile%2A> and <xref:System.Reflection.Assembly.LoadFrom%2A>.</span></span>  
  
<a name="avoid_loading_multiple_versions"></a>   
## <a name="avoid-loading-multiple-versions-of-an-assembly-into-the-same-context"></a><span data-ttu-id="ec8f2-200">Unikaj ładowania wielu wersji zestawu do tego samego kontekstu</span><span class="sxs-lookup"><span data-stu-id="ec8f2-200">Avoid Loading Multiple Versions of an Assembly into the Same Context</span></span>  
 <span data-ttu-id="ec8f2-201">Podczas ładowania wielu wersji zestawu do jednego kontekstu ładowania może spowodować problemy tożsamości typu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-201">Loading multiple versions of an assembly into one load context can cause type identity problems.</span></span> <span data-ttu-id="ec8f2-202">Jeśli ten sam typ jest załadowany z dwie wersje tego samego zestawu, są tak, jakby został załadowany dwa różne typy o takiej samej nazwie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-202">If the same type is loaded from two versions of the same assembly, it is as if two different types with the same name had been loaded.</span></span> <span data-ttu-id="ec8f2-203"><xref:System.InvalidCastException> Jest generowany przy próbie rzutowania typu do innych komunikatem mylące wpisz `MyType` nie można rzutować na typ `MyType`.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-203">An <xref:System.InvalidCastException> is thrown if you try to cast one type to the other, with the confusing message that type `MyType` cannot be cast to type `MyType`.</span></span>  
  
 <span data-ttu-id="ec8f2-204">Na przykład program może załadować jednej wersji `Utility` zestawu bezpośrednio i później może załadować innego zestawu, który ładuje innej wersji `Utility` zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-204">For example, your program might load one version of the `Utility` assembly directly, and later it might load another assembly that loads a different version of the `Utility` assembly.</span></span> <span data-ttu-id="ec8f2-205">Lub błąd kodowania może spowodować dwa różne ścieżki aplikacji do ładowania różnych wersji zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-205">Or a coding error might cause two different code paths in your application to load different versions of an assembly.</span></span>  
  
 <span data-ttu-id="ec8f2-206">W domyślnym kontekście ładowania, ten problem może wystąpić, gdy używasz <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> metodę i określić nazwy wyświetlane pełny zestaw, które obejmują różnych numerów wersji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-206">In the default load context, this problem can occur when you use the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method and specify complete assembly display names that include different version numbers.</span></span> <span data-ttu-id="ec8f2-207">Dla zestawów, które zostały załadowane bez kontekstu, problem może być spowodowane przy użyciu <xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType> metodę, aby załadować ten sam zestaw z innej ścieżki.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-207">For assemblies that are loaded without context, the problem can be caused by using the <xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType> method to load the same assembly from different paths.</span></span> <span data-ttu-id="ec8f2-208">Środowisko uruchomieniowe uwzględnia dwa zestawy, które są ładowane z różne ścieżki się różnych zestawów, nawet jeśli ich tożsamości są takie same.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-208">The runtime considers two assemblies that are loaded from different paths to be different assemblies, even if their identities are the same.</span></span>  
  
 <span data-ttu-id="ec8f2-209">Oprócz typu tożsamości problemów, może spowodować wiele wersji zestawu <xref:System.MissingMethodException> Jeśli typ, który jest ładowany z jednej wersji zestawu są przekazywane do kodu, która oczekuje typu z innej wersji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-209">In addition to type identity problems, multiple versions of an assembly can cause a <xref:System.MissingMethodException> if a type that is loaded from one version of the assembly is passed to code that expects that type from a different version.</span></span> <span data-ttu-id="ec8f2-210">Na przykład kod może oczekiwać, że metoda, która została dodana do nowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-210">For example, the code might expect a method that was added to the later version.</span></span>  
  
 <span data-ttu-id="ec8f2-211">Więcej subtelnych błędów może wystąpić, jeśli zachowanie typu zmieniony między wersjami.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-211">More subtle errors can occur if the behavior of the type changed between versions.</span></span> <span data-ttu-id="ec8f2-212">Na przykład metoda może zgłosić wystąpił nieoczekiwany wyjątek lub zwrócić nieoczekiwaną wartość.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-212">For example, a method might throw an unexpected exception or return an unexpected value.</span></span>  
  
 <span data-ttu-id="ec8f2-213">Uważnie przejrzyj swój kod, aby upewnić się, że tylko jeden jest załadowana wersja tego zestawu.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-213">Carefully review your code to ensure that only one version of an assembly is loaded.</span></span> <span data-ttu-id="ec8f2-214">Można użyć <xref:System.AppDomain.GetAssemblies%2A?displayProperty=nameWithType> metodę, aby określić, które zestawy są ładowane w danym momencie.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-214">You can use the <xref:System.AppDomain.GetAssemblies%2A?displayProperty=nameWithType> method to determine which assemblies are loaded at any given time.</span></span>  
  
<a name="switch_to_default"></a>   
## <a name="consider-switching-to-the-default-load-context"></a><span data-ttu-id="ec8f2-215">Rozważ przejście na domyślnym kontekście ładowania</span><span class="sxs-lookup"><span data-stu-id="ec8f2-215">Consider Switching to the Default Load Context</span></span>  
 <span data-ttu-id="ec8f2-216">Sprawdź wzorców obciążenia i wdrażania zestawu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-216">Examine your application's assembly loading and deployment patterns.</span></span> <span data-ttu-id="ec8f2-217">Pozwala wyeliminować zestawy, które są ładowane z tablic bajtowych</span><span class="sxs-lookup"><span data-stu-id="ec8f2-217">Can you eliminate assemblies that are loaded from byte arrays?</span></span> <span data-ttu-id="ec8f2-218">Można przenieść zestawów do ścieżki próbkowania?</span><span class="sxs-lookup"><span data-stu-id="ec8f2-218">Can you move assemblies into the probing path?</span></span> <span data-ttu-id="ec8f2-219">Jeśli zestawy znajdują się w globalnej pamięci podręcznej zestawów lub w domenie aplikacji na ścieżce badania (to znaczy jego <xref:System.AppDomainSetup.ApplicationBase%2A> i <xref:System.AppDomainSetup.PrivateBinPath%2A>), można załadować zestawu przez jego tożsamość.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-219">If assemblies are located in the global assembly cache or in the application domain's probing path (that is, its <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A>), you can load the assembly by its identity.</span></span>  
  
 <span data-ttu-id="ec8f2-220">Jeśli nie jest możliwe umieszczenie ponownie zestawy w ścieżce sondowania, należy wziąć pod uwagę rozwiązań alternatywnych, takich jak przy użyciu modelu dodatku programu .NET Framework, umieszczanie zestawów w globalnej pamięci podręcznej zestawów lub tworzenia domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-220">If it is not possible to put all your assemblies in the probing path, consider alternatives such as using the .NET Framework add-in model, placing assemblies into the global assembly cache, or creating application domains.</span></span>  
  
### <a name="consider-using-the-net-framework-add-in-model"></a><span data-ttu-id="ec8f2-221">Należy wziąć pod uwagę przy użyciu platformy .NET Framework — w modelu</span><span class="sxs-lookup"><span data-stu-id="ec8f2-221">Consider Using the .NET Framework Add-In Model</span></span>  
 <span data-ttu-id="ec8f2-222">Jeśli używasz kontekst load-from do zaimplementowania dodatków, które zwykle nie są zainstalowane w bazie danych aplikacji, użyj modelu dodatku .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-222">If you are using the load-from context to implement add-ins, which typically are not installed in the application base, use the .NET Framework add-in model.</span></span> <span data-ttu-id="ec8f2-223">Ten model zapewnia izolację na poziomie domeny lub procesu aplikacji, bez konieczności samodzielnie zarządzać domen aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-223">This model provides isolation at the application domain or process level, without requiring you to manage application domains yourself.</span></span> <span data-ttu-id="ec8f2-224">Aby uzyskać informacje na temat modelu dodatku, zobacz [dodatki i rozszerzalność](../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="ec8f2-224">For information about the add-in model, see [Add-ins and Extensibility](../../../docs/framework/add-ins/index.md).</span></span>  
  
### <a name="consider-using-the-global-assembly-cache"></a><span data-ttu-id="ec8f2-225">Należy rozważyć użycie Globalna pamięć podręczna zestawów</span><span class="sxs-lookup"><span data-stu-id="ec8f2-225">Consider Using the Global Assembly Cache</span></span>  
 <span data-ttu-id="ec8f2-226">Zestawy miejsca w pamięci podręcznej GAC można skorzystać z zalet ścieżki zestaw udostępnionego to poza aplikacją podstawowej, bez utraty korzyści wynikające z domyślnym kontekście ładowania lub pobieranie na wady innych kontekstach.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-226">Place assemblies in the global assembly cache to get the benefit of a shared assembly path that is outside the application base, without losing the advantages of the default load context or taking on the disadvantages of the other contexts.</span></span>  
  
### <a name="consider-using-application-domains"></a><span data-ttu-id="ec8f2-227">Należy rozważyć użycie domeny aplikacji</span><span class="sxs-lookup"><span data-stu-id="ec8f2-227">Consider Using Application Domains</span></span>  
 <span data-ttu-id="ec8f2-228">Jeśli okaże się, że niektóre z zestawów nie można wdrożyć w ścieżce sondowania aplikacji, należy rozważyć utworzenie nowej domeny aplikacji dla tych zestawów.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-228">If you determine that some of your assemblies cannot be deployed in the application's probing path, consider creating a new application domain for those assemblies.</span></span> <span data-ttu-id="ec8f2-229">Użyj <xref:System.AppDomainSetup> do utworzenia nowej domeny aplikacji i użycia <xref:System.AppDomainSetup.ApplicationBase%2A?displayProperty=nameWithType> właściwość, aby określić ścieżkę zawierającą zestawy chcesz załadować.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-229">Use an <xref:System.AppDomainSetup> to create the new application domain, and use the <xref:System.AppDomainSetup.ApplicationBase%2A?displayProperty=nameWithType> property to specify the path that contains the assemblies you want to load.</span></span> <span data-ttu-id="ec8f2-230">Jeśli masz wiele katalogów do sondowania, możesz ustawić <xref:System.AppDomainSetup.ApplicationBase%2A> do katalogu głównego i użyj <xref:System.AppDomainSetup.PrivateBinPath%2A?displayProperty=nameWithType> właściwość do identyfikacji podkatalogi do sondowania.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-230">If you have multiple directories to probe, you can set the <xref:System.AppDomainSetup.ApplicationBase%2A> to a root directory and use the <xref:System.AppDomainSetup.PrivateBinPath%2A?displayProperty=nameWithType> property to identify the subdirectories to probe.</span></span> <span data-ttu-id="ec8f2-231">Alternatywnie możesz utworzyć wiele domen aplikacji i ustawić <xref:System.AppDomainSetup.ApplicationBase%2A> każdej domeny aplikacji odpowiednią ścieżkę do jego zestawów.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-231">Alternatively, you can create multiple application domains and set the <xref:System.AppDomainSetup.ApplicationBase%2A> of each application domain to the appropriate path for its assemblies.</span></span>  
  
 <span data-ttu-id="ec8f2-232">Należy pamiętać, że można użyć <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> metodę, aby załadować te zestawy.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-232">Note that you can use the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method to load these assemblies.</span></span> <span data-ttu-id="ec8f2-233">Ponieważ teraz są ścieżki próbkowania, zostaną one załadowane w domyślnym kontekście ładowania zamiast kontekst load-from.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-233">Because they are now in the probing path, they will be loaded into the default load context instead of the load-from context.</span></span> <span data-ttu-id="ec8f2-234">Jednak firma Microsoft zaleca, aby przełączyć się do <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> — metoda i dostarczanie pełnej nazwy wyświetlane zestawu, aby upewnić się, że poprawne wersje są zawsze używane.</span><span class="sxs-lookup"><span data-stu-id="ec8f2-234">However, we recommend that you switch to the <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> method and supply full assembly display names to ensure that correct versions are always used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ec8f2-235">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="ec8f2-235">See Also</span></span>  
 <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType>  
 <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>  
 <xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType>  
 <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType>  
 [<span data-ttu-id="ec8f2-236">Dodatki i rozszerzalność</span><span class="sxs-lookup"><span data-stu-id="ec8f2-236">Add-ins and Extensibility</span></span>](../../../docs/framework/add-ins/index.md)
