---
title: 'Instrukcje: Odbieranie powiadomień o wyjątkach pierwszej szansy'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- first-chance exception notifications
- exceptions, first chance notifications
ms.assetid: 66f002b8-a97d-4a6e-a503-2cec01689113
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: f6f70b4c67de892c3b66a0099dae9f618a99b3f1
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/18/2019
ms.locfileid: "59770493"
---
# <a name="how-to-receive-first-chance-exception-notifications"></a><span data-ttu-id="73dfe-102">Instrukcje: Odbieranie powiadomień o wyjątkach pierwszej szansy</span><span class="sxs-lookup"><span data-stu-id="73dfe-102">How to: Receive First-Chance Exception Notifications</span></span>
<span data-ttu-id="73dfe-103"><xref:System.AppDomain.FirstChanceException> Zdarzenia <xref:System.AppDomain> klasa umożliwia otrzymywanie powiadomień, który jest zwracany wyjątek, przed języka wspólnego środowiska uruchomieniowego została rozpoczęta, wyszukując obsługi wyjątków.</span><span class="sxs-lookup"><span data-stu-id="73dfe-103">The <xref:System.AppDomain.FirstChanceException> event of the <xref:System.AppDomain> class lets you receive a notification that an exception has been thrown, before the common language runtime has begun searching for exception handlers.</span></span>

 <span data-ttu-id="73dfe-104">Zdarzenie jest wywoływane na poziomie domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-104">The event is raised at the application domain level.</span></span> <span data-ttu-id="73dfe-105">Wątek wykonywania mogą przejść przez wiele domen aplikacji, więc wyjątek, który jest nieobsługiwany w jednej domenie aplikacji może być obsługiwane w innej domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-105">A thread of execution can pass through multiple application domains, so an exception that is unhandled in one application domain could be handled in another application domain.</span></span> <span data-ttu-id="73dfe-106">Powiadomienie występuje w każdej domenie aplikacji, która została dodana procedura obsługi zdarzeń, dopóki nie obsługuje wyjątek, domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-106">The notification occurs in each application domain that has added a handler for the event, until an application domain handles the exception.</span></span>

 <span data-ttu-id="73dfe-107">Procedury składowane i przykłady w niniejszym artykule pokazano, jak otrzymywać powiadomienia o wyjątkach pierwszej szansy w prosty program, który ma jedną domenę aplikacji, a w domenie aplikacji, którą tworzysz.</span><span class="sxs-lookup"><span data-stu-id="73dfe-107">The procedures and examples in this article show how to receive first-chance exception notifications in a simple program that has one application domain, and in an application domain that you create.</span></span>

 <span data-ttu-id="73dfe-108">Na przykład bardziej złożone, która obejmuje kilka domen aplikacji, zobacz przykład <xref:System.AppDomain.FirstChanceException> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="73dfe-108">For a more complex example that spans several application domains, see the example for the <xref:System.AppDomain.FirstChanceException> event.</span></span>

## <a name="receiving-first-chance-exception-notifications-in-the-default-application-domain"></a><span data-ttu-id="73dfe-109">Odbieranie powiadomień o wyjątkach pierwszej szansy w domyślnej domeny aplikacji</span><span class="sxs-lookup"><span data-stu-id="73dfe-109">Receiving First-Chance Exception Notifications in the Default Application Domain</span></span>
 <span data-ttu-id="73dfe-110">W poniższej procedurze punkt wejścia dla aplikacji, `Main()` metoda, jest uruchamiana w domyślnej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-110">In the following procedure, the entry point for the application, the `Main()` method, runs in the default application domain.</span></span>

#### <a name="to-demonstrate-first-chance-exception-notifications-in-the-default-application-domain"></a><span data-ttu-id="73dfe-111">Aby zademonstrować powiadomień o wyjątkach pierwszej szansy w domyślnej domeny aplikacji</span><span class="sxs-lookup"><span data-stu-id="73dfe-111">To demonstrate first-chance exception notifications in the default application domain</span></span>

1. <span data-ttu-id="73dfe-112">Definiowanie zdarzenia obsługi dla <xref:System.AppDomain.FirstChanceException> zdarzenie, przy użyciu wyrażenia lambda funkcji i dołącz je do zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="73dfe-112">Define an event handler for the <xref:System.AppDomain.FirstChanceException> event, using a lambda function, and attach it to the event.</span></span> <span data-ttu-id="73dfe-113">W tym przykładzie program obsługi zdarzeń Drukuje nazwę domeny aplikacji, w którym zdarzenie został obsłużony i wyjątków <xref:System.Exception.Message%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="73dfe-113">In this example, the event handler prints the name of the application domain where the event was handled and the exception's <xref:System.Exception.Message%2A> property.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#2)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#2)]

2. <span data-ttu-id="73dfe-114">Zgłoszenie wyjątku i przechwytywać je.</span><span class="sxs-lookup"><span data-stu-id="73dfe-114">Throw an exception and catch it.</span></span> <span data-ttu-id="73dfe-115">Zanim środowisko uruchomieniowe lokalizuje obsługi wyjątków <xref:System.AppDomain.FirstChanceException> zdarzenie jest zgłaszane i zostanie wyświetlony komunikat.</span><span class="sxs-lookup"><span data-stu-id="73dfe-115">Before the runtime locates the exception handler, the <xref:System.AppDomain.FirstChanceException> event is raised and displays a message.</span></span> <span data-ttu-id="73dfe-116">Ten komunikat występuje komunikat, który jest wyświetlany przez program obsługi wyjątków.</span><span class="sxs-lookup"><span data-stu-id="73dfe-116">This message is followed by the message that is displayed by the exception handler.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#3](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#3)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#3)]

3. <span data-ttu-id="73dfe-117">Zgłoś wyjątek, ale nie Przechwytuj.</span><span class="sxs-lookup"><span data-stu-id="73dfe-117">Throw an exception, but do not catch it.</span></span> <span data-ttu-id="73dfe-118">Zanim środowisko uruchomieniowe szuka obsługi wyjątków <xref:System.AppDomain.FirstChanceException> zdarzenie jest zgłaszane i zostanie wyświetlony komunikat.</span><span class="sxs-lookup"><span data-stu-id="73dfe-118">Before the runtime looks for an exception handler, the <xref:System.AppDomain.FirstChanceException> event is raised and displays a message.</span></span> <span data-ttu-id="73dfe-119">Jest nie obsługi wyjątków, dlatego zakończenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-119">There is no exception handler, so the application terminates.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#4](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#4)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#4)]

     <span data-ttu-id="73dfe-120">Kod, który jest wyświetlany w pierwszych trzech kroków tej procedury formularzy aplikacji konsoli ukończone.</span><span class="sxs-lookup"><span data-stu-id="73dfe-120">The code that is shown in the first three steps of this procedure forms a complete console application.</span></span> <span data-ttu-id="73dfe-121">Dane wyjściowe z aplikacji różni się w zależności od nazwy pliku .exe, ponieważ nazwa domyślnej domeny aplikacji składa się z nazwę i rozszerzenie pliku .exe.</span><span class="sxs-lookup"><span data-stu-id="73dfe-121">The output from the application varies, depending on the name of the .exe file, because the name of the default application domain consists of the name and extension of the .exe file.</span></span> <span data-ttu-id="73dfe-122">Zobacz następujące przykładowe dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="73dfe-122">See the following for sample output.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#5)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#5)]

## <a name="receiving-first-chance-exception-notifications-in-another-application-domain"></a><span data-ttu-id="73dfe-123">Odbieranie powiadomień o wyjątkach pierwszej szansy w innej domenie aplikacji</span><span class="sxs-lookup"><span data-stu-id="73dfe-123">Receiving First-Chance Exception Notifications in Another Application Domain</span></span>
 <span data-ttu-id="73dfe-124">Jeśli program zawiera więcej niż jedną domenę aplikacji, wybierz pozycję domen aplikacji, otrzymywać powiadomienia.</span><span class="sxs-lookup"><span data-stu-id="73dfe-124">If your program contains more than one application domain, you can choose which application domains receive notifications.</span></span>

#### <a name="to-receive-first-chance-exception-notifications-in-an-application-domain-that-you-create"></a><span data-ttu-id="73dfe-125">Aby otrzymywać powiadomienia o wyjątkach pierwszej szansy w domenie aplikacji, którą tworzysz</span><span class="sxs-lookup"><span data-stu-id="73dfe-125">To receive first-chance exception notifications in an application domain that you create</span></span>

1. <span data-ttu-id="73dfe-126">Definiowanie zdarzenia obsługi dla <xref:System.AppDomain.FirstChanceException> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="73dfe-126">Define an event handler for the <xref:System.AppDomain.FirstChanceException> event.</span></span> <span data-ttu-id="73dfe-127">W tym przykładzie użyto `static` — metoda (`Shared` w języku Visual Basic), drukuje nazwę domeny aplikacji, w którym zdarzenie został obsłużony i wyjątków <xref:System.Exception.Message%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="73dfe-127">This example uses a `static` method (`Shared` method in Visual Basic) that prints the name of the application domain where the event was handled and the exception's <xref:System.Exception.Message%2A> property.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#3](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#3)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#3)]

2. <span data-ttu-id="73dfe-128">Tworzenie domeny aplikacji i dodaj procedurę obsługi zdarzeń do <xref:System.AppDomain.FirstChanceException> zdarzenia dla tej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-128">Create an application domain and add the event handler to the <xref:System.AppDomain.FirstChanceException> event for that application domain.</span></span> <span data-ttu-id="73dfe-129">W tym przykładzie domena aplikacji o nazwie `AD1`.</span><span class="sxs-lookup"><span data-stu-id="73dfe-129">In this example, the application domain is named `AD1`.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#2)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#2)]

     <span data-ttu-id="73dfe-130">W ten sam sposób, może obsługiwać to zdarzenie w domyślnej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-130">You can handle this event in the default application domain in the same way.</span></span> <span data-ttu-id="73dfe-131">Użyj `static` (`Shared` w języku Visual Basic) <xref:System.AppDomain.CurrentDomain%2A?displayProperty=nameWithType> właściwość `Main()` można pobrać odwołania do domyślnej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-131">Use the `static` (`Shared` in Visual Basic) <xref:System.AppDomain.CurrentDomain%2A?displayProperty=nameWithType> property in `Main()` to get a reference to the default application domain.</span></span>

#### <a name="to-demonstrate-first-chance-exception-notifications-in-the-application-domain"></a><span data-ttu-id="73dfe-132">Aby zademonstrować powiadomień o wyjątkach pierwszej szansy w domenie aplikacji</span><span class="sxs-lookup"><span data-stu-id="73dfe-132">To demonstrate first-chance exception notifications in the application domain</span></span>

1. <span data-ttu-id="73dfe-133">Utwórz `Worker` obiektu w domenie aplikacji, który został utworzony w poprzedniej procedurze.</span><span class="sxs-lookup"><span data-stu-id="73dfe-133">Create a `Worker` object in the application domain that you created in the previous procedure.</span></span> <span data-ttu-id="73dfe-134">`Worker` Klasy muszą być publiczne i musi pochodzić od klasy <xref:System.MarshalByRefObject>, jak pokazano w kompletnym przykładzie na końcu tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="73dfe-134">The `Worker` class must be public, and must derive from <xref:System.MarshalByRefObject>, as shown in the complete example at the end of this article.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#4](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#4)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#4)]

2. <span data-ttu-id="73dfe-135">Wywołaj metodę klasy `Worker` obiekt, który zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="73dfe-135">Call a method of the `Worker` object that throws an exception.</span></span> <span data-ttu-id="73dfe-136">W tym przykładzie `Thrower` metoda jest wywoływana dwa razy.</span><span class="sxs-lookup"><span data-stu-id="73dfe-136">In this example, the `Thrower` method is called twice.</span></span> <span data-ttu-id="73dfe-137">Podczas pierwszego argumentu metody jest `true`, co powoduje, że metoda przechwycić wyjątek swój własny.</span><span class="sxs-lookup"><span data-stu-id="73dfe-137">The first time, the method argument is `true`, which causes the method to catch its own exception.</span></span> <span data-ttu-id="73dfe-138">Po raz drugi, argument jest `false`i `Main()` metoda przechwytuje wyjątek w domyślnej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-138">The second time, the argument is `false`, and the `Main()` method catches the exception in the default application domain.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#6](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#6)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#6)]

3. <span data-ttu-id="73dfe-139">Umieść kod w `Thrower` metodę, aby kontrolować, czy metoda obsługuje swój własny wyjątek.</span><span class="sxs-lookup"><span data-stu-id="73dfe-139">Place code in the `Thrower` method to control whether the method handles its own exception.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#5)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#5)]

## <a name="example"></a><span data-ttu-id="73dfe-140">Przykład</span><span class="sxs-lookup"><span data-stu-id="73dfe-140">Example</span></span>
 <span data-ttu-id="73dfe-141">Poniższy przykład tworzy domenę aplikacji o nazwie `AD1` i dodaje procedurę obsługi zdarzeń do domeny aplikacji <xref:System.AppDomain.FirstChanceException> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="73dfe-141">The following example creates an application domain named `AD1` and adds an event handler to the application domain's <xref:System.AppDomain.FirstChanceException> event.</span></span> <span data-ttu-id="73dfe-142">Przykład tworzy wystąpienie `Worker` klasy w domenie aplikacji i wywołuje metodę o nazwie `Thrower` która zgłasza <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="73dfe-142">The example creates an instance of the `Worker` class in the application domain, and calls a method named `Thrower` that throws an <xref:System.ArgumentException>.</span></span> <span data-ttu-id="73dfe-143">W zależności od wartości argumentu metoda przechwytuje wyjątek lub nie można go obsłużyć.</span><span class="sxs-lookup"><span data-stu-id="73dfe-143">Depending on the value of its argument, the method either catches the exception or fails to handle it.</span></span>

 <span data-ttu-id="73dfe-144">Każdorazowo `Thrower` metoda zgłasza wyjątek `AD1`, <xref:System.AppDomain.FirstChanceException> zdarzenie jest zgłaszane w `AD1`, i wyświetla komunikat, program obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="73dfe-144">Each time the `Thrower` method throws an exception in `AD1`, the <xref:System.AppDomain.FirstChanceException> event is raised in `AD1`, and the event handler displays a message.</span></span> <span data-ttu-id="73dfe-145">Środowisko uruchomieniowe wyszukuje następnie obsługi wyjątków.</span><span class="sxs-lookup"><span data-stu-id="73dfe-145">The runtime then looks for an exception handler.</span></span> <span data-ttu-id="73dfe-146">W przypadku pierwszego programu obsługi wyjątków znajduje się w `AD1`.</span><span class="sxs-lookup"><span data-stu-id="73dfe-146">In the first case, the exception handler is found in `AD1`.</span></span> <span data-ttu-id="73dfe-147">W drugim przypadku nieobsługiwanego wyjątku w `AD1`i zamiast tego zostanie zablokowany w domyślnej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73dfe-147">In the second case, the exception is unhandled in `AD1`, and instead is caught in the default application domain.</span></span>

> [!NOTE]
>  <span data-ttu-id="73dfe-148">Nazwa domyślnej domeny aplikacji jest taka sama jak nazwa pliku wykonywalnego.</span><span class="sxs-lookup"><span data-stu-id="73dfe-148">The name of the default application domain is the same as the name of the executable.</span></span>

 <span data-ttu-id="73dfe-149">Jeśli dodasz funkcję obsługi <xref:System.AppDomain.FirstChanceException> zdarzenia do domyślnej domeny aplikacji, zdarzenie jest zgłaszane i obsługiwane przed domyślnej domeny aplikacji obsługuje wyjątek.</span><span class="sxs-lookup"><span data-stu-id="73dfe-149">If you add a handler for the <xref:System.AppDomain.FirstChanceException> event to the default application domain, the event is raised and handled before the default application domain handles the exception.</span></span> <span data-ttu-id="73dfe-150">Aby to zobaczyć, Dodaj kod C# `AppDomain.CurrentDomain.FirstChanceException += FirstChanceException;` (w języku Visual Basic `AddHandler AppDomain.CurrentDomain.FirstChanceException, FirstChanceException`) na początku `Main()`.</span><span class="sxs-lookup"><span data-stu-id="73dfe-150">To see this, add the C# code `AppDomain.CurrentDomain.FirstChanceException += FirstChanceException;` (in Visual Basic, `AddHandler AppDomain.CurrentDomain.FirstChanceException, FirstChanceException`) at the beginning of `Main()`.</span></span>

 [!code-csharp[System.AppDomain.FirstChanceException_howto#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#1)]
 [!code-vb[System.AppDomain.FirstChanceException_howto#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#1)]

## <a name="compiling-the-code"></a><span data-ttu-id="73dfe-151">Kompilowanie kodu</span><span class="sxs-lookup"><span data-stu-id="73dfe-151">Compiling the Code</span></span>

-   <span data-ttu-id="73dfe-152">W tym przykładzie jest aplikacją wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="73dfe-152">This example is a command-line application.</span></span> <span data-ttu-id="73dfe-153">Aby skompilować i uruchomić ten kod w programie Visual Studio, należy dodać kod C# `Console.ReadLine();` (w języku Visual Basic `Console.ReadLine()`) na końcu `Main()`, aby uniemożliwić zamknięcie, zanim może odczytywać dane wyjściowe z okna poleceń.</span><span class="sxs-lookup"><span data-stu-id="73dfe-153">To compile and run this code in Visual Studio, add the C# code `Console.ReadLine();` (in Visual Basic, `Console.ReadLine()`) at the end of `Main()`, to prevent the command window from closing before you can read the output.</span></span>

## <a name="see-also"></a><span data-ttu-id="73dfe-154">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="73dfe-154">See also</span></span>

- <xref:System.AppDomain.FirstChanceException>
