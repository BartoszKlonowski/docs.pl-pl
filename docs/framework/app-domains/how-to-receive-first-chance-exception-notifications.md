---
title: 'Porady: odbieranie powiadomień o wyjątkach pierwszej szansy'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- first-chance exception notifications
- exceptions, first chance notifications
ms.assetid: 66f002b8-a97d-4a6e-a503-2cec01689113
ms.openlocfilehash: da60dfca424f7c10e810b5e083ff7fa63a688218
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/30/2019
ms.locfileid: "73119873"
---
# <a name="how-to-receive-first-chance-exception-notifications"></a><span data-ttu-id="5e790-102">Porady: odbieranie powiadomień o wyjątkach pierwszej szansy</span><span class="sxs-lookup"><span data-stu-id="5e790-102">How to: Receive First-Chance Exception Notifications</span></span>
<span data-ttu-id="5e790-103">Zdarzenie <xref:System.AppDomain.FirstChanceException> klasy <xref:System.AppDomain> pozwala otrzymać powiadomienie, że zgłoszono wyjątek, zanim środowisko uruchomieniowe języka wspólnego rozpoczęło wyszukiwanie obsługi wyjątków.</span><span class="sxs-lookup"><span data-stu-id="5e790-103">The <xref:System.AppDomain.FirstChanceException> event of the <xref:System.AppDomain> class lets you receive a notification that an exception has been thrown, before the common language runtime has begun searching for exception handlers.</span></span>

 <span data-ttu-id="5e790-104">Zdarzenie jest zgłaszane na poziomie domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-104">The event is raised at the application domain level.</span></span> <span data-ttu-id="5e790-105">Wątek wykonywania może przechodzić przez wiele domen aplikacji, więc wyjątek, który jest nieobsługiwany w jednej domenie aplikacji, może być obsługiwany w innej domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-105">A thread of execution can pass through multiple application domains, so an exception that is unhandled in one application domain could be handled in another application domain.</span></span> <span data-ttu-id="5e790-106">Powiadomienie odbywa się w każdej domenie aplikacji, która dodała procedurę obsługi dla zdarzenia, dopóki domena aplikacji obsłuży wyjątek.</span><span class="sxs-lookup"><span data-stu-id="5e790-106">The notification occurs in each application domain that has added a handler for the event, until an application domain handles the exception.</span></span>

 <span data-ttu-id="5e790-107">Procedury i przykłady w tym artykule pokazują, jak odbierać powiadomienia o wyjątkach pierwszej szansy w prostym programie, który ma jedną domenę aplikacji, i w utworzonej domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-107">The procedures and examples in this article show how to receive first-chance exception notifications in a simple program that has one application domain, and in an application domain that you create.</span></span>

 <span data-ttu-id="5e790-108">Aby uzyskać bardziej złożony przykład obejmujący kilka domen aplikacji, zobacz przykład zdarzenia <xref:System.AppDomain.FirstChanceException>.</span><span class="sxs-lookup"><span data-stu-id="5e790-108">For a more complex example that spans several application domains, see the example for the <xref:System.AppDomain.FirstChanceException> event.</span></span>

## <a name="receiving-first-chance-exception-notifications-in-the-default-application-domain"></a><span data-ttu-id="5e790-109">Otrzymywanie powiadomień o wyjątkach pierwszej szansy w domenie domyślnej aplikacji</span><span class="sxs-lookup"><span data-stu-id="5e790-109">Receiving First-Chance Exception Notifications in the Default Application Domain</span></span>
 <span data-ttu-id="5e790-110">W poniższej procedurze punkt wejścia dla aplikacji, Metoda `Main()`, jest uruchamiana w domyślnej domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-110">In the following procedure, the entry point for the application, the `Main()` method, runs in the default application domain.</span></span>

#### <a name="to-demonstrate-first-chance-exception-notifications-in-the-default-application-domain"></a><span data-ttu-id="5e790-111">Aby przedstawić powiadomienia o wyjątkach pierwszej szansy w domenie domyślnej aplikacji</span><span class="sxs-lookup"><span data-stu-id="5e790-111">To demonstrate first-chance exception notifications in the default application domain</span></span>

1. <span data-ttu-id="5e790-112">Zdefiniuj procedurę obsługi zdarzeń dla zdarzenia <xref:System.AppDomain.FirstChanceException> przy użyciu funkcji lambda i Dołącz ją do zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="5e790-112">Define an event handler for the <xref:System.AppDomain.FirstChanceException> event, using a lambda function, and attach it to the event.</span></span> <span data-ttu-id="5e790-113">W tym przykładzie program obsługi zdarzeń drukuje nazwę domeny aplikacji, w której zostało obsłużone zdarzenie, oraz Właściwość <xref:System.Exception.Message%2A> wyjątku.</span><span class="sxs-lookup"><span data-stu-id="5e790-113">In this example, the event handler prints the name of the application domain where the event was handled and the exception's <xref:System.Exception.Message%2A> property.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#2)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#2)]

2. <span data-ttu-id="5e790-114">Zgłoś wyjątek i Przechwyć go.</span><span class="sxs-lookup"><span data-stu-id="5e790-114">Throw an exception and catch it.</span></span> <span data-ttu-id="5e790-115">Zanim środowisko uruchomieniowe odnajdzie procedurę obsługi wyjątków, zostanie zgłoszone zdarzenie <xref:System.AppDomain.FirstChanceException> i zostanie wyświetlony komunikat.</span><span class="sxs-lookup"><span data-stu-id="5e790-115">Before the runtime locates the exception handler, the <xref:System.AppDomain.FirstChanceException> event is raised and displays a message.</span></span> <span data-ttu-id="5e790-116">Po tym komunikacie następuje komunikat, który jest wyświetlany przez program obsługi wyjątków.</span><span class="sxs-lookup"><span data-stu-id="5e790-116">This message is followed by the message that is displayed by the exception handler.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#3](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#3)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#3)]

3. <span data-ttu-id="5e790-117">Zgłoś wyjątek, ale nie należy go przechwycić.</span><span class="sxs-lookup"><span data-stu-id="5e790-117">Throw an exception, but do not catch it.</span></span> <span data-ttu-id="5e790-118">Zanim środowisko uruchomieniowe wyszuka procedurę obsługi wyjątków, zostanie zgłoszone zdarzenie <xref:System.AppDomain.FirstChanceException> i zostanie wyświetlony komunikat.</span><span class="sxs-lookup"><span data-stu-id="5e790-118">Before the runtime looks for an exception handler, the <xref:System.AppDomain.FirstChanceException> event is raised and displays a message.</span></span> <span data-ttu-id="5e790-119">Brak obsługi wyjątków, więc aplikacja kończy działanie.</span><span class="sxs-lookup"><span data-stu-id="5e790-119">There is no exception handler, so the application terminates.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#4](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#4)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#4)]

     <span data-ttu-id="5e790-120">Kod, który jest wyświetlany w pierwszych trzech krokach tej procedury, stanowi kompletną aplikację konsolową.</span><span class="sxs-lookup"><span data-stu-id="5e790-120">The code that is shown in the first three steps of this procedure forms a complete console application.</span></span> <span data-ttu-id="5e790-121">Dane wyjściowe aplikacji różnią się w zależności od nazwy pliku. exe, ponieważ nazwa domyślnej domeny aplikacji składa się z nazwy i rozszerzenia pliku. exe.</span><span class="sxs-lookup"><span data-stu-id="5e790-121">The output from the application varies, depending on the name of the .exe file, because the name of the default application domain consists of the name and extension of the .exe file.</span></span> <span data-ttu-id="5e790-122">Poniżej znajdują się przykładowe dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="5e790-122">See the following for sample output.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#5)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#5)]

## <a name="receiving-first-chance-exception-notifications-in-another-application-domain"></a><span data-ttu-id="5e790-123">Otrzymywanie powiadomień o wyjątkach pierwszej szansy w innej domenie aplikacji</span><span class="sxs-lookup"><span data-stu-id="5e790-123">Receiving First-Chance Exception Notifications in Another Application Domain</span></span>
 <span data-ttu-id="5e790-124">Jeśli program zawiera więcej niż jedną domenę aplikacji, możesz wybrać, które domeny aplikacji mają otrzymywać powiadomienia.</span><span class="sxs-lookup"><span data-stu-id="5e790-124">If your program contains more than one application domain, you can choose which application domains receive notifications.</span></span>

#### <a name="to-receive-first-chance-exception-notifications-in-an-application-domain-that-you-create"></a><span data-ttu-id="5e790-125">Aby otrzymywać powiadomienia o wyjątkach pierwszej szansy w domenie aplikacji, którą tworzysz</span><span class="sxs-lookup"><span data-stu-id="5e790-125">To receive first-chance exception notifications in an application domain that you create</span></span>

1. <span data-ttu-id="5e790-126">Zdefiniuj procedurę obsługi zdarzeń dla zdarzenia <xref:System.AppDomain.FirstChanceException>.</span><span class="sxs-lookup"><span data-stu-id="5e790-126">Define an event handler for the <xref:System.AppDomain.FirstChanceException> event.</span></span> <span data-ttu-id="5e790-127">W tym przykładzie użyto metody `static` (`Shared` Metoda w Visual Basic), która drukuje nazwę domeny aplikacji, w której zostało obsłużone zdarzenie, oraz Właściwość <xref:System.Exception.Message%2A> wyjątku.</span><span class="sxs-lookup"><span data-stu-id="5e790-127">This example uses a `static` method (`Shared` method in Visual Basic) that prints the name of the application domain where the event was handled and the exception's <xref:System.Exception.Message%2A> property.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#3](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#3)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#3)]

2. <span data-ttu-id="5e790-128">Utwórz domenę aplikacji i Dodaj procedurę obsługi zdarzeń do zdarzenia <xref:System.AppDomain.FirstChanceException> dla tej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-128">Create an application domain and add the event handler to the <xref:System.AppDomain.FirstChanceException> event for that application domain.</span></span> <span data-ttu-id="5e790-129">W tym przykładzie domena aplikacji ma nazwę `AD1`.</span><span class="sxs-lookup"><span data-stu-id="5e790-129">In this example, the application domain is named `AD1`.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#2)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#2)]

     <span data-ttu-id="5e790-130">To zdarzenie można obsłużyć w domyślnej domenie aplikacji w taki sam sposób.</span><span class="sxs-lookup"><span data-stu-id="5e790-130">You can handle this event in the default application domain in the same way.</span></span> <span data-ttu-id="5e790-131">Użyj właściwości <xref:System.AppDomain.CurrentDomain%2A?displayProperty=nameWithType> `static` (`Shared` w Visual Basic) w `Main()`, aby uzyskać odwołanie do domyślnej domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-131">Use the `static` (`Shared` in Visual Basic) <xref:System.AppDomain.CurrentDomain%2A?displayProperty=nameWithType> property in `Main()` to get a reference to the default application domain.</span></span>

#### <a name="to-demonstrate-first-chance-exception-notifications-in-the-application-domain"></a><span data-ttu-id="5e790-132">Aby przedstawić powiadomienia o wyjątkach pierwszej szansy w domenie aplikacji</span><span class="sxs-lookup"><span data-stu-id="5e790-132">To demonstrate first-chance exception notifications in the application domain</span></span>

1. <span data-ttu-id="5e790-133">Utwórz obiekt `Worker` w domenie aplikacji utworzonej w poprzedniej procedurze.</span><span class="sxs-lookup"><span data-stu-id="5e790-133">Create a `Worker` object in the application domain that you created in the previous procedure.</span></span> <span data-ttu-id="5e790-134">Klasa `Worker` musi być publiczna i musi pochodzić od <xref:System.MarshalByRefObject>, jak pokazano w kompletnym przykładzie na końcu tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="5e790-134">The `Worker` class must be public, and must derive from <xref:System.MarshalByRefObject>, as shown in the complete example at the end of this article.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#4](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#4)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#4)]

2. <span data-ttu-id="5e790-135">Wywołaj metodę obiektu `Worker`, który zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="5e790-135">Call a method of the `Worker` object that throws an exception.</span></span> <span data-ttu-id="5e790-136">W tym przykładzie metoda `Thrower` jest wywoływana dwukrotnie.</span><span class="sxs-lookup"><span data-stu-id="5e790-136">In this example, the `Thrower` method is called twice.</span></span> <span data-ttu-id="5e790-137">Po raz pierwszy argument metody jest `true`, co powoduje, że metoda przechwytuje swój własny wyjątek.</span><span class="sxs-lookup"><span data-stu-id="5e790-137">The first time, the method argument is `true`, which causes the method to catch its own exception.</span></span> <span data-ttu-id="5e790-138">Drugi raz, argument jest `false`, a metoda `Main()` przechwytuje wyjątek w domyślnej domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-138">The second time, the argument is `false`, and the `Main()` method catches the exception in the default application domain.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#6](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#6)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#6)]

3. <span data-ttu-id="5e790-139">Umieść kod w metodzie `Thrower`, aby określić, czy metoda obsługuje swój własny wyjątek.</span><span class="sxs-lookup"><span data-stu-id="5e790-139">Place code in the `Thrower` method to control whether the method handles its own exception.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#5)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#5)]

## <a name="example"></a><span data-ttu-id="5e790-140">Przykład</span><span class="sxs-lookup"><span data-stu-id="5e790-140">Example</span></span>
 <span data-ttu-id="5e790-141">Poniższy przykład tworzy domenę aplikacji o nazwie `AD1` i dodaje procedurę obsługi zdarzeń do zdarzenia <xref:System.AppDomain.FirstChanceException> domeny aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-141">The following example creates an application domain named `AD1` and adds an event handler to the application domain's <xref:System.AppDomain.FirstChanceException> event.</span></span> <span data-ttu-id="5e790-142">Przykład tworzy wystąpienie klasy `Worker` w domenie aplikacji i wywołuje metodę o nazwie `Thrower`, która zgłasza <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="5e790-142">The example creates an instance of the `Worker` class in the application domain, and calls a method named `Thrower` that throws an <xref:System.ArgumentException>.</span></span> <span data-ttu-id="5e790-143">W zależności od wartości argumentu Metoda przechwytuje wyjątek lub nie można jej obsłużyć.</span><span class="sxs-lookup"><span data-stu-id="5e790-143">Depending on the value of its argument, the method either catches the exception or fails to handle it.</span></span>

 <span data-ttu-id="5e790-144">Za każdym razem, gdy metoda `Thrower` zgłasza wyjątek w `AD1`, zdarzenie <xref:System.AppDomain.FirstChanceException> jest zgłaszane w `AD1`, a program obsługi zdarzeń wyświetla komunikat.</span><span class="sxs-lookup"><span data-stu-id="5e790-144">Each time the `Thrower` method throws an exception in `AD1`, the <xref:System.AppDomain.FirstChanceException> event is raised in `AD1`, and the event handler displays a message.</span></span> <span data-ttu-id="5e790-145">Środowisko uruchomieniowe następnie szuka programu obsługi wyjątków.</span><span class="sxs-lookup"><span data-stu-id="5e790-145">The runtime then looks for an exception handler.</span></span> <span data-ttu-id="5e790-146">W pierwszym przypadku program obsługi wyjątków znajduje się w `AD1`.</span><span class="sxs-lookup"><span data-stu-id="5e790-146">In the first case, the exception handler is found in `AD1`.</span></span> <span data-ttu-id="5e790-147">W drugim przypadku wyjątek jest nieobsługiwany w `AD1`i zamiast tego jest przechwytywany w domyślnej domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e790-147">In the second case, the exception is unhandled in `AD1`, and instead is caught in the default application domain.</span></span>

> [!NOTE]
> <span data-ttu-id="5e790-148">Nazwa domyślnej domeny aplikacji jest taka sama jak nazwa pliku wykonywalnego.</span><span class="sxs-lookup"><span data-stu-id="5e790-148">The name of the default application domain is the same as the name of the executable.</span></span>

 <span data-ttu-id="5e790-149">Jeśli dodasz procedurę obsługi dla zdarzenia <xref:System.AppDomain.FirstChanceException> do domyślnej domeny aplikacji, zdarzenie jest zgłaszane i obsługiwane, zanim domyślna domena aplikacji przechwytuje wyjątek.</span><span class="sxs-lookup"><span data-stu-id="5e790-149">If you add a handler for the <xref:System.AppDomain.FirstChanceException> event to the default application domain, the event is raised and handled before the default application domain handles the exception.</span></span> <span data-ttu-id="5e790-150">Aby to sprawdzić, należy dodać C# kod `AppDomain.CurrentDomain.FirstChanceException += FirstChanceException;` (w Visual Basic `AddHandler AppDomain.CurrentDomain.FirstChanceException, FirstChanceException`) na początku `Main()`.</span><span class="sxs-lookup"><span data-stu-id="5e790-150">To see this, add the C# code `AppDomain.CurrentDomain.FirstChanceException += FirstChanceException;` (in Visual Basic, `AddHandler AppDomain.CurrentDomain.FirstChanceException, FirstChanceException`) at the beginning of `Main()`.</span></span>

 [!code-csharp[System.AppDomain.FirstChanceException_howto#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#1)]
 [!code-vb[System.AppDomain.FirstChanceException_howto#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#1)]

## <a name="see-also"></a><span data-ttu-id="5e790-151">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="5e790-151">See also</span></span>

- <xref:System.AppDomain.FirstChanceException>
