---
title: Kopiowanie zestawów w tle
ms.date: 03/30/2017
helpviewer_keywords:
- assemblies [.NET Framework], shadow copying
- application domains, shadow copying assemblies
- shadow copying assemblies
ms.assetid: de8b8759-fca7-4260-896b-5a4973157672
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: ebec8c880f5b40ed3294585b9be0e83972ac12a7
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/23/2019
ms.locfileid: "54741709"
---
# <a name="shadow-copying-assemblies"></a><span data-ttu-id="faa33-102">Kopiowanie zestawów w tle</span><span class="sxs-lookup"><span data-stu-id="faa33-102">Shadow Copying Assemblies</span></span>
<span data-ttu-id="faa33-103">Kopiowanie zestawów umożliwia, które są używane w domenie aplikacji, należy zaktualizować bez rozładowywania domeny aplikacji w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-103">Shadow copying enables assemblies that are used in an application domain to be updated without unloading the application domain.</span></span> <span data-ttu-id="faa33-104">Jest to szczególnie przydatne w przypadku aplikacji, które muszą być dostępne w sposób ciągły, takich jak witryny programu ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="faa33-104">This is particularly useful for applications that must be available continuously, such as ASP.NET sites.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="faa33-105">Kopiowanie w tle nie jest obsługiwane w [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] aplikacji.</span><span class="sxs-lookup"><span data-stu-id="faa33-105">Shadow copying is not supported in [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps.</span></span>  
  
 <span data-ttu-id="faa33-106">Środowisko uruchomieniowe języka wspólnego blokuje plik zestawu, gdy zestaw jest ładowany, więc nie można zaktualizować pliku, dopóki nie zostanie zwolniony zestawu.</span><span class="sxs-lookup"><span data-stu-id="faa33-106">The common language runtime locks an assembly file when the assembly is loaded, so the file cannot be updated until the assembly is unloaded.</span></span> <span data-ttu-id="faa33-107">Jedynym sposobem, aby zwolnić zestaw z domeny aplikacji jest rozładowywania domeny aplikacji, dzięki czemu w normalnych warunkach, dopóki wszystkie domeny aplikacji, które korzystają z zestawu nie można zaktualizować na dysku zostały usunięte.</span><span class="sxs-lookup"><span data-stu-id="faa33-107">The only way to unload an assembly from an application domain is by unloading the application domain, so under normal circumstances, an assembly cannot be updated on disk until all the application domains that are using it have been unloaded.</span></span>  
  
 <span data-ttu-id="faa33-108">Gdy domeny aplikacji jest skonfigurowany do plików kopii w tle, zestawów w ścieżce aplikacji są kopiowany do innej lokalizacji i załadować z tej lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="faa33-108">When an application domain is configured to shadow copy files, assemblies from the application path are copied to another location and loaded from that location.</span></span> <span data-ttu-id="faa33-109">Kopia jest zablokowany, ale oryginalny plik zestawu jest odblokowana i może zostać zaktualizowany.</span><span class="sxs-lookup"><span data-stu-id="faa33-109">The copy is locked, but the original assembly file is unlocked and can be updated.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="faa33-110">Tylko zestawy, które mogą być kopiowane w tle są te, przechowywane w katalogu aplikacji lub jego podkatalogów określonego przez <xref:System.AppDomainSetup.ApplicationBase%2A> i <xref:System.AppDomainSetup.PrivateBinPath%2A> właściwości, gdy jest skonfigurowana w domenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="faa33-110">The only assemblies that can be shadow copied are those stored in the application directory or its subdirectories, specified by the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> properties when the application domain is configured.</span></span> <span data-ttu-id="faa33-111">Zestawów przechowywanej w globalnej pamięci podręcznej nie są kopiowane w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-111">Assemblies stored in the global assembly cache are not shadow copied.</span></span>  
  
 <span data-ttu-id="faa33-112">Ten artykuł zawiera następujące sekcje:</span><span class="sxs-lookup"><span data-stu-id="faa33-112">This article contains the following sections:</span></span>  
  
-   <span data-ttu-id="faa33-113">[Włączanie i kopiowania w tle za pomocą](#EnablingAndUsing) w tym artykule opisano podstawowe zastosowanie i opcje, które są dostępne dla kopiowania w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-113">[Enabling and Using Shadow Copying](#EnablingAndUsing) describes the basic use and the options that are available for shadow copying.</span></span>  
  
-   <span data-ttu-id="faa33-114">[Startowa wydajność](#StartupPerformance) w tym artykule opisano zmiany wprowadzone do kopiowania w tle [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] Aby zwiększyć wydajność uruchamiania i jak przywrócić działanie wcześniejszych wersji.</span><span class="sxs-lookup"><span data-stu-id="faa33-114">[Startup Performance](#StartupPerformance) describes the changes that are made to shadow copying in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] to improve startup performance, and how to revert to the behavior of earlier versions.</span></span>  
  
-   <span data-ttu-id="faa33-115">[Metody przestarzałe](#ObsoleteMethods) w tym artykule opisano zmiany, które zostały wprowadzone do właściwości i metod tego formantu kopiowanie w tle w [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)].</span><span class="sxs-lookup"><span data-stu-id="faa33-115">[Obsolete Methods](#ObsoleteMethods) describes the changes that were made to the properties and methods that control shadow copying in the [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)].</span></span>  
  
<a name="EnablingAndUsing"></a>   
## <a name="enabling-and-using-shadow-copying"></a><span data-ttu-id="faa33-116">Włączanie i korzystanie z kopiowania w tle</span><span class="sxs-lookup"><span data-stu-id="faa33-116">Enabling and Using Shadow Copying</span></span>  
 <span data-ttu-id="faa33-117">Można użyć właściwości <xref:System.AppDomainSetup> klasy w następujący sposób, aby skonfigurować domenę aplikacji do kopiowania w tle:</span><span class="sxs-lookup"><span data-stu-id="faa33-117">You can use the properties of the <xref:System.AppDomainSetup> class as follows to configure an application domain for shadow copying:</span></span>  
  
-   <span data-ttu-id="faa33-118">Kopiowanie, ustawiając w tle Włącz <xref:System.AppDomainSetup.ShadowCopyFiles%2A> właściwości do wartości ciągu `"true"`.</span><span class="sxs-lookup"><span data-stu-id="faa33-118">Enable shadow copying by setting the <xref:System.AppDomainSetup.ShadowCopyFiles%2A> property to the string value `"true"`.</span></span>  
  
     <span data-ttu-id="faa33-119">Domyślnie to ustawienie powoduje, że wszystkie zestawy ścieżka aplikacji, które mają być kopiowane do pamięci podręcznej pobierania, przed załadowaniem.</span><span class="sxs-lookup"><span data-stu-id="faa33-119">By default, this setting causes all assemblies in the application path to be copied to a download cache before they are loaded.</span></span> <span data-ttu-id="faa33-120">Jest tej samej pamięci podręcznej, obsługiwane przez środowisko uruchomieniowe języka wspólnego do przechowywania plików pobranych z innych komputerów i środowiska uruchomieniowego języka wspólnego automatycznie usuwa pliki, gdy nie są już potrzebne.</span><span class="sxs-lookup"><span data-stu-id="faa33-120">This is the same cache maintained by the common language runtime to store files downloaded from other computers, and the common language runtime automatically deletes the files when they are no longer needed.</span></span>  
  
-   <span data-ttu-id="faa33-121">Opcjonalnie ustaw niestandardową lokalizację plików kopie w tle za pomocą <xref:System.AppDomainSetup.CachePath%2A> właściwości i <xref:System.AppDomainSetup.ApplicationName%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="faa33-121">Optionally set a custom location for shadow copied files by using the <xref:System.AppDomainSetup.CachePath%2A> property and the <xref:System.AppDomainSetup.ApplicationName%2A> property.</span></span>  
  
     <span data-ttu-id="faa33-122">Podstawowa ścieżka lokalizacji jest tworzona przez złączenie <xref:System.AppDomainSetup.ApplicationName%2A> właściwość <xref:System.AppDomainSetup.CachePath%2A> właściwość jako podkatalogu.</span><span class="sxs-lookup"><span data-stu-id="faa33-122">The base path for the location is formed by concatenating the <xref:System.AppDomainSetup.ApplicationName%2A> property to the <xref:System.AppDomainSetup.CachePath%2A> property as a subdirectory.</span></span> <span data-ttu-id="faa33-123">Zestawy są kopiowane do podkatalogów tej ścieżki, aby sama ścieżka podstawowa nie w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-123">Assemblies are shadow copied to subdirectories of this path, not to the base path itself.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="faa33-124">Jeśli <xref:System.AppDomainSetup.ApplicationName%2A> nie ustawiono właściwości <xref:System.AppDomainSetup.CachePath%2A> właściwość jest ignorowana, a pamięć podręczna pobierania jest używana.</span><span class="sxs-lookup"><span data-stu-id="faa33-124">If the <xref:System.AppDomainSetup.ApplicationName%2A> property is not set, the <xref:System.AppDomainSetup.CachePath%2A> property is ignored and the download cache is used.</span></span> <span data-ttu-id="faa33-125">Jest zgłaszany żaden wyjątek.</span><span class="sxs-lookup"><span data-stu-id="faa33-125">No exception is thrown.</span></span>  
  
     <span data-ttu-id="faa33-126">Jeśli określisz niestandardową lokalizację, jest odpowiedzialny za czyszczenie katalogów i skopiować pliki, gdy nie są już potrzebne.</span><span class="sxs-lookup"><span data-stu-id="faa33-126">If you specify a custom location, you are responsible for cleaning up the directories and copied files when they are no longer needed.</span></span> <span data-ttu-id="faa33-127">Nie są automatycznie usuwane.</span><span class="sxs-lookup"><span data-stu-id="faa33-127">They are not deleted automatically.</span></span>  
  
     <span data-ttu-id="faa33-128">Istnieje kilka powodów dlaczego warto ustawić niestandardową lokalizację plików kopie w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-128">There are a few reasons why you might want to set a custom location for shadow copied files.</span></span> <span data-ttu-id="faa33-129">Można ustawić niestandardową lokalizację plików kopie w tle, jeśli aplikacja generuje dużą liczbę kopii.</span><span class="sxs-lookup"><span data-stu-id="faa33-129">You might want to set a custom location for shadow copied files if your application generates a large number of copies.</span></span> <span data-ttu-id="faa33-130">Pamięć podręczna pobierania jest ograniczona przez rozmiar, a nie przez okres istnienia, więc jest możliwe, że środowisko uruchomieniowe języka wspólnego podejmie próbę usunięcia pliku, który jest używany.</span><span class="sxs-lookup"><span data-stu-id="faa33-130">The download cache is limited by size, not by lifetime, so it is possible that the common language runtime will attempt to delete a file that is still in use.</span></span> <span data-ttu-id="faa33-131">Kolejny powód, aby ustawić niestandardową lokalizację jest, gdy użytkownicy korzystający z aplikacji nie mieć dostęp do zapisu na lokalizację katalogu, w której środowisko uruchomieniowe języka wspólnego używa pamięci podręcznej pobierania.</span><span class="sxs-lookup"><span data-stu-id="faa33-131">Another reason to set a custom location is when users running your application do not have write access to the directory location the common language runtime uses for the download cache.</span></span>  
  
-   <span data-ttu-id="faa33-132">Opcjonalnie ogranicz zestawy, które są kopie w tle woluminów przy użyciu <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="faa33-132">Optionally limit the assemblies that are shadow copied by using the <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> property.</span></span>  
  
     <span data-ttu-id="faa33-133">Po włączeniu kopiowania w tle dla domeny aplikacji, wartość domyślna to do skopiowania wszystkich zestawów w ścieżce aplikacji — czyli w katalogi określone przez <xref:System.AppDomainSetup.ApplicationBase%2A> i <xref:System.AppDomainSetup.PrivateBinPath%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="faa33-133">When you enable shadow copying for an application domain, the default is to copy all assemblies in the application path — that is, in the directories specified by the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> properties.</span></span> <span data-ttu-id="faa33-134">Można ograniczyć kopiowanie do wybranych katalogów, tworząc ciąg, który zawiera tylko te katalogi, które chcesz umieścić w kopii w tle i przypisywanie ciąg <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> właściwości.</span><span class="sxs-lookup"><span data-stu-id="faa33-134">You can limit the copying to selected directories by creating a string that contains only those directories you want to shadow copy, and assigning the string to the <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> property.</span></span> <span data-ttu-id="faa33-135">Katalogi należy oddzielić średnikami.</span><span class="sxs-lookup"><span data-stu-id="faa33-135">Separate the directories with semicolons.</span></span> <span data-ttu-id="faa33-136">Tylko zestawy, które są kopiowane w tle są pokazane w wybranych katalogów.</span><span class="sxs-lookup"><span data-stu-id="faa33-136">The only assemblies that are shadow copied are the ones in the selected directories.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="faa33-137">Jeśli nie przypiszesz ciąg <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> właściwości, lub jeśli ta właściwość jest ustawiona na `null`, wszystkie zestawy w katalogi określone przez <xref:System.AppDomainSetup.ApplicationBase%2A> i <xref:System.AppDomainSetup.PrivateBinPath%2A> właściwości są kopie w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-137">If you don’t assign a string to the <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> property, or if you set this property to `null`, all assemblies in the directories specified by the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> properties are shadow copied.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="faa33-138">Ścieżek katalogów nie mogą zawierać średnikami, ponieważ znajduje się znak ogranicznika.</span><span class="sxs-lookup"><span data-stu-id="faa33-138">Directory paths must not contain semicolons, because the semicolon is the delimiter character.</span></span> <span data-ttu-id="faa33-139">Nie ma żadnych znak ucieczki dla średnikami.</span><span class="sxs-lookup"><span data-stu-id="faa33-139">There is no escape character for semicolons.</span></span>  
  
<a name="StartupPerformance"></a>   
## <a name="startup-performance"></a><span data-ttu-id="faa33-140">Startowa wydajność</span><span class="sxs-lookup"><span data-stu-id="faa33-140">Startup Performance</span></span>  
 <span data-ttu-id="faa33-141">Po uruchomieniu domeny aplikacji, która używa kopiowania w tle występuje opóźnienie podczas zestawów w katalogu aplikacji są kopiowane do katalogu kopii w tle lub zweryfikować, czy są już w tej lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="faa33-141">When an application domain that uses shadow copying starts, there is a delay while assemblies in the application directory are copied to the shadow copy directory, or verified if they are already in that location.</span></span> <span data-ttu-id="faa33-142">Przed [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], wszystkie zestawy zostały skopiowane do katalogu tymczasowego.</span><span class="sxs-lookup"><span data-stu-id="faa33-142">Before the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], all assemblies were copied to a temporary directory.</span></span> <span data-ttu-id="faa33-143">Każdy zestaw został otwarty, aby sprawdzić nazwę zestawu, a została zweryfikowana silnej nazwy.</span><span class="sxs-lookup"><span data-stu-id="faa33-143">Each assembly was opened to verify the assembly name, and the strong name was validated.</span></span> <span data-ttu-id="faa33-144">Każdy zestaw została sprawdzona czy miał został zaktualizowany niedawno kopiowania w katalogu kopii w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-144">Each assembly was checked to see whether it had been updated more recently than the copy in the shadow copy directory.</span></span> <span data-ttu-id="faa33-145">Jeśli tak, został skopiowany do katalogu kopii w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-145">If so, it was copied to the shadow copy directory.</span></span> <span data-ttu-id="faa33-146">Na koniec tymczasowej kopii zostały odrzucone.</span><span class="sxs-lookup"><span data-stu-id="faa33-146">Finally, the temporary copies were discarded.</span></span>  
  
 <span data-ttu-id="faa33-147">Począwszy od [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], domyślne zachowanie uruchamiania jest bezpośrednio porównanie pliku Data i godzina każdego zestawu w katalogu aplikacji przy użyciu pliku daty i czasu kopiowania w katalogu kopii w tle.</span><span class="sxs-lookup"><span data-stu-id="faa33-147">Beginning with the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], the default startup behavior is to directly compare the file date and time of each assembly in the application directory with the file date and time of the copy in the shadow copy directory.</span></span> <span data-ttu-id="faa33-148">Jeśli zestaw został zaktualizowany, jest kopiowany przy użyciu tej samej procedury jak w starszych wersjach programu .NET Framework; w przeciwnym razie kopia w katalogu kopii w tle jest ładowany.</span><span class="sxs-lookup"><span data-stu-id="faa33-148">If the assembly has been updated, it is copied by using the same procedure as in earlier versions of the .NET Framework; otherwise, the copy in the shadow copy directory is loaded.</span></span>  
  
 <span data-ttu-id="faa33-149">Wynikowy wzrost wydajności jest największy dla aplikacji, w których zestawy nie zmieniają się często, a zmiany są zazwyczaj występuje w mały podzbiór zestawów.</span><span class="sxs-lookup"><span data-stu-id="faa33-149">The resulting performance improvement is largest for applications in which assemblies do not change frequently and changes usually occur in a small subset of assemblies.</span></span> <span data-ttu-id="faa33-150">Większość zestawów w zmiany aplikacji są często nowe zachowanie może spowodować regresji wydajności.</span><span class="sxs-lookup"><span data-stu-id="faa33-150">If a majority of assemblies in an application change frequently, the new default behavior might cause a performance regression.</span></span> <span data-ttu-id="faa33-151">Można przywrócić zachowanie uruchamiania z poprzednich wersji programu .NET Framework, dodając [ \<shadowCopyVerifyByTimestamp > element](../../../docs/framework/configure-apps/file-schema/runtime/shadowcopyverifybytimestamp-element.md) do pliku konfiguracji z `enabled="false"`.</span><span class="sxs-lookup"><span data-stu-id="faa33-151">You can restore the startup behavior of previous versions of the .NET Framework by adding the [\<shadowCopyVerifyByTimestamp> element](../../../docs/framework/configure-apps/file-schema/runtime/shadowcopyverifybytimestamp-element.md) to the configuration file, with `enabled="false"`.</span></span>  
  
<a name="ObsoleteMethods"></a>   
## <a name="obsolete-methods"></a><span data-ttu-id="faa33-152">Metody przestarzałe</span><span class="sxs-lookup"><span data-stu-id="faa33-152">Obsolete Methods</span></span>  
 <span data-ttu-id="faa33-153"><xref:System.AppDomain> Klasa ma kilka metod, takich jak <xref:System.AppDomain.SetShadowCopyFiles%2A> i <xref:System.AppDomain.ClearShadowCopyPath%2A>, który może służyć do kontrolowania kopiowania w tle na domenę aplikacji, ale te zostały oznaczone jako przestarzałe w programie .NET Framework w wersji 2.0.</span><span class="sxs-lookup"><span data-stu-id="faa33-153">The <xref:System.AppDomain> class has several methods, such as <xref:System.AppDomain.SetShadowCopyFiles%2A> and <xref:System.AppDomain.ClearShadowCopyPath%2A>, that can be used to control shadow copying on an application domain, but these have been marked obsolete in the .NET Framework version 2.0.</span></span> <span data-ttu-id="faa33-154">Zalecanym sposobem konfigurowanie domeny aplikacji, w przypadku kopiowania w tle jest użycie właściwości <xref:System.AppDomainSetup> klasy.</span><span class="sxs-lookup"><span data-stu-id="faa33-154">The recommended way to configure an application domain for shadow copying is to use the properties of the <xref:System.AppDomainSetup> class.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="faa33-155">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="faa33-155">See also</span></span>
- <xref:System.AppDomainSetup.ShadowCopyFiles%2A?displayProperty=nameWithType>
- <xref:System.AppDomainSetup.CachePath%2A?displayProperty=nameWithType>
- <xref:System.AppDomainSetup.ApplicationName%2A?displayProperty=nameWithType>
- <xref:System.AppDomainSetup.ShadowCopyDirectories%2A?displayProperty=nameWithType>
- [<span data-ttu-id="faa33-156">\<shadowCopyVerifyByTimestamp > Element</span><span class="sxs-lookup"><span data-stu-id="faa33-156">\<shadowCopyVerifyByTimestamp> Element</span></span>](../../../docs/framework/configure-apps/file-schema/runtime/shadowcopyverifybytimestamp-element.md)
