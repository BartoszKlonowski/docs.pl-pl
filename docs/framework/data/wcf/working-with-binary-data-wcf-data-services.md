---
title: Praca z danymi binarnymi (Usługi danych programu WCF)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, binary data
- WCF Data Services, streams
ms.assetid: aeccc45c-d5c5-4671-ad63-a492ac8043ac
ms.openlocfilehash: 3c391e641df52d9143630406a40e17c6bc853865
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/15/2020
ms.locfileid: "90551754"
---
# <a name="working-with-binary-data-wcf-data-services"></a><span data-ttu-id="b7687-102">Praca z danymi binarnymi (Usługi danych programu WCF)</span><span class="sxs-lookup"><span data-stu-id="b7687-102">Working with Binary Data (WCF Data Services)</span></span>

<span data-ttu-id="b7687-103">Biblioteka klienta Usługi danych programu WCF umożliwia pobieranie i aktualizowanie danych binarnych za pomocą źródła danych Open Data Protocol (OData) w jeden z następujących sposobów:</span><span class="sxs-lookup"><span data-stu-id="b7687-103">The WCF Data Services client library enables you to retrieve and update binary data from an Open Data Protocol (OData) feed in one of the following ways:</span></span>

- <span data-ttu-id="b7687-104">Jako właściwość typu pierwotnego jednostki.</span><span class="sxs-lookup"><span data-stu-id="b7687-104">As a primitive type property of an entity.</span></span> <span data-ttu-id="b7687-105">Jest to zalecana metoda pracy z małymi obiektami danych binarnych, które można łatwo załadować do pamięci.</span><span class="sxs-lookup"><span data-stu-id="b7687-105">This is the recommended method for working with small binary data objects that can be easily loaded into memory.</span></span> <span data-ttu-id="b7687-106">W tym przypadku Właściwość Binary jest właściwością jednostki uwidocznioną przez model danych, a usługa danych serializować dane binarne jako plik binarny z kodowaniem Base-64 w komunikacie odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="b7687-106">In this case, the binary property is an entity property exposed by the data model, and the data service serializes the binary data as base-64 binary encoded XML in the response message.</span></span>

- <span data-ttu-id="b7687-107">Jako oddzielny strumień zasobów binarnych.</span><span class="sxs-lookup"><span data-stu-id="b7687-107">As a separate binary resource stream.</span></span> <span data-ttu-id="b7687-108">Jest to zalecana metoda do uzyskiwania dostępu do danych binarnych dużych obiektów (BLOB), które mogą reprezentować zdjęcia, wideo lub dowolnego innego typu binarne dane zakodowane.</span><span class="sxs-lookup"><span data-stu-id="b7687-108">This is the recommended method for accessing and changing binary large object (BLOB) data that may represent a photo, video, or any other type of binary encoded data.</span></span>

<span data-ttu-id="b7687-109">Usługi danych programu WCF implementuje przesyłanie strumieniowe danych binarnych przy użyciu protokołu HTTP zgodnie z definicją w protokole OData.</span><span class="sxs-lookup"><span data-stu-id="b7687-109">WCF Data Services implements the streaming of binary data by using HTTP as defined in the OData.</span></span> <span data-ttu-id="b7687-110">W tym mechanizmie dane binarne są traktowane jako zasób multimedialny, który jest oddzielony od, ale związany z jednostką, która jest nazywana wpisem multimediów.</span><span class="sxs-lookup"><span data-stu-id="b7687-110">In this mechanism, binary data is treated as a media resource that is separate from but related to an entity, which is called a media link entry.</span></span> <span data-ttu-id="b7687-111">Aby uzyskać więcej informacji, zobacz [dostawca przesyłania strumieniowego](streaming-provider-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="b7687-111">For more information, see [Streaming Provider](streaming-provider-wcf-data-services.md).</span></span>

> [!TIP]
> <span data-ttu-id="b7687-112">Aby zapoznać się z przykładem krok po kroku, jak utworzyć aplikację kliencką Windows Presentation Foundation (WPF), która pobiera pliki obrazów binarnych z usługi OData, która przechowuje zdjęcia, zobacz wpis [Data Services dostawcy przesyłania strumieniowego — część 2: uzyskiwanie dostępu do strumienia zasobów multimediów z klienta](/archive/blogs/astoriateam/data-services-streaming-provider-series-part-2-accessing-a-media-resource-stream-from-the-client)programu.</span><span class="sxs-lookup"><span data-stu-id="b7687-112">For a step-by-step example of how to create a Windows Presentation Foundation (WPF) client application that downloads binary image files from an OData service that stores photos, see the post [Data Services Streaming Provider Series-Part 2: Accessing a Media Resource Stream from the Client](/archive/blogs/astoriateam/data-services-streaming-provider-series-part-2-accessing-a-media-resource-stream-from-the-client).</span></span> <span data-ttu-id="b7687-113">Aby pobrać przykładowy kod dla usługi Stream Data Service polecanej w blogu, zobacz [przykład usługi przesyłania strumieniowego Streaming](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample) w witrynie GitHub.</span><span class="sxs-lookup"><span data-stu-id="b7687-113">To download the sample code for the stream photo data service featured in the blog post, see the [Streaming Photo Data Service Sample](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample) in GitHub.</span></span>

## <a name="entity-metadata"></a><span data-ttu-id="b7687-114">Metadane jednostki</span><span class="sxs-lookup"><span data-stu-id="b7687-114">Entity Metadata</span></span>

<span data-ttu-id="b7687-115">Jednostka, która ma powiązany strumień zasobów multimediów, jest wskazywany w metadanych usługi danych przez `HasStream` atrybut zastosowany do typu jednostki, który jest wpisem linku do nośnika.</span><span class="sxs-lookup"><span data-stu-id="b7687-115">An entity that has a related media resource stream is indicated in the data service metadata by the `HasStream` attribute applied to an entity type that is the media link entry.</span></span> <span data-ttu-id="b7687-116">W poniższym przykładzie `PhotoInfo` jednostką jest wpis linku do nośnika z powiązanym zasobem multimedialnym wskazywanym przez `HasStream` atrybut.</span><span class="sxs-lookup"><span data-stu-id="b7687-116">In the following example, the `PhotoInfo` entity is a media link entry that has a related media resource, indicated by the `HasStream` attribute.</span></span>

[!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria_photo_streaming_service/xml/photodata.edmx#hasstream)]

<span data-ttu-id="b7687-117">Pozostałe przykłady w tym temacie pokazują, jak uzyskać dostęp do strumienia zasobów multimediów i zmienić go.</span><span class="sxs-lookup"><span data-stu-id="b7687-117">The remaining examples in this topic show how to access and change the media resource stream.</span></span> <span data-ttu-id="b7687-118">Aby zapoznać się z kompletnym przykładem użycia strumienia zasobów multimediów w .NET Framework aplikacji klienckiej przy użyciu biblioteki klienta Usługi danych programu WCF, zobacz temat Wysyłanie [dostępu do strumienia zasobów multimediów z klienta](/archive/blogs/astoriateam/data-services-streaming-provider-series-part-2-accessing-a-media-resource-stream-from-the-client).</span><span class="sxs-lookup"><span data-stu-id="b7687-118">For a complete example of how to consume a media resource stream in a .NET Framework client application by using the WCF Data Services client library, see the post [Accessing a Media Resource Stream from the Client](/archive/blogs/astoriateam/data-services-streaming-provider-series-part-2-accessing-a-media-resource-stream-from-the-client).</span></span>

## <a name="accessing-the-binary-resource-stream"></a><span data-ttu-id="b7687-119">Uzyskiwanie dostępu do strumienia zasobów binarnych</span><span class="sxs-lookup"><span data-stu-id="b7687-119">Accessing the Binary Resource Stream</span></span>

<span data-ttu-id="b7687-120">Biblioteka klienta Usługi danych programu WCF zapewnia metody uzyskiwania dostępu do strumieni zasobów binarnych z usługi danych opartych na protokole OData.</span><span class="sxs-lookup"><span data-stu-id="b7687-120">The WCF Data Services client library provides methods for accessing binary resource streams from an OData-based data service.</span></span> <span data-ttu-id="b7687-121">Podczas pobierania zasobu multimedialnego można użyć identyfikatora URI zasobu multimedialnego lub uzyskać strumień binarny, który zawiera same dane zasobów multimedialnych.</span><span class="sxs-lookup"><span data-stu-id="b7687-121">When downloading a media resource, you can either use the URI of the media resource or you can get a binary stream that contains the media resource data itself.</span></span> <span data-ttu-id="b7687-122">Możesz również przekazać dane zasobów multimedialnych jako strumień binarny.</span><span class="sxs-lookup"><span data-stu-id="b7687-122">You can also upload media resource data as a binary stream.</span></span>

> [!TIP]
> <span data-ttu-id="b7687-123">Aby zapoznać się z przykładem krok po kroku, jak utworzyć aplikację kliencką Windows Presentation Foundation (WPF), która pobiera pliki obrazów binarnych z usługi OData, która przechowuje zdjęcia, zobacz wpis [Data Services dostawcy przesyłania strumieniowego — część 2: uzyskiwanie dostępu do strumienia zasobów multimediów z klienta](/archive/blogs/astoriateam/data-services-streaming-provider-series-part-2-accessing-a-media-resource-stream-from-the-client)programu.</span><span class="sxs-lookup"><span data-stu-id="b7687-123">For a step-by-step example of how to create a Windows Presentation Foundation (WPF) client application that downloads binary image files from an OData service that stores photos, see the post [Data Services Streaming Provider Series-Part 2: Accessing a Media Resource Stream from the Client](/archive/blogs/astoriateam/data-services-streaming-provider-series-part-2-accessing-a-media-resource-stream-from-the-client).</span></span> <span data-ttu-id="b7687-124">Aby pobrać przykładowy kod dla usługi Stream Data Service polecanej w blogu, zobacz [przykład usługi przesyłania strumieniowego Streaming](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample) w witrynie GitHub.</span><span class="sxs-lookup"><span data-stu-id="b7687-124">To download the sample code for the stream photo data service featured in the blog post, see the [Streaming Photo Data Service Sample](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample) in GitHub.</span></span>

### <a name="getting-the-uri-of-the-binary-stream"></a><span data-ttu-id="b7687-125">Pobieranie identyfikatora URI strumienia binarnego</span><span class="sxs-lookup"><span data-stu-id="b7687-125">Getting the URI of the Binary Stream</span></span>

<span data-ttu-id="b7687-126">Podczas pobierania niektórych typów zasobów multimedialnych, takich jak obrazy i inne pliki multimedialne, często łatwiej jest używać identyfikatora URI zasobu multimedialnego w aplikacji niż obsługa samego strumienia danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="b7687-126">When retrieving certain types of media resources, such as images and other media files, it is often easier to use the URI of the media resource in your application than handling the binary data stream itself.</span></span> <span data-ttu-id="b7687-127">Aby uzyskać identyfikator URI strumienia zasobów skojarzonego z wpisem "Udostępnij multimedia link", należy wywołać <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> metodę w <xref:System.Data.Services.Client.DataServiceContext> wystąpieniu, które śledzi jednostkę.</span><span class="sxs-lookup"><span data-stu-id="b7687-127">To get the URI of a resource stream associated with a give media link entry, you must call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance that is tracking the entity.</span></span> <span data-ttu-id="b7687-128">Poniższy przykład pokazuje, jak wywołać metodę, <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> Aby uzyskać identyfikator URI strumienia zasobów multimediów używanego do tworzenia nowego obrazu na kliencie:</span><span class="sxs-lookup"><span data-stu-id="b7687-128">The following example shows how to call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> method to get the URI of a media resource stream that is used to create a new image on the client:</span></span>

[!code-csharp[Astoria Photo Streaming Client#GetReadStreamUri](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_photo_streaming_client/cs/photowindow.xaml.cs#getreadstreamuri)]
[!code-vb[Astoria Photo Streaming Client#GetReadStreamUri](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_photo_streaming_client/vb/photowindow.xaml.vb#getreadstreamuri)]

### <a name="downloading-the-binary-resource-stream"></a><span data-ttu-id="b7687-129">Pobieranie strumienia zasobów binarnych</span><span class="sxs-lookup"><span data-stu-id="b7687-129">Downloading the Binary Resource Stream</span></span>

<span data-ttu-id="b7687-130">Podczas pobierania strumienia zasobów binarnych należy wywołać <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> metodę w <xref:System.Data.Services.Client.DataServiceContext> wystąpieniu, które śledzi wpis linku do nośnika.</span><span class="sxs-lookup"><span data-stu-id="b7687-130">When retrieving a binary resource stream, you must call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance that is tracking the media link entry.</span></span> <span data-ttu-id="b7687-131">Ta metoda wysyła żądanie do usługi danych, która zwraca <xref:System.Data.Services.Client.DataServiceStreamResponse> obiekt, który zawiera odwołanie do strumienia zawierającego zasób.</span><span class="sxs-lookup"><span data-stu-id="b7687-131">This method sends a request to the data service that returns a <xref:System.Data.Services.Client.DataServiceStreamResponse> object, which has a reference to the stream that contains the resource.</span></span> <span data-ttu-id="b7687-132">Tej metody należy użyć, gdy aplikacja wymaga zasobu binarnego jako <xref:System.IO.Stream> .</span><span class="sxs-lookup"><span data-stu-id="b7687-132">Use this method when your application requires the binary resource as a <xref:System.IO.Stream>.</span></span> <span data-ttu-id="b7687-133">Poniższy przykład pokazuje, jak wywołać metodę, <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> Aby pobrać strumień, który jest używany do tworzenia nowego obrazu na kliencie:</span><span class="sxs-lookup"><span data-stu-id="b7687-133">The following example shows how to call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method to retrieve a stream that is used to create a new image on the client:</span></span>

[!code-csharp[Astoria Streaming Client#GetReadStreamClient](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_streaming_client/cs/customerphotowindow.xaml.cs#getreadstreamclient)]
[!code-vb[Astoria Streaming Client#GetReadStreamClient](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_streaming_client/vb/customerphotowindow.xaml.vb#getreadstreamclient)]

> [!NOTE]
> <span data-ttu-id="b7687-134">Nagłówek Content-Length w komunikacie odpowiedzi zawierającym parę binarną nie jest ustawiony przez usługę danych.</span><span class="sxs-lookup"><span data-stu-id="b7687-134">The Content-Length header in the response message that contains the binary steam is not set by the data service.</span></span> <span data-ttu-id="b7687-135">Ta wartość nie może odzwierciedlać rzeczywistej długości strumienia danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="b7687-135">This value may not reflect the actual length of the binary data stream.</span></span>

### <a name="uploading-a-media-resource-as-a-stream"></a><span data-ttu-id="b7687-136">Przekazywanie zasobu multimedialnego jako strumienia</span><span class="sxs-lookup"><span data-stu-id="b7687-136">Uploading a Media Resource as a Stream</span></span>

<span data-ttu-id="b7687-137">Aby wstawić lub zaktualizować zasób multimedialny, wywołaj <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> metodę w <xref:System.Data.Services.Client.DataServiceContext> wystąpieniu, które śledzi jednostkę.</span><span class="sxs-lookup"><span data-stu-id="b7687-137">To insert or update a media resource, call the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance that is tracking the entity.</span></span> <span data-ttu-id="b7687-138">Ta metoda wysyła żądanie do usługi danych zawierającej zasób nośnika odczytany z podanego strumienia.</span><span class="sxs-lookup"><span data-stu-id="b7687-138">This method sends a request to the data service that contains the media resource read from the supplied stream.</span></span> <span data-ttu-id="b7687-139">Poniższy przykład pokazuje, jak wywołać <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> metodę w celu wysłania obrazu do usługi danych:</span><span class="sxs-lookup"><span data-stu-id="b7687-139">The following example shows how to call the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method to send an image to the data service:</span></span>

[!code-csharp[Astoria Photo Streaming Client#SetSaveStream](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_photo_streaming_client/cs/photodetailswindow.xaml.cs#setsavestream)]
[!code-vb[Astoria Photo Streaming Client#SetSaveStream](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_photo_streaming_client/vb/photodetailswindow.xaml.vb#setsavestream)]

<span data-ttu-id="b7687-140">W tym przykładzie <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> Metoda jest wywoływana przez dostarczenie wartości `true` `closeStream` parametru.</span><span class="sxs-lookup"><span data-stu-id="b7687-140">In this example, the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method is called by supplying a value of `true` for the `closeStream` parameter.</span></span> <span data-ttu-id="b7687-141">Gwarantuje to, że <xref:System.Data.Services.Client.DataServiceContext> Zamknięcie strumienia po danych binarnych zostanie przekazane do usługi danych.</span><span class="sxs-lookup"><span data-stu-id="b7687-141">This guarantees that the <xref:System.Data.Services.Client.DataServiceContext> closes the stream after the binary data is uploaded to the data service.</span></span>

> [!NOTE]
> <span data-ttu-id="b7687-142">Po wywołaniu <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> , strumień nie jest wysyłany do usługi danych do momentu wywołania <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> .</span><span class="sxs-lookup"><span data-stu-id="b7687-142">When you call <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A>, the stream is not sent to the data service until <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> is called.</span></span>

## <a name="see-also"></a><span data-ttu-id="b7687-143">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="b7687-143">See also</span></span>

- [<span data-ttu-id="b7687-144">Biblioteka klienta usług danych WCF</span><span class="sxs-lookup"><span data-stu-id="b7687-144">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)
- [<span data-ttu-id="b7687-145">Wiązanie danych z kontrolką</span><span class="sxs-lookup"><span data-stu-id="b7687-145">Binding Data to Controls</span></span>](binding-data-to-controls-wcf-data-services.md)
