---
title: Dostawca przesyłania strumieniowego (usługi danych WCF)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, providers
- WCF Data Services, binary data
- streaming data provider [WCF Data Services]
- WCF Data Services, streams
ms.assetid: f0978fe4-5f9f-42aa-a5c2-df395d7c9495
ms.openlocfilehash: d65ea58bc2e98ab2607ce105b496ac0a870362b0
ms.sourcegitcommit: 15109844229ade1c6449f48f3834db1b26907824
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/07/2018
ms.locfileid: "33805476"
---
# <a name="streaming-provider-wcf-data-services"></a><span data-ttu-id="35c8b-102">Dostawca przesyłania strumieniowego (usługi danych WCF)</span><span class="sxs-lookup"><span data-stu-id="35c8b-102">Streaming Provider (WCF Data Services)</span></span>
<span data-ttu-id="35c8b-103">Usługi danych mogą uwidaczniać dużego obiektu binarnego danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-103">A data service can expose large object binary data.</span></span> <span data-ttu-id="35c8b-104">Te dane binarne może reprezentować strumienie audio i wideo, obrazów, plików dokumentów lub binarne nośników innych typów.</span><span class="sxs-lookup"><span data-stu-id="35c8b-104">This binary data might represent video and audio streams, images, document files, or other types of binary media.</span></span> <span data-ttu-id="35c8b-105">Kiedy jednostki w modelu danych obejmuje co najmniej jednej właściwości binarnych, Usługa danych zwraca to dane binarne zakodowane jako base-64 wewnątrz wpis w odpowiedzi źródła danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-105">When an entity in the data model includes one or more binary properties, the data service returns this binary data encoded as base-64 inside the entry in the response feed.</span></span> <span data-ttu-id="35c8b-106">Ponieważ ładowanie i serializacji dużych danych binarnych w ten sposób może wpłynąć na wydajność, [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] definiuje mechanizm służący do pobierania danych binarnych, niezależnie od podmiotu, do którego należy.</span><span class="sxs-lookup"><span data-stu-id="35c8b-106">Because loading and serializing large binary data in this manner can affect performance, the [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] defines a mechanism for retrieving binary data independent of the entity to which it belongs.</span></span> <span data-ttu-id="35c8b-107">Jest to osiągane przez rozdzielić danych binarnych z jednostki jeden lub więcej strumieni danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-107">This is accomplished by separating the binary data from the entity into one or more data streams.</span></span>  
  
-   <span data-ttu-id="35c8b-108">Zasób Media - danych binarnych, który należy do jednostki, takich jak wideo, audio, obrazu lub inny typ nośnika strumienia zasobów.</span><span class="sxs-lookup"><span data-stu-id="35c8b-108">Media resource - binary data that belongs to an entity, such as a video, audio, image or other type of media resource stream.</span></span>  
  
-   <span data-ttu-id="35c8b-109">Wpis - jednostki, która odwołuje się do strumienia zasobu powiązane z łącza nośnika.</span><span class="sxs-lookup"><span data-stu-id="35c8b-109">Media link entry - an entity that has a reference to a related media resource stream.</span></span>  
  
 <span data-ttu-id="35c8b-110">Z [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], zdefiniuj strumienia zasobów binarnych zaimplementowanie przesyłania strumieniowego dostawcy danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-110">With [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], you define a binary resource stream by implementing a streaming data provider.</span></span> <span data-ttu-id="35c8b-111">Przesyłania strumieniowego implementacja dostawcy udostępnia usługę danych ze strumienia zasobów nośnika skojarzony z wybraną jednostką jako <xref:System.IO.Stream> obiektu.</span><span class="sxs-lookup"><span data-stu-id="35c8b-111">The streaming provider implementation supplies the data service with the media resource stream associated with a specific entity as an <xref:System.IO.Stream> object.</span></span> <span data-ttu-id="35c8b-112">Ta implementacja umożliwia usłudze danych Zaakceptuj i zwracać zasobów multimedialnych za pośrednictwem protokołu HTTP jako strumieni danych binarnych określonego typu MIME.</span><span class="sxs-lookup"><span data-stu-id="35c8b-112">This implementation enables the data service to accept and return media resources over HTTP as binary data streams of a specified MIME type.</span></span>  
  
 <span data-ttu-id="35c8b-113">Konfigurowanie usługi danych do obsługi przesyłanie strumieniowe danych binarnych wymaga wykonania następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="35c8b-113">Configuring a data service to support the streaming of binary data requires the following steps:</span></span>  
  
1.  <span data-ttu-id="35c8b-114">Atrybut co najmniej jedna jednostka w modelu danych, zgodnie z wpisem łącza nośnika.</span><span class="sxs-lookup"><span data-stu-id="35c8b-114">Attribute one or more entities in the data model as a media link entry.</span></span> <span data-ttu-id="35c8b-115">Te jednostki nie może zawierać danych binarnych w przesyłane strumieniowo.</span><span class="sxs-lookup"><span data-stu-id="35c8b-115">These entities should not include the binary data to be streamed.</span></span> <span data-ttu-id="35c8b-116">Wszystkie właściwości binarnych jednostki są zawsze zwracane we wpisie jako algorytmem base-64 binarnego.</span><span class="sxs-lookup"><span data-stu-id="35c8b-116">Any binary properties of an entity are always returned in the entry as base-64 encoded binary.</span></span>  
  
2.  <span data-ttu-id="35c8b-117">Zaimplementuj interfejs T:System.Data.Services.Providers.IDataServiceStreamProvider.</span><span class="sxs-lookup"><span data-stu-id="35c8b-117">Implement the T:System.Data.Services.Providers.IDataServiceStreamProvider interface.</span></span>  
  
3.  <span data-ttu-id="35c8b-118">Zdefiniuj Usługa danych, która implementuje <xref:System.IServiceProvider> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="35c8b-118">Define a data service that implements the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="35c8b-119">Dane usługi używa <xref:System.IServiceProvider.GetService%2A> implementacji do przesyłania strumieniowego implementacja dostawcy danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-119">The data service uses the <xref:System.IServiceProvider.GetService%2A> implementation to access the streaming data provider implementation.</span></span> <span data-ttu-id="35c8b-120">Ta metoda zwraca odpowiedniej implementacji dostawcy przesyłania strumieniowego.</span><span class="sxs-lookup"><span data-stu-id="35c8b-120">This method returns the appropriate streaming provider implementation.</span></span>  
  
4.  <span data-ttu-id="35c8b-121">Włącz strumieni dużych komunikatów w konfiguracji aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="35c8b-121">Enable large message streams in the Web application configuration.</span></span>  
  
5.  <span data-ttu-id="35c8b-122">Zapewnianie dostępu do zasobów binarnych na serwerze lub w źródle danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-122">Enable access to binary resources on the server or in a data source.</span></span>  
  
 <span data-ttu-id="35c8b-123">Przykłady w tym temacie są oparte na próbkę przesyłanie strumieniowe zdjęć usługi, która została omówiona szczegółowo w ciągu [przesyłania strumieniowego serii dostawcy danych usług: Implementowanie dostawcy przesyłania strumieniowego (część 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="35c8b-123">The examples in this topic are based on a sample streaming photo service, which is discussed in depth in the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span></span> <span data-ttu-id="35c8b-124">Dla tej usługi przykładowy kod źródłowy jest dostępny na [przesyłanie strumieniowe zdjęć danych usługi przykładową stronę](http://go.microsoft.com/fwlink/?LinkID=198988) w galerii kodu MSDN.</span><span class="sxs-lookup"><span data-stu-id="35c8b-124">The source code for this sample service is available on the [Streaming Photo Data Service Sample page](http://go.microsoft.com/fwlink/?LinkID=198988) on MSDN Code Gallery.</span></span>  
  
## <a name="defining-a-media-link-entry-in-the-data-model"></a><span data-ttu-id="35c8b-125">Definiowanie wpisu łącza nośnika w modelu danych</span><span class="sxs-lookup"><span data-stu-id="35c8b-125">Defining a Media Link Entry in the Data Model</span></span>  
 <span data-ttu-id="35c8b-126">Dostawca źródła danych określa sposób, że jednostka jest zdefiniowany jako wpisu media link entry w modelu danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-126">The data source provider determines the way that an entity is defined as a media link entry in the data model.</span></span>  
  
 <span data-ttu-id="35c8b-127">**Dostawca programu Entity Framework**</span><span class="sxs-lookup"><span data-stu-id="35c8b-127">**Entity Framework Provider**</span></span>  
 <span data-ttu-id="35c8b-128">Aby wskazać, że jednostka jest wpisem łącza nośnika, należy dodać `HasStream` atrybutu do definicji typu jednostki w modelu koncepcyjnym, jak w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="35c8b-128">To indicate that an entity is a media link entry, add the `HasStream` attribute to the entity type definition in the conceptual model, as in the following example:</span></span>  
  
 [!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria photo streaming service/xml/photodata.edmx#hasstream)]  
  
 <span data-ttu-id="35c8b-129">Musisz również dodać przestrzeń nazw `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` do jednostki lub w katalogu głównym pliku edmx lub .csdl, który definiuje modelu danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-129">You must also add the namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` either to the entity or to the root of the .edmx or .csdl file that defines the data model.</span></span>  
  
 <span data-ttu-id="35c8b-130">Na przykład usługa danych, który używa [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] dostawcy i udostępnia zasobu multimedialnego, zobacz wpis [przesyłania strumieniowego serii dostawcy danych usług: Implementowanie dostawcy przesyłania strumieniowego (część 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="35c8b-130">For an example of a data service that uses the [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] provider and exposes a media resource, see the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span></span>  
  
 <span data-ttu-id="35c8b-131">**Dostawca odbicia**</span><span class="sxs-lookup"><span data-stu-id="35c8b-131">**Reflection Provider**</span></span>  
 <span data-ttu-id="35c8b-132">Aby wskazać, że jednostka jest wpisem łącza nośnika, należy dodać <xref:System.Data.Services.Common.HasStreamAttribute> do klasy, który definiuje typ jednostki w dostawcy odbicia.</span><span class="sxs-lookup"><span data-stu-id="35c8b-132">To indicate that an entity is a media link entry, add the <xref:System.Data.Services.Common.HasStreamAttribute> to the class that defines the entity type in the reflection provider.</span></span>  
  
 <span data-ttu-id="35c8b-133">**Dostawcy usług danych niestandardowych**</span><span class="sxs-lookup"><span data-stu-id="35c8b-133">**Custom Data Service Provider**</span></span>  
 <span data-ttu-id="35c8b-134">Podczas korzystania z usług niestandardowych dostawców należy zaimplementować <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> interfejs do definiowania metadanych dla usługi danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-134">When using custom service providers, you implement the <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> interface to define the metadata for your data service.</span></span> <span data-ttu-id="35c8b-135">Aby uzyskać więcej informacji, zobacz [dostawców usług danych niestandardowych](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="35c8b-135">For more information, see [Custom Data Service Providers](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span></span> <span data-ttu-id="35c8b-136">Wskazuje, że strumień zasobów binarnych należy do <xref:System.Data.Services.Providers.ResourceType> przez ustawienie <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> właściwości `true` na <xref:System.Data.Services.Providers.ResourceType> reprezentujący typ jednostki wpisu łącza nośnika.</span><span class="sxs-lookup"><span data-stu-id="35c8b-136">You indicate that a binary resource stream belongs to a <xref:System.Data.Services.Providers.ResourceType> by setting the <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> property to `true` on the <xref:System.Data.Services.Providers.ResourceType> that represents the entity type, which is a media link entry.</span></span>  
  
## <a name="implementing-the-idataservicestreamprovider-interface"></a><span data-ttu-id="35c8b-137">Implementacja interfejsu interfejsu IDataServiceStreamProvider</span><span class="sxs-lookup"><span data-stu-id="35c8b-137">Implementing the IDataServiceStreamProvider Interface</span></span>  
 <span data-ttu-id="35c8b-138">Aby utworzyć usługę danych, która obsługuje strumienie danych binarnych, musisz zaimplementować <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="35c8b-138">To create a data service that supports binary data streams, you must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface.</span></span> <span data-ttu-id="35c8b-139">Ta implementacja umożliwia usłudze danych do zwrócenia danych binarnych jako strumień klientowi i korzystania z danych binarnych jako strumień wysłanych z klienta.</span><span class="sxs-lookup"><span data-stu-id="35c8b-139">This implementation enables the data service to return binary data as a stream to the client and consume binary data as a stream sent from the client.</span></span> <span data-ttu-id="35c8b-140">Usługi danych tworzy wystąpienie tego interfejsu zawsze, gdy musi mieć dostęp do danych binarnych jako strumień.</span><span class="sxs-lookup"><span data-stu-id="35c8b-140">The data service creates an instance of this interface whenever it needs to access binary data as a stream.</span></span> <span data-ttu-id="35c8b-141"><xref:System.Data.Services.Providers.IDataServiceStreamProvider> Interfejsu określa następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="35c8b-141">The <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface specifies the following members:</span></span>  
  
|<span data-ttu-id="35c8b-142">Nazwa elementu członkowskiego</span><span class="sxs-lookup"><span data-stu-id="35c8b-142">Member name</span></span>|<span data-ttu-id="35c8b-143">Opis</span><span class="sxs-lookup"><span data-stu-id="35c8b-143">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>|<span data-ttu-id="35c8b-144">Ta metoda jest wywoływana przez usługę danych można usunąć odpowiadający jej zasób nośnik, po usunięciu jego wpisu media link entry.</span><span class="sxs-lookup"><span data-stu-id="35c8b-144">This method is invoked by the data service to delete the corresponding media resource when its media link entry is deleted.</span></span> <span data-ttu-id="35c8b-145">Po zaimplementowaniu <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, ta metoda zawiera kod, który usuwa skojarzone z wpisu łącza nośnika dostarczony zasobu multimediów.</span><span class="sxs-lookup"><span data-stu-id="35c8b-145">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that deletes the media resource associated with the supplied media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>|<span data-ttu-id="35c8b-146">Ta metoda jest wywoływana przez usługę danych do zwrócenia z zasobem multimediów jako strumień.</span><span class="sxs-lookup"><span data-stu-id="35c8b-146">This method is invoked by the data service to return a media resource as a stream.</span></span> <span data-ttu-id="35c8b-147">Po zaimplementowaniu <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, ta metoda zawiera kod, który zapewnia strumienia, który jest używany przez usługę danych zasobem Zwróć nośniki, który jest skojarzony z podanych nośnika wpisu łącza.</span><span class="sxs-lookup"><span data-stu-id="35c8b-147">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that provides a stream that is used by the data service to the return media resource that is associated with the provided media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStreamUri%2A>|<span data-ttu-id="35c8b-148">Ta metoda jest wywoływana przez usługę danych do zwrócenia identyfikator URI, który jest używany do żądania zasób nośnika wpisu łącza nośnika.</span><span class="sxs-lookup"><span data-stu-id="35c8b-148">This method is invoked by the data service to return the URI that is used to request the media resource for the media link entry.</span></span> <span data-ttu-id="35c8b-149">Ta wartość jest używana do tworzenia `src` atrybutu w elemencie zawartości wpisu łącza nośnika, oraz że jest używany do żądania strumienia danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-149">This value is used to create the `src` attribute in the content element of the media link entry and that is used to request the data stream.</span></span> <span data-ttu-id="35c8b-150">Ta metoda zwraca `null`, Usługa danych automatycznie określa identyfikator URI.</span><span class="sxs-lookup"><span data-stu-id="35c8b-150">When this method returns `null`, the data service automatically determines the URI.</span></span> <span data-ttu-id="35c8b-151">Użyj tej metody, gdy chcesz zapewnić klientom bezpośredni dostęp do danych binarnych bez przy użyciu dostawcy pary.</span><span class="sxs-lookup"><span data-stu-id="35c8b-151">Use this method when you need to provide clients with direct access to binary data without using the steam provider.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamContentType%2A>|<span data-ttu-id="35c8b-152">Ta metoda jest wywoływana przez usługę danych ma zostać zwrócona wartość Content-Type zasobu nośnika, który jest skojarzony z określonym nośnika wpisu łącza.</span><span class="sxs-lookup"><span data-stu-id="35c8b-152">This method is invoked by the data service to return the Content-Type value of the media resource that is associated with the specified media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamETag%2A>|<span data-ttu-id="35c8b-153">Ta metoda jest wywoływana przez usługę danych do zwrócenia eTag strumienia danych skojarzonego z określonej jednostki.</span><span class="sxs-lookup"><span data-stu-id="35c8b-153">This method is invoked by the data service to return the eTag of the data stream that is associated with the specified entity.</span></span> <span data-ttu-id="35c8b-154">Ta metoda jest używana w przypadku zarządzania współbieżności dla danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-154">This method is used when you manage concurrency for the binary data.</span></span> <span data-ttu-id="35c8b-155">Gdy ta metoda zwraca wartość null, usługi danych nie śledzi współbieżności.</span><span class="sxs-lookup"><span data-stu-id="35c8b-155">When this method returns null, the data service does not track concurrency.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>|<span data-ttu-id="35c8b-156">Ta metoda jest wywoływana przez usługę danych można uzyskać strumienia, który jest używany podczas odbierania strumienia wysłanych z klienta.</span><span class="sxs-lookup"><span data-stu-id="35c8b-156">This method is invoked by the data service to obtain the stream that is used when receiving the stream sent from the client.</span></span> <span data-ttu-id="35c8b-157">Po zaimplementowaniu <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, musi zwracać strumień zapisywalny, do którego dane usługi zapisy otrzymał strumienia danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-157">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, you must return a writable stream to which the data service writes received stream data.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.ResolveType%2A>|<span data-ttu-id="35c8b-158">Zwraca nazwę typu kwalifikowanego przestrzeni nazw, który reprezentuje typ środowiska uruchomieniowego usługi danych należy utworzyć dla wpisu łącza nośnika skojarzony z strumienia danych dla zasobu multimediów wstawianego.</span><span class="sxs-lookup"><span data-stu-id="35c8b-158">Returns a namespace-qualified type name that represents the type that the data service runtime must create for the media link entry that is associated with the data stream for the media resource that is being inserted.</span></span>|  
  
## <a name="creating-the-streaming-data-service"></a><span data-ttu-id="35c8b-159">Tworzenie przesyłania strumieniowego usługi danych</span><span class="sxs-lookup"><span data-stu-id="35c8b-159">Creating the Streaming Data Service</span></span>  
 <span data-ttu-id="35c8b-160">Aby zapewnić [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] środowiska wykonawczego z dostępem do <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementacji utworzonego usługi danych musi implementować też <xref:System.IServiceProvider> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="35c8b-160">To provide the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] runtime with access to the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementation, the data service that you create must also implement the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="35c8b-161">Poniższy przykład przedstawia sposób wykonania <xref:System.IServiceProvider.GetService%2A> sposób zwrócenia wystąpienia klasy `PhotoServiceStreamProvider` klasa implementująca <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="35c8b-161">The following example shows how to implement the <xref:System.IServiceProvider.GetService%2A> method to return an instance of the `PhotoServiceStreamProvider` class that implements <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span></span>  
  
 [!code-csharp[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria photo streaming service/cs/photodata.svc.cs#photoservicestreamingprovider)]
 [!code-vb[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria photo streaming service/vb/photodata.svc.vb#photoservicestreamingprovider)]  
  
 <span data-ttu-id="35c8b-162">Aby uzyskać ogólne informacje o sposobie tworzenia usługi danych, zobacz [Konfigurowanie usługi danych](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="35c8b-162">For general information about how to create a data service, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span>  
  
## <a name="enabling-large-binary-streams-in-the-hosting-environment"></a><span data-ttu-id="35c8b-163">Włączanie dużych strumienie binarne w środowisku macierzystym</span><span class="sxs-lookup"><span data-stu-id="35c8b-163">Enabling Large Binary Streams in the Hosting Environment</span></span>  
 <span data-ttu-id="35c8b-164">Podczas tworzenia usługi danych w [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] aplikacji sieci Web Windows Communication Foundation (WCF) służy do implementacji protokołu HTTP.</span><span class="sxs-lookup"><span data-stu-id="35c8b-164">When you create a data service in an [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web application, Windows Communication Foundation (WCF) is used to provide the HTTP protocol implementation.</span></span> <span data-ttu-id="35c8b-165">Domyślnie program WCF ogranicza rozmiar wiadomości HTTP do tylko 65 KB.</span><span class="sxs-lookup"><span data-stu-id="35c8b-165">By default, WCF limits the size of HTTP messages to only 65K bytes.</span></span> <span data-ttu-id="35c8b-166">Aby można było do strumienia dużych danych binarnych do i z usług danych, należy również skonfigurować aplikacji sieci Web, aby włączyć duże pliki binarne i użyć strumieni transferu.</span><span class="sxs-lookup"><span data-stu-id="35c8b-166">To be able to stream large binary data to and from the data service, you must also configure the Web application to enable large binary files and to use streams for transfer.</span></span> <span data-ttu-id="35c8b-167">W tym celu należy dodać następujące opcje w `<configuration />` elementu plik Web.config:</span><span class="sxs-lookup"><span data-stu-id="35c8b-167">To do this, add the following in the `<configuration />` element of the application's Web.config file:</span></span>  
  
  
  
> [!NOTE]
>  <span data-ttu-id="35c8b-168">Należy użyć <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> tryb transferu, aby upewnić się, czy dane binarne w komunikatów żądań i odpowiedzi są przesyłane strumieniowo i nie jest buforowana przez usługę WCF.</span><span class="sxs-lookup"><span data-stu-id="35c8b-168">You must use a <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> transfer mode to ensure that the binary data in both the request and response messages are streamed and not buffered by WCF.</span></span>  
  
 <span data-ttu-id="35c8b-169">Aby uzyskać więcej informacji, zobacz [przesyłania strumieniowego transferu wiadomości](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) i [przydziały dla transportu](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="35c8b-169">For more information, see [Streaming Message Transfer](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) and [Transport Quotas](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span></span>  
  
 <span data-ttu-id="35c8b-170">Domyślnie program Internet Information Services (IIS) ogranicza rozmiar żądania do 4MB.</span><span class="sxs-lookup"><span data-stu-id="35c8b-170">By default, Internet Information Services (IIS) also limits the size of requests to 4MB.</span></span> <span data-ttu-id="35c8b-171">Aby włączyć usługi danych do odbierania strumieni większych niż 4MB uruchomionej na serwerze IIS, należy także ustawić `maxRequestLength` atrybutu [httpRuntime — Element (schemat ustawień programu ASP.NET)](http://msdn.microsoft.com/library/e9b81350-8aaf-47cc-9843-5f7d0c59f369) w `<system.web />` sekcji konfiguracji jako pokazano w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="35c8b-171">To enable your data service to receive streams larger than 4MB when running on IIS, you must also set the `maxRequestLength` attribute of the [httpRuntime Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/e9b81350-8aaf-47cc-9843-5f7d0c59f369) in the `<system.web />` configuration section, as shown in the following example:</span></span>  
  
  
  
## <a name="using-data-streams-in-a-client-application"></a><span data-ttu-id="35c8b-172">Za pomocą strumieni danych w aplikacji klienta</span><span class="sxs-lookup"><span data-stu-id="35c8b-172">Using Data Streams in a Client Application</span></span>  
 <span data-ttu-id="35c8b-173">[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] Biblioteki klienta umożliwia zarówno pobierania i aktualizowania te uwidocznione zasoby jako strumienie binarne na kliencie.</span><span class="sxs-lookup"><span data-stu-id="35c8b-173">The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library enables you to both retrieve and update these exposed resources as binary streams on the client.</span></span> <span data-ttu-id="35c8b-174">Aby uzyskać więcej informacji, zobacz [Praca z danymi binarnymi](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="35c8b-174">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>  
  
## <a name="considerations-for-working-with-a-streaming-provider"></a><span data-ttu-id="35c8b-175">Informacje dotyczące pracy z dostawcą przesyłania strumieniowego</span><span class="sxs-lookup"><span data-stu-id="35c8b-175">Considerations for Working with a Streaming Provider</span></span>  
 <span data-ttu-id="35c8b-176">Oto co należy wziąć pod uwagę podczas implementacji dostawcy przesyłania strumieniowego i jeśli dostęp do zasobów multimedialnych z usługi danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-176">The following are things to consider when you implement a streaming provider and when you access media resources from a data service.</span></span>  
  
-   <span data-ttu-id="35c8b-177">SCALANIE żądania nie są obsługiwane dla zasobów multimedialnych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-177">MERGE requests are not supported for media resources.</span></span> <span data-ttu-id="35c8b-178">Umożliwia zmianę zasobu multimediów istniejącej jednostki żądania PUT.</span><span class="sxs-lookup"><span data-stu-id="35c8b-178">Use a PUT request to change the media resource of an existing entity.</span></span>  
  
-   <span data-ttu-id="35c8b-179">Żądanie POST nie może służyć do tworzenia nowego nośnika wpisu łącza.</span><span class="sxs-lookup"><span data-stu-id="35c8b-179">A POST request cannot be used to create a new media link entry.</span></span> <span data-ttu-id="35c8b-180">Zamiast tego należy wygenerować żądanie POST, aby utworzyć nowy zasób nośnika, a usługi danych powoduje utworzenie nowego nośnika wpisu łącza z wartościami domyślnymi.</span><span class="sxs-lookup"><span data-stu-id="35c8b-180">Instead, you must issue a POST request to create a new media resource, and the data service creates a new media link entry with default values.</span></span> <span data-ttu-id="35c8b-181">Ten nowy obiekt może być aktualizowany przez kolejne żądanie scalania lub PUT.</span><span class="sxs-lookup"><span data-stu-id="35c8b-181">This new entity can be updated by a subsequent MERGE or PUT request.</span></span> <span data-ttu-id="35c8b-182">Może również należy wziąć pod uwagę buforowanie jednostki i przeprowadzić aktualizacje w usuwającego, takie jak ustawienie wartości właściwości na wartość nagłówek sluga w żądaniu POST.</span><span class="sxs-lookup"><span data-stu-id="35c8b-182">You may also consider caching the entity and make updates in the disposer, such as setting the property value to the value of the Slug header in the POST request.</span></span>  
  
-   <span data-ttu-id="35c8b-183">Po odebraniu żądania POST, dane usługi wywołania <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> można utworzyć zasobu multimediów przed nią wywołuje <xref:System.Data.Services.IUpdatable.SaveChanges%2A> do utworzenia nośnika wpisu łącza.</span><span class="sxs-lookup"><span data-stu-id="35c8b-183">When a POST request is received, the data service calls <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> to create the media resource before it calls <xref:System.Data.Services.IUpdatable.SaveChanges%2A> to create the media link entry.</span></span>  
  
-   <span data-ttu-id="35c8b-184">Implementacja interfejsu <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> nie może zwracać <xref:System.IO.MemoryStream> obiektu.</span><span class="sxs-lookup"><span data-stu-id="35c8b-184">An implementation of <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> should not return a <xref:System.IO.MemoryStream> object.</span></span> <span data-ttu-id="35c8b-185">Korzystając z tego rodzaju strumienia, problemy z pamięcią zasobów wystąpią, gdy usługa odbierze strumieni bardzo dużej ilości danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-185">When you use this kind of stream, memory resource issues will occur when the service receives very large data streams.</span></span>  
  
-   <span data-ttu-id="35c8b-186">Co należy wziąć pod uwagę podczas przechowywania nośników zasobów w bazie danych są następujące:</span><span class="sxs-lookup"><span data-stu-id="35c8b-186">The following are things to consider when storing media resources in a database:</span></span>  
  
    -   <span data-ttu-id="35c8b-187">Właściwość binarną, która jest zasobem multimediów nie powinny znajdować się w modelu danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-187">A binary property that is a media resource should not be included in the data model.</span></span> <span data-ttu-id="35c8b-188">Wszystkie właściwości w modelu danych są zwracane w wpis w odpowiedzi na źródła danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-188">All properties exposed in a data model are returned in the entry in a response feed.</span></span>  
  
    -   <span data-ttu-id="35c8b-189">Aby zwiększyć wydajność za duża strumienia binarnego, zaleca się utworzenie klasy niestandardowej strumienia do przechowywania danych binarnych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-189">To improve performance with a large binary stream, we recommend that you create a custom stream class to store binary data in the database.</span></span> <span data-ttu-id="35c8b-190">Ta klasa jest zwracany przez użytkownika <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementacji i wysyła dane binarne do bazy danych w fragmentów.</span><span class="sxs-lookup"><span data-stu-id="35c8b-190">This class is returned by your <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementation and sends the binary data to the database in chunks.</span></span> <span data-ttu-id="35c8b-191">Dla bazy danych programu SQL Server firma Microsoft zaleca, aby używać FILESTREAM do transmisji danych do bazy danych binarnych jest większy niż 1MB.</span><span class="sxs-lookup"><span data-stu-id="35c8b-191">For a SQL Server database, we recommend that you use a FILESTREAM to stream data into the database when the binary data is larger than 1MB.</span></span>  
  
    -   <span data-ttu-id="35c8b-192">Upewnij się, że baza danych jest przeznaczony do przechowywania dużych strumienie binarne, które mają być odbierany przez usługi danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-192">Ensure that your database is designed to store the binary large streams that are to be received by your data service.</span></span>  
  
    -   <span data-ttu-id="35c8b-193">Gdy klient wysyła żądanie POST, aby wstawić wpisu media link entry z zasobem multimediów w ramach pojedynczego żądania <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> jest wywoływana w celu uzyskania strumienia, zanim usługa danych Wstawia nową jednostkę w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-193">When a client sends a POST request to insert a media link entry with a media resource in a single request, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> is called to obtain the stream before the data service inserts the new entity into the database.</span></span> <span data-ttu-id="35c8b-194">Przesyłania strumieniowego implementacji dostawcy musi mieć możliwość obsługi tego zachowania usługi danych.</span><span class="sxs-lookup"><span data-stu-id="35c8b-194">A streaming provider implementation must be able to handle this data service behavior.</span></span> <span data-ttu-id="35c8b-195">Należy rozważyć użycie tabeli oddzielnego danych do przechowywania danych binarnych lub strumień danych w pliku dopiero po jednostki został wstawiony do bazy danych magazynu.</span><span class="sxs-lookup"><span data-stu-id="35c8b-195">Consider using a separate data table to store the binary data or store the data stream in a file until after the entity has been inserted into the database.</span></span>  
  
-   <span data-ttu-id="35c8b-196">Po zaimplementowaniu <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, lub <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> metod, musisz użyć eTag i wartości typu zawartości, które są określane jako parametry metody.</span><span class="sxs-lookup"><span data-stu-id="35c8b-196">When you implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, or <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> methods, you must use the eTag and Content-Type values that are supplied as method parameters.</span></span> <span data-ttu-id="35c8b-197">Nie ustawiaj eTag lub nagłówki typu zawartości w Twojej <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementacji dostawcy.</span><span class="sxs-lookup"><span data-stu-id="35c8b-197">Do not set eTag or Content-Type headers in your <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider implementation.</span></span>  
  
-   <span data-ttu-id="35c8b-198">Domyślnie klient wysyła dużych strumienie binarne przy użyciu fragmentarycznego HTTP Transfer-Encoding.</span><span class="sxs-lookup"><span data-stu-id="35c8b-198">By default, the client sends large binary streams by using a chunked HTTP Transfer-Encoding.</span></span> <span data-ttu-id="35c8b-199">Ponieważ [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server nie obsługuje tego typu kodowania, nie można użyć tego serwera sieci Web do obsługi przesyłania strumieniowego Usługa danych, musisz zaakceptować dużych strumienie binarne.</span><span class="sxs-lookup"><span data-stu-id="35c8b-199">Because the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server does not support this kind of encoding, you cannot use this Web server to host a streaming data service that must accept large binary streams.</span></span> <span data-ttu-id="35c8b-200">Aby uzyskać więcej informacji na temat [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server, zobacz [serwerów sieci Web w programie Visual Studio dla projektów sieci Web ASP.NET](http://msdn.microsoft.com/library/31d4f588-df59-4b7e-b9ea-e1f2dd204328).</span><span class="sxs-lookup"><span data-stu-id="35c8b-200">For more information on [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server, see [Web Servers in Visual Studio for ASP.NET Web Projects](http://msdn.microsoft.com/library/31d4f588-df59-4b7e-b9ea-e1f2dd204328).</span></span>  
  
<a name="versioning"></a>   
## <a name="versioning-requirements"></a><span data-ttu-id="35c8b-201">Wymagania dotyczące kontroli wersji</span><span class="sxs-lookup"><span data-stu-id="35c8b-201">Versioning Requirements</span></span>  
 <span data-ttu-id="35c8b-202">Dostawca przesyłania strumieniowego ma następujące [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protokołu wymagań dotyczących przechowywania wersji:</span><span class="sxs-lookup"><span data-stu-id="35c8b-202">The streaming provider has the following [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol versioning requirements:</span></span>  
  
-   <span data-ttu-id="35c8b-203">Dostawca przesyłania strumieniowego wymaga, że usługa danych obsługuje wersja 2.0 [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protokołu i nowszych wersjach.</span><span class="sxs-lookup"><span data-stu-id="35c8b-203">The streaming provider requires that the data service support version 2.0 of the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol and later versions.</span></span>  
  
 <span data-ttu-id="35c8b-204">Aby uzyskać więcej informacji, zobacz [przechowywanie wersji usługi danych](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="35c8b-204">For more information, see [Data Service Versioning](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="35c8b-205">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="35c8b-205">See Also</span></span>  
 [<span data-ttu-id="35c8b-206">Dostawcy usług danych</span><span class="sxs-lookup"><span data-stu-id="35c8b-206">Data Services Providers</span></span>](../../../../docs/framework/data/wcf/data-services-providers-wcf-data-services.md)  
 [<span data-ttu-id="35c8b-207">Niestandardowi dostawcy usługi danych</span><span class="sxs-lookup"><span data-stu-id="35c8b-207">Custom Data Service Providers</span></span>](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md)  
 [<span data-ttu-id="35c8b-208">Praca z danymi binarnymi</span><span class="sxs-lookup"><span data-stu-id="35c8b-208">Working with Binary Data</span></span>](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md)
