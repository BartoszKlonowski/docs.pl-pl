---
title: Kwerendy pojedynczej tabeli (LINQ to DataSet)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212
ms.openlocfilehash: 17a2fcf54cae64d9443b0cc0e8a37e1002bbd394
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/24/2020
ms.locfileid: "91175359"
---
# <a name="single-table-queries-linq-to-dataset"></a><span data-ttu-id="08f88-102">Kwerendy pojedynczej tabeli (LINQ to DataSet)</span><span class="sxs-lookup"><span data-stu-id="08f88-102">Single-Table Queries (LINQ to DataSet)</span></span>

<span data-ttu-id="08f88-103">Zapytania dotyczące języka (LINQ) są używane w źródłach danych, które implementują <xref:System.Collections.Generic.IEnumerable%601> interfejs lub <xref:System.Linq.IQueryable%601> interfejs.</span><span class="sxs-lookup"><span data-stu-id="08f88-103">Language-Integrated Query (LINQ) queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="08f88-104"><xref:System.Data.DataTable>Klasa nie implementuje żadnego interfejsu, dlatego należy wywołać <xref:System.Data.DataTableExtensions.AsEnumerable%2A> metodę, jeśli chcesz użyć <xref:System.Data.DataTable> jako źródła w `From` klauzuli zapytania LINQ.</span><span class="sxs-lookup"><span data-stu-id="08f88-104">The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a LINQ query.</span></span>  
  
 <span data-ttu-id="08f88-105">Poniższy przykład pobiera wszystkie zamówienia online z tabeli SalesOrderHeader i wyświetla identyfikator zamówienia, datę zamówienia i numer zamówienia w konsoli programu.</span><span class="sxs-lookup"><span data-stu-id="08f88-105">The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]  
 [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)]
  
 <span data-ttu-id="08f88-106">Zapytanie zmiennej lokalnej jest inicjowane z wyrażeniem zapytania, które działa na co najmniej jednym źródle informacji przez zastosowanie co najmniej jednego operatora zapytań z standardowych operatorów zapytań lub, w przypadku LINQ to DataSet, operatorów specyficznych dla <xref:System.Data.DataSet> klasy.</span><span class="sxs-lookup"><span data-stu-id="08f88-106">The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of LINQ to DataSet, operators specific to the <xref:System.Data.DataSet> class.</span></span> <span data-ttu-id="08f88-107">W wyrażeniu zapytania w poprzednim przykładzie użyto dwóch standardowych operatorów zapytań: `Where` i `Select` .</span><span class="sxs-lookup"><span data-stu-id="08f88-107">The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.</span></span>  
  
 <span data-ttu-id="08f88-108">`Where`Klauzula filtruje sekwencję w oparciu o warunek, w tym przypadku `OnlineOrderFlag` jest ustawiona na `true` .</span><span class="sxs-lookup"><span data-stu-id="08f88-108">The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`.</span></span> <span data-ttu-id="08f88-109">`Select`Operator przydziela i zwraca wyliczalny obiekt, który przechwytuje argumenty przekazane do operatora.</span><span class="sxs-lookup"><span data-stu-id="08f88-109">The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator.</span></span> <span data-ttu-id="08f88-110">W tym przykładzie typ anonimowy jest tworzony z trzema właściwościami: `SalesOrderID` , `OrderDate` , i `SalesOrderNumber` .</span><span class="sxs-lookup"><span data-stu-id="08f88-110">In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`.</span></span> <span data-ttu-id="08f88-111">Wartości tych trzech właściwości są ustawiane na wartości `SalesOrderID` , `OrderDate` , i `SalesOrderNumber` kolumn z `SalesOrderHeader` tabeli.</span><span class="sxs-lookup"><span data-stu-id="08f88-111">The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.</span></span>  
  
 <span data-ttu-id="08f88-112">`foreach`Pętla następnie wylicza wyliczalny obiekt zwracany przez `Select` i daje wyniki zapytania.</span><span class="sxs-lookup"><span data-stu-id="08f88-112">The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results.</span></span> <span data-ttu-id="08f88-113">Ponieważ zapytanie jest <xref:System.Linq.Enumerable> typu, który implementuje <xref:System.Collections.Generic.IEnumerable%601> , obliczanie zapytania jest odroczone do momentu, gdy zmienna zapytania zostanie powtórzona przy użyciu `foreach` pętli.</span><span class="sxs-lookup"><span data-stu-id="08f88-113">Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop.</span></span> <span data-ttu-id="08f88-114">Wywnioskowana Ocena zapytania umożliwia przechowywanie zapytań jako wartości, które mogą być oceniane wiele razy, za każdym razem, gdy dają one inne wyniki.</span><span class="sxs-lookup"><span data-stu-id="08f88-114">Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.</span></span>  
  
 <span data-ttu-id="08f88-115"><xref:System.Data.DataRowExtensions.Field%2A>Metoda zapewnia dostęp do wartości kolumn a <xref:System.Data.DataRow> i <xref:System.Data.DataRowExtensions.SetField%2A> (nie pokazano w poprzednim przykładzie) ustawia wartości kolumn w <xref:System.Data.DataRow> .</span><span class="sxs-lookup"><span data-stu-id="08f88-115">The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="08f88-116"><xref:System.Data.DataRowExtensions.Field%2A>Metody i <xref:System.Data.DataRowExtensions.SetField%2A> metody obsługują typy wartości null, więc nie trzeba jawnie sprawdzać wartości null.</span><span class="sxs-lookup"><span data-stu-id="08f88-116">Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable value types, so you do not have to explicitly check for null values.</span></span> <span data-ttu-id="08f88-117">Obie metody są metodami ogólnymi, co oznacza, że nie trzeba rzutować zwracanego typu.</span><span class="sxs-lookup"><span data-stu-id="08f88-117">Both methods are generic methods, also, which means you do not have to cast the return type.</span></span> <span data-ttu-id="08f88-118">Można użyć metody dostępu do istniejącej kolumny <xref:System.Data.DataRow> (na przykład `o["OrderDate"]` ), ale wykonanie tej operacji wymagałoby rzutowania obiektu powrotnego na odpowiedni typ.</span><span class="sxs-lookup"><span data-stu-id="08f88-118">You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o["OrderDate"]`), but doing so would require you to cast the return object to the appropriate type.</span></span>  <span data-ttu-id="08f88-119">Jeśli kolumna jest typem wartości null, należy sprawdzić, czy wartość jest równa null przy użyciu <xref:System.Data.DataRow.IsNull%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="08f88-119">If the column is a nullable value type you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method.</span></span> <span data-ttu-id="08f88-120">Aby uzyskać więcej informacji, zobacz [pola ogólne i metody SetField](generic-field-and-setfield-methods-linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="08f88-120">For more information, see [Generic Field and SetField Methods](generic-field-and-setfield-methods-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="08f88-121">Należy zauważyć, że typ danych określony w parametrze ogólnym `T` <xref:System.Data.DataRowExtensions.Field%2A> metody i <xref:System.Data.DataRowExtensions.SetField%2A> metody musi być zgodny z typem podstawowej wartości lub <xref:System.InvalidCastException> zostanie wygenerowany.</span><span class="sxs-lookup"><span data-stu-id="08f88-121">Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown.</span></span> <span data-ttu-id="08f88-122">Określona nazwa kolumny musi być również zgodna z nazwą kolumny w <xref:System.Data.DataSet> lub <xref:System.ArgumentException> zostanie wygenerowane.</span><span class="sxs-lookup"><span data-stu-id="08f88-122">The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown.</span></span> <span data-ttu-id="08f88-123">W obu przypadkach wyjątek jest generowany podczas wyliczania danych w czasie wykonywania, gdy zapytanie jest wykonywane.</span><span class="sxs-lookup"><span data-stu-id="08f88-123">In both cases, the exception is thrown at run time data enumeration when the query is executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="08f88-124">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="08f88-124">See also</span></span>

- [<span data-ttu-id="08f88-125">Zapytania wielotabelowe</span><span class="sxs-lookup"><span data-stu-id="08f88-125">Cross-Table Queries</span></span>](cross-table-queries-linq-to-dataset.md)
- [<span data-ttu-id="08f88-126">Wykonywanie zapytania do typizowanych zestawów danych</span><span class="sxs-lookup"><span data-stu-id="08f88-126">Querying Typed DataSets</span></span>](querying-typed-datasets.md)
- [<span data-ttu-id="08f88-127">Field i SetField, metody ogólne</span><span class="sxs-lookup"><span data-stu-id="08f88-127">Generic Field and SetField Methods</span></span>](generic-field-and-setfield-methods-linq-to-dataset.md)
