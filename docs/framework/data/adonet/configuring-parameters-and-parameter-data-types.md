---
title: "Konfigurowanie parametrów i typów danych parametrów"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: 0f5aed56ba4958d44e0628f55115308751afae55
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/22/2017
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="ed0a1-102">Konfigurowanie parametrów i typów danych parametrów</span><span class="sxs-lookup"><span data-stu-id="ed0a1-102">Configuring Parameters and Parameter Data Types</span></span>
<span data-ttu-id="ed0a1-103">Polecenie obiektów parametry do przekazania wartości do instrukcji SQL lub procedur składowanych, zapewniając Sprawdzanie typu i weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="ed0a1-104">W odróżnieniu od tekst polecenia parametr wejściowy jest traktowany jako wartość literału nie jako kod wykonywalny.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="ed0a1-105">Dzięki temu zabezpieczenia przed atakami "Iniekcja kodu SQL", w których osoba atakująca Wstawia polecenie Zabezpieczenia dokonywania na serwerze do instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>  
  
 <span data-ttu-id="ed0a1-106">Sparametryzowanych poleceń także może zwiększyć wydajność wykonywania zapytań, ponieważ pomagają dokładne dopasowanie przychodzące polecenie z planu prawidłowego zapytania w pamięci podręcznej serwera bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="ed0a1-107">Aby uzyskać więcej informacji, zobacz [buforowanie Plan wykonania i ponowne użycie](http://go.microsoft.com/fwlink/?LinkId=120424) i [parametrów i wykonanie planu ponowne użycie](http://go.microsoft.com/fwlink/?LinkId=120423) w dokumentacji SQL Server — książki Online.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-107">For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online.</span></span> <span data-ttu-id="ed0a1-108">Oprócz korzyści bezpieczeństwo i wydajność sparametryzowanych poleceń zapewniają wygodną metodę organizowania wartości przekazany do źródła danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>  
  
 <span data-ttu-id="ed0a1-109">A <xref:System.Data.Common.DbParameter> obiektu można tworzyć za pomocą jego konstruktora lub dodając go do <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> przez wywołanie metody `Add` metody <xref:System.Data.Common.DbParameterCollection> kolekcji.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="ed0a1-110">`Add` Metoda będzie przyjmować jako danych wejściowych w argumentach konstruktora lub parametr obiektu, w zależności od dostawcy danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>  
  
## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="ed0a1-111">Udostępnia właściwości właściwość ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="ed0a1-111">Supplying the ParameterDirection Property</span></span>  
 <span data-ttu-id="ed0a1-112">Dodając parametry, należy podać <xref:System.Data.ParameterDirection> właściwości dla parametrów innych niż parametrów wejściowych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="ed0a1-113">W poniższej tabeli przedstawiono `ParameterDirection` wartości, których można używać z <xref:System.Data.ParameterDirection> wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>  
  
|<span data-ttu-id="ed0a1-114">Nazwa elementu członkowskiego</span><span class="sxs-lookup"><span data-stu-id="ed0a1-114">Member name</span></span>|<span data-ttu-id="ed0a1-115">Opis</span><span class="sxs-lookup"><span data-stu-id="ed0a1-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="ed0a1-116">Parametr jest parametrem wejściowym.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-116">The parameter is an input parameter.</span></span> <span data-ttu-id="ed0a1-117">Domyślnie włączone.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-117">This is the default.</span></span>|  
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="ed0a1-118">Parametr może wykonywać zarówno danych wejściowych i wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-118">The parameter can perform both input and output.</span></span>|  
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="ed0a1-119">Parametr jest parametrem wyjściowym.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-119">The parameter is an output parameter.</span></span>|  
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="ed0a1-120">Parametr reprezentuje wartością zwracaną operacji, takiej jak procedury składowanej, funkcji wbudowanej lub funkcję zdefiniowaną przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|  
  
## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="ed0a1-121">Praca z parametru symbole zastępcze</span><span class="sxs-lookup"><span data-stu-id="ed0a1-121">Working with Parameter Placeholders</span></span>  
 <span data-ttu-id="ed0a1-122">Składnia parametru symbole zastępcze zależy od źródła danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="ed0a1-123">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Dostawców danych obsługi nazywania i określanie parametrów i symbole zastępcze parametru inaczej.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="ed0a1-124">Ta składnia jest dostosowane do określonego źródła danych, zgodnie z opisem w poniższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-124">This syntax is customized to a specific data source, as described in the following table.</span></span>  
  
|<span data-ttu-id="ed0a1-125">Dostawca danych</span><span class="sxs-lookup"><span data-stu-id="ed0a1-125">Data provider</span></span>|<span data-ttu-id="ed0a1-126">Składnia nazwy parametru</span><span class="sxs-lookup"><span data-stu-id="ed0a1-126">Parameter naming syntax</span></span>|  
|-------------------|-----------------------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="ed0a1-127">Używa nazwanych parametrów w formacie `@` *parametername*.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-127">Uses named parameters in the format `@`*parametername*.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="ed0a1-128">Używa wskaźników parametrów pozycyjnych wskazywanym przez znak zapytania (`?`).</span><span class="sxs-lookup"><span data-stu-id="ed0a1-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="ed0a1-129">Używa wskaźników parametrów pozycyjnych wskazywanym przez znak zapytania (`?`).</span><span class="sxs-lookup"><span data-stu-id="ed0a1-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="ed0a1-130">Używa nazwanych parametrów w formacie `:` *parmname* (lub *parmname*).</span><span class="sxs-lookup"><span data-stu-id="ed0a1-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|  
  
## <a name="specifying-parameter-data-types"></a><span data-ttu-id="ed0a1-131">Określenie typów danych parametrów</span><span class="sxs-lookup"><span data-stu-id="ed0a1-131">Specifying Parameter Data Types</span></span>  
 <span data-ttu-id="ed0a1-132">Typ danych parametru jest specyficzne dla [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dostawcy danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="ed0a1-133">Określenie typu konwertuje wartość `Parameter` do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] typ dostawcy danych przed przekazaniem wartość ze źródłem danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="ed0a1-134">Można również określić typ `Parameter` w sposób ogólny, ustawiając `DbType` właściwość `Parameter` obiektu do określonego <xref:System.Data.DbType>.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>  
  
 <span data-ttu-id="ed0a1-135">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Typu dostawcy danych `Parameter` obiektu jest wywnioskowany na podstawie [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] typu `Value` z `Parameter` obiekt, lub z `DbType` z `Parameter` obiektu.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="ed0a1-136">W poniższej tabeli przedstawiono wnioskowany `Parameter` typ oparty na obiekt przekazany jako `Parameter` wartość lub określony `DbType`.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>  
  
|<span data-ttu-id="ed0a1-137">Typ programu .NET Framework</span><span class="sxs-lookup"><span data-stu-id="ed0a1-137">.NET Framework type</span></span>|<span data-ttu-id="ed0a1-138">Wartość DbType</span><span class="sxs-lookup"><span data-stu-id="ed0a1-138">DbType</span></span>|<span data-ttu-id="ed0a1-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="ed0a1-139">SqlDbType</span></span>|<span data-ttu-id="ed0a1-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="ed0a1-140">OleDbType</span></span>|<span data-ttu-id="ed0a1-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="ed0a1-141">OdbcType</span></span>|<span data-ttu-id="ed0a1-142">Typu OracleType</span><span class="sxs-lookup"><span data-stu-id="ed0a1-142">OracleType</span></span>|  
|-------------------------|------------|---------------|---------------|--------------|----------------|  
|<xref:System.Boolean>|<span data-ttu-id="ed0a1-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="ed0a1-143">Boolean</span></span>|<span data-ttu-id="ed0a1-144">bitowe</span><span class="sxs-lookup"><span data-stu-id="ed0a1-144">Bit</span></span>|<span data-ttu-id="ed0a1-145">Boolean</span><span class="sxs-lookup"><span data-stu-id="ed0a1-145">Boolean</span></span>|<span data-ttu-id="ed0a1-146">bitowe</span><span class="sxs-lookup"><span data-stu-id="ed0a1-146">Bit</span></span>|<span data-ttu-id="ed0a1-147">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0a1-147">Byte</span></span>|  
|<xref:System.Byte>|<span data-ttu-id="ed0a1-148">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0a1-148">Byte</span></span>|<span data-ttu-id="ed0a1-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-149">TinyInt</span></span>|<span data-ttu-id="ed0a1-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-150">UnsignedTinyInt</span></span>|<span data-ttu-id="ed0a1-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-151">TinyInt</span></span>|<span data-ttu-id="ed0a1-152">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0a1-152">Byte</span></span>|  
|<span data-ttu-id="ed0a1-153">Byte]</span><span class="sxs-lookup"><span data-stu-id="ed0a1-153">byte[]</span></span>|<span data-ttu-id="ed0a1-154">plików binarnych</span><span class="sxs-lookup"><span data-stu-id="ed0a1-154">Binary</span></span>|<span data-ttu-id="ed0a1-155">VarBinary`.` niejawnej konwersji zakończy się niepowodzeniem, jeśli tablica bajtów jest większy niż maksymalny rozmiar VarBinary, czyli 8000 bajtów. Tablice typu byte jest większy niż 8000 bajtów, jawnie ustaw <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-155">VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="ed0a1-156">VarBinary</span><span class="sxs-lookup"><span data-stu-id="ed0a1-156">VarBinary</span></span>|<span data-ttu-id="ed0a1-157">plików binarnych</span><span class="sxs-lookup"><span data-stu-id="ed0a1-157">Binary</span></span>|<span data-ttu-id="ed0a1-158">nieprzetworzone</span><span class="sxs-lookup"><span data-stu-id="ed0a1-158">Raw</span></span>|  
|<xref:System.Char>|``|<span data-ttu-id="ed0a1-159">Wnioskowanie <xref:System.Data.SqlDbType> z char nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-159">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="ed0a1-160">Char</span><span class="sxs-lookup"><span data-stu-id="ed0a1-160">Char</span></span>|<span data-ttu-id="ed0a1-161">Char</span><span class="sxs-lookup"><span data-stu-id="ed0a1-161">Char</span></span>|<span data-ttu-id="ed0a1-162">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0a1-162">Byte</span></span>|  
|<xref:System.DateTime>|<span data-ttu-id="ed0a1-163">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-163">DateTime</span></span>|<span data-ttu-id="ed0a1-164">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-164">DateTime</span></span>|<span data-ttu-id="ed0a1-165">Odcisk czasowy</span><span class="sxs-lookup"><span data-stu-id="ed0a1-165">DBTimeStamp</span></span>|<span data-ttu-id="ed0a1-166">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-166">DateTime</span></span>|<span data-ttu-id="ed0a1-167">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-167">DateTime</span></span>|  
|<xref:System.DateTimeOffset>|<span data-ttu-id="ed0a1-168">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="ed0a1-168">DateTimeOffset</span></span>|<span data-ttu-id="ed0a1-169">DateTimeOffset w programie SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-169">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="ed0a1-170">Wnioskowanie <xref:System.Data.SqlDbType> z DateTimeOffset nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-170">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="ed0a1-171">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-171">DateTime</span></span>|  
|<xref:System.Decimal>|<span data-ttu-id="ed0a1-172">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="ed0a1-172">Decimal</span></span>|<span data-ttu-id="ed0a1-173">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="ed0a1-173">Decimal</span></span>|<span data-ttu-id="ed0a1-174">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="ed0a1-174">Decimal</span></span>|<span data-ttu-id="ed0a1-175">numeryczne</span><span class="sxs-lookup"><span data-stu-id="ed0a1-175">Numeric</span></span>|<span data-ttu-id="ed0a1-176">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="ed0a1-176">Number</span></span>|  
|<xref:System.Double>|<span data-ttu-id="ed0a1-177">Double</span><span class="sxs-lookup"><span data-stu-id="ed0a1-177">Double</span></span>|<span data-ttu-id="ed0a1-178">Float</span><span class="sxs-lookup"><span data-stu-id="ed0a1-178">Float</span></span>|<span data-ttu-id="ed0a1-179">Double</span><span class="sxs-lookup"><span data-stu-id="ed0a1-179">Double</span></span>|<span data-ttu-id="ed0a1-180">Double</span><span class="sxs-lookup"><span data-stu-id="ed0a1-180">Double</span></span>|<span data-ttu-id="ed0a1-181">Double</span><span class="sxs-lookup"><span data-stu-id="ed0a1-181">Double</span></span>|  
|<xref:System.Single>|<span data-ttu-id="ed0a1-182">Single</span><span class="sxs-lookup"><span data-stu-id="ed0a1-182">Single</span></span>|<span data-ttu-id="ed0a1-183">Rzeczywiste</span><span class="sxs-lookup"><span data-stu-id="ed0a1-183">Real</span></span>|<span data-ttu-id="ed0a1-184">Single</span><span class="sxs-lookup"><span data-stu-id="ed0a1-184">Single</span></span>|<span data-ttu-id="ed0a1-185">Rzeczywiste</span><span class="sxs-lookup"><span data-stu-id="ed0a1-185">Real</span></span>|<span data-ttu-id="ed0a1-186">Float</span><span class="sxs-lookup"><span data-stu-id="ed0a1-186">Float</span></span>|  
|<xref:System.Guid>|<span data-ttu-id="ed0a1-187">Identyfikator GUID</span><span class="sxs-lookup"><span data-stu-id="ed0a1-187">Guid</span></span>|<span data-ttu-id="ed0a1-188">Unikatowy identyfikator</span><span class="sxs-lookup"><span data-stu-id="ed0a1-188">UniqueIdentifier</span></span>|<span data-ttu-id="ed0a1-189">Identyfikator GUID</span><span class="sxs-lookup"><span data-stu-id="ed0a1-189">Guid</span></span>|<span data-ttu-id="ed0a1-190">Unikatowy identyfikator</span><span class="sxs-lookup"><span data-stu-id="ed0a1-190">UniqueIdentifier</span></span>|<span data-ttu-id="ed0a1-191">nieprzetworzone</span><span class="sxs-lookup"><span data-stu-id="ed0a1-191">Raw</span></span>|  
|<xref:System.Int16 >|<span data-ttu-id="ed0a1-192">Int16</span><span class="sxs-lookup"><span data-stu-id="ed0a1-192">Int16</span></span>|<span data-ttu-id="ed0a1-193">SmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-193">SmallInt</span></span>|<span data-ttu-id="ed0a1-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-194">SmallInt</span></span>|<span data-ttu-id="ed0a1-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-195">SmallInt</span></span>|<span data-ttu-id="ed0a1-196">Int16</span><span class="sxs-lookup"><span data-stu-id="ed0a1-196">Int16</span></span>|  
|<xref:System.Int32>|<span data-ttu-id="ed0a1-197">Int32</span><span class="sxs-lookup"><span data-stu-id="ed0a1-197">Int32</span></span>|<span data-ttu-id="ed0a1-198">int</span><span class="sxs-lookup"><span data-stu-id="ed0a1-198">Int</span></span>|<span data-ttu-id="ed0a1-199">int</span><span class="sxs-lookup"><span data-stu-id="ed0a1-199">Int</span></span>|<span data-ttu-id="ed0a1-200">int</span><span class="sxs-lookup"><span data-stu-id="ed0a1-200">Int</span></span>|<span data-ttu-id="ed0a1-201">Int32</span><span class="sxs-lookup"><span data-stu-id="ed0a1-201">Int32</span></span>|  
|<xref:System.Int64>|<span data-ttu-id="ed0a1-202">Int64</span><span class="sxs-lookup"><span data-stu-id="ed0a1-202">Int64</span></span>|<span data-ttu-id="ed0a1-203">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-203">BigInt</span></span>|<span data-ttu-id="ed0a1-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-204">BigInt</span></span>|<span data-ttu-id="ed0a1-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-205">BigInt</span></span>|<span data-ttu-id="ed0a1-206">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="ed0a1-206">Number</span></span>|  
|<xref:System.Object>|<span data-ttu-id="ed0a1-207">Obiekt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-207">Object</span></span>|<span data-ttu-id="ed0a1-208">Variant</span><span class="sxs-lookup"><span data-stu-id="ed0a1-208">Variant</span></span>|<span data-ttu-id="ed0a1-209">Variant</span><span class="sxs-lookup"><span data-stu-id="ed0a1-209">Variant</span></span>|<span data-ttu-id="ed0a1-210">Wnioskowanie OdbcType z obiektu nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-210">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="ed0a1-211">Obiekt blob</span><span class="sxs-lookup"><span data-stu-id="ed0a1-211">Blob</span></span>|  
|<xref:System.String>|<span data-ttu-id="ed0a1-212">String</span><span class="sxs-lookup"><span data-stu-id="ed0a1-212">String</span></span>|<span data-ttu-id="ed0a1-213">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-213">NVarChar.</span></span> <span data-ttu-id="ed0a1-214">Ta niejawna konwersja zakończy się niepowodzeniem, jeśli ciąg jest większy niż maksymalny rozmiar NVarChar, która jest 4000 znaków.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-214">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="ed0a1-215">Ciągi większej niż 4000 znaków, należy jawnie ustawić <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-215">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="ed0a1-216">VarWChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-216">VarWChar</span></span>|<span data-ttu-id="ed0a1-217">NVarChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-217">NVarChar</span></span>|<span data-ttu-id="ed0a1-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-218">NVarChar</span></span>|  
|<xref:System.TimeSpan>|<span data-ttu-id="ed0a1-219">Godzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-219">Time</span></span>|<span data-ttu-id="ed0a1-220">Czas w programie SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-220">Time in SQL Server 2008.</span></span> <span data-ttu-id="ed0a1-221">Wnioskowanie <xref:System.Data.SqlDbType> z TimeSpan nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-221">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="ed0a1-222">DBTime</span><span class="sxs-lookup"><span data-stu-id="ed0a1-222">DBTime</span></span>|<span data-ttu-id="ed0a1-223">Godzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-223">Time</span></span>|<span data-ttu-id="ed0a1-224">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-224">DateTime</span></span>|  
|<xref:System.UInt16>|<span data-ttu-id="ed0a1-225">UInt16</span><span class="sxs-lookup"><span data-stu-id="ed0a1-225">UInt16</span></span>|<span data-ttu-id="ed0a1-226">Wnioskowanie <xref:System.Data.SqlDbType> z UInt16 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-226">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="ed0a1-227">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-227">UnsignedSmallInt</span></span>|<span data-ttu-id="ed0a1-228">int</span><span class="sxs-lookup"><span data-stu-id="ed0a1-228">Int</span></span>|<span data-ttu-id="ed0a1-229">UInt16</span><span class="sxs-lookup"><span data-stu-id="ed0a1-229">UInt16</span></span>|  
|<xref:System.UInt32>|<span data-ttu-id="ed0a1-230">UInt32</span><span class="sxs-lookup"><span data-stu-id="ed0a1-230">UInt32</span></span>|<span data-ttu-id="ed0a1-231">Wnioskowanie <xref:System.Data.SqlDbType> z UInt32 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-231">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="ed0a1-232">unsignedInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-232">UnsignedInt</span></span>|<span data-ttu-id="ed0a1-233">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-233">BigInt</span></span>|<span data-ttu-id="ed0a1-234">UInt32</span><span class="sxs-lookup"><span data-stu-id="ed0a1-234">UInt32</span></span>|  
|<xref:System.UInt64>|<span data-ttu-id="ed0a1-235">UInt64</span><span class="sxs-lookup"><span data-stu-id="ed0a1-235">UInt64</span></span>|<span data-ttu-id="ed0a1-236">Wnioskowanie <xref:System.Data.SqlDbType> z UInt64 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-236">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="ed0a1-237">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-237">UnsignedBigInt</span></span>|<span data-ttu-id="ed0a1-238">numeryczne</span><span class="sxs-lookup"><span data-stu-id="ed0a1-238">Numeric</span></span>|<span data-ttu-id="ed0a1-239">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="ed0a1-239">Number</span></span>|  
||<span data-ttu-id="ed0a1-240">AnsiString</span><span class="sxs-lookup"><span data-stu-id="ed0a1-240">AnsiString</span></span>|<span data-ttu-id="ed0a1-241">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-241">VarChar</span></span>|<span data-ttu-id="ed0a1-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-242">VarChar</span></span>|<span data-ttu-id="ed0a1-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-243">VarChar</span></span>|<span data-ttu-id="ed0a1-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-244">VarChar</span></span>|  
||<span data-ttu-id="ed0a1-245">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="ed0a1-245">AnsiStringFixedLength</span></span>|<span data-ttu-id="ed0a1-246">Char</span><span class="sxs-lookup"><span data-stu-id="ed0a1-246">Char</span></span>|<span data-ttu-id="ed0a1-247">Char</span><span class="sxs-lookup"><span data-stu-id="ed0a1-247">Char</span></span>|<span data-ttu-id="ed0a1-248">Char</span><span class="sxs-lookup"><span data-stu-id="ed0a1-248">Char</span></span>|<span data-ttu-id="ed0a1-249">Char</span><span class="sxs-lookup"><span data-stu-id="ed0a1-249">Char</span></span>|  
|``|<span data-ttu-id="ed0a1-250">Waluta</span><span class="sxs-lookup"><span data-stu-id="ed0a1-250">Currency</span></span>|<span data-ttu-id="ed0a1-251">oszczędność pieniędzy</span><span class="sxs-lookup"><span data-stu-id="ed0a1-251">Money</span></span>|<span data-ttu-id="ed0a1-252">Waluta</span><span class="sxs-lookup"><span data-stu-id="ed0a1-252">Currency</span></span>|<span data-ttu-id="ed0a1-253">Wnioskowanie `OdbcType` z `Currency` nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-253">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="ed0a1-254">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="ed0a1-254">Number</span></span>|  
|``|<span data-ttu-id="ed0a1-255">Data</span><span class="sxs-lookup"><span data-stu-id="ed0a1-255">Date</span></span>|<span data-ttu-id="ed0a1-256">Data w programie SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-256">Date in SQL Server 2008.</span></span> <span data-ttu-id="ed0a1-257">Wnioskowanie <xref:System.Data.SqlDbType> od daty nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-257">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="ed0a1-258">DBDate</span><span class="sxs-lookup"><span data-stu-id="ed0a1-258">DBDate</span></span>|<span data-ttu-id="ed0a1-259">Data</span><span class="sxs-lookup"><span data-stu-id="ed0a1-259">Date</span></span>|<span data-ttu-id="ed0a1-260">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-260">DateTime</span></span>|  
|``|<span data-ttu-id="ed0a1-261">SByte</span><span class="sxs-lookup"><span data-stu-id="ed0a1-261">SByte</span></span>|<span data-ttu-id="ed0a1-262">Wnioskowanie <xref:System.Data.SqlDbType> z SByte nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-262">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="ed0a1-263">TinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0a1-263">TinyInt</span></span>|<span data-ttu-id="ed0a1-264">Wnioskowanie `OdbcType` z SByte nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-264">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="ed0a1-265">SByte</span><span class="sxs-lookup"><span data-stu-id="ed0a1-265">SByte</span></span>|  
||<span data-ttu-id="ed0a1-266">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="ed0a1-266">StringFixedLength</span></span>|<span data-ttu-id="ed0a1-267">NChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-267">NChar</span></span>|<span data-ttu-id="ed0a1-268">WChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-268">WChar</span></span>|<span data-ttu-id="ed0a1-269">NChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-269">NChar</span></span>|<span data-ttu-id="ed0a1-270">NChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-270">NChar</span></span>|  
||<span data-ttu-id="ed0a1-271">Godzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-271">Time</span></span>|<span data-ttu-id="ed0a1-272">Czas w programie SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-272">Time in SQL Server 2008.</span></span> <span data-ttu-id="ed0a1-273">Wnioskowanie <xref:System.Data.SqlDbType> od czasu nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-273">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="ed0a1-274">DBTime</span><span class="sxs-lookup"><span data-stu-id="ed0a1-274">DBTime</span></span>|<span data-ttu-id="ed0a1-275">Godzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-275">Time</span></span>|<span data-ttu-id="ed0a1-276">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="ed0a1-276">DateTime</span></span>|  
||<span data-ttu-id="ed0a1-277">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="ed0a1-277">VarNumeric</span></span>|<span data-ttu-id="ed0a1-278">Wnioskowanie <xref:System.Data.SqlDbType> z VarNumeric nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-278">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="ed0a1-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="ed0a1-279">VarNumeric</span></span>|<span data-ttu-id="ed0a1-280">Wnioskowanie `OdbcType` z VarNumeric nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-280">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="ed0a1-281">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="ed0a1-281">Number</span></span>|  
|<span data-ttu-id="ed0a1-282">Typ zdefiniowany przez użytkownika (obiekt z<xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="ed0a1-282">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="ed0a1-283">Obiekt lub ciąg, w zależności od dostawcy (SqlClient zawsze zwraca obiekt, Odbc zawsze zwraca wartość typu ciąg, dostawcy danych zarządzanych OleDb zobaczyć albo</span><span class="sxs-lookup"><span data-stu-id="ed0a1-283">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="ed0a1-284">SqlDbType.Udt Jeśli <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> jest obecny, w przeciwnym razie Variant</span><span class="sxs-lookup"><span data-stu-id="ed0a1-284">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="ed0a1-285">OleDbType.VarWChar (jeśli ma wartość null) w przeciwnym razie OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-285">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="ed0a1-286">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="ed0a1-286">OdbcType.NVarChar</span></span>|<span data-ttu-id="ed0a1-287">Nieobsługiwane</span><span class="sxs-lookup"><span data-stu-id="ed0a1-287">not supported</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="ed0a1-288">Konwersje z dziesiętną na inne typy są zawężanie konwersji, które zaokrąglona wartość dziesiętna do najbliższej wartości całkowitej w kierunku zera.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-288">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="ed0a1-289">Jeśli wynik konwersji nie można przedstawić w typie docelowym <xref:System.OverflowException> jest generowany.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-289">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0a1-290">Wartość null parametru są wysyłane do serwera, należy określić <xref:System.DBNull>, a nie `null` (`Nothing` w [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="ed0a1-290">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="ed0a1-291">Wartość null w systemie jest pusty obiekt, który nie ma wartości.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-291">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="ed0a1-292"><xref:System.DBNull>jest używana do reprezentowania wartości null.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-292"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="ed0a1-293">Aby uzyskać więcej informacji o wartości null bazy danych, zobacz [Obsługa wartości zerowych](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="ed0a1-293">For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span></span>  
  
## <a name="deriving-parameter-information"></a><span data-ttu-id="ed0a1-294">Wyprowadzanie informacje o parametrach</span><span class="sxs-lookup"><span data-stu-id="ed0a1-294">Deriving Parameter Information</span></span>  
 <span data-ttu-id="ed0a1-295">Parametry mogą również pochodzić z za pomocą procedury składowanej `DbCommandBuilder` klasy.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-295">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="ed0a1-296">Zarówno `SqlCommandBuilder` i `OleDbCommandBuilder` klasy udostępnia metody statyczne, `DeriveParameters`, która automatycznie wypełnia kolekcję parametrów dla obiekt polecenia, który używa parametru informacji z procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-296">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="ed0a1-297">Należy pamiętać, że `DeriveParameters` zastępuje wszelkie istniejące informacje parametr dla polecenia.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-297">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0a1-298">Wyprowadzanie informacje o parametrach wiąże spadek wydajności, ponieważ wymaga dodatkowych operacji dostępu do źródła danych, aby pobrać informacje.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-298">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="ed0a1-299">Jeśli informacje o parametrach jest znany w czasie projektowania, może poprawić wydajność aplikacji, jawnie ustawiając parametrów.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-299">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>  
  
 <span data-ttu-id="ed0a1-300">Aby uzyskać więcej informacji, zobacz [generowania poleceń CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="ed0a1-300">For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span></span>  
  
## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="ed0a1-301">Przy użyciu parametrów z SqlCommand i procedury składowanej</span><span class="sxs-lookup"><span data-stu-id="ed0a1-301">Using Parameters with a SqlCommand and a Stored Procedure</span></span>  
 <span data-ttu-id="ed0a1-302">Procedury składowane oferują wiele zalet w aplikacjach opartych na danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-302">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="ed0a1-303">Przy użyciu procedur składowanych, operacje bazy danych można być hermetyzowany za pomocą jednego polecenia, zoptymalizowane pod kątem najlepszą wydajność i rozszerzona o dodatkowe zabezpieczenia.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-303">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="ed0a1-304">Mimo że można wywołać procedurę składowaną przez przekazanie nazwę procedury składowanej następuje argumenty parametrów jako instrukcji SQL przy użyciu <xref:System.Data.Common.DbCommand.Parameters%2A> Kolekcja [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> obiektu umożliwia bardziej jawnie definiować przechowywane Parametry procedur i dostępu do danych wyjściowych, parametrów i wartości zwracane.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-304">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0a1-305">Sparametryzowanych instrukcji są wykonywane na serwerze przy użyciu `sp_executesql,` co umożliwia ponowne planu zapytania.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-305">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="ed0a1-306">Kursory lokalne lub zmiennych w `sp_executesql` partii nie są widoczne dla partii, który wywołuje `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-306">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="ed0a1-307">Ostatnie zmiany w kontekście bazy danych tylko do końca `sp_executesql` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-307">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="ed0a1-308">Aby uzyskać więcej informacji zobacz dokumentację SQL Server — książki Online.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-308">For more information, see SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="ed0a1-309">Korzystając z parametrów z <xref:System.Data.SqlClient.SqlCommand> programu SQL Server wykonaj procedurę składowaną w, nazwy parametrów dodane do <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> kolekcji muszą być zgodne z nazwami znaczników parametr w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-309">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="ed0a1-310">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Dostawcy danych programu SQL Server nie obsługuje symbolu zastępczego znak zapytania (?) przekazywania parametrów do instrukcji SQL lub procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-310">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="ed0a1-311">Traktuje parametry w procedurze składowanej jako nazwane parametry, a wyszukuje dopasowywania parametru znaczników.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-311">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="ed0a1-312">Na przykład `CustOrderHist` procedury składowanej jest definiowana za pomocą parametru o nazwie `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-312">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="ed0a1-313">Po kodzie wykonuje procedurę składowaną, również należy użyć parametru o nazwie `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-313">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>  
  
```  
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  
```  
  
### <a name="example"></a><span data-ttu-id="ed0a1-314">Przykład</span><span class="sxs-lookup"><span data-stu-id="ed0a1-314">Example</span></span>  
 <span data-ttu-id="ed0a1-315">W tym przykładzie przedstawiono sposób wywoływania procedur składowanych serwera SQL `Northwind` przykładowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-315">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="ed0a1-316">Nazwa procedury składowanej jest `dbo.SalesByCategory` i zawiera parametru wejściowego o nazwie `@CategoryName` z typem danych `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-316">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="ed0a1-317">Kod tworzy nową <xref:System.Data.SqlClient.SqlConnection> wewnątrz using zablokować, tak aby połączenie zostanie usunięty po zakończeniu procedury.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-317">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="ed0a1-318"><xref:System.Data.SqlClient.SqlCommand> i <xref:System.Data.SqlClient.SqlParameter> obiekty są tworzone i ustawić ich właściwości.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-318">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="ed0a1-319">A <xref:System.Data.SqlClient.SqlDataReader> wykonuje `SqlCommand` i zwraca zestawu wyników z procedury składowanej, wyświetlając dane wyjściowe w oknie konsoli.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-319">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0a1-320">Zamiast tworzyć `SqlCommand` i `SqlParameter` obiektów, a następnie ustawić właściwości w osobnych instrukcji, można zamiast tego wybrać opcję Użyj jednej z przeciążone konstruktory do ustawiania wielu właściwości w jednej instrukcji.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-320">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  
  
## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="ed0a1-321">Przy użyciu parametrów przy użyciu OleDbCommand lub OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="ed0a1-321">Using Parameters with an OleDbCommand or OdbcCommand</span></span>  
 <span data-ttu-id="ed0a1-322">Korzystając z parametrów z <xref:System.Data.OleDb.OleDbCommand> lub <xref:System.Data.Odbc.OdbcCommand>, kolejność parametrów dodanych do `Parameters` kolekcji muszą być zgodne kolejność parametrów zdefiniowanych w procedury przechowywanej.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-322">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="ed0a1-323">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Dostawcy danych OLE DB i [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dostawcy danych ODBC Traktuj parametry w procedurze składowanej jako symbole zastępcze i zastosować wartości parametrów w kolejności.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-323">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="ed0a1-324">Ponadto zwrócić wartość parametrów musi być pierwszym parametry dodane do `Parameters` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-324">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>  
  
 <span data-ttu-id="ed0a1-325">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Dostawcy danych OLE DB i [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dostawcy danych ODBC nie obsługują parametrów nazwanych parametrów może być przekazywany do instrukcji SQL lub procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-325">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="ed0a1-326">W takim przypadku należy użyć symbolu zastępczego znak zapytania (?), jak w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-326">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>  
  
```  
SELECT * FROM Customers WHERE CustomerID = ?  
```  
  
 <span data-ttu-id="ed0a1-327">W rezultacie, w kolejności `Parameter` obiekty są dodawane do `Parameters` kolekcji bezpośrednio musi odpowiadać pozycja?</span><span class="sxs-lookup"><span data-stu-id="ed0a1-327">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="ed0a1-328">symbol zastępczy dla parametru.</span><span class="sxs-lookup"><span data-stu-id="ed0a1-328">placeholder for the parameter.</span></span>  
  
### <a name="oledb-example"></a><span data-ttu-id="ed0a1-329">Przykład OleDb</span><span class="sxs-lookup"><span data-stu-id="ed0a1-329">OleDb Example</span></span>  
  
```vb  
Dim command As OleDbCommand = New OleDbCommand( _  
  "SampleProc", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OleDbParameter = command.Parameters.Add( _  
  "RETURN_VALUE", OleDbType.Integer)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OleDbType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OleDbType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OleDbCommand command = new OleDbCommand("SampleProc", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OleDbParameter parameter = command.Parameters.Add(  
  "RETURN_VALUE", OleDbType.Integer);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add(  
  "@InputParm", OleDbType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add(  
  "@OutputParm", OleDbType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="odbc-example"></a><span data-ttu-id="ed0a1-330">Przykład ODBC</span><span class="sxs-lookup"><span data-stu-id="ed0a1-330">Odbc Example</span></span>  
  
```vb  
Dim command As OdbcCommand = New OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OdbcCommand command = new OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OdbcParameter parameter = command.Parameters.Add( _  
  "RETURN_VALUE", OdbcType.Int);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="see-also"></a><span data-ttu-id="ed0a1-331">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="ed0a1-331">See Also</span></span>  
 [<span data-ttu-id="ed0a1-332">Polecenia i parametry</span><span class="sxs-lookup"><span data-stu-id="ed0a1-332">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="ed0a1-333">Parametry elementu DataAdapter</span><span class="sxs-lookup"><span data-stu-id="ed0a1-333">DataAdapter Parameters</span></span>](../../../../docs/framework/data/adonet/dataadapter-parameters.md)  
 [<span data-ttu-id="ed0a1-334">Mapowanie typu danych w ADO.NET</span><span class="sxs-lookup"><span data-stu-id="ed0a1-334">Data Type Mappings in ADO.NET</span></span>](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)  
 [<span data-ttu-id="ed0a1-335">ADO.NET zarządzanego dostawcy i zestawu danych w Centrum deweloperów</span><span class="sxs-lookup"><span data-stu-id="ed0a1-335">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
