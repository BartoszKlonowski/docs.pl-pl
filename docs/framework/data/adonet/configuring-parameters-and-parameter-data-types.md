---
title: Konfigurowanie parametrów i typów danych parametrów
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: 638e8177060c489a7469f80adde68cb9ba266365
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/19/2019
ms.locfileid: "65879970"
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="8788a-102">Konfigurowanie parametrów i typów danych parametrów</span><span class="sxs-lookup"><span data-stu-id="8788a-102">Configuring parameters and parameter data types</span></span>

<span data-ttu-id="8788a-103">Obiekty poleceń parametry do przekazania wartości do instrukcji SQL lub procedur składowanych, zapewniając sprawdzania typu i weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="8788a-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="8788a-104">W przeciwieństwie do tekstu polecenia wprowadzanie parametrów jest traktowany jako literał, nie jako kod wykonywalny.</span><span class="sxs-lookup"><span data-stu-id="8788a-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="8788a-105">Dzięki temu można zabezpieczyć się przed "SQL" wstrzyknięciu kodu, w których osoba atakująca Wstawia polecenie Zabezpieczenia naruszeń na serwerze do instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="8788a-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>

<span data-ttu-id="8788a-106">Poleceń sparametryzowanych może również zwiększyć wydajność wykonywania zapytań, ponieważ pomagają dokładne dopasowanie przychodzące polecenie z planu prawidłowego zapytania w pamięci podręcznej serwera bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8788a-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="8788a-107">Aby uzyskać więcej informacji, zobacz [wykonywania Plan pamięci podręcznej i ponowne użycie](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) i [parametrów i wykonanie planu ponowne użycie](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span><span class="sxs-lookup"><span data-stu-id="8788a-107">For more information, see [Execution Plan Caching and Reuse](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) and [Parameters and Execution Plan Reuse](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span></span> <span data-ttu-id="8788a-108">Oprócz korzyści bezpieczeństwo i wydajność poleceń sparametryzowanych zapewniają wygodną metodę służący do organizowania wartości przekazane do źródła danych.</span><span class="sxs-lookup"><span data-stu-id="8788a-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>

<span data-ttu-id="8788a-109">A <xref:System.Data.Common.DbParameter> obiektu można utworzyć za pomocą jej konstruktora lub przez dodanie jej do <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> przez wywołanie metody `Add` metody <xref:System.Data.Common.DbParameterCollection> kolekcji.</span><span class="sxs-lookup"><span data-stu-id="8788a-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="8788a-110">`Add` Metoda zajmie się jako dane wejściowe w argumentach konstruktora lub parametr obiektu, w zależności od dostawcy danych.</span><span class="sxs-lookup"><span data-stu-id="8788a-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>

## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="8788a-111">Udostępnia właściwości ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="8788a-111">Supplying the ParameterDirection property</span></span>

<span data-ttu-id="8788a-112">Dodając parametry, należy podać <xref:System.Data.ParameterDirection> właściwość parametrów innych niż parametrów wejściowych.</span><span class="sxs-lookup"><span data-stu-id="8788a-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="8788a-113">W poniższej tabeli przedstawiono `ParameterDirection` wartości, które można używać z <xref:System.Data.ParameterDirection> wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="8788a-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>

|<span data-ttu-id="8788a-114">Nazwa elementu członkowskiego</span><span class="sxs-lookup"><span data-stu-id="8788a-114">Member name</span></span>|<span data-ttu-id="8788a-115">Opis</span><span class="sxs-lookup"><span data-stu-id="8788a-115">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="8788a-116">Parametr jest parametrem wejściowym.</span><span class="sxs-lookup"><span data-stu-id="8788a-116">The parameter is an input parameter.</span></span> <span data-ttu-id="8788a-117">Domyślnie włączone.</span><span class="sxs-lookup"><span data-stu-id="8788a-117">This is the default.</span></span>|
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="8788a-118">Parametr można wykonywać zarówno dane wejściowe i wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="8788a-118">The parameter can perform both input and output.</span></span>|
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="8788a-119">Parametr jest parametrem wyjściowym.</span><span class="sxs-lookup"><span data-stu-id="8788a-119">The parameter is an output parameter.</span></span>|
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="8788a-120">Parametr reprezentuje wartość zwracana z operacji, takich jak procedury składowanej, funkcji wbudowanej lub funkcję zdefiniowaną przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8788a-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|

## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="8788a-121">Praca z symbolami zastępczymi parametru</span><span class="sxs-lookup"><span data-stu-id="8788a-121">Working with parameter placeholders</span></span>

<span data-ttu-id="8788a-122">Składnia dla symboli zastępczych parametru zależy od źródła danych.</span><span class="sxs-lookup"><span data-stu-id="8788a-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="8788a-123">Dostawcy danych .NET Framework obsługują nazewnictwa i określanie parametrów i symbole zastępcze parametr inaczej.</span><span class="sxs-lookup"><span data-stu-id="8788a-123">The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="8788a-124">Ta składnia jest dostosowane do określonego źródła danych, zgodnie z opisem w poniższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="8788a-124">This syntax is customized to a specific data source, as described in the following table.</span></span>

|<span data-ttu-id="8788a-125">Dostawca danych</span><span class="sxs-lookup"><span data-stu-id="8788a-125">Data provider</span></span>|<span data-ttu-id="8788a-126">Składnia nazwy parametru</span><span class="sxs-lookup"><span data-stu-id="8788a-126">Parameter naming syntax</span></span>|
|-------------------|-----------------------------|
|<xref:System.Data.SqlClient>|<span data-ttu-id="8788a-127">Korzysta z nazwanych parametrów w formacie `@` *parametername*.</span><span class="sxs-lookup"><span data-stu-id="8788a-127">Uses named parameters in the format `@`*parametername*.</span></span>|
|<xref:System.Data.OleDb>|<span data-ttu-id="8788a-128">Używa wskaźników parametr pozycyjne wskazywanym przez znak zapytania (`?`).</span><span class="sxs-lookup"><span data-stu-id="8788a-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.Odbc>|<span data-ttu-id="8788a-129">Używa wskaźników parametr pozycyjne wskazywanym przez znak zapytania (`?`).</span><span class="sxs-lookup"><span data-stu-id="8788a-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.OracleClient>|<span data-ttu-id="8788a-130">Korzysta z nazwanych parametrów w formacie `:` *parmname* (lub *parmname*).</span><span class="sxs-lookup"><span data-stu-id="8788a-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|

## <a name="specifying-parameter-data-types"></a><span data-ttu-id="8788a-131">Określenie typów danych parametrów</span><span class="sxs-lookup"><span data-stu-id="8788a-131">Specifying parameter data types</span></span>

<span data-ttu-id="8788a-132">Typ danych parametru jest specyficzne dla dostawcy danych .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8788a-132">The data type of a parameter is specific to the .NET Framework data provider.</span></span> <span data-ttu-id="8788a-133">Określenie typu konwertuje wartość `Parameter` typ dostawcy danych .NET Framework przed przekazaniem wartości do źródła danych.</span><span class="sxs-lookup"><span data-stu-id="8788a-133">Specifying the type converts the value of the `Parameter` to the .NET Framework data provider type before passing the value to the data source.</span></span> <span data-ttu-id="8788a-134">Możesz również określić typ `Parameter` w sposób ogólny, ustawiając `DbType` właściwość `Parameter` obiektu do określonego <xref:System.Data.DbType>.</span><span class="sxs-lookup"><span data-stu-id="8788a-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>

<span data-ttu-id="8788a-135">Typ dostawcy danych .NET Framework z `Parameter` obiektu jest wnioskowany z typu .NET Framework `Value` z `Parameter` obiektu, albo z `DbType` z `Parameter` obiektu.</span><span class="sxs-lookup"><span data-stu-id="8788a-135">The .NET Framework data provider type of a `Parameter` object is inferred from the .NET Framework type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="8788a-136">W poniższej tabeli przedstawiono wywnioskowane `Parameter` typ oparty na obiekcie, który został przekazany jako `Parameter` wartość lub określone `DbType`.</span><span class="sxs-lookup"><span data-stu-id="8788a-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>

|<span data-ttu-id="8788a-137">Typ programu .NET Framework</span><span class="sxs-lookup"><span data-stu-id="8788a-137">.NET Framework type</span></span>|<span data-ttu-id="8788a-138">DbType</span><span class="sxs-lookup"><span data-stu-id="8788a-138">DbType</span></span>|<span data-ttu-id="8788a-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="8788a-139">SqlDbType</span></span>|<span data-ttu-id="8788a-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="8788a-140">OleDbType</span></span>|<span data-ttu-id="8788a-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="8788a-141">OdbcType</span></span>|<span data-ttu-id="8788a-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="8788a-142">OracleType</span></span>|
|-------------------------|------------|---------------|---------------|--------------|----------------|
|<xref:System.Boolean>|<span data-ttu-id="8788a-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="8788a-143">Boolean</span></span>|<span data-ttu-id="8788a-144">Bit</span><span class="sxs-lookup"><span data-stu-id="8788a-144">Bit</span></span>|<span data-ttu-id="8788a-145">Boolean</span><span class="sxs-lookup"><span data-stu-id="8788a-145">Boolean</span></span>|<span data-ttu-id="8788a-146">Bit</span><span class="sxs-lookup"><span data-stu-id="8788a-146">Bit</span></span>|<span data-ttu-id="8788a-147">Byte</span><span class="sxs-lookup"><span data-stu-id="8788a-147">Byte</span></span>|
|<xref:System.Byte>|<span data-ttu-id="8788a-148">Byte</span><span class="sxs-lookup"><span data-stu-id="8788a-148">Byte</span></span>|<span data-ttu-id="8788a-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="8788a-149">TinyInt</span></span>|<span data-ttu-id="8788a-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="8788a-150">UnsignedTinyInt</span></span>|<span data-ttu-id="8788a-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="8788a-151">TinyInt</span></span>|<span data-ttu-id="8788a-152">Byte</span><span class="sxs-lookup"><span data-stu-id="8788a-152">Byte</span></span>|
|<span data-ttu-id="8788a-153">byte[]</span><span class="sxs-lookup"><span data-stu-id="8788a-153">byte[]</span></span>|<span data-ttu-id="8788a-154">plików binarnych</span><span class="sxs-lookup"><span data-stu-id="8788a-154">Binary</span></span>|<span data-ttu-id="8788a-155">VarBinary.</span><span class="sxs-lookup"><span data-stu-id="8788a-155">VarBinary.</span></span> <span data-ttu-id="8788a-156">To niejawna konwersja nie powiedzie się, jeśli tablica bajtów jest większy niż maksymalny rozmiar wartości typu VarBinary, czyli 8000 bajtów. Dla tablic bajtów jest większa niż 8000 bajtów, należy jawnie ustawić <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="8788a-156">This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="8788a-157">VarBinary</span><span class="sxs-lookup"><span data-stu-id="8788a-157">VarBinary</span></span>|<span data-ttu-id="8788a-158">plików binarnych</span><span class="sxs-lookup"><span data-stu-id="8788a-158">Binary</span></span>|<span data-ttu-id="8788a-159">nieprzetworzone</span><span class="sxs-lookup"><span data-stu-id="8788a-159">Raw</span></span>|
|<xref:System.Char>| |<span data-ttu-id="8788a-160">Wnioskowanie <xref:System.Data.SqlDbType> z char nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-160">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="8788a-161">Char</span><span class="sxs-lookup"><span data-stu-id="8788a-161">Char</span></span>|<span data-ttu-id="8788a-162">Char</span><span class="sxs-lookup"><span data-stu-id="8788a-162">Char</span></span>|<span data-ttu-id="8788a-163">Byte</span><span class="sxs-lookup"><span data-stu-id="8788a-163">Byte</span></span>|
|<xref:System.DateTime>|<span data-ttu-id="8788a-164">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-164">DateTime</span></span>|<span data-ttu-id="8788a-165">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-165">DateTime</span></span>|<span data-ttu-id="8788a-166">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="8788a-166">DBTimeStamp</span></span>|<span data-ttu-id="8788a-167">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-167">DateTime</span></span>|<span data-ttu-id="8788a-168">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-168">DateTime</span></span>|
|<xref:System.DateTimeOffset>|<span data-ttu-id="8788a-169">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="8788a-169">DateTimeOffset</span></span>|<span data-ttu-id="8788a-170">DateTimeOffset programu SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-170">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="8788a-171">Wnioskowanie <xref:System.Data.SqlDbType> z DateTimeOffset nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-171">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="8788a-172">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-172">DateTime</span></span>|
|<xref:System.Decimal>|<span data-ttu-id="8788a-173">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="8788a-173">Decimal</span></span>|<span data-ttu-id="8788a-174">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="8788a-174">Decimal</span></span>|<span data-ttu-id="8788a-175">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="8788a-175">Decimal</span></span>|<span data-ttu-id="8788a-176">Numeric</span><span class="sxs-lookup"><span data-stu-id="8788a-176">Numeric</span></span>|<span data-ttu-id="8788a-177">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="8788a-177">Number</span></span>|
|<xref:System.Double>|<span data-ttu-id="8788a-178">Double</span><span class="sxs-lookup"><span data-stu-id="8788a-178">Double</span></span>|<span data-ttu-id="8788a-179">Float</span><span class="sxs-lookup"><span data-stu-id="8788a-179">Float</span></span>|<span data-ttu-id="8788a-180">Podwójne</span><span class="sxs-lookup"><span data-stu-id="8788a-180">Double</span></span>|<span data-ttu-id="8788a-181">Podwójne</span><span class="sxs-lookup"><span data-stu-id="8788a-181">Double</span></span>|<span data-ttu-id="8788a-182">Double</span><span class="sxs-lookup"><span data-stu-id="8788a-182">Double</span></span>|
|<xref:System.Single>|<span data-ttu-id="8788a-183">Single</span><span class="sxs-lookup"><span data-stu-id="8788a-183">Single</span></span>|<span data-ttu-id="8788a-184">Rzeczywiste</span><span class="sxs-lookup"><span data-stu-id="8788a-184">Real</span></span>|<span data-ttu-id="8788a-185">Single</span><span class="sxs-lookup"><span data-stu-id="8788a-185">Single</span></span>|<span data-ttu-id="8788a-186">Rzeczywiste</span><span class="sxs-lookup"><span data-stu-id="8788a-186">Real</span></span>|<span data-ttu-id="8788a-187">Float</span><span class="sxs-lookup"><span data-stu-id="8788a-187">Float</span></span>|
|<xref:System.Guid>|<span data-ttu-id="8788a-188">Guid</span><span class="sxs-lookup"><span data-stu-id="8788a-188">Guid</span></span>|<span data-ttu-id="8788a-189">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="8788a-189">UniqueIdentifier</span></span>|<span data-ttu-id="8788a-190">Guid</span><span class="sxs-lookup"><span data-stu-id="8788a-190">Guid</span></span>|<span data-ttu-id="8788a-191">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="8788a-191">UniqueIdentifier</span></span>|<span data-ttu-id="8788a-192">nieprzetworzone</span><span class="sxs-lookup"><span data-stu-id="8788a-192">Raw</span></span>|
|<xref:System.Int16>|<span data-ttu-id="8788a-193">Int16</span><span class="sxs-lookup"><span data-stu-id="8788a-193">Int16</span></span>|<span data-ttu-id="8788a-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="8788a-194">SmallInt</span></span>|<span data-ttu-id="8788a-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="8788a-195">SmallInt</span></span>|<span data-ttu-id="8788a-196">SmallInt</span><span class="sxs-lookup"><span data-stu-id="8788a-196">SmallInt</span></span>|<span data-ttu-id="8788a-197">Int16</span><span class="sxs-lookup"><span data-stu-id="8788a-197">Int16</span></span>|
|<xref:System.Int32>|<span data-ttu-id="8788a-198">Int32</span><span class="sxs-lookup"><span data-stu-id="8788a-198">Int32</span></span>|<span data-ttu-id="8788a-199">int</span><span class="sxs-lookup"><span data-stu-id="8788a-199">Int</span></span>|<span data-ttu-id="8788a-200">int</span><span class="sxs-lookup"><span data-stu-id="8788a-200">Int</span></span>|<span data-ttu-id="8788a-201">int</span><span class="sxs-lookup"><span data-stu-id="8788a-201">Int</span></span>|<span data-ttu-id="8788a-202">Int32</span><span class="sxs-lookup"><span data-stu-id="8788a-202">Int32</span></span>|
|<xref:System.Int64>|<span data-ttu-id="8788a-203">Int64</span><span class="sxs-lookup"><span data-stu-id="8788a-203">Int64</span></span>|<span data-ttu-id="8788a-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="8788a-204">BigInt</span></span>|<span data-ttu-id="8788a-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="8788a-205">BigInt</span></span>|<span data-ttu-id="8788a-206">BigInt</span><span class="sxs-lookup"><span data-stu-id="8788a-206">BigInt</span></span>|<span data-ttu-id="8788a-207">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="8788a-207">Number</span></span>|
|<xref:System.Object>|<span data-ttu-id="8788a-208">Obiekt</span><span class="sxs-lookup"><span data-stu-id="8788a-208">Object</span></span>|<span data-ttu-id="8788a-209">Variant</span><span class="sxs-lookup"><span data-stu-id="8788a-209">Variant</span></span>|<span data-ttu-id="8788a-210">Variant</span><span class="sxs-lookup"><span data-stu-id="8788a-210">Variant</span></span>|<span data-ttu-id="8788a-211">Wnioskowanie OdbcType z obiektu nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-211">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="8788a-212">Blob</span><span class="sxs-lookup"><span data-stu-id="8788a-212">Blob</span></span>|
|<xref:System.String>|<span data-ttu-id="8788a-213">String</span><span class="sxs-lookup"><span data-stu-id="8788a-213">String</span></span>|<span data-ttu-id="8788a-214">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="8788a-214">NVarChar.</span></span> <span data-ttu-id="8788a-215">To niejawna konwersja nie powiedzie się, jeśli ciąg jest większy niż maksymalny rozmiar typu NVarChar to 4000 znaków.</span><span class="sxs-lookup"><span data-stu-id="8788a-215">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="8788a-216">Ciągi większej niż 4000 znaków, należy jawnie ustawić <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="8788a-216">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="8788a-217">VarWChar</span><span class="sxs-lookup"><span data-stu-id="8788a-217">VarWChar</span></span>|<span data-ttu-id="8788a-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="8788a-218">NVarChar</span></span>|<span data-ttu-id="8788a-219">NVarChar</span><span class="sxs-lookup"><span data-stu-id="8788a-219">NVarChar</span></span>|
|<xref:System.TimeSpan>|<span data-ttu-id="8788a-220">Godzina</span><span class="sxs-lookup"><span data-stu-id="8788a-220">Time</span></span>|<span data-ttu-id="8788a-221">Czas w programie SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-221">Time in SQL Server 2008.</span></span> <span data-ttu-id="8788a-222">Wnioskowanie <xref:System.Data.SqlDbType> z przedziału czasu nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-222">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="8788a-223">DBTime</span><span class="sxs-lookup"><span data-stu-id="8788a-223">DBTime</span></span>|<span data-ttu-id="8788a-224">Godzina</span><span class="sxs-lookup"><span data-stu-id="8788a-224">Time</span></span>|<span data-ttu-id="8788a-225">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-225">DateTime</span></span>|
|<xref:System.UInt16>|<span data-ttu-id="8788a-226">UInt16</span><span class="sxs-lookup"><span data-stu-id="8788a-226">UInt16</span></span>|<span data-ttu-id="8788a-227">Wnioskowanie <xref:System.Data.SqlDbType> z UInt16 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-227">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="8788a-228">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="8788a-228">UnsignedSmallInt</span></span>|<span data-ttu-id="8788a-229">int</span><span class="sxs-lookup"><span data-stu-id="8788a-229">Int</span></span>|<span data-ttu-id="8788a-230">UInt16</span><span class="sxs-lookup"><span data-stu-id="8788a-230">UInt16</span></span>|
|<xref:System.UInt32>|<span data-ttu-id="8788a-231">UInt32</span><span class="sxs-lookup"><span data-stu-id="8788a-231">UInt32</span></span>|<span data-ttu-id="8788a-232">Wnioskowanie <xref:System.Data.SqlDbType> z UInt32 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-232">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="8788a-233">unsignedInt</span><span class="sxs-lookup"><span data-stu-id="8788a-233">UnsignedInt</span></span>|<span data-ttu-id="8788a-234">BigInt</span><span class="sxs-lookup"><span data-stu-id="8788a-234">BigInt</span></span>|<span data-ttu-id="8788a-235">UInt32</span><span class="sxs-lookup"><span data-stu-id="8788a-235">UInt32</span></span>|
|<xref:System.UInt64>|<span data-ttu-id="8788a-236">UInt64</span><span class="sxs-lookup"><span data-stu-id="8788a-236">UInt64</span></span>|<span data-ttu-id="8788a-237">Wnioskowanie <xref:System.Data.SqlDbType> z UInt64 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-237">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="8788a-238">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="8788a-238">UnsignedBigInt</span></span>|<span data-ttu-id="8788a-239">Numeric</span><span class="sxs-lookup"><span data-stu-id="8788a-239">Numeric</span></span>|<span data-ttu-id="8788a-240">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="8788a-240">Number</span></span>|
||<span data-ttu-id="8788a-241">AnsiString</span><span class="sxs-lookup"><span data-stu-id="8788a-241">AnsiString</span></span>|<span data-ttu-id="8788a-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="8788a-242">VarChar</span></span>|<span data-ttu-id="8788a-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="8788a-243">VarChar</span></span>|<span data-ttu-id="8788a-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="8788a-244">VarChar</span></span>|<span data-ttu-id="8788a-245">VarChar</span><span class="sxs-lookup"><span data-stu-id="8788a-245">VarChar</span></span>|
||<span data-ttu-id="8788a-246">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="8788a-246">AnsiStringFixedLength</span></span>|<span data-ttu-id="8788a-247">Char</span><span class="sxs-lookup"><span data-stu-id="8788a-247">Char</span></span>|<span data-ttu-id="8788a-248">Char</span><span class="sxs-lookup"><span data-stu-id="8788a-248">Char</span></span>|<span data-ttu-id="8788a-249">Char</span><span class="sxs-lookup"><span data-stu-id="8788a-249">Char</span></span>|<span data-ttu-id="8788a-250">Char</span><span class="sxs-lookup"><span data-stu-id="8788a-250">Char</span></span>|
||<span data-ttu-id="8788a-251">Waluta</span><span class="sxs-lookup"><span data-stu-id="8788a-251">Currency</span></span>|<span data-ttu-id="8788a-252">money</span><span class="sxs-lookup"><span data-stu-id="8788a-252">Money</span></span>|<span data-ttu-id="8788a-253">Waluta</span><span class="sxs-lookup"><span data-stu-id="8788a-253">Currency</span></span>|<span data-ttu-id="8788a-254">Wnioskowanie `OdbcType` z `Currency` nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-254">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="8788a-255">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="8788a-255">Number</span></span>|
||<span data-ttu-id="8788a-256">Data</span><span class="sxs-lookup"><span data-stu-id="8788a-256">Date</span></span>|<span data-ttu-id="8788a-257">Data w programie SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-257">Date in SQL Server 2008.</span></span> <span data-ttu-id="8788a-258">Wnioskowanie <xref:System.Data.SqlDbType> od daty nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-258">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="8788a-259">DBDate</span><span class="sxs-lookup"><span data-stu-id="8788a-259">DBDate</span></span>|<span data-ttu-id="8788a-260">Data</span><span class="sxs-lookup"><span data-stu-id="8788a-260">Date</span></span>|<span data-ttu-id="8788a-261">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-261">DateTime</span></span>|
||<span data-ttu-id="8788a-262">SByte</span><span class="sxs-lookup"><span data-stu-id="8788a-262">SByte</span></span>|<span data-ttu-id="8788a-263">Wnioskowanie <xref:System.Data.SqlDbType> z SByte nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-263">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="8788a-264">TinyInt</span><span class="sxs-lookup"><span data-stu-id="8788a-264">TinyInt</span></span>|<span data-ttu-id="8788a-265">Wnioskowanie `OdbcType` z SByte nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-265">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="8788a-266">SByte</span><span class="sxs-lookup"><span data-stu-id="8788a-266">SByte</span></span>|
||<span data-ttu-id="8788a-267">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="8788a-267">StringFixedLength</span></span>|<span data-ttu-id="8788a-268">NChar</span><span class="sxs-lookup"><span data-stu-id="8788a-268">NChar</span></span>|<span data-ttu-id="8788a-269">WChar</span><span class="sxs-lookup"><span data-stu-id="8788a-269">WChar</span></span>|<span data-ttu-id="8788a-270">NChar</span><span class="sxs-lookup"><span data-stu-id="8788a-270">NChar</span></span>|<span data-ttu-id="8788a-271">NChar</span><span class="sxs-lookup"><span data-stu-id="8788a-271">NChar</span></span>|
||<span data-ttu-id="8788a-272">Godzina</span><span class="sxs-lookup"><span data-stu-id="8788a-272">Time</span></span>|<span data-ttu-id="8788a-273">Czas w programie SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-273">Time in SQL Server 2008.</span></span> <span data-ttu-id="8788a-274">Wnioskowanie <xref:System.Data.SqlDbType> od czasu nie jest obsługiwany w wersjach programu SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="8788a-274">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="8788a-275">DBTime</span><span class="sxs-lookup"><span data-stu-id="8788a-275">DBTime</span></span>|<span data-ttu-id="8788a-276">Godzina</span><span class="sxs-lookup"><span data-stu-id="8788a-276">Time</span></span>|<span data-ttu-id="8788a-277">DataGodzina</span><span class="sxs-lookup"><span data-stu-id="8788a-277">DateTime</span></span>|
||<span data-ttu-id="8788a-278">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="8788a-278">VarNumeric</span></span>|<span data-ttu-id="8788a-279">Wnioskowanie <xref:System.Data.SqlDbType> z VarNumeric nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-279">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="8788a-280">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="8788a-280">VarNumeric</span></span>|<span data-ttu-id="8788a-281">Wnioskowanie `OdbcType` z VarNumeric nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="8788a-281">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="8788a-282">Wartość liczbowa</span><span class="sxs-lookup"><span data-stu-id="8788a-282">Number</span></span>|
|<span data-ttu-id="8788a-283">Typ zdefiniowany przez użytkownika (obiektu przy użyciu <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="8788a-283">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="8788a-284">Obiekt lub ciąg, w zależności od dostawcy (SqlClient zawsze zwraca obiekt, Odbc zawsze zwraca wartość typu ciąg, a następnie zobaczyć albo dostawcy danych zarządzanych OleDb</span><span class="sxs-lookup"><span data-stu-id="8788a-284">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="8788a-285">SqlDbType.Udt Jeśli <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> jest obecna, w przeciwnym razie Variant</span><span class="sxs-lookup"><span data-stu-id="8788a-285">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="8788a-286">OleDbType.VarWChar (jeśli ma wartość null) OleDbType.Variant inaczej.</span><span class="sxs-lookup"><span data-stu-id="8788a-286">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="8788a-287">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="8788a-287">OdbcType.NVarChar</span></span>|<span data-ttu-id="8788a-288">Nie jest obsługiwany</span><span class="sxs-lookup"><span data-stu-id="8788a-288">not supported</span></span>|

> [!NOTE]
> <span data-ttu-id="8788a-289">Konwersja dziesiętne na inne typy są zawężających, które zaokrąglona wartość dziesiętną do najbliższej wartości całkowitej w kierunku zera.</span><span class="sxs-lookup"><span data-stu-id="8788a-289">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="8788a-290">Jeśli wynik konwersji nie jest stałego w typie docelowym <xref:System.OverflowException> zgłaszany.</span><span class="sxs-lookup"><span data-stu-id="8788a-290">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="8788a-291">Wartość parametru o wartości null jest wysyłany do serwera, należy określić <xref:System.DBNull>, a nie `null` (`Nothing` w języku Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="8788a-291">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="8788a-292">Wartość null w systemie jest pusty obiekt, który nie ma wartości.</span><span class="sxs-lookup"><span data-stu-id="8788a-292">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="8788a-293"><xref:System.DBNull> jest używana do reprezentowania wartości null.</span><span class="sxs-lookup"><span data-stu-id="8788a-293"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="8788a-294">Aby uzyskać więcej informacji o wartości null w bazie danych, zobacz [Obsługa wartości zerowych](./sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="8788a-294">For more information about database nulls, see [Handling Null Values](./sql/handling-null-values.md).</span></span>

## <a name="deriving-parameter-information"></a><span data-ttu-id="8788a-295">Wyprowadzanie informacje o parametrach</span><span class="sxs-lookup"><span data-stu-id="8788a-295">Deriving parameter information</span></span>

<span data-ttu-id="8788a-296">Parametry mogą również pochodzić z procedury składowanej przy użyciu `DbCommandBuilder` klasy.</span><span class="sxs-lookup"><span data-stu-id="8788a-296">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="8788a-297">Zarówno `SqlCommandBuilder` i `OleDbCommandBuilder` klasy zapewniają statycznej metody `DeriveParameters`, który automatycznie wypełnia kolekcję parametrów obiektu polecenia, który używa parametru informacji z procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="8788a-297">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="8788a-298">Należy pamiętać, że `DeriveParameters` zastępuje wszelkie istniejące informacje parametr dla polecenia.</span><span class="sxs-lookup"><span data-stu-id="8788a-298">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>

> [!NOTE]
> <span data-ttu-id="8788a-299">Wyprowadzanie informacje o parametrach powoduje spadek wydajności, ponieważ wymaga ona dodatkowej komunikacji dwustronnej źródła danych, aby pobrać informacje.</span><span class="sxs-lookup"><span data-stu-id="8788a-299">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="8788a-300">Jeśli informacje o parametrach jest znany w czasie projektowania, może zwiększyć wydajność aplikacji, jawnie ustawiając parametrów.</span><span class="sxs-lookup"><span data-stu-id="8788a-300">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>

<span data-ttu-id="8788a-301">Aby uzyskać więcej informacji, zobacz [Generowanie poleceń za pomocą CommandBuilders](generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="8788a-301">For more information, see [Generating Commands with CommandBuilders](generating-commands-with-commandbuilders.md).</span></span>

## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="8788a-302">Przy użyciu parametrów SqlCommand i procedury składowanej</span><span class="sxs-lookup"><span data-stu-id="8788a-302">Using parameters with a SqlCommand and a stored procedure</span></span>

<span data-ttu-id="8788a-303">Procedury składowane oferują wiele zalet w aplikacjach opartych na danych.</span><span class="sxs-lookup"><span data-stu-id="8788a-303">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="8788a-304">Za pomocą procedur składowanych, operacje bazy danych można być hermetyzowane w pojedynczym poleceniu, zoptymalizowane pod kątem uzyskania najlepszej wydajności i rozszerzone o dodatkowe zabezpieczenia.</span><span class="sxs-lookup"><span data-stu-id="8788a-304">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="8788a-305">Chociaż procedury składowanej może być wywoływany przez przekazanie nazwy procedury składowanej, następuje argumenty parametrów jako instrukcji SQL przy użyciu <xref:System.Data.Common.DbCommand.Parameters%2A> zbiór ADO.NET <xref:System.Data.Common.DbCommand> obiektu pozwala na zdefiniowanie bardziej jawny sposób procedury składowanej Parametry i dostęp do danych wyjściowych, parametrów i wartości zwracane.</span><span class="sxs-lookup"><span data-stu-id="8788a-305">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the ADO.NET <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>

> [!NOTE]
> <span data-ttu-id="8788a-306">Sparametryzowanych instrukcji są wykonywane na serwerze przy użyciu `sp_executesql,` pozwalający do ponownego wykorzystania planu zapytania.</span><span class="sxs-lookup"><span data-stu-id="8788a-306">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="8788a-307">Kursory lokalne lub zmiennych w `sp_executesql` usługi batch nie są widoczne dla usługi batch, która wywołuje `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="8788a-307">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="8788a-308">Ostatnie zmiany w kontekście bazy danych tylko na końcu `sp_executesql` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="8788a-308">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="8788a-309">Aby uzyskać więcej informacji, zobacz [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8788a-309">For more information, see [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span></span>

<span data-ttu-id="8788a-310">Podczas korzystania z parametrów za pomocą <xref:System.Data.SqlClient.SqlCommand> programu SQL Server wykonaj procedurę składowaną w, nazwy parametrów dodanych do <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> kolekcji musi być zgodne z nazwami znaczników parametr w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="8788a-310">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="8788a-311">.NET Framework Data Provider for SQL Server nie obsługuje znaku zapytania (?) — symbol zastępczy przekazywania parametrów do instrukcji SQL lub procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="8788a-311">The .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="8788a-312">Traktuje parametry w procedurze składowanej jako nazwane parametry, a szuka dopasowania z symbolami parametru.</span><span class="sxs-lookup"><span data-stu-id="8788a-312">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="8788a-313">Na przykład `CustOrderHist` procedury składowanej jest definiowana za pomocą parametru o nazwie `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="8788a-313">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="8788a-314">Gdy kod wykonuje procedurę składowaną, należy również użyć parametru o nazwie `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="8788a-314">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>

```sql
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)
```

### <a name="example"></a><span data-ttu-id="8788a-315">Przykład</span><span class="sxs-lookup"><span data-stu-id="8788a-315">Example</span></span>

<span data-ttu-id="8788a-316">W tym przykładzie przedstawiono sposób wywoływania procedur składowanych serwera SQL Server `Northwind` przykładowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8788a-316">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="8788a-317">Nazwa procedury składowanej jest `dbo.SalesByCategory` i ma parametr wejściowy o nazwie `@CategoryName` z typem danych `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="8788a-317">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="8788a-318">Ten kod tworzy nową <xref:System.Data.SqlClient.SqlConnection> wewnątrz using blokowania, tak aby połączenie zostanie usunięty po zakończeniu procedury.</span><span class="sxs-lookup"><span data-stu-id="8788a-318">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="8788a-319"><xref:System.Data.SqlClient.SqlCommand> i <xref:System.Data.SqlClient.SqlParameter> obiekty są tworzone i ustaw jego właściwości.</span><span class="sxs-lookup"><span data-stu-id="8788a-319">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="8788a-320">A <xref:System.Data.SqlClient.SqlDataReader> wykonuje `SqlCommand` i zwraca zestawu wyników z procedury składowanej, wyświetlanie danych wyjściowych w oknie konsoli.</span><span class="sxs-lookup"><span data-stu-id="8788a-320">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>

> [!NOTE]
> <span data-ttu-id="8788a-321">Zamiast tworzyć `SqlCommand` i `SqlParameter` obiektów, a następnie ustawiając właściwości w osobnych instrukcji, możesz zamiast tego wybrać opcję Użyj jednej z przeciążenia konstruktorów do ustawiania wielu właściwości w pojedynczej instrukcji.</span><span class="sxs-lookup"><span data-stu-id="8788a-321">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>

[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
[!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]

## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="8788a-322">Przy użyciu parametrów przy użyciu OleDbCommand lub OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="8788a-322">Using parameters with an OleDbCommand or OdbcCommand</span></span>

<span data-ttu-id="8788a-323">Podczas korzystania z parametrów za pomocą <xref:System.Data.OleDb.OleDbCommand> lub <xref:System.Data.Odbc.OdbcCommand>, kolejność parametrów dodanych do `Parameters` kolekcji musi być zgodna z kolejnością parametrów zdefiniowanych w swojej przechowywanej procedurze.</span><span class="sxs-lookup"><span data-stu-id="8788a-323">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="8788a-324">.NET Framework Data Provider for OLE DB i .NET Framework Data Provider for ODBC traktować parametry w procedurze składowanej jako symbole zastępcze i stosowanie wartości parametrów w kolejności.</span><span class="sxs-lookup"><span data-stu-id="8788a-324">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="8788a-325">Ponadto, zwróć wartość parametry muszą być pierwsze parametry, które są dodawane do `Parameters` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="8788a-325">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>

<span data-ttu-id="8788a-326">.NET Framework Data Provider for OLE DB i .NET Framework Data Provider for ODBC nie obsługują parametrów nazwanych przekazywania parametrów do instrukcji SQL lub procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="8788a-326">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="8788a-327">W takim przypadku należy użyć symbolu zastępczego znak zapytania (?), jak w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="8788a-327">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>

```sql
SELECT * FROM Customers WHERE CustomerID = ?
```

<span data-ttu-id="8788a-328">W rezultacie, kolejność, w której `Parameter` obiekty są dodawane do `Parameters` kolekcji bezpośrednio musi odpowiadać położenie?</span><span class="sxs-lookup"><span data-stu-id="8788a-328">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="8788a-329">symbol zastępczy dla parametru.</span><span class="sxs-lookup"><span data-stu-id="8788a-329">placeholder for the parameter.</span></span>

### <a name="oledb-example"></a><span data-ttu-id="8788a-330">Przykład OleDb</span><span class="sxs-lookup"><span data-stu-id="8788a-330">OleDb Example</span></span>

```vb
Dim command As OleDbCommand = New OleDbCommand( _
  "SampleProc", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OleDbParameter = command.Parameters.Add( _
  "RETURN_VALUE", OleDbType.Integer)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OleDbType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OleDbType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OleDbCommand command = new OleDbCommand("SampleProc", connection);
command.CommandType = CommandType.StoredProcedure;

OleDbParameter parameter = command.Parameters.Add(
  "RETURN_VALUE", OleDbType.Integer);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add(
  "@InputParm", OleDbType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add(
  "@OutputParm", OleDbType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="odbc-example"></a><span data-ttu-id="8788a-331">Przykład ODBC</span><span class="sxs-lookup"><span data-stu-id="8788a-331">Odbc Example</span></span>

```vb
Dim command As OdbcCommand = New OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OdbcCommand command = new OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection);
command.CommandType = CommandType.StoredProcedure;

OdbcParameter parameter = command.Parameters.Add( _
  "RETURN_VALUE", OdbcType.Int);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="see-also"></a><span data-ttu-id="8788a-332">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="8788a-332">See also</span></span>

- [<span data-ttu-id="8788a-333">Polecenia i parametry</span><span class="sxs-lookup"><span data-stu-id="8788a-333">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="8788a-334">Parametry elementu DataAdapter</span><span class="sxs-lookup"><span data-stu-id="8788a-334">DataAdapter Parameters</span></span>](dataadapter-parameters.md)
- [<span data-ttu-id="8788a-335">Mapowanie typu danych w ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8788a-335">Data Type Mappings in ADO.NET</span></span>](data-type-mappings-in-ado-net.md)
- [<span data-ttu-id="8788a-336">Omówienie ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8788a-336">ADO.NET Overview</span></span>](ado-net-overview.md)
