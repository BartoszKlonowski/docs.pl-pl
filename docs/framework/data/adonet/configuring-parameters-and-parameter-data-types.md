---
title: Konfigurowanie parametrów i typów danych parametrów
description: Obiekty poleceń używają parametrów do przekazywania wartości do instrukcji SQL lub procedur składowanych, zapewniając sprawdzanie typu i weryfikację w ADO.NET.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: a426eeae785274b0484a84a2fae2dce4572fb4c4
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/02/2020
ms.locfileid: "84287119"
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="df8db-103">Konfigurowanie parametrów i typów danych parametrów</span><span class="sxs-lookup"><span data-stu-id="df8db-103">Configuring parameters and parameter data types</span></span>

<span data-ttu-id="df8db-104">Obiekty poleceń używają parametrów do przekazywania wartości do instrukcji SQL lub procedur składowanych, zapewniając sprawdzanie typu i weryfikację.</span><span class="sxs-lookup"><span data-stu-id="df8db-104">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="df8db-105">W przeciwieństwie do tekstu polecenia, wprowadzanie parametrów jest traktowane jako wartość literału, a nie jako kod wykonywalny.</span><span class="sxs-lookup"><span data-stu-id="df8db-105">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="df8db-106">Pomaga to chronić przed atakami "iniekcji SQL", w których osoba atakująca wstawia polecenie naruszające zabezpieczenia serwera do instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="df8db-106">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>

<span data-ttu-id="df8db-107">Polecenia sparametryzowane mogą również zwiększyć wydajność wykonywania zapytań, ponieważ ułatwiają one serwerowi bazy danych dokładne dopasowanie do polecenia przychodzącego z prawidłowym buforowanym planem zapytań.</span><span class="sxs-lookup"><span data-stu-id="df8db-107">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="df8db-108">Aby uzyskać więcej informacji, zobacz [buforowanie i ponowne użycie planu wykonywania](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) oraz ponowne używanie [parametrów i planu wykonania](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span><span class="sxs-lookup"><span data-stu-id="df8db-108">For more information, see [Execution Plan Caching and Reuse](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) and [Parameters and Execution Plan Reuse](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span></span> <span data-ttu-id="df8db-109">Oprócz korzyści związanych z zabezpieczeniami i wydajnością, polecenia sparametryzowane zapewniają wygodną metodę organizowania wartości przesyłanych do źródła danych.</span><span class="sxs-lookup"><span data-stu-id="df8db-109">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>

<span data-ttu-id="df8db-110"><xref:System.Data.Common.DbParameter>Obiekt można utworzyć za pomocą jego konstruktora lub przez dodanie go do obiektu <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> przez wywołanie `Add` metody <xref:System.Data.Common.DbParameterCollection> kolekcji.</span><span class="sxs-lookup"><span data-stu-id="df8db-110">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="df8db-111">`Add`Metoda przyjmuje jako dane wejściowe argumenty konstruktora lub istniejący obiekt parametru, w zależności od dostawcy danych.</span><span class="sxs-lookup"><span data-stu-id="df8db-111">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>

## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="df8db-112">Dostarczanie właściwości ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="df8db-112">Supplying the ParameterDirection property</span></span>

<span data-ttu-id="df8db-113">Podczas dodawania parametrów należy podać <xref:System.Data.ParameterDirection> Właściwość parametrów innych niż parametry wejściowe.</span><span class="sxs-lookup"><span data-stu-id="df8db-113">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="df8db-114">W poniższej tabeli przedstawiono `ParameterDirection` wartości, których można użyć z <xref:System.Data.ParameterDirection> wyliczeniem.</span><span class="sxs-lookup"><span data-stu-id="df8db-114">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>

|<span data-ttu-id="df8db-115">Nazwa elementu członkowskiego</span><span class="sxs-lookup"><span data-stu-id="df8db-115">Member name</span></span>|<span data-ttu-id="df8db-116">Opis</span><span class="sxs-lookup"><span data-stu-id="df8db-116">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="df8db-117">Parametr jest parametrem wejściowym.</span><span class="sxs-lookup"><span data-stu-id="df8db-117">The parameter is an input parameter.</span></span> <span data-ttu-id="df8db-118">Domyślnie włączone.</span><span class="sxs-lookup"><span data-stu-id="df8db-118">This is the default.</span></span>|
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="df8db-119">Parametr może wykonywać zarówno dane wejściowe, jak i wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="df8db-119">The parameter can perform both input and output.</span></span>|
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="df8db-120">Parametr jest parametrem wyjściowym.</span><span class="sxs-lookup"><span data-stu-id="df8db-120">The parameter is an output parameter.</span></span>|
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="df8db-121">Parametr reprezentuje wartość zwracaną z operacji, takiej jak procedura składowana, wbudowana funkcja lub funkcja zdefiniowana przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="df8db-121">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|

## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="df8db-122">Praca z symbolami zastępczymi parametrów</span><span class="sxs-lookup"><span data-stu-id="df8db-122">Working with parameter placeholders</span></span>

<span data-ttu-id="df8db-123">Składnia symboli zastępczych parametrów zależy od źródła danych.</span><span class="sxs-lookup"><span data-stu-id="df8db-123">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="df8db-124">Dostawcy danych .NET Framework obsługują nazewnictwo i Określanie parametrów i symboli zastępczych parametrów w różny sposób.</span><span class="sxs-lookup"><span data-stu-id="df8db-124">The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="df8db-125">Ta składnia jest dostosowana do określonego źródła danych, zgodnie z opisem w poniższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="df8db-125">This syntax is customized to a specific data source, as described in the following table.</span></span>

|<span data-ttu-id="df8db-126">Dostawca danych</span><span class="sxs-lookup"><span data-stu-id="df8db-126">Data provider</span></span>|<span data-ttu-id="df8db-127">Składnia nazewnictwa parametrów</span><span class="sxs-lookup"><span data-stu-id="df8db-127">Parameter naming syntax</span></span>|
|-------------------|-----------------------------|
|<xref:System.Data.SqlClient>|<span data-ttu-id="df8db-128">Używa nazwanych parametrów w formacie `@` *ParameterName*.</span><span class="sxs-lookup"><span data-stu-id="df8db-128">Uses named parameters in the format `@`*parametername*.</span></span>|
|<xref:System.Data.OleDb>|<span data-ttu-id="df8db-129">Używa znaczników parametrów pozycyjnych wskazanych przez znak zapytania ( `?` ).</span><span class="sxs-lookup"><span data-stu-id="df8db-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.Odbc>|<span data-ttu-id="df8db-130">Używa znaczników parametrów pozycyjnych wskazanych przez znak zapytania ( `?` ).</span><span class="sxs-lookup"><span data-stu-id="df8db-130">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.OracleClient>|<span data-ttu-id="df8db-131">Używa nazwanych parametrów w formacie `:` *parmname* (lub *parmname*).</span><span class="sxs-lookup"><span data-stu-id="df8db-131">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|

## <a name="specifying-parameter-data-types"></a><span data-ttu-id="df8db-132">Określanie typów danych parametrów</span><span class="sxs-lookup"><span data-stu-id="df8db-132">Specifying parameter data types</span></span>

<span data-ttu-id="df8db-133">Typ danych parametru jest specyficzny dla dostawcy danych .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="df8db-133">The data type of a parameter is specific to the .NET Framework data provider.</span></span> <span data-ttu-id="df8db-134">Określenie typu spowoduje konwersję wartości `Parameter` do typu .NET Framework dostawcy danych przed przekazaniem wartości do źródła danych.</span><span class="sxs-lookup"><span data-stu-id="df8db-134">Specifying the type converts the value of the `Parameter` to the .NET Framework data provider type before passing the value to the data source.</span></span> <span data-ttu-id="df8db-135">Można również określić typ a `Parameter` w ogólny sposób, ustawiając `DbType` Właściwość `Parameter` obiektu na konkretną <xref:System.Data.DbType> .</span><span class="sxs-lookup"><span data-stu-id="df8db-135">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>

<span data-ttu-id="df8db-136">Typ dostawcy danych .NET Frameworkgo `Parameter` obiektu jest wywnioskowany na podstawie typu .NET Framework `Value` `Parameter` obiektu lub z `DbType` `Parameter` obiektu.</span><span class="sxs-lookup"><span data-stu-id="df8db-136">The .NET Framework data provider type of a `Parameter` object is inferred from the .NET Framework type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="df8db-137">W poniższej tabeli przedstawiono typ wnioskowany `Parameter` na podstawie obiektu przekazanego jako `Parameter` wartość lub określony `DbType` .</span><span class="sxs-lookup"><span data-stu-id="df8db-137">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>

|<span data-ttu-id="df8db-138">Typ programu .NET Framework</span><span class="sxs-lookup"><span data-stu-id="df8db-138">.NET Framework type</span></span>|<span data-ttu-id="df8db-139">DbType</span><span class="sxs-lookup"><span data-stu-id="df8db-139">DbType</span></span>|<span data-ttu-id="df8db-140">DbType</span><span class="sxs-lookup"><span data-stu-id="df8db-140">SqlDbType</span></span>|<span data-ttu-id="df8db-141">OleDbType</span><span class="sxs-lookup"><span data-stu-id="df8db-141">OleDbType</span></span>|<span data-ttu-id="df8db-142">OdbcType</span><span class="sxs-lookup"><span data-stu-id="df8db-142">OdbcType</span></span>|<span data-ttu-id="df8db-143">OracleType</span><span class="sxs-lookup"><span data-stu-id="df8db-143">OracleType</span></span>|
|-------------------------|------------|---------------|---------------|--------------|----------------|
|<xref:System.Boolean>|<span data-ttu-id="df8db-144">Boolean (wartość logiczna)</span><span class="sxs-lookup"><span data-stu-id="df8db-144">Boolean</span></span>|<span data-ttu-id="df8db-145">Bit</span><span class="sxs-lookup"><span data-stu-id="df8db-145">Bit</span></span>|<span data-ttu-id="df8db-146">Boolean (wartość logiczna)</span><span class="sxs-lookup"><span data-stu-id="df8db-146">Boolean</span></span>|<span data-ttu-id="df8db-147">Bit</span><span class="sxs-lookup"><span data-stu-id="df8db-147">Bit</span></span>|<span data-ttu-id="df8db-148">Byte</span><span class="sxs-lookup"><span data-stu-id="df8db-148">Byte</span></span>|
|<xref:System.Byte>|<span data-ttu-id="df8db-149">Byte</span><span class="sxs-lookup"><span data-stu-id="df8db-149">Byte</span></span>|<span data-ttu-id="df8db-150">TinyInt</span><span class="sxs-lookup"><span data-stu-id="df8db-150">TinyInt</span></span>|<span data-ttu-id="df8db-151">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="df8db-151">UnsignedTinyInt</span></span>|<span data-ttu-id="df8db-152">TinyInt</span><span class="sxs-lookup"><span data-stu-id="df8db-152">TinyInt</span></span>|<span data-ttu-id="df8db-153">Byte</span><span class="sxs-lookup"><span data-stu-id="df8db-153">Byte</span></span>|
|<span data-ttu-id="df8db-154">Byte []</span><span class="sxs-lookup"><span data-stu-id="df8db-154">byte[]</span></span>|<span data-ttu-id="df8db-155">Binarne</span><span class="sxs-lookup"><span data-stu-id="df8db-155">Binary</span></span>|<span data-ttu-id="df8db-156">Liczby.</span><span class="sxs-lookup"><span data-stu-id="df8db-156">VarBinary.</span></span> <span data-ttu-id="df8db-157">Ta niejawna konwersja zakończy się niepowodzeniem, jeśli tablica bajtów jest większa niż maksymalny rozmiar VarBinary, czyli 8000 bajtów. W przypadku tablic bajtowych o rozmiarze większym niż 8000 bajtów jawnie ustaw wartość <xref:System.Data.SqlDbType> .</span><span class="sxs-lookup"><span data-stu-id="df8db-157">This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="df8db-158">Liczby</span><span class="sxs-lookup"><span data-stu-id="df8db-158">VarBinary</span></span>|<span data-ttu-id="df8db-159">Binarne</span><span class="sxs-lookup"><span data-stu-id="df8db-159">Binary</span></span>|<span data-ttu-id="df8db-160">Nieprzetworzone</span><span class="sxs-lookup"><span data-stu-id="df8db-160">Raw</span></span>|
|<xref:System.Char>| |<span data-ttu-id="df8db-161">Wnioskowanie typu <xref:System.Data.SqlDbType> from nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-161">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="df8db-162">Char</span><span class="sxs-lookup"><span data-stu-id="df8db-162">Char</span></span>|<span data-ttu-id="df8db-163">Char</span><span class="sxs-lookup"><span data-stu-id="df8db-163">Char</span></span>|<span data-ttu-id="df8db-164">Byte</span><span class="sxs-lookup"><span data-stu-id="df8db-164">Byte</span></span>|
|<xref:System.DateTime>|<span data-ttu-id="df8db-165">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-165">DateTime</span></span>|<span data-ttu-id="df8db-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-166">DateTime</span></span>|<span data-ttu-id="df8db-167">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="df8db-167">DBTimeStamp</span></span>|<span data-ttu-id="df8db-168">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-168">DateTime</span></span>|<span data-ttu-id="df8db-169">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-169">DateTime</span></span>|
|<xref:System.DateTimeOffset>|<span data-ttu-id="df8db-170">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="df8db-170">DateTimeOffset</span></span>|<span data-ttu-id="df8db-171">DateTimeOffset w SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-171">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="df8db-172">Wnioskowanie z klasy <xref:System.Data.SqlDbType> DateTimeOffset nie jest obsługiwane w wersjach SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-172">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="df8db-173">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-173">DateTime</span></span>|
|<xref:System.Decimal>|<span data-ttu-id="df8db-174">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="df8db-174">Decimal</span></span>|<span data-ttu-id="df8db-175">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="df8db-175">Decimal</span></span>|<span data-ttu-id="df8db-176">Wartość dziesiętna</span><span class="sxs-lookup"><span data-stu-id="df8db-176">Decimal</span></span>|<span data-ttu-id="df8db-177">Liczbowe</span><span class="sxs-lookup"><span data-stu-id="df8db-177">Numeric</span></span>|<span data-ttu-id="df8db-178">Liczba</span><span class="sxs-lookup"><span data-stu-id="df8db-178">Number</span></span>|
|<xref:System.Double>|<span data-ttu-id="df8db-179">Double</span><span class="sxs-lookup"><span data-stu-id="df8db-179">Double</span></span>|<span data-ttu-id="df8db-180">Float</span><span class="sxs-lookup"><span data-stu-id="df8db-180">Float</span></span>|<span data-ttu-id="df8db-181">Double</span><span class="sxs-lookup"><span data-stu-id="df8db-181">Double</span></span>|<span data-ttu-id="df8db-182">Double</span><span class="sxs-lookup"><span data-stu-id="df8db-182">Double</span></span>|<span data-ttu-id="df8db-183">Double</span><span class="sxs-lookup"><span data-stu-id="df8db-183">Double</span></span>|
|<xref:System.Single>|<span data-ttu-id="df8db-184">Single</span><span class="sxs-lookup"><span data-stu-id="df8db-184">Single</span></span>|<span data-ttu-id="df8db-185">Rzeczywiste</span><span class="sxs-lookup"><span data-stu-id="df8db-185">Real</span></span>|<span data-ttu-id="df8db-186">Single</span><span class="sxs-lookup"><span data-stu-id="df8db-186">Single</span></span>|<span data-ttu-id="df8db-187">Rzeczywiste</span><span class="sxs-lookup"><span data-stu-id="df8db-187">Real</span></span>|<span data-ttu-id="df8db-188">Float</span><span class="sxs-lookup"><span data-stu-id="df8db-188">Float</span></span>|
|<xref:System.Guid>|<span data-ttu-id="df8db-189">Guid (identyfikator GUID)</span><span class="sxs-lookup"><span data-stu-id="df8db-189">Guid</span></span>|<span data-ttu-id="df8db-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="df8db-190">UniqueIdentifier</span></span>|<span data-ttu-id="df8db-191">Guid (identyfikator GUID)</span><span class="sxs-lookup"><span data-stu-id="df8db-191">Guid</span></span>|<span data-ttu-id="df8db-192">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="df8db-192">UniqueIdentifier</span></span>|<span data-ttu-id="df8db-193">Nieprzetworzone</span><span class="sxs-lookup"><span data-stu-id="df8db-193">Raw</span></span>|
|<xref:System.Int16>|<span data-ttu-id="df8db-194">Int16</span><span class="sxs-lookup"><span data-stu-id="df8db-194">Int16</span></span>|<span data-ttu-id="df8db-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="df8db-195">SmallInt</span></span>|<span data-ttu-id="df8db-196">SmallInt</span><span class="sxs-lookup"><span data-stu-id="df8db-196">SmallInt</span></span>|<span data-ttu-id="df8db-197">SmallInt</span><span class="sxs-lookup"><span data-stu-id="df8db-197">SmallInt</span></span>|<span data-ttu-id="df8db-198">Int16</span><span class="sxs-lookup"><span data-stu-id="df8db-198">Int16</span></span>|
|<xref:System.Int32>|<span data-ttu-id="df8db-199">Int32</span><span class="sxs-lookup"><span data-stu-id="df8db-199">Int32</span></span>|<span data-ttu-id="df8db-200">int</span><span class="sxs-lookup"><span data-stu-id="df8db-200">Int</span></span>|<span data-ttu-id="df8db-201">int</span><span class="sxs-lookup"><span data-stu-id="df8db-201">Int</span></span>|<span data-ttu-id="df8db-202">int</span><span class="sxs-lookup"><span data-stu-id="df8db-202">Int</span></span>|<span data-ttu-id="df8db-203">Int32</span><span class="sxs-lookup"><span data-stu-id="df8db-203">Int32</span></span>|
|<xref:System.Int64>|<span data-ttu-id="df8db-204">Int64</span><span class="sxs-lookup"><span data-stu-id="df8db-204">Int64</span></span>|<span data-ttu-id="df8db-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="df8db-205">BigInt</span></span>|<span data-ttu-id="df8db-206">BigInt</span><span class="sxs-lookup"><span data-stu-id="df8db-206">BigInt</span></span>|<span data-ttu-id="df8db-207">BigInt</span><span class="sxs-lookup"><span data-stu-id="df8db-207">BigInt</span></span>|<span data-ttu-id="df8db-208">Liczba</span><span class="sxs-lookup"><span data-stu-id="df8db-208">Number</span></span>|
|<xref:System.Object>|<span data-ttu-id="df8db-209">Obiekt</span><span class="sxs-lookup"><span data-stu-id="df8db-209">Object</span></span>|<span data-ttu-id="df8db-210">Wariant</span><span class="sxs-lookup"><span data-stu-id="df8db-210">Variant</span></span>|<span data-ttu-id="df8db-211">Wariant</span><span class="sxs-lookup"><span data-stu-id="df8db-211">Variant</span></span>|<span data-ttu-id="df8db-212">Wnioskowanie OdbcType z obiektu nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-212">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="df8db-213">Obiekt blob</span><span class="sxs-lookup"><span data-stu-id="df8db-213">Blob</span></span>|
|<xref:System.String>|<span data-ttu-id="df8db-214">String (ciąg)</span><span class="sxs-lookup"><span data-stu-id="df8db-214">String</span></span>|<span data-ttu-id="df8db-215">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="df8db-215">NVarChar.</span></span> <span data-ttu-id="df8db-216">Ta niejawna konwersja zakończy się niepowodzeniem, jeśli ciąg jest większy niż maksymalny rozmiar elementu NVarChar, który jest 4000 znaków.</span><span class="sxs-lookup"><span data-stu-id="df8db-216">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="df8db-217">W przypadku ciągów o rozmiarze większym niż 4000 znaków jawnie ustaw wartość <xref:System.Data.SqlDbType> .</span><span class="sxs-lookup"><span data-stu-id="df8db-217">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="df8db-218">VarWChar</span><span class="sxs-lookup"><span data-stu-id="df8db-218">VarWChar</span></span>|<span data-ttu-id="df8db-219">NVarChar</span><span class="sxs-lookup"><span data-stu-id="df8db-219">NVarChar</span></span>|<span data-ttu-id="df8db-220">NVarChar</span><span class="sxs-lookup"><span data-stu-id="df8db-220">NVarChar</span></span>|
|<xref:System.TimeSpan>|<span data-ttu-id="df8db-221">Godzina</span><span class="sxs-lookup"><span data-stu-id="df8db-221">Time</span></span>|<span data-ttu-id="df8db-222">Czas w SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-222">Time in SQL Server 2008.</span></span> <span data-ttu-id="df8db-223">Wnioskowanie z elementu <xref:System.Data.SqlDbType> TimeSpan nie jest obsługiwane w wersjach SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-223">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="df8db-224">Czas</span><span class="sxs-lookup"><span data-stu-id="df8db-224">DBTime</span></span>|<span data-ttu-id="df8db-225">Godzina</span><span class="sxs-lookup"><span data-stu-id="df8db-225">Time</span></span>|<span data-ttu-id="df8db-226">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-226">DateTime</span></span>|
|<xref:System.UInt16>|<span data-ttu-id="df8db-227">UInt16</span><span class="sxs-lookup"><span data-stu-id="df8db-227">UInt16</span></span>|<span data-ttu-id="df8db-228">Wnioskowanie <xref:System.Data.SqlDbType> z UInt16 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-228">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="df8db-229">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="df8db-229">UnsignedSmallInt</span></span>|<span data-ttu-id="df8db-230">int</span><span class="sxs-lookup"><span data-stu-id="df8db-230">Int</span></span>|<span data-ttu-id="df8db-231">UInt16</span><span class="sxs-lookup"><span data-stu-id="df8db-231">UInt16</span></span>|
|<xref:System.UInt32>|<span data-ttu-id="df8db-232">UInt32</span><span class="sxs-lookup"><span data-stu-id="df8db-232">UInt32</span></span>|<span data-ttu-id="df8db-233">Wnioskowanie z typu <xref:System.Data.SqlDbType> UInt32 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-233">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="df8db-234">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="df8db-234">UnsignedInt</span></span>|<span data-ttu-id="df8db-235">BigInt</span><span class="sxs-lookup"><span data-stu-id="df8db-235">BigInt</span></span>|<span data-ttu-id="df8db-236">UInt32</span><span class="sxs-lookup"><span data-stu-id="df8db-236">UInt32</span></span>|
|<xref:System.UInt64>|<span data-ttu-id="df8db-237">UInt64</span><span class="sxs-lookup"><span data-stu-id="df8db-237">UInt64</span></span>|<span data-ttu-id="df8db-238">Wnioskowanie <xref:System.Data.SqlDbType> z UInt64 nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-238">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="df8db-239">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="df8db-239">UnsignedBigInt</span></span>|<span data-ttu-id="df8db-240">Liczbowe</span><span class="sxs-lookup"><span data-stu-id="df8db-240">Numeric</span></span>|<span data-ttu-id="df8db-241">Liczba</span><span class="sxs-lookup"><span data-stu-id="df8db-241">Number</span></span>|
||<span data-ttu-id="df8db-242">AnsiString</span><span class="sxs-lookup"><span data-stu-id="df8db-242">AnsiString</span></span>|<span data-ttu-id="df8db-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="df8db-243">VarChar</span></span>|<span data-ttu-id="df8db-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="df8db-244">VarChar</span></span>|<span data-ttu-id="df8db-245">VarChar</span><span class="sxs-lookup"><span data-stu-id="df8db-245">VarChar</span></span>|<span data-ttu-id="df8db-246">VarChar</span><span class="sxs-lookup"><span data-stu-id="df8db-246">VarChar</span></span>|
||<span data-ttu-id="df8db-247">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="df8db-247">AnsiStringFixedLength</span></span>|<span data-ttu-id="df8db-248">Char</span><span class="sxs-lookup"><span data-stu-id="df8db-248">Char</span></span>|<span data-ttu-id="df8db-249">Char</span><span class="sxs-lookup"><span data-stu-id="df8db-249">Char</span></span>|<span data-ttu-id="df8db-250">Char</span><span class="sxs-lookup"><span data-stu-id="df8db-250">Char</span></span>|<span data-ttu-id="df8db-251">Char</span><span class="sxs-lookup"><span data-stu-id="df8db-251">Char</span></span>|
||<span data-ttu-id="df8db-252">Waluta</span><span class="sxs-lookup"><span data-stu-id="df8db-252">Currency</span></span>|<span data-ttu-id="df8db-253">Pieniądze</span><span class="sxs-lookup"><span data-stu-id="df8db-253">Money</span></span>|<span data-ttu-id="df8db-254">Waluta</span><span class="sxs-lookup"><span data-stu-id="df8db-254">Currency</span></span>|<span data-ttu-id="df8db-255">Wnioskowanie `OdbcType` z `Currency` nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-255">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="df8db-256">Liczba</span><span class="sxs-lookup"><span data-stu-id="df8db-256">Number</span></span>|
||<span data-ttu-id="df8db-257">Data</span><span class="sxs-lookup"><span data-stu-id="df8db-257">Date</span></span>|<span data-ttu-id="df8db-258">Data w SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-258">Date in SQL Server 2008.</span></span> <span data-ttu-id="df8db-259">Wnioskowanie <xref:System.Data.SqlDbType> z daty od nie jest obsługiwane w wersjach SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-259">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="df8db-260">DBDate</span><span class="sxs-lookup"><span data-stu-id="df8db-260">DBDate</span></span>|<span data-ttu-id="df8db-261">Data</span><span class="sxs-lookup"><span data-stu-id="df8db-261">Date</span></span>|<span data-ttu-id="df8db-262">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-262">DateTime</span></span>|
||<span data-ttu-id="df8db-263">SByte</span><span class="sxs-lookup"><span data-stu-id="df8db-263">SByte</span></span>|<span data-ttu-id="df8db-264">Wnioskowanie typu <xref:System.Data.SqlDbType> from nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-264">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="df8db-265">TinyInt</span><span class="sxs-lookup"><span data-stu-id="df8db-265">TinyInt</span></span>|<span data-ttu-id="df8db-266">Wywnioskowanie z niezgodnego elementu `OdbcType` nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-266">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="df8db-267">SByte</span><span class="sxs-lookup"><span data-stu-id="df8db-267">SByte</span></span>|
||<span data-ttu-id="df8db-268">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="df8db-268">StringFixedLength</span></span>|<span data-ttu-id="df8db-269">NChar</span><span class="sxs-lookup"><span data-stu-id="df8db-269">NChar</span></span>|<span data-ttu-id="df8db-270">WChar</span><span class="sxs-lookup"><span data-stu-id="df8db-270">WChar</span></span>|<span data-ttu-id="df8db-271">NChar</span><span class="sxs-lookup"><span data-stu-id="df8db-271">NChar</span></span>|<span data-ttu-id="df8db-272">NChar</span><span class="sxs-lookup"><span data-stu-id="df8db-272">NChar</span></span>|
||<span data-ttu-id="df8db-273">Godzina</span><span class="sxs-lookup"><span data-stu-id="df8db-273">Time</span></span>|<span data-ttu-id="df8db-274">Czas w SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-274">Time in SQL Server 2008.</span></span> <span data-ttu-id="df8db-275">Wnioskowanie <xref:System.Data.SqlDbType> z czasu od nie jest obsługiwane w wersjach SQL Server starszych niż SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="df8db-275">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="df8db-276">Czas</span><span class="sxs-lookup"><span data-stu-id="df8db-276">DBTime</span></span>|<span data-ttu-id="df8db-277">Godzina</span><span class="sxs-lookup"><span data-stu-id="df8db-277">Time</span></span>|<span data-ttu-id="df8db-278">DateTime</span><span class="sxs-lookup"><span data-stu-id="df8db-278">DateTime</span></span>|
||<span data-ttu-id="df8db-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="df8db-279">VarNumeric</span></span>|<span data-ttu-id="df8db-280">Wnioskowanie <xref:System.Data.SqlDbType> z VARNUMERIC nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-280">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="df8db-281">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="df8db-281">VarNumeric</span></span>|<span data-ttu-id="df8db-282">Wnioskowanie `OdbcType` z VARNUMERIC nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="df8db-282">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="df8db-283">Liczba</span><span class="sxs-lookup"><span data-stu-id="df8db-283">Number</span></span>|
|<span data-ttu-id="df8db-284">typ zdefiniowany przez użytkownika (obiekt z<xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="df8db-284">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="df8db-285">Obiekt lub ciąg, w zależności od dostawcy (SqlClient zawsze zwraca obiekt, ODBC zawsze zwraca ciąg, a dostawca danych zarządzanych OleDb może zobaczyć</span><span class="sxs-lookup"><span data-stu-id="df8db-285">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="df8db-286">SqlDbType. UDT <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> , jeśli jest obecny, w przeciwnym razie wariant</span><span class="sxs-lookup"><span data-stu-id="df8db-286">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="df8db-287">OleDbtype. VarWChar (Jeśli wartość jest równa null) w przeciwnym wypadku OleDbtype. Variant.</span><span class="sxs-lookup"><span data-stu-id="df8db-287">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="df8db-288">OdbcType. NVarChar</span><span class="sxs-lookup"><span data-stu-id="df8db-288">OdbcType.NVarChar</span></span>|<span data-ttu-id="df8db-289">nieobsługiwane</span><span class="sxs-lookup"><span data-stu-id="df8db-289">not supported</span></span>|

> [!NOTE]
> <span data-ttu-id="df8db-290">Konwersje z wartości dziesiętnych na inne typy są zawężanymi konwersjemi, które zaokrąglią wartość dziesiętną do najbliższej wartości całkowitej w kierunku zera.</span><span class="sxs-lookup"><span data-stu-id="df8db-290">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="df8db-291">Jeśli wynik konwersji nie zostanie zaprezentowany w typie docelowym, <xref:System.OverflowException> zostanie zgłoszony.</span><span class="sxs-lookup"><span data-stu-id="df8db-291">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="df8db-292">W przypadku wysyłania wartości parametru o wartości null do serwera należy określić wartość <xref:System.DBNull> , a nie `null` ( `Nothing` w Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="df8db-292">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="df8db-293">Wartość null w systemie jest pustym obiektem, który nie ma wartości.</span><span class="sxs-lookup"><span data-stu-id="df8db-293">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="df8db-294"><xref:System.DBNull>służy do reprezentowania wartości null.</span><span class="sxs-lookup"><span data-stu-id="df8db-294"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="df8db-295">Aby uzyskać więcej informacji na temat wartości null bazy danych, zobacz [Obsługa wartości null](./sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="df8db-295">For more information about database nulls, see [Handling Null Values](./sql/handling-null-values.md).</span></span>

## <a name="deriving-parameter-information"></a><span data-ttu-id="df8db-296">Wyprowadzanie informacji o parametrach</span><span class="sxs-lookup"><span data-stu-id="df8db-296">Deriving parameter information</span></span>

<span data-ttu-id="df8db-297">Parametry mogą również pochodzić z procedury składowanej przy użyciu `DbCommandBuilder` klasy.</span><span class="sxs-lookup"><span data-stu-id="df8db-297">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="df8db-298">`SqlCommandBuilder` `OleDbCommandBuilder` Klasy i zapewniają metodę statyczną, `DeriveParameters` która automatycznie wypełnia kolekcję parametrów obiektu polecenia, który używa informacji o parametrach z procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="df8db-298">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="df8db-299">Należy zauważyć, że `DeriveParameters` zastępuje wszystkie istniejące informacje o parametrach dla polecenia.</span><span class="sxs-lookup"><span data-stu-id="df8db-299">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>

> [!NOTE]
> <span data-ttu-id="df8db-300">Wyprowadzanie informacji o parametrach powoduje spadek wydajności, ponieważ wymaga dodatkowej podróży do źródła danych w celu pobrania informacji.</span><span class="sxs-lookup"><span data-stu-id="df8db-300">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="df8db-301">Jeśli informacje o parametrach są znane w czasie projektowania, można zwiększyć wydajność aplikacji przez ustawienie parametrów jawnie.</span><span class="sxs-lookup"><span data-stu-id="df8db-301">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>

<span data-ttu-id="df8db-302">Aby uzyskać więcej informacji, zobacz [Generowanie poleceń z CommandBuilders](generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="df8db-302">For more information, see [Generating Commands with CommandBuilders](generating-commands-with-commandbuilders.md).</span></span>

## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="df8db-303">Używanie parametrów z SqlCommand i procedurą składowaną</span><span class="sxs-lookup"><span data-stu-id="df8db-303">Using parameters with a SqlCommand and a stored procedure</span></span>

<span data-ttu-id="df8db-304">Procedury składowane oferują wiele korzyści w aplikacjach opartych na danych.</span><span class="sxs-lookup"><span data-stu-id="df8db-304">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="df8db-305">Korzystając z procedur składowanych, operacje bazy danych mogą być hermetyzowane w pojedynczym poleceniu, zoptymalizowane pod kątem najlepszej wydajności i ulepszone z dodatkowymi zabezpieczeniami.</span><span class="sxs-lookup"><span data-stu-id="df8db-305">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="df8db-306">Chociaż procedura składowana może być wywoływana przez przekazanie nazwy procedury składowanej, a następnie argumentów parametrów jako instrukcji SQL, przy użyciu <xref:System.Data.Common.DbCommand.Parameters%2A> kolekcji obiektu ADO.NET, <xref:System.Data.Common.DbCommand> można dokładniej definiować parametry procedury składowanej oraz uzyskać dostęp do parametrów wyjściowych i zwracanych wartości.</span><span class="sxs-lookup"><span data-stu-id="df8db-306">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the ADO.NET <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>

> [!NOTE]
> <span data-ttu-id="df8db-307">Instrukcje sparametryzowane są wykonywane na serwerze przy użyciu `sp_executesql,` , który umożliwia ponowne użycie planu zapytania.</span><span class="sxs-lookup"><span data-stu-id="df8db-307">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="df8db-308">Lokalne kursory lub zmienne w `sp_executesql` partii nie są widoczne dla partii, która wywołuje `sp_executesql` .</span><span class="sxs-lookup"><span data-stu-id="df8db-308">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="df8db-309">Zmiany kontekstu bazy danych są ostatnie na końcu `sp_executesql` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="df8db-309">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="df8db-310">Aby uzyskać więcej informacji, zobacz [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="df8db-310">For more information, see [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span></span>

<span data-ttu-id="df8db-311">W przypadku używania parametrów z <xref:System.Data.SqlClient.SqlCommand> do wykonywania SQL Server procedury składowanej, nazwy parametrów dodawane do <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> kolekcji muszą być zgodne z nazwami znaczników parametrów w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="df8db-311">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="df8db-312">Dostawca danych .NET Framework dla SQL Server nie obsługuje symbolu zastępczego znaku zapytania (?) do przekazywania parametrów do instrukcji SQL lub procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="df8db-312">The .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="df8db-313">Traktuje parametry w procedurze składowanej jako parametry nazwane i wyszukuje pasujące znaczniki parametrów.</span><span class="sxs-lookup"><span data-stu-id="df8db-313">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="df8db-314">Na przykład `CustOrderHist` procedura składowana jest definiowana przy użyciu parametru o nazwie `@CustomerID` .</span><span class="sxs-lookup"><span data-stu-id="df8db-314">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="df8db-315">Gdy kod wykonuje procedurę składowaną, musi również użyć parametru o nazwie `@CustomerID` .</span><span class="sxs-lookup"><span data-stu-id="df8db-315">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>

```sql
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)
```

### <a name="example"></a><span data-ttu-id="df8db-316">Przykład</span><span class="sxs-lookup"><span data-stu-id="df8db-316">Example</span></span>

<span data-ttu-id="df8db-317">W tym przykładzie pokazano, jak wywołać procedurę składowaną SQL Server w `Northwind` przykładowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="df8db-317">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="df8db-318">Nazwa procedury składowanej jest `dbo.SalesByCategory` i ma parametr wejściowy o nazwie `@CategoryName` z typem danych `nvarchar(15)` .</span><span class="sxs-lookup"><span data-stu-id="df8db-318">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="df8db-319">Kod tworzy nowy <xref:System.Data.SqlClient.SqlConnection> wewnątrz bloku using, aby połączenie zostało usunięte po zakończeniu procedury.</span><span class="sxs-lookup"><span data-stu-id="df8db-319">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="df8db-320"><xref:System.Data.SqlClient.SqlCommand>Obiekty i <xref:System.Data.SqlClient.SqlParameter> są tworzone i ich właściwości są ustawione.</span><span class="sxs-lookup"><span data-stu-id="df8db-320">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="df8db-321">A <xref:System.Data.SqlClient.SqlDataReader> wykonuje `SqlCommand` i zwraca zestaw wyników z procedury składowanej, wyświetlając dane wyjściowe w oknie konsoli.</span><span class="sxs-lookup"><span data-stu-id="df8db-321">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>

> [!NOTE]
> <span data-ttu-id="df8db-322">Zamiast tworzyć obiekty i a `SqlCommand` `SqlParameter` następnie ustawiać właściwości w oddzielnych instrukcjach, zamiast tego można wybrać opcję użycia jednego z przeciążonych konstruktorów, aby ustawić wiele właściwości w jednej instrukcji.</span><span class="sxs-lookup"><span data-stu-id="df8db-322">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>

[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
[!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]

## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="df8db-323">Używanie parametrów z OleDbCommand lub OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="df8db-323">Using parameters with an OleDbCommand or OdbcCommand</span></span>

<span data-ttu-id="df8db-324">W przypadku używania parametrów z <xref:System.Data.OleDb.OleDbCommand> lub <xref:System.Data.Odbc.OdbcCommand> , kolejność parametrów dodanych do `Parameters` kolekcji musi być zgodna z kolejnością parametrów zdefiniowanych w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="df8db-324">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="df8db-325">.NET Framework Dostawca danych dla OLE DB i .NET Framework Dostawca danych dla ODBC Traktuj parametry w procedurze składowanej jako symbole zastępcze i Zastosuj wartości parametrów w podanej kolejności.</span><span class="sxs-lookup"><span data-stu-id="df8db-325">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="df8db-326">Ponadto parametry wartości zwracanej muszą być pierwszymi parametrami dodawanymi do `Parameters` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="df8db-326">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>

<span data-ttu-id="df8db-327">Dostawca danych .NET Framework dla OLE DB i .NET Framework Dostawca danych dla ODBC nie obsługują parametrów nazwanych do przekazywania parametrów do instrukcji SQL lub procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="df8db-327">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="df8db-328">W takim przypadku należy użyć symbolu zastępczego znaku zapytania (?), jak w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="df8db-328">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>

```sql
SELECT * FROM Customers WHERE CustomerID = ?
```

<span data-ttu-id="df8db-329">W związku z tym kolejność, w jakiej `Parameter` obiekty są dodawane do `Parameters` kolekcji, musi być bezpośrednio zgodna z pozycją?</span><span class="sxs-lookup"><span data-stu-id="df8db-329">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="df8db-330">Symbol zastępczy dla parametru.</span><span class="sxs-lookup"><span data-stu-id="df8db-330">placeholder for the parameter.</span></span>

### <a name="oledb-example"></a><span data-ttu-id="df8db-331">Przykład OleDb</span><span class="sxs-lookup"><span data-stu-id="df8db-331">OleDb Example</span></span>

```vb
Dim command As OleDbCommand = New OleDbCommand( _
  "SampleProc", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OleDbParameter = command.Parameters.Add( _
  "RETURN_VALUE", OleDbType.Integer)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OleDbType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OleDbType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OleDbCommand command = new OleDbCommand("SampleProc", connection);
command.CommandType = CommandType.StoredProcedure;

OleDbParameter parameter = command.Parameters.Add(
  "RETURN_VALUE", OleDbType.Integer);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add(
  "@InputParm", OleDbType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add(
  "@OutputParm", OleDbType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="odbc-example"></a><span data-ttu-id="df8db-332">Przykład ODBC</span><span class="sxs-lookup"><span data-stu-id="df8db-332">Odbc Example</span></span>

```vb
Dim command As OdbcCommand = New OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OdbcCommand command = new OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection);
command.CommandType = CommandType.StoredProcedure;

OdbcParameter parameter = command.Parameters.Add( _
  "RETURN_VALUE", OdbcType.Int);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="see-also"></a><span data-ttu-id="df8db-333">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="df8db-333">See also</span></span>

- [<span data-ttu-id="df8db-334">Polecenia i parametry</span><span class="sxs-lookup"><span data-stu-id="df8db-334">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="df8db-335">Parametry elementu DataAdapter</span><span class="sxs-lookup"><span data-stu-id="df8db-335">DataAdapter Parameters</span></span>](dataadapter-parameters.md)
- [<span data-ttu-id="df8db-336">Mapowanie typu danych w ADO.NET</span><span class="sxs-lookup"><span data-stu-id="df8db-336">Data Type Mappings in ADO.NET</span></span>](data-type-mappings-in-ado-net.md)
- [<span data-ttu-id="df8db-337">Omówienie ADO.NET</span><span class="sxs-lookup"><span data-stu-id="df8db-337">ADO.NET Overview</span></span>](ado-net-overview.md)
