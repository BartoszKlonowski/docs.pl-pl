---
title: Buforowanie połączenia Oracle, OLE DB i ODBC
ms.date: 03/30/2017
ms.assetid: 2bd83b1e-3ea9-43c4-bade-d9cdb9bbbb04
ms.openlocfilehash: 58ea5aa54a0f6acbc8d2400dd04eeba9ff498055
ms.sourcegitcommit: 8c99457955fc31785b36b3330c4ab6ce7984a7ba
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/29/2019
ms.locfileid: "75545046"
---
# <a name="ole-db-odbc-and-oracle-connection-pooling"></a><span data-ttu-id="ad698-102">Buforowanie połączeń OLE DB, ODBC i Oracle</span><span class="sxs-lookup"><span data-stu-id="ad698-102">OLE DB, ODBC, and Oracle connection pooling</span></span>

<span data-ttu-id="ad698-103">Połączenia w puli mogą znacząco zwiększyć wydajność i skalowalność aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ad698-103">Pooling connections can significantly enhance the performance and scalability of your application.</span></span> <span data-ttu-id="ad698-104">W tej sekcji omówiono pule połączeń .NET Framework dostawców danych dla OLE DB, ODBC i Oracle.</span><span class="sxs-lookup"><span data-stu-id="ad698-104">This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC, and Oracle.</span></span>

## <a name="oledb"></a><span data-ttu-id="ad698-105">OleDb</span><span class="sxs-lookup"><span data-stu-id="ad698-105">OleDb</span></span>

<span data-ttu-id="ad698-106">Dostawca danych .NET Framework dla OLE DB automatycznie pule połączeń przy użyciu puli sesji OLE DB.</span><span class="sxs-lookup"><span data-stu-id="ad698-106">The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling.</span></span> <span data-ttu-id="ad698-107">Argumenty parametrów połączenia mogą służyć do włączania lub wyłączania usług OLE DB, takich jak pule.</span><span class="sxs-lookup"><span data-stu-id="ad698-107">Connection string arguments can be used to enable or disable OLE DB services including pooling.</span></span> <span data-ttu-id="ad698-108">Na przykład następujące parametry połączenia uniemożliwiają OLE DB pule sesji i automatyczne rejestracje transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad698-108">For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.</span></span>

```csharp
Provider=SQLOLEDB;OLE DB Services=-4;Data Source=localhost;Integrated Security=SSPI;
```

 <span data-ttu-id="ad698-109">Zaleca się, aby zawsze zamykać lub zbyć połączenie po zakończeniu korzystania z niego w celu zwrócenia połączenia z pulą.</span><span class="sxs-lookup"><span data-stu-id="ad698-109">We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool.</span></span> <span data-ttu-id="ad698-110">Połączenia, które nie są jawnie zamknięte, mogą nie zostać zwrócone do puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-110">Connections that are not explicitly closed may not get returned to the pool.</span></span> <span data-ttu-id="ad698-111">Na przykład połączenie, które zostało utracone poza zakresem, ale nie zostało jawnie zamknięte, zostanie zwrócone do puli połączeń tylko wtedy, gdy Osiągnięto maksymalny rozmiar puli, a połączenie jest nadal ważne.</span><span class="sxs-lookup"><span data-stu-id="ad698-111">For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.</span></span>

 <span data-ttu-id="ad698-112">Aby uzyskać więcej informacji na temat OLE DB sesji lub puli zasobów, a także sposobu wyłączania puli przez zastępowanie ustawień domyślnych usługi dostawcy OLE DB, zobacz [Podręcznik programisty programu OLE DB](https://docs.microsoft.com/previous-versions/windows/desktop/ms713643(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="ad698-112">For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](https://docs.microsoft.com/previous-versions/windows/desktop/ms713643(v=vs.85)).</span></span>

## <a name="odbc"></a><span data-ttu-id="ad698-113">ODBC</span><span class="sxs-lookup"><span data-stu-id="ad698-113">ODBC</span></span>
 <span data-ttu-id="ad698-114">Pule połączeń dla Dostawca danych .NET Framework dla ODBC są zarządzane przez Menedżera sterowników ODBC, który jest używany do połączenia, i nie ma wpływ na .NET Framework Dostawca danych dla ODBC.</span><span class="sxs-lookup"><span data-stu-id="ad698-114">Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.</span></span>

 <span data-ttu-id="ad698-115">Aby włączyć lub wyłączyć buforowanie połączeń, Otwórz pozycję **Administrator źródła danych ODBC** w folderze Narzędzia administracyjne w panelu sterowania.</span><span class="sxs-lookup"><span data-stu-id="ad698-115">To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel.</span></span> <span data-ttu-id="ad698-116">Karta **pula połączeń** umożliwia określenie parametrów puli połączeń dla każdego zainstalowanego sterownika ODBC.</span><span class="sxs-lookup"><span data-stu-id="ad698-116">The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed.</span></span> <span data-ttu-id="ad698-117">Zmiany puli połączeń dla określonego sterownika ODBC mają wpływ na wszystkie aplikacje używające tego sterownika ODBC.</span><span class="sxs-lookup"><span data-stu-id="ad698-117">Connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.</span></span>

## <a name="oracleclient"></a><span data-ttu-id="ad698-118">OracleClient</span><span class="sxs-lookup"><span data-stu-id="ad698-118">OracleClient</span></span>
 <span data-ttu-id="ad698-119">.NET Framework Dostawca danych dla programu Oracle zapewnia automatyczne buforowanie połączeń dla aplikacji klienckiej ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="ad698-119">The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application.</span></span> <span data-ttu-id="ad698-120">Możesz również podać kilka modyfikatorów parametrów połączenia, aby kontrolować zachowanie puli połączeń (zobacz "kontrolowanie puli połączeń ze słowami kluczowymi parametrów połączenia" w dalszej części tego tematu).</span><span class="sxs-lookup"><span data-stu-id="ad698-120">You can also supply several connection string modifiers to control connection pooling behavior (see "Controlling Connection Pooling with Connection String Keywords," later in this topic).</span></span>

### <a name="create-and-assign-pools"></a><span data-ttu-id="ad698-121">Tworzenie i przypisywanie pul</span><span class="sxs-lookup"><span data-stu-id="ad698-121">Create and assign pools</span></span>
 <span data-ttu-id="ad698-122">Po otwarciu połączenia tworzona jest pula połączeń oparta na dokładnie zgodnym algorytmie, który kojarzy pulę z parametrami połączenia w połączeniu.</span><span class="sxs-lookup"><span data-stu-id="ad698-122">When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection.</span></span> <span data-ttu-id="ad698-123">Każda pula połączeń jest skojarzona z unikatowymi parametrami połączenia.</span><span class="sxs-lookup"><span data-stu-id="ad698-123">Each connection pool is associated with a distinct connection string.</span></span> <span data-ttu-id="ad698-124">W przypadku otwarcia nowego połączenia, jeśli parametry połączenia nie są dokładnie zgodne z istniejącą pulą, tworzona jest nowa pula.</span><span class="sxs-lookup"><span data-stu-id="ad698-124">When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.</span></span>

 <span data-ttu-id="ad698-125">Po utworzeniu pule połączeń nie są niszczone do momentu zakończenia aktywnego procesu.</span><span class="sxs-lookup"><span data-stu-id="ad698-125">Once created, connection pools are not destroyed until the active process ends.</span></span> <span data-ttu-id="ad698-126">Obsługa nieaktywnych lub pustych pul używa bardzo mało zasobów systemowych.</span><span class="sxs-lookup"><span data-stu-id="ad698-126">Maintaining inactive or empty pools uses very few system resources.</span></span>

### <a name="connection-addition"></a><span data-ttu-id="ad698-127">Dodawanie połączenia</span><span class="sxs-lookup"><span data-stu-id="ad698-127">Connection Addition</span></span>
 <span data-ttu-id="ad698-128">Pula połączeń jest tworzona dla każdego unikatowego ciągu połączenia.</span><span class="sxs-lookup"><span data-stu-id="ad698-128">A connection pool is created for each unique connection string.</span></span> <span data-ttu-id="ad698-129">Po utworzeniu puli do puli są tworzone i dodawane wiele obiektów połączeń, aby zapewnić spełnienie minimalnych wymagań dotyczących rozmiaru puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-129">When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied.</span></span> <span data-ttu-id="ad698-130">Połączenia są dodawane do puli w razie potrzeby do maksymalnego rozmiaru puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-130">Connections are added to the pool as needed, up to the maximum pool size.</span></span>

 <span data-ttu-id="ad698-131">Gdy zażądano obiektu <xref:System.Data.OracleClient.OracleConnection>, jest on uzyskiwany z puli, jeśli dostępne jest połączenie możliwe do użycia.</span><span class="sxs-lookup"><span data-stu-id="ad698-131">When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available.</span></span> <span data-ttu-id="ad698-132">Aby można było korzystać z tego połączenia, połączenie musi być obecnie nieużywane, mieć pasujący kontekst transakcji lub nie być skojarzone z żadnym kontekstem transakcji i mieć prawidłowe połączenie z serwerem.</span><span class="sxs-lookup"><span data-stu-id="ad698-132">To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.</span></span>

 <span data-ttu-id="ad698-133">Jeśli maksymalny rozmiar puli został osiągnięty i nie jest dostępne żadne możliwe połączenie, żądanie jest umieszczane w kolejce.</span><span class="sxs-lookup"><span data-stu-id="ad698-133">If the maximum pool size has been reached and no usable connection is available, the request is queued.</span></span> <span data-ttu-id="ad698-134">Pulę połączenia spełnia te żądania, ponownie przydzielając połączenia po ich wydaniu z powrotem do puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-134">The connection pooler satisfies these requests by reallocating connections as they are released back into the pool.</span></span> <span data-ttu-id="ad698-135">Połączenia są zwalniane z powrotem do puli, gdy są zamknięte lub usuwane.</span><span class="sxs-lookup"><span data-stu-id="ad698-135">Connections are released back into the pool when they are closed or disposed.</span></span>

### <a name="connection-removal"></a><span data-ttu-id="ad698-136">Usuwanie połączenia</span><span class="sxs-lookup"><span data-stu-id="ad698-136">Connection Removal</span></span>
 <span data-ttu-id="ad698-137">Połączenie pulę usuwa połączenie z puli, gdy było ono bezczynne przez dłuższy czas lub jeśli pulę wykryje, że połączenie z serwerem zostało odłączone.</span><span class="sxs-lookup"><span data-stu-id="ad698-137">The connection pooler removes a connection from the pool after it has been idle for an extended period of time or if the pooler detects that the connection with the server has been severed.</span></span> <span data-ttu-id="ad698-138">Ten sposób można wykryć tylko po podjęciu próby komunikacji z serwerem.</span><span class="sxs-lookup"><span data-stu-id="ad698-138">This can be detected only after attempting to communicate with the server.</span></span> <span data-ttu-id="ad698-139">Jeśli zostanie znalezione połączenie, które nie jest już połączone z serwerem, jest oznaczone jako nieprawidłowe.</span><span class="sxs-lookup"><span data-stu-id="ad698-139">If a connection is found that is no longer connected to the server, it is marked as invalid.</span></span> <span data-ttu-id="ad698-140">Pulę połączenia okresowo skanuje pule połączeń, szukając obiektów, które zostały wydane do puli i są oznaczone jako nieprawidłowe.</span><span class="sxs-lookup"><span data-stu-id="ad698-140">The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid.</span></span> <span data-ttu-id="ad698-141">Zostaną one trwale usunięte.</span><span class="sxs-lookup"><span data-stu-id="ad698-141">These connections are then permanently removed.</span></span>

 <span data-ttu-id="ad698-142">Jeśli połączenie istnieje na serwerze, który został wyświetlony, to połączenie może być narysowane z puli, jeśli połączenie pulę nie wykryło poprawnego połączenia i zostało oznaczone jako nieprawidłowe.</span><span class="sxs-lookup"><span data-stu-id="ad698-142">If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid.</span></span> <span data-ttu-id="ad698-143">W takim przypadku zostanie wygenerowany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="ad698-143">When this occurs, an exception is generated.</span></span> <span data-ttu-id="ad698-144">Jednak nadal należy zamknąć połączenie w celu zwolnienia go z powrotem do puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-144">However, you must still close the connection in order to release it back into the pool.</span></span>

 <span data-ttu-id="ad698-145">Nie wywołuj `Close` ani `Dispose` na `Connection`, `DataReader`ani żadnych innych zarządzanych obiektów w metodzie `Finalize` klasy.</span><span class="sxs-lookup"><span data-stu-id="ad698-145">Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class.</span></span> <span data-ttu-id="ad698-146">W finalizatorze zwalniane są tylko niezarządzane zasoby, które są własnością klasy bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="ad698-146">In a finalizer, only release unmanaged resources that your class owns directly.</span></span> <span data-ttu-id="ad698-147">Jeśli Klasa nie jest własnością żadnych niezarządzanych zasobów, nie Uwzględniaj metody `Finalize` w definicji klasy.</span><span class="sxs-lookup"><span data-stu-id="ad698-147">If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition.</span></span> <span data-ttu-id="ad698-148">Aby uzyskać więcej informacji, zobacz [odzyskiwanie pamięci](../../../standard/garbage-collection/index.md).</span><span class="sxs-lookup"><span data-stu-id="ad698-148">For more information, see [Garbage Collection](../../../standard/garbage-collection/index.md).</span></span>

### <a name="transaction-support"></a><span data-ttu-id="ad698-149">Obsługa transakcji</span><span class="sxs-lookup"><span data-stu-id="ad698-149">Transaction Support</span></span>
 <span data-ttu-id="ad698-150">Połączenia są rysowane z puli i przypisywane na podstawie kontekstu transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad698-150">Connections are drawn from the pool and assigned based on transaction context.</span></span> <span data-ttu-id="ad698-151">Kontekst wątku żądającego i przypisanego połączenia musi być zgodny.</span><span class="sxs-lookup"><span data-stu-id="ad698-151">The context of the requesting thread and the assigned connection must match.</span></span> <span data-ttu-id="ad698-152">W związku z tym każda pula połączeń jest podzielona na połączenia bez skojarzonego kontekstu transakcji i do *N* podpodziałów, z których każdy zawiera połączenia z określonym kontekstem transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad698-152">Therefore, each connection pool is subdivided into connections with no associated transaction context and into *N* subdivisions that each contain connections with a particular transaction context.</span></span>

 <span data-ttu-id="ad698-153">Gdy połączenie jest zamknięte, zostaje wydane z powrotem do puli i do odpowiedniej części pola na podstawie kontekstu transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad698-153">When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context.</span></span> <span data-ttu-id="ad698-154">W związku z tym możesz zamknąć połączenie bez generowania błędu, mimo że transakcja rozproszona nadal oczekuje.</span><span class="sxs-lookup"><span data-stu-id="ad698-154">Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending.</span></span> <span data-ttu-id="ad698-155">Dzięki temu możesz zatwierdzić lub przerwać transakcję rozproszoną w późniejszym czasie.</span><span class="sxs-lookup"><span data-stu-id="ad698-155">This allows you to commit or abort the distributed transaction at a later time.</span></span>

### <a name="control-connection-pooling-with-connection-string-keywords"></a><span data-ttu-id="ad698-156">Sterowanie pulą połączeń przy użyciu słów kluczowych parametrów połączenia</span><span class="sxs-lookup"><span data-stu-id="ad698-156">Control Connection Pooling with Connection String Keywords</span></span>
 <span data-ttu-id="ad698-157">Właściwość <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> obiektu <xref:System.Data.OracleClient.OracleConnection> obsługuje pary klucz/wartość parametrów połączenia, których można użyć do dostosowania zachowania logiki puli połączeń.</span><span class="sxs-lookup"><span data-stu-id="ad698-157">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.</span></span>

 <span data-ttu-id="ad698-158">W poniższej tabeli opisano wartości <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>, których można użyć do dostosowania zachowania puli połączeń.</span><span class="sxs-lookup"><span data-stu-id="ad698-158">The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior.</span></span>

|<span data-ttu-id="ad698-159">Nazwa</span><span class="sxs-lookup"><span data-stu-id="ad698-159">Name</span></span>|<span data-ttu-id="ad698-160">Domyślny</span><span class="sxs-lookup"><span data-stu-id="ad698-160">Default</span></span>|<span data-ttu-id="ad698-161">Opis</span><span class="sxs-lookup"><span data-stu-id="ad698-161">Description</span></span>|
|----------|-------------|-----------------|
|`Connection Lifetime`|<span data-ttu-id="ad698-162">0</span><span class="sxs-lookup"><span data-stu-id="ad698-162">0</span></span>|<span data-ttu-id="ad698-163">Gdy połączenie zostanie zwrócone do puli, jego czas utworzenia jest porównywany z bieżącą godziną i połączenie jest niszczone, jeśli ten przedział czasu (w sekundach) przekroczy wartość określoną przez `Connection Lifetime`.</span><span class="sxs-lookup"><span data-stu-id="ad698-163">When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`.</span></span> <span data-ttu-id="ad698-164">Jest to przydatne w konfiguracjach klastrowanych w celu wymuszenia równoważenia obciążenia między uruchomionym serwerem a serwerem, który został przełączony w tryb online.</span><span class="sxs-lookup"><span data-stu-id="ad698-164">This is useful in clustered configurations to force load balancing between a running server and a server just brought online.</span></span><br /><br /> <span data-ttu-id="ad698-165">Wartość zero (0) powoduje, że połączenia w puli mają maksymalny limit czasu.</span><span class="sxs-lookup"><span data-stu-id="ad698-165">A value of zero (0) will cause pooled connections to have the maximum time-out.</span></span>|
|`Enlist`|<span data-ttu-id="ad698-166">'true'</span><span class="sxs-lookup"><span data-stu-id="ad698-166">'true'</span></span>|<span data-ttu-id="ad698-167">Gdy `true`, pulę automatycznie zarejestrowanie połączenia w bieżącym kontekście transakcji wątku tworzenia, jeśli istnieje kontekst transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad698-167">When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.</span></span>|
|`Max Pool Size`|<span data-ttu-id="ad698-168">100</span><span class="sxs-lookup"><span data-stu-id="ad698-168">100</span></span>|<span data-ttu-id="ad698-169">Maksymalna liczba połączeń dozwolonych w puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-169">The maximum number of connections allowed in the pool.</span></span>|
|`Min Pool Size`|<span data-ttu-id="ad698-170">0</span><span class="sxs-lookup"><span data-stu-id="ad698-170">0</span></span>|<span data-ttu-id="ad698-171">Minimalna liczba połączeń przechowywanych w puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-171">The minimum number of connections maintained in the pool.</span></span>|
|`Pooling`|<span data-ttu-id="ad698-172">'true'</span><span class="sxs-lookup"><span data-stu-id="ad698-172">'true'</span></span>|<span data-ttu-id="ad698-173">Gdy `true`, połączenie jest nawiązywane z odpowiedniej puli lub w razie potrzeby tworzone i dodawane do odpowiedniej puli.</span><span class="sxs-lookup"><span data-stu-id="ad698-173">When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.</span></span>|

## <a name="see-also"></a><span data-ttu-id="ad698-174">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="ad698-174">See also</span></span>

- [<span data-ttu-id="ad698-175">Pula połączeń</span><span class="sxs-lookup"><span data-stu-id="ad698-175">Connection Pooling</span></span>](connection-pooling.md)
- [<span data-ttu-id="ad698-176">Liczniki wydajności</span><span class="sxs-lookup"><span data-stu-id="ad698-176">Performance Counters</span></span>](performance-counters.md)
- [<span data-ttu-id="ad698-177">Omówienie ADO.NET</span><span class="sxs-lookup"><span data-stu-id="ad698-177">ADO.NET Overview</span></span>](ado-net-overview.md)
