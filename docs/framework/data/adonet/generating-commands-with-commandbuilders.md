---
title: Generowanie poleceń za pomocą CommandBuilders
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 6e3fb8b5-373b-4f9e-ab03-a22693df8e91
ms.openlocfilehash: 76c2a6cb0661a0e39fc3a0dd599fcbb3c046f382
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/12/2020
ms.locfileid: "79149615"
---
# <a name="generating-commands-with-commandbuilders"></a><span data-ttu-id="8f7e1-102">Generowanie poleceń za pomocą CommandBuilders</span><span class="sxs-lookup"><span data-stu-id="8f7e1-102">Generating Commands with CommandBuilders</span></span>
<span data-ttu-id="8f7e1-103">Gdy `SelectCommand` właściwość jest dynamicznie określona w czasie wykonywania, na przykład za pośrednictwem narzędzia kwerendy, które pobiera `InsertCommand` `UpdateCommand`polecenie `DeleteCommand` tekstowe od użytkownika, nie można określić odpowiedniego , lub w czasie projektowania.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-103">When the `SelectCommand` property is dynamically specified at run time, such as through a query tool that takes a textual command from the user, you may not be able to specify the appropriate `InsertCommand`, `UpdateCommand`, or `DeleteCommand` at design time.</span></span> <span data-ttu-id="8f7e1-104">Jeśli <xref:System.Data.DataTable> mapy do lub jest generowany z jednej tabeli <xref:System.Data.Common.DbCommandBuilder> bazy danych, można `DeleteCommand` `InsertCommand`skorzystać `UpdateCommand` z <xref:System.Data.Common.DbDataAdapter>obiektu, aby automatycznie wygenerować , i .</span><span class="sxs-lookup"><span data-stu-id="8f7e1-104">If your <xref:System.Data.DataTable> maps to or is generated from a single database table, you can take advantage of the <xref:System.Data.Common.DbCommandBuilder> object to automatically generate the `DeleteCommand`, `InsertCommand`, and `UpdateCommand` of the <xref:System.Data.Common.DbDataAdapter>.</span></span>  
  
 <span data-ttu-id="8f7e1-105">Jako wymóg minimalny należy ustawić `SelectCommand` właściwość, aby automatyczne generowanie poleceń działało.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-105">As a minimum requirement, you must set the `SelectCommand` property in order for automatic command generation to work.</span></span> <span data-ttu-id="8f7e1-106">Schemat tabeli pobrany `SelectCommand` przez właściwość określa składnię automatycznie generowanych instrukcji INSERT, UPDATE i DELETE.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-106">The table schema retrieved by the `SelectCommand` property determines the syntax of the automatically generated INSERT, UPDATE, and DELETE statements.</span></span>  
  
 <span data-ttu-id="8f7e1-107">Musi <xref:System.Data.Common.DbCommandBuilder> wykonać `SelectCommand` w celu zwrócenia metadanych niezbędnych do konstruowania wstawić, UPDATE i DELETE SQL poleceń.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-107">The <xref:System.Data.Common.DbCommandBuilder> must execute the `SelectCommand` in order to return the metadata necessary to construct the INSERT, UPDATE, and DELETE SQL commands.</span></span> <span data-ttu-id="8f7e1-108">W rezultacie konieczna jest dodatkowa podróż do źródła danych, co może utrudniać działanie.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-108">As a result, an extra trip to the data source is necessary, and this can hinder performance.</span></span> <span data-ttu-id="8f7e1-109">Aby osiągnąć optymalną wydajność, należy określić <xref:System.Data.Common.DbCommandBuilder>polecenia jawnie, a nie za pomocą .</span><span class="sxs-lookup"><span data-stu-id="8f7e1-109">To achieve optimal performance, specify your commands explicitly rather than using the <xref:System.Data.Common.DbCommandBuilder>.</span></span>  
  
 <span data-ttu-id="8f7e1-110">Musi `SelectCommand` również zwrócić co najmniej jeden klucz podstawowy lub unikatową kolumnę.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-110">The `SelectCommand` must also return at least one primary key or unique column.</span></span> <span data-ttu-id="8f7e1-111">Jeśli żaden z `InvalidOperation` nich nie jest obecny, wyjątek jest generowany, a polecenia nie są generowane.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-111">If none are present, an `InvalidOperation` exception is generated, and the commands are not generated.</span></span>  
  
 <span data-ttu-id="8f7e1-112">Po skojarzeniu `DataAdapter`z <xref:System.Data.Common.DbCommandBuilder> , automatycznie generuje `InsertCommand` `UpdateCommand`, `DeleteCommand` i `DataAdapter` właściwości, jeśli są one null odwołania.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-112">When associated with a `DataAdapter`, the <xref:System.Data.Common.DbCommandBuilder> automatically generates the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties of the `DataAdapter` if they are null references.</span></span> <span data-ttu-id="8f7e1-113">Jeśli `Command` już istnieje dla właściwości, `Command` jest używany istniejący.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-113">If a `Command` already exists for a property, the existing `Command` is used.</span></span>  
  
 <span data-ttu-id="8f7e1-114">Widoki bazy danych, które są tworzone przez połączenie dwóch lub więcej tabel razem nie są uważane za jedną tabelę bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-114">Database views that are created by joining two or more tables together are not considered a single database table.</span></span> <span data-ttu-id="8f7e1-115">W tym przypadku nie <xref:System.Data.Common.DbCommandBuilder> można użyć do automatycznego generowania poleceń; należy określić polecenia jawnie.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-115">In this instance you cannot use the <xref:System.Data.Common.DbCommandBuilder> to automatically generate commands; you must specify your commands explicitly.</span></span> <span data-ttu-id="8f7e1-116">Aby uzyskać informacje dotyczące jawnego ustawiania `DataSet` poleceń rozpoznawania aktualizacji z powrotem do źródła danych, zobacz [Aktualizowanie źródeł danych za pomocą programów DataAdapters](updating-data-sources-with-dataadapters.md).</span><span class="sxs-lookup"><span data-stu-id="8f7e1-116">For information about explicitly setting commands to resolve updates to a `DataSet` back to the data source, see [Updating Data Sources with DataAdapters](updating-data-sources-with-dataadapters.md).</span></span>  
  
 <span data-ttu-id="8f7e1-117">Można zamapować parametry wyjściowe z powrotem do zaktualizowanego wiersza pliku `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-117">You might want to map output parameters back to the updated row of a `DataSet`.</span></span> <span data-ttu-id="8f7e1-118">Jednym z typowych zadań będzie pobieranie wartości automatycznie wygenerowanego pola tożsamości lub sygnatury czasowej ze źródła danych.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-118">One common task would be retrieving the value of an automatically generated identity field or time stamp from the data source.</span></span> <span data-ttu-id="8f7e1-119">Domyślnie <xref:System.Data.Common.DbCommandBuilder> nie mapuje parametrów wyjściowych na kolumny w zaktualizowanym wierszu.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-119">The <xref:System.Data.Common.DbCommandBuilder> will not map output parameters to columns in an updated row by default.</span></span> <span data-ttu-id="8f7e1-120">W tym przypadku należy jawnie określić polecenie.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-120">In this instance you must specify your command explicitly.</span></span> <span data-ttu-id="8f7e1-121">Na przykład mapowania automatycznie wygenerowanego pola tożsamości z powrotem do kolumny wstawionego wiersza zobacz [Pobieranie wartości tożsamości lub Autonumerowania](retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="8f7e1-121">For an example of mapping an automatically generated identity field back to a column of an inserted row, see [Retrieving Identity or Autonumber Values](retrieving-identity-or-autonumber-values.md).</span></span>  
  
## <a name="rules-for-automatically-generated-commands"></a><span data-ttu-id="8f7e1-122">Reguły dla automatycznie generowanych poleceń</span><span class="sxs-lookup"><span data-stu-id="8f7e1-122">Rules for Automatically Generated Commands</span></span>  
 <span data-ttu-id="8f7e1-123">W poniższej tabeli przedstawiono reguły generowania automatycznie generowanych poleceń.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-123">The following table shows the rules for how automatically generated commands are generated.</span></span>  
  
|<span data-ttu-id="8f7e1-124">Polecenie</span><span class="sxs-lookup"><span data-stu-id="8f7e1-124">Command</span></span>|<span data-ttu-id="8f7e1-125">Reguła</span><span class="sxs-lookup"><span data-stu-id="8f7e1-125">Rule</span></span>|  
|-------------|----------|  
|`InsertCommand`|<span data-ttu-id="8f7e1-126">Wstawia wiersz u źródła danych dla wszystkich wierszy w tabeli z <xref:System.Data.DataRow.RowState%2A> . <xref:System.Data.DataRowState.Added></span><span class="sxs-lookup"><span data-stu-id="8f7e1-126">Inserts a row at the data source for all rows in the table with a <xref:System.Data.DataRow.RowState%2A> of <xref:System.Data.DataRowState.Added>.</span></span> <span data-ttu-id="8f7e1-127">Wstawia wartości dla wszystkich kolumn, które można aktualizować (ale nie kolumny, takie jak tożsamości, wyrażenia lub sygnatury czasowe).</span><span class="sxs-lookup"><span data-stu-id="8f7e1-127">Inserts values for all columns that are updateable (but not columns such as identities, expressions, or timestamps).</span></span>|  
|`UpdateCommand`|<span data-ttu-id="8f7e1-128">Aktualizuje wiersze w źródle danych dla wszystkich `RowState` wierszy w tabeli z . <xref:System.Data.DataRowState.Modified></span><span class="sxs-lookup"><span data-stu-id="8f7e1-128">Updates rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="8f7e1-129">Aktualizuje wartości wszystkich kolumn z wyjątkiem kolumn, które nie można aktualizować, takich jak tożsamości lub wyrażenia.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-129">Updates the values of all columns except for columns that are not updateable, such as identities or expressions.</span></span> <span data-ttu-id="8f7e1-130">Aktualizuje wszystkie wiersze, w których wartości kolumn w źródle danych są zgodne z wartościami kolumn klucza podstawowego wiersza i w których pozostałe kolumny w źródle danych są zgodne z oryginalnymi wartościami wiersza.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-130">Updates all rows where the column values at the data source match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="8f7e1-131">Aby uzyskać więcej informacji, zobacz "Optymistyczny model współbieżności dla aktualizacji i usuwania", w dalszej części tego tematu.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-131">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
|`DeleteCommand`|<span data-ttu-id="8f7e1-132">Usuwa wiersze u źródła danych dla wszystkich wierszy `RowState` <xref:System.Data.DataRowState.Deleted>w tabeli z plikiem .</span><span class="sxs-lookup"><span data-stu-id="8f7e1-132">Deletes rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Deleted>.</span></span> <span data-ttu-id="8f7e1-133">Usuwa wszystkie wiersze, w których wartości kolumn odpowiadają wartościom kolumny klucza podstawowego wiersza i w których pozostałe kolumny w źródle danych są zgodne z oryginalnymi wartościami wiersza.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-133">Deletes all rows where the column values match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="8f7e1-134">Aby uzyskać więcej informacji, zobacz "Optymistyczny model współbieżności dla aktualizacji i usuwania", w dalszej części tego tematu.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-134">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
  
## <a name="optimistic-concurrency-model-for-updates-and-deletes"></a><span data-ttu-id="8f7e1-135">Optymistyczny model współbieżności dla aktualizacji i usuwania</span><span class="sxs-lookup"><span data-stu-id="8f7e1-135">Optimistic Concurrency Model for Updates and Deletes</span></span>  
 <span data-ttu-id="8f7e1-136">Logika automatycznego generowania poleceń dla instrukcji UPDATE i DELETE opiera się na *optymistycznej współbieżności*- oznacza to, że rekordy nie są zablokowane do edycji i mogą być modyfikowane przez innych użytkowników lub procesy w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-136">The logic for generating commands automatically for UPDATE and DELETE statements is based on *optimistic concurrency*--that is, records are not locked for editing and can be modified by other users or processes at any time.</span></span> <span data-ttu-id="8f7e1-137">Ponieważ rekord mógł zostać zmodyfikowany po jego zwrocie z instrukcji SELECT, ale przed wydaniem instrukcji UPDATE lub DELETE, automatycznie wygenerowana instrukcja UPDATE lub DELETE zawiera klauzulę WHERE, określającą, że wiersz jest aktualizowany tylko wtedy, gdy jest aktualizowany zawiera wszystkie oryginalne wartości i nie został usunięty ze źródła danych.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-137">Because a record could have been modified after it was returned from the SELECT statement, but before the UPDATE or DELETE statement is issued, the automatically generated UPDATE or DELETE statement contains a WHERE clause, specifying that a row is only updated if it contains all original values and has not been deleted from the data source.</span></span> <span data-ttu-id="8f7e1-138">Ma to na celu uniknięcie zastępowania nowych danych.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-138">This is done to avoid overwriting new data.</span></span> <span data-ttu-id="8f7e1-139">W przypadku, gdy automatycznie generowana aktualizacja próbuje zaktualizować wiersz, który został <xref:System.Data.DataSet>usunięty lub który nie zawiera oryginalnych wartości znalezionych w , polecenie nie wpływa na żadne rekordy i <xref:System.Data.DBConcurrencyException> jest wyrzucane.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-139">Where an automatically generated update attempts to update a row that has been deleted or that does not contain the original values found in the <xref:System.Data.DataSet>, the command does not affect any records, and a <xref:System.Data.DBConcurrencyException> is thrown.</span></span>  
  
 <span data-ttu-id="8f7e1-140">Jeśli chcesz UPDATE lub DELETE, aby zakończyć niezależnie od oryginalnych wartości, należy jawnie ustawić `UpdateCommand` dla `DataAdapter` i nie polegać na automatyczne generowanie poleceń.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-140">If you want the UPDATE or DELETE to complete regardless of original values, you must explicitly set the `UpdateCommand` for the `DataAdapter` and not rely on automatic command generation.</span></span>  
  
## <a name="limitations-of-automatic-command-generation-logic"></a><span data-ttu-id="8f7e1-141">Ograniczenia logiki automatycznego generowania poleceń</span><span class="sxs-lookup"><span data-stu-id="8f7e1-141">Limitations of Automatic Command Generation Logic</span></span>  
 <span data-ttu-id="8f7e1-142">Następujące ograniczenia dotyczą automatycznego generowania poleceń.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-142">The following limitations apply to automatic command generation.</span></span>  
  
### <a name="unrelated-tables-only"></a><span data-ttu-id="8f7e1-143">Tylko niepowiązane tabele</span><span class="sxs-lookup"><span data-stu-id="8f7e1-143">Unrelated Tables Only</span></span>  
 <span data-ttu-id="8f7e1-144">Logika automatycznego generowania poleceń generuje instrukcje INSERT, UPDATE lub DELETE dla tabel autonomicznych bez uwzględnienia żadnych relacji z innymi tabelami w źródle danych.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-144">The automatic command generation logic generates INSERT, UPDATE, or DELETE statements for stand-alone tables without taking into account any relationships to other tables at the data source.</span></span> <span data-ttu-id="8f7e1-145">W rezultacie może wystąpić błąd podczas `Update` wywoływania do przesyłania zmian dla kolumny, która uczestniczy w ograniczeniu klucza obcego w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-145">As a result, you may encounter a failure when calling `Update` to submit changes for a column that participates in a foreign key constraint in the database.</span></span> <span data-ttu-id="8f7e1-146">Aby uniknąć tego wyjątku, <xref:System.Data.Common.DbCommandBuilder> nie należy używać do aktualizowania kolumn zaangażowanych w ograniczenie klucza obcego; zamiast tego jawnie określić instrukcje używane do wykonywania operacji.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-146">To avoid this exception, do not use the <xref:System.Data.Common.DbCommandBuilder> for updating columns involved in a foreign key constraint; instead, explicitly specify the statements used to perform the operation.</span></span>  
  
### <a name="table-and-column-names"></a><span data-ttu-id="8f7e1-147">Nazwy tabel i kolumn</span><span class="sxs-lookup"><span data-stu-id="8f7e1-147">Table and Column Names</span></span>  
 <span data-ttu-id="8f7e1-148">Logika automatycznego generowania poleceń może zakończyć się niepowodzeniem, jeśli nazwy kolumn lub tabel zawierają znaki specjalne, takie jak spacje, kropki, cudzysłowy lub inne znaki niealphanumeryczne, nawet jeśli są rozdzielone nawiasami.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-148">Automatic command generation logic may fail if column names or table names contain any special characters, such as spaces, periods, quotation marks, or other nonalphanumeric characters, even if delimited by brackets.</span></span> <span data-ttu-id="8f7e1-149">W zależności od dostawcy ustawienie parametrów QuotePrefix i QuoteSuffix może umożliwić logice generowania przetwarzanie spacji, ale nie może uciec przed znakami specjalnymi.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-149">Depending on the provider, setting the QuotePrefix and QuoteSuffix parameters may allow the generation logic to process spaces, but it cannot escape special characters.</span></span> <span data-ttu-id="8f7e1-150">Obsługiwane są w pełni kwalifikowane nazwy tabel w postaci *catalog.schema.table.*</span><span class="sxs-lookup"><span data-stu-id="8f7e1-150">Fully qualified table names in the form of *catalog.schema.table* are supported.</span></span>  
  
## <a name="using-the-commandbuilder-to-automatically-generate-an-sql-statement"></a><span data-ttu-id="8f7e1-151">Automatyczne generowanie instrukcji SQL za pomocą narzędzia CommandBuilder</span><span class="sxs-lookup"><span data-stu-id="8f7e1-151">Using the CommandBuilder to Automatically Generate an SQL Statement</span></span>  
 <span data-ttu-id="8f7e1-152">Aby automatycznie wygenerować `DataAdapter`instrukcje `SelectCommand` SQL dla `DataAdapter`, najpierw `CommandBuilder` ustaw właściwość , `DataAdapter` a następnie `CommandBuilder` utwórz obiekt i określ jako argument, dla którego będą automatycznie generować instrukcje SQL.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-152">To automatically generate SQL statements for a `DataAdapter`, first set the `SelectCommand` property of the `DataAdapter`, then create a `CommandBuilder` object, and specify as an argument the `DataAdapter` for which the `CommandBuilder` will automatically generate SQL statements.</span></span>  
  
```vb  
' Assumes that connection is a valid SqlConnection object
' inside of a Using block.  
Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  
  "SELECT * FROM dbo.Customers", connection)  
Dim builder As SqlCommandBuilder = New SqlCommandBuilder(adapter)  
builder.QuotePrefix = "["  
builder.QuoteSuffix = "]"  
```  
  
```csharp  
// Assumes that connection is a valid SqlConnection object  
// inside of a using block.  
SqlDataAdapter adapter = new SqlDataAdapter(  
  "SELECT * FROM dbo.Customers", connection);  
SqlCommandBuilder builder = new SqlCommandBuilder(adapter);  
builder.QuotePrefix = "[";  
builder.QuoteSuffix = "]";  
```  
  
## <a name="modifying-the-selectcommand"></a><span data-ttu-id="8f7e1-153">Modyfikowanie selectcommand</span><span class="sxs-lookup"><span data-stu-id="8f7e1-153">Modifying the SelectCommand</span></span>  
 <span data-ttu-id="8f7e1-154">Jeśli zmodyfikujesz `CommandText` `SelectCommand` polecenia po automatycznym wygenerowaniu poleceń INSERT, UPDATE lub DELETE, może wystąpić wyjątek.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-154">If you modify the `CommandText` of the `SelectCommand` after the INSERT, UPDATE, or DELETE commands have been automatically generated, an exception may occur.</span></span> <span data-ttu-id="8f7e1-155">Jeśli zmodyfikowane `SelectCommand.CommandText` zawiera informacje o schemacie, który jest niezgodny z `SelectCommand.CommandText` używanym podczas automatycznego `DataAdapter.Update` generowania poleceń wstawiania, aktualizacji lub usuwania, `SelectCommand`przyszłe wywołania metody mogą próbować uzyskać dostęp do kolumn, które już nie istnieją w bieżącej tabeli, do których odwołuje się program , i zostanie zgłoszony wyjątek.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-155">If the modified `SelectCommand.CommandText` contains schema information that is inconsistent with the `SelectCommand.CommandText` used when the insert, update, or delete commands were automatically generated, future calls to the `DataAdapter.Update` method may attempt to access columns that no longer exist in the current table referenced by the `SelectCommand`, and an exception will be thrown.</span></span>  
  
 <span data-ttu-id="8f7e1-156">Można odświeżyć informacje o `CommandBuilder` schemacie używane przez polecenie `RefreshSchema` do `CommandBuilder`automatycznego generowania poleceń, wywołując metodę programu .</span><span class="sxs-lookup"><span data-stu-id="8f7e1-156">You can refresh the schema information used by the `CommandBuilder` to automatically generate commands by calling the `RefreshSchema` method of the `CommandBuilder`.</span></span>  
  
 <span data-ttu-id="8f7e1-157">Jeśli chcesz wiedzieć, jakie polecenie zostało wygenerowane automatycznie, możesz uzyskać odwołanie do `GetInsertCommand`automatycznie `GetUpdateCommand`generowanych poleceń za pomocą , i `GetDeleteCommand` metod `CommandBuilder` obiektu i sprawdzania `CommandText` właściwości skojarzonego polecenia.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-157">If you want to know what command was automatically generated, you can obtain a reference to the automatically generated commands by using the `GetInsertCommand`, `GetUpdateCommand`, and `GetDeleteCommand` methods of the `CommandBuilder` object and checking the `CommandText` property of the associated command.</span></span>  
  
 <span data-ttu-id="8f7e1-158">Poniższy przykład kodu zapisuje w konsoli polecenie aktualizacji, które zostało wygenerowane automatycznie.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-158">The following code example writes to the console the update command that was automatically generated.</span></span>  
  
```vb
Console.WriteLine(builder.GetUpdateCommand().CommandText)  
```

```csharp
Console.WriteLine(builder.GetUpdateCommand().CommandText);
```
  
 <span data-ttu-id="8f7e1-159">Poniższy przykład odtwarza `Customers` tabelę `custDS` w zestawie danych.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-159">The following example recreates the `Customers` table in the `custDS` dataset.</span></span> <span data-ttu-id="8f7e1-160">**Metoda RefreshSchema** jest wywoływana w celu odświeżenia automatycznie generowanych poleceń za pomocą tych nowych informacji o kolumnie.</span><span class="sxs-lookup"><span data-stu-id="8f7e1-160">The **RefreshSchema** method is called to refresh the automatically generated commands with this new column information.</span></span>  
  
```vb  
' Assumes an open SqlConnection and SqlDataAdapter inside of a Using block.  
adapter.SelectCommand.CommandText = _  
  "SELECT CustomerID, ContactName FROM dbo.Customers"  
builder.RefreshSchema()  
  
custDS.Tables.Remove(custDS.Tables("Customers"))  
adapter.Fill(custDS, "Customers")  
```  
  
```csharp  
// Assumes an open SqlConnection and SqlDataAdapter inside of a using block.  
adapter.SelectCommand.CommandText =
  "SELECT CustomerID, ContactName FROM dbo.Customers";  
builder.RefreshSchema();  
  
custDS.Tables.Remove(custDS.Tables["Customers"]);  
adapter.Fill(custDS, "Customers");  
```  
  
## <a name="see-also"></a><span data-ttu-id="8f7e1-161">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="8f7e1-161">See also</span></span>

- [<span data-ttu-id="8f7e1-162">Polecenia i parametry</span><span class="sxs-lookup"><span data-stu-id="8f7e1-162">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="8f7e1-163">Wykonywanie polecenia</span><span class="sxs-lookup"><span data-stu-id="8f7e1-163">Executing a Command</span></span>](executing-a-command.md)
- [<span data-ttu-id="8f7e1-164">DbConnection, DbCommand i DbException</span><span class="sxs-lookup"><span data-stu-id="8f7e1-164">DbConnection, DbCommand and DbException</span></span>](dbconnection-dbcommand-and-dbexception.md)
- [<span data-ttu-id="8f7e1-165">Omówienie ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8f7e1-165">ADO.NET Overview</span></span>](ado-net-overview.md)
