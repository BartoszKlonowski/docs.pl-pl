---
title: Powiązanie danych
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: cbec8b02-a1e8-4ae8-a83b-bb5190413ac5
ms.openlocfilehash: 79a14e787b4fe1aa1b16ad661b11a43b12bdd718
ms.sourcegitcommit: 4e2d355baba82814fa53efd6b8bbb45bfe054d11
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/04/2019
ms.locfileid: "70247379"
---
# <a name="data-binding"></a><span data-ttu-id="afcbf-102">Powiązanie danych</span><span class="sxs-lookup"><span data-stu-id="afcbf-102">Data Binding</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="afcbf-103">obsługuje powiązanie ze wspólnymi kontrolkami, takimi jak kontrolki siatki.</span><span class="sxs-lookup"><span data-stu-id="afcbf-103">supports binding to common controls, such as grid controls.</span></span> <span data-ttu-id="afcbf-104">W szczególności [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] definiuje podstawowe wzorce do tworzenia powiązań z siatką danych i obsługi powiązań wzorzec-szczegóły, w odniesieniu do wyświetlania i aktualizowania.</span><span class="sxs-lookup"><span data-stu-id="afcbf-104">Specifically, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] defines the basic patterns for binding to a data grid and handling master-detail binding, both with regard to display and updating.</span></span>

## <a name="underlying-principle"></a><span data-ttu-id="afcbf-105">Podstawowa zasada</span><span class="sxs-lookup"><span data-stu-id="afcbf-105">Underlying Principle</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="afcbf-106">tłumaczy [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] zapytania na SQL na potrzeby wykonywania w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="afcbf-106">translates [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries to SQL for execution on a database.</span></span> <span data-ttu-id="afcbf-107">Wyniki są jednoznacznie wpisane `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="afcbf-107">The results are strongly typed `IEnumerable`.</span></span> <span data-ttu-id="afcbf-108">Ponieważ te obiekty są zwykłymi obiektami środowiska uruchomieniowego języka wspólnego (CLR), zwykłe powiązanie danych obiektów może służyć do wyświetlania wyników.</span><span class="sxs-lookup"><span data-stu-id="afcbf-108">Because these objects are ordinary common language runtime (CLR) objects, ordinary object data binding can be used to display the results.</span></span> <span data-ttu-id="afcbf-109">Z drugiej strony operacje zmiany (INSERT, Updates i usunięć) wymagają wykonania dodatkowych czynności.</span><span class="sxs-lookup"><span data-stu-id="afcbf-109">On the other hand, change operations (inserts, updates, and deletes) require additional steps.</span></span>

## <a name="operation"></a><span data-ttu-id="afcbf-110">Operacja</span><span class="sxs-lookup"><span data-stu-id="afcbf-110">Operation</span></span>

<span data-ttu-id="afcbf-111">Niejawnie wiązanie z kontrolkami Windows Forms jest realizowane przez <xref:System.ComponentModel.IListSource>implementację.</span><span class="sxs-lookup"><span data-stu-id="afcbf-111">Implicitly binding to Windows Forms controls is accomplished by implementing <xref:System.ComponentModel.IListSource>.</span></span> <span data-ttu-id="afcbf-112">Źródła <xref:System.Data.Linq.Table%601> danych `DataQuery` (`Table<T>` C# w <xref:System.ComponentModel.IListSource>VisualBasic)i ogólne zostały zaktualizowane w celu zaimplementowania. `Table(Of T)`</span><span class="sxs-lookup"><span data-stu-id="afcbf-112">Data sources generic <xref:System.Data.Linq.Table%601> (`Table<T>` in C# or `Table(Of T)` in Visual Basic) and generic `DataQuery` have been updated to implement <xref:System.ComponentModel.IListSource>.</span></span> <span data-ttu-id="afcbf-113">Aparaty powiązań danych (UI) dla interfejsu użytkownika (Windows Forms i Windows Presentation Foundation) sprawdzają, czy ich źródło <xref:System.ComponentModel.IListSource>danych implementuje.</span><span class="sxs-lookup"><span data-stu-id="afcbf-113">User interface (UI) data-binding engines (Windows Forms and Windows Presentation Foundation) both test whether their data source implements <xref:System.ComponentModel.IListSource>.</span></span> <span data-ttu-id="afcbf-114">W związku z tym pisanie bezpośredniego wpływu zapytania do źródła danych kontrolki niejawnie wywołuje [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] generowanie kolekcji, jak w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="afcbf-114">Therefore, writing a direct affectation of a query to a data source of a control implicitly calls [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] collection generation, as in the following example:</span></span>

[!code-csharp[DLinqDataBinding#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqDataBinding/cs/Program.cs#1)]
[!code-vb[DLinqDataBinding#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqDataBinding/vb/Module1.vb#1)]

<span data-ttu-id="afcbf-115">Ten sam problem występuje w przypadku Windows Presentation Foundation:</span><span class="sxs-lookup"><span data-stu-id="afcbf-115">The same occurs with Windows Presentation Foundation:</span></span>

[!code-csharp[DLinqDataBinding#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqDataBinding/cs/Program.cs#2)]
[!code-vb[DLinqDataBinding#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqDataBinding/vb/Module1.vb#2)]

<span data-ttu-id="afcbf-116">Generacji kolekcji są implementowane przez <xref:System.Data.Linq.Table%601> ogólne i `DataQuery` ogólne <xref:System.ComponentModel.IListSource.GetList%2A>w.</span><span class="sxs-lookup"><span data-stu-id="afcbf-116">Collection generations are implemented by generic <xref:System.Data.Linq.Table%601> and generic `DataQuery` in <xref:System.ComponentModel.IListSource.GetList%2A>.</span></span>

## <a name="ilistsource-implementation"></a><span data-ttu-id="afcbf-117">Implementacja IListSource</span><span class="sxs-lookup"><span data-stu-id="afcbf-117">IListSource Implementation</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="afcbf-118">implementuje <xref:System.ComponentModel.IListSource> w dwóch lokalizacjach:</span><span class="sxs-lookup"><span data-stu-id="afcbf-118">implements <xref:System.ComponentModel.IListSource> in two locations:</span></span>

- <span data-ttu-id="afcbf-119">Źródło danych to <xref:System.Data.Linq.Table%601>: [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] przegląda tabelę w celu wypełnienia `DataBindingList` kolekcji, która zachowuje odwołanie do tabeli.</span><span class="sxs-lookup"><span data-stu-id="afcbf-119">The data source is a <xref:System.Data.Linq.Table%601>: [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] browses the table to fill a `DataBindingList` collection that keeps a reference on the table.</span></span>

- <span data-ttu-id="afcbf-120">Źródło danych to <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="afcbf-120">The data source is an <xref:System.Linq.IQueryable%601>.</span></span> <span data-ttu-id="afcbf-121">Istnieją dwa scenariusze:</span><span class="sxs-lookup"><span data-stu-id="afcbf-121">There are two scenarios:</span></span>

  - <span data-ttu-id="afcbf-122">Jeśli [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <xref:System.Linq.IQueryable%601>program odnajdzie <xref:System.Data.Linq.Table%601> źródłowy z, Źródło zezwala na wydanie wersji, a sytuacja jest taka sama jak w pierwszym punkcie punktora.</span><span class="sxs-lookup"><span data-stu-id="afcbf-122">If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] finds the underlying <xref:System.Data.Linq.Table%601> from the <xref:System.Linq.IQueryable%601>, the source allows for edition and the situation is the same as in the first bullet point.</span></span>

  - <span data-ttu-id="afcbf-123">Jeśli [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] nie można znaleźć bazowego <xref:System.Data.Linq.Table%601>, źródło nie zezwala na `groupby`wydanie programu (na przykład).</span><span class="sxs-lookup"><span data-stu-id="afcbf-123">If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] cannot find the underlying <xref:System.Data.Linq.Table%601>, the source does not allow for edition (for example, `groupby`).</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="afcbf-124">przegląda zapytanie w celu wypełnienia ogólnego `SortableBindingList`, który jest prosty <xref:System.ComponentModel.BindingList%601> , który implementuje funkcję sortowania dla jednostek T dla danej właściwości.</span><span class="sxs-lookup"><span data-stu-id="afcbf-124">browses the query to fill a generic `SortableBindingList`, which is a simple <xref:System.ComponentModel.BindingList%601> that implements the sorting feature for T entities for a given property.</span></span>

## <a name="specialized-collections"></a><span data-ttu-id="afcbf-125">Specjalne kolekcje</span><span class="sxs-lookup"><span data-stu-id="afcbf-125">Specialized Collections</span></span>

<span data-ttu-id="afcbf-126">W przypadku wielu funkcji opisanych wcześniej w tym dokumencie <xref:System.ComponentModel.BindingList%601> został on wyspecjalizowany dla niektórych różnych klas.</span><span class="sxs-lookup"><span data-stu-id="afcbf-126">For many features described earlier in this document, <xref:System.ComponentModel.BindingList%601> has been specialized to some different classes.</span></span> <span data-ttu-id="afcbf-127">Klasy te są ogólne `SortableBindingList` i ogólne `DataBindingList`.</span><span class="sxs-lookup"><span data-stu-id="afcbf-127">These classes are generic `SortableBindingList` and generic `DataBindingList`.</span></span> <span data-ttu-id="afcbf-128">Oba są zadeklarowane jako wewnętrzne.</span><span class="sxs-lookup"><span data-stu-id="afcbf-128">Both are declared as internal.</span></span>

### <a name="generic-sortablebindinglist"></a><span data-ttu-id="afcbf-129">SortableBindingList ogólny</span><span class="sxs-lookup"><span data-stu-id="afcbf-129">Generic SortableBindingList</span></span>

<span data-ttu-id="afcbf-130">Ta klasa dziedziczy z <xref:System.ComponentModel.BindingList%601>i jest <xref:System.ComponentModel.BindingList%601>wersją do sortowania.</span><span class="sxs-lookup"><span data-stu-id="afcbf-130">This class inherits from <xref:System.ComponentModel.BindingList%601>, and is a sortable version of <xref:System.ComponentModel.BindingList%601>.</span></span> <span data-ttu-id="afcbf-131">Sortowanie jest rozwiązaniem w pamięci i nigdy nie kontaktuje się z samą bazą danych.</span><span class="sxs-lookup"><span data-stu-id="afcbf-131">Sorting is an in-memory solution and never contacts the database itself.</span></span> <span data-ttu-id="afcbf-132"><xref:System.ComponentModel.BindingList%601>implementuje <xref:System.ComponentModel.IBindingList> , ale nie obsługuje sortowania domyślnie.</span><span class="sxs-lookup"><span data-stu-id="afcbf-132"><xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> but does not support sorting by default.</span></span> <span data-ttu-id="afcbf-133">Jest to jednak <xref:System.ComponentModel.IBindingList> implementowane przy użyciu metod wirtualnych Core <xref:System.ComponentModel.BindingList%601> .</span><span class="sxs-lookup"><span data-stu-id="afcbf-133">However, <xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> with virtual *core* methods.</span></span> <span data-ttu-id="afcbf-134">Można łatwo przesłonić te metody.</span><span class="sxs-lookup"><span data-stu-id="afcbf-134">You can easily override these methods.</span></span> <span data-ttu-id="afcbf-135">Zastąpienia `SortableBindingList` Ogólne,<xref:System.ComponentModel.BindingList%601.SortPropertyCore%2A> ,<xref:System.ComponentModel.BindingList%601.ApplySortCore%2A>i. <xref:System.ComponentModel.BindingList%601.SupportsSortingCore%2A> <xref:System.ComponentModel.BindingList%601.SortDirectionCore%2A></span><span class="sxs-lookup"><span data-stu-id="afcbf-135">Generic `SortableBindingList` overrides <xref:System.ComponentModel.BindingList%601.SupportsSortingCore%2A>, <xref:System.ComponentModel.BindingList%601.SortPropertyCore%2A>, <xref:System.ComponentModel.BindingList%601.SortDirectionCore%2A>, and <xref:System.ComponentModel.BindingList%601.ApplySortCore%2A>.</span></span> <span data-ttu-id="afcbf-136">`ApplySortCore`jest wywoływany <xref:System.ComponentModel.IBindingList.ApplySort%2A> przez i sortuje listę T elementów dla danej właściwości.</span><span class="sxs-lookup"><span data-stu-id="afcbf-136">`ApplySortCore` is called by <xref:System.ComponentModel.IBindingList.ApplySort%2A> and sorts the list of T items for a given property.</span></span>

<span data-ttu-id="afcbf-137">Wyjątek jest wywoływany, jeśli właściwość nie należy do T.</span><span class="sxs-lookup"><span data-stu-id="afcbf-137">An exception is raised if the property does not belong to T.</span></span>

<span data-ttu-id="afcbf-138">Aby uzyskać sortowanie, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] program tworzy klasę `SortableBindingList.PropertyComparer` generyczną, która dziedziczy <xref:System.Collections.Generic.Comparer%601.System%23Collections%23IComparer%23Compare%2A> z generycznej i implementuje domyślną funkcję porównującą dla danego typu `PropertyDescriptor`T, a i kierunku.</span><span class="sxs-lookup"><span data-stu-id="afcbf-138">To achieve sorting, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] creates a generic `SortableBindingList.PropertyComparer` class that inherits from generic <xref:System.Collections.Generic.Comparer%601.System%23Collections%23IComparer%23Compare%2A> and implements a default comparer for a given type T, a `PropertyDescriptor`, and a direction.</span></span> <span data-ttu-id="afcbf-139">Ta klasa tworzy `Comparer` dynamicznie t, gdzie t `PropertyType` jest `PropertyDescriptor`z.</span><span class="sxs-lookup"><span data-stu-id="afcbf-139">This class dynamically creates a `Comparer` of T where T is the `PropertyType` of the `PropertyDescriptor`.</span></span> <span data-ttu-id="afcbf-140">Następnie domyślna funkcja porównująca jest pobierana z statycznego `Comparer`ogólnego.</span><span class="sxs-lookup"><span data-stu-id="afcbf-140">Then, the default comparer is retrieved from the static generic `Comparer`.</span></span> <span data-ttu-id="afcbf-141">Wystąpienie domyślne jest uzyskiwane przy użyciu odbicia.</span><span class="sxs-lookup"><span data-stu-id="afcbf-141">A default instance is obtained by using reflection.</span></span>

<span data-ttu-id="afcbf-142">Rodzajowy `SortableBindingList` jest również klasą bazową dla `DataBindingList`.</span><span class="sxs-lookup"><span data-stu-id="afcbf-142">Generic `SortableBindingList` is also the base class for `DataBindingList`.</span></span> <span data-ttu-id="afcbf-143">Ogólne `SortableBindingList` oferuje dwie metody wirtualne do zawieszania lub wznawiania elementów Dodaj/Usuń śledzenie.</span><span class="sxs-lookup"><span data-stu-id="afcbf-143">Generic `SortableBindingList` offers two virtual methods for suspending or resuming items add/remove tracking.</span></span> <span data-ttu-id="afcbf-144">Te dwie metody mogą być używane na potrzeby funkcji podstawowych, takich jak sortowanie, ale w rzeczywistości są implementowane przez wyższe `DataBindingList`klasy, takie jak generyczne.</span><span class="sxs-lookup"><span data-stu-id="afcbf-144">Those two methods can be used for base features such as sorting, but will really be implemented by upper classes like generic `DataBindingList`.</span></span>

### <a name="generic-databindinglist"></a><span data-ttu-id="afcbf-145">DataBindingList ogólny</span><span class="sxs-lookup"><span data-stu-id="afcbf-145">Generic DataBindingList</span></span>

<span data-ttu-id="afcbf-146">Ta klasa dziedziczy z generycznego `SortableBindingLIst`.</span><span class="sxs-lookup"><span data-stu-id="afcbf-146">This class inherits from generic `SortableBindingLIst`.</span></span> <span data-ttu-id="afcbf-147">Ogólne `DataBindingList` zachowuje odwołanie do podstawowego ogólnego `Table` elementu ogólnego `IQueryable` używane podczas wstępnego wypełniania kolekcji.</span><span class="sxs-lookup"><span data-stu-id="afcbf-147">Generic `DataBindingList` keeps a reference on the underlying generic `Table` of the generic `IQueryable` used for the initial filling of the collection.</span></span> <span data-ttu-id="afcbf-148">Ogólne `DatabindingList` dodaje śledzenie dla elementu Dodaj/Usuń do kolekcji, zastępując `InsertItem`() i `RemoveItem`().</span><span class="sxs-lookup"><span data-stu-id="afcbf-148">Generic `DatabindingList` adds tracking for item add/remove to the collection by overriding `InsertItem`() and `RemoveItem`().</span></span> <span data-ttu-id="afcbf-149">Implementuje także abstrakcyjną funkcję śledzenia wstrzymywania/wznawiania, aby umożliwić śledzenie warunkowe.</span><span class="sxs-lookup"><span data-stu-id="afcbf-149">It also implements the abstract suspend/resume tracking feature to make tracking conditional.</span></span> <span data-ttu-id="afcbf-150">Ta funkcja sprawia, `DataBindingList` że ogólną zaletą jest użycie polimorficznej funkcji śledzenia klas nadrzędnych.</span><span class="sxs-lookup"><span data-stu-id="afcbf-150">This feature makes generic `DataBindingList` take advantage of all the polymorphic usage of the tracking feature of the parent classes.</span></span>

## <a name="binding-to-entitysets"></a><span data-ttu-id="afcbf-151">Powiązanie z EntitySets</span><span class="sxs-lookup"><span data-stu-id="afcbf-151">Binding to EntitySets</span></span>

<span data-ttu-id="afcbf-152">Powiązanie z `EntitySet` jest przypadkiem specjalnym `EntitySet` , ponieważ jest już kolekcją <xref:System.ComponentModel.IBindingList>implementującą.</span><span class="sxs-lookup"><span data-stu-id="afcbf-152">Binding to `EntitySet` is a special case because `EntitySet` is already a collection that implements <xref:System.ComponentModel.IBindingList>.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="afcbf-153">dodaje obsługę sortowania i anulowania (<xref:System.ComponentModel.ICancelAddNew>).</span><span class="sxs-lookup"><span data-stu-id="afcbf-153">adds sorting and canceling (<xref:System.ComponentModel.ICancelAddNew>) support.</span></span> <span data-ttu-id="afcbf-154">`EntitySet` Klasa używa wewnętrznej listy do przechowywania jednostek.</span><span class="sxs-lookup"><span data-stu-id="afcbf-154">An `EntitySet` class uses an internal list to store entities.</span></span> <span data-ttu-id="afcbf-155">Ta lista jest kolekcją niskiego poziomu opartą na tablicy ogólnej, klasie generycznej `ItemList` .</span><span class="sxs-lookup"><span data-stu-id="afcbf-155">This list is a low-level collection based on a generic array, the generic `ItemList` class.</span></span>

### <a name="adding-a-sorting-feature"></a><span data-ttu-id="afcbf-156">Dodawanie funkcji sortowania</span><span class="sxs-lookup"><span data-stu-id="afcbf-156">Adding a Sorting Feature</span></span>

<span data-ttu-id="afcbf-157">Tablice oferują metodę`Array.Sort()`Sort (), która może być używana `Comparer` z T. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] używa klasy generycznej `SortableBindingList.PropertyComparer` opisanej wcześniej w tym temacie, aby uzyskać tę `Comparer` Właściwość oraz kierunek sortowania.</span><span class="sxs-lookup"><span data-stu-id="afcbf-157">Arrays offer a sort method (`Array.Sort()`) that you can be used with a `Comparer` of T. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] uses the generic `SortableBindingList.PropertyComparer` class described earlier in this topic to obtain this `Comparer` for the property and the direction to be sorted on.</span></span> <span data-ttu-id="afcbf-158">Metoda jest dodawana do elementu `ItemList` ogólnego w celu wywołania tej funkcji. `ApplySort`</span><span class="sxs-lookup"><span data-stu-id="afcbf-158">An `ApplySort` method is added to generic `ItemList` to call this feature.</span></span>

<span data-ttu-id="afcbf-159">`EntitySet` Po stronie należy teraz zadeklarować obsługę sortowania:</span><span class="sxs-lookup"><span data-stu-id="afcbf-159">On the `EntitySet` side, you now have to declare sorting support:</span></span>

- <span data-ttu-id="afcbf-160"><xref:System.ComponentModel.IBindingList.SupportsSorting%2A>zwraca `true`wartość.</span><span class="sxs-lookup"><span data-stu-id="afcbf-160"><xref:System.ComponentModel.IBindingList.SupportsSorting%2A> returns `true`.</span></span>

- <span data-ttu-id="afcbf-161"><xref:System.ComponentModel.IBindingList.ApplySort%2A>wywołania `entities.ApplySort()` , a `OnListChanged()`następnie.</span><span class="sxs-lookup"><span data-stu-id="afcbf-161"><xref:System.ComponentModel.IBindingList.ApplySort%2A> calls `entities.ApplySort()` and then `OnListChanged()`.</span></span>

- <span data-ttu-id="afcbf-162"><xref:System.ComponentModel.IBindingList.SortDirection%2A>i <xref:System.ComponentModel.IBindingList.SortProperty%2A> właściwości uwidaczniają bieżącą definicję sortowania, która jest przechowywana w lokalnych elementach członkowskich.</span><span class="sxs-lookup"><span data-stu-id="afcbf-162"><xref:System.ComponentModel.IBindingList.SortDirection%2A> and <xref:System.ComponentModel.IBindingList.SortProperty%2A> properties expose the current sorting definition, which is stored in local members.</span></span>

<span data-ttu-id="afcbf-163">W przypadku używania elementu System. Windows. Forms. BindingSource i powiązania > zamiaru obiektu EntitySet\<z obiektem system. Windows. Forms. BindingSource. DataSource, należy wywołać zamiar obiektu EntitySet\<>. GetNewBindingList się z aktualizacją BindingSource. list.</span><span class="sxs-lookup"><span data-stu-id="afcbf-163">When you use a System.Windows.Forms.BindingSource and bind an EntitySet\<TEntity> to the System.Windows.Forms.BindingSource.DataSource, you must call EntitySet\<TEntity>.GetNewBindingList to update BindingSource.List.</span></span>

<span data-ttu-id="afcbf-164">Jeśli używasz elementu System. Windows. Forms. BindingSource i ustawimy właściwość BindingSource. DataMember i ustawimy wartość BindingSource. DataSource dla klasy, która ma właściwość o nazwie w elemencie BindingSource. DataMember, która uwidacznia\<> zamiaru obiektu EntitySet, należy nie trzeba wywoływać >\<zamiaru obiektu EntitySet. GetNewBindingList zaktualizować element BindingSource. list, ale utracisz możliwość sortowania.</span><span class="sxs-lookup"><span data-stu-id="afcbf-164">If you use a System.Windows.Forms.BindingSource and set the BindingSource.DataMember property and set BindingSource.DataSource to a class that has a property named in the BindingSource.DataMember that exposes the EntitySet\<TEntity>, you don’t have to call EntitySet\<TEntity>.GetNewBindingList to update the BindingSource.List but you lose Sorting capability.</span></span>

## <a name="caching"></a><span data-ttu-id="afcbf-165">Buforowanie</span><span class="sxs-lookup"><span data-stu-id="afcbf-165">Caching</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="afcbf-166">zapytania implementują <xref:System.ComponentModel.IListSource.GetList%2A>.</span><span class="sxs-lookup"><span data-stu-id="afcbf-166">queries implement <xref:System.ComponentModel.IListSource.GetList%2A>.</span></span> <span data-ttu-id="afcbf-167">Gdy Klasa BindingSource Windows Forms jest zgodna z tym interfejsem, wywołuje metodę GetList () trzy czasu dla jednego połączenia.</span><span class="sxs-lookup"><span data-stu-id="afcbf-167">When the Windows Forms BindingSource class meets this interface, it calls GetList() threes time for a single connection.</span></span> <span data-ttu-id="afcbf-168">Aby obejść tę sytuację, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implementuje pamięć podręczną na wystąpienie do przechowywania i zawsze zwraca tę samą wygenerowaną kolekcję.</span><span class="sxs-lookup"><span data-stu-id="afcbf-168">To work around this situation, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implements a cache per instance to store and always return the same generated collection.</span></span>

## <a name="cancellation"></a><span data-ttu-id="afcbf-169">Anulowanie</span><span class="sxs-lookup"><span data-stu-id="afcbf-169">Cancellation</span></span>

<span data-ttu-id="afcbf-170"><xref:System.ComponentModel.IBindingList><xref:System.ComponentModel.IBindingList.AddNew%2A> definiuje metodę, która jest używana przez kontrolki do tworzenia nowego elementu z kolekcji powiązanej.</span><span class="sxs-lookup"><span data-stu-id="afcbf-170"><xref:System.ComponentModel.IBindingList> defines an <xref:System.ComponentModel.IBindingList.AddNew%2A> method that is used by controls to create a new item from a bound collection.</span></span> <span data-ttu-id="afcbf-171">`DataGridView` Kontrolka pokazuje tę funkcję bardzo dobrze, gdy ostatni widoczny wiersz zawiera gwiazdkę w nagłówku.</span><span class="sxs-lookup"><span data-stu-id="afcbf-171">The `DataGridView` control shows this feature very well when the last visible row contains a star in its header.</span></span> <span data-ttu-id="afcbf-172">Gwiazdka pokazuje, że można dodać nowy element.</span><span class="sxs-lookup"><span data-stu-id="afcbf-172">The star shows you that you can add a new item.</span></span>

<span data-ttu-id="afcbf-173">Oprócz tej funkcji kolekcja może również implementować <xref:System.ComponentModel.ICancelAddNew>.</span><span class="sxs-lookup"><span data-stu-id="afcbf-173">In addition to this feature, a collection can also implement <xref:System.ComponentModel.ICancelAddNew>.</span></span> <span data-ttu-id="afcbf-174">Ta funkcja umożliwia anulowanie przez kontrolki lub zweryfikowanie, czy nowy edytowany element został sprawdzony.</span><span class="sxs-lookup"><span data-stu-id="afcbf-174">This feature allows for the controls to cancel or validate that the new edited item has been validated or not.</span></span>

<span data-ttu-id="afcbf-175"><xref:System.ComponentModel.ICancelAddNew>jest zaimplementowany we wszystkich [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] kolekcjach DataBound ( `SortableBindingList` rodzajowe `EntitySet`i ogólne).</span><span class="sxs-lookup"><span data-stu-id="afcbf-175"><xref:System.ComponentModel.ICancelAddNew> is implemented in all [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] databound collections (generic `SortableBindingList` and generic `EntitySet`).</span></span> <span data-ttu-id="afcbf-176">W obu implementacjach kod wykonuje następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="afcbf-176">In both implementations the code performs as follows:</span></span>

- <span data-ttu-id="afcbf-177">Umożliwia wstawianie i usuwanie elementów z kolekcji.</span><span class="sxs-lookup"><span data-stu-id="afcbf-177">Lets items be inserted and then removed from the collection.</span></span>

- <span data-ttu-id="afcbf-178">Nie śledzi zmian, o ile nie zostanie zatwierdzona przez interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="afcbf-178">Does not track changes as long as the UI does not commit the edition.</span></span>

- <span data-ttu-id="afcbf-179">Nie śledzi zmian, o ile wersja została anulowana (<xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>).</span><span class="sxs-lookup"><span data-stu-id="afcbf-179">Does not track changes as long as the edition is canceled (<xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>).</span></span>

- <span data-ttu-id="afcbf-180">Umożliwia śledzenie podczas zatwierdzania wersji (<xref:System.ComponentModel.ICancelAddNew.EndNew%2A>).</span><span class="sxs-lookup"><span data-stu-id="afcbf-180">Allows tracking when the edition is committed (<xref:System.ComponentModel.ICancelAddNew.EndNew%2A>).</span></span>

- <span data-ttu-id="afcbf-181">Pozwala na normalne zachowanie kolekcji, jeśli nie pochodzi <xref:System.ComponentModel.IBindingList.AddNew%2A>nowy element.</span><span class="sxs-lookup"><span data-stu-id="afcbf-181">Lets the collection behave normally if the new item does not come from <xref:System.ComponentModel.IBindingList.AddNew%2A>.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="afcbf-182">Rozwiązywanie problemów</span><span class="sxs-lookup"><span data-stu-id="afcbf-182">Troubleshooting</span></span>

<span data-ttu-id="afcbf-183">Ta sekcja wywołuje kilka elementów, które mogą pomóc w rozwiązywaniu problemów z aplikacjami do [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] tworzenia powiązań danych.</span><span class="sxs-lookup"><span data-stu-id="afcbf-183">This section calls out several items that might help troubleshoot your [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] data binding applications.</span></span>

- <span data-ttu-id="afcbf-184">Musisz użyć właściwości; Używanie tylko pól jest niewystarczające.</span><span class="sxs-lookup"><span data-stu-id="afcbf-184">You must use properties; using only fields is not sufficient.</span></span> <span data-ttu-id="afcbf-185">Windows Forms wymaga tego użycia.</span><span class="sxs-lookup"><span data-stu-id="afcbf-185">Windows Forms require this usage.</span></span>

- <span data-ttu-id="afcbf-186">Domyślnie `image` `timestamp` ,, i typy baz danych są mapowane na tablicę bajtową. `varbinary`</span><span class="sxs-lookup"><span data-stu-id="afcbf-186">By default, `image`, `varbinary`, and `timestamp` database types map to byte array.</span></span> <span data-ttu-id="afcbf-187">Ponieważ `ToString()` nie jest to obsługiwane w tym scenariuszu, nie można wyświetlić tych obiektów.</span><span class="sxs-lookup"><span data-stu-id="afcbf-187">Because `ToString()` is not supported in this scenario, these objects cannot be displayed.</span></span>

- <span data-ttu-id="afcbf-188">Składowa klasy zamapowana na klucz podstawowy ma metodę ustawiającą, ale [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] nie obsługuje zmiany tożsamości obiektu.</span><span class="sxs-lookup"><span data-stu-id="afcbf-188">A class member mapped to a primary key has a setter, but [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] does not support object identity change.</span></span> <span data-ttu-id="afcbf-189">W związku z tym nie można zaktualizować klucza podstawowego/unikatowego używanego w mapowaniu w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="afcbf-189">Therefore, the primary/unique key that is used in mapping cannot be updated in the database.</span></span> <span data-ttu-id="afcbf-190">Zmiana w siatce powoduje wyjątek podczas wywoływania <xref:System.Data.Linq.DataContext.SubmitChanges%2A>.</span><span class="sxs-lookup"><span data-stu-id="afcbf-190">A change in the grid causes an exception when you call <xref:System.Data.Linq.DataContext.SubmitChanges%2A>.</span></span>

- <span data-ttu-id="afcbf-191">Jeśli jednostka jest powiązana w dwóch oddzielnych siatkach (na przykład jeden wzorzec i inne szczegóły), a `Delete` w siatce głównej nie jest propagowany do siatki szczegółów.</span><span class="sxs-lookup"><span data-stu-id="afcbf-191">If an entity is bound in two separate grids (for example, one master and another detail), a `Delete` in the master grid is not propagated to the detail grid.</span></span>

## <a name="see-also"></a><span data-ttu-id="afcbf-192">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="afcbf-192">See also</span></span>

- [<span data-ttu-id="afcbf-193">Informacje uzupełniające</span><span class="sxs-lookup"><span data-stu-id="afcbf-193">Background Information</span></span>](background-information.md)
