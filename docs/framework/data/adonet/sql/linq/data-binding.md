---
title: Powiązanie danych
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: cbec8b02-a1e8-4ae8-a83b-bb5190413ac5
ms.openlocfilehash: c7048d292bdf5c1372d5f8f174f7f0e84efa7593
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/03/2020
ms.locfileid: "75634719"
---
# <a name="data-binding"></a><span data-ttu-id="2dbb1-102">Powiązanie danych</span><span class="sxs-lookup"><span data-stu-id="2dbb1-102">Data Binding</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="2dbb1-103">obsługuje powiązania ze wspólnymi kontrolkami, takimi jak kontrolki siatki.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-103">supports binding to common controls, such as grid controls.</span></span> <span data-ttu-id="2dbb1-104">W szczególności [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] definiuje podstawowe wzorce do tworzenia powiązań z siatką danych i obsługi powiązań wzorzec-szczegóły, w odniesieniu do wyświetlania i aktualizowania.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-104">Specifically, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] defines the basic patterns for binding to a data grid and handling master-detail binding, both with regard to display and updating.</span></span>

## <a name="underlying-principle"></a><span data-ttu-id="2dbb1-105">Podstawowa zasada</span><span class="sxs-lookup"><span data-stu-id="2dbb1-105">Underlying Principle</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="2dbb1-106">tłumaczy zapytania LINQ na SQL w celu wykonania w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-106">translates LINQ queries to SQL for execution on a database.</span></span> <span data-ttu-id="2dbb1-107">Wyniki mają silnie wpisane `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-107">The results are strongly typed `IEnumerable`.</span></span> <span data-ttu-id="2dbb1-108">Ponieważ te obiekty są zwykłymi obiektami środowiska uruchomieniowego języka wspólnego (CLR), zwykłe powiązanie danych obiektów może służyć do wyświetlania wyników.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-108">Because these objects are ordinary common language runtime (CLR) objects, ordinary object data binding can be used to display the results.</span></span> <span data-ttu-id="2dbb1-109">Z drugiej strony operacje zmiany (INSERT, Updates i usunięć) wymagają wykonania dodatkowych czynności.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-109">On the other hand, change operations (inserts, updates, and deletes) require additional steps.</span></span>

## <a name="operation"></a><span data-ttu-id="2dbb1-110">Operacja</span><span class="sxs-lookup"><span data-stu-id="2dbb1-110">Operation</span></span>

<span data-ttu-id="2dbb1-111">Niejawnie wiązanie z kontrolkami Windows Forms jest realizowane przez implementację <xref:System.ComponentModel.IListSource>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-111">Implicitly binding to Windows Forms controls is accomplished by implementing <xref:System.ComponentModel.IListSource>.</span></span> <span data-ttu-id="2dbb1-112">Źródła danych: ogólne <xref:System.Data.Linq.Table%601> (`Table<T>` C# `Table(Of T)` w Visual Basic) i ogólne `DataQuery` zostały zaktualizowane w celu zaimplementowania <xref:System.ComponentModel.IListSource>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-112">Data sources generic <xref:System.Data.Linq.Table%601> (`Table<T>` in C# or `Table(Of T)` in Visual Basic) and generic `DataQuery` have been updated to implement <xref:System.ComponentModel.IListSource>.</span></span> <span data-ttu-id="2dbb1-113">Aparaty powiązań danych (UI) dla interfejsu użytkownika (Windows Forms i Windows Presentation Foundation) sprawdzają, czy ich źródło danych implementuje <xref:System.ComponentModel.IListSource>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-113">User interface (UI) data-binding engines (Windows Forms and Windows Presentation Foundation) both test whether their data source implements <xref:System.ComponentModel.IListSource>.</span></span> <span data-ttu-id="2dbb1-114">W związku z tym zapisywanie bezpośredniego wpływu zapytania do źródła danych kontrolki niejawnie wywołuje [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] generacja kolekcji, jak w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="2dbb1-114">Therefore, writing a direct affectation of a query to a data source of a control implicitly calls [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] collection generation, as in the following example:</span></span>

[!code-csharp[DLinqDataBinding#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqDataBinding/cs/Program.cs#1)]
[!code-vb[DLinqDataBinding#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqDataBinding/vb/Module1.vb#1)]

<span data-ttu-id="2dbb1-115">Ten sam problem występuje w przypadku Windows Presentation Foundation:</span><span class="sxs-lookup"><span data-stu-id="2dbb1-115">The same occurs with Windows Presentation Foundation:</span></span>

[!code-csharp[DLinqDataBinding#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqDataBinding/cs/Program.cs#2)]
[!code-vb[DLinqDataBinding#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqDataBinding/vb/Module1.vb#2)]

<span data-ttu-id="2dbb1-116">Generacji kolekcji są implementowane przez ogólne <xref:System.Data.Linq.Table%601> i ogólne `DataQuery` w <xref:System.ComponentModel.IListSource.GetList%2A>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-116">Collection generations are implemented by generic <xref:System.Data.Linq.Table%601> and generic `DataQuery` in <xref:System.ComponentModel.IListSource.GetList%2A>.</span></span>

## <a name="ilistsource-implementation"></a><span data-ttu-id="2dbb1-117">Implementacja IListSource</span><span class="sxs-lookup"><span data-stu-id="2dbb1-117">IListSource Implementation</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="2dbb1-118">implementuje <xref:System.ComponentModel.IListSource> w dwóch lokalizacjach:</span><span class="sxs-lookup"><span data-stu-id="2dbb1-118">implements <xref:System.ComponentModel.IListSource> in two locations:</span></span>

- <span data-ttu-id="2dbb1-119">Źródło danych to <xref:System.Data.Linq.Table%601>: [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] przegląda tabelę, aby wypełnić kolekcję `DataBindingList`, która zachowuje odwołanie do tabeli.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-119">The data source is a <xref:System.Data.Linq.Table%601>: [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] browses the table to fill a `DataBindingList` collection that keeps a reference on the table.</span></span>

- <span data-ttu-id="2dbb1-120">Źródło danych jest <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-120">The data source is an <xref:System.Linq.IQueryable%601>.</span></span> <span data-ttu-id="2dbb1-121">Istnieją dwa scenariusze:</span><span class="sxs-lookup"><span data-stu-id="2dbb1-121">There are two scenarios:</span></span>

  - <span data-ttu-id="2dbb1-122">Jeśli [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] odnajdzie bazowe <xref:System.Data.Linq.Table%601> z <xref:System.Linq.IQueryable%601>, Źródło zezwala na wersję i sytuacja jest taka sama jak w pierwszym punkcie punktora.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-122">If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] finds the underlying <xref:System.Data.Linq.Table%601> from the <xref:System.Linq.IQueryable%601>, the source allows for edition and the situation is the same as in the first bullet point.</span></span>

  - <span data-ttu-id="2dbb1-123">Jeśli [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] nie może znaleźć bazowego <xref:System.Data.Linq.Table%601>, źródło nie zezwala na wydanie programu (na przykład `groupby`).</span><span class="sxs-lookup"><span data-stu-id="2dbb1-123">If [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] cannot find the underlying <xref:System.Data.Linq.Table%601>, the source does not allow for edition (for example, `groupby`).</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="2dbb1-124">przegląda zapytanie w celu wypełnienia ogólnego `SortableBindingList`, który jest prostym <xref:System.ComponentModel.BindingList%601>em, który implementuje funkcję sortowania dla jednostek T dla danej właściwości.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-124">browses the query to fill a generic `SortableBindingList`, which is a simple <xref:System.ComponentModel.BindingList%601> that implements the sorting feature for T entities for a given property.</span></span>

## <a name="specialized-collections"></a><span data-ttu-id="2dbb1-125">Specjalne kolekcje</span><span class="sxs-lookup"><span data-stu-id="2dbb1-125">Specialized Collections</span></span>

<span data-ttu-id="2dbb1-126">W przypadku wielu funkcji opisanych wcześniej w tym dokumencie <xref:System.ComponentModel.BindingList%601> była wyspecjalizowana dla niektórych różnych klas.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-126">For many features described earlier in this document, <xref:System.ComponentModel.BindingList%601> has been specialized to some different classes.</span></span> <span data-ttu-id="2dbb1-127">Te klasy są ogólnymi `SortableBindingList`ami i ogólnymi `DataBindingList`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-127">These classes are generic `SortableBindingList` and generic `DataBindingList`.</span></span> <span data-ttu-id="2dbb1-128">Oba są zadeklarowane jako wewnętrzne.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-128">Both are declared as internal.</span></span>

### <a name="generic-sortablebindinglist"></a><span data-ttu-id="2dbb1-129">SortableBindingList ogólny</span><span class="sxs-lookup"><span data-stu-id="2dbb1-129">Generic SortableBindingList</span></span>

<span data-ttu-id="2dbb1-130">Ta klasa dziedziczy z <xref:System.ComponentModel.BindingList%601>i jest wersją <xref:System.ComponentModel.BindingList%601>do sortowania.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-130">This class inherits from <xref:System.ComponentModel.BindingList%601>, and is a sortable version of <xref:System.ComponentModel.BindingList%601>.</span></span> <span data-ttu-id="2dbb1-131">Sortowanie jest rozwiązaniem w pamięci i nigdy nie kontaktuje się z samą bazą danych.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-131">Sorting is an in-memory solution and never contacts the database itself.</span></span> <span data-ttu-id="2dbb1-132"><xref:System.ComponentModel.BindingList%601> implementuje <xref:System.ComponentModel.IBindingList>, ale nie obsługuje sortowania domyślnie.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-132"><xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> but does not support sorting by default.</span></span> <span data-ttu-id="2dbb1-133"><xref:System.ComponentModel.BindingList%601> implementuje jednak <xref:System.ComponentModel.IBindingList> przy użyciu metod wirtualnych *Core* .</span><span class="sxs-lookup"><span data-stu-id="2dbb1-133">However, <xref:System.ComponentModel.BindingList%601> implements <xref:System.ComponentModel.IBindingList> with virtual *core* methods.</span></span> <span data-ttu-id="2dbb1-134">Można łatwo przesłonić te metody.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-134">You can easily override these methods.</span></span> <span data-ttu-id="2dbb1-135">Ogólne `SortableBindingList` przesłania <xref:System.ComponentModel.BindingList%601.SupportsSortingCore%2A>, <xref:System.ComponentModel.BindingList%601.SortPropertyCore%2A>, <xref:System.ComponentModel.BindingList%601.SortDirectionCore%2A>i <xref:System.ComponentModel.BindingList%601.ApplySortCore%2A>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-135">Generic `SortableBindingList` overrides <xref:System.ComponentModel.BindingList%601.SupportsSortingCore%2A>, <xref:System.ComponentModel.BindingList%601.SortPropertyCore%2A>, <xref:System.ComponentModel.BindingList%601.SortDirectionCore%2A>, and <xref:System.ComponentModel.BindingList%601.ApplySortCore%2A>.</span></span> <span data-ttu-id="2dbb1-136">`ApplySortCore` jest wywoływana przez <xref:System.ComponentModel.IBindingList.ApplySort%2A> i sortuje listę elementów T dla danej właściwości.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-136">`ApplySortCore` is called by <xref:System.ComponentModel.IBindingList.ApplySort%2A> and sorts the list of T items for a given property.</span></span>

<span data-ttu-id="2dbb1-137">Wyjątek jest wywoływany, jeśli właściwość nie należy do T.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-137">An exception is raised if the property does not belong to T.</span></span>

<span data-ttu-id="2dbb1-138">Aby uzyskać sortowanie, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] tworzy klasę generyczną `SortableBindingList.PropertyComparer`, która dziedziczy z generycznego <xref:System.Collections.Generic.Comparer%601.System%23Collections%23IComparer%23Compare%2A> i implementuje domyślną funkcję porównującą dla danego typu T, `PropertyDescriptor`i kierunku.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-138">To achieve sorting, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] creates a generic `SortableBindingList.PropertyComparer` class that inherits from generic <xref:System.Collections.Generic.Comparer%601.System%23Collections%23IComparer%23Compare%2A> and implements a default comparer for a given type T, a `PropertyDescriptor`, and a direction.</span></span> <span data-ttu-id="2dbb1-139">Ta klasa dynamicznie tworzy `Comparer` T, gdzie T jest `PropertyType` `PropertyDescriptor`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-139">This class dynamically creates a `Comparer` of T where T is the `PropertyType` of the `PropertyDescriptor`.</span></span> <span data-ttu-id="2dbb1-140">Następnie domyślna funkcja porównująca jest pobierana z statycznej `Comparer`ogólnej.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-140">Then, the default comparer is retrieved from the static generic `Comparer`.</span></span> <span data-ttu-id="2dbb1-141">Wystąpienie domyślne jest uzyskiwane przy użyciu odbicia.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-141">A default instance is obtained by using reflection.</span></span>

<span data-ttu-id="2dbb1-142">`SortableBindingList` generyczna jest również klasą bazową dla `DataBindingList`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-142">Generic `SortableBindingList` is also the base class for `DataBindingList`.</span></span> <span data-ttu-id="2dbb1-143">`SortableBindingList` generyczne oferuje dwie metody wirtualne do zawieszania lub wznawiania elementów Dodaj/Usuń śledzenie.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-143">Generic `SortableBindingList` offers two virtual methods for suspending or resuming items add/remove tracking.</span></span> <span data-ttu-id="2dbb1-144">Te dwie metody mogą być używane na potrzeby funkcji podstawowych, takich jak sortowanie, ale w rzeczywistości są implementowane przez wyższe klasy, takie jak ogólne `DataBindingList`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-144">Those two methods can be used for base features such as sorting, but will really be implemented by upper classes like generic `DataBindingList`.</span></span>

### <a name="generic-databindinglist"></a><span data-ttu-id="2dbb1-145">DataBindingList ogólny</span><span class="sxs-lookup"><span data-stu-id="2dbb1-145">Generic DataBindingList</span></span>

<span data-ttu-id="2dbb1-146">Ta klasa dziedziczy z ogólnej `SortableBindingLIst`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-146">This class inherits from generic `SortableBindingLIst`.</span></span> <span data-ttu-id="2dbb1-147">Ogólne `DataBindingList` zachowuje odwołanie do podstawowej `Table` ogólnej `IQueryable` używane podczas wstępnego wypełniania kolekcji.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-147">Generic `DataBindingList` keeps a reference on the underlying generic `Table` of the generic `IQueryable` used for the initial filling of the collection.</span></span> <span data-ttu-id="2dbb1-148">Ogólne `DatabindingList` dodaje śledzenie dla elementu Dodaj/Usuń do kolekcji, zastępując `InsertItem`() i `RemoveItem`().</span><span class="sxs-lookup"><span data-stu-id="2dbb1-148">Generic `DatabindingList` adds tracking for item add/remove to the collection by overriding `InsertItem`() and `RemoveItem`().</span></span> <span data-ttu-id="2dbb1-149">Implementuje także abstrakcyjną funkcję śledzenia wstrzymywania/wznawiania, aby umożliwić śledzenie warunkowe.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-149">It also implements the abstract suspend/resume tracking feature to make tracking conditional.</span></span> <span data-ttu-id="2dbb1-150">Ta funkcja sprawia, że ogólne `DataBindingList` korzystać ze wszystkich polimorficznych zastosowań funkcji śledzenia klas nadrzędnych.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-150">This feature makes generic `DataBindingList` take advantage of all the polymorphic usage of the tracking feature of the parent classes.</span></span>

## <a name="binding-to-entitysets"></a><span data-ttu-id="2dbb1-151">Powiązanie z EntitySets</span><span class="sxs-lookup"><span data-stu-id="2dbb1-151">Binding to EntitySets</span></span>

<span data-ttu-id="2dbb1-152">Powiązanie do `EntitySet` jest szczególnym przypadkiem, ponieważ `EntitySet` jest już kolekcją implementującą <xref:System.ComponentModel.IBindingList>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-152">Binding to `EntitySet` is a special case because `EntitySet` is already a collection that implements <xref:System.ComponentModel.IBindingList>.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="2dbb1-153">dodaje obsługę sortowania i anulowania (<xref:System.ComponentModel.ICancelAddNew>).</span><span class="sxs-lookup"><span data-stu-id="2dbb1-153">adds sorting and canceling (<xref:System.ComponentModel.ICancelAddNew>) support.</span></span> <span data-ttu-id="2dbb1-154">Klasa `EntitySet` używa wewnętrznej listy do przechowywania jednostek.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-154">An `EntitySet` class uses an internal list to store entities.</span></span> <span data-ttu-id="2dbb1-155">Ta lista jest kolekcją niskiego poziomu opartą na tablicy ogólnej, ogólnej klasie `ItemList`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-155">This list is a low-level collection based on a generic array, the generic `ItemList` class.</span></span>

### <a name="adding-a-sorting-feature"></a><span data-ttu-id="2dbb1-156">Dodawanie funkcji sortowania</span><span class="sxs-lookup"><span data-stu-id="2dbb1-156">Adding a Sorting Feature</span></span>

<span data-ttu-id="2dbb1-157">Tablice oferują metodę sortowania (`Array.Sort()`), która może być używana z `Comparer` T. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] używa klasy generycznej `SortableBindingList.PropertyComparer` opisanej wcześniej w tym temacie, aby uzyskać ten `Comparer` właściwości i kierunek sortowania.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-157">Arrays offer a sort method (`Array.Sort()`) that you can be used with a `Comparer` of T. [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] uses the generic `SortableBindingList.PropertyComparer` class described earlier in this topic to obtain this `Comparer` for the property and the direction to be sorted on.</span></span> <span data-ttu-id="2dbb1-158">Metoda `ApplySort` zostanie dodana do generycznego `ItemList` w celu wywołania tej funkcji.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-158">An `ApplySort` method is added to generic `ItemList` to call this feature.</span></span>

<span data-ttu-id="2dbb1-159">Po stronie `EntitySet` musisz teraz zadeklarować obsługę sortowania:</span><span class="sxs-lookup"><span data-stu-id="2dbb1-159">On the `EntitySet` side, you now have to declare sorting support:</span></span>

- <span data-ttu-id="2dbb1-160"><xref:System.ComponentModel.IBindingList.SupportsSorting%2A> zwraca `true`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-160"><xref:System.ComponentModel.IBindingList.SupportsSorting%2A> returns `true`.</span></span>

- <span data-ttu-id="2dbb1-161"><xref:System.ComponentModel.IBindingList.ApplySort%2A> wywołań `entities.ApplySort()` a następnie `OnListChanged()`.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-161"><xref:System.ComponentModel.IBindingList.ApplySort%2A> calls `entities.ApplySort()` and then `OnListChanged()`.</span></span>

- <span data-ttu-id="2dbb1-162">Właściwości <xref:System.ComponentModel.IBindingList.SortDirection%2A> i <xref:System.ComponentModel.IBindingList.SortProperty%2A> uwidaczniają bieżącą definicję sortowania, która jest przechowywana w lokalnych elementach członkowskich.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-162"><xref:System.ComponentModel.IBindingList.SortDirection%2A> and <xref:System.ComponentModel.IBindingList.SortProperty%2A> properties expose the current sorting definition, which is stored in local members.</span></span>

<span data-ttu-id="2dbb1-163">W przypadku używania elementu System. Windows. Forms. BindingSource i powiązania >\<obiektu EntitySet z obiektem system. Windows. Forms. BindingSource. DataSource, należy wywołać > zamiaru obiektu EntitySet\<. GetNewBindingList się z aktualizacją BindingSource. list.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-163">When you use a System.Windows.Forms.BindingSource and bind an EntitySet\<TEntity> to the System.Windows.Forms.BindingSource.DataSource, you must call EntitySet\<TEntity>.GetNewBindingList to update BindingSource.List.</span></span>

<span data-ttu-id="2dbb1-164">Jeśli używasz elementu System. Windows. Forms. BindingSource i ustawimy właściwość BindingSource. DataMember i ustawimy wartość BindingSource. DataSource dla klasy, która ma właściwość o nazwie w elemencie BindingSource. DataMember, która uwidacznia > zamiaru EntitySet\<, nie musisz wywoływać > zamiaru elementu EntitySet\<. GetNewBindingList zaktualizować element BindingSource. list, ale utracisz możliwość sortowania.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-164">If you use a System.Windows.Forms.BindingSource and set the BindingSource.DataMember property and set BindingSource.DataSource to a class that has a property named in the BindingSource.DataMember that exposes the EntitySet\<TEntity>, you don’t have to call EntitySet\<TEntity>.GetNewBindingList to update the BindingSource.List but you lose Sorting capability.</span></span>

## <a name="caching"></a><span data-ttu-id="2dbb1-165">Buforowanie</span><span class="sxs-lookup"><span data-stu-id="2dbb1-165">Caching</span></span>

<span data-ttu-id="2dbb1-166">zapytania [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implementują <xref:System.ComponentModel.IListSource.GetList%2A>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-166">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] queries implement <xref:System.ComponentModel.IListSource.GetList%2A>.</span></span> <span data-ttu-id="2dbb1-167">Gdy Klasa BindingSource Windows Forms jest zgodna z tym interfejsem, wywołuje metodę GetList () trzy czasu dla jednego połączenia.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-167">When the Windows Forms BindingSource class meets this interface, it calls GetList() threes time for a single connection.</span></span> <span data-ttu-id="2dbb1-168">Aby obejść tę sytuację, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implementuje pamięć podręczną na wystąpienie do przechowywania i zawsze zwraca tę samą wygenerowaną kolekcję.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-168">To work around this situation, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] implements a cache per instance to store and always return the same generated collection.</span></span>

## <a name="cancellation"></a><span data-ttu-id="2dbb1-169">Anulowanie</span><span class="sxs-lookup"><span data-stu-id="2dbb1-169">Cancellation</span></span>

<span data-ttu-id="2dbb1-170"><xref:System.ComponentModel.IBindingList> definiuje metodę <xref:System.ComponentModel.IBindingList.AddNew%2A>, która jest używana przez kontrolki do tworzenia nowego elementu z kolekcji powiązanej.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-170"><xref:System.ComponentModel.IBindingList> defines an <xref:System.ComponentModel.IBindingList.AddNew%2A> method that is used by controls to create a new item from a bound collection.</span></span> <span data-ttu-id="2dbb1-171">Kontrolka `DataGridView` wyświetla tę funkcję bardzo dobrze, gdy ostatni widoczny wiersz zawiera gwiazdkę w nagłówku.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-171">The `DataGridView` control shows this feature very well when the last visible row contains a star in its header.</span></span> <span data-ttu-id="2dbb1-172">Gwiazdka pokazuje, że można dodać nowy element.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-172">The star shows you that you can add a new item.</span></span>

<span data-ttu-id="2dbb1-173">Oprócz tej funkcji kolekcja może również implementować <xref:System.ComponentModel.ICancelAddNew>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-173">In addition to this feature, a collection can also implement <xref:System.ComponentModel.ICancelAddNew>.</span></span> <span data-ttu-id="2dbb1-174">Ta funkcja umożliwia anulowanie przez kontrolki lub zweryfikowanie, czy nowy edytowany element został sprawdzony.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-174">This feature allows for the controls to cancel or validate that the new edited item has been validated or not.</span></span>

<span data-ttu-id="2dbb1-175"><xref:System.ComponentModel.ICancelAddNew> jest zaimplementowana we wszystkich [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] kolekcjach DataBound (ogólne `SortableBindingList` i ogólne `EntitySet`).</span><span class="sxs-lookup"><span data-stu-id="2dbb1-175"><xref:System.ComponentModel.ICancelAddNew> is implemented in all [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] databound collections (generic `SortableBindingList` and generic `EntitySet`).</span></span> <span data-ttu-id="2dbb1-176">W obu implementacjach kod wykonuje następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="2dbb1-176">In both implementations the code performs as follows:</span></span>

- <span data-ttu-id="2dbb1-177">Umożliwia wstawianie i usuwanie elementów z kolekcji.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-177">Lets items be inserted and then removed from the collection.</span></span>

- <span data-ttu-id="2dbb1-178">Nie śledzi zmian, o ile nie zostanie zatwierdzona przez interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-178">Does not track changes as long as the UI does not commit the edition.</span></span>

- <span data-ttu-id="2dbb1-179">Nie śledzi zmian, o ile ta wersja została anulowana (<xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>).</span><span class="sxs-lookup"><span data-stu-id="2dbb1-179">Does not track changes as long as the edition is canceled (<xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>).</span></span>

- <span data-ttu-id="2dbb1-180">Umożliwia śledzenie podczas zatwierdzania wersji (<xref:System.ComponentModel.ICancelAddNew.EndNew%2A>).</span><span class="sxs-lookup"><span data-stu-id="2dbb1-180">Allows tracking when the edition is committed (<xref:System.ComponentModel.ICancelAddNew.EndNew%2A>).</span></span>

- <span data-ttu-id="2dbb1-181">Pozwala na normalne zachowanie kolekcji, jeśli nowy element nie pochodzi z <xref:System.ComponentModel.IBindingList.AddNew%2A>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-181">Lets the collection behave normally if the new item does not come from <xref:System.ComponentModel.IBindingList.AddNew%2A>.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="2dbb1-182">Rozwiązywanie problemów</span><span class="sxs-lookup"><span data-stu-id="2dbb1-182">Troubleshooting</span></span>

<span data-ttu-id="2dbb1-183">Ta sekcja wywołuje kilka elementów, które mogą pomóc w rozwiązywaniu problemów z [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] aplikacji powiązań danych.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-183">This section calls out several items that might help troubleshoot your [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] data binding applications.</span></span>

- <span data-ttu-id="2dbb1-184">Musisz użyć właściwości; Używanie tylko pól jest niewystarczające.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-184">You must use properties; using only fields is not sufficient.</span></span> <span data-ttu-id="2dbb1-185">Windows Forms wymaga tego użycia.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-185">Windows Forms require this usage.</span></span>

- <span data-ttu-id="2dbb1-186">Domyślnie `image`, `varbinary`i `timestamp` typy baz danych mapują na tablicę bajtową.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-186">By default, `image`, `varbinary`, and `timestamp` database types map to byte array.</span></span> <span data-ttu-id="2dbb1-187">Ponieważ `ToString()` nie jest obsługiwana w tym scenariuszu, nie można wyświetlić tych obiektów.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-187">Because `ToString()` is not supported in this scenario, these objects cannot be displayed.</span></span>

- <span data-ttu-id="2dbb1-188">Składowa klasy zamapowana na klucz podstawowy ma metodę ustawiającą, ale [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] nie obsługuje zmiany tożsamości obiektu.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-188">A class member mapped to a primary key has a setter, but [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] does not support object identity change.</span></span> <span data-ttu-id="2dbb1-189">W związku z tym nie można zaktualizować klucza podstawowego/unikatowego używanego w mapowaniu w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-189">Therefore, the primary/unique key that is used in mapping cannot be updated in the database.</span></span> <span data-ttu-id="2dbb1-190">Zmiana w siatce powoduje wyjątek podczas wywoływania <xref:System.Data.Linq.DataContext.SubmitChanges%2A>.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-190">A change in the grid causes an exception when you call <xref:System.Data.Linq.DataContext.SubmitChanges%2A>.</span></span>

- <span data-ttu-id="2dbb1-191">Jeśli jednostka jest powiązana w dwóch oddzielnych siatkach (na przykład jeden wzorzec i inne szczegóły), `Delete` w siatce głównej nie są propagowane do siatki szczegółów.</span><span class="sxs-lookup"><span data-stu-id="2dbb1-191">If an entity is bound in two separate grids (for example, one master and another detail), a `Delete` in the master grid is not propagated to the detail grid.</span></span>

## <a name="see-also"></a><span data-ttu-id="2dbb1-192">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="2dbb1-192">See also</span></span>

- [<span data-ttu-id="2dbb1-193">Informacje uzupełniające</span><span class="sxs-lookup"><span data-stu-id="2dbb1-193">Background Information</span></span>](background-information.md)
