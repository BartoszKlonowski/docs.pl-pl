---
title: 'Optymistyczna współbieżność: Omówienie'
ms.date: 03/30/2017
ms.assetid: c2e38512-d0c8-4807-b30a-cb7e30338694
ms.openlocfilehash: a61d4c5b35f3797539fe845045b8a959b0351350
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/22/2019
ms.locfileid: "69938631"
---
# <a name="optimistic-concurrency-overview"></a><span data-ttu-id="f98e8-102">Optymistyczna współbieżność: Omówienie</span><span class="sxs-lookup"><span data-stu-id="f98e8-102">Optimistic Concurrency: Overview</span></span>
[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="f98e8-103">obsługuje optymistyczną kontrolę współbieżności.</span><span class="sxs-lookup"><span data-stu-id="f98e8-103">supports optimistic concurrency control.</span></span> <span data-ttu-id="f98e8-104">W poniższej tabeli opisano terminy, które dotyczą optymistycznej współbieżności [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] w dokumentacji:</span><span class="sxs-lookup"><span data-stu-id="f98e8-104">The following table describes terms that apply to optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation:</span></span>  
  
|<span data-ttu-id="f98e8-105">Odsetk</span><span class="sxs-lookup"><span data-stu-id="f98e8-105">Terms</span></span>|<span data-ttu-id="f98e8-106">Opis</span><span class="sxs-lookup"><span data-stu-id="f98e8-106">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="f98e8-107">współbieżność</span><span class="sxs-lookup"><span data-stu-id="f98e8-107">concurrency</span></span>|<span data-ttu-id="f98e8-108">Sytuacja, w której co najmniej dwóch użytkowników w tym samym czasie próbuje zaktualizować ten sam wiersz bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f98e8-108">The situation in which two or more users at the same time try to update the same database row.</span></span>|  
|<span data-ttu-id="f98e8-109">konflikt współbieżności</span><span class="sxs-lookup"><span data-stu-id="f98e8-109">concurrency conflict</span></span>|<span data-ttu-id="f98e8-110">Sytuacja, w której dwóch lub więcej użytkowników w tym samym czasie próbuje przesłać wartości powodujące konflikt do jednej lub kilku kolumn w wierszu.</span><span class="sxs-lookup"><span data-stu-id="f98e8-110">The situation in which two or more users at the same time try to submit conflicting values to one or more columns of a row.</span></span>|  
|<span data-ttu-id="f98e8-111">formant współbieżności</span><span class="sxs-lookup"><span data-stu-id="f98e8-111">concurrency control</span></span>|<span data-ttu-id="f98e8-112">Technika służąca do rozwiązywania konfliktów współbieżności.</span><span class="sxs-lookup"><span data-stu-id="f98e8-112">The technique used to resolve concurrency conflicts.</span></span>|  
|<span data-ttu-id="f98e8-113">Optymistyczna kontrola współbieżności</span><span class="sxs-lookup"><span data-stu-id="f98e8-113">optimistic concurrency control</span></span>|<span data-ttu-id="f98e8-114">Technika, która najpierw sprawdza, czy inne transakcje zmieniły wartości w wierszu przed umożliwieniem przesłania zmian.</span><span class="sxs-lookup"><span data-stu-id="f98e8-114">The technique that first investigates whether other transactions have changed values in a row before permitting changes to be submitted.</span></span><br /><br /> <span data-ttu-id="f98e8-115">Różni się od *pesymistycznej kontroli współbieżności*, która blokuje rekord, aby uniknąć konfliktów współbieżności.</span><span class="sxs-lookup"><span data-stu-id="f98e8-115">Contrast with *pessimistic concurrency control*, which locks the record to avoid concurrency conflicts.</span></span><br /><br /> <span data-ttu-id="f98e8-116">Kontrola optymistyczna jest w ten sposób uznawana, ponieważ uwzględnia szanse jednej transakcji zakłócające, że jest to mało prawdopodobne.</span><span class="sxs-lookup"><span data-stu-id="f98e8-116">*Optimistic* control is so termed because it considers the chances of one transaction interfering with another to be unlikely.</span></span>|  
|<span data-ttu-id="f98e8-117">Rozwiązywanie konfliktów</span><span class="sxs-lookup"><span data-stu-id="f98e8-117">conflict resolution</span></span>|<span data-ttu-id="f98e8-118">Proces odświeżania elementu powodującego konflikt przez ponowne wykonywanie zapytania względem bazy danych, a następnie Uzgadnianie różnic.</span><span class="sxs-lookup"><span data-stu-id="f98e8-118">The process of refreshing a conflicting item by querying the database again and then reconciling differences.</span></span><br /><br /> <span data-ttu-id="f98e8-119">Po odświeżeniu obiektu narzędzie do [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] śledzenia zmian zawiera następujące dane:</span><span class="sxs-lookup"><span data-stu-id="f98e8-119">When an object is refreshed, the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] change tracker holds the following data:</span></span><br /><br /> <span data-ttu-id="f98e8-120">— Wartości początkowo pobrane z bazy danych i używane do sprawdzania aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="f98e8-120">-   The values originally taken from the database and used for the update check.</span></span><br /><span data-ttu-id="f98e8-121">— Nowe wartości bazy danych z kolejnego zapytania.</span><span class="sxs-lookup"><span data-stu-id="f98e8-121">-   The new database values from the subsequent query.</span></span><br /><br /> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="f98e8-122">następnie decyduje o tym, czy obiekt jest w konflikcie (czyli czy co najmniej jedna jego wartość członkowska została zmieniona).</span><span class="sxs-lookup"><span data-stu-id="f98e8-122">then determines whether the object is in conflict (that is, whether one or more of its member values has changed).</span></span> <span data-ttu-id="f98e8-123">Jeśli obiekt jest w konflikcie, następnie [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] należy określić, który z jego elementów członkowskich jest w konflikcie.</span><span class="sxs-lookup"><span data-stu-id="f98e8-123">If the object is in conflict, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] next determines which of its members are in conflict.</span></span><br /><br /> <span data-ttu-id="f98e8-124">Wszelkie konflikty elementów [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] Członkowskich, które są odnajdywane, zostaną dodane do listy konfliktów.</span><span class="sxs-lookup"><span data-stu-id="f98e8-124">Any member conflict that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] discovers is added to a conflict list.</span></span>|  
  
 <span data-ttu-id="f98e8-125">W modelu obiektów występuje *konflikt optymistycznej współbieżności* , gdy spełniony jest oba z następujących warunków: [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]</span><span class="sxs-lookup"><span data-stu-id="f98e8-125">In the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model, an *optimistic concurrency conflict* occurs when both of the following conditions are true:</span></span>  
  
- <span data-ttu-id="f98e8-126">Klient próbuje przesłać zmiany do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f98e8-126">The client tries to submit changes to the database.</span></span>  
  
- <span data-ttu-id="f98e8-127">Co najmniej jedna wartość sprawdzania aktualizacji została zaktualizowana w bazie danych od czasu ostatniego odczytu przez klienta.</span><span class="sxs-lookup"><span data-stu-id="f98e8-127">One or more update-check values have been updated in the database since the client last read them.</span></span>  
  
 <span data-ttu-id="f98e8-128">Rozwiązanie tego konfliktu obejmuje odnajdywanie, które elementy członkowskie obiektu są w konflikcie, a następnie decydowanie o tym, co chcesz zrobić.</span><span class="sxs-lookup"><span data-stu-id="f98e8-128">Resolution of this conflict includes discovering which members of the object are in conflict, and then deciding what you want to do about it.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f98e8-129">Tylko członkowie zamapowane <xref:System.Data.Linq.Mapping.UpdateCheck.Always> jako <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> lub uczestniczą w sprawdzaniu współbieżności optymistycznej.</span><span class="sxs-lookup"><span data-stu-id="f98e8-129">Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks.</span></span> <span data-ttu-id="f98e8-130">Nie jest wykonywane żadne sprawdzenie dla elementów <xref:System.Data.Linq.Mapping.UpdateCheck.Never>członkowskich oznaczonych.</span><span class="sxs-lookup"><span data-stu-id="f98e8-130">No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>.</span></span> <span data-ttu-id="f98e8-131">Aby uzyskać więcej informacji, zobacz <xref:System.Data.Linq.Mapping.UpdateCheck>.</span><span class="sxs-lookup"><span data-stu-id="f98e8-131">For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.</span></span>  
  
## <a name="example"></a><span data-ttu-id="f98e8-132">Przykład</span><span class="sxs-lookup"><span data-stu-id="f98e8-132">Example</span></span>  
 <span data-ttu-id="f98e8-133">Na przykład w poniższym scenariuszu Użytkownik1 rozpocznie się przygotowywanie aktualizacji przez przeszukiwanie wiersza w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="f98e8-133">For example, in the following scenario, User1 starts to prepare an update by querying the database for a row.</span></span> <span data-ttu-id="f98e8-134">Użytkownik1 odbiera wiersz o wartościach Alfreds, Maria i Sales.</span><span class="sxs-lookup"><span data-stu-id="f98e8-134">User1 receives a row with values of Alfreds, Maria, and Sales.</span></span>  
  
 <span data-ttu-id="f98e8-135">Użytkownik1 chce zmienić wartość kolumny Manager na Alfred i wartość kolumny działu na marketing.</span><span class="sxs-lookup"><span data-stu-id="f98e8-135">User1 wants to change the value of the Manager column to Alfred and the value of the Department column to Marketing.</span></span> <span data-ttu-id="f98e8-136">Zanim Użytkownik1 będzie mógł przesłać te zmiany, nastąpiło przesłanie zmian do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f98e8-136">Before User1 can submit those changes, User2 has submitted changes to the database.</span></span> <span data-ttu-id="f98e8-137">W związku z tym teraz wartość kolumny asystenta została zmieniona na Mary i wartość kolumny dział na usługa.</span><span class="sxs-lookup"><span data-stu-id="f98e8-137">So now the value of the Assistant column has been changed to Mary and the value of the Department column to Service.</span></span>  
  
 <span data-ttu-id="f98e8-138">Gdy Użytkownik1 podejmie teraz próbę przesłania zmian, przesłanie nie powiedzie się i <xref:System.Data.Linq.ChangeConflictException> zostanie zgłoszony wyjątek.</span><span class="sxs-lookup"><span data-stu-id="f98e8-138">When User1 now tries to submit changes, the submission fails and a <xref:System.Data.Linq.ChangeConflictException> exception is thrown.</span></span> <span data-ttu-id="f98e8-139">Ten wynik występuje, ponieważ wartości bazy danych dla kolumny asystenta i działu nie są oczekiwane.</span><span class="sxs-lookup"><span data-stu-id="f98e8-139">This result occurs because the database values for the Assistant column and the Department column are not those that were expected.</span></span> <span data-ttu-id="f98e8-140">Elementy członkowskie reprezentujące kolumny asystenta i działu są w konflikcie.</span><span class="sxs-lookup"><span data-stu-id="f98e8-140">Members representing the Assistant and Department columns are in conflict.</span></span> <span data-ttu-id="f98e8-141">Poniższa tabela zawiera podsumowanie sytuacji.</span><span class="sxs-lookup"><span data-stu-id="f98e8-141">The following table summarizes the situation.</span></span>  
  
||<span data-ttu-id="f98e8-142">maszyny wirtualnej</span><span class="sxs-lookup"><span data-stu-id="f98e8-142">Manager</span></span>|<span data-ttu-id="f98e8-143">Pomocnik</span><span class="sxs-lookup"><span data-stu-id="f98e8-143">Assistant</span></span>|<span data-ttu-id="f98e8-144">Dział</span><span class="sxs-lookup"><span data-stu-id="f98e8-144">Department</span></span>|  
|------|-------------|---------------|----------------|  
|<span data-ttu-id="f98e8-145">Stan pierwotny</span><span class="sxs-lookup"><span data-stu-id="f98e8-145">Original state</span></span>|<span data-ttu-id="f98e8-146">Alfreds</span><span class="sxs-lookup"><span data-stu-id="f98e8-146">Alfreds</span></span>|<span data-ttu-id="f98e8-147">Maria</span><span class="sxs-lookup"><span data-stu-id="f98e8-147">Maria</span></span>|<span data-ttu-id="f98e8-148">Sprzedaż</span><span class="sxs-lookup"><span data-stu-id="f98e8-148">Sales</span></span>|  
|<span data-ttu-id="f98e8-149">Użytkownik1</span><span class="sxs-lookup"><span data-stu-id="f98e8-149">User1</span></span>|<span data-ttu-id="f98e8-150">Alfred</span><span class="sxs-lookup"><span data-stu-id="f98e8-150">Alfred</span></span>||<span data-ttu-id="f98e8-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="f98e8-151">Marketing</span></span>|  
|<span data-ttu-id="f98e8-152">Użytkownik2</span><span class="sxs-lookup"><span data-stu-id="f98e8-152">User2</span></span>||<span data-ttu-id="f98e8-153">Anna</span><span class="sxs-lookup"><span data-stu-id="f98e8-153">Mary</span></span>|<span data-ttu-id="f98e8-154">Usługa</span><span class="sxs-lookup"><span data-stu-id="f98e8-154">Service</span></span>|  
  
 <span data-ttu-id="f98e8-155">Można rozwiązać konflikty, takie jak na różne sposoby.</span><span class="sxs-lookup"><span data-stu-id="f98e8-155">You can resolve conflicts such as this in different ways.</span></span> <span data-ttu-id="f98e8-156">Aby uzyskać więcej informacji, zobacz [jak: Zarządzanie konfliktami](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)zmian.</span><span class="sxs-lookup"><span data-stu-id="f98e8-156">For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span></span>  
  
## <a name="conflict-detection-and-resolution-checklist"></a><span data-ttu-id="f98e8-157">Lista kontrolna wykrywania i rozwiązywania konfliktów</span><span class="sxs-lookup"><span data-stu-id="f98e8-157">Conflict Detection and Resolution Checklist</span></span>  
 <span data-ttu-id="f98e8-158">Możesz wykrywać i rozwiązywać konflikty na dowolnym poziomie szczegółowości.</span><span class="sxs-lookup"><span data-stu-id="f98e8-158">You can detect and resolve conflicts at any level of detail.</span></span> <span data-ttu-id="f98e8-159">Z jednej najwyższej klasy można rozwiązać wszystkie konflikty na jeden z trzech sposobów (zobacz <xref:System.Data.Linq.RefreshMode>) bez dodatkowych zagadnień.</span><span class="sxs-lookup"><span data-stu-id="f98e8-159">At one extreme, you can resolve all conflicts in one of three ways (see <xref:System.Data.Linq.RefreshMode>) without additional consideration.</span></span> <span data-ttu-id="f98e8-160">Z drugiej najwyższej klasy można wyznaczyć określoną akcję dla każdego typu konfliktu dla każdego elementu członkowskiego powodującego konflikt.</span><span class="sxs-lookup"><span data-stu-id="f98e8-160">At the other extreme, you can designate a specific action for each type of conflict on every member in conflict.</span></span>  
  
- <span data-ttu-id="f98e8-161">Określ lub skoryguj <xref:System.Data.Linq.Mapping.UpdateCheck> opcje w modelu obiektów.</span><span class="sxs-lookup"><span data-stu-id="f98e8-161">Specify or revise <xref:System.Data.Linq.Mapping.UpdateCheck> options in your object model.</span></span>  
  
     <span data-ttu-id="f98e8-162">Aby uzyskać więcej informacji, zobacz [jak: Określ, które elementy członkowskie są testowane pod](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md)kątem konfliktów współbieżności.</span><span class="sxs-lookup"><span data-stu-id="f98e8-162">For more information, see [How to: Specify Which Members are Tested for Concurrency Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).</span></span>  
  
- <span data-ttu-id="f98e8-163">W bloku try/catch wywołania do <xref:System.Data.Linq.DataContext.SubmitChanges%2A>Określ, w którym punkcie mają być zgłaszane wyjątki.</span><span class="sxs-lookup"><span data-stu-id="f98e8-163">In the try/catch block of your call to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, specify at what point you want exceptions to be thrown.</span></span>  
  
     <span data-ttu-id="f98e8-164">Aby uzyskać więcej informacji, zobacz [jak: Określ, kiedy są zgłaszane](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md)wyjątki współbieżności.</span><span class="sxs-lookup"><span data-stu-id="f98e8-164">For more information, see [How to: Specify When Concurrency Exceptions are Thrown](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).</span></span>  
  
- <span data-ttu-id="f98e8-165">Określ, ile szczegółów konfliktów chcesz pobrać, i odpowiednio Dołącz kod w bloku try/catch.</span><span class="sxs-lookup"><span data-stu-id="f98e8-165">Determine how much conflict detail you want to retrieve, and include code in your try/catch block accordingly.</span></span>  
  
     <span data-ttu-id="f98e8-166">Aby uzyskać więcej informacji, zobacz [jak: Pobierz informacje o](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) konflikcie jednostki [i instrukcje: Pobierz informacje o](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md)konflikcie elementu członkowskiego.</span><span class="sxs-lookup"><span data-stu-id="f98e8-166">For more information, see [How to: Retrieve Entity Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) and [How to: Retrieve Member Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).</span></span>  
  
- <span data-ttu-id="f98e8-167">Uwzględnij w `try` /kodziesposób, wjakichceszrozwiązaćróżneodnajdywanekonflikty.`catch`</span><span class="sxs-lookup"><span data-stu-id="f98e8-167">Include in your `try`/`catch` code how you want to resolve the various conflicts you discover.</span></span>  
  
     <span data-ttu-id="f98e8-168">Aby uzyskać więcej informacji, zobacz [jak: Rozwiązywanie konfliktów przez zachowywanie wartości](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md)bazy [danych, jak: Rozwiąż konflikty, zastępując wartości](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md)bazy danych i [instrukcje: Rozwiązywanie konfliktów przez scalanie z](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md)wartościami bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f98e8-168">For more information, see [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), and [How to: Resolve Conflicts by Merging with Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).</span></span>  
  
## <a name="linq-to-sql-types-that-support-conflict-discovery-and-resolution"></a><span data-ttu-id="f98e8-169">Typy LINQ to SQL obsługujące wykrywanie i rozwiązywanie konfliktów</span><span class="sxs-lookup"><span data-stu-id="f98e8-169">LINQ to SQL Types That Support Conflict Discovery and Resolution</span></span>  
 <span data-ttu-id="f98e8-170">Klasy i funkcje do obsługi rozwiązywania konfliktów w optymistycznej współbieżności w [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] programie obejmują następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="f98e8-170">Classes and features to support the resolution of conflicts in optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] include the following:</span></span>  
  
- <xref:System.Data.Linq.ObjectChangeConflict?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.MemberChangeConflict?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.ChangeConflictCollection?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.ChangeConflictException?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.ChangeConflicts%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.SubmitChanges%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.Refresh%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.Mapping.ColumnAttribute.UpdateCheck%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.Mapping.UpdateCheck?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.RefreshMode?displayProperty=nameWithType>  
  
## <a name="see-also"></a><span data-ttu-id="f98e8-171">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="f98e8-171">See also</span></span>

- [<span data-ttu-id="f98e8-172">Instrukcje: Zarządzanie konfliktami zmian</span><span class="sxs-lookup"><span data-stu-id="f98e8-172">How to: Manage Change Conflicts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)
