---
title: "Porady: przechowywanie i ponowne użycie zapytań"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
caps.latest.revision: "2"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: 8170b1219bf66c1f90fb5db3143916f7a41aab94
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/22/2017
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="7a275-102">Porady: przechowywanie i ponowne użycie zapytań</span><span class="sxs-lookup"><span data-stu-id="7a275-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="7a275-103">Jeśli masz aplikację, która wykonuje zapytania strukturę podobną tyle razy, często może zwiększyć wydajność kompilacji zapytania jeden raz i jej wykonanie kilka razy z innymi parametrami.</span><span class="sxs-lookup"><span data-stu-id="7a275-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="7a275-104">Na przykład aplikacja może mieć można pobrać wszystkich klientów, którzy są określonego miasta, w którym miasta jest określone w czasie wykonywania przez użytkownika w postaci.</span><span class="sxs-lookup"><span data-stu-id="7a275-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="7a275-105">obsługuje korzystanie z *skompilowane zapytania* w tym celu.</span><span class="sxs-lookup"><span data-stu-id="7a275-105"> supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7a275-106">Ten wzorzec użycia reprezentuje najbardziej popularnym zastosowaniem zapytań skompilowany.</span><span class="sxs-lookup"><span data-stu-id="7a275-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="7a275-107">Możliwe są inne podejścia.</span><span class="sxs-lookup"><span data-stu-id="7a275-107">Other approaches are possible.</span></span> <span data-ttu-id="7a275-108">Na przykład skompilowane zapytania mogą być przechowywane jako statyczne elementy członkowskie dla częściowej klasy, która rozszerza kod wygenerowany przez projektanta.</span><span class="sxs-lookup"><span data-stu-id="7a275-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="7a275-109">Przykład</span><span class="sxs-lookup"><span data-stu-id="7a275-109">Example</span></span>  
 <span data-ttu-id="7a275-110">W wielu scenariuszach można ponownie użyć zapytania w granicach wątku.</span><span class="sxs-lookup"><span data-stu-id="7a275-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="7a275-111">W takich przypadkach zapisanie skompilowane zapytania w zmienne statyczne jest szczególnie użyteczna.</span><span class="sxs-lookup"><span data-stu-id="7a275-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="7a275-112">Poniższy przykład kodu zakłada `Queries` klasy przeznaczone do przechowywania skompilowanych zapytania i przyjęto założenie, reprezentujący silnie typizowaną klasę Northwind <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="7a275-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="7a275-113">Przykład</span><span class="sxs-lookup"><span data-stu-id="7a275-113">Example</span></span>  
 <span data-ttu-id="7a275-114">Nie można obecnie zapytań magazynu (w zmiennych statycznych), które zwracają *typu anonimowego*, ponieważ typ nie ma nazwy zapewnienie jako argument rodzajowy.</span><span class="sxs-lookup"><span data-stu-id="7a275-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="7a275-115">W poniższym przykładzie pokazano, jak można obejść ten problem, tworząc typu, który reprezentuje wynik, a następnie użyć jej jako argument rodzajowy.</span><span class="sxs-lookup"><span data-stu-id="7a275-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="7a275-116">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="7a275-116">See Also</span></span>  
 <xref:System.Data.Linq.CompiledQuery>  
 [<span data-ttu-id="7a275-117">Pojęcia dotyczące zapytań</span><span class="sxs-lookup"><span data-stu-id="7a275-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)  
 [<span data-ttu-id="7a275-118">Wykonywanie zapytania w bazie danych</span><span class="sxs-lookup"><span data-stu-id="7a275-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
