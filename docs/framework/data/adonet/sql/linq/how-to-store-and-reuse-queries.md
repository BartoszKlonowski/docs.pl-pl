---
title: 'Instrukcje: Przechowywanie i ponowne użycie zapytań'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: f8400b214bc9ba3a28eeec05f6171953b42bc6f5
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/22/2019
ms.locfileid: "69938742"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="d771c-102">Instrukcje: Przechowywanie i ponowne użycie zapytań</span><span class="sxs-lookup"><span data-stu-id="d771c-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="d771c-103">W przypadku aplikacji, która wielokrotnie wykonuje podobne zapytania strukturalnie, często można zwiększyć wydajność, kompilując zapytanie jeden raz i wykonując je kilka razy z innymi parametrami.</span><span class="sxs-lookup"><span data-stu-id="d771c-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="d771c-104">Na przykład aplikacja może wymagać pobrania wszystkich klientów, którzy znajdują się w konkretnym mieście, gdzie miasto jest określone w czasie wykonywania przez użytkownika w formularzu.</span><span class="sxs-lookup"><span data-stu-id="d771c-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="d771c-105">obsługuje w tym celu użycie *skompilowanych zapytań* .</span><span class="sxs-lookup"><span data-stu-id="d771c-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="d771c-106">Ten wzorzec użycia reprezentuje najczęstsze zastosowania skompilowanych zapytań.</span><span class="sxs-lookup"><span data-stu-id="d771c-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="d771c-107">Możliwe jest inne podejście.</span><span class="sxs-lookup"><span data-stu-id="d771c-107">Other approaches are possible.</span></span> <span data-ttu-id="d771c-108">Na przykład skompilowane zapytania mogą być przechowywane jako statyczne elementy członkowskie klasy częściowej, która rozszerza kod generowany przez projektanta.</span><span class="sxs-lookup"><span data-stu-id="d771c-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="d771c-109">Przykład</span><span class="sxs-lookup"><span data-stu-id="d771c-109">Example</span></span>  
 <span data-ttu-id="d771c-110">W wielu scenariuszach możesz chcieć ponownie wykorzystać zapytania w granicach wątków.</span><span class="sxs-lookup"><span data-stu-id="d771c-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="d771c-111">W takich przypadkach przechowywanie skompilowanych zapytań w zmiennych statycznych jest szczególnie skuteczne.</span><span class="sxs-lookup"><span data-stu-id="d771c-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="d771c-112">W poniższym przykładzie kodu założono `Queries` klasę zaprojektowaną do przechowywania skompilowanych zapytań i przyjmujemy klasę Northwind, która reprezentuje <xref:System.Data.Linq.DataContext>silnie wpisaną wartość.</span><span class="sxs-lookup"><span data-stu-id="d771c-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="d771c-113">Przykład</span><span class="sxs-lookup"><span data-stu-id="d771c-113">Example</span></span>  
 <span data-ttu-id="d771c-114">Obecnie nie można przechowywać (w zmiennych statycznych) zapytań, które zwracają *Typ anonimowy*, ponieważ typ nie ma nazwy, która ma być argumentem ogólnym.</span><span class="sxs-lookup"><span data-stu-id="d771c-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="d771c-115">Poniższy przykład pokazuje, jak można obejść ten problem, tworząc typ, który może reprezentować wynik, a następnie użyć go jako argumentu rodzajowego.</span><span class="sxs-lookup"><span data-stu-id="d771c-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="d771c-116">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="d771c-116">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="d771c-117">Pojęcia dotyczące zapytań</span><span class="sxs-lookup"><span data-stu-id="d771c-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
- [<span data-ttu-id="d771c-118">Wykonywanie zapytania w bazie danych</span><span class="sxs-lookup"><span data-stu-id="d771c-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
