---
title: "LINQ do SQL N-warstwowa z usługami sieci Web"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 9cb10eb8-957f-4beb-a271-5f682016fed2
caps.latest.revision: "3"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: a24b8fe5d0da4b3fa3a13db15bd91be83f102dcf
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/17/2018
---
# <a name="linq-to-sql-n-tier-with-web-services"></a><span data-ttu-id="f20d1-102">LINQ do SQL N-warstwowa z usługami sieci Web</span><span class="sxs-lookup"><span data-stu-id="f20d1-102">LINQ to SQL N-Tier with Web Services</span></span>
[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="f20d1-103">jest przeznaczonym zwłaszcza do użycia w warstwie środkowej warstwy dostępu luźno połączonych danych (DAL) na przykład usługi sieci Web.</span><span class="sxs-lookup"><span data-stu-id="f20d1-103"> is designed especially for use on the middle tier in a loosely-coupled data access layer (DAL) such as a Web service.</span></span> <span data-ttu-id="f20d1-104">Jeśli Warstwa prezentacji prowadzi do strony sieci Web ASP.NET, a następnie używasz <xref:System.Web.UI.WebControls.LinqDataSource> formant serwera do zarządzania przesyłaniem danych między interfejs użytkownika sieci Web i [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] na warstwy środkowej.</span><span class="sxs-lookup"><span data-stu-id="f20d1-104">If the presentation tier is an ASP.NET Web page, then you use the <xref:System.Web.UI.WebControls.LinqDataSource> Web server control to manage the data transfer between the user interface and [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] on the middle-tier.</span></span> <span data-ttu-id="f20d1-105">Jeśli Warstwa prezentacji nie jest strony platformy ASP.NET, następnie zarówno warstwy środkowej i warstwy prezentacji wykonaj wykonania dodatkowych czynności, aby zarządzać serializacji i deserializacji obiektu danych.</span><span class="sxs-lookup"><span data-stu-id="f20d1-105">If the presentation tier is not an ASP.NET page, then both the middle-tier and the presentation tier must do some additional work to manage the serialization and deserialization of data.</span></span>  
  
## <a name="setting-up-linq-to-sql-on-the-middle-tier"></a><span data-ttu-id="f20d1-106">Konfigurowanie składnika LINQ to SQL na warstwy środkowej</span><span class="sxs-lookup"><span data-stu-id="f20d1-106">Setting up LINQ to SQL on the Middle Tier</span></span>  
 <span data-ttu-id="f20d1-107">W usłudze sieci Web lub aplikacji warstwowych warstwy środkowej zawiera kontekstu danych oraz klas jednostek.</span><span class="sxs-lookup"><span data-stu-id="f20d1-107">In a Web service or n-tier application, the middle tier contains the data context and the entity classes.</span></span> <span data-ttu-id="f20d1-108">Można utworzyć tych klas, ręcznie lub za pomocą obu SQLMetal.exe lub [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] zgodnie z opisem w innym miejscu w dokumentacji.</span><span class="sxs-lookup"><span data-stu-id="f20d1-108">You can create these classes manually, or by using either SQLMetal.exe or the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] as described elsewhere in the documentation.</span></span> <span data-ttu-id="f20d1-109">W czasie projektowania użytkownik może być możliwy do serializacji klas jednostek.</span><span class="sxs-lookup"><span data-stu-id="f20d1-109">At design time, you have the option to make the entity classes serializable.</span></span> <span data-ttu-id="f20d1-110">Aby uzyskać więcej informacji, zobacz [jak: utworzyć serializacji jednostek](../../../../../../docs/framework/data/adonet/sql/linq/how-to-make-entities-serializable.md).</span><span class="sxs-lookup"><span data-stu-id="f20d1-110">For more information, see [How to: Make Entities Serializable](../../../../../../docs/framework/data/adonet/sql/linq/how-to-make-entities-serializable.md).</span></span> <span data-ttu-id="f20d1-111">Innym rozwiązaniem jest tworzyć osobne zestawy klas, które zapewniają dane do serializacji i projektu do tych typów możliwych do serializacji, po powrocie do danych w sieci [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] zapytania.</span><span class="sxs-lookup"><span data-stu-id="f20d1-111">Another option is to create a separate set of classes that encapsulate the data to be serialized, and then project into those serializable types when you return data in your [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries.</span></span>  
  
 <span data-ttu-id="f20d1-112">Następnie zdefiniuj interfejsu za pomocą metod wywołujących klientów pobierania, wstawiania i aktualizowania danych.</span><span class="sxs-lookup"><span data-stu-id="f20d1-112">You then define the interface with the methods that the clients will call to retrieve, insert and update data.</span></span> <span data-ttu-id="f20d1-113">Zawijaj metod interfejsu użytkownika [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] zapytania.</span><span class="sxs-lookup"><span data-stu-id="f20d1-113">The interface methods wrap your [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries.</span></span> <span data-ttu-id="f20d1-114">Dowolny rodzaj mechanizmu serializacji służy do obsługi wywołania metody zdalnego i serializacja danych.</span><span class="sxs-lookup"><span data-stu-id="f20d1-114">You can use any kind of serialization mechanism to handle the remote method calls and the serialization of data.</span></span> <span data-ttu-id="f20d1-115">Jedynym wymaganiem jest to, że jeśli masz cykliczne lub dwukierunkowe relacje w modelu obiektu, takim jak między klientami a zamówień w standardowy model obiektów Northwind, to należy użyć serializatora, który go obsługuje.</span><span class="sxs-lookup"><span data-stu-id="f20d1-115">The only requirement is that if you have cyclic or bi-directional relationships in your object model, such as that between Customers and Orders in the standard Northwind object model, then you must use a serializer that supports it.</span></span> <span data-ttu-id="f20d1-116">Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> obsługuje dwukierunkowe relacje, ale element XmlSerializer, używany z usługami sieci Web z systemem innym niż — WCF nie.</span><span class="sxs-lookup"><span data-stu-id="f20d1-116">The Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> supports bi-directional relationships but the XmlSerializer that is used with non-WCF Web services does not.</span></span> <span data-ttu-id="f20d1-117">Jeśli wybrano opcję XmlSerializer, musi upewnij się, że model obiektów ma Brak relacji cyklicznej.</span><span class="sxs-lookup"><span data-stu-id="f20d1-117">If you select to use the XmlSerializer, then you must make sure that your object model has no cyclic relationships.</span></span>  
  
 <span data-ttu-id="f20d1-118">Aby uzyskać więcej informacji na temat programu Windows Communication Foundation, zobacz [usług Windows Communication Foundation oraz usługi danych WCF w programie Visual Studio](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="f20d1-118">For more information about Windows Communication Foundation, see [Windows Communication Foundation Services and WCF Data Services in Visual Studio](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span></span>  
  
 <span data-ttu-id="f20d1-119">Implementowanie reguł biznesowych lub innych logiki specyficznego dla domeny przy użyciu klasy częściowe i metody na <xref:System.Data.Linq.DataContext> oraz klas jednostek do przyłączanie się do [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] zdarzeniach środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="f20d1-119">Implement your business rules or other domain-specific logic by using the partial classes and methods on the <xref:System.Data.Linq.DataContext> and entity classes to hook into [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] runtime events.</span></span> <span data-ttu-id="f20d1-120">Aby uzyskać więcej informacji, zobacz [implementacji logiki biznesowej N-warstwowa](../../../../../../docs/framework/data/adonet/sql/linq/implementing-business-logic-linq-to-sql.md).</span><span class="sxs-lookup"><span data-stu-id="f20d1-120">For more information, see [Implementing N-Tier Business Logic](../../../../../../docs/framework/data/adonet/sql/linq/implementing-business-logic-linq-to-sql.md).</span></span>  
  
## <a name="defining-the-serializable-types"></a><span data-ttu-id="f20d1-121">Definiowanie typów możliwych do serializacji</span><span class="sxs-lookup"><span data-stu-id="f20d1-121">Defining the Serializable Types</span></span>  
 <span data-ttu-id="f20d1-122">Warstwa prezentacji lub klienta musi mieć definicji typu dla klasy, które będą otrzymywać od warstwy środkowej.</span><span class="sxs-lookup"><span data-stu-id="f20d1-122">The client or presentation tier must have type definitions for the classes that it will be receiving from the middle tier.</span></span> <span data-ttu-id="f20d1-123">Tych typów może być klas jednostek, samodzielnie lub specjalne klasy, które zawijać się tylko niektóre pola z klas jednostek dla niego komunikację zdalną.</span><span class="sxs-lookup"><span data-stu-id="f20d1-123">Those types may be the entity classes themselves, or special classes that wrap only certain fields from the entity classes for remoting.</span></span> <span data-ttu-id="f20d1-124">W każdym przypadku [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] jest całkowicie unconcerned o jak warstwy prezentacji uzyskuje te definicje typów.</span><span class="sxs-lookup"><span data-stu-id="f20d1-124">In any case, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] is completely unconcerned about how the presentation tier acquires those type definitions.</span></span> <span data-ttu-id="f20d1-125">Na przykład warstwy prezentacji można użyć WCF można automatycznie wygenerować typy może mieć kopię bibliotekę DLL, w których te typy są definiowane lub po prostu zdefiniować własny wersji typów.</span><span class="sxs-lookup"><span data-stu-id="f20d1-125">For example, the presentation tier could use WCF to generate the types automatically, or it could have a copy of a DLL in which those types are defined, or it could just define its own versions of the types.</span></span>  
  
## <a name="retrieving-and-inserting-data"></a><span data-ttu-id="f20d1-126">Trwa pobieranie i wstawianie danych</span><span class="sxs-lookup"><span data-stu-id="f20d1-126">Retrieving and Inserting Data</span></span>  
 <span data-ttu-id="f20d1-127">Warstwy środkowej definiuje interfejs, który określa, jak Warstwa prezentacji uzyskuje dostęp do danych.</span><span class="sxs-lookup"><span data-stu-id="f20d1-127">The middle tier defines an interface that specifies how the presentation tier accesses the data.</span></span> <span data-ttu-id="f20d1-128">Na przykład `GetProductByID(int productID)`, lub `GetCustomers()`.</span><span class="sxs-lookup"><span data-stu-id="f20d1-128">For example `GetProductByID(int productID)`, or `GetCustomers()`.</span></span> <span data-ttu-id="f20d1-129">W warstwie środkowej treści metody zazwyczaj tworzy nowe wystąpienie klasy <xref:System.Data.Linq.DataContext>, wykonuje zapytania dotyczącego co najmniej jednego z jego tabeli.</span><span class="sxs-lookup"><span data-stu-id="f20d1-129">On the middle tier, the method body typically creates a new instance of the <xref:System.Data.Linq.DataContext>, executes a query against one or more of its table.</span></span> <span data-ttu-id="f20d1-130">Warstwy środkowej zwraca wynik w postaci <xref:System.Collections.Generic.IEnumerable%601>, gdzie `T` jest klasą jednostki lub innego typu, który jest używany do serializacji.</span><span class="sxs-lookup"><span data-stu-id="f20d1-130">The middle tier then returns the result as an <xref:System.Collections.Generic.IEnumerable%601>, where `T` is either an entity class or another type that is used for serialization.</span></span> <span data-ttu-id="f20d1-131">Warstwa prezentacji nigdy nie wysyła lub odbiera zmiennych zapytania bezpośrednio do lub z warstwy środkowej.</span><span class="sxs-lookup"><span data-stu-id="f20d1-131">The presentation tier never sends or receives query variables directly to or from the middle tier.</span></span> <span data-ttu-id="f20d1-132">Dwie warstwy wymiany wartości, obiektów i kolekcji konkretnych danych.</span><span class="sxs-lookup"><span data-stu-id="f20d1-132">The two tiers exchange values, objects, and collections of concrete data.</span></span> <span data-ttu-id="f20d1-133">Po odebraniu kolekcji, można użyć warstwy prezentacji [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] do obiektów do badania go, jeśli to konieczne.</span><span class="sxs-lookup"><span data-stu-id="f20d1-133">After it has received a collection, the presentation tier can use [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] to Objects to query it if necessary.</span></span>  
  
 <span data-ttu-id="f20d1-134">Podczas wstawiania danych, warstwy prezentacji można utworzyć nowego obiektu i wysyłania go do warstwy środkowej, lub mogą mieć konstruowania obiektu na podstawie wartości, które zapewnia warstwę środkową.</span><span class="sxs-lookup"><span data-stu-id="f20d1-134">When inserting data, the presentation tier can construct a new object and send it to the middle tier, or it can have the middle tier construct the object based on values that it provides.</span></span> <span data-ttu-id="f20d1-135">Ogólnie rzecz biorąc pobieranie i wstawianie danych w aplikacjach warstwowych nie różni się znacznie w procesie w aplikacji warstwy 2.</span><span class="sxs-lookup"><span data-stu-id="f20d1-135">In general, retrieving and inserting data in n-tier applications does not differ much from the process in 2-tier applications.</span></span> <span data-ttu-id="f20d1-136">Aby uzyskać więcej informacji, zobacz [kwerendy bazy danych](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md) i [tworzenie i przesyłanie zmian danych](../../../../../../docs/framework/data/adonet/sql/linq/making-and-submitting-data-changes.md).</span><span class="sxs-lookup"><span data-stu-id="f20d1-136">For more information, see [Querying the Database](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md) and [Making and Submitting Data Changes](../../../../../../docs/framework/data/adonet/sql/linq/making-and-submitting-data-changes.md).</span></span>  
  
## <a name="tracking-changes-for-updates-and-deletes"></a><span data-ttu-id="f20d1-137">Śledzenie zmian aktualizacji i usunięć</span><span class="sxs-lookup"><span data-stu-id="f20d1-137">Tracking Changes for Updates and Deletes</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="f20d1-138">obsługuje optymistycznej współbieżności na podstawie sygnatury czasowe (nazywana również RowVersions) a oryginalnych wartości.</span><span class="sxs-lookup"><span data-stu-id="f20d1-138"> supports optimistic concurrency based on timestamps (also named RowVersions) and on original values.</span></span> <span data-ttu-id="f20d1-139">Jeśli tabel bazy danych są sygnatury czasowe, następnie aktualizacji i usunięć wymaga niewiele dodatkowej pracy w warstwie warstwy środkowej albo prezentacji.</span><span class="sxs-lookup"><span data-stu-id="f20d1-139">If the database tables have timestamps, then updates and deletions require little extra work on either the middle-tier or presentation tier.</span></span> <span data-ttu-id="f20d1-140">Jednak jeśli oryginalne wartości musi być używany dla sprawdzenie optymistycznej współbieżności, następnie warstwy prezentacji jest odpowiedzialny za śledzenia te wartości i wysyła je po ułatwia aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="f20d1-140">However, if you must use original values for optimistic concurrency checks, then the presentation tier is responsible for tracking those values and sending them back when it makes updates.</span></span> <span data-ttu-id="f20d1-141">Jest to spowodowane jednostek w warstwie prezentacji zostały wprowadzone zmiany nie są śledzone na warstwy środkowej.</span><span class="sxs-lookup"><span data-stu-id="f20d1-141">This is because changes that were made to entities on the presentation tier are not tracked on the middle tier.</span></span> <span data-ttu-id="f20d1-142">W rzeczywistości oryginalnego pobierania jednostki i aktualizacji ostatecznego je są najczęściej wykonywane przez dwa osobne wystąpienia <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="f20d1-142">In fact, the original retrieval of an entity, and the eventual update made to it are typically performed by two completely separate instances of the <xref:System.Data.Linq.DataContext>.</span></span>  
  
 <span data-ttu-id="f20d1-143">Większa liczba zmian, które zapewnia warstwę prezentacji, tym bardziej złożone, które staje się on do śledzenia tych zmian i pakiet, który je z powrotem do warstwy środkowej.</span><span class="sxs-lookup"><span data-stu-id="f20d1-143">The greater the number of changes that the presentation tier makes, the more complex it becomes to track those changes and package them back to the middle tier.</span></span> <span data-ttu-id="f20d1-144">Implementacja mechanizm komunikacji zmiany zależy całkowicie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f20d1-144">The implementation of a mechanism for communicating changes is completely up to the application.</span></span> <span data-ttu-id="f20d1-145">Jedynym wymaganiem jest to, że [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] muszą mieć te oryginalnych wartości, które są wymagane dla sprawdzenie optymistycznej współbieżności.</span><span class="sxs-lookup"><span data-stu-id="f20d1-145">The only requirement is that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] must be given those original values that are required for optimistic concurrency checks.</span></span>  
  
 <span data-ttu-id="f20d1-146">Aby uzyskać więcej informacji, zobacz [pobierania danych i CUD operacje w aplikacjach warstwowych (LINQ to SQL)](../../../../../../docs/framework/data/adonet/sql/linq/data-retrieval-and-cud-operations-in-n-tier-applications.md).</span><span class="sxs-lookup"><span data-stu-id="f20d1-146">For more information, see [Data Retrieval and CUD Operations in N-Tier Applications (LINQ to SQL)](../../../../../../docs/framework/data/adonet/sql/linq/data-retrieval-and-cud-operations-in-n-tier-applications.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f20d1-147">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="f20d1-147">See Also</span></span>  
 [<span data-ttu-id="f20d1-148">N-warstwowe i zdalne aplikacje z użyciem LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="f20d1-148">N-Tier and Remote Applications with LINQ to SQL</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/n-tier-and-remote-applications-with-linq-to-sql.md)  
 [<span data-ttu-id="f20d1-149">NIB: Informacje o formancie serwera sieci Web LinqDataSource</span><span class="sxs-lookup"><span data-stu-id="f20d1-149">NIB: LinqDataSource Web Server Control Overview</span></span>](http://msdn.microsoft.com/en-us/104cfc3f-7385-47d3-8a51-830dfa791136)
