---
title: "Zarządzanie uprawnieniami w procedurach składowanych w programie SQL Server"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 08fa34e8-2ffa-470d-ba62-e511a5f8558e
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: 806cd23060dde3f7b466df0d4ce39162353380e6
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/21/2017
---
# <a name="managing-permissions-with-stored-procedures-in-sql-server"></a><span data-ttu-id="c6c9c-102">Zarządzanie uprawnieniami w procedurach składowanych w programie SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6c9c-102">Managing Permissions with Stored Procedures in SQL Server</span></span>
<span data-ttu-id="c6c9c-103">Jedną z metod tworzenia wielu linii obrony wokół bazy danych jest wdrożenie wszystkich dostęp do danych za pomocą procedury składowanej lub funkcji zdefiniowanej przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-103">One method of creating multiple lines of defense around your database is to implement all data access using stored procedures or user-defined functions.</span></span> <span data-ttu-id="c6c9c-104">Odwoływanie lub odmówić wszystkich uprawnień do obiektów podstawowych, takich jak tabele i przyznać uprawnienia EXECUTE procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-104">You revoke or deny all permissions to underlying objects, such as tables, and grant EXECUTE permissions on stored procedures.</span></span> <span data-ttu-id="c6c9c-105">Spowoduje to skutecznie utworzenie obwodu zabezpieczeń wokół obiektów danych i bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-105">This effectively creates a security perimeter around your data and database objects.</span></span>  
  
## <a name="stored-procedure-benefits"></a><span data-ttu-id="c6c9c-106">Procedura składowana korzyści</span><span class="sxs-lookup"><span data-stu-id="c6c9c-106">Stored Procedure Benefits</span></span>  
 <span data-ttu-id="c6c9c-107">Procedury składowane są następujące korzyści:</span><span class="sxs-lookup"><span data-stu-id="c6c9c-107">Stored procedures have the following benefits:</span></span>  
  
-   <span data-ttu-id="c6c9c-108">Reguły logiki i business danych można hermetyzowany, dzięki czemu użytkownicy mogą uzyskiwać dostęp do danych i obiektów tylko w sposób, w którym mają deweloperom i administratorom bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-108">Data logic and business rules can be encapsulated so that users can access data and objects only in ways that developers and database administrators intend.</span></span>  
  
-   <span data-ttu-id="c6c9c-109">Sparametryzowane procedur składowanych, sprawdzania poprawności wszystkich danych wejściowych użytkownika można zablokować ataki.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-109">Parameterized stored procedures that validate all user input can be used to thwart SQL injection attacks.</span></span> <span data-ttu-id="c6c9c-110">Użycie dynamicznych SQL, należy koniecznie parametryzacja poleceń i nigdy nie dołączaj parametru wartości bezpośrednio do ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-110">If you use dynamic SQL, be sure to parameterize your commands, and never include parameter values directly into a query string.</span></span>  
  
-   <span data-ttu-id="c6c9c-111">Ad hoc modyfikacji zapytań i danych mogą niedozwolone.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-111">Ad hoc queries and data modifications can be disallowed.</span></span> <span data-ttu-id="c6c9c-112">Zapobiega to użytkownikom złośliwe lub przypadkowo niszczenie danych lub wykonywanie zapytań, które obniżają wydajność na serwerze lub w sieci.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-112">This prevents users from maliciously or inadvertently destroying data or executing queries that impair performance on the server or the network.</span></span>  
  
-   <span data-ttu-id="c6c9c-113">Błędy mogą być obsługiwane w kodzie procedury bez przekazywany bezpośrednio do aplikacji klienckich.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-113">Errors can be handled in procedure code without being passed directly to client applications.</span></span> <span data-ttu-id="c6c9c-114">Zapobiega to komunikaty o błędach zwracanych, która może pomóc w sondowania ataku.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-114">This prevents error messages from being returned that could aid in a probing attack.</span></span> <span data-ttu-id="c6c9c-115">Rejestrowanie błędów i obsługiwać je na serwerze.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-115">Log errors and handle them on the server.</span></span>  
  
-   <span data-ttu-id="c6c9c-116">Procedury składowane można raz zapisany i dostęp do wielu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-116">Stored procedures can be written once, and accessed by many applications.</span></span>  
  
-   <span data-ttu-id="c6c9c-117">Aplikacje klienta nie muszą mieć żadnych informacji na temat podstawowej struktury danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-117">Client applications do not need to know anything about the underlying data structures.</span></span> <span data-ttu-id="c6c9c-118">Procedura składowana kodu można zmienić bez konieczności wprowadzania zmian w aplikacjach klienckich, tak długo, jak zmiany nie wpływają na listy parametrów lub zwracane typy danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-118">Stored procedure code can be changed without requiring changes in client applications as long as the changes do not affect parameter lists or returned data types.</span></span>  
  
-   <span data-ttu-id="c6c9c-119">Procedury składowane można zmniejszenie ruchu w sieci, łącząc wiele operacji na jednym wywoływania.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-119">Stored procedures can reduce network traffic by combining multiple operations into one procedure call.</span></span>  
  
## <a name="stored-procedure-execution"></a><span data-ttu-id="c6c9c-120">Wykonywanie procedury składowanej</span><span class="sxs-lookup"><span data-stu-id="c6c9c-120">Stored Procedure Execution</span></span>  
 <span data-ttu-id="c6c9c-121">Przechowywane procedury Wykorzystaj własność łańcucha w celu zapewnienia dostępu do danych, dzięki czemu użytkownicy nie muszą mieć jawne uprawnienia dostępu do obiektów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-121">Stored procedures take advantage of ownership chaining to provide access to data so that users do not need to have explicit permission to access database objects.</span></span> <span data-ttu-id="c6c9c-122">Łańcuch własność występuje, gdy obiekty, które uzyskują dostęp do siebie sekwencyjnie własnością tego samego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-122">An ownership chain exists when objects that access each other sequentially are owned by the same user.</span></span> <span data-ttu-id="c6c9c-123">Na przykład wywołać procedurę składowaną innych procedur składowanych lub procedury składowanej mogą uzyskiwać dostęp do wielu tabel.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-123">For example, a stored procedure can call other stored procedures, or a stored procedure can access multiple tables.</span></span> <span data-ttu-id="c6c9c-124">Jeśli wszystkie obiekty w łańcuchu wykonanie tego samego właściciela, a następnie programu SQL Server tylko sprawdza uprawnienia EXECUTE dla obiekt wywołujący, nie wywołującego uprawnienia do innych obiektów.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-124">If all objects in the chain of execution have the same owner, then SQL Server only checks the EXECUTE permission for the caller, not the caller's permissions on other objects.</span></span> <span data-ttu-id="c6c9c-125">W związku z tym należy przyznać uprawnienia tylko wykonywania na procedury składowane; można odwołać lub odrzucać wszystkie uprawnienia w tabeli.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-125">Therefore you need to grant only EXECUTE permissions on stored procedures; you can revoke or deny all permissions on the underlying tables.</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="c6c9c-126">Najlepsze praktyki</span><span class="sxs-lookup"><span data-stu-id="c6c9c-126">Best Practices</span></span>  
 <span data-ttu-id="c6c9c-127">Po prostu Pisanie procedur składowanych nie wystarcza do odpowiednio zabezpieczania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-127">Simply writing stored procedures isn't enough to adequately secure your application.</span></span> <span data-ttu-id="c6c9c-128">Należy również rozważyć następujące potencjalnych luk w zabezpieczeniach.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-128">You should also consider the following potential security holes.</span></span>  
  
-   <span data-ttu-id="c6c9c-129">Udziel uprawnienia do wykonania na procedury składowane dla ról bazy danych, które chcesz mieć możliwość uzyskania dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-129">Grant EXECUTE permissions on the stored procedures for database roles you want to be able to access the data.</span></span>  
  
-   <span data-ttu-id="c6c9c-130">Odwoływanie lub odrzucać wszystkie uprawnienia do tabeli dla wszystkich ról i użytkowników w bazie danych, w tym `public` roli.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-130">Revoke or deny all permissions to the underlying tables for all roles and users in the database, including the `public` role.</span></span> <span data-ttu-id="c6c9c-131">Wszyscy użytkownicy dziedziczą uprawnienia z publicznej.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-131">All users inherit permissions from public.</span></span> <span data-ttu-id="c6c9c-132">W związku z tym odmawiania uprawnień do `public` oznacza tylko właściciele i `sysadmin` członkowie mają dostęp; wszyscy inni użytkownicy będą mogli dziedziczą uprawnienia z członkostwa w innych ról.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-132">Therefore denying permissions to `public` means that only owners and `sysadmin` members have access; all other users will be unable to inherit permissions from membership in other roles.</span></span>  
  
-   <span data-ttu-id="c6c9c-133">Nie należy dodawać użytkowników i ról do `sysadmin` lub `db_owner` ról.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-133">Do not add users or roles to the `sysadmin` or `db_owner` roles.</span></span> <span data-ttu-id="c6c9c-134">Administratorzy systemu i właścicielom bazy danych mają dostęp do wszystkich obiektów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-134">System administrators and database owners can access all database objects.</span></span>  
  
-   <span data-ttu-id="c6c9c-135">Wyłącz `guest` konta.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-135">Disable the `guest` account.</span></span> <span data-ttu-id="c6c9c-136">Uniemożliwi to użytkownicy anonimowi łączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-136">This will prevent anonymous users from connecting to the database.</span></span> <span data-ttu-id="c6c9c-137">Konta gościa jest domyślnie wyłączona w nowych baz danych.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-137">The guest account is disabled by default in new databases.</span></span>  
  
-   <span data-ttu-id="c6c9c-138">Implementuje błąd obsługi i dziennik błędów.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-138">Implement error handling and log errors.</span></span>  
  
-   <span data-ttu-id="c6c9c-139">Utworzyć sparametryzowany procedur składowanych, sprawdzania poprawności wszystkich danych wejściowych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-139">Create parameterized stored procedures that validate all user input.</span></span> <span data-ttu-id="c6c9c-140">Traktuj wszystkie dane wejściowe użytkownika jako niezaufane.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-140">Treat all user input as untrusted.</span></span>  
  
-   <span data-ttu-id="c6c9c-141">Uniknąć dynamiczne SQL, chyba że bezwzględnie konieczne.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-141">Avoid dynamic SQL unless absolutely necessary.</span></span> <span data-ttu-id="c6c9c-142">Użyj funkcji QUOTENAME() języka Transact-SQL, aby ograniczyć wartość ciągu i uniknięcie wszelkich wystąpieniu ogranicznika w ciągu wejściowym.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-142">Use the Transact-SQL QUOTENAME() function to delimit a string value and escape any occurrence of the delimiter in the input string.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="c6c9c-143">Zasoby zewnętrzne</span><span class="sxs-lookup"><span data-stu-id="c6c9c-143">External Resources</span></span>  
 <span data-ttu-id="c6c9c-144">Aby uzyskać więcej informacji zobacz następujące zasoby.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-144">For more information, see the following resources.</span></span>  
  
|<span data-ttu-id="c6c9c-145">Zasób</span><span class="sxs-lookup"><span data-stu-id="c6c9c-145">Resource</span></span>|<span data-ttu-id="c6c9c-146">Opis</span><span class="sxs-lookup"><span data-stu-id="c6c9c-146">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="c6c9c-147">[Procedury składowane](http://msdn.microsoft.com/library/ms190782.aspx) i [iniekcja kodu SQL](http://go.microsoft.com/fwlink/?LinkId=98234) w dokumentacji SQL Server Books Online</span><span class="sxs-lookup"><span data-stu-id="c6c9c-147">[Stored Procedures](http://msdn.microsoft.com/library/ms190782.aspx) and [SQL Injection](http://go.microsoft.com/fwlink/?LinkId=98234) in SQL Server Books Online</span></span>|<span data-ttu-id="c6c9c-148">Tematach opisano sposób tworzenia procedury składowane i jak działa iniekcja kodu SQL.</span><span class="sxs-lookup"><span data-stu-id="c6c9c-148">Topics describe how to create stored procedures and how SQL Injection works.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c6c9c-149">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="c6c9c-149">See Also</span></span>  
 [<span data-ttu-id="c6c9c-150">Zabezpieczanie aplikacji ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c6c9c-150">Securing ADO.NET Applications</span></span>](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)  
 [<span data-ttu-id="c6c9c-151">Przegląd zabezpieczeń serwera SQL</span><span class="sxs-lookup"><span data-stu-id="c6c9c-151">Overview of SQL Server Security</span></span>](../../../../../docs/framework/data/adonet/sql/overview-of-sql-server-security.md)  
 [<span data-ttu-id="c6c9c-152">Scenariusze zabezpieczeń aplikacji w programie SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6c9c-152">Application Security Scenarios in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/application-security-scenarios-in-sql-server.md)  
 [<span data-ttu-id="c6c9c-153">Zapisywanie Secure dynamiczne SQL w programie SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6c9c-153">Writing Secure Dynamic SQL in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/writing-secure-dynamic-sql-in-sql-server.md)  
 [<span data-ttu-id="c6c9c-154">Rejestrowanie procedur składowanych w programie SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6c9c-154">Signing Stored Procedures in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/signing-stored-procedures-in-sql-server.md)  
 [<span data-ttu-id="c6c9c-155">Dostosowywanie uprawnieniami personifikacja w programie SQL Server</span><span class="sxs-lookup"><span data-stu-id="c6c9c-155">Customizing Permissions with Impersonation in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server.md)  
 [<span data-ttu-id="c6c9c-156">Modyfikowanie danych w procedurach składowanych</span><span class="sxs-lookup"><span data-stu-id="c6c9c-156">Modifying Data with Stored Procedures</span></span>](../../../../../docs/framework/data/adonet/modifying-data-with-stored-procedures.md)  
 [<span data-ttu-id="c6c9c-157">ADO.NET zarządzanego dostawcy i zestawu danych w Centrum deweloperów</span><span class="sxs-lookup"><span data-stu-id="c6c9c-157">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
