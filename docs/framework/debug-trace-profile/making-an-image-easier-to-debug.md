---
title: Ułatwianie debugowania obrazu
ms.date: 03/30/2017
helpviewer_keywords:
- images [.NET Framework], debugging
- executable image for debugging
- debugging [.NET Framework], executable images for
ms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3
author: mairaw
ms.author: mairaw
ms.openlocfilehash: c58008bc621ea95fbb2e4cc5e7d4521576aca37c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
---
# <a name="making-an-image-easier-to-debug"></a><span data-ttu-id="baf77-102">Ułatwianie debugowania obrazu</span><span class="sxs-lookup"><span data-stu-id="baf77-102">Making an Image Easier to Debug</span></span>
<span data-ttu-id="baf77-103">Podczas kompilowania niezarządzanego kodu można za pomocą odpowiednich przełączników środowiska IDE lub opcji wiersza polecenia skonfigurować wykonywalny obraz na potrzeby debugowania.</span><span class="sxs-lookup"><span data-stu-id="baf77-103">When compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="baf77-104">Na przykład można użyć /**Zi** opcji wiersza polecenia w programie Visual C++ można zażądać Emituj debugowania plików symboli (.pdb rozszerzenia pliku).</span><span class="sxs-lookup"><span data-stu-id="baf77-104">For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb).</span></span> <span data-ttu-id="baf77-105">Podobnie /**Od** opcji wiersza polecenia informuje kompilator, aby wyłączyć optymalizacji.</span><span class="sxs-lookup"><span data-stu-id="baf77-105">Similarly, the /**Od** command-line option tells the compiler to disable optimization.</span></span> <span data-ttu-id="baf77-106">Powstały kod działa wolniej, ale w razie potrzeby łatwiej go debugować.</span><span class="sxs-lookup"><span data-stu-id="baf77-106">The resulting code runs more slowly, but is easier to debug, should this be necessary.</span></span>  
  
 <span data-ttu-id="baf77-107">Podczas kompilowania zarządzanego kodu środowiska .NET Framework kompilatory takie jak Visual C++, Visual Basic i C# kompilują program źródłowy do języka Microsoft Intermediate Language (MSIL).</span><span class="sxs-lookup"><span data-stu-id="baf77-107">When compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft Intermediate Language (MSIL).</span></span> <span data-ttu-id="baf77-108">Kod w języku MSIL tuż przed wykonaniem jest kompilowany dokładnie na czas do macierzystego kodu maszynowego.</span><span class="sxs-lookup"><span data-stu-id="baf77-108">MSIL is subsequently JIT-compiled, just before execution, into native machine code.</span></span> <span data-ttu-id="baf77-109">Podobnie jak w przypadku kodu niezarządzanego za pomocą odpowiednich przełączników środowiska IDE lub opcji wiersza polecenia można na potrzeby debugowania skonfigurować wykonywalny obraz.</span><span class="sxs-lookup"><span data-stu-id="baf77-109">As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="baf77-110">W bardzo podobny sposób można również skonfigurować kompilowanie dokładnie na czas (JIT) w celu debugowania.</span><span class="sxs-lookup"><span data-stu-id="baf77-110">In addition, you can configure the JIT compilation for debugging in much the same way.</span></span>  
  
 <span data-ttu-id="baf77-111">Taka konfiguracja JIT ma dwa aspekty:</span><span class="sxs-lookup"><span data-stu-id="baf77-111">This JIT configuration has two aspects:</span></span>  
  
-   <span data-ttu-id="baf77-112">W kompilatorze JIT można włączyć generowanie informacji ze śledzenia.</span><span class="sxs-lookup"><span data-stu-id="baf77-112">You can request the JIT-compiler to generate tracking information.</span></span> <span data-ttu-id="baf77-113">Po włączeniu tej opcji debuger może porównywać łańcuch kodu języka MSIL z jego odpowiednikiem w kodzie maszynowym oraz śledzić, gdzie są przechowywane lokalne zmienne i argumenty funkcji.</span><span class="sxs-lookup"><span data-stu-id="baf77-113">This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored.</span></span>  <span data-ttu-id="baf77-114">W programie .NET Framework w wersji 2.0 kompilator JIT zawsze generuje informacje ze śledzenia, dlatego nie trzeba specjalnie włączać takiej opcji.</span><span class="sxs-lookup"><span data-stu-id="baf77-114">In the .NET Framework version 2.0, the JIT compiler will always generate tracking information, so there is no need to request it.</span></span>  
  
-   <span data-ttu-id="baf77-115">W kompilatorze JIT można włączyć opcję braku optymalizacji powstającego kodu maszynowego.</span><span class="sxs-lookup"><span data-stu-id="baf77-115">You can request the JIT-compiler to not optimize the resulting machine code.</span></span>  
  
 <span data-ttu-id="baf77-116">Zwykle, kompilator generuje MSIL ustawia tych opcji kompilatora JIT, na podstawie przełączników IDE lub opcji wiersza polecenia można określić, na przykład /**Od**.</span><span class="sxs-lookup"><span data-stu-id="baf77-116">Normally, the compiler that generates the MSIL sets these JIT-compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**.</span></span>  
  
 <span data-ttu-id="baf77-117">Czasami trzeba zmienić zachowanie kompilatora JIT, tak aby generowany przez niego kod maszynowy był łatwiejszy do debugowania.</span><span class="sxs-lookup"><span data-stu-id="baf77-117">In some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug.</span></span> <span data-ttu-id="baf77-118">Na przykład warto wygenerować informacje ze śledzenia kompilatora JIT dla kompilacji detalicznej lub optymalizacji kontrolek.</span><span class="sxs-lookup"><span data-stu-id="baf77-118">For example, you might want to generate JIT tracking information for a retail build or control optimization.</span></span> <span data-ttu-id="baf77-119">Należy do tego celu użyć pliku inicjującego (.ini).</span><span class="sxs-lookup"><span data-stu-id="baf77-119">You can do so with an initialization (.ini) file.</span></span>  
  
 <span data-ttu-id="baf77-120">Jeśli na przykład zestaw, który ma być debugowany, nazywa się MyApp.exe, w folderze z plikiem MyApp.exe można utworzyć plik tekstowy o nazwie MyApp.ini zawierający poniższe trzy wiersze:</span><span class="sxs-lookup"><span data-stu-id="baf77-120">For example, if the assembly you want to debug is called MyApp.exe, then you can create a text file named MyApp.ini, in the same folder as MyApp.exe, which contains these three lines:</span></span>  
  
```  
[.NET Framework Debugging Control]  
GenerateTrackingInfo=1  
AllowOptimize=0  
```  
  
 <span data-ttu-id="baf77-121">Dla każdej opcji można ustawić wartość 0 lub 1. Każda niezdefiniowana opcja domyślnie przyjmuje wartość 0.</span><span class="sxs-lookup"><span data-stu-id="baf77-121">You can set the value of each option to 0 or 1, and any absent option defaults to 0.</span></span> <span data-ttu-id="baf77-122">Ustawienie w opcji `GenerateTrackingInfo` wartości 1 i w opcji `AllowOptimize` wartości 0 zapewni najłatwiejsze debugowanie.</span><span class="sxs-lookup"><span data-stu-id="baf77-122">Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="baf77-123">W programie .NET Framework w wersji 2.0 kompilator JIT zawsze generuje informacje ze śledzenia, niezależnie od wartości atrybutu `GenerateTrackingInfo`. Tym niemniej wartość `AllowOptimize` wciąż daje efekt.</span><span class="sxs-lookup"><span data-stu-id="baf77-123">In the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect.</span></span> <span data-ttu-id="baf77-124">Korzystając z [Ngen.exe (Generator obrazu natywnego)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) wstępnej kompilacji obrazu macierzystego bez optymalizacji, plik .ini musi znajdować się w folderze docelowym z `AllowOptimize=0` po wykonuje Ngen.exe.</span><span class="sxs-lookup"><span data-stu-id="baf77-124">When using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes.</span></span> <span data-ttu-id="baf77-125">Jeśli zostały wstępnie skompilowana zestawu bez optymalizacji, należy usunąć kod wstępnie skompilowana przy użyciu NGen.exe **/ uninstall** opcji przed uruchomienie Ngen.exe wstępnej kompilacji kodu, ponieważ zoptymalizowane.</span><span class="sxs-lookup"><span data-stu-id="baf77-125">If you have precompiled an assembly without optimization, you must remove the precompiled code using the NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized.</span></span> <span data-ttu-id="baf77-126">Jeśli w folderze nie ma pliku .ini, domyślnie program Ngen.exe wstępnie kompiluje kod z optymalizacją.</span><span class="sxs-lookup"><span data-stu-id="baf77-126">If the .ini file is not present in the folder, by default Ngen.exe precompiles the code as optimized.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="baf77-127">Klasa <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> kontroluje ustawienia zestawu.</span><span class="sxs-lookup"><span data-stu-id="baf77-127">The <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly.</span></span> <span data-ttu-id="baf77-128">**DebuggableAttribute** zawiera dwa pola, które rekordu ustawienia dla tego, czy przy użyciu kompilatora JIT powinien optymalizacji i/lub Generuj informacje o śledzeniu.</span><span class="sxs-lookup"><span data-stu-id="baf77-128">**DebuggableAttribute** includes two fields that record the settings for whether the JIT compiler should optimize, and/or generate tracking information.</span></span> <span data-ttu-id="baf77-129">W programie .NET Framework w wersji 2.0 kompilator JIT zawsze generuje informacje ze śledzenia.</span><span class="sxs-lookup"><span data-stu-id="baf77-129">In the .NET Framework version 2.0, the JIT compiler will always generate tracking information.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="baf77-130">Dla kompilację detalicznych kompilatory nie należy ustawiać żadnego **DebuggableAttribute**.</span><span class="sxs-lookup"><span data-stu-id="baf77-130">For a retail build, compilers do not set any **DebuggableAttribute**.</span></span> <span data-ttu-id="baf77-131">Domyślne zachowanie kompilatora JIT prowadzi do wygenerowaniu kodu maszynowego o najwyższej wydajności i najtrudniejszego do debugowania.</span><span class="sxs-lookup"><span data-stu-id="baf77-131">The JIT-compiler default behavior is to generate the highest performance, hardest to debug machine code.</span></span> <span data-ttu-id="baf77-132">Włączenie funkcji śledzenia w kompilatorze JIT obniża wydajność nieznacznie, natomiast wyłączenie optymalizacji zmniejsza ją wyraźnie.</span><span class="sxs-lookup"><span data-stu-id="baf77-132">Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="baf77-133">**DebuggableAttribute** ma zastosowanie do całego zestawu w czasie, a nie do poszczególnych modułów w zestawie.</span><span class="sxs-lookup"><span data-stu-id="baf77-133">The **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly.</span></span> <span data-ttu-id="baf77-134">Narzędzia deweloperskie w związku z tym należy dołączyć atrybutów niestandardowych do tokenu metadanych zestawu, jeśli zestawu została już utworzona, lub do klasy o nazwie **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span><span class="sxs-lookup"><span data-stu-id="baf77-134">Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span></span> <span data-ttu-id="baf77-135">Narzędzia ALink następnie propaguje je **DebuggableAttribute** atrybutów z poszczególnych modułów do zestawu stają się one częścią.</span><span class="sxs-lookup"><span data-stu-id="baf77-135">The ALink tool will then promote these **DebuggableAttribute** attributes from each module to the assembly they become a part of.</span></span> <span data-ttu-id="baf77-136">W razie istnienia konfliktu operacja ALink kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="baf77-136">If there is a conflict, the ALink operation will fail.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="baf77-137">W wersji 1.0 programu .NET Framework, dodaje kompilator Microsoft Visual C++ **DebuggableAttribute** podczas **/CLR** i **/zi** — opcje kompilatora zostały określone.</span><span class="sxs-lookup"><span data-stu-id="baf77-137">In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified.</span></span> <span data-ttu-id="baf77-138">W wersji 1.1 platformy .NET, należy dodać **DebugabbleAttribute** ręcznie w kodu lub użycie **/ASSEMBLYDEBUG** — opcja konsolidatora.</span><span class="sxs-lookup"><span data-stu-id="baf77-138">In version 1.1 of the .NET Framework, you must either add the **DebugabbleAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="baf77-139">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="baf77-139">See Also</span></span>  
 [<span data-ttu-id="baf77-140">Debugowanie, śledzenie i profilowanie</span><span class="sxs-lookup"><span data-stu-id="baf77-140">Debugging, Tracing, and Profiling</span></span>](../../../docs/framework/debug-trace-profile/index.md)  
 [<span data-ttu-id="baf77-141">Włączanie debugowania dołączania JIT</span><span class="sxs-lookup"><span data-stu-id="baf77-141">Enabling JIT-Attach Debugging</span></span>](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)  
 [<span data-ttu-id="baf77-142">Włączenie profilowania</span><span class="sxs-lookup"><span data-stu-id="baf77-142">Enabling Profiling</span></span>](http://msdn.microsoft.com/library/3b669676-f0e0-4ebf-8674-68986dd2020d)
