---
title: Ułatwianie debugowania na platformie .NET obrazu
description: Dowiedz się, jak skonfigurować wykonywalny obraz dla zmienia ułatwiają debugowanie przy użyciu środowiska IDE i opcje wiersza polecenia.
ms.date: 08/30/2018
helpviewer_keywords:
- images [.NET Framework], debugging
- executable image for debugging
- debugging [.NET Framework], executable images for
ms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 5bab707afb059d4fcbd46a9ee54edead991be523
ms.sourcegitcommit: 0c48191d6d641ce88d7510e319cf38c0e35697d0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/05/2019
ms.locfileid: "57362019"
---
# <a name="making-an-image-easier-to-debug-in-net"></a><span data-ttu-id="00f0f-103">Ułatwianie debugowania na platformie .NET obrazu</span><span class="sxs-lookup"><span data-stu-id="00f0f-103">Making an image easier to debug in .NET</span></span>

<span data-ttu-id="00f0f-104">Podczas kompilowania niezarządzanego kodu można za pomocą odpowiednich przełączników środowiska IDE lub opcji wiersza polecenia skonfigurować wykonywalny obraz na potrzeby debugowania.</span><span class="sxs-lookup"><span data-stu-id="00f0f-104">When compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="00f0f-105">Na przykład, można użyć /**Zi** opcji wiersza polecenia w programie Visual C++ można zażądać wyemitowania plików symboli debugowania (plików z rozszerzeniem .pdb).</span><span class="sxs-lookup"><span data-stu-id="00f0f-105">For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb).</span></span> <span data-ttu-id="00f0f-106">Podobnie /**Od** opcji wiersza polecenia informuje kompilator, aby wyłączyć optymalizację.</span><span class="sxs-lookup"><span data-stu-id="00f0f-106">Similarly, the /**Od** command-line option tells the compiler to disable optimization.</span></span> <span data-ttu-id="00f0f-107">Powstały kod działa wolniej, ale jest łatwiejszy do debugowania, w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="00f0f-107">The resulting code runs more slowly, but it's easier to debug, should this be necessary.</span></span>

<span data-ttu-id="00f0f-108">Podczas kompilowania .NET Framework kodu zarządzanego, kompilatory, takie jak Visual C++, Visual Basic i C# kompilują program źródłowy do języka Microsoft intermediate language (MSIL).</span><span class="sxs-lookup"><span data-stu-id="00f0f-108">When compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="00f0f-109">MSIL jest kompilowany dokładnie na czas, tuż przed wykonaniem do macierzystego kodu maszynowego.</span><span class="sxs-lookup"><span data-stu-id="00f0f-109">MSIL is then JIT-compiled, just before execution, into native machine code.</span></span> <span data-ttu-id="00f0f-110">Podobnie jak w przypadku kodu niezarządzanego za pomocą odpowiednich przełączników środowiska IDE lub opcji wiersza polecenia można na potrzeby debugowania skonfigurować wykonywalny obraz.</span><span class="sxs-lookup"><span data-stu-id="00f0f-110">As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="00f0f-111">Można również skonfigurować kompilację JIT dla debugowania w taki sam sposób.</span><span class="sxs-lookup"><span data-stu-id="00f0f-111">You can also configure the JIT compilation for debugging in much the same way.</span></span>

<span data-ttu-id="00f0f-112">Taka konfiguracja JIT ma dwa aspekty:</span><span class="sxs-lookup"><span data-stu-id="00f0f-112">This JIT configuration has two aspects:</span></span>

- <span data-ttu-id="00f0f-113">Możesz poprosić kompilator JIT, aby wygenerować informacje ze śledzenia.</span><span class="sxs-lookup"><span data-stu-id="00f0f-113">You can request the JIT compiler to generate tracking information.</span></span> <span data-ttu-id="00f0f-114">Po włączeniu tej opcji debuger może porównywać łańcuch kodu języka MSIL z jego odpowiednikiem w kodzie maszynowym oraz śledzić, gdzie są przechowywane lokalne zmienne i argumenty funkcji.</span><span class="sxs-lookup"><span data-stu-id="00f0f-114">This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored.</span></span> <span data-ttu-id="00f0f-115">Począwszy od programu .NET Framework w wersji 2.0 kompilator JIT zawsze generuje informacje ze śledzenia, więc nie trzeba wysłać żądanie.</span><span class="sxs-lookup"><span data-stu-id="00f0f-115">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information, so there is no need to request it.</span></span>

- <span data-ttu-id="00f0f-116">Możesz poprosić kompilator JIT braku optymalizacji powstającego kodu maszynowego.</span><span class="sxs-lookup"><span data-stu-id="00f0f-116">You can request the JIT compiler to not optimize the resulting machine code.</span></span>

<span data-ttu-id="00f0f-117">Normalnie, kompilator generujący kod w języku MSIL ustawia te opcje kompilatora JIT, na podstawie przełączników środowiska IDE lub opcji wiersza polecenia, które określisz, na przykład /**Od**.</span><span class="sxs-lookup"><span data-stu-id="00f0f-117">Normally, the compiler that generates the MSIL sets these JIT compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**.</span></span>

<span data-ttu-id="00f0f-118">Czasami trzeba zmienić zachowanie kompilatora JIT, tak aby generowany przez niego kod maszynowy był łatwiejszy do debugowania.</span><span class="sxs-lookup"><span data-stu-id="00f0f-118">In some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug.</span></span> <span data-ttu-id="00f0f-119">Na przykład warto wygenerować informacje ze śledzenia kompilatora JIT dla kompilacji detalicznej lub optymalizacji kontrolek.</span><span class="sxs-lookup"><span data-stu-id="00f0f-119">For example, you might want to generate JIT tracking information for a retail build or control optimization.</span></span> <span data-ttu-id="00f0f-120">Należy do tego celu użyć pliku inicjującego (.ini).</span><span class="sxs-lookup"><span data-stu-id="00f0f-120">You can do so with an initialization (.ini) file.</span></span>

<span data-ttu-id="00f0f-121">Na przykład, jeśli zestaw, który chcesz debugować jest nazywana *MyApp.exe*, możesz utworzyć plik tekstowy o nazwie *MyApp.ini*, w tym samym folderze co *MyApp.exe*, który zawiera te trzy wiersze:</span><span class="sxs-lookup"><span data-stu-id="00f0f-121">For example, if the assembly you want to debug is called *MyApp.exe*, then you can create a text file named *MyApp.ini*, in the same folder as *MyApp.exe*, which contains these three lines:</span></span>

```ini
[.NET Framework Debugging Control]
GenerateTrackingInfo=1
AllowOptimize=0
```

<span data-ttu-id="00f0f-122">Dla każdej opcji można ustawić wartość 0 lub 1. Każda niezdefiniowana opcja domyślnie przyjmuje wartość 0.</span><span class="sxs-lookup"><span data-stu-id="00f0f-122">You can set the value of each option to 0 or 1, and any absent option defaults to 0.</span></span> <span data-ttu-id="00f0f-123">Ustawienie w opcji `GenerateTrackingInfo` wartości 1 i w opcji `AllowOptimize` wartości 0 zapewni najłatwiejsze debugowanie.</span><span class="sxs-lookup"><span data-stu-id="00f0f-123">Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging.</span></span>

<span data-ttu-id="00f0f-124">Począwszy od programu .NET Framework w wersji 2.0 kompilator JIT zawsze generuje informacje ze śledzenia niezależnie od wartości `GenerateTrackingInfo`; jednak `AllowOptimize` wartość wciąż daje efekt.</span><span class="sxs-lookup"><span data-stu-id="00f0f-124">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect.</span></span> <span data-ttu-id="00f0f-125">Korzystając z [Ngen.exe (Generator obrazu natywnego)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) wstępnej kompilacji obrazu natywnego, bez optymalizacji, musi znajdować się w folderze docelowym przy użyciu pliku ini `AllowOptimize=0` kiedy wykonuje Ngen.exe.</span><span class="sxs-lookup"><span data-stu-id="00f0f-125">When using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes.</span></span> <span data-ttu-id="00f0f-126">Jeśli istnieje wstępnie skompilowany zestaw bez optymalizacji, należy usunąć wstępnie skompilowany kod za pomocą NGen.exe **/ uninstall** możliwość przed ponownym uruchomieniu Ngen.exe wstępnie skompilować kod jako zoptymalizowany.</span><span class="sxs-lookup"><span data-stu-id="00f0f-126">If you have precompiled an assembly without optimization, you must remove the precompiled code using NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized.</span></span> <span data-ttu-id="00f0f-127">Jeśli plik .ini nie jest obecny w folderze, domyślnie Ngen.exe wstępnie kompiluje kod z optymalizacją.</span><span class="sxs-lookup"><span data-stu-id="00f0f-127">If the .ini file isn't present in the folder, by default Ngen.exe precompiles the code as optimized.</span></span>

<span data-ttu-id="00f0f-128">Klasa <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> kontroluje ustawienia zestawu.</span><span class="sxs-lookup"><span data-stu-id="00f0f-128">The <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly.</span></span> <span data-ttu-id="00f0f-129">**DebuggableAttribute** zawiera dwa pola tę kontrolkę, czy kompilator JIT należy zoptymalizować i/lub generować informacje ze śledzenia.</span><span class="sxs-lookup"><span data-stu-id="00f0f-129">**DebuggableAttribute** includes two fields that control whether the JIT compiler should optimize and/or generate tracking information.</span></span> <span data-ttu-id="00f0f-130">Począwszy od programu .NET Framework w wersji 2.0 kompilator JIT zawsze generuje informacje ze śledzenia.</span><span class="sxs-lookup"><span data-stu-id="00f0f-130">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information.</span></span>

<span data-ttu-id="00f0f-131">Dla kompilacji detalicznej kompilatory nie ustawiają żadnej **DebuggableAttribute**.</span><span class="sxs-lookup"><span data-stu-id="00f0f-131">For a retail build, compilers don't set any **DebuggableAttribute**.</span></span> <span data-ttu-id="00f0f-132">Domyślnie kompilator JIT generuje o najwyższej wydajności i najtrudniejszego do debugowania kodu maszynowego.</span><span class="sxs-lookup"><span data-stu-id="00f0f-132">By default, the JIT compiler generates the highest performance, hardest to debug machine code.</span></span> <span data-ttu-id="00f0f-133">Włączenie funkcji śledzenia w kompilatorze JIT obniża wydajność nieznacznie, natomiast wyłączenie optymalizacji zmniejsza ją wyraźnie.</span><span class="sxs-lookup"><span data-stu-id="00f0f-133">Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.</span></span>

<span data-ttu-id="00f0f-134">**DebuggableAttribute** ma zastosowanie do całego zestawu w czasie, a nie do poszczególnych modułów w zestawie.</span><span class="sxs-lookup"><span data-stu-id="00f0f-134">The **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly.</span></span> <span data-ttu-id="00f0f-135">Narzędzia programistyczne w związku z tym muszą dołączać niestandardowe atrybuty do tokenu metadanych zestawu, jeśli zestawu została już utworzona, lub do klasy o nazwie **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span><span class="sxs-lookup"><span data-stu-id="00f0f-135">Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span></span> <span data-ttu-id="00f0f-136">Te promuje następnie narzędzie ALink **DebuggableAttribute** atrybuty z każdego modułu do zestawu staną się częścią.</span><span class="sxs-lookup"><span data-stu-id="00f0f-136">The ALink tool then promotes these **DebuggableAttribute** attributes from each module to the assembly they become a part of.</span></span> <span data-ttu-id="00f0f-137">W przypadku konfliktu operacja ALink kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="00f0f-137">If there's a conflict, the ALink operation fails.</span></span>

> [!NOTE]
> <span data-ttu-id="00f0f-138">W programie .NET Framework w wersji 1.0 kompilator Microsoft Visual C++ dodaje **DebuggableAttribute** podczas **/CLR** i **/zi** określono opcje kompilatora.</span><span class="sxs-lookup"><span data-stu-id="00f0f-138">In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified.</span></span> <span data-ttu-id="00f0f-139">W wersji 1.1 programu .NET Framework, należy dodać **DebuggableAttribute** ręcznie w kodzie albo użyć **/assemblydebug** — opcja konsolidatora.</span><span class="sxs-lookup"><span data-stu-id="00f0f-139">In version 1.1 of the .NET Framework, you must either add the **DebuggableAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.</span></span>

## <a name="see-also"></a><span data-ttu-id="00f0f-140">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="00f0f-140">See also</span></span>

- [<span data-ttu-id="00f0f-141">Debugowanie, śledzenie i profilowanie</span><span class="sxs-lookup"><span data-stu-id="00f0f-141">Debugging, Tracing, and Profiling</span></span>](../../../docs/framework/debug-trace-profile/index.md)
- [<span data-ttu-id="00f0f-142">Włączanie debugowania dołączania JIT</span><span class="sxs-lookup"><span data-stu-id="00f0f-142">Enabling JIT-Attach Debugging</span></span>](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)
- <span data-ttu-id="00f0f-143">[Włączanie profilowania](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="00f0f-143">[Enabling Profiling](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span></span>
