---
title: Łatwiejsze debugowanie obrazu w programie .NET
description: Informacje o konfigurowaniu obrazu wykonywalnego w celu łatwiejszego debugowania przy użyciu przełączników IDE i opcji wiersza polecenia.
ms.date: 08/30/2018
helpviewer_keywords:
- images [.NET Framework], debugging
- executable image for debugging
- debugging [.NET Framework], executable images for
ms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3
ms.openlocfilehash: a3305dc864e7852c2336009503732a51868410d2
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/15/2020
ms.locfileid: "90558514"
---
# <a name="making-an-image-easier-to-debug-in-net"></a><span data-ttu-id="22d69-103">Łatwiejsze debugowanie obrazu w programie .NET</span><span class="sxs-lookup"><span data-stu-id="22d69-103">Making an image easier to debug in .NET</span></span>

<span data-ttu-id="22d69-104">Podczas kompilowania niezarządzanego kodu można za pomocą odpowiednich przełączników środowiska IDE lub opcji wiersza polecenia skonfigurować wykonywalny obraz na potrzeby debugowania.</span><span class="sxs-lookup"><span data-stu-id="22d69-104">When compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="22d69-105">Na przykład można użyć opcji wiersza polecenia/**Zi** w Visual C++, aby zażądać jej do emitowania plików symboli debugowania (rozszerzenie pliku. pdb).</span><span class="sxs-lookup"><span data-stu-id="22d69-105">For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb).</span></span> <span data-ttu-id="22d69-106">Podobnie opcja wiersza polecenia/**od** instruuje kompilator, aby wyłączył optymalizację.</span><span class="sxs-lookup"><span data-stu-id="22d69-106">Similarly, the /**Od** command-line option tells the compiler to disable optimization.</span></span> <span data-ttu-id="22d69-107">Otrzymany kod działa wolniej, ale w razie potrzeby jest łatwiejszy do debugowania.</span><span class="sxs-lookup"><span data-stu-id="22d69-107">The resulting code runs more slowly, but it's easier to debug, should this be necessary.</span></span>

<span data-ttu-id="22d69-108">Podczas kompilowania .NET Framework kodu zarządzanego, kompilatory, takie jak Visual C++, Visual Basic i C# kompilują swój program źródłowy do języka pośredniego firmy Microsoft (MSIL).</span><span class="sxs-lookup"><span data-stu-id="22d69-108">When compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="22d69-109">KOMPILATOR MSIL jest następnie kompilowany przed wykonaniem w kodzie macierzystym.</span><span class="sxs-lookup"><span data-stu-id="22d69-109">MSIL is then JIT-compiled, just before execution, into native machine code.</span></span> <span data-ttu-id="22d69-110">Podobnie jak w przypadku kodu niezarządzanego za pomocą odpowiednich przełączników środowiska IDE lub opcji wiersza polecenia można na potrzeby debugowania skonfigurować wykonywalny obraz.</span><span class="sxs-lookup"><span data-stu-id="22d69-110">As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="22d69-111">Możesz również skonfigurować kompilację JIT w taki sam sposób, jak w przypadku debugowania.</span><span class="sxs-lookup"><span data-stu-id="22d69-111">You can also configure the JIT compilation for debugging in much the same way.</span></span>

<span data-ttu-id="22d69-112">Taka konfiguracja JIT ma dwa aspekty:</span><span class="sxs-lookup"><span data-stu-id="22d69-112">This JIT configuration has two aspects:</span></span>

- <span data-ttu-id="22d69-113">Możesz zażądać kompilatora JIT, aby generować informacje o śledzeniu.</span><span class="sxs-lookup"><span data-stu-id="22d69-113">You can request the JIT compiler to generate tracking information.</span></span> <span data-ttu-id="22d69-114">Po włączeniu tej opcji debuger może porównywać łańcuch kodu języka MSIL z jego odpowiednikiem w kodzie maszynowym oraz śledzić, gdzie są przechowywane lokalne zmienne i argumenty funkcji.</span><span class="sxs-lookup"><span data-stu-id="22d69-114">This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored.</span></span> <span data-ttu-id="22d69-115">Począwszy od .NET Framework w wersji 2,0 kompilator JIT zawsze generuje informacje śledzenia, więc nie ma potrzeby żądania.</span><span class="sxs-lookup"><span data-stu-id="22d69-115">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information, so there is no need to request it.</span></span>

- <span data-ttu-id="22d69-116">Można zażądać kompilatora JIT, aby nie optymalizować powstającego kodu maszynowego.</span><span class="sxs-lookup"><span data-stu-id="22d69-116">You can request the JIT compiler to not optimize the resulting machine code.</span></span>

<span data-ttu-id="22d69-117">Zwykle kompilator generujący MSIL ustawia te opcje kompilatora JIT odpowiednio na podstawie przełączników IDE lub opcji wiersza polecenia, które określisz, na przykład,/**od**.</span><span class="sxs-lookup"><span data-stu-id="22d69-117">Normally, the compiler that generates the MSIL sets these JIT compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**.</span></span>

<span data-ttu-id="22d69-118">Czasami trzeba zmienić zachowanie kompilatora JIT, tak aby generowany przez niego kod maszynowy był łatwiejszy do debugowania.</span><span class="sxs-lookup"><span data-stu-id="22d69-118">In some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug.</span></span> <span data-ttu-id="22d69-119">Na przykład warto wygenerować informacje ze śledzenia kompilatora JIT dla kompilacji detalicznej lub optymalizacji kontrolek.</span><span class="sxs-lookup"><span data-stu-id="22d69-119">For example, you might want to generate JIT tracking information for a retail build or control optimization.</span></span> <span data-ttu-id="22d69-120">Należy do tego celu użyć pliku inicjującego (.ini).</span><span class="sxs-lookup"><span data-stu-id="22d69-120">You can do so with an initialization (.ini) file.</span></span>

<span data-ttu-id="22d69-121">Na przykład jeśli zestaw, który ma być debugowany, jest nazywany *MyApp.exe*, można utworzyć plik tekstowy o nazwie *MyApp.ini*w tym samym folderze, w którym znajduje się *MyApp.exe*, który zawiera następujące trzy wiersze:</span><span class="sxs-lookup"><span data-stu-id="22d69-121">For example, if the assembly you want to debug is called *MyApp.exe*, then you can create a text file named *MyApp.ini*, in the same folder as *MyApp.exe*, which contains these three lines:</span></span>

```ini
[.NET Framework Debugging Control]
GenerateTrackingInfo=1
AllowOptimize=0
```

<span data-ttu-id="22d69-122">Dla każdej opcji można ustawić wartość 0 lub 1. Każda niezdefiniowana opcja domyślnie przyjmuje wartość 0.</span><span class="sxs-lookup"><span data-stu-id="22d69-122">You can set the value of each option to 0 or 1, and any absent option defaults to 0.</span></span> <span data-ttu-id="22d69-123">Ustawienie w opcji `GenerateTrackingInfo` wartości 1 i w opcji `AllowOptimize` wartości 0 zapewni najłatwiejsze debugowanie.</span><span class="sxs-lookup"><span data-stu-id="22d69-123">Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging.</span></span>

<span data-ttu-id="22d69-124">Począwszy od .NET Framework w wersji 2,0, kompilator JIT zawsze generuje informacje o śledzeniu niezależnie od wartości `GenerateTrackingInfo` , jednak `AllowOptimize` nadal ma efekt.</span><span class="sxs-lookup"><span data-stu-id="22d69-124">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect.</span></span> <span data-ttu-id="22d69-125">W przypadku korzystania z [Ngen.exe (Generator obrazu natywnego)](../tools/ngen-exe-native-image-generator.md) do wstępnego kompilowania obrazu natywnego bez optymalizacji, plik. ini musi znajdować się w folderze docelowym, `AllowOptimize=0` gdy jest wykonywana Ngen.exe.</span><span class="sxs-lookup"><span data-stu-id="22d69-125">When using the [Ngen.exe (Native Image Generator)](../tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes.</span></span> <span data-ttu-id="22d69-126">Jeśli wstępnie skompilowano zestaw bez optymalizacji, należy usunąć wstępnie skompilowany kod przy użyciu opcji NGen.exe **/Uninstall** przed ponownym uruchomieniem Ngen.exe, aby wstępnie skompilować kod jako zoptymalizowany.</span><span class="sxs-lookup"><span data-stu-id="22d69-126">If you have precompiled an assembly without optimization, you must remove the precompiled code using NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized.</span></span> <span data-ttu-id="22d69-127">Jeśli plik. ini nie znajduje się w folderze, domyślnie Ngen.exe wstępnie kompiluje kod jako zoptymalizowany.</span><span class="sxs-lookup"><span data-stu-id="22d69-127">If the .ini file isn't present in the folder, by default Ngen.exe precompiles the code as optimized.</span></span>

<span data-ttu-id="22d69-128">Klasa <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> kontroluje ustawienia zestawu.</span><span class="sxs-lookup"><span data-stu-id="22d69-128">The <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly.</span></span> <span data-ttu-id="22d69-129">**DebuggableAttribute** zawiera dwa pola, które kontrolują, czy kompilator JIT powinien optymalizować i/lub generować informacje śledzenia.</span><span class="sxs-lookup"><span data-stu-id="22d69-129">**DebuggableAttribute** includes two fields that control whether the JIT compiler should optimize and/or generate tracking information.</span></span> <span data-ttu-id="22d69-130">Począwszy od .NET Framework w wersji 2,0 kompilator JIT zawsze generuje informacje o śledzeniu.</span><span class="sxs-lookup"><span data-stu-id="22d69-130">Starting with the .NET Framework version 2.0, the JIT compiler always generates tracking information.</span></span>

<span data-ttu-id="22d69-131">W przypadku kompilacji detalicznej kompilatory nie ustawiają żadnych **DebuggableAttribute**.</span><span class="sxs-lookup"><span data-stu-id="22d69-131">For a retail build, compilers don't set any **DebuggableAttribute**.</span></span> <span data-ttu-id="22d69-132">Domyślnie kompilator JIT generuje najwyższy poziom wydajności, najtrudniejszy do debugowania kod maszynowy.</span><span class="sxs-lookup"><span data-stu-id="22d69-132">By default, the JIT compiler generates the highest performance, hardest to debug machine code.</span></span> <span data-ttu-id="22d69-133">Włączenie funkcji śledzenia w kompilatorze JIT obniża wydajność nieznacznie, natomiast wyłączenie optymalizacji zmniejsza ją wyraźnie.</span><span class="sxs-lookup"><span data-stu-id="22d69-133">Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.</span></span>

<span data-ttu-id="22d69-134">**DebuggableAttribute** dotyczy całego zestawu jednocześnie, a nie do poszczególnych modułów w ramach zestawu.</span><span class="sxs-lookup"><span data-stu-id="22d69-134">The **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly.</span></span> <span data-ttu-id="22d69-135">Narzędzia programistyczne muszą w związku z tym dołączać atrybuty niestandardowe do tokenu metadanych zestawu, jeśli zestaw został już utworzony, lub do klasy o nazwie **System. Runtime. CompilerServices. AssemblyAttributesGoHere**.</span><span class="sxs-lookup"><span data-stu-id="22d69-135">Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span></span> <span data-ttu-id="22d69-136">Narzędzie ALink następnie promuje te atrybuty **DebuggableAttribute** z każdego modułu do zestawu, do którego należy.</span><span class="sxs-lookup"><span data-stu-id="22d69-136">The ALink tool then promotes these **DebuggableAttribute** attributes from each module to the assembly they become a part of.</span></span> <span data-ttu-id="22d69-137">W razie wystąpienia konfliktu operacja ALink kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="22d69-137">If there's a conflict, the ALink operation fails.</span></span>

> [!NOTE]
> <span data-ttu-id="22d69-138">W wersji 1,0 .NET Framework, kompilator Microsoft Visual C++ dodaje **DebuggableAttribute** , gdy są określone opcje kompilatora **/CLR** i **/Zi** .</span><span class="sxs-lookup"><span data-stu-id="22d69-138">In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified.</span></span> <span data-ttu-id="22d69-139">W wersji 1,1 .NET Framework należy ręcznie dodać **DebuggableAttribute** w kodzie lub użyć opcji konsolidatora **/ASSEMBLYDEBUG** .</span><span class="sxs-lookup"><span data-stu-id="22d69-139">In version 1.1 of the .NET Framework, you must either add the **DebuggableAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.</span></span>

## <a name="see-also"></a><span data-ttu-id="22d69-140">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="22d69-140">See also</span></span>

- [<span data-ttu-id="22d69-141">Debugowanie, śledzenie i profilowanie</span><span class="sxs-lookup"><span data-stu-id="22d69-141">Debugging, Tracing, and Profiling</span></span>](index.md)
- [<span data-ttu-id="22d69-142">Włączanie debugowania dołączania JIT</span><span class="sxs-lookup"><span data-stu-id="22d69-142">Enabling JIT-Attach Debugging</span></span>](enabling-jit-attach-debugging.md)
- <span data-ttu-id="22d69-143">[Włączanie profilowania](/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="22d69-143">[Enabling Profiling](/previous-versions/dotnet/netframework-4.0/s5ec0es1(v=vs.100))</span></span>
