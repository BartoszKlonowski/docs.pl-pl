---
title: Liczniki wydajności i wewnątrzprocesowe, równoczesne aplikacje
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- performance counters
- performance counters,and in-process side-by-side applications
- performance,.NET Framework applications
- performance monitoring,counters
ms.assetid: 6888f9be-c65b-4b03-a07b-df7ebdee2436
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: bf8a5a7c97969fb0018bb1dba4ea027fe7afd2c9
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
---
# <a name="performance-counters-and-in-process-side-by-side-applications"></a><span data-ttu-id="9bdc9-102">Liczniki wydajności i wewnątrzprocesowe, równoczesne aplikacje</span><span class="sxs-lookup"><span data-stu-id="9bdc9-102">Performance Counters and In-Process Side-By-Side Applications</span></span>
<span data-ttu-id="9bdc9-103">Korzystanie z Monitora wydajności (Perfmon.exe), jest możliwe do odróżnienia liczników wydajności na podstawie na środowiska wykonawczego.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-103">Using the Performance Monitor (Perfmon.exe), it is possible to differentiate the performance counters on a per-runtime basis.</span></span> <span data-ttu-id="9bdc9-104">W tym temacie opisano zmiany rejestru wymagane do włączenia tej funkcji.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-104">This topic describes the registry change needed to enable this functionality.</span></span>  
  
## <a name="the-default-behavior"></a><span data-ttu-id="9bdc9-105">Domyślne zachowanie</span><span class="sxs-lookup"><span data-stu-id="9bdc9-105">The Default Behavior</span></span>  
 <span data-ttu-id="9bdc9-106">Domyślnie Monitor wydajności Wyświetla liczniki wydajności na podstawie określonych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-106">By default, the Performance Monitor displays performance counters on a per-application basis.</span></span> <span data-ttu-id="9bdc9-107">Istnieją dwa scenariusze, w których jest to powodować problemy:</span><span class="sxs-lookup"><span data-stu-id="9bdc9-107">However, there are two scenarios in which this is problematic:</span></span>  
  
-   <span data-ttu-id="9bdc9-108">Podczas monitorowania dwóch aplikacji, które mają taką samą nazwę.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-108">When you monitor two applications that have the same name.</span></span> <span data-ttu-id="9bdc9-109">Na przykład, jeśli obie aplikacje są nazywane myapp.exe, zostanie wyświetlony jeden jako **moja_aplikacja** i inne, **moja_aplikacja #1** w **wystąpienia** kolumny.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-109">For example, if both applications are named myapp.exe, one will be displayed as **myapp** and the other as **myapp#1** in the **Instance** column.</span></span> <span data-ttu-id="9bdc9-110">W tym przypadku jest trudne do dopasowania licznik wydajności do określonej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-110">In this case, it is difficult to match a performance counter to a particular application.</span></span> <span data-ttu-id="9bdc9-111">Nie jest jasne, czy dane są zbierane dla **moja_aplikacja #1** odwołuje się do myapp.exe pierwszy lub drugi myapp.exe.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-111">It is not clear whether the data collected for **myapp#1** refers to the first myapp.exe or the second myapp.exe.</span></span>  
  
-   <span data-ttu-id="9bdc9-112">Jeśli aplikacja używa wielu wystąpień środowiska CLR.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-112">When an application uses multiple instances of the common language runtime.</span></span> <span data-ttu-id="9bdc9-113">[!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] Obsługuje scenariusze hostingu side-by-side wewnątrzprocesowe; oznacza to, jednego procesu lub aplikacji można załadować wiele wystąpień środowiska CLR.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-113">The [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)] supports in-process side-by-side hosting scenarios; that is, a single process or application can load multiple instances of the common language runtime.</span></span> <span data-ttu-id="9bdc9-114">Jeśli pojedynczej aplikacji o nazwie obciążeń myapp.exe dwa wystąpienia środowiska wykonawczego, domyślnie zostanie one określony w **wystąpienia** jako kolumny **moja_aplikacja** i **moja_aplikacja #1**.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-114">If a single application named myapp.exe loads two runtime instances, by default, they will be designated in the **Instance** column as **myapp** and **myapp#1**.</span></span> <span data-ttu-id="9bdc9-115">W takim przypadku nie jest jasne, czy **moja_aplikacja** i **moja_aplikacja #1** odnosić się do dwóch aplikacji o takiej samej nazwie lub do tej samej aplikacji z dwóch środowisk uruchomieniowych.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-115">In this case, it is not clear whether **myapp** and **myapp#1** refer to two applications with the same name, or to the same application with two runtimes.</span></span> <span data-ttu-id="9bdc9-116">Jeśli wiele aplikacji o takiej samej nazwie załadować wiele środowisk uruchomieniowych, niejednoznaczności jest jeszcze bardziej znaczące.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-116">If multiple applications with the same name load multiple runtimes, the ambiguity is even greater.</span></span>  
  
 <span data-ttu-id="9bdc9-117">Można ustawić klucz rejestru, aby usunąć tę niejednoznaczność.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-117">You can set a registry key to eliminate this ambiguity.</span></span> <span data-ttu-id="9bdc9-118">W przypadku aplikacji utworzony przy użyciu [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], tej zmiany rejestru dodaje identyfikator procesu, następuje identyfikator wystąpienia środowiska uruchomieniowego na nazwę aplikacji w **wystąpienia** kolumny.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-118">For applications developed using the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], this registry change adds a process identifier followed by a runtime instance identifier to the application name in the **Instance** column.</span></span> <span data-ttu-id="9bdc9-119">Zamiast *aplikacji* lub *aplikacji*#1 aplikacja jest teraz identyfikowane jako *aplikacji*_`p`*processID* \_ `r` *runtimeID* w **wystąpienia** kolumny.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-119">Instead of *application* or *application*#1, the application is now identified as *application*_`p`*processID*\_`r`*runtimeID* in the **Instance** column.</span></span> <span data-ttu-id="9bdc9-120">Jeśli aplikacja została opracowana za pomocą poprzedniej wersji środowiska CLR, to wystąpienie jest reprezentowany jako *aplikacji\_*`p`*processID* pod warunkiem, że [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] jest zainstalowany.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-120">If an application was developed using a previous version of the common language runtime, that instance is represented as *application\_*`p`*processID* provided that the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed.</span></span>  
  
## <a name="performance-counters-for-in-process-side-by-side-applications"></a><span data-ttu-id="9bdc9-121">Liczniki wydajności dla aplikacji Side-by-Side w procesie</span><span class="sxs-lookup"><span data-stu-id="9bdc9-121">Performance Counters for In-Process Side-by-Side Applications</span></span>  
 <span data-ttu-id="9bdc9-122">Do obsługi liczniki wydajności dla wielu wspólnego języka środowiska uruchomieniowego wersji, które znajdują się w jednej aplikacji, należy zmienić klucz rejestru pojedynczego ustawienie, jak pokazano w poniższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-122">To handle performance counters for multiple common language runtime versions that are hosted in a single application, you must change a single registry key setting, as shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9bdc9-123">Nazwa klucza</span><span class="sxs-lookup"><span data-stu-id="9bdc9-123">Key name</span></span>|<span data-ttu-id="9bdc9-124">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\\. NETFramework\Performance</span><span class="sxs-lookup"><span data-stu-id="9bdc9-124">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span></span>|  
|<span data-ttu-id="9bdc9-125">Nazwa wartości</span><span class="sxs-lookup"><span data-stu-id="9bdc9-125">Value name</span></span>|<span data-ttu-id="9bdc9-126">ProcessNameFormat</span><span class="sxs-lookup"><span data-stu-id="9bdc9-126">ProcessNameFormat</span></span>|  
|<span data-ttu-id="9bdc9-127">Typ wartości</span><span class="sxs-lookup"><span data-stu-id="9bdc9-127">Value type</span></span>|<span data-ttu-id="9bdc9-128">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="9bdc9-128">REG_DWORD</span></span>|  
|<span data-ttu-id="9bdc9-129">Wartość</span><span class="sxs-lookup"><span data-stu-id="9bdc9-129">Value</span></span>|<span data-ttu-id="9bdc9-130">1 (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="9bdc9-130">1 (0x00000001)</span></span>|  
  
 <span data-ttu-id="9bdc9-131">Wartość 0 dla `ProcessNameFormat` wskazuje, że jest włączona domyślnie; będący Perfmon.exe wyświetla liczniki wydajności na podstawie określonych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-131">A value of 0 for `ProcessNameFormat` indicates that the default behavior is enabled; that is, Perfmon.exe displays performance counters on a per-application basis.</span></span> <span data-ttu-id="9bdc9-132">Gdy ta wartość jest ustawiona na 1, Perfmon.exe pozwala odróżnić od siebie wiele wersji aplikacji i zawiera liczników wydajności na podstawie na środowiska wykonawczego.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-132">When you set this value to 1, Perfmon.exe disambiguates multiple versions of an application and provides performance counters on a per-runtime basis.</span></span> <span data-ttu-id="9bdc9-133">Wszystkie inne wartości `ProcessNameFormat` ustawienie klucza rejestru jest nieobsługiwane i zarezerwowane do użytku w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-133">Any other value for the `ProcessNameFormat` registry key setting is unsupported and reserved for future use.</span></span>  
  
 <span data-ttu-id="9bdc9-134">Po zaktualizowaniu `ProcessNameFormat` klucza rejestru ustawienie, musisz ponownie uruchomić Perfmon.exe lub innym klientom liczników wydajności, aby nowa funkcja nazewnictwa wystąpienia działa prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-134">After you update the `ProcessNameFormat` registry key setting, you must restart Perfmon.exe or any other consumers of performance counters so that the new instance naming feature works correctly.</span></span>  
  
 <span data-ttu-id="9bdc9-135">Poniższy przykład przedstawia sposób zmiany `ProcessNameFormat` wartość programowo.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-135">The following example shows how to change the `ProcessNameFormat` value programmatically.</span></span>  
  
 [!code-csharp[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/cs/regsetting1.cs#1)]
 [!code-vb[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/vb/regsetting1.vb#1)]  
  
 <span data-ttu-id="9bdc9-136">Po wprowadzeniu tej zmiany w rejestrze Perfmon.exe wyświetla nazwy aplikacji przeznaczonych [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] jako *aplikacji*_`p`*processID* \_ `r` *runtimeID*, gdzie *aplikacji* jest nazwa aplikacji, *processID* jest identyfikatora procesu aplikacji, a  *runtimeID* jest identyfikatorem środowiska uruchomieniowego języka wspólnego.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-136">When you make this registry change, Perfmon.exe displays the names of applications that target the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] as *application*_`p`*processID*\_`r`*runtimeID*, where *application* is the name of the application, *processID* is the application's process identifier, and *runtimeID* is a common language runtime identifier.</span></span> <span data-ttu-id="9bdc9-137">Na przykład jeśli aplikacja o nazwie obciążeń myapp.exe dwa wystąpienia środowisko uruchomieniowe języka wspólnego, Perfmon.exe może zidentyfikować jedno wystąpienie jako myapp_p1416_r10, a drugi jako myapp_p3160_r10.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-137">For example, if an application named myapp.exe loads two instances of the common language runtime, Perfmon.exe may identify one instance as myapp_p1416_r10 and the second as myapp_p3160_r10.</span></span> <span data-ttu-id="9bdc9-138">Identyfikator środowiska uruchomieniowego tylko pozwala odróżnić od siebie środowisk uruchomieniowych w ramach procesu; nie ma innych informacji dotyczących środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-138">The runtime identifier only disambiguates the runtimes within a process; it does not provide any other information about the runtime.</span></span> <span data-ttu-id="9bdc9-139">(Na przykład identyfikator działania ma relacja wersji lub wersji środowiska uruchomieniowego).</span><span class="sxs-lookup"><span data-stu-id="9bdc9-139">(For example, the runtime ID has no relation to the version or the SKU of the runtime.)</span></span>  
  
 <span data-ttu-id="9bdc9-140">Jeśli [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] jest zainstalowany, zmiany w rejestrze również wpływa na aplikacje, które zostały opracowane za pomocą wcześniejszych wersji programu .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-140">If the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is installed, the registry change also affects applications that were developed using earlier versions of the .NET Framework.</span></span> <span data-ttu-id="9bdc9-141">Są one wyświetlane w Perfmon.exe jako *application_*`p`*processID*, gdzie *aplikacji* to nazwa aplikacji i *processID* jest identyfikatorem procesu.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-141">These appear in Perfmon.exe as *application_*`p`*processID*, where *application* is the application name and *processID* is the process identifier.</span></span> <span data-ttu-id="9bdc9-142">Na przykład jeśli liczniki wydajności z dwóch aplikacji o nazwie myapp.exe są monitorowane, co może być wyświetlany jako myapp_p23900, a drugi jako myapp_p24908.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-142">For example, if the performance counters of two applications named myapp.exe are monitored, one might appear as myapp_p23900 and the other as myapp_p24908.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9bdc9-143">Identyfikator procesu eliminuje niejednoznaczności rozpoznawania dwóch aplikacji o takiej samej nazwie, korzystających z wcześniejszych wersji środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-143">The process identifier eliminates the ambiguity of resolving two applications with the same name that use earlier versions of the runtime.</span></span> <span data-ttu-id="9bdc9-144">Identyfikator środowiska uruchomieniowego nie jest wymagana w poprzednich wersjach, ponieważ poprzednie wersje środowiska CLR nie obsługują side-by-side scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-144">A runtime identifier is not required for previous versions, because previous versions of the common language runtime do not support side-by-side scenarios.</span></span>  
  
 <span data-ttu-id="9bdc9-145">Jeśli [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] nie istnieje lub została odinstalowana, ustawienie klucza rejestru nie ma wpływu.</span><span class="sxs-lookup"><span data-stu-id="9bdc9-145">If the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] is not present or was uninstalled, setting the registry key has no effect.</span></span> <span data-ttu-id="9bdc9-146">Oznacza to, że dwie aplikacje o tej samej nazwie będą nadal wyświetlane w Perfmon.exe jako *aplikacji* i *aplikacji #1* (na przykład jako **moja_aplikacja** i **moja_aplikacja #1**).</span><span class="sxs-lookup"><span data-stu-id="9bdc9-146">This means that two applications with the same name will continue to appear in Perfmon.exe as *application* and *application#1* (for example, as **myapp** and **myapp#1**).</span></span>
