---
title: Liczniki wydajności i wewnątrzprocesowe, równoczesne aplikacje
description: Przejrzyj liczniki wydajności i wewnątrzprocesowe aplikacje równoległe w programie .NET. Użyj Perfmon.exe, aby odróżnić liczniki wydajności dla każdego środowiska uruchomieniowego.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- performance counters
- performance counters,and in-process side-by-side applications
- performance,.NET Framework applications
- performance monitoring,counters
ms.assetid: 6888f9be-c65b-4b03-a07b-df7ebdee2436
ms.openlocfilehash: a40cc1d318fbca3feca89431ce18d18d2e5c3e9f
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/26/2020
ms.locfileid: "96254522"
---
# <a name="performance-counters-and-in-process-side-by-side-applications"></a><span data-ttu-id="4a424-104">Liczniki wydajności i wewnątrzprocesowe, równoczesne aplikacje</span><span class="sxs-lookup"><span data-stu-id="4a424-104">Performance Counters and In-Process Side-By-Side Applications</span></span>

<span data-ttu-id="4a424-105">Korzystając z monitora wydajności (Perfmon.exe), istnieje możliwość odróżnienia liczników wydajności na podstawie czasu wykonywania.</span><span class="sxs-lookup"><span data-stu-id="4a424-105">Using the Performance Monitor (Perfmon.exe), it is possible to differentiate the performance counters on a per-runtime basis.</span></span> <span data-ttu-id="4a424-106">W tym temacie opisano zmianę rejestru wymaganą do włączenia tej funkcji.</span><span class="sxs-lookup"><span data-stu-id="4a424-106">This topic describes the registry change needed to enable this functionality.</span></span>  
  
## <a name="the-default-behavior"></a><span data-ttu-id="4a424-107">Zachowanie domyślne</span><span class="sxs-lookup"><span data-stu-id="4a424-107">The Default Behavior</span></span>  

 <span data-ttu-id="4a424-108">Domyślnie Monitor wydajności Wyświetla liczniki wydajności dla poszczególnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4a424-108">By default, the Performance Monitor displays performance counters on a per-application basis.</span></span> <span data-ttu-id="4a424-109">Jednak istnieją dwa scenariusze, w których jest to problematyczne:</span><span class="sxs-lookup"><span data-stu-id="4a424-109">However, there are two scenarios in which this is problematic:</span></span>  
  
- <span data-ttu-id="4a424-110">W przypadku monitorowania dwóch aplikacji o tej samej nazwie.</span><span class="sxs-lookup"><span data-stu-id="4a424-110">When you monitor two applications that have the same name.</span></span> <span data-ttu-id="4a424-111">Jeśli na przykład obie aplikacje mają nazwę myapp.exe, zostanie ona wyświetlona jako **MojaApl** , a druga jako **MojaApl # 1** w kolumnie **wystąpienie** .</span><span class="sxs-lookup"><span data-stu-id="4a424-111">For example, if both applications are named myapp.exe, one will be displayed as **myapp** and the other as **myapp#1** in the **Instance** column.</span></span> <span data-ttu-id="4a424-112">W takim przypadku trudno jest dopasować licznik wydajności do określonej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4a424-112">In this case, it is difficult to match a performance counter to a particular application.</span></span> <span data-ttu-id="4a424-113">Nie jest jasne, czy dane zbierane dla programu **MojaApl # 1** odnoszą się do pierwszej myapp.exe, czy drugiego myapp.exe.</span><span class="sxs-lookup"><span data-stu-id="4a424-113">It is not clear whether the data collected for **myapp#1** refers to the first myapp.exe or the second myapp.exe.</span></span>  
  
- <span data-ttu-id="4a424-114">Gdy aplikacja używa wielu wystąpień środowiska uruchomieniowego języka wspólnego.</span><span class="sxs-lookup"><span data-stu-id="4a424-114">When an application uses multiple instances of the common language runtime.</span></span> <span data-ttu-id="4a424-115">.NET Framework 4 obsługuje międzyprocesowe scenariusze hostingu równoczesnego; oznacza to, że pojedynczy proces lub aplikacja może ładować wiele wystąpień środowiska uruchomieniowego języka wspólnego.</span><span class="sxs-lookup"><span data-stu-id="4a424-115">The .NET Framework 4 supports in-process side-by-side hosting scenarios; that is, a single process or application can load multiple instances of the common language runtime.</span></span> <span data-ttu-id="4a424-116">Jeśli jedna aplikacja o nazwie myapp.exe ładuje dwa wystąpienia środowiska uruchomieniowego, domyślnie zostanie wyznaczony w kolumnie **wystąpienie** jako **MojaApl** i **MojaApl # 1**.</span><span class="sxs-lookup"><span data-stu-id="4a424-116">If a single application named myapp.exe loads two runtime instances, by default, they will be designated in the **Instance** column as **myapp** and **myapp#1**.</span></span> <span data-ttu-id="4a424-117">W takim przypadku nie jest jasne, czy **MojaApl** i **MojaApl # 1** odnoszą się do dwóch aplikacji o tej samej nazwie lub w tej samej aplikacji z dwoma środowiskami uruchomieniowymi.</span><span class="sxs-lookup"><span data-stu-id="4a424-117">In this case, it is not clear whether **myapp** and **myapp#1** refer to two applications with the same name, or to the same application with two runtimes.</span></span> <span data-ttu-id="4a424-118">Jeśli wiele aplikacji o tej samej nazwie ładuje wiele środowisk uruchomieniowych, niejednoznaczność jest jeszcze większa.</span><span class="sxs-lookup"><span data-stu-id="4a424-118">If multiple applications with the same name load multiple runtimes, the ambiguity is even greater.</span></span>  
  
 <span data-ttu-id="4a424-119">Aby wyeliminować tę niejednoznaczność, można ustawić klucz rejestru.</span><span class="sxs-lookup"><span data-stu-id="4a424-119">You can set a registry key to eliminate this ambiguity.</span></span> <span data-ttu-id="4a424-120">W przypadku aplikacji utworzonych przy użyciu .NET Framework 4, ta zmiana w rejestrze dodaje identyfikator procesu, a następnie identyfikator wystąpienia środowiska uruchomieniowego do nazwy aplikacji w kolumnie **wystąpienie** .</span><span class="sxs-lookup"><span data-stu-id="4a424-120">For applications developed using the .NET Framework 4, this registry change adds a process identifier followed by a runtime instance identifier to the application name in the **Instance** column.</span></span> <span data-ttu-id="4a424-121">Zamiast *aplikacji* *lub #1 aplikacji, aplikacja jest* teraz identyfikowana jako *aplikacja* _ `p` *ProcessId* \_ `r` *runtimeID* w kolumnie **instance** .</span><span class="sxs-lookup"><span data-stu-id="4a424-121">Instead of *application* or *application*#1, the application is now identified as *application* _`p`*processID*\_`r`*runtimeID* in the **Instance** column.</span></span> <span data-ttu-id="4a424-122">Jeśli aplikacja została opracowana przy użyciu poprzedniej wersji środowiska uruchomieniowego języka wspólnego, to wystąpienie jest reprezentowane jako *\_* `p` *Identyfikator procesu* aplikacji, pod warunkiem, że zainstalowano .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="4a424-122">If an application was developed using a previous version of the common language runtime, that instance is represented as *application\_*`p`*processID* provided that the .NET Framework 4 is installed.</span></span>  
  
## <a name="performance-counters-for-in-process-side-by-side-applications"></a><span data-ttu-id="4a424-123">Liczniki wydajności dla In-Process aplikacji równoległych</span><span class="sxs-lookup"><span data-stu-id="4a424-123">Performance Counters for In-Process Side-by-Side Applications</span></span>  

 <span data-ttu-id="4a424-124">Aby obsługiwać liczniki wydajności dla wielu wersji środowiska uruchomieniowego języka wspólnego, które są hostowane w pojedynczej aplikacji, należy zmienić jedno ustawienie klucza rejestru, jak pokazano w poniższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="4a424-124">To handle performance counters for multiple common language runtime versions that are hosted in a single application, you must change a single registry key setting, as shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="4a424-125">Nazwa klucza</span><span class="sxs-lookup"><span data-stu-id="4a424-125">Key name</span></span>|<span data-ttu-id="4a424-126">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\ . NETFramework\Performance</span><span class="sxs-lookup"><span data-stu-id="4a424-126">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span></span>|  
|<span data-ttu-id="4a424-127">Nazwa wartości</span><span class="sxs-lookup"><span data-stu-id="4a424-127">Value name</span></span>|<span data-ttu-id="4a424-128">ProcessNameFormat</span><span class="sxs-lookup"><span data-stu-id="4a424-128">ProcessNameFormat</span></span>|  
|<span data-ttu-id="4a424-129">Typ wartości</span><span class="sxs-lookup"><span data-stu-id="4a424-129">Value type</span></span>|<span data-ttu-id="4a424-130">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="4a424-130">REG_DWORD</span></span>|  
|<span data-ttu-id="4a424-131">Wartość</span><span class="sxs-lookup"><span data-stu-id="4a424-131">Value</span></span>|<span data-ttu-id="4a424-132">1 (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="4a424-132">1 (0x00000001)</span></span>|  
  
 <span data-ttu-id="4a424-133">Wartość 0 `ProcessNameFormat` oznacza, że zachowanie domyślne jest włączone, czyli Perfmon.exe Wyświetla liczniki wydajności dla poszczególnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4a424-133">A value of 0 for `ProcessNameFormat` indicates that the default behavior is enabled; that is, Perfmon.exe displays performance counters on a per-application basis.</span></span> <span data-ttu-id="4a424-134">Gdy ta wartość zostanie ustawiona na 1, Perfmon.exe rozróżnia wiele wersji aplikacji i oferuje liczniki wydajności na podstawie środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="4a424-134">When you set this value to 1, Perfmon.exe disambiguates multiple versions of an application and provides performance counters on a per-runtime basis.</span></span> <span data-ttu-id="4a424-135">Wszystkie inne wartości `ProcessNameFormat` Ustawienia klucz rejestru są nieobsługiwane i zarezerwowane do użytku w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="4a424-135">Any other value for the `ProcessNameFormat` registry key setting is unsupported and reserved for future use.</span></span>  
  
 <span data-ttu-id="4a424-136">Po zaktualizowaniu `ProcessNameFormat` Ustawienia klucza rejestru należy ponownie uruchomić Perfmon.exe lub innych użytkowników liczników wydajności, aby nowa funkcja nazewnictwa wystąpień była poprawnie działać.</span><span class="sxs-lookup"><span data-stu-id="4a424-136">After you update the `ProcessNameFormat` registry key setting, you must restart Perfmon.exe or any other consumers of performance counters so that the new instance naming feature works correctly.</span></span>  
  
 <span data-ttu-id="4a424-137">Poniższy przykład pokazuje, jak zmienić `ProcessNameFormat` wartość programowo.</span><span class="sxs-lookup"><span data-stu-id="4a424-137">The following example shows how to change the `ProcessNameFormat` value programmatically.</span></span>  
  
 [!code-csharp[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/cs/regsetting1.cs#1)]
 [!code-vb[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/vb/regsetting1.vb#1)]  
  
 <span data-ttu-id="4a424-138">Po wprowadzeniu tej zmiany w rejestrze Perfmon.exe są wyświetlane nazwy aplikacji przeznaczonych dla .NET Framework 4 jako *aplikacja* _ o identyfikatorze `p` *processID* \_ `r` procesu *runtimeID*, gdzie *aplikacja* jest nazwą aplikacji, parametrem *ProcessId* są identyfikatory procesów aplikacji, a *runtimeID* jest identyfikatorem środowiska uruchomieniowego języka wspólnego.</span><span class="sxs-lookup"><span data-stu-id="4a424-138">When you make this registry change, Perfmon.exe displays the names of applications that target the .NET Framework 4 as *application* _`p`*processID*\_`r`*runtimeID*, where *application* is the name of the application, *processID* is the application's process identifier, and *runtimeID* is a common language runtime identifier.</span></span> <span data-ttu-id="4a424-139">Na przykład jeśli aplikacja o nazwie myapp.exe ładuje dwa wystąpienia środowiska uruchomieniowego języka wspólnego, Perfmon.exe może zidentyfikować jedno wystąpienie jako myapp_p1416_r10, a drugi jako myapp_p3160_r10.</span><span class="sxs-lookup"><span data-stu-id="4a424-139">For example, if an application named myapp.exe loads two instances of the common language runtime, Perfmon.exe may identify one instance as myapp_p1416_r10 and the second as myapp_p3160_r10.</span></span> <span data-ttu-id="4a424-140">Identyfikator środowiska uruchomieniowego rozróżnia tylko środowiska uruchomieniowe w ramach procesu; nie zawiera żadnych innych informacji o środowisku uruchomieniowym.</span><span class="sxs-lookup"><span data-stu-id="4a424-140">The runtime identifier only disambiguates the runtimes within a process; it does not provide any other information about the runtime.</span></span> <span data-ttu-id="4a424-141">(Na przykład identyfikator środowiska uruchomieniowego nie ma relacji do wersji lub jednostki SKU środowiska uruchomieniowego).</span><span class="sxs-lookup"><span data-stu-id="4a424-141">(For example, the runtime ID has no relation to the version or the SKU of the runtime.)</span></span>  
  
 <span data-ttu-id="4a424-142">Jeśli zainstalowano .NET Framework 4, zmiana rejestru wpłynie również na aplikacje, które zostały opracowane przy użyciu wcześniejszych wersji .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="4a424-142">If the .NET Framework 4 is installed, the registry change also affects applications that were developed using earlier versions of the .NET Framework.</span></span> <span data-ttu-id="4a424-143">Są one wyświetlane w Perfmon.exe jako *application_* `p` *Identyfikator procesu*, gdzie *aplikacja* jest nazwą aplikacji *,* a identyfikatorem przepełnienia jest proces.</span><span class="sxs-lookup"><span data-stu-id="4a424-143">These appear in Perfmon.exe as *application_*`p`*processID*, where *application* is the application name and *processID* is the process identifier.</span></span> <span data-ttu-id="4a424-144">Jeśli na przykład liczniki wydajności dwóch aplikacji o nazwie myapp.exe są monitorowane, jeden z nich może być wyświetlany jako myapp_p23900 i inne jako myapp_p24908.</span><span class="sxs-lookup"><span data-stu-id="4a424-144">For example, if the performance counters of two applications named myapp.exe are monitored, one might appear as myapp_p23900 and the other as myapp_p24908.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4a424-145">Identyfikator procesu eliminuje niejednoznaczność rozpoznawania dwóch aplikacji o tej samej nazwie, która korzysta ze starszych wersji środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="4a424-145">The process identifier eliminates the ambiguity of resolving two applications with the same name that use earlier versions of the runtime.</span></span> <span data-ttu-id="4a424-146">Identyfikator środowiska uruchomieniowego nie jest wymagany w przypadku poprzednich wersji, ponieważ poprzednie wersje środowiska uruchomieniowego języka wspólnego nie obsługują scenariuszy równoległych.</span><span class="sxs-lookup"><span data-stu-id="4a424-146">A runtime identifier is not required for previous versions, because previous versions of the common language runtime do not support side-by-side scenarios.</span></span>  
  
 <span data-ttu-id="4a424-147">Jeśli .NET Framework 4 nie istnieje lub została odinstalowana, ustawienie klucza rejestru nie ma żadnego wpływu.</span><span class="sxs-lookup"><span data-stu-id="4a424-147">If the .NET Framework 4 is not present or was uninstalled, setting the registry key has no effect.</span></span> <span data-ttu-id="4a424-148">Oznacza to, że dwie aplikacje o tej samej nazwie będą nadal wyświetlane w Perfmon.exe jako *aplikacja* i *aplikacja # 1* (na przykład jako **MojaApl** i **MojaApl # 1**).</span><span class="sxs-lookup"><span data-stu-id="4a424-148">This means that two applications with the same name will continue to appear in Perfmon.exe as *application* and *application#1* (for example, as **myapp** and **myapp#1**).</span></span>
