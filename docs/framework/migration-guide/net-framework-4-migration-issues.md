---
title: Zagadnienia dotyczące migracji programu .NET framework 4
ms.date: 05/02/2017
helpviewer_keywords:
- .NET Framework 4, migration
- application compatibility
ms.assetid: df478548-8c05-4de2-8ba7-adcdbe1c2a60
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 351bf675d33a060019cbf22437d7945537a21707
ms.sourcegitcommit: ad99773e5e45068ce03b99518008397e1299e0d1
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/22/2018
ms.locfileid: "46577759"
---
# <a name="net-framework-4-migration-issues"></a>Zagadnienia dotyczące migracji programu .NET framework 4

W tym temacie opisano problemy przy migracji między .NET Framework w wersji 3.5 z dodatkiem Service Pack 1 i .NET Framework w wersji 4, w tym poprawki, zmian dotyczących zgodności ze standardami i bezpieczeństwo i zmiany na podstawie opinii klientów. Większość tych zmian nie wymaga żadnych modyfikacji programistycznych w aplikacjach. Dla osób, które mogą obejmować modyfikacje Zobacz zalecane kolumny zmiany w tabeli.

W tym temacie opisano znaczące zmiany w następujących obszarach:

* [Program ASP.NET i sieci Web](#asp-net-and-web)

* [Funkcje podstawowe](#core)

* [Dane](#data)

* [Windows Communication Foundation (WCF)](#windows-communication-foundation-wcf)

* [Windows Presentation Foundation (WPF)](#windows-presentation-foundation-wpf)

* [XML](#xml)

Omówienie wyższego poziomu problemy, w tym temacie zobacz [Przewodnik po migracji do programu .NET Framework 4](/previous-versions/dotnet/netframework-4.0/ff657133(v=vs.100)).

Aby uzyskać informacje o nowych funkcjach, zobacz [What's New in .NET Framework 4](/previous-versions/dotnet/netframework-4.0/ms171868(v=vs.100)).

## <a name="aspnet-and-web"></a>ASP.NET i Internet

Przestrzenie nazw: <xref:System.Web>, <xref:System.Web.Mobile>, <xref:System.Web.Security>, <xref:System.Web.UI.WebControls>; zestaw: System.Web (w System.Web.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Pliki definicji przeglądarki** | Przeglądarka plików definicji zostały zaktualizowane do uwzględnienia informacji o nowych i zaktualizowanych przeglądarek i urządzeń. Starsze przeglądarki i urządzenia, takich jak Netscape Navigator zostały usunięte i nowszych przeglądarkach i urządzeniach, takich jak Google Chrome i Apple iPhone zostały dodane.<br><br>Jeśli aplikacja zawiera definicje niestandardowego przeglądarki, które dziedziczą z jednej z definicji przeglądarki, które zostały usunięte, zostanie wyświetlony błąd.<br><br><xref:System.Web.HttpBrowserCapabilities> Obiektu (który jest uwidaczniany przez stronę `Request.Browse` właściwość) jest wymuszany przez pliki definicji przeglądarki. W związku z tym informacje, które jest zwracany, uzyskując dostęp do właściwości tego obiektu w programie ASP.NET 4 może być inny niż informacji, który został zwrócony we wcześniejszej wersji programu ASP.NET. | Jeśli aplikacja zależy od stare pliki definicji przeglądarki, można je skopiować z następującego folderu:<br><br>*Windows\\Microsoft.NET\\Framework\\v2.0.50727\\CONFIG\\przeglądarki*<br><br>Skopiuj pliki do odpowiednich  *\\CONFIG\\przeglądarek* folder dla platformy ASP.NET 4. Po skopiowaniu plików Uruchom [Aspnet_regbrowsers.exe](https://msdn.microsoft.com/library/ms229858.aspx) narzędzie wiersza polecenia. Aby uzyskać więcej informacji, zobacz [ http://www.asp.net/mobile ](https://go.microsoft.com/fwlink/?LinkId=182900) witryny sieci Web. |
| **Aplikacje podrzędne, działające w środowisku mieszanym wersji platformy ASP.NET** | ASP.NET 4 aplikacje, które są skonfigurowane jako elementy podrzędne w aplikacji, które są uruchomione wcześniejsze wersje programu ASP.NET może nie można uruchomić z powodu błędów kompilacji lub konfiguracji. Konkretny błąd, który występuje, zależy od tego, czy aplikacja działa w ramach usług IIS 6.0 lub w ramach usług IIS 7 lub usług IIS 7.5. | Tak, aby system konfiguracji prawidłowe rozpoznawanie aplikacji platformy ASP.NET 4, można wprowadzić zmiany w plikach konfiguracji aplikacji, których to dotyczy. Aby uzyskać informacje o zmianach, należy wykonać, zobacz sekcję "4 podrzędnych aplikacji zakończyć się niepowodzeniem do Start podczas w obszarze platformy ASP.NET w wersji 2.0 lub ASP.NET 3.5 aplikacji ASP.NET" w dokumencie [fundamentalne zmiany w programie ASP.NET 4](https://go.microsoft.com/fwlink/?LinkId=182908) w witrynie sieci Web platformy ASP.NET. |
| **Zmiany identyfikatora klienta** | Nowy `clientIDMode` ustawienie w ASP.NET 4 pozwala określić, jak program ASP.NET generuje `id` atrybutów elementów HTML. W poprzednich wersjach programu ASP.NET, zachowanie domyślne zostało odpowiednikiem `AutoID` ustawienie `clientIDMode`. Ustawieniem domyślnym jest teraz `Predictable`. Aby uzyskać więcej informacji, zobacz [Identyfikacja kontrolki serwera sieci Web platformy ASP.NET](https://msdn.microsoft.com/library/1d04y8ss(v=vs.100).aspx). | Jeśli używasz programu Visual Studio, aby uaktualnić aplikację ASP.NET w wersji 2.0 lub ASP.NET 3.5, narzędzie automatycznie dodaje ustawienie do pliku Web.config, który zachowuje zachowanie wcześniejszych wersji programu .NET Framework. Jednak jeśli zaktualizujesz aplikację, zmieniając puli aplikacji w usługach IIS pod kątem programu .NET Framework 4, platformy ASP.NET używa domyślnie nowy tryb. Aby wyłączyć nowy tryb Identyfikatora klienta, należy dodać następujące ustawienie do pliku Web.config:<br><br>`<pages clientIDMode="AutoID" />` |
| **Zabezpieczenia dostępu kodu (CAS)** | Program ASP.NET 2.0 netto funkcje, które zostały dodane w programie ASP.NET 3.5 używać .NET Framework 1.1 i .NET Framework 2.0 model zabezpieczenia dostępu kodu. Jednak implementacja urzędów certyfikacji w ASP.NET 4 został znacznie overhauled. W rezultacie częściowego zaufania aplikacji ASP.NET, które zależą od zaufanego kodu w globalnej pamięci podręcznej może się nie powieść z różnych wyjątków zabezpieczeń. Aplikacje częściowo zaufane, korzystających z rozległych modyfikacji na komputerze zasady CAS może również zakończyć się niepowodzeniem i generować wyjątki zabezpieczeń. | Aplikacje programu ASP.NET 4 częściowego zaufania do zachowania ASP.NET 1.1 i 2.0 można przywrócić za pomocą nowego `legacyCasModel` atrybutu w `trust` element konfiguracji, jak pokazano w poniższym przykładzie:<br><br>`<trust level= "Medium" legacyCasModel="true" />`<br><br>Ważne: Powracanie do starszego modelu urzędów certyfikacji może reprezentować mniejsze zabezpieczeń.<br><br>Aby uzyskać więcej informacji na temat nowy model zabezpieczeń dostępu kodu platformy ASP.NET 4, zobacz [zabezpieczenia dostępu kodu w aplikacji programu ASP.NET 4](https://msdn.microsoft.com/library/dd984947.aspx). |
| **Pliki konfiguracji** | Główny pliki konfiguracji (plik machine.config i głównego pliku Web.config) .NET Framework i programu ASP.NET 4 zostały zaktualizowane do zawierają większość informacji o konfiguracji standardowy, która została znaleziona w plikach Web.config aplikacji na platformie ASP.NET 3.5. Ze względu na złożoność zarządzanych usług IIS 7 i IIS 7.5 systemów konfiguracji uruchamiania aplikacji ASP.NET 3.5 w ramach platformy ASP.NET 4 i w ramach usług IIS 7 i IIS 7.5 może powodować błędy programu ASP.NET lub błędy usługi IIS. | Uaktualnianie aplikacji ASP.NET 3.5 do platformy ASP.NET 4, za pomocą narzędzia uaktualniania projektu w programie Visual Studio. Program Visual Studio 2010 automatycznie modyfikuje plik Web.config aplikacji ASP.NET 3.5 zawiera odpowiednie ustawienia dla platformy ASP.NET 4.<br><br>Jednak można uruchamiać aplikacje ASP.NET 3.5 przy użyciu programu .NET Framework 4 bez ponownej kompilacji. W takim przypadku trzeba ręcznie zmodyfikować pliku Web.config aplikacji przed uruchomieniem aplikacji w ramach programu .NET Framework 4 i w ramach usług IIS 7 lub usług IIS 7.5. Określonej zmiany, które należy wykonać, zależy od kombinacji oprogramowania, którą pracujesz, łącznie z wersji Service Pack (SP). Uzyskać informacji na temat kombinacje możliwości oprogramowania, których dotyczy ta zmiana i jak rozwiązać problemy z konkretnej ich kombinacji, zobacz sekcję "Konfiguracji błędów powiązanych do nowej platformy ASP.NET 4 głównego konfiguracji" w dokumencie [ Istotne zmiany w platformie ASP.NET 4](https://go.microsoft.com/fwlink/?LinkId=182908) w witrynie sieci Web platformy ASP.NET. |
| **Renderowania formantu** | W poprzednich wersjach programu ASP.NET niektóre kontrolki emitowany kod znaczników, który nie można wyłączyć. Domyślnie w ASP.NET 4 nie jest generowana tego typu znaczników. Zmiany renderowania dotyczą następujących formantów:<br><br>* `Image` i `ImageButton` już renderowanie kontrolek `border="0"` atrybutu.<br>* `BaseValidator` Klasy oraz sprawdzanie poprawności formantów, które od niej pochodzić renderowania czerwony tekst nie jest już domyślnie.<br>* `HtmlForm` Kontrolki nie jest renderowana `name` atrybutu.<br>* `Table` Kontrolować już renderuje `border="0"` atrybutu.<br><br>Formanty, które nie są przeznaczone na dane wejściowe użytkownika (na przykład `Label` kontroli) nie jest już renderowania `disabled="disabled"` atrybutu, jeśli ich `Enabled` właściwość jest ustawiona na `false` (lub jeśli dziedziczą one tego ustawienia z poziomu kontroli kontenera). | Uaktualnianie aplikacji ASP.NET w wersji 2.0 lub ASP.NET 3.5 przy użyciu programu Visual Studio, narzędzie automatycznie dodaje ustawienia do pliku Web.config, który zachowuje renderowania starszej wersji. Jednak jeśli zaktualizujesz aplikację, zmieniając puli aplikacji w usługach IIS pod kątem programu .NET Framework 4, platformy ASP.NET używa domyślnie nowy tryb renderowania. Aby wyłączyć nowy tryb renderowania, Dodaj następujące ustawienie do pliku Web.config:<br><br>`<pages controlRenderingCompatibilityVersion="3.5" />` |
| **Programy obsługi zdarzeń w domyślnych dokumentów.** | ASP.NET 4 renderuje kod HTML `form` elementu `action` wartość atrybutu jako ciąg pusty, po wysłaniu żądania do bez rozszerzenia adresu URL, który ma do niej przyporządkowany dokument domyślny. We wcześniejszych wersjach programu ASP.NET, żądanie `http://contoso.com` mogłoby spowodować żądania do Default.aspx. W tym dokumencie otwarcia `form` pozbawi znaczników, jak w poniższym przykładzie:<br><br>`<form action="Default.aspx" />`<br><br>ASP.NET 4, żądanie `http://contoso.com` również wyniki w żądaniu skierowanym do Default.aspx, ale ASP.NET teraz renderuje otwierania HTML `form` znaczników, jak w poniższym przykładzie:<br><br>`<form action="" />`<br><br>Gdy `action` atrybut jest pustym ciągiem, IIS `DefaultDocumentModule` obiektu tworzy żądanie podrzędne Default.aspx. W większości okolicznościach tego żądania podrzędnego jest niewidoczne dla kodu aplikacji, a strony Default.aspx działa normalnie. Potencjalne interakcji między kodem zarządzanym i trybie usług IIS 7 lub IIS 7.5 zintegrowane może jednak spowodować strony .aspx zarządzanych przestaną działać poprawnie podczas żądania podrzędnego. Jeśli wystąpią następujące warunki, żądania podrzędnego do domyślnej aspx dokumentu spowoduje błąd lub nieoczekiwane zachowanie:<br><br>* Strony .aspx jest wysyłany do przeglądarki przy użyciu `form` elementu `action` ustawioną wartość atrybutu "".<br>* Formularza jest publikowany do platformy ASP.NET.<br>* HTTP modułu zarządzanego odczytuje część treści jednostki, takie jak `Request.Form` lub `Request.Params`. Powoduje to treści jednostki żądania POST do odczytu do pamięci zarządzanej. W rezultacie treści jednostki nie jest już dostępna dla wszelkich modułów kodu natywnego, które działają w trybie usługi IIS 7 lub IIS 7.5 zintegrowane.<br>* IIS `DefaultDocumentModule` obiektu po pewnym czasie działa i tworzy żądania podrzędnego do dokumentu Default.aspx. Ponieważ treści jednostki już zostało odczytane przez fragment kodu zarządzanego, nie jest jednak nie można wysyłać żądania podrzędnego treści jednostki.<br>* Uruchomienie potoku HTTP dla żądania podrzędnych, obsługi plików aspx działa w fazie handler-execute.<br><br>Ponieważ nie ma żadnych treści jednostki, istnieją żadnych zmiennych formularza i bez stanu widoku. W związku z tym nie ma żadnych informacji dotyczących obsługi strony .aspx ustalić, jakie zdarzenie (jeśli istnieje) powinien być wywoływany. W rezultacie Brak programów obsługi zdarzeń zwrotu strony .aspx dotyczy Uruchom. | Aby uzyskać informacje dotyczące sposobów obejścia problemów, które mogą wystąpić w wyniku tej zmiany, zobacz "Zdarzenia obsługi może nie być nie zgłoszone w domyślne dokumentu w usług IIS 7 lub usług IIS 7.5 zintegrowane tryb" w dokumencie [platformy ASP.NET 4 fundamentalne zmiany](https://go.microsoft.com/fwlink/?LinkId=182908)w witrynie sieci Web platformy ASP.NET. |
| **Algorytm wyznaczania wartości skrótu** | Aplikacja ASP.NET używa szyfrowanie i algorytmy wyznaczania wartości skrótu, aby ułatwić zabezpieczanie danych, takich jak pliki cookie uwierzytelniania formularzy oraz stanu widoku. Domyślnie używa platformy ASP.NET 4 <xref:System.Security.Cryptography.HMACSHA256> algorytm wyznaczania wartości skrótu operacje na pliki cookie i stan widoku. Starsze wersje programu ASP.NET używały starsze <xref:System.Security.Cryptography.HMACSHA1> algorytmu. | Po uruchomieniu aplikacji, które mieszać ASP.NET 2.0 i platformy ASP.NET 4, gdzie dane, takie jak pliki cookie uwierzytelniania formularzy musi działać w wersji programu .NET Framework, należy skonfigurować aplikację sieci Web platformy ASP.NET 4 do korzystania ze starszą wersją <xref:System.Security.Cryptography.HMACSHA1> algorytmu, dodając następujące ustawienie w plik Web.config:<br><br>`<machineKey validation="SHA1" />` |
| **Hosting kontrolek w programie Internet Explorer** | Nie będzie już hosta formantów formularzy Windows w programie Internet Explorer, ponieważ istnieją lepszego rozwiązania do obsługi formantów w sieci Web. W związku z tym zestawów IEHost.dll i IEExec.exe zostały usunięte z programu .NET Framework. | Następujące technologie służy do tworzenia kontrolki niestandardowej w aplikacji sieci Web:<br><br>* Można utworzyć aplikację Silverlight i skonfigurowanie pod kątem uruchamiania poza przeglądarką. Aby uzyskać więcej informacji, zobacz [pomocy technicznej bez przeglądarki](https://msdn.microsoft.com/library/dd550721(v=vs.100).aspx).<br>* Możesz tworzyć aplikacji przeglądarki XAML (XBAP), aby móc korzystać z możliwości WPF (wymaga programu .NET Framework na maszynach klienckich). Aby uzyskać więcej informacji, zobacz [WPF XAML Browser Applications Overview](/dotnet/framework/wpf/app-development/wpf-xaml-browser-applications-overview). |
| **Metody HtmlEncode i UrlEncode** | `HtmlEncode` i `UrlEncode` metody <xref:System.Web.HttpUtility> i <xref:System.Web.HttpServerUtility> klasy zostały zaktualizowane do kodowania znaków pojedynczego cudzysłowu (') w następujący sposób:<br><br>* `HtmlEncode` Metoda koduje wystąpień pojedynczego cudzysłowu jako `&#39;`<br>* `UrlEncode` Metoda koduje wystąpień pojedynczego cudzysłowu jako `%27` | Sprawdź swój kod pod kątem miejsca, w którym używasz `HtmlEncode` i `UrlEncode` metod i upewnij się, że ta zmiana kodowania powoduje zmiany, które będą wpływać na aplikację. |
| **Httpexception — błędy w aplikacjach ASP.NET 2.0** | Po włączeniu programu ASP.NET 4 w usługach IIS 6 aplikacje programu ASP.NET 2.0, które działają w usługach IIS 6 (w systemie Windows Server 2003 lub Windows Server 2003 R2) może generować błędy, takie jak następujące: `System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.` | * Jeśli ASP.NET 4 nie jest wymagane do uruchomienia witryny sieci Web, należy ponownie zamapować lokacji zamiast tego użyć programu ASP.NET 2.0.<br><br>—lub—<br><br>* Jeśli ASP.NET 4 jest wymagany, aby można było uruchomić witryny sieci Web, należy przenieść wszelkich podrzędnych katalogów wirtualnych ASP.NET 2.0 do innej witryny sieci Web, który jest mapowany na platformie ASP.NET 2.0.<br><br>—lub—<br><br>* Wyłączenie adresy URL bez rozszerzeń. Aby uzyskać więcej informacji, zobacz "aplikacje programu ASP.NET 2.0 mogą generować błędy elemencie HttpException tego odwołania eurl.axd" w dokumencie [fundamentalne zmiany w programie ASP.NET 4](https://go.microsoft.com/fwlink/?LinkId=182908) w witrynie sieci Web platformy ASP.NET. |
| **Typy członkostwa** | Niektóre typy (na przykład <xref:System.Web.Security.MembershipProvider>) które są używane w programie ASP.NET: członkostwo zostały przeniesione z System.Web.dll do zestawu System.Web.ApplicationServices.dll. Typy zostało przeniesione, aby można było rozpoznać warstw architektury zależności między typami w kliencie, jak i w postaci jednostek SKU rozszerzonej platformy .NET Framework. | Biblioteki klas, który uaktualniono z wcześniejszych wersji programu ASP.NET, które korzystają członkostwa typy, które zostały przeniesione może zakończyć się niepowodzeniem do kompilowania, gdy jest używana w projektach programu ASP.NET 4. Jeśli tak, aby System.Web.ApplicationServices.dll Dodaj odwołanie w projekcie biblioteki klas. |
| **Menu Kontrola zmian** | Zmienia się na <xref:System.Web.UI.WebControls.Menu> kontrolować wynikiem są następujące zachowanie:<br><br>* Jeśli <xref:System.Web.UI.WebControls.MenuRenderingMode> jest ustawiona na `List`, lub jeśli <xref:System.Web.UI.WebControls.MenuRenderingMode> ustawiono `Default` i <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> jest ustawiona na `4.0` lub nowszym, <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> właściwość nie ma wpływu.<br>* Jeśli ścieżki, który jest ustawiony w <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> i <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> właściwości zawiera ukośnik odwrotny (\\), obrazy nie są renderowane. (We wcześniejszych wersjach programu ASP.NET, ścieżki może zawierać ukośnika odwrotnego.) | * Zamiast z ustawienie <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> ustawić właściwości dla poszczególnych elementów menu, <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> lub <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> nadrzędnej <xref:System.Web.UI.WebControls.Menu> kontroli.<br><br>—lub—<br><br>Ustaw <xref:System.Web.UI.WebControls.MenuRenderingMode> do `Table`, lub ustawić <xref:System.Web.UI.WebControls.MenuRenderingMode> do `Default` i ustaw <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> do `3.5`. Te ustawienia powodują <xref:System.Web.UI.WebControls.Menu> kontrolki używanej na podstawie tabeli układ HTML używany we wcześniejszych wersjach programu ASP.NET.<br>* Jeśli ścieżka w <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> lub <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> właściwość zawiera ukośnik odwrotny (\\), Zastąp znaku ukośnika (/). |
| **Przenośne zestawu w pliku Web.config** | W poprzednich wersjach programu ASP.NET, odwołanie do zestawu System.Web.Mobile.dll została uwzględniona w głównym pliku Web.config w `assemblies` sekcji `system.web` / `compilation`. Aby zwiększyć wydajność, zostało usunięte odwołanie do tego zestawu.<br><br>Uwaga: Zestaw System.Web.Mobile.dll oraz formanty mobilne ASP.NET, które są zawarte w ASP.NET 4, ale są one przestarzałe. | Jeśli chcesz, by używał typów z tego zestawu, należy dodać odwołanie do zestawu w obu głównego pliku Web.config lub w pliku Web.config aplikacji. |
| **Buforowanie danych wyjściowych** | W wersji 1.0 programu ASP.NET, stron, które określono w pamięci podręcznej usterka spowodowana `Location="ServerAndClient"` jako dane wyjściowe — możliwość ciągłego dostosowywania "ustawienie, aby emitować pamięci podręcznej `Vary:*` nagłówek odpowiedzi HTTP. To w efekcie informuje przeglądarki klienta nigdy nie pamięci podręcznej na stronie lokalnie. W ASP.NET 1.1 <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> metoda został dodany, który może być wywoływana, aby pominąć `Vary:*` nagłówka. Jednak raporty o usterkach zgłaszane sugerują, deweloperzy i znają istniejącej `SetOmitVaryStar` zachowanie.<br><br>W technologii ASP.NET 4 `Vary:*` z odpowiedzi, które określają następujące dyrektywy, nie jest już jest emitowany nagłówka HTTP:<br><br>`<%@ OutputCache Location="ServerAndClient" %>`<br><br>W rezultacie <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> metoda jest już potrzebne, aby pominąć `Vary:*` nagłówka. W aplikacji, które określają "ServerAndClient" dla `Location` atrybut będzie stron podlega buforowaniu, w przeglądarce bez konieczności, który można wywoływać <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A>. | Jeśli stron w aplikacji musi wysyłać właściwość `Vary:*`, wywołaj <xref:System.Web.HttpResponse.AppendHeader%2A> metody, jak pokazano w poniższym przykładzie:<br><br>`System.Web.HttpResponse.AppendHeader("Vary","*");`<br><br>Alternatywnie, można zmienić wartość buforowania danych wyjściowych `Location` atrybut "Server". |
| **Strona analizy** | Parser strony dla stron sieci Web platformy ASP.NET (pliki aspx) i kontrolki użytkownika (plikach ascx) jest bardziej restrykcyjny w ASP.NET 4 niż we wcześniejszych wersjach programu ASP.NET, a jego flagi więcej znaczników jako niepoprawna niż we wcześniejszych wersjach. | Sprawdź komunikaty o błędach, które są tworzone po uruchomieniu strony i naprawić błędy, które wynikają z nieprawidłowe znaczniki. |
| **Typy Passport** | Usługa Passport wbudowaną w ASP.NET 2.0 jest przestarzała i nie jest obsługiwany z powodu zmian w Passport (teraz SDK identyfikator Live). W rezultacie typy związane z usługi Passport w <xref:System.Web.Security> zostały oznaczone za pomocą `ObsoleteAttribute` atrybutu. | Zmiany jakiegokolwiek kodu istnieje, którym są używane usługi Passport w <xref:System.Web.Security> przestrzeni nazw (na przykład <xref:System.Web.Security.PassportIdentity>) do użycia [SDK](https://go.microsoft.com/fwlink/?LinkId=106346). |
| **PATHINFO zawiera informacje w FilePath — właściwość** | ASP.NET 4 nie zawiera już `PathInfo` wartość zwracana wartości z właściwości, takie jak <xref:System.Web.HttpRequest.FilePath>, <xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath>, i <xref:System.Web.HttpRequest.CurrentExecutionFilePath>. Zamiast tego `PathInfo` informacje są dostępne w <xref:System.Web.HttpRequest.PathInfo>. Na przykład Wyobraź sobie następujący fragmentu adresu URL:<br><br>`/testapp/Action.mvc/SomeAction`<br><br>We wcześniejszych wersjach programu ASP.NET <xref:System.Web.HttpRequest> właściwości mieć następujące wartości:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`<br>* <xref:System.Web.HttpRequest.PathInfo>: (pusty)<br><br>W technologii ASP.NET 4 <xref:System.Web.HttpRequest> właściwości zamiast mieć następujące wartości:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`<br>* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction` | Sprawdź swój kod pod kątem miejsca, w którym możesz polegać na właściwości <xref:System.Web.HttpRequest> klasy, aby zwrócić informacje o ścieżce; Zmień kod w celu odzwierciedlenia zmian jak informacje o ścieżce jest zwracana. |
| **Żądanie weryfikacji** | W celu weryfikacji żądań ASP.NET Weryfikacja żądania jest wywoływana we wcześniejszej części cyklu życia żądania. W rezultacie Weryfikacja żądania jest wykonywany dla żądań, które nie dotyczą plików .aspx, takie jak wywołania usługi sieci Web oraz niestandardowe programy obsługi. Weryfikacja żądania również jest aktywny, kiedy niestandardowe moduły HTTP są uruchomione w potoku przetwarzania żądań.<br><br>W wyniku tej zmiany żądania zasobów innych niż pliki aspx może zgłaszać błędy sprawdzania poprawności żądania. Kod niestandardowy, który jest uruchamiany w Potok żądań (na przykład niestandardowe moduły HTTP) także może zgłaszać błędy sprawdzania poprawności żądania. | Jeśli to konieczne, można przywrócić poprzednie działanie mających tylko strony .aspx wyzwalania weryfikacji żądań przy użyciu następującego ustawienia w pliku konfiguracji sieci Web:<br><br>`<httpRuntime requestValidationMode="2.0" />`<br><br>Ostrzeżenie: Jeśli użytkownik wróci do starego zachowania, upewnij się, całego kodu w istniejących programów obsługi, moduły i inne niestandardowy kod wykonuje testy, aby potencjalnie niebezpiecznych danych wejściowych protokołu HTTP, które mogą być XSS ataki wektorów. " |
| **Routing** | Jeśli utworzysz witrynę sieci Web systemu plików w programie Visual Studio 2010 i witryny sieci Web znajduje się w folderze, który zawiera kropkę (.) w nazwie, routing adresów URL nie będzie działać niezawodnie. Błąd HTTP 404 jest zwracana z niektórych ścieżek wirtualnych. Dzieje się tak, ponieważ program Visual Studio 2010 uruchamia serwera wdrożeniowego Visual Studio przy użyciu nieprawidłowej ścieżki katalogu wirtualnego katalogu głównego. | * W **właściwości** strony witryny sieci Web opartych na plikach powoduje, że zmiany **ścieżka wirtualna** atrybutu "/".<br><br>—lub—<br><br>* Utwórz projekt aplikacji sieci Web zamiast projektu witryny sieci Web. Projekty aplikacji sieci Web i ten problem nie występuje i routingu adresów URL działać nawet wtedy, gdy nazwa folderu projektu zawiera kropkę.<br><br>—lub—<br><br>* Utwórz witrynę sieci Web opartych na protokole HTTP, który znajduje się w usługach IIS. Witryny sieci Web hostowanych przez usługi IIS może mieć kropki w ścieżce wirtualnej również jak folder pliku projektu. |
| **Witryny programu SharePoint** | Jeśli zostanie podjęta próba uruchomienia witryny sieci Web programu ASP.NET 4, który jest wdrażany jako element podrzędny witryny sieci Web programu SharePoint, która zawiera niestandardowe częściowego zaufania poziomu o nazwie `WSS_Minimal`, zostanie wyświetlony następujący błąd:<br><br>`Could not find permission set named 'ASP.Net'.` | Obecnie nie wersji programu SharePoint są zgodne z programem ASP.NET. W rezultacie nie należy podejmować Uruchom witrynę sieci Web programu ASP.NET 4 jako element podrzędny witryny sieci Web programu SharePoint. |
| **Standardy XHTML 1.1** | Aby włączyć zgodności XHTML 1.1 dla nowych witryn sieci Web, z formantami ASP.NET w programie .NET Framework 4, spowoduje wygenerowanie HTML zgodne XHTML 1.1. Ten renderowania jest włączona, przy użyciu następujących opcji w pliku Web.config wewnątrz `<system.Web>` elementu:<br><br>`<pages controlRenderingCompatibilityVersion="4.0"/>`<br><br>Ta opcja jest ustawiona domyślnie 4.0. Projekty sieci Web, które są uaktualnienia z programu Visual Studio 2008 ma włączone zgodności ustawienie 3.5. | Brak. |

## <a name="core"></a>Core

### <a name="general-features"></a>Funkcje ogólne

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **CardSpace** | Program Windows CardSpace nie jest już umieszczana w .NET Framework; jest ona udostępniana oddzielnie. | Pobierz program Windows CardSpace z [Centrum pobierania Microsoft](https://go.microsoft.com/fwlink/?LinkId=199868). |
| **Pliki konfiguracji** | Poprawki zostały wprowadzone w sposób .NET Framework uzyskuje dostęp do plików konfiguracji aplikacji. | Jeśli plik konfiguracji aplikacji ma nazwę *name.config aplikacji*, zmień jej nazwę na *name.exe.config aplikacji*. Na przykład zmienić nazwę *MyApp.config* do *MojaAplikacja.exe.config*. |
| **Kompilator kodu języka C#** | `Compiler`, `CompilerError`, I `ErrorLevel` klas, które były <xref:Microsoft.CSharp> przestrzeni nazw nie są już dostępne, a ich zestawu (cscompmgd.dll) nie jest już umieszczana w .NET Framework. | Użyj <xref:System.CodeDom.Compiler.CodeDomProvider> klasy i innych klas w <xref:System.CodeDom.Compiler> przestrzeni nazw. Aby uzyskać więcej informacji, zobacz [Używanie modelu CodeDOM](https://msdn.microsoft.com/library/y2k85ax6(v=vs.100).aspx). |
| **Hosting** (niezarządzany interfejs API) | Aby zwiększyć możliwości hostingu, niektóre aktywacji hostingu interfejsy API są przestarzałe. -Process side-by-side wykonywania funkcje umożliwiają aplikację załadować i uruchomić wiele wersji .NET Framework w tym samym procesie. Na przykład, można uruchomić aplikacji, które ładują dodatków (lub składniki) które są oparte na programie .NET Framework 2.0 z dodatkiem SP1 i dodatki, które są oparte na .NET Framework 4, w tym samym procesie. Starsze składniki w dalszym ciągu używać starszych wersji .NET Framework i nowe składniki używana nowa wersja .NET Framework. | Korzystanie z konfiguracji opisanych w [-Process Side-by-Side wykonywania](/dotnet/framework/deployment/in-process-side-by-side-execution). |
| **Nowy model zabezpieczeń** | Zasady zabezpieczenia dostępu kodu, została wyłączona i zastąpiona uproszczony model, zgodnie z opisem w [zmiany zabezpieczeń w programie .NET Framework 4](https://msdn.microsoft.com/library/dd233103(v=vs.100).aspx). | Modyfikacje mogą być wymagane, jeśli są zależne od urzędów certyfikacji w swoich aplikacjach. Aby uzyskać więcej informacji, zobacz [zgodnością zasady zabezpieczeń dostępu kodu i migracji](/dotnet/framework/misc/code-access-security-policy-compatibility-and-migration). |

### <a name="date-and-time"></a>Data i godzina

Namespace: <xref:System>; zestaw: mscorlib (w mscorlib.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Oszczędność czasu letniego** | Aby zachować spójność z zegara systemowego, czas właściwości (takie jak <xref:System.TimeZoneInfo.Local> i <xref:System.DateTime.Now>) teraz używać reguł systemu operacyjnego zamiast innych danych .NET Framework dla operacji czasu letniego. | Brak. |
| **Ciągi formatujące** | Do obsługi formatowania kultury, <xref:System.TimeSpan> struktura zawiera nowe przeciążenia `ToString`, `Parse`, i `TryParse` metody z nowym `ParseExact` i `TryParseExact` metody. | Brak. |


### <a name="globalization"></a>Globalizacja

Aby uzyskać listę nowych neutralne i nacechowane zobacz [What's New in lokalizacja i globalizacja](https://msdn.microsoft.com/library/dd997383(v=vs.100).aspx).

Namespace: <xref:System.Globalization>; zestaw: mscorlib (w mscorlib.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Nazwy kultury** | Następujące zmiany nazw wpływają na kultur niemiecki, Malediwski i Afryki:<br><br>* <xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: Nazwa waluty dla języka niemieckiego (Switizerland) (de-CH) kultury został zmieniony z "sFr." Aby "Fr.".<br>* <xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: Wzorzec daty długiej dla Malediwski (Malediwy) (dv MV) kultury został zmieniony z "MMMM/dd/yyyy" na "dd/MM/yyyy".<br>* <xref:System.Globalization.DateTimeFormatInfo.PMDesignator>W dniu oznaczenie elementu Afrikaans (RPA) (af ZA) kultury został zmieniony z "nm" na "PM". | Należy pamiętać, zmiany nazwy kultury. |
| **Parametr LCID** | Aby zachować spójność z oczekiwane zachowanie w ustawieniach serwera automatyzacji, środowisko CLR nie jest już przekazuje bieżącej kultury na `LCID` parametr do niezarządzanej aplikacji opartych na modelu COM. Zamiast tego przekazuje 1033 (en-us) dla kultury. | Żadnych modyfikacji jest to konieczne, z wyjątkiem aplikacji natywnych, które wymagają określonej kultury. |
| **Kultura przestarzałe typy** | <xref:System.Globalization.CultureTypes> i <xref:System.Globalization.CultureTypes> kultury typy są obecnie przestarzałe.<br><br>W celu zapewnienia zgodności z poprzednimi wersjami <xref:System.Globalization.CultureTypes> teraz zwraca neutralne i nacechowane, które zostały zawarte w poprzedni .NET Framework i <xref:System.Globalization.CultureTypes> teraz zwraca pustą listę. | Użyj innych wartości <xref:System.Globalization.CultureTypes> wyliczenia. |
| **Trwa pobieranie kultury** | Począwszy od Windows 7, .NET Framework 4 pobiera informacje o ustawieniach kulturowych z systemu operacyjnego, zamiast przechowywania danych. Ponadto program .NET Framework synchronizuje się z Windows do sortowania i wielkość liter danych. | Brak. |
| **Standardy Unicode 5.1.** | .NET Framework obsługuje teraz wszystkie znaki Unicode 5.1 — Dodawanie około 1400 znaków. Dodatkowe znaki obejmują nowych symboli, strzałki, znaki diakrytyczne, znaki interpunkcyjne, symbole matematyczne, pociągnięć CJK i ideogramy, dodatkowe malajalam i Telugu znaki numeryczne i różnych Myanmar, łaciński, arabski, grecki, mongolski i cyrylica znaki. Następujące nowe skrypty są obsługiwane przy użyciu standardu Unicode 5.1: Sundanese, znaki Lepcha, Ol Chiki, Vai, Saurashtra, Kayah Li, Rejang, Gurmukhi, Odia, tamilski, Telugu i malajalam i Cham. | Brak. |

### <a name="exceptions"></a>Wyjątki

Przestrzenie nazw: <xref:System>, <xref:System.Runtime.ExceptionServices>; zestaw: mscorlib (w mscorlib.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Wyjątki dotyczące stanu procesu uszkodzony** | Środowisko CLR nie jest już dostarcza wyjątki dotyczące stan uszkodzony procesu do obsługi wyjątków w kodzie zarządzanym. | Te wyjątki wskazują, czy stan procesu został uszkodzony. Firma Microsoft nie zaleca się uruchomienie aplikacji w tym stanie.<br><br>Aby uzyskać więcej informacji, zobacz <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> i wpis [obsługi wyjątków stan uszkodzony](https://go.microsoft.com/fwlink/?LinkID=179681) w blogu CLR Inside Out. |
| **Wyjątki aparatu wykonywania** | <xref:System.ExecutionEngineException> jest już nieaktualny, ponieważ wyjątek przechwytywalne umożliwi niestabilne procesu będą nadal działać. Ta zmiana zwiększa stabilności i niezawodności w środowisku uruchomieniowym. | Użyj <xref:System.InvalidOperationException> celu sygnalizowania, że warunek. |

### <a name="reflection"></a>Odbicie

Namespace: <xref:System.Reflection>; zestaw: mscorlib (w mscorlib.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Algorytmy wyznaczania wartości skrótu zestawu** | <xref:System.Reflection.AssemblyName.HashAlgorithm> Zwraca teraz właściwość <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm>, ponieważ środowisko uruchomieniowe nie zna algorytmu wyznaczania wartości skrótu przywoływanego zestawu, gdy zestaw nie jest załadowany. (Dotyczy to przy użyciu właściwości w przywoływanym zestawie zwracany przez <xref:System.Reflection.Assembly.GetReferencedAssemblies%2A> metody.) | Brak. |
| **Ładowanie zestawu** | Aby zapobiec nadmiarowe, ładowanie zestawów i zapisanie w wirtualnej przestrzeni adresowej, środowisko CLR teraz ładuje zestawy przy użyciu tylko Win32 `MapViewOfFile` funkcji. Nie jest już także `LoadLibrary` funkcji.<br><br>Ta zmiana dotyczy diagnostyki aplikacji, w następujący sposób:<br><br>* A <xref:System.Diagnostics.ProcessModuleCollection> nie będzie już zawierał wszystkie moduły z biblioteki klas (plik dll), po uzyskaniu wyniku wywołania `Process.GetCurrentProcess().Modules`.<br>* Win32 — aplikacje używające `EnumProcessModules` funkcji nie będą widzieć wszystkie zarządzane moduły na liście. | Brak. |
| **Deklarowanie typu** | <xref:System.Type.DeclaringType> Właściwość teraz prawidłowo zwraca wartość null, jeśli typ nie ma typ deklarujący. | Brak. |
| **Delegaci** | Delegat teraz zgłasza <xref:System.ArgumentNullException> zamiast <xref:System.NullReferenceException> po wartości null jest przekazywana do konstruktora delegata. | Upewnij się, że każdy wyjątek, obsługa połowy <xref:System.ArgumentNullException>. |
| **Zmiana lokalizacji pamięci podręcznej zestawów globalnych** | Dla zestawów .NET Framework 4, global assembly cache została przeniesiona z katalogu Windows (% WINDIR %) w podkatalogu Microsoft.Net (*% WINDIR %\\Microsoft.Net*). Zestawy z wcześniejszych wersji pozostają w starszych katalogu.<br><br>Niezarządzaną [asm_cache_flags —](../unmanaged-api/fusion/asm-cache-flags-enumeration.md) wyliczenia zawiera nowe `ASM_CACHE_ROOT_EX` flagi. Ta flaga pobiera lokalizację pamięci podręcznej zestawów .NET Framework 4, które można uzyskać za [getcachepath —](../unmanaged-api/fusion/getcachepath-function.md) funkcji. | Brak, przy założeniu, że aplikacje nie używają jawne ścieżek do zestawów, który nie jest zalecanym rozwiązaniem. |
| **Narzędzie Global assembly cache** | [Gacutil.exe (Global Assembly Cache Tool)](https://msdn.microsoft.com/library/ex0ss12c(v=vs.100).aspx) już nie obsługuje podglądu wtyczki powłoki. | Brak. |

### <a name="interoperability"></a>Współdziałanie

Namespace: <xref:System.Runtime.InteropServices>; zestaw: mscorlib (w mscorlib.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Długość buforu** (niezarządzany interfejs API) | Zapisanie w pamięci, funkcja `pBufferLengthOffset` parametr [icorprofilerinfo2::getstringlayout —](../unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method.md) metoda została zmieniona, tak aby dopasować `pStringLengthOffset` parametru. Oba parametry teraz wskaż lokalizację przesunięcia o długości ciągu. Długość buforu został usunięty z reprezentacji klasa string. | Usuń jej zależności od długości buforu. |
| **Debugowanie JIT** | Aby uprościć rejestrację just-in-time (JIT) debugowania, debuger .NET Framework używa tylko AeDebug klucz rejestru, który kontroluje JIT debugowania zachowania dla kodu natywnego. Ta zmiana powoduje następujące czynności:<br><br>* Nie jest już można zarejestrować dwa inne debugery kodu zarządzanego i natywnego.<br>* Można już uruchomić debuger automatycznie dla procesu nieinteraktywnego, ale możesz też monitować użytkownika na potrzeby procesu interaktywnego.<br>* Nie jest już otrzymasz powiadomienie, gdy debuger nie można uruchomić lub nie ma żadnych zarejestrowanych debugera, który powinien zostać uruchomiony.<br>* Zasady automatyczne uruchamianie, które są zależne od interakcji aplikacji nie są już obsługiwane. | Dostosuj operacje debugowania zgodnie z potrzebami. |
| **Wywołanie platformy** | W celu poprawy wydajności w współdziałanie z kodem niezarządzanym niepoprawne konwencji wywoływania na platformie wywołać Przyczyna teraz aplikacji nie powiedzie się. W poprzednich wersjach organizowania warstwy rozwiązać te błędy w górę stosu. | Debugowanie aplikacji w programie Microsoft Visual Studio ostrzega o tych błędów, dzięki czemu można je poprawić.<br><br>W przypadku plików binarnych, których nie można zaktualizować mogą obejmować [ \<NetFx40_PInvokeStackResilience >](../configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element.md) elementu w pliku konfiguracji aplikacji, aby umożliwić wywołującym błędy zostać rozwiązany w górę stosu, podobnie jak w wcześniejszych wersjach. Może to jednak wpłynąć na wydajność aplikacji. |
| **Usunięte interfejsów** (niezarządzany interfejs API) | Aby uniknąć nieporozumień dla deweloperów, następujące interfejsy zostały usunięte, ponieważ nie dostarczył żadnych przydatne w scenariuszach środowiska wykonawczego, a środowisko CLR nie zapewniają ani akceptować implementacjami:<br><br>* **INativeImageINativeImageDependency**<br>* **INativeImageInstallInfo**<br>* **INativeImageEvaluate**<br>* **INativeImageConverter**<br>* **ICorModule**<br>* **Imetadataconverter —** | Brak. |

## <a name="data"></a>Dane

W tej sekcji opisano problemy z migracją za pomocą zestawów danych i klientów programu SQL, platformy Entity Framework LINQ to SQL i serwery danych WCF (wcześniej znane jako architektury ADO.NET Data Services).

### <a name="dataset-and-sql-client"></a>Zestaw danych i Klient SQL

W poniższej tabeli opisano ulepszenia funkcji, które poprzednio miały ograniczenia lub innych kwestiach.

Przestrzenie nazw: <xref:System.Data>, <xref:System.Data.Objects.DataClasses>, <xref:System.Data.SqlClient>; zestawów: dane systemowe (w System.Data.dll), System.Data.Entity (w System.Data.Entity.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Obiektów POCO scenariuszy** | <xref:System.Data.Objects.DataClasses.IRelatedEnd> Interfejs ma nowe metody, aby zwiększyć jej użyteczność w scenariuszach zwykłe stare CLR obiektu (— POCO). Te nowe metody przyjmują <xref:System.Object> zamiast <xref:System.Data.Objects.DataClasses.IEntityWithRelationships> jednostki jako parametr. |
| **Edytowanie wierszy** | <xref:System.Collections.IList.IndexOf%2A> Jako implementowany przez metodę <xref:System.Data.DataView> klasy, teraz prawidłowo zwraca wartość liczby wierszy, który jest edytowany, zamiast zwracać wartość -1. |
| **Zdarzenia** | <xref:System.Data.DataRowView.PropertyChanged> Zdarzenie jest zgłaszane teraz, gdy wiersz jest w stanie zmodyfikowany i <xref:System.Data.DataRow.RejectChanges%2A> metoda jest wywoływana. Ta zmiana ułatwia tworzenie kontrolek interfejsu użytkownika, które uwidaczniają zawartość <xref:System.Data.DataSet> obiektu. |
| **Wyjątki** | <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> Zgłasza teraz metoda <xref:System.InvalidOperationException> gdy połączenia nie jest ustawiona lub Otwórz zamiast <xref:System.NullReferenceException>. |
| **Mapowanie widoków** | Błędy mapowania widoku zapytania teraz są przechwytywane w czasie projektowania, zamiast zgłaszać <xref:System.NullReferenceException> w czasie wykonywania.<br><br>Teraz weryfikacji mapowania połowy błąd, w której skojarzenie dwóch zestawów w schematu koncepcyjnego (CSDL) są mapowane na tej samej kolumny. |
| **Transakcje** | Jeśli aplikacja podejmuje próbę wykonania instrukcji na połączenie po zakończeniu transakcji (w tym przerwane lub walcowanego tył), <xref:System.InvalidOperationException> jest teraz generowany. Poprzednie wersje zgłoszenie wyjątku i nie umożliwiają wykonywanie dodatkowych poleceń, nawet wtedy, gdy transakcja została przerwana. |

### <a name="entity-framework"></a>Entity Framework

W poniższej tabeli opisano ulepszenia funkcji, które poprzednio miały ograniczenia lub innych kwestiach.

Przestrzenie nazw: <xref:System.Data>, <xref:System.Data.Objects>, <xref:System.Data.Objects.DataClasses>; zestaw: System.Data.Entity (w System.Data.Entity.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Obiekty jednostki** | Teraz jest parzystość <xref:System.Data.Objects.ObjectContext.Detach%2A> metody i stan obiektu jednostki po <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> metoda jest wywoływana. Ten spójności ulepszone zapobiega nieoczekiwane wyjątki od zgłaszane. |
| **Jednostki SQL** | Zasady zostały ulepszone do rozpoznawania identyfikatora jednostki SQL.<br><br>Analizator składni SQL jednostki poprawiła logiki rozpoznawania wieloczęściowych identyfikatorów. |
| **Adnotacje strukturalnych** | Entity Framework rozpoznaje teraz strukturalnych adnotacji. |
| **Zapytania** | W zapytaniach wprowadzono następujące ulepszenia:<br><br>* A `GroupBy` zapytanie przy użyciu klucza o wartości null dla pustej kolekcji nie będzie zwracać wszystkie wiersze, niezależnie od tego, jeśli ma żadnych dodatkowych wybiera w zapytaniu.<br>* Wygenerowane zapytań SQL, w LINQ i jednostki SQL teraz Traktuj parametry jako wartości innego niż Unicode domyślnie. |

### <a name="linq-to-sql"></a>LINQ do SQL

W poniższej tabeli opisano ulepszenia funkcji, które poprzednio miały ograniczenia lub innych kwestiach.

Namespace: <xref:System.Data.Linq>; zestaw: System.Data.Linq (w System.Data.Linq.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Zdarzenia** | A <xref:System.Data.Linq.EntitySet%601> zgłasza teraz kolekcji <xref:System.Data.Linq.EntitySet%601.ListChanged> zdarzenie Dodaj i Usuń operacje, jeśli <xref:System.Data.Linq.EntitySet%601> jest zwalniana, oprócz podnoszonego zdarzenia, gdy kolekcja jest ładowany. |
| **Zapytania** | `Skip(0)` kwerendy SQL nie jest już jest ignorowany w składniku LINQ. W wyniku zapytania, które mają ta metoda może zachowywać się inaczej. Na przykład w niektórych przypadkach `OrderBy` klauzula jest wymagany w przypadku `Skip(0)`, i teraz zgłosi zapytanie <xref:System.NotSupportedException> wyjątek Jeśli `OrderBy` klauzula nie jest dołączony. |

### <a name="wcf-data-services"></a>Usługi danych WCF

W poniższej tabeli opisano ulepszenia funkcji, które poprzednio miały ograniczenia lub innych kwestiach.

Przestrzenie nazw: <xref:System.Data.Services>, <xref:System.Data.Services.Client>, <xref:System.Data.Services.Common>, <xref:System.Data.Services.Providers>; zestawów: System.Data.Services (w System.Data.Services.dll), System.Data.Services.Client (w System.Data.Services.Client.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Wsadowa zawartość binarna** | Usługi danych WCF obsługuje teraz wsadowej zawartość binarną w żądań i odpowiedzi. |
| **Interceptory zmiany** | Interceptory zmiany są teraz wykonywane dla żądanie usunięcia.<br><br>Interceptor zmiany to metoda, która jest uruchamiana za każdym razem, gdy żądanie zostanie odebrane przez serwer, aby zmodyfikować jednostki w zestawie jednostek. Jest ono uruchamiane przed wykonaniem żądania przychodzącego. Interceptor zmian zapewnia dostęp do jednostki, który został zmieniony i operacji, która jest wykonywana na nim. |
| **Wyjątki** | Następujące warunki teraz zgłaszają bardziej użyteczny, wyjątki, zamiast <xref:System.NullReferenceException>:<br><br>* A <xref:System.ServiceProcess.TimeoutException> po limitu czasu połączenia z usługą danych.<br>* A <xref:System.Data.Services.Client.DataServiceRequestException> nawiązaniem złe żądanie do usługi danych.<br><br>W aplikacjach należy zmienić obsługi wyjątków przechwytują wyjątki nowe. |
| **Nagłówki** | Nagłówki wprowadzono następujące ulepszenia:<br><br>* WCF Data Services teraz poprawnie odrzuca `eTag` nagłówek, który ma wartość nieokreślony.<br>* WCF Data Services teraz zwraca błąd i nie jest wykonywane żądanie żądania usunięcia łącza po `if-*` nagłówka znajduje się w żądaniu.<br>* WCF Data Services teraz zwraca błąd do klienta w formacie (Atom, JSON), który klient określony w nagłówku Accept. |
| **Czytnik JSON** | Czytnik JavaScript Object Notation (JSON) teraz poprawnie zwraca błąd, jeśli odczytuje pojedynczy ukośnik odwrotny ("\\") znak ucieczki dla znaków, podczas przetwarzania ładunków JSON wysyłane do usługi danych WCF. |
| **Scala** | Wprowadzono następujące ulepszenia <xref:System.Data.Services.Client.MergeOption> wyliczenia:<br><br>* <xref:System.Data.Services.Client.MergeOption> Opcja scalania nie modyfikuje jednostki na kliencie w wyniku kolejne odpowiedzi od usługi danych.<br>* <xref:System.Data.Services.Client.MergeOption> Opcji jest teraz spójny między dynamiczny język SQL, a aktualizacje na podstawie procedury przechowywanej. |
| **Żądania** | <xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A> Wywoływana jest metoda teraz przed przetworzeniem żądania do usługi danych. Dzięki temu żądania do prawidłowego działania <xref:System.Data.Services.Providers.ServiceOperation> usług. |
| **Strumienie** | Usługi danych WCF nie jest już zamknięta bazowego strumienia dla operacji odczytu i zapisu. |
| **Identyfikatory URI** | Anulowanie identyfikatorów URI przez klienta usługi danych WCF problem został rozwiązany. |

## <a name="windows-communication-foundation-wcf"></a>Windows Communication Foundation (WCF)

W poniższej tabeli opisano ulepszenia funkcji, które poprzednio miały ograniczenia lub innych kwestiach.

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Pliki konfiguracji** | Aby włączyć dziedziczenia zachowania przez hierarchię plików konfiguracji, WCF obsługuje teraz, scalanie w plikach konfiguracji.<br><br>Teraz podzielonego model dziedziczenia konfiguracji umożliwiające użytkownikom na Definiowanie zachowania, które będą stosowane do wszystkich usług, które są uruchomione na komputerze.<br><br>Zmiany zachowania mogą wystąpić, jeśli istnieją zachowania o takiej samej nazwie na różnych poziomach hierarchii. |
| **Usługa hostingu** | Nie można określić `<serviceHostingEnvironment>` elementu konfiguracji na poziomie usługi, dodając atrybut `allowDefinition="MachineToApplication"` do definicji elementu.<br><br>Określanie `<serviceHostingEnvironment>` elementu na poziomie usługi są z technicznego punktu widzenia niepoprawne i powodując niespójne zachowanie. |

## <a name="windows-presentation-foundation-wpf"></a>Windows Presentation Foundation (WPF)

### <a name="applications"></a>Aplikacje

Przestrzenie nazw: <xref:System.Windows>, <xref:System.Windows.Controls>; zestaw: PresentationFramework (w PresentationFramework.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Obsługa wyjątków** | Aby włączyć można wcześniej wykryć błędy, zgłasza WPF <xref:System.Reflection.TargetInvocationException> i ustawia <xref:System.Exception.InnerException> właściwość wyjątki krytyczne, takie jak <xref:System.NullReferenceException>, <xref:System.OutOfMemoryException>, <xref:System.StackOverflowException>, i <xref:System.Security.SecurityException>, zamiast Przechwytywanie oryginalnego wyjątku. | Brak. |
| **Połączonych zasobów** | Aby zasobów było prostsze, łączenia plików (takich jak obrazy), które znajdują się w lokalizacji innej niż strukturze folderu projektu użyj pełną ścieżkę do pliku zasobów zamiast po prostu jego nazwa pliku jako identyfikator zasobu podczas kompilowania aplikacji. Aplikacja będzie mogła zlokalizować plików w czasie wykonywania. | Brak. |
| **Aplikacje częściowo zaufane** | Ze względów bezpieczeństwa aplikacji opartych na Windows, które działają w częściowego zaufania i zawierać <xref:System.Windows.Controls.WebBrowser> kontroli lub <xref:System.Windows.Controls.Frame> formant, który zawiera kod HTML będzie zgłaszać wyjątek <xref:System.Security.SecurityException> po utworzeniu kontrolki.<br><br>Aplikacje przeglądarkowe spowoduje zgłoszenie wyjątku i wyświetlić komunikat, jeśli są spełnione wszystkie następujące warunki:<br><br>* Aplikacja jest uruchomiona w przeglądarce Firefox.<br>* Aplikacja jest uruchomiona w trybie częściowego zaufania strefie Internet z innych zaufanych witryn.<br>* Ta aplikacja zawiera <xref:System.Windows.Controls.WebBrowser> kontroli lub <xref:System.Windows.Controls.Frame> formant, który zawiera kod HTML.<br><br>Należy pamiętać, aplikacje, które korzystają z zaufanych witryn lub ze strefy intranetowej nie zostaną zmienione. | W aplikacjach przeglądarki może ułatwić tę zmianę, wykonując jedną z następujących czynności:<br><br>* Uruchom aplikację przeglądarki w trybie pełnego zaufania.<br>* Mają klientów, Dodaj witrynę aplikacji do strefy Zaufane witryny.<br>* Mają klientom uruchamianie aplikacji w programie Internet Explorer. |
| **Słowniki zasobów** | Aby zwiększyć słowników zasobów na poziomie motywu i uniemożliwić zmianę, freezable zasoby, które są zdefiniowane w słowniku zasobów i scalenia ich z słownika poziom motywu są teraz zawsze oznaczone jako zablokowany i są niezmienne. Jest to oczekiwane zachowanie freezable zasobów. | Aplikacje, które modyfikują z zasobem, który jest zdefiniowany w słowniku scalonych poziom motywu należy sklonować zasobu i zmodyfikuj sklonowanej kopii. Alternatywnie, można oznaczyć zasób `x:Shared="false"` tak, aby <xref:System.Windows.ResourceDictionary> tworzy nową kopię za każdym razem, gdy zasób zostaje przesłane zapytanie. |
| **Windows 7** | Aby aplikacje WPF działają lepiej na Windows 7, wprowadzono następujące ulepszenia, aby poprawić działanie okna:<br><br>* Zadokować i gestów współpracują teraz stanów jako użytkownika na podstawie oczekiwanego interakcji.<br>* Polecenia paska zadań **kaskadowo systemu windows, Pokaż okna skumulowany**, i **Pokaż okna side-by-side** teraz ma poprawne zachowanie i zaktualizuj odpowiednie właściwości.<br>* `Top`, `Left`, `Width`, I `Height` właściwości zmaksymalizowanego lub zminimalizowanego okna zawierają teraz lokalizacji przywracania poprawne okna zamiast innych wartości w zależności od tego monitora. | Brak. |
| **Windows style i przezroczystości** | <xref:System.InvalidOperationException> Jest generowany, Jeśli spróbujesz ustawić <xref:System.Windows.Window.WindowStyle> wartość inną niż <xref:System.Windows.WindowStyle> podczas <xref:System.Windows.Window.AllowsTransparency> jest `true` i <xref:System.Windows.WindowState> jest <xref:System.Windows.WindowState>. | Jeśli musisz zmienić <xref:System.Windows.Window.WindowStyle> podczas <xref:System.Windows.Window.AllowsTransparency> jest `true`, można wywołać Win32 `SetWindowLongPtr` funkcji. |
| **Przeglądarka plików XPS** | WPF nie obejmuje Microsoft XML Paper specyfikacji Essentials pakietu (XPSEP). XPSEP jest dołączony do Windows 7 i Windows Vista.<br><br>Na komputerze z systemem Windows XP bez .NET Framework 3.5 z dodatkiem SP1 zainstalowane drukowanie przy użyciu interfejsu API programu WPF, inne niż te w <xref:System.Windows.Controls.PrintDialog> będzie zależny od WINSPOOL. Niektóre funkcje drukarki nie będą raportowane i niektóre ustawienia drukarki nie będą stosowane podczas drukowania. | Jeśli to konieczne, zainstaluj [Microsoft XML Paper specyfikacji Essentials dodatkiem Service Pack](https://go.microsoft.com/fwlink/?LinkId=178895). |

### <a name="controls"></a>Formanty

Przestrzenie nazw: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; zestawów: PresentationFramework (w PresentationFramework.dll), PresentationCore (w PresentationCore.dll), WindowsBase (w WindowsBase.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Okna dialogowe** | Aby zwiększyć niezawodność, <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> metoda jest wywoływana w tym samym wątku, który utworzony <xref:Microsoft.Win32.FileDialog> kontroli. | Pamiętaj utworzyć <xref:Microsoft.Win32.FileDialog> kontroli i wywołać <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> metody w tym samym wątku. |
| **Przestawianie okien** | Aby rozwiązać problem fokus przywracania logikę, która niepoprawnie utrzymuje uaktywnia przestawne okno (tworząc z niej wyglądają jak modalne okno dialogowe), przywracanie fokus teraz nie może Jeśli kandydat nie jest elementem podrzędnym okna. | Brak. |
| **Elementy w kolekcji** | Gdy element jest przeniesiony lub dodawane do podstawowej kolekcji, pojawia się w <xref:System.Windows.Data.CollectionView> w tej samej względnej lokalizacji Jeśli <xref:System.Windows.Data.CollectionView> nie jest posortowana. Zapewnia to spójność między położenie elementu w kolekcji i w skojarzonej <xref:System.Windows.Data.CollectionView>. | Użyj <xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> lub <xref:System.Windows.Data.CollectionView.IndexOf%2A> metodę, aby znaleźć lokalizację elementu w <xref:System.Windows.Data.CollectionView> zamiast polegania na stałych lokalizacji elementu. |
| **Układy** | Aby wyeliminować niepotrzebne re układów, zmiana <xref:System.Windows.Controls.Page.ShowsNavigationUI> już unieważnia układu lub powoduje przekazanie innego układu. | Jeśli spodziewasz się, że zmiana <xref:System.Windows.Controls.Page.ShowsNavigationUI> spowoduje, że inny układ przekazać, wywołaj <xref:System.Windows.UIElement.InvalidateVisual%2A> po ustawieniu właściwości. |
| **Menu** | Aby włączyć ClearType tekst w menu wyskakujące okienka, zostały wprowadzone zmiany <xref:System.Windows.Controls.ControlTemplate> klasy i <xref:System.Windows.Controls.MenuItem> i inne kontrolki. | Aplikacje nie należy polegać na strukturze visual szablony kontrolek. Tylko o nazwie części <xref:System.Windows.Controls.ControlTemplate> stanowią część publicznego kontraktu. Jeśli aplikacja musi znaleźć niektórych obiektu <xref:System.Windows.Controls.ControlTemplate>, przeszukać drzewo wizualne dla określonego typu zamiast polegania na stałych położenie obiektu w drzewie. |
| **Nawigacja** | Jeśli <xref:System.Windows.Controls.Frame> bezpośrednio powoduje przejście do lokalizacji, <xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> właściwość `true` po początkowej nawigacji. Ta zmiana zapobiega dodatkowych zdarzeń zgłaszanych w trakcie scenariuszom dla programów próbnych. | Brak. |
| **Wyskakujące okienka** | <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> Delegata może teraz zostać wywołane wielokrotnie podczas przekazanie układu, a nie tylko raz. | Jeśli Twoje <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> delegata oblicza pozycję <xref:System.Windows.Controls.Primitives.Popup> na podstawie jego poprzedniej pozycji, Oblicz ponownie pozycji tylko wtedy, gdy wartości `popupSize`, `targetSize`, lub `offset` zmiany parametrów. |
| **Wartości właściwości** | <xref:System.Windows.DependencyObject.SetCurrentValue%2A> — Metoda umożliwia teraz ustawić właściwości wartość skuteczne, mimo że kontynuuje uwzględnia wszystkie powiązania, stylu lub wyzwalacz, który wpływa na właściwości. | Kontrolka Autorzy powinni używać <xref:System.Windows.DependencyObject.SetCurrentValue%2A> zawsze po zmianie wartości właściwości jako efekt uboczny innych działań, w tym manipulowanie użytkownika. |
| **Pola tekstowe** | Ze względów bezpieczeństwa <xref:System.Windows.Forms.TextBoxBase.Copy%2A> i <xref:System.Windows.Forms.TextBoxBase.Cut%2A> metody po cichu nie wywołanego w częściowej relacji zaufania.<br><br>Ponadto programowe wykonywanie <xref:System.Windows.Input.ApplicationCommands.Copy> lub <xref:System.Windows.Input.ApplicationCommands.Cut> właściwość kontrolki, która dziedziczy <xref:System.Windows.Controls.Primitives.TextBoxBase> zostanie zablokowane w częściowej relacji zaufania. Jednak inicjowane przez użytkownika kopiowanie i wklejanie wyciętych poleceń, takich jak kliknięcie przycisku którego <xref:System.Windows.Controls.Primitives.ButtonBase.Command> właściwość jest powiązana z jednego z następujących poleceń, będą działać. Standardowa kopiowania i wycinania za pomocą skrótów klawiaturowych i menu kontekstowego nadal będzie działać tak jak poprzednio w częściowej relacji zaufania. | Powiąż <xref:System.Windows.Input.ApplicationCommands.Copy> lub <xref:System.Windows.Input.ApplicationCommands.Cut> działanie inicjowane przez użytkownika, takie jak kliknięcie przycisku polecenia. |

### <a name="graphics"></a>Grafika

Przestrzenie nazw: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Media.Effects>; zestawów: PresentationFramework (w PresentationFramework.dll), PresentationCore (w PresentationCore.dll), WindowsBase (w WindowsBase.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Efekty mapy bitowej** | Aby zwiększyć wydajność, <xref:System.Windows.Media.Effects.BitmapEffect> klasy i klas, które dziedziczą z <xref:System.Windows.Media.Effects.BitmapEffect> klasy, chociaż nadal obecna, są wyłączone. Efekt będzie renderowany przy użyciu potoku renderowanie przyspieszane sprzętowo, jeśli są spełnione następujące warunki:<br><br>* Aplikacja używa <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> lub <xref:System.Windows.Media.Effects.BlurBitmapEffect> że właściwość radius ustawił DIU mniej niż 100.<br>* Karty wideo na komputerze, na którym działa aplikacja obsługuje program do cieniowania pikseli w wersji 2.0.<br><br>Jeśli te warunki nie są spełnione, <xref:System.Windows.Media.Effects.BitmapEffect> obiektu nie odniesie żadnego skutku.<br><br>Ponadto programu Visual Studio generuje ostrzeżenie kompilatora po napotkaniu <xref:System.Windows.Media.Effects.BitmapEffect> obiektu lub podklasę.<br><br><xref:System.Windows.Media.DrawingContext.PushEffect%2A> Metody jest oznaczony jako przestarzały. | Przerwanie, za pomocą starszego <xref:System.Windows.Media.Effects.BitmapEffect> klasy pochodne i zamiast tego użyć nowej klasy pochodne od elementu <xref:System.Windows.Media.Effects.Effect>: <xref:System.Windows.Media.Effects.BlurEffect>, <xref:System.Windows.Media.Effects.DropShadowEffect>, i <xref:System.Windows.Media.Effects.ShaderEffect>.<br><br>Można również utworzyć własne efekty przez dziedziczenie z <xref:System.Windows.Media.Effects.ShaderEffect> klasy. |
| **Mapa bitowa ramki** | Sklonowany <xref:System.Windows.Media.Imaging.BitmapFrame> obiektów teraz odbierać <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>, i <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> zdarzenia. Dzięki temu obrazy, które zostaną pobrane z sieci Web i zastosowane do <xref:System.Windows.Controls.Image> kontrolować za pośrednictwem <xref:System.Windows.Style> działała prawidłowo.<br><br>Zmiany w zachowaniu zostanie wyświetlony tylko wtedy, gdy spełnione są wszystkie z następujących instrukcji:<br><br>* Możesz zasubskrybować <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>, lub <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> zdarzeń.<br>* Źródło <xref:System.Windows.Media.Imaging.BitmapFrame> pochodzi z sieci Web.<br>* <xref:System.Windows.Media.Imaging.BitmapFrame> Został sklonowany, gdy pobierany jest nadal w toku. | Sprawdź nadawcy w obsłudze zdarzeń i podejmij działania, tylko wtedy, gdy nadawca oryginalny <xref:System.Windows.Media.Imaging.BitmapFrame>. |
| **Dekodowanie obrazów** | Aby zapobiec <xref:System.IO.IOException> z nie jest obsługiwany, gdy obrazy nie może zdekodować, <xref:System.Windows.Media.Imaging.BitmapSource> zgłosi klasy <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> zdarzenie, kiedy nie dekoduje obrazu. | Usuń wszelkie obsługi dla wyjątków <xref:System.IO.IOException>i użyj <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> zdarzeń pod kątem dekodowania awarii. |

### <a name="input"></a>Dane wejściowe

Przestrzenie nazw: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; zestawów: PresentationFramework (w PresentationFramework.dll), PresentationCore (w PresentationCore.dll), WindowsBase (w WindowsBase.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Powiązanie polecenia wystąpień** | Mechanizm, aby powiązać polecenia oparta na modelu widoku wystąpień na podstawie widoku danych wejściowych gestów <xref:System.Windows.Input.InputBinding> klasy, ale teraz dziedziczy <xref:System.Windows.Freezable> zamiast <xref:System.Windows.DependencyObject>. Właściwości zależności są teraz następujące właściwości:<br><br>* <xref:System.Windows.Input.InputBinding.Command><br>* <xref:System.Windows.Input.InputBinding.CommandParameter><br>* <xref:System.Windows.Input.InputBinding.CommandTarget><br><br>Ta zmiana powoduje następujące czynności:<br><br>* <xref:System.Windows.Input.InputBinding> Obiekt teraz jest zamrożony po jej zarejestrowaniu zamiast pozostałe modyfikowalna.<br>* Niedostępne na poziomie wystąpienia <xref:System.Windows.Input.InputBinding> obiektów z wielu wątków, ze względu na ograniczenia elementu <xref:System.Windows.DependencyObject> klasy.<br>* Możesz nie można zmutować powiązania danych wejściowych na poziomie klasy po ich rejestracji, ze względu na ograniczenia elementu <xref:System.Windows.Freezable> klasy.<br>* Powiązania danych wejściowych nie można określić w wystąpieniach polecenia, które są tworzone w modelu widoku. | Utwórz oddzielne wystąpienia <xref:System.Windows.Input.InputBinding> klasy w oddzielnych wątkach, w przypadku powiązania mutable lub Blokuj je w przeciwnym razie. Mutuje statyczne klasy poziomie <xref:System.Windows.Input.InputBinding> po jego zarejestrowaniu. |
| **Aplikacje przeglądarki** | Aplikacje przeglądarki WPF (. Kluczowych zdarzeń procesu teraz XBAP) tak jak aplikacje autonomiczne WPF, tak aby obiekty odbierać zdarzenia trasowane klucza w odpowiedniej kolejności. | Brak. |
| **Kombinacje martwy klawisz** | WPF zaciemnia martwy klucze, które generuje żadne znaki widoczne, ale zamiast tego wskazuje, że klucz jest ma być połączona z kluczem litery dalej w celu utworzenia jeden znak. Klucz wejściowych zdarzenia, takie jak <xref:System.Windows.Input.Keyboard.KeyDownEvent> zdarzenie, raportów, gdy klucz jest martwy klawisz, ustawiając <xref:System.Windows.Input.KeyEventArgs.Key> właściwości <xref:System.Windows.Input.Key> wartość. Jest to zwykle oczekiwane zachowanie, ponieważ aplikacje zazwyczaj nie będą odpowiadać na danych wprowadzonych z klawiatury, tworzącą znak połączone. | Aplikacje, które oczekują na odczytywanie kluczy, które były częścią znaków łączonych można uzyskać klucz teraz zaciemnionego za pomocą <xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey> właściwości. |
| **Menedżer koncentracji uwagi** | Gdy <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> metoda przechodzi przez element, który ma [IsFocusScope](https://msdn.microsoft.com/library/system.windows.input.focusmanager.isfocusscope.aspx) dołączona właściwość, ustaw `true`, Metoda ta zwraca element, który jest ostatnim elementem skoncentrowane na klawiaturze w tym zakresie fokus w przypadku i tylko wtedy, gdy Zwrócony element należy do tej samej <xref:System.Windows.PresentationSource> obiektu jako element, który jest przekazywany do metody. | Brak. |

### <a name="ui-automation"></a>Automatyzacja interfejsu użytkownika

Namespace: <xref:System.Windows>, <xref:System.Windows.Automation.Peers>, <xref:System.Windows.Automation.Provider>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; zestawów: PresentationFramework (w PresentationFramework.dll), PresentationCore (w PresentationCore.dll) UIAutomationProvider (w UIAutomationProvider.dll), WindowsBase (w WindowsBase.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Hierarchia klas widoków** | <xref:System.Windows.Automation.Peers.TreeViewAutomationPeer> i <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> klasy dziedziczą <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> zamiast <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>. | Jeśli dziedziczą z <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> klasy i zastąpienie <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A> metody, należy wziąć pod uwagę zwrócenie obiektu, który dziedziczy z nowym <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer> klasy. |
| **Kontenery poza ekranem** | Aby naprawić nieprawidłową wartość zwracaną <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A> metoda teraz poprawnie zwraca `false` dla kontenerów elementów, które jest przewijane poza widokiem. Ponadto wartość metody, nie dotyczy zamknięcia przez inne okna lub tego, czy element jest widoczny na konkretnego monitora. | Brak. |
| **Menu i obiekty podrzędne** | Włączyć automatyzacji interfejsu użytkownika z menu, które zawierają elementy podrzędne na innych niż <xref:System.Windows.Controls.MenuItem> obiektów <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A> metoda teraz zwraca <xref:System.Windows.Automation.Peers.AutomationPeer> obiekt podrzędny <xref:System.Windows.UIElement> obiektu, zamiast <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer> obiektu. | Brak. |
| **Nowe interfejsy i zestawu** | Aby włączyć nowe funkcje dla automatyzacji interfejsu użytkownika, zostały dodane następujące interfejsy:<br><br>* <xref:System.Windows.Automation.Provider.IItemContainerProvider><br>* <xref:System.Windows.Automation.Provider.ISynchronizedInputProvider><br>* <xref:System.Windows.Automation.Provider.IVirtualizedItemProvider> | Jakiegokolwiek projektu, który tworzy elementy równorzędne automatyzacji WPF, należy dodać jawnego odwołania do UIAutomationProvider.dll. |
| **Thumbs** | <xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A> Metoda zwraca wartość zamiast wartości null. W związku z tym, określa formanty, takie jak <xref:System.Windows.Controls.GridSplitter> , dziedziczą z <xref:System.Windows.Controls.Primitives.Thumb> klasy zgłosi nazwy automatyzacji interfejsu użytkownika. | Brak. |
| **Zwirtualizowane elementy** | Aby zwiększyć wydajność, <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A> metoda zwraca tylko podrzędnych obiektów, które są rzeczywiście w drzewie wizualnym, a nie wszystkich obiektów podrzędnych, niezależnie od tego, czy są one zwirtualizowane. | Użyj <xref:System.Windows.Automation.ItemContainerPattern> do wykonywania iteracji wszystkich elementów <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer>. |

### <a name="xaml"></a>XAML

Przestrzenie nazw: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Markup>; zestawów: PresentationFramework (w PresentationFramework.dll), PresentationCore (w PresentationCore.dll), WindowsBase (w WindowsBase.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 | Zalecanych zmianach |
| ------- | ------------------------ | ------------------- |
| **Rozszerzenie znaczników** | WPF teraz poprawnie zawsze używa wartości z <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> metody zamiast zwracać <xref:System.Windows.Markup.MarkupExtension> obiektu w niektórych przypadkach, gdy rozszerzenie znaczników służy do ustawiania właściwości lub utworzyć nowy element w kolekcji. Rozszerzenie znaczników może zwrócić się w niektórych przypadkach. | Jeśli aplikacja uzyskuje dostęp do zasobu, który zwrócił <xref:System.Windows.Markup.MarkupExtension> obiektów w starszych wersjach, odwołaj się do obiektu, który jest zwracany z <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>, zamiast <xref:System.Windows.Markup.MarkupExtension> obiektu. |
| **Podczas analizowania atrybutów** | Atrybuty w XAML teraz może mieć tylko jedną kropkę. Na przykład że są prawidłowe:<br><br>`<Button Background="Red"/>` (nie okresy)<br><br>`<Button Button.Background = "Red"/>` (okres jednego)<br><br>Następujące nie jest już prawidłowy:<br><br>`<Button Control.Button.Background = "Red"/>` (więcej niż jedną kropkę) | Prawidłowe atrybuty XAML, które mają więcej niż jedną kropkę. |

## <a name="xml"></a>XML

Wiersze w tej tabeli opisano ulepszenia funkcji, które poprzednio miały ograniczenia lub innych kwestiach.

### <a name="schema-and-transforms"></a>Schemat i przekształcenia

Przestrzenie nazw: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; zestawów: System.Xml (w System.Xml.dll), System.Xml.Linq (w System.Xml.Linq.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Schematy Chameleon** | Aby zapobiec uszkodzeniu danych, schematów chameleon są teraz sklonowany poprawnie, gdy są one dołączone wiele schematów.<br><br>Schematy Chameleon są schematów, które nie ma docelowego obszaru nazw, a gdy są one uwzględnione w innym pliku XSD, przyjmują w docelowy obszar nazw Importowanie schematu. Są często używane do dołączenia popularnych typów do schematu. |
| **Identyfikator funkcji** | Przekształcenie XSLT [id — funkcja](/sql/xquery/functions-on-sequences-id) teraz zwraca prawidłową wartość zamiast wartości null, gdy <xref:System.Xml.XmlReader> obiekt jest przekazywany do XLST.<br><br>Jeśli użytkownik utworzył <xref:System.Xml.XmlReader> obiekt z LINQ do XML klasy przy użyciu <xref:System.Xml.Linq.XNode.CreateReader%2A> metody, a <xref:System.Xml.XmlReader> obiekt został przekazany do przekształcenia XSLT, wszystkie wystąpienia `id` funkcja XSLT wcześniej zwróciła wartość null. Nie jest dozwolone wartości zwracanej przez `id` funkcji. |
| **Atrybut Namespace** | Aby zapobiec uszkodzeniu danych <xref:System.Xml.XPath.XPathNavigator> teraz zwraca nazwę lokalnego `x:xmlns` atrybutu prawidłowo. |
| **Deklaracji Namespace** | <xref:System.Xml.XmlReader> Obiektu w poddrzewie nie tworzy już deklaracje zduplikowaną przestrzeń nazw w obrębie jednego elementu XML. |
| **Sprawdzanie poprawności schematu** | Aby zapobiec weryfikacji schematu błędne <xref:System.Xml.Schema.XmlSchemaSet> klasy umożliwia schematy XSD do skompilowania poprawnej i spójnej. Schematy te mogą zawierać inne schematy; na przykład `A.xsd` mogą obejmować `B.xsd`, które mogą obejmować `C.xsd`. Kompilowanie któregokolwiek z tych przyczyn ten wykres zależności, aby te typy można przemierzać. |
| **Funkcje skryptu** | [Funkcji dostępnych funkcji](https://msdn.microsoft.com/library/ms256124(v=vs.110).aspx) już niepoprawnie zwraca `false` gdy funkcja jest aktualnie dostępna. |
| **Identyfikatory URI** | <xref:System.Xml.Linq.XElement.Load%2A> Metoda teraz zwraca poprawne BaseURI w kwerendach LINQ. |

### <a name="validation"></a>Walidacja

Przestrzenie nazw: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; zestawów: System.Xml (w System.Xml.dll), System.Xml.Linq (w System.Xml.Linq.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Mechanizmy rozpoznawania elementów Namespace** | <xref:System.Xml.XmlReader.ReadContentAs%2A> Metoda nie jest już ignoruje <xref:System.Xml.IXmlNamespaceResolver> przekazany rozpoznawania nazw.<br><br>W poprzednich wersjach, zostało zignorowane program rozpoznawania nazw dla określonego obszaru nazw, a <xref:System.Xml.XmlReader> zamiast niej użyto. |
| **Biały znak** | Aby zapobiec utracie danych podczas tworzenia czytnika <xref:System.Xml.XmlReader.Create%2A> metoda nie jest już odrzuca istotnych białych.<br><br>Sprawdzanie poprawności kodu XML rozpoznaje zawartością mieszaną tryb, w którym tekst może być mieszany — przy użyciu znaczników XML. W trybie mieszanym wszystkich odstępów ma znaczenie i powinny być raportowane. |

### <a name="writing"></a>Zapisywanie

Przestrzenie nazw: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; zestawów: System.Xml (w System.Xml.dll), System.Xml.Linq (w System.Xml.Linq.dll)

| Funkcja | Różnice z 3.5 z dodatkiem SP1 |
| ------- | ------------------------ |
| **Odwołania do jednostek** | Aby zapobiec uszkodzeniu danych, odwołania do jednostek są już entitized dwa razy w atrybutów XML.<br><br>Jeśli użytkownik próbował zapisu jednostki do `xmlns` atrybut lub do `xml:lang` lub `xml:space` atrybutu przy użyciu <xref:System.Xml.XmlWriter.WriteEntityRef%2A> metody, jednostka została entitized dwa razy w danych wyjściowych, w związku z tym uszkodzenia danych. |
| **Obsługę nowego wiersza** | Aby zapobiec uszkodzeniu danych <xref:System.Xml.XmlWriter> obiektów względem <xref:System.Xml.NewLineHandling> opcji. |

## <a name="see-also"></a>Zobacz także

### <a name="reference"></a>Tematy pomocy

- [Nowe typy i członkowie w .NET Framework 4](https://msdn.microsoft.com/library/ff641764(v=vs.100).aspx)

### <a name="concepts"></a>Pojęcia

- [Przewodnik po migracji do programu .NET Framework 4](https://msdn.microsoft.com/library/ff657133(v=vs.100).aspx)
- [What's New in .NET Framework 4](https://msdn.microsoft.com/library/ms171868(v=vs.100).aspx)
- [Zgodność wersji w programie .NET Framework](../../../docs/framework/migration-guide/version-compatibility.md)
- [Migracja rozwiązań pakietu Office do programu .NET Framework 4](https://msdn.microsoft.com/library/ee207231.aspx)

### <a name="other-resources"></a>Inne zasoby

- [Co to jest przestarzała w bibliotece klas programu .NET Framework](../whats-new/whats-obsolete.md)