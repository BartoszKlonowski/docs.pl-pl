---
title: 'Wskazówki: wdrażanie formularza korzystającego z operacji w tle'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- threading [Windows Forms], forms
- BackgroundWorker component
- background tasks
- forms [Windows Forms], multithreading
- threading [Windows Forms], walkthroughs
- forms [Windows Forms], background operations
- threading [Windows Forms], background operations
- background operations
ms.assetid: 4691b796-9200-471a-89c3-ba4c7cc78c03
ms.openlocfilehash: 28b1ac924fb9b6b8cbc09db62ee33c6780bee820
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
ms.locfileid: "33542083"
---
# <a name="walkthrough-implementing-a-form-that-uses-a-background-operation"></a><span data-ttu-id="7ee12-102">Wskazówki: wdrażanie formularza korzystającego z operacji w tle</span><span class="sxs-lookup"><span data-stu-id="7ee12-102">Walkthrough: Implementing a Form That Uses a Background Operation</span></span>
<span data-ttu-id="7ee12-103">Jeśli masz operacji potrwa długo, i nie ma interfejsu użytkownika (UI) przestanie odpowiadać lub "zawiesza się," można użyć <xref:System.ComponentModel.BackgroundWorker> klasy, aby wykonać tę operację w innym wątku.</span><span class="sxs-lookup"><span data-stu-id="7ee12-103">If you have an operation that will take a long time to complete, and you do not want your user interface (UI) to stop responding or "hang," you can use the <xref:System.ComponentModel.BackgroundWorker> class to execute the operation on another thread.</span></span>  
  
 <span data-ttu-id="7ee12-104">W tym przewodniku przedstawiono sposób użycia <xref:System.ComponentModel.BackgroundWorker> klasę, aby wykonać obliczenia czasochłonne "w tle" podczas reaguje interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7ee12-104">This walkthrough illustrates how to use the <xref:System.ComponentModel.BackgroundWorker> class to perform time-consuming computations "in the background," while the user interface remains responsive.</span></span>  <span data-ttu-id="7ee12-105">Po zakończeniu wykonywania masz aplikację, która oblicza numery Fibonacci asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="7ee12-105">When you are through, you will have an application that computes Fibonacci numbers asynchronously.</span></span> <span data-ttu-id="7ee12-106">Mimo że obliczeniowych dużą liczbą Fibonacci może zająć zauważalne ilość czasu, głównego wątku interfejsu użytkownika nie zostanie przerwana przez to opóźnienie i formularz będzie odpowiadać podczas obliczania.</span><span class="sxs-lookup"><span data-stu-id="7ee12-106">Even though computing a large Fibonacci number can take a noticeable amount of time, the main UI thread will not be interrupted by this delay, and the form will be responsive during the calculation.</span></span>  
  
 <span data-ttu-id="7ee12-107">Zadania przedstawione w tym przewodniku obejmują:</span><span class="sxs-lookup"><span data-stu-id="7ee12-107">Tasks illustrated in this walkthrough include:</span></span>  
  
-   <span data-ttu-id="7ee12-108">Tworzenie aplikacji systemu Windows</span><span class="sxs-lookup"><span data-stu-id="7ee12-108">Creating a Windows-based Application</span></span>  
  
-   <span data-ttu-id="7ee12-109">Tworzenie <xref:System.ComponentModel.BackgroundWorker> w formularzu</span><span class="sxs-lookup"><span data-stu-id="7ee12-109">Creating a <xref:System.ComponentModel.BackgroundWorker> in Your Form</span></span>  
  
-   <span data-ttu-id="7ee12-110">Dodawanie programów obsługi zdarzeń asynchroniczne</span><span class="sxs-lookup"><span data-stu-id="7ee12-110">Adding Asynchronous Event Handlers</span></span>  
  
-   <span data-ttu-id="7ee12-111">Dodawanie raportowania postępu i obsługa anulowania</span><span class="sxs-lookup"><span data-stu-id="7ee12-111">Adding Progress Reporting and Support for Cancellation</span></span>  
  
 <span data-ttu-id="7ee12-112">Aby uzyskać pełną listę kod używany w tym przykładzie, zobacz [porady: Implementowanie formularza korzystającego z operacji w tle](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md).</span><span class="sxs-lookup"><span data-stu-id="7ee12-112">For a complete listing of the code used in this example, see [How to: Implement a Form That Uses a Background Operation](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7ee12-113">Okna dialogowe i polecenia menu mogą się różnić od tych opisanych w Pomocy, w zależności od ustawień aktywnych lub wydania.</span><span class="sxs-lookup"><span data-stu-id="7ee12-113">The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.</span></span> <span data-ttu-id="7ee12-114">Aby zmienić ustawienia, wybierz **Import i eksport ustawień** na **narzędzia** menu.</span><span class="sxs-lookup"><span data-stu-id="7ee12-114">To change your settings, choose **Import and Export Settings** on the **Tools** menu.</span></span> <span data-ttu-id="7ee12-115">Aby uzyskać więcej informacji, zobacz [Dostosowywanie ustawień środowiska w programie Visual Studio](http://msdn.microsoft.com/library/22c4debb-4e31-47a8-8f19-16f328d7dcd3).</span><span class="sxs-lookup"><span data-stu-id="7ee12-115">For more information, see [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/library/22c4debb-4e31-47a8-8f19-16f328d7dcd3).</span></span>  
  
## <a name="creating-the-project"></a><span data-ttu-id="7ee12-116">Tworzenie projektu</span><span class="sxs-lookup"><span data-stu-id="7ee12-116">Creating the Project</span></span>  
 <span data-ttu-id="7ee12-117">Pierwszym krokiem jest utworzenie projektu i konfigurowanie formularza.</span><span class="sxs-lookup"><span data-stu-id="7ee12-117">The first step is to create the project and to set up the form.</span></span>  
  
#### <a name="to-create-a-form-that-uses-a-background-operation"></a><span data-ttu-id="7ee12-118">Aby utworzyć formularza korzystającego z operacji w tle</span><span class="sxs-lookup"><span data-stu-id="7ee12-118">To create a form that uses a background operation</span></span>  
  
1.  <span data-ttu-id="7ee12-119">Utwórz projekt aplikacji systemu Windows o nazwie `BackgroundWorkerExample`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-119">Create a Windows-based application project called `BackgroundWorkerExample`.</span></span> <span data-ttu-id="7ee12-120">Aby uzyskać więcej informacji, zobacz [porady: Tworzenie projektu aplikacji Windows](http://msdn.microsoft.com/library/b2f93fed-c635-4705-8d0e-cf079a264efa).</span><span class="sxs-lookup"><span data-stu-id="7ee12-120">For details, see [How to: Create a Windows Application Project](http://msdn.microsoft.com/library/b2f93fed-c635-4705-8d0e-cf079a264efa).</span></span>  
  
2.  <span data-ttu-id="7ee12-121">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy **Form1** i wybierz **zmienić** z menu skrótów.</span><span class="sxs-lookup"><span data-stu-id="7ee12-121">In **Solution Explorer**, right-click **Form1** and select **Rename** from the shortcut menu.</span></span> <span data-ttu-id="7ee12-122">Zmień nazwę pliku, aby `FibonacciCalculator`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-122">Change the file name to `FibonacciCalculator`.</span></span> <span data-ttu-id="7ee12-123">Kliknij przycisk **tak** przycisku, gdy zostanie wyświetlony monit, jeśli chcesz zmienić wszystkie odwołania do elementu kodu '`Form1`".</span><span class="sxs-lookup"><span data-stu-id="7ee12-123">Click the **Yes** button when you are asked if you want to rename all references to the code element '`Form1`'.</span></span>  
  
3.  <span data-ttu-id="7ee12-124">Przeciągnij <xref:System.Windows.Forms.NumericUpDown> kontrolować z **przybornika** na formularzu.</span><span class="sxs-lookup"><span data-stu-id="7ee12-124">Drag a <xref:System.Windows.Forms.NumericUpDown> control from the **Toolbox** onto the form.</span></span> <span data-ttu-id="7ee12-125">Ustaw <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> właściwości `1` i <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> właściwości `91`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-125">Set the <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> property to `1` and the <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> property to `91`.</span></span>  
  
4.  <span data-ttu-id="7ee12-126">Dodaj dwa <xref:System.Windows.Forms.Button> formantów w formularzu.</span><span class="sxs-lookup"><span data-stu-id="7ee12-126">Add two <xref:System.Windows.Forms.Button> controls to the form.</span></span>  
  
5.  <span data-ttu-id="7ee12-127">Zmień nazwę pierwszego <xref:System.Windows.Forms.Button> kontroli `startAsyncButton` i ustaw <xref:System.Windows.Forms.Control.Text%2A> właściwości `Start Async`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-127">Rename the first <xref:System.Windows.Forms.Button> control `startAsyncButton` and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Start Async`.</span></span> <span data-ttu-id="7ee12-128">Zmień nazwę drugiego <xref:System.Windows.Forms.Button> kontroli `cancelAsyncButton`i ustaw <xref:System.Windows.Forms.Control.Text%2A> właściwości `Cancel Async`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-128">Rename the second <xref:System.Windows.Forms.Button> control `cancelAsyncButton`, and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Cancel Async`.</span></span> <span data-ttu-id="7ee12-129">Ustaw jego <xref:System.Windows.Forms.Control.Enabled%2A> właściwości `false`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-129">Set its <xref:System.Windows.Forms.Control.Enabled%2A> property to `false`.</span></span>  
  
6.  <span data-ttu-id="7ee12-130">Tworzenie procedury obsługi zdarzeń dla obu <xref:System.Windows.Forms.Button> formantów <xref:System.Windows.Forms.Control.Click> zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="7ee12-130">Create an event handler for both of the <xref:System.Windows.Forms.Button> controls' <xref:System.Windows.Forms.Control.Click> events.</span></span> <span data-ttu-id="7ee12-131">Aby uzyskać więcej informacji, zobacz [porady: tworzenie zdarzeń obsługi przy użyciu narzędzia Projektant](http://msdn.microsoft.com/library/8461e9b8-14e8-406f-936e-3726732b23d2).</span><span class="sxs-lookup"><span data-stu-id="7ee12-131">For details, see [How to: Create Event Handlers Using the Designer](http://msdn.microsoft.com/library/8461e9b8-14e8-406f-936e-3726732b23d2).</span></span>  
  
7.  <span data-ttu-id="7ee12-132">Przeciągnij <xref:System.Windows.Forms.Label> kontrolować z **przybornika** na formularz i zmień jego nazwę `resultLabel`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-132">Drag a <xref:System.Windows.Forms.Label> control from the **Toolbox** onto the form and rename it `resultLabel`.</span></span>  
  
8.  <span data-ttu-id="7ee12-133">Przeciągnij <xref:System.Windows.Forms.ProgressBar> kontrolować z **przybornika** na formularzu.</span><span class="sxs-lookup"><span data-stu-id="7ee12-133">Drag a <xref:System.Windows.Forms.ProgressBar> control from the **Toolbox** onto the form.</span></span>  
  
## <a name="creating-a-backgroundworker-in-your-form"></a><span data-ttu-id="7ee12-134">Tworzenie BackgroundWorker w formularzu</span><span class="sxs-lookup"><span data-stu-id="7ee12-134">Creating a BackgroundWorker in Your Form</span></span>  
 <span data-ttu-id="7ee12-135">Można utworzyć <xref:System.ComponentModel.BackgroundWorker> do operacji asynchronicznej przy użyciu **Windows** **Projektant formularzy**.</span><span class="sxs-lookup"><span data-stu-id="7ee12-135">You can create the <xref:System.ComponentModel.BackgroundWorker> for your asynchronous operation using the **Windows** **Forms Designer**.</span></span>  
  
#### <a name="to-create-a-backgroundworker-with-the-designer"></a><span data-ttu-id="7ee12-136">Aby utworzyć BackgroundWorker za pomocą narzędzia Projektant</span><span class="sxs-lookup"><span data-stu-id="7ee12-136">To create a BackgroundWorker with the Designer</span></span>  
  
-   <span data-ttu-id="7ee12-137">Z **składniki** karcie **przybornika**, przeciągnij <xref:System.ComponentModel.BackgroundWorker> na formularzu.</span><span class="sxs-lookup"><span data-stu-id="7ee12-137">From the **Components** tab of the **Toolbox**, drag a <xref:System.ComponentModel.BackgroundWorker> onto the form.</span></span>  
  
## <a name="adding-asynchronous-event-handlers"></a><span data-ttu-id="7ee12-138">Dodawanie programów obsługi zdarzeń asynchroniczne</span><span class="sxs-lookup"><span data-stu-id="7ee12-138">Adding Asynchronous Event Handlers</span></span>  
 <span data-ttu-id="7ee12-139">Teraz można przystąpić do dodawania obsługi zdarzeń <xref:System.ComponentModel.BackgroundWorker> zdarzenia asynchroniczne składnika.</span><span class="sxs-lookup"><span data-stu-id="7ee12-139">You are now ready to add event handlers for the <xref:System.ComponentModel.BackgroundWorker> component's asynchronous events.</span></span> <span data-ttu-id="7ee12-140">Czasochłonna operacja, które zostanie uruchomione w tle, który oblicza numery Fibonacci, jest wywoływana przez jeden z tych programów obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7ee12-140">The time-consuming operation that will run in the background, which computes Fibonacci numbers, is called by one of these event handlers.</span></span>  
  
#### <a name="to-implement-asynchronous-event-handlers"></a><span data-ttu-id="7ee12-141">Do wykonania procedury obsługi zdarzeń asynchroniczne</span><span class="sxs-lookup"><span data-stu-id="7ee12-141">To implement asynchronous event handlers</span></span>  
  
1.  <span data-ttu-id="7ee12-142">W **właściwości** okno z <xref:System.ComponentModel.BackgroundWorker> składnika jest wybrana, kliknij przycisk **zdarzenia** przycisku.</span><span class="sxs-lookup"><span data-stu-id="7ee12-142">In the **Properties** window, with the <xref:System.ComponentModel.BackgroundWorker> component still selected, click the **Events** button.</span></span> <span data-ttu-id="7ee12-143">Kliknij dwukrotnie <xref:System.ComponentModel.BackgroundWorker.DoWork> i <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> zdarzenia można utworzyć procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7ee12-143">Double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers.</span></span> <span data-ttu-id="7ee12-144">Aby uzyskać więcej informacji o sposobie używania programów obsługi zdarzeń, zobacz [porady: tworzenie zdarzeń obsługi przy użyciu narzędzia Projektant](http://msdn.microsoft.com/library/8461e9b8-14e8-406f-936e-3726732b23d2).</span><span class="sxs-lookup"><span data-stu-id="7ee12-144">For more information about how to use event handlers, see [How to: Create Event Handlers Using the Designer](http://msdn.microsoft.com/library/8461e9b8-14e8-406f-936e-3726732b23d2).</span></span>  
  
2.  <span data-ttu-id="7ee12-145">Utworzenie nowej metody o nazwie `ComputeFibonacci`, w formularzu.</span><span class="sxs-lookup"><span data-stu-id="7ee12-145">Create a new method, called `ComputeFibonacci`, in your form.</span></span> <span data-ttu-id="7ee12-146">Ta metoda wykonuje całą pracę i będzie działał w tle.</span><span class="sxs-lookup"><span data-stu-id="7ee12-146">This method does the actual work, and it will run in the background.</span></span> <span data-ttu-id="7ee12-147">Ten kod ilustruje cyklicznego wykonania algorytmu Fibonacci, co jest szczególnie nieefektywne, biorąc wykładniczo dłuższego czasu na większą liczbą.</span><span class="sxs-lookup"><span data-stu-id="7ee12-147">This code demonstrates the recursive implementation of the Fibonacci algorithm, which is notably inefficient, taking exponentially longer time to complete for larger numbers.</span></span> <span data-ttu-id="7ee12-148">Służy w tym miejscu celach ilustracyjnych, aby wyświetlić operacji, które mogą powodować duże opóźnienia w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7ee12-148">It is used here for illustrative purposes, to show an operation that can introduce long delays in your application.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#10](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#10)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#10)]
     [!code-vb[System.ComponentModel.BackgroundWorker#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#10)]  
  
3.  <span data-ttu-id="7ee12-149">W <xref:System.ComponentModel.BackgroundWorker.DoWork> program obsługi zdarzeń, dodaj wywołanie do `ComputeFibonacci` metody.</span><span class="sxs-lookup"><span data-stu-id="7ee12-149">In the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler, add a call to the `ComputeFibonacci` method.</span></span> <span data-ttu-id="7ee12-150">Przeprowadzanie pierwszy parametr `ComputeFibonacci` z <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> właściwość <xref:System.ComponentModel.DoWorkEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="7ee12-150">Take the first parameter for `ComputeFibonacci` from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="7ee12-151"><xref:System.ComponentModel.BackgroundWorker> i <xref:System.ComponentModel.DoWorkEventArgs> parametry będą później używane dla raportowania postępu i anulowania obsługi.</span><span class="sxs-lookup"><span data-stu-id="7ee12-151">The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.ComponentModel.DoWorkEventArgs> parameters will be used later for progress reporting and cancellation support.</span></span> <span data-ttu-id="7ee12-152">Przypisz wartość zwrotną z elementu `ComputeFibonacci` do <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> właściwość <xref:System.ComponentModel.DoWorkEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="7ee12-152">Assign the return value from `ComputeFibonacci` to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="7ee12-153">Ten wynik będzie dostępna do <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7ee12-153">This result will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="7ee12-154"><xref:System.ComponentModel.BackgroundWorker.DoWork> Program obsługi zdarzeń nie odwołuje się `backgroundWorker1` wystąpienie zmiennej bezpośrednio, ponieważ spowoduje to połączenie ten program obsługi zdarzeń do konkretnego wystąpienia <xref:System.ComponentModel.BackgroundWorker>.</span><span class="sxs-lookup"><span data-stu-id="7ee12-154">The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="7ee12-155">Zamiast tego odwołania do <xref:System.ComponentModel.BackgroundWorker> wywoływane to, że zdarzenie jest odzyskała sprawność działania po `sender` parametru.</span><span class="sxs-lookup"><span data-stu-id="7ee12-155">Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter.</span></span> <span data-ttu-id="7ee12-156">Jest to ważne, gdy formularz zawiera więcej niż jeden <xref:System.ComponentModel.BackgroundWorker>.</span><span class="sxs-lookup"><span data-stu-id="7ee12-156">This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="7ee12-157">Warto również nie manipulowania żadne obiekty interfejsu użytkownika w Twojej <xref:System.ComponentModel.BackgroundWorker.DoWork> obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7ee12-157">It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler.</span></span> <span data-ttu-id="7ee12-158">Zamiast tego komunikują się za pośrednictwem interfejsu użytkownika <xref:System.ComponentModel.BackgroundWorker> zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="7ee12-158">Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#5](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#5)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#5](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#5)]
     [!code-vb[System.ComponentModel.BackgroundWorker#5](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#5)]  
  
4.  <span data-ttu-id="7ee12-159">W `startAsyncButton` formantu <xref:System.Windows.Forms.Control.Click> program obsługi zdarzeń, Dodaj kod, który rozpoczyna operację asynchroniczną.</span><span class="sxs-lookup"><span data-stu-id="7ee12-159">In the `startAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that starts the asynchronous operation.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#13](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#13)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#13](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#13)]
     [!code-vb[System.ComponentModel.BackgroundWorker#13](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#13)]  
  
5.  <span data-ttu-id="7ee12-160">W <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> program obsługi zdarzeń, przypisz wynik obliczenia `resultLabel` formantu.</span><span class="sxs-lookup"><span data-stu-id="7ee12-160">In the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler, assign the result of the calculation to the `resultLabel` control.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#6](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#6)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#6](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#6)]
     [!code-vb[System.ComponentModel.BackgroundWorker#6](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#6)]  
  
## <a name="adding-progress-reporting-and-support-for-cancellation"></a><span data-ttu-id="7ee12-161">Dodawanie raportowania postępu i obsługa anulowania</span><span class="sxs-lookup"><span data-stu-id="7ee12-161">Adding Progress Reporting and Support for Cancellation</span></span>  
 <span data-ttu-id="7ee12-162">Asynchroniczne operacje wykonywane przez długi czas często jest pożądane raportowania postępu dla użytkownika, aby zezwolić użytkownikowi anulować operację.</span><span class="sxs-lookup"><span data-stu-id="7ee12-162">For asynchronous operations that will take a long time, it is often desirable to report progress to the user and to allow the user to cancel the operation.</span></span> <span data-ttu-id="7ee12-163"><xref:System.ComponentModel.BackgroundWorker> Udostępnia zdarzenie pozwala na księgowanie postępu jako programu będzie kontynuowane operacji tła.</span><span class="sxs-lookup"><span data-stu-id="7ee12-163">The <xref:System.ComponentModel.BackgroundWorker> class provides an event that allows you to post progress as your background operation proceeds.</span></span> <span data-ttu-id="7ee12-164">Zapewnia także Flaga, która umożliwia kodu procesu roboczego do wykrywania wywołanie <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> i przerwać samej sobie.</span><span class="sxs-lookup"><span data-stu-id="7ee12-164">It also provides a flag that allows your worker code to detect a call to <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> and interrupt itself.</span></span>  
  
#### <a name="to-implement-progress-reporting"></a><span data-ttu-id="7ee12-165">Aby zaimplementować raportowania postępu</span><span class="sxs-lookup"><span data-stu-id="7ee12-165">To implement progress reporting</span></span>  
  
1.  <span data-ttu-id="7ee12-166">W **właściwości**, wybierz `backgroundWorker1`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-166">In the **Properties**, window, select `backgroundWorker1`.</span></span> <span data-ttu-id="7ee12-167">Ustaw <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> i <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> właściwości `true`.</span><span class="sxs-lookup"><span data-stu-id="7ee12-167">Set the <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`.</span></span>  
  
2.  <span data-ttu-id="7ee12-168">Zadeklaruj dwie zmienne w `FibonacciCalculator` formularza.</span><span class="sxs-lookup"><span data-stu-id="7ee12-168">Declare two variables in the `FibonacciCalculator` form.</span></span> <span data-ttu-id="7ee12-169">Te będzie można śledzić postęp.</span><span class="sxs-lookup"><span data-stu-id="7ee12-169">These will be used to track progress.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#14](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#14)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#14](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#14)]
     [!code-vb[System.ComponentModel.BackgroundWorker#14](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#14)]  
  
3.  <span data-ttu-id="7ee12-170">Dodaj program obsługi zdarzeń dla <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7ee12-170">Add an event handler for the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event.</span></span> <span data-ttu-id="7ee12-171">W <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> obsługi zdarzeń, aktualizacja <xref:System.Windows.Forms.ProgressBar> z <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> właściwość <xref:System.ComponentModel.ProgressChangedEventArgs> parametru.</span><span class="sxs-lookup"><span data-stu-id="7ee12-171">In the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler, update the <xref:System.Windows.Forms.ProgressBar> with the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> property of the <xref:System.ComponentModel.ProgressChangedEventArgs> parameter.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#7](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#7)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#7](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#7)]
     [!code-vb[System.ComponentModel.BackgroundWorker#7](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#7)]  
  
#### <a name="to-implement-support-for-cancellation"></a><span data-ttu-id="7ee12-172">Obsługa anulowania</span><span class="sxs-lookup"><span data-stu-id="7ee12-172">To implement support for cancellation</span></span>  
  
1.  <span data-ttu-id="7ee12-173">W `cancelAsyncButton` formantu <xref:System.Windows.Forms.Control.Click> program obsługi zdarzeń, Dodaj kod, który anuluje operację asynchroniczną.</span><span class="sxs-lookup"><span data-stu-id="7ee12-173">In the `cancelAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that cancels the asynchronous operation.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#4](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#4)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#4](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#4)]
     [!code-vb[System.ComponentModel.BackgroundWorker#4](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#4)]  
  
2.  <span data-ttu-id="7ee12-174">Poniższy kod fragmentów w `ComputeFibonacci` — metoda raportu postęp i obsługa anulowania.</span><span class="sxs-lookup"><span data-stu-id="7ee12-174">The following code fragments in the `ComputeFibonacci` method report progress and support cancellation.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#11](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#11)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#11](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#11)]
     [!code-vb[System.ComponentModel.BackgroundWorker#11](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#11)]  
    [!code-cpp[System.ComponentModel.BackgroundWorker#12](../../../../samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#12)]
    [!code-csharp[System.ComponentModel.BackgroundWorker#12](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#12)]
    [!code-vb[System.ComponentModel.BackgroundWorker#12](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#12)]  
  
## <a name="checkpoint"></a><span data-ttu-id="7ee12-175">Punkt kontrolny</span><span class="sxs-lookup"><span data-stu-id="7ee12-175">Checkpoint</span></span>  
 <span data-ttu-id="7ee12-176">W tym momencie można skompilować i uruchomić aplikację Fibonacci Kalkulator.</span><span class="sxs-lookup"><span data-stu-id="7ee12-176">At this point, you can compile and run the Fibonacci Calculator application.</span></span>  
  
#### <a name="to-test-your-project"></a><span data-ttu-id="7ee12-177">Aby przetestować projektu</span><span class="sxs-lookup"><span data-stu-id="7ee12-177">To test your project</span></span>  
  
-   <span data-ttu-id="7ee12-178">Naciśnij klawisz F5, aby skompilować i uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="7ee12-178">Press F5 to compile and run the application.</span></span>  
  
     <span data-ttu-id="7ee12-179">Obliczenie jest uruchomiona w tle, zobaczysz <xref:System.Windows.Forms.ProgressBar> Wyświetlanie postępu obliczenia w kierunku ukończenia.</span><span class="sxs-lookup"><span data-stu-id="7ee12-179">While the calculation is running in the background, you will see the <xref:System.Windows.Forms.ProgressBar> displaying the progress of the calculation toward completion.</span></span> <span data-ttu-id="7ee12-180">Możesz również anulować oczekująca operacja.</span><span class="sxs-lookup"><span data-stu-id="7ee12-180">You can also cancel the pending operation.</span></span>  
  
     <span data-ttu-id="7ee12-181">Dla małej liczby obliczenia powinny być bardzo szybko, ale dla większej liczby powinna zostać wyświetlona zauważalnego opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="7ee12-181">For small numbers, the calculation should be very fast, but for larger numbers, you should see a noticeable delay.</span></span> <span data-ttu-id="7ee12-182">Jeśli wprowadzisz wartość 30 lub większą, powinna zostać wyświetlona opóźnienie kilka sekund, w zależności od szybkości komputera.</span><span class="sxs-lookup"><span data-stu-id="7ee12-182">If you enter a value of 30 or greater, you should see a delay of several seconds, depending on the speed of your computer.</span></span> <span data-ttu-id="7ee12-183">W przypadku wartości większej niż 40 może potrwać minut lub godziny na zakończenie działania.</span><span class="sxs-lookup"><span data-stu-id="7ee12-183">For values greater than 40, it may take minutes or hours to finish the calculation.</span></span> <span data-ttu-id="7ee12-184">Kalkulator jest zajęty obliczeniowych dużą liczbą Fibonacci, zwróć uwagę, że można swobodnie poruszanie formularza, zminimalizować, zmaksymalizować, a nawet je zamknąć.</span><span class="sxs-lookup"><span data-stu-id="7ee12-184">While the calculator is busy computing a large Fibonacci number, notice that you can freely move the form around, minimize, maximize, and even dismiss it.</span></span> <span data-ttu-id="7ee12-185">Jest to spowodowane wątku interfejsu użytkownika głównego nie oczekuje na obliczenia zakończyć.</span><span class="sxs-lookup"><span data-stu-id="7ee12-185">This is because the main UI thread is not waiting for the calculation to finish.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="7ee12-186">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="7ee12-186">Next Steps</span></span>  
 <span data-ttu-id="7ee12-187">Teraz, gdy zostały zaimplementowane formularza korzystającego z <xref:System.ComponentModel.BackgroundWorker> składnika do wykonywania obliczeń w tle, można sprawdzić możliwości innych operacji asynchronicznych:</span><span class="sxs-lookup"><span data-stu-id="7ee12-187">Now that you have implemented a form that uses a <xref:System.ComponentModel.BackgroundWorker> component to execute a computation in the background, you can explore other possibilities for asynchronous operations:</span></span>  
  
-   <span data-ttu-id="7ee12-188">Używanych jest wiele <xref:System.ComponentModel.BackgroundWorker> obiektów dla wielu jednoczesnych operacji.</span><span class="sxs-lookup"><span data-stu-id="7ee12-188">Use multiple <xref:System.ComponentModel.BackgroundWorker> objects for several simultaneous operations.</span></span>  
  
-   <span data-ttu-id="7ee12-189">Debugowanie aplikacji wielowątkowych, zobacz [porady: Korzystanie z okna wątków](/visualstudio/debugger/how-to-use-the-threads-window).</span><span class="sxs-lookup"><span data-stu-id="7ee12-189">To debug your multithreaded application, see [How to: Use the Threads Window](/visualstudio/debugger/how-to-use-the-threads-window).</span></span>  
  
-   <span data-ttu-id="7ee12-190">Implementuje własne składnik, który obsługuje model programowania asynchronicznego.</span><span class="sxs-lookup"><span data-stu-id="7ee12-190">Implement your own component that supports the asynchronous programming model.</span></span> <span data-ttu-id="7ee12-191">Aby uzyskać więcej informacji, zobacz [oparty na zdarzeniach asynchroniczny wzorzec — Przegląd](../../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7ee12-191">For more information, see [Event-based Asynchronous Pattern Overview](../../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md).</span></span>  
  
    > [!CAUTION]
    >  <span data-ttu-id="7ee12-192">Korzystając z wielowątkowość jakiegokolwiek, możesz narażając samodzielnie do usterki bardzo poważne i złożone.</span><span class="sxs-lookup"><span data-stu-id="7ee12-192">When using multithreading of any sort, you potentially expose yourself to very serious and complex bugs.</span></span> <span data-ttu-id="7ee12-193">Zapoznaj się [zarządzanych wątków najlepsze rozwiązania w zakresie](../../../../docs/standard/threading/managed-threading-best-practices.md) przed zaimplementowaniem rozwiązania, w którym używane wielowątkowości.</span><span class="sxs-lookup"><span data-stu-id="7ee12-193">Consult the [Managed Threading Best Practices](../../../../docs/standard/threading/managed-threading-best-practices.md) before implementing any solution that uses multithreading.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7ee12-194">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="7ee12-194">See Also</span></span>  
 <xref:System.ComponentModel.BackgroundWorker>  
 [<span data-ttu-id="7ee12-195">Zarządzana wątkowość — najlepsze rozwiązania</span><span class="sxs-lookup"><span data-stu-id="7ee12-195">Managed Threading Best Practices</span></span>](../../../../docs/standard/threading/managed-threading-best-practices.md)  
 [<span data-ttu-id="7ee12-196">Wielowątkowość składników</span><span class="sxs-lookup"><span data-stu-id="7ee12-196">Multithreading in Components</span></span>](http://msdn.microsoft.com/library/2fc31e68-fb71-4544-b654-0ce720478779)  
 [<span data-ttu-id="7ee12-197">NIE w kompilacji: Wielowątkowość w języku Visual Basic</span><span class="sxs-lookup"><span data-stu-id="7ee12-197">NOT IN BUILD: Multithreading in Visual Basic</span></span>](http://msdn.microsoft.com/library/c731a50c-09c1-4468-9646-54c86b75d269)  
 [<span data-ttu-id="7ee12-198">Instrukcje: implementowanie formularza korzystającego z operacji w tle</span><span class="sxs-lookup"><span data-stu-id="7ee12-198">How to: Implement a Form That Uses a Background Operation</span></span>](../../../../docs/framework/winforms/controls/how-to-implement-a-form-that-uses-a-background-operation.md)  
 [<span data-ttu-id="7ee12-199">Przewodnik: przeprowadzanie operacji w tle</span><span class="sxs-lookup"><span data-stu-id="7ee12-199">Walkthrough: Running an Operation in the Background</span></span>](../../../../docs/framework/winforms/controls/walkthrough-running-an-operation-in-the-background.md)  
 [<span data-ttu-id="7ee12-200">BackgroundWorker, składnik</span><span class="sxs-lookup"><span data-stu-id="7ee12-200">BackgroundWorker Component</span></span>](../../../../docs/framework/winforms/controls/backgroundworker-component.md)
