---
title: 'Przewodnik: wdrażanie formularza korzystającego z operacji w tle'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- threading [Windows Forms], forms
- BackgroundWorker component
- background tasks
- forms [Windows Forms], multithreading
- threading [Windows Forms], walkthroughs
- forms [Windows Forms], background operations
- threading [Windows Forms], background operations
- background operations
ms.assetid: 4691b796-9200-471a-89c3-ba4c7cc78c03
ms.openlocfilehash: 60421d6ba634bd7b4107f1c9998fbbe158417c83
ms.sourcegitcommit: 10986410e59ff29f2ec55c6759bde3eb4d1a00cb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/31/2019
ms.locfileid: "66423836"
---
# <a name="walkthrough-implementing-a-form-that-uses-a-background-operation"></a><span data-ttu-id="6d578-102">Przewodnik: wdrażanie formularza korzystającego z operacji w tle</span><span class="sxs-lookup"><span data-stu-id="6d578-102">Walkthrough: Implementing a Form That Uses a Background Operation</span></span>

<span data-ttu-id="6d578-103">Jeśli operacja, która będzie zająć dużo czasu, i nie ma interfejsu użytkownika (UI) przestanie odpowiadać lub do blokowania, możesz użyć <xref:System.ComponentModel.BackgroundWorker> klasy do wykonywania operacji na inny wątek.</span><span class="sxs-lookup"><span data-stu-id="6d578-103">If you have an operation that will take a long time to complete, and you do not want your user interface (UI) to stop responding or to block, you can use the <xref:System.ComponentModel.BackgroundWorker> class to execute the operation on another thread.</span></span>

<span data-ttu-id="6d578-104">W tym instruktażu przedstawiono sposób użycia <xref:System.ComponentModel.BackgroundWorker> klasy do wykonywania czasochłonnych obliczeń "w"tle, podczas gdy interfejs użytkownika reaguje.</span><span class="sxs-lookup"><span data-stu-id="6d578-104">This walkthrough illustrates how to use the <xref:System.ComponentModel.BackgroundWorker> class to perform time-consuming computations "in the background," while the user interface remains responsive.</span></span>  <span data-ttu-id="6d578-105">Po zakończeniu wykonywania masz aplikację, która oblicza numery Fibonacci asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="6d578-105">When you are through, you will have an application that computes Fibonacci numbers asynchronously.</span></span> <span data-ttu-id="6d578-106">Mimo że obliczeniowej dużą liczbą Fibonacci może potrwać zauważalne ilość czasu, przez to opóźnienie nie zostanie przerwana głównego wątku interfejsu użytkownika, a formularz będzie odpowiadać podczas obliczania.</span><span class="sxs-lookup"><span data-stu-id="6d578-106">Even though computing a large Fibonacci number can take a noticeable amount of time, the main UI thread will not be interrupted by this delay, and the form will be responsive during the calculation.</span></span>

<span data-ttu-id="6d578-107">Zadania zilustrowane w tym przewodniku obejmują:</span><span class="sxs-lookup"><span data-stu-id="6d578-107">Tasks illustrated in this walkthrough include:</span></span>

- <span data-ttu-id="6d578-108">Tworzenie aplikacji z systemem Windows</span><span class="sxs-lookup"><span data-stu-id="6d578-108">Creating a Windows-based Application</span></span>

- <span data-ttu-id="6d578-109">Tworzenie <xref:System.ComponentModel.BackgroundWorker> w formularzu</span><span class="sxs-lookup"><span data-stu-id="6d578-109">Creating a <xref:System.ComponentModel.BackgroundWorker> in Your Form</span></span>

- <span data-ttu-id="6d578-110">Dodawanie obsługi zdarzeń asynchronicznych</span><span class="sxs-lookup"><span data-stu-id="6d578-110">Adding Asynchronous Event Handlers</span></span>

- <span data-ttu-id="6d578-111">Dodawanie raportowania postępu i obsługę anulowania</span><span class="sxs-lookup"><span data-stu-id="6d578-111">Adding Progress Reporting and Support for Cancellation</span></span>

<span data-ttu-id="6d578-112">Aby uzyskać pełną listę kod używany w tym przykładzie, zobacz [jak: Implementowanie formularza korzystającego z operacji w tle](how-to-implement-a-form-that-uses-a-background-operation.md).</span><span class="sxs-lookup"><span data-stu-id="6d578-112">For a complete listing of the code used in this example, see [How to: Implement a Form That Uses a Background Operation](how-to-implement-a-form-that-uses-a-background-operation.md).</span></span>

## <a name="create-a-form-that-uses-a-background-operation"></a><span data-ttu-id="6d578-113">Tworzenie formularza korzystającego z operacji w tle</span><span class="sxs-lookup"><span data-stu-id="6d578-113">Create a form that uses a background operation</span></span>

1. <span data-ttu-id="6d578-114">W programie Visual Studio Utwórz projekt aplikacji systemu Windows o nazwie `BackgroundWorkerExample` (**pliku** > **New** > **projektu**  >  **Visual C#**  lub **języka Visual Basic** > **Classic Desktop** > **Windows Forms Aplikacja**).</span><span class="sxs-lookup"><span data-stu-id="6d578-114">In Visual Studio, create a Windows-based application project called `BackgroundWorkerExample` (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**).</span></span>

2. <span data-ttu-id="6d578-115">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy **Form1** i wybierz **Zmień nazwę** z menu skrótów.</span><span class="sxs-lookup"><span data-stu-id="6d578-115">In **Solution Explorer**, right-click **Form1** and select **Rename** from the shortcut menu.</span></span> <span data-ttu-id="6d578-116">Zmień nazwę pliku, aby `FibonacciCalculator`.</span><span class="sxs-lookup"><span data-stu-id="6d578-116">Change the file name to `FibonacciCalculator`.</span></span> <span data-ttu-id="6d578-117">Kliknij przycisk **tak** przycisku, gdy zostanie wyświetlony monit, jeśli chcesz zmienić wszystkie odwołania do elementu kodu '`Form1`".</span><span class="sxs-lookup"><span data-stu-id="6d578-117">Click the **Yes** button when you are asked if you want to rename all references to the code element '`Form1`'.</span></span>

3. <span data-ttu-id="6d578-118">Przeciągnij <xref:System.Windows.Forms.NumericUpDown> z kontrolować **przybornika** na formularz.</span><span class="sxs-lookup"><span data-stu-id="6d578-118">Drag a <xref:System.Windows.Forms.NumericUpDown> control from the **Toolbox** onto the form.</span></span> <span data-ttu-id="6d578-119">Ustaw <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> właściwości `1` i <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> właściwość `91`.</span><span class="sxs-lookup"><span data-stu-id="6d578-119">Set the <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> property to `1` and the <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> property to `91`.</span></span>

4. <span data-ttu-id="6d578-120">Dodaj dwie <xref:System.Windows.Forms.Button> formantów do formularza.</span><span class="sxs-lookup"><span data-stu-id="6d578-120">Add two <xref:System.Windows.Forms.Button> controls to the form.</span></span>

5. <span data-ttu-id="6d578-121">Zmień nazwę pierwszego <xref:System.Windows.Forms.Button> kontroli `startAsyncButton` i ustaw <xref:System.Windows.Forms.Control.Text%2A> właściwość `Start Async`.</span><span class="sxs-lookup"><span data-stu-id="6d578-121">Rename the first <xref:System.Windows.Forms.Button> control `startAsyncButton` and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Start Async`.</span></span> <span data-ttu-id="6d578-122">Zmień nazwę drugiej <xref:System.Windows.Forms.Button> kontroli `cancelAsyncButton`i ustaw <xref:System.Windows.Forms.Control.Text%2A> właściwość `Cancel Async`.</span><span class="sxs-lookup"><span data-stu-id="6d578-122">Rename the second <xref:System.Windows.Forms.Button> control `cancelAsyncButton`, and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Cancel Async`.</span></span> <span data-ttu-id="6d578-123">Ustaw jego <xref:System.Windows.Forms.Control.Enabled%2A> właściwość `false`.</span><span class="sxs-lookup"><span data-stu-id="6d578-123">Set its <xref:System.Windows.Forms.Control.Enabled%2A> property to `false`.</span></span>

6. <span data-ttu-id="6d578-124">Utwórz procedurę obsługi zdarzeń dla obu <xref:System.Windows.Forms.Button> kontrolek <xref:System.Windows.Forms.Control.Click> zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="6d578-124">Create an event handler for both of the <xref:System.Windows.Forms.Button> controls' <xref:System.Windows.Forms.Control.Click> events.</span></span> <span data-ttu-id="6d578-125">Aby uzyskać więcej informacji, zobacz [jak: Tworzenie obsługi zdarzeń za pomocą projektanta](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="6d578-125">For details, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span></span>

7. <span data-ttu-id="6d578-126">Przeciągnij <xref:System.Windows.Forms.Label> z kontrolować **przybornika** na formularz i zmień jego nazwę `resultLabel`.</span><span class="sxs-lookup"><span data-stu-id="6d578-126">Drag a <xref:System.Windows.Forms.Label> control from the **Toolbox** onto the form and rename it `resultLabel`.</span></span>

8. <span data-ttu-id="6d578-127">Przeciągnij <xref:System.Windows.Forms.ProgressBar> z kontrolować **przybornika** na formularz.</span><span class="sxs-lookup"><span data-stu-id="6d578-127">Drag a <xref:System.Windows.Forms.ProgressBar> control from the **Toolbox** onto the form.</span></span>

## <a name="create-a-backgroundworker-with-the-designer"></a><span data-ttu-id="6d578-128">Tworzenie BackgroundWorker przy użyciu narzędzia Projektant</span><span class="sxs-lookup"><span data-stu-id="6d578-128">Create a BackgroundWorker with the Designer</span></span>

<span data-ttu-id="6d578-129">Możesz utworzyć <xref:System.ComponentModel.BackgroundWorker> dla operacji asynchronicznej przy użyciu **Windows** **projektanta formularzy**.</span><span class="sxs-lookup"><span data-stu-id="6d578-129">You can create the <xref:System.ComponentModel.BackgroundWorker> for your asynchronous operation using the **Windows** **Forms Designer**.</span></span>

<span data-ttu-id="6d578-130">Z **składniki** karcie **przybornika**, przeciągnij <xref:System.ComponentModel.BackgroundWorker> na formularz.</span><span class="sxs-lookup"><span data-stu-id="6d578-130">From the **Components** tab of the **Toolbox**, drag a <xref:System.ComponentModel.BackgroundWorker> onto the form.</span></span>

## <a name="add-asynchronous-event-handlers"></a><span data-ttu-id="6d578-131">Dodawanie obsługi zdarzeń asynchronicznych</span><span class="sxs-lookup"><span data-stu-id="6d578-131">Add asynchronous event handlers</span></span>

<span data-ttu-id="6d578-132">Teraz można przystąpić do dodania obsługi zdarzeń dla <xref:System.ComponentModel.BackgroundWorker> zdarzeń asynchronicznych składnika.</span><span class="sxs-lookup"><span data-stu-id="6d578-132">You are now ready to add event handlers for the <xref:System.ComponentModel.BackgroundWorker> component's asynchronous events.</span></span> <span data-ttu-id="6d578-133">Czasochłonne operacji, która jest uruchamiana w tle, który oblicza Fibonacci liczb, jest wywoływana za pomocą jednej z tych programów obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d578-133">The time-consuming operation that will run in the background, which computes Fibonacci numbers, is called by one of these event handlers.</span></span>

1. <span data-ttu-id="6d578-134">W **właściwości** oknie z <xref:System.ComponentModel.BackgroundWorker> składnika wciąż zaznaczone, kliknij przycisk **zdarzenia** przycisku.</span><span class="sxs-lookup"><span data-stu-id="6d578-134">In the **Properties** window, with the <xref:System.ComponentModel.BackgroundWorker> component still selected, click the **Events** button.</span></span> <span data-ttu-id="6d578-135">Kliknij dwukrotnie <xref:System.ComponentModel.BackgroundWorker.DoWork> i <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> zdarzeń, aby utworzyć procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d578-135">Double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers.</span></span> <span data-ttu-id="6d578-136">Aby uzyskać więcej informacji na temat używania programów obsługi zdarzeń, zobacz [jak: Tworzenie obsługi zdarzeń za pomocą projektanta](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="6d578-136">For more information about how to use event handlers, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span></span>

2. <span data-ttu-id="6d578-137">Utwórz nową metodę o nazwie `ComputeFibonacci`, w formularzu.</span><span class="sxs-lookup"><span data-stu-id="6d578-137">Create a new method, called `ComputeFibonacci`, in your form.</span></span> <span data-ttu-id="6d578-138">Ta metoda wykonuje faktyczną pracę, a zostanie ona uruchomiona w tle.</span><span class="sxs-lookup"><span data-stu-id="6d578-138">This method does the actual work, and it will run in the background.</span></span> <span data-ttu-id="6d578-139">Ten kod przedstawia implementację cyklicznego algorytmu Fibonacci, który jest szczególnie nieefektywne, biorąc wykładniczo dłużej, aby uzyskać większą liczbą.</span><span class="sxs-lookup"><span data-stu-id="6d578-139">This code demonstrates the recursive implementation of the Fibonacci algorithm, which is notably inefficient, taking exponentially longer time to complete for larger numbers.</span></span> <span data-ttu-id="6d578-140">Służy w tym miejscu w celach ilustracyjnych, aby pokazać operacji, która może prowadzić do opóźnień w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="6d578-140">It is used here for illustrative purposes, to show an operation that can introduce long delays in your application.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#10)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#10)]
     [!code-vb[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#10)]

3. <span data-ttu-id="6d578-141">W <xref:System.ComponentModel.BackgroundWorker.DoWork> procedura obsługi zdarzeń, dodaj wywołanie do `ComputeFibonacci` metody.</span><span class="sxs-lookup"><span data-stu-id="6d578-141">In the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler, add a call to the `ComputeFibonacci` method.</span></span> <span data-ttu-id="6d578-142">Wykonaj pierwszy parametr `ComputeFibonacci` z <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> właściwość <xref:System.ComponentModel.DoWorkEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="6d578-142">Take the first parameter for `ComputeFibonacci` from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="6d578-143"><xref:System.ComponentModel.BackgroundWorker> i <xref:System.ComponentModel.DoWorkEventArgs> parametry będzie później używane dla raportowania postępu i anulowania obsługi.</span><span class="sxs-lookup"><span data-stu-id="6d578-143">The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.ComponentModel.DoWorkEventArgs> parameters will be used later for progress reporting and cancellation support.</span></span> <span data-ttu-id="6d578-144">Przypisz wartość zwrotną z elementu `ComputeFibonacci` do <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> właściwość <xref:System.ComponentModel.DoWorkEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="6d578-144">Assign the return value from `ComputeFibonacci` to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="6d578-145">Ten wynik będzie dostępny dla <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d578-145">This result will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler.</span></span>

    > [!NOTE]
    > <span data-ttu-id="6d578-146"><xref:System.ComponentModel.BackgroundWorker.DoWork> Program obsługi zdarzeń nie odwołuje się `backgroundWorker1` wystąpienie zmiennej bezpośrednio, jak to będzie sprzęgnięcie ta procedura obsługi zdarzeń do określonego wystąpienia <xref:System.ComponentModel.BackgroundWorker>.</span><span class="sxs-lookup"><span data-stu-id="6d578-146">The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="6d578-147">Zamiast tego odwołania do <xref:System.ComponentModel.BackgroundWorker> , to zgłoszone zdarzenie jest przywracany z `sender` parametru.</span><span class="sxs-lookup"><span data-stu-id="6d578-147">Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter.</span></span> <span data-ttu-id="6d578-148">Jest to ważne, gdy formularz udostępnia więcej niż jedną <xref:System.ComponentModel.BackgroundWorker>.</span><span class="sxs-lookup"><span data-stu-id="6d578-148">This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="6d578-149">Jest również pamiętać, aby nie modyfikować żadnych obiektów interfejsu użytkownika w Twojej <xref:System.ComponentModel.BackgroundWorker.DoWork> programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d578-149">It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler.</span></span> <span data-ttu-id="6d578-150">Zamiast tego komunikują się interfejs użytkownika za pośrednictwem <xref:System.ComponentModel.BackgroundWorker> zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="6d578-150">Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#5)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#5)]
     [!code-vb[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#5)]

4. <span data-ttu-id="6d578-151">W `startAsyncButton` kontrolki <xref:System.Windows.Forms.Control.Click> procedura obsługi zdarzeń, Dodaj kod, który rozpoczyna operację asynchroniczną.</span><span class="sxs-lookup"><span data-stu-id="6d578-151">In the `startAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that starts the asynchronous operation.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#13)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#13)]
     [!code-vb[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#13)]

5. <span data-ttu-id="6d578-152">W <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> procedura obsługi zdarzeń, przypisz wynik obliczenia `resultLabel` kontroli.</span><span class="sxs-lookup"><span data-stu-id="6d578-152">In the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler, assign the result of the calculation to the `resultLabel` control.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#6)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#6)]
     [!code-vb[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#6)]

## <a name="adding-progress-reporting-and-support-for-cancellation"></a><span data-ttu-id="6d578-153">Dodawanie raportowania postępu i obsługę anulowania</span><span class="sxs-lookup"><span data-stu-id="6d578-153">Adding Progress Reporting and Support for Cancellation</span></span>

<span data-ttu-id="6d578-154">Operacje asynchroniczne, które będzie trwać często jest pożądane, aby raport postęp dla użytkownika, aby umożliwić użytkownikowi anulować operację.</span><span class="sxs-lookup"><span data-stu-id="6d578-154">For asynchronous operations that will take a long time, it is often desirable to report progress to the user and to allow the user to cancel the operation.</span></span> <span data-ttu-id="6d578-155"><xref:System.ComponentModel.BackgroundWorker> Klasa udostępnia zdarzenia, które pozwala na publikowanie postępu jako swoje przychody operacji tła.</span><span class="sxs-lookup"><span data-stu-id="6d578-155">The <xref:System.ComponentModel.BackgroundWorker> class provides an event that allows you to post progress as your background operation proceeds.</span></span> <span data-ttu-id="6d578-156">Zapewnia także flagę, która umożliwia wywołanie w celu wykrywania kodu procesu roboczego <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> i przerwać samej sobie.</span><span class="sxs-lookup"><span data-stu-id="6d578-156">It also provides a flag that allows your worker code to detect a call to <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> and interrupt itself.</span></span>

### <a name="implement-progress-reporting"></a><span data-ttu-id="6d578-157">Implementowanie raportowania postępu</span><span class="sxs-lookup"><span data-stu-id="6d578-157">Implement progress reporting</span></span>

1. <span data-ttu-id="6d578-158">W **właściwości**, wybierz `backgroundWorker1`.</span><span class="sxs-lookup"><span data-stu-id="6d578-158">In the **Properties**, window, select `backgroundWorker1`.</span></span> <span data-ttu-id="6d578-159">Ustaw <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> i <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> właściwości `true`.</span><span class="sxs-lookup"><span data-stu-id="6d578-159">Set the <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`.</span></span>

2. <span data-ttu-id="6d578-160">Zadeklaruj dwie zmienne w `FibonacciCalculator` formularza.</span><span class="sxs-lookup"><span data-stu-id="6d578-160">Declare two variables in the `FibonacciCalculator` form.</span></span> <span data-ttu-id="6d578-161">Będą one używane, w celu śledzenia postępu.</span><span class="sxs-lookup"><span data-stu-id="6d578-161">These will be used to track progress.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#14)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#14)]
     [!code-vb[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#14)]

3. <span data-ttu-id="6d578-162">Dodawanie obsługi zdarzeń dla <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d578-162">Add an event handler for the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event.</span></span> <span data-ttu-id="6d578-163">W <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> programu obsługi zdarzeń, aktualizacja <xref:System.Windows.Forms.ProgressBar> z <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> właściwość <xref:System.ComponentModel.ProgressChangedEventArgs> parametru.</span><span class="sxs-lookup"><span data-stu-id="6d578-163">In the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler, update the <xref:System.Windows.Forms.ProgressBar> with the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> property of the <xref:System.ComponentModel.ProgressChangedEventArgs> parameter.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#7)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#7)]
     [!code-vb[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#7)]

### <a name="implement-support-for-cancellation"></a><span data-ttu-id="6d578-164">Zapewnia obsługę anulowania</span><span class="sxs-lookup"><span data-stu-id="6d578-164">Implement support for cancellation</span></span>

1. <span data-ttu-id="6d578-165">W `cancelAsyncButton` kontrolki <xref:System.Windows.Forms.Control.Click> procedura obsługi zdarzeń, Dodaj kod, który anuluje operację asynchroniczną.</span><span class="sxs-lookup"><span data-stu-id="6d578-165">In the `cancelAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that cancels the asynchronous operation.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#4)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#4)]
     [!code-vb[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#4)]

2. <span data-ttu-id="6d578-166">Poniższy kod fragmentów w `ComputeFibonacci` metoda raport postępu i pomoc techniczna anulowania.</span><span class="sxs-lookup"><span data-stu-id="6d578-166">The following code fragments in the `ComputeFibonacci` method report progress and support cancellation.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#11)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#11)]
     [!code-vb[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#11)]
    [!code-cpp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#12)]
    [!code-csharp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#12)]
    [!code-vb[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#12)]

## <a name="checkpoint"></a><span data-ttu-id="6d578-167">Punkt kontrolny</span><span class="sxs-lookup"><span data-stu-id="6d578-167">Checkpoint</span></span>

<span data-ttu-id="6d578-168">W tym momencie można skompilować i uruchomić aplikacja Kalkulator Fibonacci.</span><span class="sxs-lookup"><span data-stu-id="6d578-168">At this point, you can compile and run the Fibonacci Calculator application.</span></span>

<span data-ttu-id="6d578-169">Naciśnij klawisz **F5** Aby skompilować i uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="6d578-169">Press **F5** to compile and run the application.</span></span>

<span data-ttu-id="6d578-170">Obliczenie jest uruchomiona w tle, zobaczysz <xref:System.Windows.Forms.ProgressBar> Wyświetlanie postępu obliczeń w kierunku ukończenia.</span><span class="sxs-lookup"><span data-stu-id="6d578-170">While the calculation is running in the background, you will see the <xref:System.Windows.Forms.ProgressBar> displaying the progress of the calculation toward completion.</span></span> <span data-ttu-id="6d578-171">Możesz również anulować oczekujące operacje.</span><span class="sxs-lookup"><span data-stu-id="6d578-171">You can also cancel the pending operation.</span></span>

<span data-ttu-id="6d578-172">Dla małymi liczbami obliczenia powinny być bardzo szybko, ale w przypadku większych liczb, powinien zostać wyświetlony zauważalnego opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="6d578-172">For small numbers, the calculation should be very fast, but for larger numbers, you should see a noticeable delay.</span></span> <span data-ttu-id="6d578-173">Jeśli wprowadzisz wartość 30 lub większą, powinien zostać wyświetlony opóźnienie kilka sekund, w zależności od szybkości komputera.</span><span class="sxs-lookup"><span data-stu-id="6d578-173">If you enter a value of 30 or greater, you should see a delay of several seconds, depending on the speed of your computer.</span></span> <span data-ttu-id="6d578-174">Dla wartości jest większa niż 40 może upłynąć minuty lub godziny na zakończenie obliczania.</span><span class="sxs-lookup"><span data-stu-id="6d578-174">For values greater than 40, it may take minutes or hours to finish the calculation.</span></span> <span data-ttu-id="6d578-175">Kalkulator jest zajęty, przetwarzanie dużą liczbą Fibonacci, zwróć uwagę, czy można swobodnie poruszać się formularz, zminimalizować, maksymalizacji i nawet je zamknąć.</span><span class="sxs-lookup"><span data-stu-id="6d578-175">While the calculator is busy computing a large Fibonacci number, notice that you can freely move the form around, minimize, maximize, and even dismiss it.</span></span> <span data-ttu-id="6d578-176">Jest to spowodowane wątku interfejsu użytkownika głównego nie oczekuje na potrzeby obliczeń zakończyć.</span><span class="sxs-lookup"><span data-stu-id="6d578-176">This is because the main UI thread is not waiting for the calculation to finish.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6d578-177">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="6d578-177">Next steps</span></span>

<span data-ttu-id="6d578-178">Teraz, że udało Ci się wdrożyć formularz, który używa <xref:System.ComponentModel.BackgroundWorker> składnik do wykonywania obliczeń w tle, możesz zapoznać się z innych możliwości dla asynchronicznych operacji:</span><span class="sxs-lookup"><span data-stu-id="6d578-178">Now that you have implemented a form that uses a <xref:System.ComponentModel.BackgroundWorker> component to execute a computation in the background, you can explore other possibilities for asynchronous operations:</span></span>

- <span data-ttu-id="6d578-179">Używanych jest wiele <xref:System.ComponentModel.BackgroundWorker> obiektów dla kilku operacji jednoczesnych.</span><span class="sxs-lookup"><span data-stu-id="6d578-179">Use multiple <xref:System.ComponentModel.BackgroundWorker> objects for several simultaneous operations.</span></span>

- <span data-ttu-id="6d578-180">Do debugowania aplikacji wielowątkowych, zobacz [jak: Korzystanie z okna wątków](/visualstudio/debugger/how-to-use-the-threads-window).</span><span class="sxs-lookup"><span data-stu-id="6d578-180">To debug your multithreaded application, see [How to: Use the Threads Window](/visualstudio/debugger/how-to-use-the-threads-window).</span></span>

- <span data-ttu-id="6d578-181">Implementowanie własnego składnika, który obsługuje model programowania asynchronicznego.</span><span class="sxs-lookup"><span data-stu-id="6d578-181">Implement your own component that supports the asynchronous programming model.</span></span> <span data-ttu-id="6d578-182">Aby uzyskać więcej informacji, zobacz [oparte na zdarzeniach asynchronicznych omówienie wzorca](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6d578-182">For more information, see [Event-based Asynchronous Pattern Overview](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md).</span></span>

    > [!CAUTION]
    > <span data-ttu-id="6d578-183">Korzystając z wielowątkowością jakiegokolwiek rodzaju, możesz potencjalnie się narazić na bardzo poważne i złożone usterek.</span><span class="sxs-lookup"><span data-stu-id="6d578-183">When using multithreading of any sort, you potentially expose yourself to very serious and complex bugs.</span></span> <span data-ttu-id="6d578-184">Zapoznaj się z [zarządzana wątkowość najlepsze](../../../standard/threading/managed-threading-best-practices.md) przed zaimplementowaniem dowolne rozwiązanie, który używa wielowątkowości.</span><span class="sxs-lookup"><span data-stu-id="6d578-184">Consult the [Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md) before implementing any solution that uses multithreading.</span></span>

## <a name="see-also"></a><span data-ttu-id="6d578-185">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="6d578-185">See also</span></span>

- <xref:System.ComponentModel.BackgroundWorker?displayProperty=nameWithType>
- [<span data-ttu-id="6d578-186">Zarządzana wątkowość</span><span class="sxs-lookup"><span data-stu-id="6d578-186">Managed Threading</span></span>](../../../standard/threading/index.md)
- [<span data-ttu-id="6d578-187">Zarządzana wątkowość — najlepsze rozwiązania</span><span class="sxs-lookup"><span data-stu-id="6d578-187">Managed Threading Best Practices</span></span>](../../../standard/threading/managed-threading-best-practices.md)
- [<span data-ttu-id="6d578-188">Asynchroniczny wzorzec oparty na zdarzeniach — omówienie</span><span class="sxs-lookup"><span data-stu-id="6d578-188">Event-based Asynchronous Pattern Overview</span></span>](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)
- [<span data-ttu-id="6d578-189">Instrukcje: Implementowanie formularza korzystającego z operacji w tle</span><span class="sxs-lookup"><span data-stu-id="6d578-189">How to: Implement a Form That Uses a Background Operation</span></span>](how-to-implement-a-form-that-uses-a-background-operation.md)
- [<span data-ttu-id="6d578-190">Przewodnik: Przeprowadzanie operacji w tle</span><span class="sxs-lookup"><span data-stu-id="6d578-190">Walkthrough: Running an Operation in the Background</span></span>](walkthrough-running-an-operation-in-the-background.md)
- [<span data-ttu-id="6d578-191">BackgroundWorker, składnik</span><span class="sxs-lookup"><span data-stu-id="6d578-191">BackgroundWorker Component</span></span>](backgroundworker-component.md)
