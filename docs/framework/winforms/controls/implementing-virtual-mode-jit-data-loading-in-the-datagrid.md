---
title: "Implementowanie trybu wirtualnego przy użyciu ładowania danych Just-In-Time w formancie DataGridView formularzy systemu Windows"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- examples [Windows Forms], just-in-time data loading
- data [Windows Forms], managing large data sets
- DataGridView control [Windows Forms], virtual mode
- just-in-time data loading
- DataGridView control [Windows Forms], large data sets
- virtual mode [Windows Forms], just-in-time data loading
ms.assetid: c2a052b9-423c-4ff7-91dc-d8c7c79345f6
caps.latest.revision: "13"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 2a830c11e8df73b71f16c1b9dfd1007461d910f5
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/22/2017
---
# <a name="implementing-virtual-mode-with-just-in-time-data-loading-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="c7598-102">Implementowanie trybu wirtualnego przy użyciu ładowania danych Just-In-Time w formancie DataGridView formularzy systemu Windows</span><span class="sxs-lookup"><span data-stu-id="c7598-102">Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="c7598-103">Jedną z przyczyn Implementowanie trybu wirtualnego w <xref:System.Windows.Forms.DataGridView> formant jest do pobierania danych tylko wtedy, gdy jest to potrzebne.</span><span class="sxs-lookup"><span data-stu-id="c7598-103">One reason to implement virtual mode in the <xref:System.Windows.Forms.DataGridView> control is to retrieve data only as it is needed.</span></span> <span data-ttu-id="c7598-104">Ta metoda jest wywoływana *ładowanie danych just in time*.</span><span class="sxs-lookup"><span data-stu-id="c7598-104">This is called *just-in-time data loading*.</span></span>  
  
 <span data-ttu-id="c7598-105">Podczas pracy z bardzo dużych tabel w zdalnej bazy danych, na przykład można uniknąć opóźnienia uruchomienia przez pobranie danych, które są niezbędne do wyświetlania i pobierania dodatkowych danych, tylko wtedy, gdy użytkownik przewija widok nowych wierszy do wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="c7598-105">If you are working with a very large table in a remote database, for example, you might want to avoid startup delays by retrieving only the data that is necessary for display and retrieving additional data only when the user scrolls new rows into view.</span></span> <span data-ttu-id="c7598-106">Jeśli komputery klienckie z systemem aplikacji ma ograniczoną ilość pamięci dostępnej dla przechowywania danych, można również odrzucić nieużywanych danych podczas pobierania nowych wartości z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-106">If the client computers running your application have a limited amount of memory available for storing data, you might also want to discard unused data when retrieving new values from the database.</span></span>  
  
 <span data-ttu-id="c7598-107">W poniższych sekcjach opisano sposób użycia <xref:System.Windows.Forms.DataGridView> kontrolki z pamięci podręcznej w czasie.</span><span class="sxs-lookup"><span data-stu-id="c7598-107">The following sections describe how to use a <xref:System.Windows.Forms.DataGridView> control with a just-in-time cache.</span></span>  
  
 <span data-ttu-id="c7598-108">Aby skopiować kod w tym temacie na jednej liście, zobacz [porady: Implementowanie trybu wirtualnego just in time w formancie DataGridView formularzy systemu Windows podczas ładowania danych](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).</span><span class="sxs-lookup"><span data-stu-id="c7598-108">To copy the code in this topic as a single listing, see [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).</span></span>  
  
## <a name="the-form"></a><span data-ttu-id="c7598-109">Formularz</span><span class="sxs-lookup"><span data-stu-id="c7598-109">The Form</span></span>  
 <span data-ttu-id="c7598-110">Poniższy przykładowy kod definiuje formularz zawierający tylko do odczytu <xref:System.Windows.Forms.DataGridView> formant, który współdziała z `Cache` obiektu za pomocą <xref:System.Windows.Forms.DataGridView.CellValueNeeded> obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="c7598-110">The following code example defines a form containing a read-only <xref:System.Windows.Forms.DataGridView> control that interacts with a `Cache` object through a <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler.</span></span> <span data-ttu-id="c7598-111">`Cache` Obiektu zarządza wartości przechowywane lokalnie i używa `DataRetriever` obiektu można pobrać wartości z tabeli zamówienia przykładowej bazy danych Northwind.</span><span class="sxs-lookup"><span data-stu-id="c7598-111">The `Cache` object manages the locally stored values and uses a `DataRetriever` object to retrieve values from the Orders table of the sample Northwind database.</span></span> <span data-ttu-id="c7598-112">`DataRetriever` Obiektu, który implementuje `IDataPageRetriever` interfejsu wymaganego przez `Cache` klasy, również służy do inicjowania <xref:System.Windows.Forms.DataGridView> kontrolować wierszy i kolumn.</span><span class="sxs-lookup"><span data-stu-id="c7598-112">The `DataRetriever` object, which implements the `IDataPageRetriever` interface required by the `Cache` class, is also used to initialize the <xref:System.Windows.Forms.DataGridView> control rows and columns.</span></span>  
  
 <span data-ttu-id="c7598-113">`IDataPageRetriever`, `DataRetriever`, I `Cache` typy są opisane w dalszej części tego tematu.</span><span class="sxs-lookup"><span data-stu-id="c7598-113">The `IDataPageRetriever`, `DataRetriever`, and `Cache` types are described later in this topic.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c7598-114">Przechowywanie poufne informacje, takie jak hasła, w ciągu połączenia może mieć wpływ na bezpieczeństwo aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c7598-114">Storing sensitive information, such as a password, within the connection string can affect the security of your application.</span></span> <span data-ttu-id="c7598-115">Korzystanie z uwierzytelniania systemu Windows (znanego również jako zabezpieczenia zintegrowane) jest bezpieczniejszym sposobem na kontrolowanie dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-115">Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database.</span></span> <span data-ttu-id="c7598-116">Aby uzyskać więcej informacji, zobacz [ochrony informacji o połączeniu](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span><span class="sxs-lookup"><span data-stu-id="c7598-116">For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#100)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#100)]  
  
## <a name="the-idatapageretriever-interface"></a><span data-ttu-id="c7598-117">Interfejs IDataPageRetriever</span><span class="sxs-lookup"><span data-stu-id="c7598-117">The IDataPageRetriever Interface</span></span>  
 <span data-ttu-id="c7598-118">Poniższy przykładowy kod definiuje `IDataPageRetriever` interfejs, który jest implementowany przez `DataRetriever` klasy.</span><span class="sxs-lookup"><span data-stu-id="c7598-118">The following code example defines the `IDataPageRetriever` interface, which is implemented by the `DataRetriever` class.</span></span> <span data-ttu-id="c7598-119">Jedyną metodą zadeklarowany w tym interfejsie jest `SupplyPageOfData` metodę, która wymaga indeks wiersza początkowego oraz liczbę liczbę wierszy w jednej strony danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-119">The only method declared in this interface is the `SupplyPageOfData` method, which requires an initial row index and a count of the number of rows in a single page of data.</span></span> <span data-ttu-id="c7598-120">Te wartości są używane przez implementujący pobrać podzbiór danych ze źródła danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-120">These values are used by the implementer to retrieve a subset of data from a data source.</span></span>  
  
 <span data-ttu-id="c7598-121">A `Cache` obiekt używa implementację tego interfejsu podczas konstruowania załadować dwie strony początkowej danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-121">A `Cache` object uses an implementation of this interface during construction to load two initial pages of data.</span></span> <span data-ttu-id="c7598-122">Zawsze, gdy wartość bez buforowania jest potrzebna, pamięci podręcznej odrzuca jedną z tych stron i żąda nową stronę zawierającą wartości z `IDataPageRetriever`.</span><span class="sxs-lookup"><span data-stu-id="c7598-122">Whenever an uncached value is needed, the cache discards one of these pages and requests a new page containing the value from the `IDataPageRetriever`.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#201)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#201)]  
  
## <a name="the-dataretriever-class"></a><span data-ttu-id="c7598-123">Klasa DataRetriever</span><span class="sxs-lookup"><span data-stu-id="c7598-123">The DataRetriever Class</span></span>  
 <span data-ttu-id="c7598-124">Poniższy przykładowy kod definiuje `DataRetriever` klasy, która implementuje `IDataPageRetriever` interfejsu można pobrać strony danych z serwera.</span><span class="sxs-lookup"><span data-stu-id="c7598-124">The following code example defines the `DataRetriever` class, which implements the `IDataPageRetriever` interface to retrieve pages of data from a server.</span></span> <span data-ttu-id="c7598-125">`DataRetriever` Klasa udostępnia także `Columns` i `RowCount` właściwości, które <xref:System.Windows.Forms.DataGridView> formant używa do tworzenia niezbędne kolumn i dodaj odpowiednią liczbę puste wiersze do <xref:System.Windows.Forms.DataGridView.Rows%2A> kolekcji.</span><span class="sxs-lookup"><span data-stu-id="c7598-125">The `DataRetriever` class also provides `Columns` and `RowCount` properties, which the <xref:System.Windows.Forms.DataGridView> control uses to create the necessary columns and to add the appropriate number of empty rows to the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection.</span></span> <span data-ttu-id="c7598-126">Dodawanie puste wiersze jest niezbędne, aby formant będą zachowywać się tak, jakby zawiera wszystkie dane w tabeli.</span><span class="sxs-lookup"><span data-stu-id="c7598-126">Adding the empty rows is necessary so that the control will behave as though it contains all the data in the table.</span></span> <span data-ttu-id="c7598-127">Oznacza to, że pole przewijania na pasku przewijania mają odpowiedni rozmiar, a użytkownik będzie mógł uzyskać dostęp każdy wiersz w tabeli.</span><span class="sxs-lookup"><span data-stu-id="c7598-127">This means that the scroll box in the scroll bar will have the appropriate size, and the user will be able to access any row in the table.</span></span> <span data-ttu-id="c7598-128">Wiersze są wypełniane przez <xref:System.Windows.Forms.DataGridView.CellValueNeeded> obsługi zdarzeń tylko wtedy, gdy są one przewijane w widoku.</span><span class="sxs-lookup"><span data-stu-id="c7598-128">The rows are filled by the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler only when they are scrolled into view.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#200)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#200)]  
  
## <a name="the-cache-class"></a><span data-ttu-id="c7598-129">Klasa pamięci podręcznej</span><span class="sxs-lookup"><span data-stu-id="c7598-129">The Cache Class</span></span>  
 <span data-ttu-id="c7598-130">Poniższy przykładowy kod definiuje `Cache` klasy, która zarządza dwie strony dane wprowadzane przy użyciu `IDataPageRetriever` implementacji.</span><span class="sxs-lookup"><span data-stu-id="c7598-130">The following code example defines the `Cache` class, which manages two pages of data populated through an `IDataPageRetriever` implementation.</span></span> <span data-ttu-id="c7598-131">`Cache` Klasa definiuje wewnętrzny `DataPage` struktury, która zawiera <xref:System.Data.DataTable> do przechowywania wartości w jednej pamięci podręcznej strony i który oblicza indeksuje wiersza, który reprezentuje górne i dolne granice strony.</span><span class="sxs-lookup"><span data-stu-id="c7598-131">The `Cache` class defines an inner `DataPage` structure, which contains a <xref:System.Data.DataTable> to store the values in a single cache page and which calculates the row indexes that represent the upper and lower boundaries of the page.</span></span>  
  
 <span data-ttu-id="c7598-132">`Cache` Klasy ładuje dwóch stronach danych w czasie tworzenia.</span><span class="sxs-lookup"><span data-stu-id="c7598-132">The `Cache` class loads two pages of data at construction time.</span></span> <span data-ttu-id="c7598-133">Zawsze, gdy <xref:System.Windows.Forms.DataGridView.CellValueNeeded> wartość, żądanie zdarzenie `Cache` określa obiekt, jeśli wartość jest dostępna w jednej z jego dwóch stron i, jeśli tak, zwraca go.</span><span class="sxs-lookup"><span data-stu-id="c7598-133">Whenever the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event requests a value, the `Cache` object determines if the value is available in one of its two pages and, if so, returns it.</span></span> <span data-ttu-id="c7598-134">Jeśli wartość nie jest dostępna lokalnie, `Cache` obiektu określa, które jego dwie strony znajduje się najdalej od aktualnie wyświetlanych wierszy i zastępuje strony nową zawierający Żądana wartość, która następnie zwraca.</span><span class="sxs-lookup"><span data-stu-id="c7598-134">If the value is not available locally, the `Cache` object determines which of its two pages is farthest from the currently displayed rows and replaces the page with a new one containing the requested value, which it then returns.</span></span>  
  
 <span data-ttu-id="c7598-135">Przy założeniu, że liczba wierszy na stronie danych jest taka sama jak liczba wierszy, które mogą być jednocześnie wyświetlane na ekranie, ten model umożliwia stronicowania za pośrednictwem tabeli wydajnie powrót do ostatniego przeglądanej strony.</span><span class="sxs-lookup"><span data-stu-id="c7598-135">Assuming that the number of rows in a data page is the same as the number of rows that can be displayed on screen at once, this model allows users paging through the table to efficiently return to the most recently viewed page.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#300)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#300)]  
  
## <a name="additional-considerations"></a><span data-ttu-id="c7598-136">Dodatkowe uwagi</span><span class="sxs-lookup"><span data-stu-id="c7598-136">Additional Considerations</span></span>  
 <span data-ttu-id="c7598-137">W poprzednich przykładach kodu podano jako pokaz ładowania danych just in time.</span><span class="sxs-lookup"><span data-stu-id="c7598-137">The previous code examples are provided as a demonstration of just-in-time data loading.</span></span> <span data-ttu-id="c7598-138">Należy zmodyfikować kod dla potrzeb osiągnąć maksymalną wydajność.</span><span class="sxs-lookup"><span data-stu-id="c7598-138">You will need to modify the code for your own needs to achieve maximum efficiency.</span></span> <span data-ttu-id="c7598-139">Co najmniej należy wybrać odpowiednią wartość liczby wierszy na stronie danych w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="c7598-139">At minimum, you will need to choose an appropriate value for the number of rows per page of data in the cache.</span></span> <span data-ttu-id="c7598-140">Ta wartość jest przekazywana do `Cache` konstruktora.</span><span class="sxs-lookup"><span data-stu-id="c7598-140">This value is passed into the `Cache` constructor.</span></span> <span data-ttu-id="c7598-141">Liczba wierszy na stronie powinien być nie mniejszy niż liczba wierszy, które mogą być wyświetlane jednocześnie w Twojej <xref:System.Windows.Forms.DataGridView> formantu.</span><span class="sxs-lookup"><span data-stu-id="c7598-141">The number of rows per page should be no less than the number of rows that can be displayed simultaneously in your <xref:System.Windows.Forms.DataGridView> control.</span></span>  
  
 <span data-ttu-id="c7598-142">Aby uzyskać najlepsze rezultaty należy przeprowadzić test wydajności i użyteczność test, aby ustalić wymagania systemu i użytkownika.</span><span class="sxs-lookup"><span data-stu-id="c7598-142">For best results, you will need to conduct performance testing and usability testing to determine the requirements of your system and your users.</span></span> <span data-ttu-id="c7598-143">Kilka czynników, które należy wziąć pod uwagę dołączenie komputerów klienckich z aplikacji, dostępnej przepustowości połączenia sieciowego, użyty i opóźnienia serwera używanego ilość pamięci.</span><span class="sxs-lookup"><span data-stu-id="c7598-143">Several factors that you will need to take into consideration include the amount of memory in the client machines running your application, the available bandwidth of the network connection used, and the latency of the server used.</span></span> <span data-ttu-id="c7598-144">Przepustowości i opóźnień powinny być określone w czasie szczytowego wykorzystania.</span><span class="sxs-lookup"><span data-stu-id="c7598-144">The bandwidth and latency should be determined at times of peak usage.</span></span>  
  
 <span data-ttu-id="c7598-145">Aby zwiększyć wydajność przewijania aplikacji, można zwiększyć ilość danych przechowywanych lokalnie.</span><span class="sxs-lookup"><span data-stu-id="c7598-145">To improve the scrolling performance of your application, you can increase the amount of data stored locally.</span></span> <span data-ttu-id="c7598-146">Jednak aby zwiększyć czas uruchamiania, należy unikać, początkowo ładowania zbyt dużej ilości danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-146">To improve startup time, however, you must avoid loading too much data initially.</span></span> <span data-ttu-id="c7598-147">Chcesz zmodyfikować `Cache` klasę, aby zwiększyć liczbę stron danych mogą być przechowywane.</span><span class="sxs-lookup"><span data-stu-id="c7598-147">You may want to modify the `Cache` class to increase the number of data pages it can store.</span></span> <span data-ttu-id="c7598-148">Za pomocą więcej stron danych może poprawić wydajność przewijania, ale musisz określić idealne liczbę wierszy na stronie danych, w zależności od dostępnej przepustowości i opóźnień serwera.</span><span class="sxs-lookup"><span data-stu-id="c7598-148">Using more data pages can improve scrolling efficiency, but you will need to determine the ideal number of rows in a data page, depending on the available bandwidth and the server latency.</span></span> <span data-ttu-id="c7598-149">W mniejszych stron serwera uzyskuje się częściej, ale trwa krócej, aby zwrócić żądanych danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-149">With smaller pages, the server will be accessed more frequently, but will take less time to return the requested data.</span></span> <span data-ttu-id="c7598-150">Jeśli opóźnienie jest więcej niż przepustowość problemu, można używać większych stron danych.</span><span class="sxs-lookup"><span data-stu-id="c7598-150">If latency is more of an issue than bandwidth, you may want to use larger data pages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c7598-151">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="c7598-151">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 <xref:System.Windows.Forms.DataGridView.VirtualMode%2A>  
 [<span data-ttu-id="c7598-152">Dostrajanie wydajności w kontrolce DataGridView formularzy Windows Forms</span><span class="sxs-lookup"><span data-stu-id="c7598-152">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="c7598-153">Najlepsze praktyki dotyczące skalowania kontrolki DataGridView formularzy Windows Forms</span><span class="sxs-lookup"><span data-stu-id="c7598-153">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/best-practices-for-scaling-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="c7598-154">Tryb wirtualny w kontrolce DataGridView formularzy Windows Forms</span><span class="sxs-lookup"><span data-stu-id="c7598-154">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="c7598-155">Przewodnik: implementowanie trybu wirtualnego w kontrolce DataGridView formularzy Windows Forms</span><span class="sxs-lookup"><span data-stu-id="c7598-155">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)  
 [<span data-ttu-id="c7598-156">Instrukcje: implementowanie trybu wirtualnego przy użyciu ładowania danych Just-In-Time w kontrolce DataGridView formularzy Windows Forms</span><span class="sxs-lookup"><span data-stu-id="c7598-156">How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)
