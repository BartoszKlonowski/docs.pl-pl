---
title: Omówienie niezarządzanych aplikacji
ms.date: 03/30/2017
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: 0b4c3e738848be1ead2adeb1945e168c9db60071
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/24/2020
ms.locfileid: "76732536"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="d4a22-102">Przegląd formularzy systemu Windows i niezarządzanych aplikacji</span><span class="sxs-lookup"><span data-stu-id="d4a22-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="d4a22-103">Windows Forms aplikacje i kontrolki mogą współdziałać z niezarządzanymi aplikacjami z pewnymi zastrzeżeniami.</span><span class="sxs-lookup"><span data-stu-id="d4a22-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="d4a22-104">W poniższych sekcjach opisano scenariusze i konfiguracje, które Windows Forms aplikacjami i kontrolami, oraz te, które nie są obsługiwane przez klienta.</span><span class="sxs-lookup"><span data-stu-id="d4a22-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="d4a22-105">Kontrolki Windows Forms i aplikacje ActiveX</span><span class="sxs-lookup"><span data-stu-id="d4a22-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="d4a22-106">Z wyjątkiem programu Microsoft Internet Explorer i Microsoft Foundation Classes (MFC), formanty Windows Forms nie są obsługiwane w aplikacjach przeznaczonych do hostowania formantów ActiveX.</span><span class="sxs-lookup"><span data-stu-id="d4a22-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="d4a22-107">Inne aplikacje i narzędzia programistyczne, które mogą hostować kontrolki ActiveX, w tym kontenery testów ActiveX z wersji programu Visual Studio, które są starsze niż Visual Studio .NET 2003, nie są obsługiwane na hostach dla formantów Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d4a22-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="d4a22-108">Te ograniczenia stosują się również do korzystania z formantów Windows Forms za pomocą współdziałania Component Object Model COM.</span><span class="sxs-lookup"><span data-stu-id="d4a22-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="d4a22-109">Korzystanie z kontrolki Windows Forms w ramach otoki wywoływanej przez COM (CCW) jest obsługiwane tylko w programie Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="d4a22-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="d4a22-110">Aby uzyskać więcej informacji na temat międzyoperacyjności modelu COM, zobacz</span><span class="sxs-lookup"><span data-stu-id="d4a22-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="d4a22-111">[Międzyoperacyjność modelu COM](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="d4a22-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="d4a22-112">W poniższej tabeli przedstawiono dostępną obsługę ActiveX hostingu formantów Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d4a22-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="d4a22-113">Wersja Windows Forms</span><span class="sxs-lookup"><span data-stu-id="d4a22-113">Windows Forms version</span></span>|<span data-ttu-id="d4a22-114">Obsługa</span><span class="sxs-lookup"><span data-stu-id="d4a22-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="d4a22-115">.NET Framework wersja 1,0</span><span class="sxs-lookup"><span data-stu-id="d4a22-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="d4a22-116">Internet Explorer 5,01 i nowsze wersje</span><span class="sxs-lookup"><span data-stu-id="d4a22-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="d4a22-117">.NET Framework wersja 1,1 lub nowsza</span><span class="sxs-lookup"><span data-stu-id="d4a22-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="d4a22-118">Internet Explorer 5,01 i nowsze wersje</span><span class="sxs-lookup"><span data-stu-id="d4a22-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="d4a22-119">Microsoft Foundation Classes (MFC) 7,0 i nowsze</span><span class="sxs-lookup"><span data-stu-id="d4a22-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="d4a22-120">Hosting Windows Forms składników jako kontrolki ActiveX</span><span class="sxs-lookup"><span data-stu-id="d4a22-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="d4a22-121">W .NET Framework 1,1 wsparcie zostało rozszerzone w taki sposób, aby obejmowało MFC 7,0 i nowsze wersje.</span><span class="sxs-lookup"><span data-stu-id="d4a22-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="d4a22-122">Ta obsługa obejmuje każdy kontener, który jest w pełni zgodny z MFC 7,0 i nowszymi kontenera formantów ActiveX.</span><span class="sxs-lookup"><span data-stu-id="d4a22-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="d4a22-123">Jednak rejestracja Windows Forms kontrolek jako kontrolki ActiveX nie jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="d4a22-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="d4a22-124">Ponadto wywoływanie metody `com.ms.win32.Ole32.CoCreateInstance` dla formantów Windows Forms nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="d4a22-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="d4a22-125">Obsługiwane są tylko zarządzane aktywacje formantów Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d4a22-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="d4a22-126">Po utworzeniu kontrolki Windows Forms można hostować ją w aplikacji MFC podobnie jak w przypadku kontrolki ActiveX.</span><span class="sxs-lookup"><span data-stu-id="d4a22-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="d4a22-127">Aby korzystać z formantów Windows Forms w niezarządzanej aplikacji, musisz hostować środowisko CLR przy użyciu niezarządzanych interfejsów API hostingu środowiska C++ CLR lub użyć funkcji międzyoperacyjnych.</span><span class="sxs-lookup"><span data-stu-id="d4a22-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="d4a22-128">Zalecanym C++ rozwiązaniem jest użycie funkcji międzyoperacyjnych.</span><span class="sxs-lookup"><span data-stu-id="d4a22-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="d4a22-129">Windows Forms w aplikacjach klienckich COM</span><span class="sxs-lookup"><span data-stu-id="d4a22-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="d4a22-130">Po otwarciu formularza systemu Windows z aplikacji klienckiej COM, takiej jak aplikacja Visual Basic 6,0 lub aplikacja MFC, formularz może zachowywać się nieoczekiwanie.</span><span class="sxs-lookup"><span data-stu-id="d4a22-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="d4a22-131">Na przykład po naciśnięciu klawisza TAB fokus nie zmienia się z jednej kontrolki na inną.</span><span class="sxs-lookup"><span data-stu-id="d4a22-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="d4a22-132">Po naciśnięciu klawisza ENTER, gdy przycisk polecenia ma fokus, zdarzenie <xref:System.Windows.Forms.Control.Click> przycisku nie zostanie zgłoszone.</span><span class="sxs-lookup"><span data-stu-id="d4a22-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="d4a22-133">Może również wystąpić nieoczekiwane zachowanie dla naciśnięć klawiszy lub działania myszy.</span><span class="sxs-lookup"><span data-stu-id="d4a22-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="d4a22-134">Takie zachowanie występuje, ponieważ niezarządzana aplikacja nie implementuje obsługi pętli komunikatów, która Windows Forms wymaga prawidłowego działania.</span><span class="sxs-lookup"><span data-stu-id="d4a22-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="d4a22-135">Pętla komunikatów dostarczana przez aplikację kliencką COM różni się zasadniczo od pętli komunikatów Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d4a22-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="d4a22-136">Pętla komunikatów aplikacji to wewnętrzna pętla programu, która pobiera komunikaty z kolejki komunikatów wątku, tłumaczy je, a następnie wysyła je do aplikacji, która ma być obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="d4a22-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="d4a22-137">Pętla komunikatów dla formularza systemu Windows nie ma takiej samej architektury jak pętle komunikatów, które są dostępne we wcześniejszych aplikacjach, takich jak aplikacje Visual Basic 6,0 i aplikacje MFC.</span><span class="sxs-lookup"><span data-stu-id="d4a22-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="d4a22-138">Komunikaty okna, które są publikowane w pętli komunikatów mogą być obsługiwane inaczej niż oczekiwano w formularzu systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="d4a22-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="d4a22-139">W związku z tym może wystąpić nieoczekiwane zachowanie.</span><span class="sxs-lookup"><span data-stu-id="d4a22-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="d4a22-140">Niektóre kombinacje naciśnięć klawiszy mogą nie działać, niektóre działania myszy mogą nie działać lub niektóre zdarzenia mogą nie być wywoływane zgodnie z oczekiwaniami.</span><span class="sxs-lookup"><span data-stu-id="d4a22-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="d4a22-141">Rozwiązywanie problemów ze współdziałaniem</span><span class="sxs-lookup"><span data-stu-id="d4a22-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="d4a22-142">Te problemy można rozwiązać, wyświetlając formularz w .NET Framework pętlą komunikatów, która jest tworzona przy użyciu metody <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d4a22-142">You can resolve these problems by displaying the form on a .NET Framework message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="d4a22-143">Aby formularz systemu Windows działał prawidłowo z aplikacji klienckiej modelu COM, należy uruchomić go w pętli komunikatów Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d4a22-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="d4a22-144">W tym celu należy użyć jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="d4a22-144">To do this, use one of the following approaches:</span></span>  
  
- <span data-ttu-id="d4a22-145">Użyj metody <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType>, aby wyświetlić formularz systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="d4a22-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="d4a22-146">Aby uzyskać więcej informacji, zobacz [How to: obsługa międzyoperacyjności modelu COM przez wyświetlanie formularza systemu Windows przy użyciu metody ShowDialog](com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="d4a22-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
- <span data-ttu-id="d4a22-147">Wyświetl Każdy formularz systemu Windows w nowym wątku.</span><span class="sxs-lookup"><span data-stu-id="d4a22-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="d4a22-148">Aby uzyskać więcej informacji, zobacz [How to: obsługa międzyoperacyjności modelu COM przez wyświetlanie każdego formularza systemu Windows w jego własnym wątku](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="d4a22-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d4a22-149">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="d4a22-149">See also</span></span>

- [<span data-ttu-id="d4a22-150">Formularze Windows Forms i niezarządzane aplikacje</span><span class="sxs-lookup"><span data-stu-id="d4a22-150">Windows Forms and Unmanaged Applications</span></span>](windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="d4a22-151">Usługa międzyoperacyjna modelu COM</span><span class="sxs-lookup"><span data-stu-id="d4a22-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="d4a22-152">Współdziałanie COM w aplikacjach .NET Framework</span><span class="sxs-lookup"><span data-stu-id="d4a22-152">COM Interoperability in .NET Framework Applications</span></span>](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)
- <span data-ttu-id="d4a22-153">[Przykłady współdziałania modelu COM](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="d4a22-153">[COM Interoperability Samples](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="d4a22-154">Aximp.exe (importer kontrolki ActiveX formularzy Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="d4a22-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../tools/aximp-exe-windows-forms-activex-control-importer.md)
- [<span data-ttu-id="d4a22-155">Udostępnianie składników .NET Framework modelowi COM</span><span class="sxs-lookup"><span data-stu-id="d4a22-155">Exposing .NET Framework Components to COM</span></span>](../../interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="d4a22-156">Pakowanie zestawu dla modelu COM</span><span class="sxs-lookup"><span data-stu-id="d4a22-156">Packaging an Assembly for COM</span></span>](../../interop/packaging-an-assembly-for-com.md)
- [<span data-ttu-id="d4a22-157">Rejestrowanie zestawów do użycia z modelem COM</span><span class="sxs-lookup"><span data-stu-id="d4a22-157">Registering Assemblies with COM</span></span>](../../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="d4a22-158">Instrukcje: obsługa międzyoperacyjności w modelu COM za pomocą wyświetlania formularzy systemu Windows przy użyciu metody ShowDialog</span><span class="sxs-lookup"><span data-stu-id="d4a22-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="d4a22-159">Instrukcje: obsługa międzyoperacyjności modelu COM za pomocą wyświetlania każdego formularza systemu Windows w jego własnym wątku</span><span class="sxs-lookup"><span data-stu-id="d4a22-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
