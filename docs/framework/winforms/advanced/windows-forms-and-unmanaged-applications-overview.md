---
title: "Przegląd formularzy systemu Windows i niezarządzanych aplikacji"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
caps.latest.revision: "12"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 9ad64588727584a9b3de0a95e9bad252a3fb0581
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/19/2018
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="75997-102">Przegląd formularzy systemu Windows i niezarządzanych aplikacji</span><span class="sxs-lookup"><span data-stu-id="75997-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="75997-103">Aplikacji formularzy systemu Windows i formantów może współdziałać z niezarządzanych aplikacji, z niektórych ostrzeżenia.</span><span class="sxs-lookup"><span data-stu-id="75997-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="75997-104">W poniższych sekcjach opisano scenariusze i konfiguracje obsługujące aplikacje i formantów formularzy systemu Windows oraz te, które nie obsługują.</span><span class="sxs-lookup"><span data-stu-id="75997-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="75997-105">Formanty i aplikacji ActiveX formularzy systemu Windows</span><span class="sxs-lookup"><span data-stu-id="75997-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="75997-106">Z wyjątkiem programu Microsoft Internet Explorer oraz Microsoft Foundation Classes (MFC) formanty formularzy systemu Windows nie są obsługiwane w aplikacji hosta formantów ActiveX.</span><span class="sxs-lookup"><span data-stu-id="75997-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="75997-107">Inne aplikacje i narzędzia deweloperskie, które są w stanie hosting formantów ActiveX kontenerów testów z wersji programu Visual Studio, które jest wcześniejsza niż Visual Studio .NET 2003, w tym nie są obsługiwane hosty dla formantów formularzy systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="75997-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="75997-108">Te ograniczenia mają zastosowanie również do używania formanty formularzy systemu Windows za pośrednictwem Component Object Model COM interop.</span><span class="sxs-lookup"><span data-stu-id="75997-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="75997-109">Używanie formantu formularzy systemu Windows za pośrednictwem wywoływana otoka COM (CCW) jest obsługiwana tylko w programie Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="75997-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="75997-110">Aby uzyskać więcej informacji na temat Usługa międzyoperacyjna modelu COM Zobacz</span><span class="sxs-lookup"><span data-stu-id="75997-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="75997-111">[Współdziałanie z COM](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="75997-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="75997-112">W poniższej tabeli przedstawiono dostępne ActiveX hostingu obsługę formantów formularzy systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="75997-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="75997-113">Wersja Windows Forms</span><span class="sxs-lookup"><span data-stu-id="75997-113">Windows Forms version</span></span>|<span data-ttu-id="75997-114">Obsługa</span><span class="sxs-lookup"><span data-stu-id="75997-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="75997-115">.NET framework w wersji 1.0</span><span class="sxs-lookup"><span data-stu-id="75997-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="75997-116">Internet Explorer 5.01 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="75997-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="75997-117">.NET framework w wersji 1.1 lub nowszej</span><span class="sxs-lookup"><span data-stu-id="75997-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="75997-118">Internet Explorer 5.01 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="75997-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="75997-119">Microsoft Foundation klas (MFC) 7.0 lub nowszym</span><span class="sxs-lookup"><span data-stu-id="75997-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="75997-120">Hosting składników formularzy systemu Windows jako formantów ActiveX</span><span class="sxs-lookup"><span data-stu-id="75997-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="75997-121">W .NET Framework 1.1 Obsługa została rozszerzona, aby uwzględnić MFC 7.0 i nowszych wersjach.</span><span class="sxs-lookup"><span data-stu-id="75997-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="75997-122">Ta obsługa obejmuje wszystkie kontener, który jest w pełni zgodny z MFC 7.0 i nowszych kontener formantu ActiveX.</span><span class="sxs-lookup"><span data-stu-id="75997-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="75997-123">Rejestracja formantów formularzy systemu Windows jako formantów ActiveX nie jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="75997-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="75997-124">Ponadto wywołanie `com.ms.win32.Ole32.CoCreateInstance` metoda dla formantów formularzy systemu Windows nie jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="75997-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="75997-125">Obsługiwane jest tylko aktywacji zarządzanej formanty formularzy systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="75997-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="75997-126">Po utworzeniu formantu formularzy systemu Windows może obsługiwać go w aplikacji MFC, tak jak w przypadku formantu ActiveX.</span><span class="sxs-lookup"><span data-stu-id="75997-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="75997-127">Aby użyć formanty formularzy systemu Windows w niezarządzanej aplikacji, możesz hosta CLR za pomocą niezarządzanych hostingu interfejsów API środowiska CLR lub użyć funkcji międzyoperacyjności języka C++.</span><span class="sxs-lookup"><span data-stu-id="75997-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="75997-128">Korzystanie z funkcji współdziałania C++ jest zalecanym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="75997-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="75997-129">Formularze systemu Windows w aplikacjach klienckich COM</span><span class="sxs-lookup"><span data-stu-id="75997-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="75997-130">Po otwarciu formularza systemu Windows z modelu COM aplikacji klienta, takich jak aplikacji Visual Basic 6.0 lub aplikacji MFC formularza może zachowywać się nieoczekiwanie.</span><span class="sxs-lookup"><span data-stu-id="75997-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="75997-131">Na przykład po naciśnięciu klawisza TAB fokus nie zmienia z jednego formantu do innego formantu.</span><span class="sxs-lookup"><span data-stu-id="75997-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="75997-132">Po naciśnięciu klawisza ENTER podczas przycisku polecenia ma fokus, przycisk w <xref:System.Windows.Forms.Control.Click> nie zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="75997-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="75997-133">Może również wystąpić nieoczekiwane zachowanie naciśnięć klawiszy lub działanie myszy.</span><span class="sxs-lookup"><span data-stu-id="75997-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="75997-134">Dzieje się tak, ponieważ niezarządzanej aplikacji nie obsługują pętli komunikatów formularzy systemu Windows wymaga, aby działać poprawnie.</span><span class="sxs-lookup"><span data-stu-id="75997-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="75997-135">Pętli komunikatów udostępniany przez aplikację klienta COM jest różni się od pętli komunikatów formularzy systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="75997-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="75997-136">Komunikat aplikacji pętli jest pętli wewnętrzny programu, które pobierają wiadomości z kolejki komunikatów dla wątku, tłumaczy je, a następnie wysyła je do aplikacji, które mają być obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="75997-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="75997-137">Pętla wiadomości dla formularza systemu Windows nie ma taką samą architekturę jako pętli komunikatów, zapewniające w starszych aplikacjach, takich jak aplikacje Visual Basic 6.0 i aplikacjach MFC.</span><span class="sxs-lookup"><span data-stu-id="75997-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="75997-138">Komunikaty okna, które są wysyłane do pętli komunikatów mogą być traktowane inaczej niż oczekiwana liczba w formularzu systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="75997-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="75997-139">W związku z tym mogą wystąpić nieoczekiwane zachowanie.</span><span class="sxs-lookup"><span data-stu-id="75997-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="75997-140">Niektórych kombinacji klawiszy mogą nie działać prawidłowo, niektóre działania myszy może nie działać lub niektóre zdarzenia nie może zostać zgłoszone, zgodnie z oczekiwaniami.</span><span class="sxs-lookup"><span data-stu-id="75997-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="75997-141">Rozwiązywanie problemów ze współdziałaniem</span><span class="sxs-lookup"><span data-stu-id="75997-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="75997-142">Można rozwiązać te problemy przez wyświetlanie w formularzu [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] pętli komunikatów, który jest tworzony przy użyciu <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="75997-142">You can resolve these problems by displaying the form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="75997-143">Aby poprawnie z aplikacji klienckiej COM służbowy formularza systemu Windows, należy uruchomić je na pętli komunikatów formularzy systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="75997-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="75997-144">Aby to zrobić, użyj jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="75997-144">To do this, use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="75997-145">Użyj <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> metodę w celu wyświetlenia formularza systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="75997-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="75997-146">Aby uzyskać więcej informacji, zobacz [porady: Obsługa międzyoperacyjności z modelem COM za pomocą wyświetlania formularzy systemu Windows przy użyciu metody ShowDialog](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="75997-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
-   <span data-ttu-id="75997-147">Wyświetlania każdego formularza systemu Windows na nowym wątku.</span><span class="sxs-lookup"><span data-stu-id="75997-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="75997-148">Aby uzyskać więcej informacji, zobacz [porady: Obsługa międzyoperacyjności z modelem COM. wyświetlania każdego formularza systemu Windows w jego własnym wątku w](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="75997-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="75997-149">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="75997-149">See Also</span></span>  
 [<span data-ttu-id="75997-150">Formularze Windows Forms i niezarządzane aplikacje</span><span class="sxs-lookup"><span data-stu-id="75997-150">Windows Forms and Unmanaged Applications</span></span>](../../../../docs/framework/winforms/advanced/windows-forms-and-unmanaged-applications.md)  
 [<span data-ttu-id="75997-151">Usługa międzyoperacyjna modelu COM</span><span class="sxs-lookup"><span data-stu-id="75997-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)  
 [<span data-ttu-id="75997-152">Współdziałanie COM w aplikacjach .NET Framework</span><span class="sxs-lookup"><span data-stu-id="75997-152">COM Interoperability in .NET Framework Applications</span></span>](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)  
 [<span data-ttu-id="75997-153">Przykłady współdziałania COM</span><span class="sxs-lookup"><span data-stu-id="75997-153">COM Interoperability Samples</span></span>](http://msdn.microsoft.com/library/09c38567-6380-4d70-848a-e896a4ca05f4)  
 [<span data-ttu-id="75997-154">Aximp.exe (importer kontrolki ActiveX formularzy Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="75997-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../../../docs/framework/tools/aximp-exe-windows-forms-activex-control-importer.md)  
 [<span data-ttu-id="75997-155">Udostępnianie składników .NET Framework modelowi COM</span><span class="sxs-lookup"><span data-stu-id="75997-155">Exposing .NET Framework Components to COM</span></span>](../../../../docs/framework/interop/exposing-dotnet-components-to-com.md)  
 [<span data-ttu-id="75997-156">Pakowanie zestawu dla modelu COM</span><span class="sxs-lookup"><span data-stu-id="75997-156">Packaging an Assembly for COM</span></span>](../../../../docs/framework/interop/packaging-an-assembly-for-com.md)  
 [<span data-ttu-id="75997-157">Rejestrowanie zestawów do użycia z modelem COM</span><span class="sxs-lookup"><span data-stu-id="75997-157">Registering Assemblies with COM</span></span>](../../../../docs/framework/interop/registering-assemblies-with-com.md)  
 [<span data-ttu-id="75997-158">Instrukcje: obsługa międzyoperacyjności w modelu COM za pomocą wyświetlania formularzy systemu Windows przy użyciu metody ShowDialog</span><span class="sxs-lookup"><span data-stu-id="75997-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md)  
 [<span data-ttu-id="75997-159">Instrukcje: obsługa międzyoperacyjności modelu COM za pomocą wyświetlania każdego formularza systemu Windows w jego własnym wątku</span><span class="sxs-lookup"><span data-stu-id="75997-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
