---
title: Omówienie profilowania
ms.date: 03/30/2017
helpviewer_keywords:
- managed code, profiling API support
- unmanaged code, combining with managed code in profiling
- notification threads [.NET Framework profiling]
- unmanaged code, profiling
- profiling API [.NET Framework], and COM
- profiling API [.NET Framework], unmanaged code profiling
- profilers, writing
- profiling API [.NET Framework], call stacks
- code profilers, writing
- profiling API [.NET Framework], security considerations
- profiling API [.NET Framework], managed code support
- common language runtime, profiling
- profiling API [.NET Framework], notification threads
- call stacks [.NET Framework profiling]
- profiling API [.NET Framework], stack depth
- common language runtime, writing a profiler
- profiling API [.NET Framework], information retrieval interfaces
- shadow stacks [.NET Framework profiling]
- COM, using in the profiling API
- stack snapshots [.NET Framework profiling]
- profiling API [.NET Framework], supported features
- profiling API [.NET Framework], overview
- security, profiling API considerations
- stack depth [.NET Framework profiling]
ms.assetid: 864c2344-71dc-46f9-96b2-ed59fb6427a8
author: mairaw
ms.author: mairaw
ms.openlocfilehash: b38b64e1c86174bea11086e722ed86b0a0046e2c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
ms.locfileid: "33461916"
---
# <a name="profiling-overview"></a><span data-ttu-id="4dd62-102">Omówienie profilowania</span><span class="sxs-lookup"><span data-stu-id="4dd62-102">Profiling Overview</span></span>
<a name="top"></a> <span data-ttu-id="4dd62-103">Profiler to narzędzie, które monitoruje wykonywanie innej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-103">A profiler is a tool that monitors the execution of another application.</span></span> <span data-ttu-id="4dd62-104">Typowe profiler środowiska uruchomieniowego (języka wspólnego CLR) języka jest biblioteki dołączanej (dynamicznie DLL), która składa się z funkcji, które odbierać komunikaty z i wysyłać wiadomości do środowiska CLR za pomocą interfejsu API profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-104">A common language runtime (CLR) profiler is a dynamic link library (DLL) that consists of functions that receive messages from, and send messages to, the CLR by using the profiling API.</span></span> <span data-ttu-id="4dd62-105">Biblioteki DLL profilera jest ładowany przez środowisko CLR w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-105">The profiler DLL is loaded by the CLR at run time.</span></span>  
  
 <span data-ttu-id="4dd62-106">Tradycyjne narzędzia profilowania skupić się na mierzeniu wykonywania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-106">Traditional profiling tools focus on measuring the execution of the application.</span></span> <span data-ttu-id="4dd62-107">Oznacza to pomiaru ich czasu poświęcana w każdej funkcji lub użycie pamięci aplikacji w czasie.</span><span class="sxs-lookup"><span data-stu-id="4dd62-107">That is, they measure the time that is spent in each function or the memory usage of the application over time.</span></span> <span data-ttu-id="4dd62-108">Interfejsu API profilowania dotyczy szerszego klasy narzędzi diagnostycznych, takich jak narzędzia pokrycia kodu i nawet zaawansowane debugowania pomocy.</span><span class="sxs-lookup"><span data-stu-id="4dd62-108">The profiling API targets a broader class of diagnostic tools such as code-coverage utilities and even advanced debugging aids.</span></span> <span data-ttu-id="4dd62-109">Te ustawienia są wszystkie diagnostycznych charakter.</span><span class="sxs-lookup"><span data-stu-id="4dd62-109">These uses are all diagnostic in nature.</span></span> <span data-ttu-id="4dd62-110">Interfejsu API profilowania nie tylko miary, ale również monitoruje wykonywania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-110">The profiling API not only measures but also monitors the execution of an application.</span></span> <span data-ttu-id="4dd62-111">Z tego powodu interfejsu API profilowania nie mogą być używane przez samą aplikację, a nie należy uwzględniać wykonywania aplikacji (lub dotyczy) profilera.</span><span class="sxs-lookup"><span data-stu-id="4dd62-111">For this reason, the profiling API should never be used by the application itself, and the application’s execution should not depend on (or be affected by) the profiler.</span></span>  
  
 <span data-ttu-id="4dd62-112">Profilowanie aplikacji CLR wymaga więcej możliwości niż profilowania tradycyjnie skompilowany kod maszyny.</span><span class="sxs-lookup"><span data-stu-id="4dd62-112">Profiling a CLR application requires more support than profiling conventionally compiled machine code.</span></span> <span data-ttu-id="4dd62-113">Jest to spowodowane CLR wprowadza pojęcia, takie jak obsługa wyjątków zarządzanych domeny aplikacji, wyrzucanie elementów bezużytecznych just-in-time (JIT) kompilacji kodu (konwertowanie język pośredni firmy Microsoft lub MSIL, kod do kodu macierzystego maszyny) i podobnych funkcje.</span><span class="sxs-lookup"><span data-stu-id="4dd62-113">This is because the CLR introduces concepts such as application domains, garbage collection, managed exception handling, just-in-time (JIT) compilation of code (converting Microsoft intermediate language, or MSIL, code into native machine code), and similar features.</span></span> <span data-ttu-id="4dd62-114">Konwencjonalne mechanizmów profilowania nie można zidentyfikować lub dostarczające przydatnych informacji o tych funkcjach.</span><span class="sxs-lookup"><span data-stu-id="4dd62-114">Conventional profiling mechanisms cannot identify or provide useful information about these features.</span></span> <span data-ttu-id="4dd62-115">Interfejsu API profilowania zapewnia brakujących informacji wydajnie, minimalny wpływ na wydajność środowiska CLR i profilowana aplikacja.</span><span class="sxs-lookup"><span data-stu-id="4dd62-115">The profiling API provides this missing information efficiently, with minimal effect on the performance of the CLR and the profiled application.</span></span>  
  
 <span data-ttu-id="4dd62-116">Kompilacja JIT w czasie wykonywania zapewnia dobre możliwości do profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-116">JIT compilation at run time provides good opportunities for profiling.</span></span> <span data-ttu-id="4dd62-117">Interfejsu API profilowania umożliwia profilera zmienić strumienia kodu MSIL w pamięci dla procedury, zanim zostanie skompilowany JIT.</span><span class="sxs-lookup"><span data-stu-id="4dd62-117">The profiling API enables a profiler to change the in-memory MSIL code stream for a routine before it is JIT-compiled.</span></span> <span data-ttu-id="4dd62-118">W ten sposób profilera można dynamicznie dodać kod Instrumentacji do określonej procedury, które wymagają głębsza analiza.</span><span class="sxs-lookup"><span data-stu-id="4dd62-118">In this manner, the profiler can dynamically add instrumentation code to particular routines that need deeper investigation.</span></span> <span data-ttu-id="4dd62-119">Takie podejście jest możliwe w scenariuszach z konwencjonalnej, jest znacznie łatwiejsze do wdrożenia dla środowiska CLR za pomocą interfejsu API profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-119">Although this approach is possible in conventional scenarios, it is much easier to implement for the CLR by using the profiling API.</span></span>  
  
 <span data-ttu-id="4dd62-120">Ten przegląd zawiera następujące sekcje:</span><span class="sxs-lookup"><span data-stu-id="4dd62-120">This overview consists of the following sections:</span></span>  
  
-   [<span data-ttu-id="4dd62-121">Interfejsu API profilowania</span><span class="sxs-lookup"><span data-stu-id="4dd62-121">The Profiling API</span></span>](#profiling_api)  
  
-   [<span data-ttu-id="4dd62-122">Obsługiwane funkcje</span><span class="sxs-lookup"><span data-stu-id="4dd62-122">Supported Features</span></span>](#support)  
  
-   [<span data-ttu-id="4dd62-123">Wątki powiadomień</span><span class="sxs-lookup"><span data-stu-id="4dd62-123">Notification Threads</span></span>](#notification_threads)  
  
-   [<span data-ttu-id="4dd62-124">Zabezpieczenia</span><span class="sxs-lookup"><span data-stu-id="4dd62-124">Security</span></span>](#security)  
  
-   [<span data-ttu-id="4dd62-125">Łączenie zarządzanych i niezarządzanych kodu w profilera kodu</span><span class="sxs-lookup"><span data-stu-id="4dd62-125">Combining Managed and Unmanaged Code in a Code Profiler</span></span>](#combining_managed_unmanaged)  
  
-   [<span data-ttu-id="4dd62-126">Niezarządzany kod profilowania</span><span class="sxs-lookup"><span data-stu-id="4dd62-126">Profiling Unmanaged Code</span></span>](#unmanaged)  
  
-   [<span data-ttu-id="4dd62-127">Przy użyciu modelu COM</span><span class="sxs-lookup"><span data-stu-id="4dd62-127">Using COM</span></span>](#com)  
  
-   [<span data-ttu-id="4dd62-128">Stosy wywołań</span><span class="sxs-lookup"><span data-stu-id="4dd62-128">Call stacks</span></span>](#call_stacks)  
  
-   [<span data-ttu-id="4dd62-129">Wywołania zwrotne i głębokość stosu</span><span class="sxs-lookup"><span data-stu-id="4dd62-129">Callbacks and Stack Depth</span></span>](#callbacks)  
  
-   [<span data-ttu-id="4dd62-130">Tematy pokrewne</span><span class="sxs-lookup"><span data-stu-id="4dd62-130">Related Topics</span></span>](#related_topics)  
  
<a name="profiling_api"></a>   
## <a name="the-profiling-api"></a><span data-ttu-id="4dd62-131">Interfejsu API profilowania</span><span class="sxs-lookup"><span data-stu-id="4dd62-131">The Profiling API</span></span>  
 <span data-ttu-id="4dd62-132">Zazwyczaj interfejsu API profilowania służy do zapisywania *program profilujący*, który jest program, który monitoruje wykonywanie zarządzanej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-132">Typically, the profiling API is used to write a *code profiler*, which is a program that monitors the execution of a managed application.</span></span>  
  
 <span data-ttu-id="4dd62-133">Interfejsu API profilowania jest używany przez profiler biblioteki DLL, który jest ładowany do tego samego procesu jak aplikacja, która jest poddawany profilowaniu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-133">The profiling API is used by a profiler DLL, which is loaded into the same process as the application that is being profiled.</span></span> <span data-ttu-id="4dd62-134">Biblioteki DLL profilera implementuje interfejs wywołania zwrotnego ([ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) w programie .NET Framework w wersji 1.0, 1.1, [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) w wersji 2.0 lub nowszy).</span><span class="sxs-lookup"><span data-stu-id="4dd62-134">The profiler DLL implements a callback interface ([ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) in the .NET Framework version 1.0 and 1.1, [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) in version 2.0 and later).</span></span> <span data-ttu-id="4dd62-135">Środowisko CLR wywołuje metody tego interfejsu do powiadamiania profilera zdarzenia PROFILOWANEGO procesu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-135">The CLR calls the methods in that interface to notify the profiler of events in the profiled process.</span></span> <span data-ttu-id="4dd62-136">Profiler może wywołania zwrotnego w czasie wykonywania przez przy użyciu metod w [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) i [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md) interfejsów, aby uzyskać informacje o stanie profilowana aplikacja.</span><span class="sxs-lookup"><span data-stu-id="4dd62-136">The profiler can call back into the runtime by using the methods in the [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) and [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md) interfaces to obtain information about the state of the profiled application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4dd62-137">W tym samym procesie jako profilowana aplikacja powinna być uruchomiona tylko częścią gromadzenia danych rozwiązania profilera.</span><span class="sxs-lookup"><span data-stu-id="4dd62-137">Only the data-gathering part of the profiler solution should be running in the same process as the profiled application.</span></span> <span data-ttu-id="4dd62-138">Wszystkich użytkowników interface i analizy danych, należy wykonać w ramach osobnej operacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-138">All user interface and data analysis should be performed in a separate process.</span></span>  
  
 <span data-ttu-id="4dd62-139">Na poniższej ilustracji przedstawiono, jak biblioteki DLL profilera współdziała z aplikacji, która jest PROFILOWANEGO i środowiska CLR.</span><span class="sxs-lookup"><span data-stu-id="4dd62-139">The following illustration shows how the profiler DLL interacts with the application that is being profiled and the CLR.</span></span>  
  
 <span data-ttu-id="4dd62-140">![Profilowanie architektury](../../../../docs/framework/unmanaged-api/profiling/media/profilingarch.png "ProfilingArch")</span><span class="sxs-lookup"><span data-stu-id="4dd62-140">![Profiling Architecture](../../../../docs/framework/unmanaged-api/profiling/media/profilingarch.png "ProfilingArch")</span></span>  
<span data-ttu-id="4dd62-141">Profilowanie architektury</span><span class="sxs-lookup"><span data-stu-id="4dd62-141">Profiling architecture</span></span>  
  
### <a name="the-notification-interfaces"></a><span data-ttu-id="4dd62-142">Interfejsy powiadomień</span><span class="sxs-lookup"><span data-stu-id="4dd62-142">The Notification Interfaces</span></span>  
 <span data-ttu-id="4dd62-143">[ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) i [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) mogą zostać uwzględnione interfejsy powiadomień.</span><span class="sxs-lookup"><span data-stu-id="4dd62-143">[ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) and [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) can be considered notification interfaces.</span></span> <span data-ttu-id="4dd62-144">Te interfejsy składają się z metody takie jak [ClassLoadStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadstarted-method.md), [ClassLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md), i [JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md).</span><span class="sxs-lookup"><span data-stu-id="4dd62-144">These interfaces consist of methods such as [ClassLoadStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadstarted-method.md), [ClassLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md), and [JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md).</span></span> <span data-ttu-id="4dd62-145">Za każdym razem CLR ładuje lub zwalnia klasy kompiluje funkcji i itd., wywołuje odpowiedniej metody w profilera `ICorProfilerCallback` lub `ICorProfilerCallback2` interfejsu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-145">Each time the CLR loads or unloads a class, compiles a function, and so on, it calls the corresponding method in the profiler's `ICorProfilerCallback` or `ICorProfilerCallback2` interface.</span></span>  
  
 <span data-ttu-id="4dd62-146">Na przykład profiler może pomiaru wydajności kodu za pomocą dwóch funkcji powiadomień: [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) i [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md).</span><span class="sxs-lookup"><span data-stu-id="4dd62-146">For example, a profiler could measure code performance through two notification functions: [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) and [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md).</span></span> <span data-ttu-id="4dd62-147">Go tylko sygnatury czasowe akumuluje wyniki każdego powiadomienia i wyświetla listę, która wskazuje, które funkcje używane najwięcej procesora CPU lub tablicy zegara czasu podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-147">It just time-stamps each notification, accumulates results, and outputs a list that indicates which functions consumed the most CPU or wall-clock time during the execution of the application.</span></span>  
  
### <a name="the-information-retrieval-interfaces"></a><span data-ttu-id="4dd62-148">Interfejsy pobierania informacji</span><span class="sxs-lookup"><span data-stu-id="4dd62-148">The Information Retrieval Interfaces</span></span>  
 <span data-ttu-id="4dd62-149">Inne objętego profilowania głównego interfejsy są [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) i [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md).</span><span class="sxs-lookup"><span data-stu-id="4dd62-149">The other main interfaces involved in profiling are [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) and [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md).</span></span> <span data-ttu-id="4dd62-150">Profiler wywołuje te interfejsy zgodnie z wymaganiami, aby uzyskać więcej informacji na temat jego analizy.</span><span class="sxs-lookup"><span data-stu-id="4dd62-150">The profiler calls these interfaces as required to obtain more information to help its analysis.</span></span> <span data-ttu-id="4dd62-151">Na przykład, gdy środowisko CLR wywołuje [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) funkcji, podaje identyfikator funkcji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-151">For example, whenever the CLR calls the [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) function, it supplies a function identifier.</span></span> <span data-ttu-id="4dd62-152">Profiler można uzyskać więcej informacji na temat tej funkcji, wywołując [ICorProfilerInfo2::GetFunctionInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md) metody odnajdywania przez funkcję klasy nadrzędnej, jego nazwa i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="4dd62-152">The profiler can get more information about that function by calling the [ICorProfilerInfo2::GetFunctionInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md) method to discover the function's parent class, its name, and so on.</span></span>  
  
 [<span data-ttu-id="4dd62-153">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-153">Back to top</span></span>](#top)  
  
<a name="support"></a>   
## <a name="supported-features"></a><span data-ttu-id="4dd62-154">Obsługiwane funkcje</span><span class="sxs-lookup"><span data-stu-id="4dd62-154">Supported Features</span></span>  
 <span data-ttu-id="4dd62-155">Interfejsu API profilowania zawiera informacje o różnych zdarzeń i akcje, które występują w środowisko uruchomieniowe języka wspólnego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-155">The profiling API provides information about a variety of events and actions that occur in the common language runtime.</span></span> <span data-ttu-id="4dd62-156">Monitorowanie przebiega procesów oraz analizowanie wydajności aplikacji .NET Framework, można użyć tych informacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-156">You can use this information to monitor the inner workings of processes and to analyze the performance of your .NET Framework application.</span></span>  
  
 <span data-ttu-id="4dd62-157">Interfejsu API profilowania pobiera informacje o następujące akcje i zdarzenia występujące w środowisku CLR:</span><span class="sxs-lookup"><span data-stu-id="4dd62-157">The profiling API retrieves information about the following actions and events that occur in the CLR:</span></span>  
  
-   <span data-ttu-id="4dd62-158">Zdarzenia uruchamiania i wyłączania CLR.</span><span class="sxs-lookup"><span data-stu-id="4dd62-158">CLR startup and shutdown events.</span></span>  
  
-   <span data-ttu-id="4dd62-159">Zdarzenia tworzenia i zamykania aplikacji domeny.</span><span class="sxs-lookup"><span data-stu-id="4dd62-159">Application domain creation and shutdown events.</span></span>  
  
-   <span data-ttu-id="4dd62-160">Zestaw ładowanie i zwalnianie zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="4dd62-160">Assembly loading and unloading events.</span></span>  
  
-   <span data-ttu-id="4dd62-161">Moduł ładowanie i zwalnianie zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="4dd62-161">Module loading and unloading events.</span></span>  
  
-   <span data-ttu-id="4dd62-162">COM vtable tworzenie i likwidacja zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="4dd62-162">COM vtable creation and destruction events.</span></span>  
  
-   <span data-ttu-id="4dd62-163">Just-in-time (JIT) kompilacji i zdarzenia pitching kodu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-163">Just-in-time (JIT) compilation and code-pitching events.</span></span>  
  
-   <span data-ttu-id="4dd62-164">Klasa zdarzeń ładowania i zwalniania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-164">Class loading and unloading events.</span></span>  
  
-   <span data-ttu-id="4dd62-165">Tworzenie i likwidacja zdarzenia wątków.</span><span class="sxs-lookup"><span data-stu-id="4dd62-165">Thread creation and destruction events.</span></span>  
  
-   <span data-ttu-id="4dd62-166">Wejście i wyjście z zdarzenia funkcji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-166">Function entry and exit events.</span></span>  
  
-   <span data-ttu-id="4dd62-167">Wyjątki.</span><span class="sxs-lookup"><span data-stu-id="4dd62-167">Exceptions.</span></span>  
  
-   <span data-ttu-id="4dd62-168">Przejścia między wykonanie kodu zarządzane i niezarządzane.</span><span class="sxs-lookup"><span data-stu-id="4dd62-168">Transitions between managed and unmanaged code execution.</span></span>  
  
-   <span data-ttu-id="4dd62-169">Przejścia między runtime różnych kontekstach.</span><span class="sxs-lookup"><span data-stu-id="4dd62-169">Transitions between different runtime contexts.</span></span>  
  
-   <span data-ttu-id="4dd62-170">Informacje o zawieszeniu środowiska wykonawczego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-170">Information about runtime suspensions.</span></span>  
  
-   <span data-ttu-id="4dd62-171">Informacje na temat środowiska uruchomieniowego pamięci sterty i odzyskiwanie kolekcji działania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-171">Information about the runtime memory heap and garbage collection activity.</span></span>  
  
 <span data-ttu-id="4dd62-172">Z dowolnego języka zgodny z modelu COM (niezarządzany) można wywołać interfejsu API profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-172">The profiling API can be called from any (non-managed) COM-compatible language.</span></span>  
  
 <span data-ttu-id="4dd62-173">Interfejs API jest efektywne względem zużycie procesora CPU i pamięci.</span><span class="sxs-lookup"><span data-stu-id="4dd62-173">The API is efficient with regard to CPU and memory consumption.</span></span> <span data-ttu-id="4dd62-174">Profilowanie nie obejmują zmiany do PROFILOWANEGO aplikacji, które są istotne, błędne wyniki.</span><span class="sxs-lookup"><span data-stu-id="4dd62-174">Profiling does not involve changes to the profiled application that are significant enough to cause misleading results.</span></span>  
  
 <span data-ttu-id="4dd62-175">Interfejsu API profilowania przydaje się do profilowania pobierania próbek i z systemem innym niż próbkowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-175">The profiling API is useful to both sampling and non-sampling profilers.</span></span> <span data-ttu-id="4dd62-176">A *próbkowania profilera* przeprowadzający profilu przy Takty zegara regularne powiedzieć, w milisekundach 5 od siebie.</span><span class="sxs-lookup"><span data-stu-id="4dd62-176">A *sampling profiler* inspects the profile at regular clock ticks, say, at 5 milliseconds apart.</span></span> <span data-ttu-id="4dd62-177">A *z systemem innym niż próbkowania profilera* zostanie poinformowany o zdarzenie synchronicznie przy użyciu wątku, który powoduje, że zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="4dd62-177">A *non-sampling profiler* is informed of an event synchronously with the thread that causes the event.</span></span>  
  
### <a name="unsupported-functionality"></a><span data-ttu-id="4dd62-178">Nieobsługiwanych funkcji</span><span class="sxs-lookup"><span data-stu-id="4dd62-178">Unsupported Functionality</span></span>  
 <span data-ttu-id="4dd62-179">Interfejsu API profilowania nie obsługuje następujące funkcje:</span><span class="sxs-lookup"><span data-stu-id="4dd62-179">The profiling API does not support the following functionality:</span></span>  
  
-   <span data-ttu-id="4dd62-180">Niezarządzany kod, który musi być profilowane konwencjonalnej metodami Win32.</span><span class="sxs-lookup"><span data-stu-id="4dd62-180">Unmanaged code, which must be profiled using conventional Win32 methods.</span></span> <span data-ttu-id="4dd62-181">Jednak CLR profiler zawiera zdarzenia przejścia do określenia granicę między zarządzanymi i niezarządzanymi kodu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-181">However, the CLR profiler includes transition events to determine the boundaries between managed and unmanaged code.</span></span>  
  
-   <span data-ttu-id="4dd62-182">Modyfikowanie własnym aplikacje, które modyfikują własny kod do celów, takich jak programowanie zorientowane na proporcji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-182">Self-modifying applications that modify their own code for purposes such as aspect-oriented programming.</span></span>  
  
-   <span data-ttu-id="4dd62-183">Sprawdzanie, ponieważ interfejsu API profilowania nie dostarcza informacji granic.</span><span class="sxs-lookup"><span data-stu-id="4dd62-183">Bounds checking, because the profiling API does not provide this information.</span></span> <span data-ttu-id="4dd62-184">Środowisko CLR zapewnia obsługę wewnętrzne granice sprawdzanie wszystkich kodu zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-184">The CLR provides intrinsic support for bounds checking of all managed code.</span></span>  
  
-   <span data-ttu-id="4dd62-185">Zdalne profilowania, która nie jest obsługiwana w następujących sytuacjach:</span><span class="sxs-lookup"><span data-stu-id="4dd62-185">Remote profiling, which is not supported for the following reasons:</span></span>  
  
    -   <span data-ttu-id="4dd62-186">Profilowanie zdalne rozszerza czasu wykonywania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-186">Remote profiling extends execution time.</span></span> <span data-ttu-id="4dd62-187">Gdy używasz interfejsy profilowania, można zminimalizować czas wykonania tak, aby wyniki profilowania nie ma negatywnego wpływu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-187">When you use the profiling interfaces, you must minimize execution time so that profiling results will not be unduly affected.</span></span> <span data-ttu-id="4dd62-188">Jest to szczególnie istotne podczas wykonywania wydajności jest monitorowany.</span><span class="sxs-lookup"><span data-stu-id="4dd62-188">This is especially true when execution performance is being monitored.</span></span> <span data-ttu-id="4dd62-189">Jednak profilowanie zdalne nie jest to ograniczenie podczas profilowania interfejsy są używane do monitorowania wykorzystania pamięci lub Aby uzyskać informacje czasu wykonywania ramki stosu, obiekty i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="4dd62-189">However, remote profiling is not a limitation when the profiling interfaces are used to monitor memory usage or to obtain run-time information about stack frames, objects, and so on.</span></span>  
  
    -   <span data-ttu-id="4dd62-190">Profiler CLR kod należy zarejestrować co najmniej jeden interfejs wywołania zwrotnego ze środowiskiem uruchomieniowym na komputerze lokalnym, na którym działa profilowana aplikacja.</span><span class="sxs-lookup"><span data-stu-id="4dd62-190">The CLR code profiler must register one or more callback interfaces with the runtime on the local computer on which the profiled application is running.</span></span> <span data-ttu-id="4dd62-191">To ogranicza możliwość tworzenia profilera zdalnego kodu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-191">This limits the ability to create a remote code profiler.</span></span>  
  
-   <span data-ttu-id="4dd62-192">Profilowanie w środowisku produkcyjnym wymagania wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="4dd62-192">Profiling in production environments with high-availability requirements.</span></span> <span data-ttu-id="4dd62-193">Interfejsu API profilowania został utworzony w celu obsługi diagnostyki w czasie opracowywania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-193">The profiling API was created to support development-time diagnostics.</span></span> <span data-ttu-id="4dd62-194">Nie przeszły rygorystyczne testy wymagane do obsługi środowisk produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="4dd62-194">It has not undergone the rigorous testing required to support production environments.</span></span>  
  
 [<span data-ttu-id="4dd62-195">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-195">Back to top</span></span>](#top)  
  
<a name="notification_threads"></a>   
## <a name="notification-threads"></a><span data-ttu-id="4dd62-196">Wątki powiadomień</span><span class="sxs-lookup"><span data-stu-id="4dd62-196">Notification Threads</span></span>  
 <span data-ttu-id="4dd62-197">W większości przypadków wątku, który generuje zdarzenie wykonuje powiadomienia.</span><span class="sxs-lookup"><span data-stu-id="4dd62-197">In most cases, the thread that generates an event also executes notifications.</span></span> <span data-ttu-id="4dd62-198">Powiadomienia (na przykład [FunctionEnter](../../../../docs/framework/unmanaged-api/profiling/functionenter-function.md) i [FunctionLeave](../../../../docs/framework/unmanaged-api/profiling/functionleave-function.md)) nie trzeba podać jawne `ThreadID`.</span><span class="sxs-lookup"><span data-stu-id="4dd62-198">Such notifications (for example, [FunctionEnter](../../../../docs/framework/unmanaged-api/profiling/functionenter-function.md) and [FunctionLeave](../../../../docs/framework/unmanaged-api/profiling/functionleave-function.md)) do not need to supply the explicit `ThreadID`.</span></span> <span data-ttu-id="4dd62-199">Ponadto profilera zdecydować się na używane magazynu wątków lokalnych do przechowywania i zaktualizuj jego bloków analizy zamiast indeksowania bloków analizy w globalnej pamięci masowej, na podstawie `ThreadID` dotyczy wątku.</span><span class="sxs-lookup"><span data-stu-id="4dd62-199">Also, the profiler might decide to use thread-local storage to store and update its analysis blocks instead of indexing the analysis blocks in global storage, based on the `ThreadID` of the affected thread.</span></span>  
  
 <span data-ttu-id="4dd62-200">Należy pamiętać, że te wywołania zwrotne nie są serializowane.</span><span class="sxs-lookup"><span data-stu-id="4dd62-200">Note that these callbacks are not serialized.</span></span> <span data-ttu-id="4dd62-201">Użytkownicy muszą chronić ich kodu przez utworzenie struktury danych wątkowo i blokowanie kodu profilera, gdzie jest to konieczne w celu zapobieżenia równoległych dostęp wiele wątków.</span><span class="sxs-lookup"><span data-stu-id="4dd62-201">Users must protect their code by creating thread-safe data structures and by locking the profiler code where necessary to prevent parallel access from multiple threads.</span></span> <span data-ttu-id="4dd62-202">Dlatego w niektórych przypadkach może odbierać nietypowe sekwencję wywołań zwrotnych.</span><span class="sxs-lookup"><span data-stu-id="4dd62-202">Therefore, in certain cases you can receive an unusual sequence of callbacks.</span></span> <span data-ttu-id="4dd62-203">Na przykład przypuśćmy, że zarządzanej aplikacji jest duplikowanie dwóch wątków, które są wykonywane w taki sam kod.</span><span class="sxs-lookup"><span data-stu-id="4dd62-203">For example, assume that a managed application is spawning two threads that are executing identical code.</span></span> <span data-ttu-id="4dd62-204">W takim przypadku użytkownik może odbierać [ICorProfilerCallback::JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md) zdarzenia dla niektórych funkcji z jednego wątku i `FunctionEnter` wywołania zwrotnego z wątku przed odbieranie [ ICorProfilerCallback::JITCompilationFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationfinished-method.md) wywołania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-204">In this case, it is possible to receive a [ICorProfilerCallback::JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md) event for some function from one thread and a `FunctionEnter` callback from the other thread before receiving the [ICorProfilerCallback::JITCompilationFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationfinished-method.md) callback.</span></span> <span data-ttu-id="4dd62-205">W takim przypadku użytkownik otrzyma `FunctionEnter` wywołania zwrotnego dla funkcji, które mogły nie zostać całkowicie just-in-time (JIT) jeszcze skompilowana.</span><span class="sxs-lookup"><span data-stu-id="4dd62-205">In this case, the user will receive a `FunctionEnter` callback for a function that may not have been fully just-in-time (JIT) compiled yet.</span></span>  
  
 [<span data-ttu-id="4dd62-206">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-206">Back to top</span></span>](#top)  
  
<a name="security"></a>   
## <a name="security"></a><span data-ttu-id="4dd62-207">Zabezpieczenia</span><span class="sxs-lookup"><span data-stu-id="4dd62-207">Security</span></span>  
 <span data-ttu-id="4dd62-208">Profiler biblioteki DLL jest niezarządzany biblioteki DLL, która działa jako część aparat wykonywania środowiska uruchomieniowego języka wspólnego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-208">A profiler DLL is an unmanaged DLL that runs as part of the common language runtime execution engine.</span></span> <span data-ttu-id="4dd62-209">W związku z tym kod w profilera, które biblioteki DLL nie podlega ograniczeniom zarządzane zabezpieczenia dostępu kodu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-209">As a result, the code in the profiler DLL is not subject to the restrictions of managed code access security.</span></span> <span data-ttu-id="4dd62-210">Jedynymi ograniczeniami profilera biblioteki DLL są nakładane przez system operacyjny na użytkownika, który działa profilowana aplikacja.</span><span class="sxs-lookup"><span data-stu-id="4dd62-210">The only limitations on the profiler DLL are those imposed by the operating system on the user who is running the profiled application.</span></span>  
  
 <span data-ttu-id="4dd62-211">Autorzy profilera należy podjąć odpowiednie środki ostrożności, aby uniknąć problemów związanych z zabezpieczeniami.</span><span class="sxs-lookup"><span data-stu-id="4dd62-211">Profiler authors should take appropriate precautions to avoid security-related issues.</span></span> <span data-ttu-id="4dd62-212">Na przykład podczas instalacji, biblioteki DLL profilera powinien można dodać do listy kontroli dostępu (ACL), aby złośliwy użytkownik nie można go modyfikować.</span><span class="sxs-lookup"><span data-stu-id="4dd62-212">For example, during installation, a profiler DLL should be added to an access control list (ACL) so that a malicious user cannot modify it.</span></span>  
  
 [<span data-ttu-id="4dd62-213">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-213">Back to top</span></span>](#top)  
  
<a name="combining_managed_unmanaged"></a>   
## <a name="combining-managed-and-unmanaged-code-in-a-code-profiler"></a><span data-ttu-id="4dd62-214">Łączenie zarządzanych i niezarządzanych kodu w profilera kodu</span><span class="sxs-lookup"><span data-stu-id="4dd62-214">Combining Managed and Unmanaged Code in a Code Profiler</span></span>  
 <span data-ttu-id="4dd62-215">Niepoprawnie napisany profilera może spowodować cykliczne odwołanie do samej siebie, co w sposób nieprzewidywalny.</span><span class="sxs-lookup"><span data-stu-id="4dd62-215">An incorrectly written profiler can cause circular references to itself, resulting in unpredictable behavior.</span></span>  
  
 <span data-ttu-id="4dd62-216">Przegląd profilowania API środowiska CLR może tworzyć wrażenie, który może zapisać profilera, zawierający składniki zarządzane i niezarządzane, wywołujące wzajemnie za pośrednictwem wywołania COM interop lub pośrednie.</span><span class="sxs-lookup"><span data-stu-id="4dd62-216">A review of the CLR profiling API may create the impression that you can write a profiler that contains managed and unmanaged components that call each other through COM interop or indirect calls.</span></span>  
  
 <span data-ttu-id="4dd62-217">Jest to możliwe z punktu widzenia projektu, interfejsu API profilowania nie obsługuje składników zarządzanych.</span><span class="sxs-lookup"><span data-stu-id="4dd62-217">Although this is possible from a design perspective, the profiling API does not support managed components.</span></span> <span data-ttu-id="4dd62-218">CLR profiler muszą być całkowicie niezarządzane.</span><span class="sxs-lookup"><span data-stu-id="4dd62-218">A CLR profiler must be completely unmanaged.</span></span> <span data-ttu-id="4dd62-219">Próbuje połączyć kod zarządzane i niezarządzane w CLR profiler może spowodować naruszenia zasad dostępu, program awarii lub zakleszczenia.</span><span class="sxs-lookup"><span data-stu-id="4dd62-219">Attempts to combine managed and unmanaged code in a CLR profiler may cause access violations, program failure, or deadlocks.</span></span> <span data-ttu-id="4dd62-220">Zarządzane składniki profilera będą wyzwalać zdarzeń do ich niezarządzane składniki, które następnie wywołać składników zarządzanych do ponownie, co powoduje odwołań cyklicznych.</span><span class="sxs-lookup"><span data-stu-id="4dd62-220">The managed components of the profiler will fire events back to their unmanaged components, which would subsequently call the managed components again, resulting in circular references.</span></span>  
  
 <span data-ttu-id="4dd62-221">Tylko gdy CLR profiler mogą wywoływać kodu zarządzanego bezpiecznie znajduje się w treści metody język pośredni (MSIL) firmy Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4dd62-221">The only location where a CLR profiler can call managed code safely is in the Microsoft intermediate language (MSIL) body of a method.</span></span> <span data-ttu-id="4dd62-222">Zalecanym działaniem w przypadku modyfikowania treści MSIL jest użycie metody ponownej kompilacji JIT w [ICorProfilerCallback4](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback4-interface.md) interfejsu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-222">The recommended practice for modifying the MSIL body is to use the  JIT recompilation methods in the [ICorProfilerCallback4](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback4-interface.md) interface.</span></span>  
  
 <span data-ttu-id="4dd62-223">Istnieje również możliwość użycia starsze metody Instrumentacji do modyfikowania MSIL.</span><span class="sxs-lookup"><span data-stu-id="4dd62-223">It is also possible to use the older instrumentation methods to modify MSIL.</span></span> <span data-ttu-id="4dd62-224">Przed ukończeniem kompilacji just-in-time (JIT) funkcji profilera można wstawić wywołań zarządzanych w treści metody, a następnie kompilacji JIT MSIL go (zobacz [ICorProfilerInfo::GetILFunctionBody](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbody-method.md) metody).</span><span class="sxs-lookup"><span data-stu-id="4dd62-224">Before the just-in-time (JIT) compilation of a function is completed, the profiler can insert managed calls in the MSIL body of a method and then JIT-compile it (see the [ICorProfilerInfo::GetILFunctionBody](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbody-method.md) method).</span></span> <span data-ttu-id="4dd62-225">Ta technika pomyślnie może służyć do selektywnego Instrumentacji kodu zarządzanego lub w celu zbierania statystyk i wydajności dane dotyczące JIT.</span><span class="sxs-lookup"><span data-stu-id="4dd62-225">This technique can successfully be used for selective instrumentation of managed code, or to gather statistics and performance data about the JIT.</span></span>  
  
 <span data-ttu-id="4dd62-226">Alternatywnie profilera kodu można wstawić natywnego punkty zaczepienia w treści MSIL każdego zarządzanego funkcji, który odwołuje się do kodu niezarządzanego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-226">Alternatively, a code profiler can insert native hooks in the MSIL body of every managed function that calls into unmanaged code.</span></span> <span data-ttu-id="4dd62-227">Ta technika może służyć do Instrumentacji i pokrycie.</span><span class="sxs-lookup"><span data-stu-id="4dd62-227">This technique can be used for instrumentation and coverage.</span></span> <span data-ttu-id="4dd62-228">Na przykład profilera kodu można wstawić punkty zaczepienia w Instrumentacji po każdym bloku MSIL, aby upewnić się, że wykonano bloku.</span><span class="sxs-lookup"><span data-stu-id="4dd62-228">For example, a code profiler could insert instrumentation hooks after every MSIL block to ensure that the block has been executed.</span></span> <span data-ttu-id="4dd62-229">Modyfikacja MSIL treści metody jest bardzo delikatny operację, i istnieje wiele czynników, które należy wziąć pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="4dd62-229">The modification of the MSIL body of a method is a very delicate operation, and there are many factors that should be taken into consideration.</span></span>  
  
 [<span data-ttu-id="4dd62-230">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-230">Back to top</span></span>](#top)  
  
<a name="unmanaged"></a>   
## <a name="profiling-unmanaged-code"></a><span data-ttu-id="4dd62-231">Niezarządzany kod profilowania</span><span class="sxs-lookup"><span data-stu-id="4dd62-231">Profiling Unmanaged Code</span></span>  
 <span data-ttu-id="4dd62-232">Środowisko uruchomieniowe języka wspólnego (CLR) interfejsu API profilowania zapewnia obsługę minimalnego profilowania kodu niezarządzanego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-232">The common language runtime (CLR) profiling API provides minimal support for profiling unmanaged code.</span></span> <span data-ttu-id="4dd62-233">Podano następujące funkcje:</span><span class="sxs-lookup"><span data-stu-id="4dd62-233">The following functionality is provided:</span></span>  
  
-   <span data-ttu-id="4dd62-234">Wyliczenie łańcuchów stosu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-234">Enumeration of stack chains.</span></span> <span data-ttu-id="4dd62-235">Ta funkcja umożliwia profilera kod określić granicę między kodu zarządzanego i kodu niezarządzanego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-235">This feature enables a code profiler to determine the boundary between managed code and unmanaged code.</span></span>  
  
-   <span data-ttu-id="4dd62-236">Oznaczanie czy łańcuch stosu odnosi się do kodu zarządzanego i kodu natywnego.</span><span class="sxs-lookup"><span data-stu-id="4dd62-236">Determination whether a stack chain corresponds to managed code or native code.</span></span>  
  
 <span data-ttu-id="4dd62-237">W wersji systemu .NET Framework 1.0 i 1.1 te metody są dostępne w trakcie podzbiór CLR debugowanie interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="4dd62-237">In the .NET Framework versions 1.0 and 1.1, these methods are available through the in-process subset of the CLR debugging API.</span></span> <span data-ttu-id="4dd62-238">Są one zdefiniowane w pliku CorDebug.idl.</span><span class="sxs-lookup"><span data-stu-id="4dd62-238">They are defined in the CorDebug.idl file.</span></span>  
  
 <span data-ttu-id="4dd62-239">W .NET Framework 2.0 lub nowszej, można użyć [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) metodę dla tej funkcji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-239">In the .NET Framework 2.0 and later, you can use the [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) method for this functionality.</span></span>  
  
 [<span data-ttu-id="4dd62-240">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-240">Back to top</span></span>](#top)  
  
<a name="com"></a>   
## <a name="using-com"></a><span data-ttu-id="4dd62-241">Przy użyciu modelu COM</span><span class="sxs-lookup"><span data-stu-id="4dd62-241">Using COM</span></span>  
 <span data-ttu-id="4dd62-242">Mimo że profilowania interfejsy są zdefiniowane jako interfejsy modelu COM, środowisko uruchomieniowe języka wspólnego (CLR) nie faktycznie zainicjować modelu COM w celu użycia tych interfejsów.</span><span class="sxs-lookup"><span data-stu-id="4dd62-242">Although the profiling interfaces are defined as COM interfaces, the common language runtime (CLR) does not actually initialize COM to use these interfaces.</span></span> <span data-ttu-id="4dd62-243">Przyczyną jest aby uniknąć konieczności ustawiania modelu wątkowości przy użyciu [CoInitialize](http://msdn.microsoft.com/library/windows/desktop/ms678543\(v=vs.85\).aspx) funkcji przed zarządzanej aplikacji miał możliwość określić jego żądanego modelu wątkowości.</span><span class="sxs-lookup"><span data-stu-id="4dd62-243">The reason is to avoid having to set the threading model by using the [CoInitialize](http://msdn.microsoft.com/library/windows/desktop/ms678543\(v=vs.85\).aspx) function before the managed application has had a chance to specify its desired threading model.</span></span> <span data-ttu-id="4dd62-244">Podobnie, nie powinny wywoływać profilera sam `CoInitialize`, ponieważ może wybierz model wątków, która jest niezgodna z aplikacją PROFILOWANEGO i może spowodować awarię aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-244">Similarly, the profiler itself should not call `CoInitialize`, because it may pick a threading model that is incompatible with the application being profiled and may cause the application to fail.</span></span>  
  
 [<span data-ttu-id="4dd62-245">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-245">Back to top</span></span>](#top)  
  
<a name="call_stacks"></a>   
## <a name="call-stacks"></a><span data-ttu-id="4dd62-246">Stosy wywołań</span><span class="sxs-lookup"><span data-stu-id="4dd62-246">Call Stacks</span></span>  
 <span data-ttu-id="4dd62-247">Interfejsu API profilowania udostępnia dwa sposoby uzyskania stosy wywołań: metoda migawki stosu, co umożliwia gromadzenie rozrzedzonych stosy wywołań, i metodę stosu w tle, który śledzi stos wywołań w każdej chwili.</span><span class="sxs-lookup"><span data-stu-id="4dd62-247">The profiling API provides two ways to obtain call stacks: a stack snapshot method, which enables sparse gathering of call stacks, and a shadow stack method, which tracks the call stack at every instant.</span></span>  
  
### <a name="stack-snapshot"></a><span data-ttu-id="4dd62-248">Migawki stosu</span><span class="sxs-lookup"><span data-stu-id="4dd62-248">Stack Snapshot</span></span>  
 <span data-ttu-id="4dd62-249">Migawki stosu jest śladu stosu wątku w chwili w czasie.</span><span class="sxs-lookup"><span data-stu-id="4dd62-249">A stack snapshot is a trace of the stack of a thread at an instant in time.</span></span> <span data-ttu-id="4dd62-250">Interfejsu API profilowania obsługuje śledzenie zarządzanego funkcji na stosie, ale pozostawia śledzenie niezarządzanych funkcji do własnych profilera walkera stosu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-250">The profiling API supports the tracing of managed functions on the stack, but it leaves the tracing of unmanaged functions to the profiler's own stack walker.</span></span>  
  
 <span data-ttu-id="4dd62-251">Aby uzyskać więcej informacji na temat programu profiler do przeszukania zarządzane stosy, zobacz [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) metody w tym zestawie dokumentacji i [profilera stosu przejście w .NET Framework 2.0: Podstawy i poza](http://go.microsoft.com/fwlink/?LinkId=73638).</span><span class="sxs-lookup"><span data-stu-id="4dd62-251">For more information about how to program the profiler to walk managed stacks, see the [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) method in this documentation set, and [Profiler Stack Walking in the .NET Framework 2.0: Basics and Beyond](http://go.microsoft.com/fwlink/?LinkId=73638).</span></span>
  
### <a name="shadow-stack"></a><span data-ttu-id="4dd62-252">Stos w tle</span><span class="sxs-lookup"><span data-stu-id="4dd62-252">Shadow Stack</span></span>  
 <span data-ttu-id="4dd62-253">Przy użyciu metody migawki zbyt często może szybko utworzyć problem z wydajnością.</span><span class="sxs-lookup"><span data-stu-id="4dd62-253">Using the snapshot method too frequently can quickly create a performance issue.</span></span> <span data-ttu-id="4dd62-254">Jeśli chcesz wykonać często ślady stosu, profilera powinno zamiast tego utworzyć stosu tle przy użyciu [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md), [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md), [FunctionTailcall2](../../../../docs/framework/unmanaged-api/profiling/functiontailcall2-function.md), i [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) wyjątek wywołań zwrotnych.</span><span class="sxs-lookup"><span data-stu-id="4dd62-254">If you want to take stack traces frequently, your profiler should instead build a shadow stack by using the [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md), [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md), [FunctionTailcall2](../../../../docs/framework/unmanaged-api/profiling/functiontailcall2-function.md), and [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) exception callbacks.</span></span> <span data-ttu-id="4dd62-255">Stos tle zawsze jest aktualny i szybko można skopiować do magazynu w każdym przypadku, gdy wymagane jest migawki stosu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-255">The shadow stack is always current and can quickly be copied to storage whenever a stack snapshot is needed.</span></span>  
  
 <span data-ttu-id="4dd62-256">Stos tle może uzyskać argumenty funkcji zwracanych wartości i informacji na temat ogólnych utworzonych wystąpieniach.</span><span class="sxs-lookup"><span data-stu-id="4dd62-256">A shadow stack may obtain function arguments, return values, and information about generic instantiations.</span></span> <span data-ttu-id="4dd62-257">Te informacje są dostępne tylko za pośrednictwem stosu w tle i mogą być uzyskane, gdy formant jest przekazywany do funkcji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-257">This information is available only through the shadow stack and may be obtained when control is handed to a function.</span></span> <span data-ttu-id="4dd62-258">Jednak te informacje mogą nie można później, podczas wykonywania funkcji.</span><span class="sxs-lookup"><span data-stu-id="4dd62-258">However, this information may not be available later during the run of the function.</span></span>  
  
 [<span data-ttu-id="4dd62-259">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-259">Back to top</span></span>](#top)  
  
<a name="callbacks"></a>   
## <a name="callbacks-and-stack-depth"></a><span data-ttu-id="4dd62-260">Wywołania zwrotne i głębokość stosu</span><span class="sxs-lookup"><span data-stu-id="4dd62-260">Callbacks and Stack Depth</span></span>  
 <span data-ttu-id="4dd62-261">Wywołania zwrotne Profiler może być wystawiony w sytuacji bardzo ograniczone stosu i przepełnienie stosu w wywołaniu zwrotnym profilera doprowadzi do zakończenia procesu bezpośrednim.</span><span class="sxs-lookup"><span data-stu-id="4dd62-261">Profiler callbacks may be issued in very stack-constrained circumstances, and a stack overflow in a profiler callback will lead to an immediate process exit.</span></span> <span data-ttu-id="4dd62-262">Profiler powinien upewnij się, że używany jako mały stos możliwie w odpowiedzi na wywołania zwrotne.</span><span class="sxs-lookup"><span data-stu-id="4dd62-262">A profiler should make sure to use as little stack as possible in response to callbacks.</span></span> <span data-ttu-id="4dd62-263">Jeśli profiler jest przeznaczony do użycia dla procesów, które są odporna przepełnienie stosu, profilera się również unikać wyzwalania przepełnienia stosu.</span><span class="sxs-lookup"><span data-stu-id="4dd62-263">If the profiler is intended for use against processes that are robust against stack overflow, the profiler itself should also avoid triggering stack overflow.</span></span>  
  
 [<span data-ttu-id="4dd62-264">Powrót do początku</span><span class="sxs-lookup"><span data-stu-id="4dd62-264">Back to top</span></span>](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a><span data-ttu-id="4dd62-265">Tematy pokrewne</span><span class="sxs-lookup"><span data-stu-id="4dd62-265">Related Topics</span></span>  
  
|<span data-ttu-id="4dd62-266">Tytuł</span><span class="sxs-lookup"><span data-stu-id="4dd62-266">Title</span></span>|<span data-ttu-id="4dd62-267">Opis</span><span class="sxs-lookup"><span data-stu-id="4dd62-267">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="4dd62-268">Konfigurowanie środowiska profilowania</span><span class="sxs-lookup"><span data-stu-id="4dd62-268">Setting Up a Profiling Environment</span></span>](../../../../docs/framework/unmanaged-api/profiling/setting-up-a-profiling-environment.md)|<span data-ttu-id="4dd62-269">Wyjaśniono, jak zainicjować profilera, ustawienie powiadomień o zdarzeniach i profilu usługi systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="4dd62-269">Explains how to initialize a profiler, set event notifications, and profile a Windows Service.</span></span>|  
|[<span data-ttu-id="4dd62-270">Interfejsy profilowania</span><span class="sxs-lookup"><span data-stu-id="4dd62-270">Profiling Interfaces</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)|<span data-ttu-id="4dd62-271">W tym artykule opisano niezarządzane interfejsy, które używa interfejsu API profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-271">Describes the unmanaged interfaces that the profiling API uses.</span></span>|  
|[<span data-ttu-id="4dd62-272">Profilowanie statycznych funkcji globalnych</span><span class="sxs-lookup"><span data-stu-id="4dd62-272">Profiling Global Static Functions</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-global-static-functions.md)|<span data-ttu-id="4dd62-273">Opisuje niezarządzane statyczne funkcje globalne, które używa interfejsu API profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-273">Describes the unmanaged global static functions that the profiling API uses.</span></span>|  
|[<span data-ttu-id="4dd62-274">Profilowanie — wyliczenia</span><span class="sxs-lookup"><span data-stu-id="4dd62-274">Profiling Enumerations</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-enumerations.md)|<span data-ttu-id="4dd62-275">W tym artykule opisano niezarządzane wyliczenia, które używa interfejsu API profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-275">Describes the unmanaged enumerations that the profiling API uses.</span></span>|  
|[<span data-ttu-id="4dd62-276">Profiling — struktury</span><span class="sxs-lookup"><span data-stu-id="4dd62-276">Profiling Structures</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-structures.md)|<span data-ttu-id="4dd62-277">W tym artykule opisano niezarządzane struktury, których używa interfejsu API profilowania.</span><span class="sxs-lookup"><span data-stu-id="4dd62-277">Describes the unmanaged structures that the profiling API uses.</span></span>|
