---
title: 'CA2008: nie twórz zadań bez przechodzenia do TaskScheduler (analiza kodu)'
description: 'Dowiedz się więcej o regule analizy kodu CA2008: nie twórz zadań bez przekazywania TaskScheduler'
ms.date: 08/26/2020
ms.topic: reference
f1_keywords:
- CA2008
- DoNotCreateTasksWithoutPassingATaskSchedulerAnalyzer
helpviewer_keywords:
- CA2008
author: gewarren
ms.author: gewarren
ms.openlocfilehash: 01bf46cfe0976107e86a3865639048163660c254
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/24/2020
ms.locfileid: "96590028"
---
# <a name="ca2008-do-not-create-tasks-without-passing-a-taskscheduler"></a><span data-ttu-id="6cdd0-103">CA2008: Nie twórz zadań bez przekazania klasy TaskScheduler</span><span class="sxs-lookup"><span data-stu-id="6cdd0-103">CA2008: Do not create tasks without passing a TaskScheduler</span></span>

| | <span data-ttu-id="6cdd0-104">Wartość</span><span class="sxs-lookup"><span data-stu-id="6cdd0-104">Value</span></span> |
|-|-|
| <span data-ttu-id="6cdd0-105">**Identyfikator zasady**</span><span class="sxs-lookup"><span data-stu-id="6cdd0-105">**Rule ID**</span></span> |<span data-ttu-id="6cdd0-106">CA2008</span><span class="sxs-lookup"><span data-stu-id="6cdd0-106">CA2008</span></span>|
| <span data-ttu-id="6cdd0-107">**Kategoria**</span><span class="sxs-lookup"><span data-stu-id="6cdd0-107">**Category**</span></span> |<span data-ttu-id="6cdd0-108">Microsoft. niezawodność</span><span class="sxs-lookup"><span data-stu-id="6cdd0-108">Microsoft.Reliability</span></span>|
| <span data-ttu-id="6cdd0-109">**Naprawa jest przerywana lub nieprzerwana**</span><span class="sxs-lookup"><span data-stu-id="6cdd0-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="6cdd0-110">Nieprzerwanie</span><span class="sxs-lookup"><span data-stu-id="6cdd0-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="6cdd0-111">Przyczyna</span><span class="sxs-lookup"><span data-stu-id="6cdd0-111">Cause</span></span>

<span data-ttu-id="6cdd0-112">Operacja tworzenia lub kontynuacji zadania używa przeciążenia metody, które nie określa <xref:System.Threading.Tasks.TaskScheduler> parametru.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-112">A task creation or continuation operation uses a method overload that does not specify a <xref:System.Threading.Tasks.TaskScheduler> parameter.</span></span>

## <a name="rule-description"></a><span data-ttu-id="6cdd0-113">Opis reguły</span><span class="sxs-lookup"><span data-stu-id="6cdd0-113">Rule description</span></span>

<span data-ttu-id="6cdd0-114">Następujące metody tworzenia i kontynuacji zadań platformy .NET mają przeciążenia zezwalające na określanie lub pomijanie <xref:System.Threading.Tasks.TaskScheduler> wystąpienia:</span><span class="sxs-lookup"><span data-stu-id="6cdd0-114">The following .NET task creation and continuation methods have overloads that allow specifying or omitting a <xref:System.Threading.Tasks.TaskScheduler> instance:</span></span>

- <span data-ttu-id="6cdd0-115"><xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=fullName> form</span><span class="sxs-lookup"><span data-stu-id="6cdd0-115"><xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=fullName> methods</span></span>
- <span data-ttu-id="6cdd0-116"><xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=fullName> form</span><span class="sxs-lookup"><span data-stu-id="6cdd0-116"><xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=fullName> methods</span></span>

<span data-ttu-id="6cdd0-117">Zawsze należy określić jawny <xref:System.Threading.Tasks.TaskScheduler> argument, aby uniknąć <xref:System.Threading.Tasks.TaskScheduler.Current%2A> wartości domyślnej, którego zachowanie jest zdefiniowane przez obiekt wywołujący i może się różnić w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-117">Always specify an explicit <xref:System.Threading.Tasks.TaskScheduler> argument to avoid the default <xref:System.Threading.Tasks.TaskScheduler.Current%2A> value, whose behavior is defined by the caller and may vary at runtime.</span></span> <span data-ttu-id="6cdd0-118"><xref:System.Threading.Tasks.TaskScheduler.Current%2A> zwraca harmonogram skojarzony z elementem <xref:System.Threading.Tasks.Task> , który jest aktualnie uruchomiony w tym wątku.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-118"><xref:System.Threading.Tasks.TaskScheduler.Current%2A> returns the scheduler associated with whatever <xref:System.Threading.Tasks.Task> is currently running on that thread.</span></span> <span data-ttu-id="6cdd0-119">Jeśli nie ma takiego zadania, zwraca <xref:System.Threading.Tasks.TaskScheduler.Default%2A> , który reprezentuje pulę wątków.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-119">If there is no such task, it returns <xref:System.Threading.Tasks.TaskScheduler.Default%2A>, which represents the thread pool.</span></span> <span data-ttu-id="6cdd0-120">Użycie <xref:System.Threading.Tasks.TaskScheduler.Current%2A> może prowadzić do zakleszczenia lub rozwiązywania problemów z interfejsem użytkownika w niektórych sytuacjach, gdy było przeznaczone do utworzenia zadania w puli wątków, ale zamiast tego czeka na powrót do wątku interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-120">Using <xref:System.Threading.Tasks.TaskScheduler.Current%2A> could lead to deadlocks or UI responsiveness issues in some situations, when it was intended to create the task on the thread pool, but instead it waits to get back onto the UI thread.</span></span>

<span data-ttu-id="6cdd0-121">Aby uzyskać więcej informacji i szczegółowe przykłady, zobacz [Nowość opcji TaskCreationOptions i TaskContinuationOptions w .NET Framework 4,5](https://devblogs.microsoft.com/pfxteam/new-taskcreationoptions-and-taskcontinuationoptions-in-net-4-5/).</span><span class="sxs-lookup"><span data-stu-id="6cdd0-121">For further information and detailed examples, see [New TaskCreationOptions and TaskContinuationOptions in .NET Framework 4.5](https://devblogs.microsoft.com/pfxteam/new-taskcreationoptions-and-taskcontinuationoptions-in-net-4-5/).</span></span>

> [!NOTE]
> <span data-ttu-id="6cdd0-122">[VSTHRD105-Unikaj przeciążeń metody, które zakładają TaskScheduler. Current](https://github.com/microsoft/vs-threading/blob/master/doc/analyzers/VSTHRD105.md) to podobna reguła zaimplementowana w pakiecie [Microsoft. VisualStudio. Threading. analizatory](https://www.nuget.org/packages/Microsoft.VisualStudio.Threading.Analyzers) .</span><span class="sxs-lookup"><span data-stu-id="6cdd0-122">[VSTHRD105 - Avoid method overloads that assume TaskScheduler.Current](https://github.com/microsoft/vs-threading/blob/master/doc/analyzers/VSTHRD105.md) is a similar rule implemented in [Microsoft.VisualStudio.Threading.Analyzers](https://www.nuget.org/packages/Microsoft.VisualStudio.Threading.Analyzers) package.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="6cdd0-123">Jak naprawić naruszenia</span><span class="sxs-lookup"><span data-stu-id="6cdd0-123">How to fix violations</span></span>

<span data-ttu-id="6cdd0-124">Aby naprawić naruszenia, wywołaj Przeciążenie metody, które przyjmuje <xref:System.Threading.Tasks.TaskScheduler> i jawnie przekaże <xref:System.Threading.Tasks.TaskScheduler.Default%2A> lub <xref:System.Threading.Tasks.TaskScheduler.Current%2A> Aby określić zamiar.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-124">To fix violations, call the method overload that takes a <xref:System.Threading.Tasks.TaskScheduler> and explicitly pass in <xref:System.Threading.Tasks.TaskScheduler.Default%2A> or <xref:System.Threading.Tasks.TaskScheduler.Current%2A> to make the intent clear.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="6cdd0-125">Kiedy pominąć ostrzeżenia</span><span class="sxs-lookup"><span data-stu-id="6cdd0-125">When to suppress warnings</span></span>

<span data-ttu-id="6cdd0-126">To ostrzeżenie jest przeznaczone głównie dla bibliotek, w których kod może być wykonywany w dowolnych środowiskach i gdzie kod nie powinien zawierać założeń dotyczących środowiska lub jak obiekt wywołujący metody może być wywoływany lub oczekujący na to.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-126">This warning is intended primarily for libraries, where the code may be executed in arbitrary environments and where code shouldn't make assumptions about the environment or how the caller of the method may be invoking or waiting on it.</span></span> <span data-ttu-id="6cdd0-127">Może być odpowiednie, aby pominąć ostrzeżenie dla projektów reprezentujących kod aplikacji zamiast kodu biblioteki.</span><span class="sxs-lookup"><span data-stu-id="6cdd0-127">It may be appropriate to suppress the warning for projects that represent application code rather than library code.</span></span>

## <a name="see-also"></a><span data-ttu-id="6cdd0-128">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="6cdd0-128">See also</span></span>

- [<span data-ttu-id="6cdd0-129">Nowe opcji TaskCreationOptions i TaskContinuationOptions w .NET Framework 4,5</span><span class="sxs-lookup"><span data-stu-id="6cdd0-129">New TaskCreationOptions and TaskContinuationOptions in .NET Framework 4.5</span></span>](https://devblogs.microsoft.com/pfxteam/new-taskcreationoptions-and-taskcontinuationoptions-in-net-4-5/)
- [<span data-ttu-id="6cdd0-130">VSTHRD105 — Unikaj przeciążeń metod, które zakładają TaskScheduler. Current</span><span class="sxs-lookup"><span data-stu-id="6cdd0-130">VSTHRD105 - Avoid method overloads that assume TaskScheduler.Current</span></span>](https://github.com/microsoft/vs-threading/blob/master/doc/analyzers/VSTHRD105.md)
- [<span data-ttu-id="6cdd0-131">CA2007: Nie oczekuj bezpośrednio zadania</span><span class="sxs-lookup"><span data-stu-id="6cdd0-131">CA2007: Do not directly await a Task</span></span>](ca2007.md)
- [<span data-ttu-id="6cdd0-132">Reguły dotyczące niezawodności</span><span class="sxs-lookup"><span data-stu-id="6cdd0-132">Reliability rules</span></span>](reliability-warnings.md)
