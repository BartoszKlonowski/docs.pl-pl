---
title: Algorytm ładowania zestawu zarządzanego — .NET Core
description: Opis szczegółów algorytmu ładowania zestawu zarządzanego w programie .NET Core
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: f368e2c20039f8679186a8d806850c9c92be8d3a
ms.sourcegitcommit: 121ab70c1ebedba41d276e436dd2b1502748a49f
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/24/2019
ms.locfileid: "70017336"
---
# <a name="managed-assembly-loading-algorithm"></a><span data-ttu-id="0dd5c-103">Algorytm ładowania zestawu zarządzanego</span><span class="sxs-lookup"><span data-stu-id="0dd5c-103">Managed assembly loading algorithm</span></span>

<span data-ttu-id="0dd5c-104">Zarządzane zestawy są zlokalizowane i ładowane z algorytmem obejmującym różne etapy.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-104">Managed assemblies are located and loaded with an algorithm involving various stages.</span></span>

<span data-ttu-id="0dd5c-105">Wszystkie zarządzane zestawy oprócz zestawów satelickich `WinRT` i zestawów używają tego samego algorytmu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-105">All managed assemblies except satellite assemblies and `WinRT` assemblies use the same algorithm.</span></span>

## <a name="when-are-managed-assemblies-loaded"></a><span data-ttu-id="0dd5c-106">Kiedy są ładowane zestawy zarządzane?</span><span class="sxs-lookup"><span data-stu-id="0dd5c-106">When are managed assemblies loaded?</span></span>

<span data-ttu-id="0dd5c-107">Najbardziej typowym mechanizmem wyzwalania obciążenia zestawu zarządzanego jest statyczne odwołanie do zestawu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-107">The most common mechanism to trigger a managed assembly load is a static assembly reference.</span></span> <span data-ttu-id="0dd5c-108">Te odwołania są wstawiane przez kompilator, za każdym razem, gdy kod używa typu zdefiniowanego w innym zestawie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-108">These references are inserted by the compiler whenever code uses a type defined in another assembly.</span></span> <span data-ttu-id="0dd5c-109">Te zestawy są ładowane (`load-by-name`), zgodnie z wymaganiami środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-109">These assemblies are loaded (`load-by-name`) as needed by the runtime.</span></span>

<span data-ttu-id="0dd5c-110">Bezpośrednie użycie konkretnych interfejsów API spowoduje również wyzwolenie ładowania:</span><span class="sxs-lookup"><span data-stu-id="0dd5c-110">The direct use of specific APIs will also trigger loads:</span></span>

|<span data-ttu-id="0dd5c-111">interfejs API</span><span class="sxs-lookup"><span data-stu-id="0dd5c-111">API</span></span>  |<span data-ttu-id="0dd5c-112">Opis</span><span class="sxs-lookup"><span data-stu-id="0dd5c-112">Description</span></span>  |<span data-ttu-id="0dd5c-113">`Active`<xref:System.Runtime.Loader.AssemblyLoadContext></span><span class="sxs-lookup"><span data-stu-id="0dd5c-113">`Active` <xref:System.Runtime.Loader.AssemblyLoadContext></span></span> |
|---------|---------|---------|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyName%2A?displayProperty=nameWithType>|`Load-by-name`|<span data-ttu-id="0dd5c-114">[To](../../csharp/language-reference/keywords/this.md) wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-114">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyPath%2A?displayProperty=nameWithType><p><xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromNativeImagePath%2A?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-115">Załaduj ze ścieżki.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-115">Load from path.</span></span>|<span data-ttu-id="0dd5c-116">[To](../../csharp/language-reference/keywords/this.md) wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-116">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromStream%2A?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-117">Załaduj z obiektu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-117">Load from object.</span></span>|<span data-ttu-id="0dd5c-118">[To](../../csharp/language-reference/keywords/this.md) wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-118">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-119">Załaduj ze ścieżki w nowym <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpieniu</span><span class="sxs-lookup"><span data-stu-id="0dd5c-119">Load from path in a new <xref:System.Runtime.Loader.AssemblyLoadContext> instance</span></span>|<span data-ttu-id="0dd5c-120">Nowe <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-120">The new <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>|
<xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-121">Załaduj ze ścieżki w <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-121">Load from path in the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span><p><span data-ttu-id="0dd5c-122">Dodaje procedurę obsługi do <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>. <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving></span><span class="sxs-lookup"><span data-stu-id="0dd5c-122">Adds a <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving> handler to <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0dd5c-123">Program obsługi załaduje zależności zestawu z jego katalogu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-123">The handler will load the assembly's dependencies from its directory.</span></span>|<span data-ttu-id="0dd5c-124"><xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> Wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-124">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Reflection.AssemblyName)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.String)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-125">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-125">`Load-by-name`.</span></span>|<span data-ttu-id="0dd5c-126">Wywnioskowane z elementu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-126">Inferred from caller.</span></span><p><span data-ttu-id="0dd5c-127">Preferuj <xref:System.Runtime.Loader.AssemblyLoadContext> metody.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-127">Prefer <xref:System.Runtime.Loader.AssemblyLoadContext> methods.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Byte[])?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.Byte[],System.Byte[])?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-128">Załaduj z obiektu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-128">Load from object.</span></span>|<span data-ttu-id="0dd5c-129">Wywnioskowane z elementu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-129">Inferred from caller.</span></span><p><span data-ttu-id="0dd5c-130">Preferuj <xref:System.Runtime.Loader.AssemblyLoadContext> metody.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-130">Prefer <xref:System.Runtime.Loader.AssemblyLoadContext> methods.</span></span>|
<xref:System.Type.GetType(System.String)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean,System.Boolean)?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-131">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-131">`Load-by-name`.</span></span>|<span data-ttu-id="0dd5c-132">Wywnioskowane z elementu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-132">Inferred from caller.</span></span><p><span data-ttu-id="0dd5c-133">Preferuj <xref:System.Type.GetType%2A?displayProperty=nameWithType> metody`assemblyResolver` z argumentem.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-133">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> methods with an `assemblyResolver` argument.</span></span>|
<xref:System.Reflection.Assembly.GetType%2A?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-134">Jeśli typ `name` zawiera opis typu ogólnego kwalifikowana zestawu, wyzwól a `Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-134">If type `name` describes an assembly qualified generic type, trigger a `Load-by-name`.</span></span>|<span data-ttu-id="0dd5c-135">Wywnioskowane z elementu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-135">Inferred from caller.</span></span><p><span data-ttu-id="0dd5c-136">Preferuj <xref:System.Type.GetType%2A?displayProperty=nameWithType> w przypadku używania nazw typu kwalifikowanego zestawu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-136">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> when using assembly qualified type names.</span></span>|
<xref:System.Activator.CreateInstance(System.String,System.String)?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Object[])?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Boolean,System.Reflection.BindingFlags,System.Reflection.Binder,System.Object[],System.Globalization.CultureInfo,System.Object[])?displayProperty=nameWithType>|<span data-ttu-id="0dd5c-137">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-137">`Load-by-name`.</span></span>|<span data-ttu-id="0dd5c-138">Wywnioskowane z elementu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-138">Inferred from caller.</span></span><p><span data-ttu-id="0dd5c-139">Preferuj <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType> metody<xref:System.Type> przyjmujące argument.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-139">Prefer <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType> methods taking a <xref:System.Type> argument.</span></span>|

## <a name="algorithm"></a><span data-ttu-id="0dd5c-140">Algorytm</span><span class="sxs-lookup"><span data-stu-id="0dd5c-140">Algorithm</span></span>

<span data-ttu-id="0dd5c-141">Poniższy algorytm opisuje sposób ładowania zarządzanego zestawu przez środowisko uruchomieniowe.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-141">The following algorithm describes how the runtime loads a managed assembly.</span></span>

1. <span data-ttu-id="0dd5c-142">`active` Określ .<xref:System.Runtime.Loader.AssemblyLoadContext></span><span class="sxs-lookup"><span data-stu-id="0dd5c-142">Determine the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>

    - <span data-ttu-id="0dd5c-143">W przypadku statycznego odwołania do zestawu `active` , <xref:System.Runtime.Loader.AssemblyLoadContext> jest to wystąpienie, które załadowało odwołujący się zestaw.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-143">For a static assembly reference, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> is the instance that loaded the referring assembly.</span></span>
    - <span data-ttu-id="0dd5c-144">Preferowane interfejsy API `active` czynią <xref:System.Runtime.Loader.AssemblyLoadContext> jawnie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-144">Preferred APIs make the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> explicit.</span></span>
    - <span data-ttu-id="0dd5c-145">Inne interfejsy API `active` <xref:System.Runtime.Loader.AssemblyLoadContext>wnioskują.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-145">Other APIs infer the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span> <span data-ttu-id="0dd5c-146">Dla tych interfejsów API <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType> właściwość jest używana.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-146">For these APIs, the <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType> property is used.</span></span> <span data-ttu-id="0dd5c-147">Jeśli wartość to `null`, zostanie użyte <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie wywnioskowane.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-147">If its value is `null`, then the inferred <xref:System.Runtime.Loader.AssemblyLoadContext> instance is used.</span></span>
    - <span data-ttu-id="0dd5c-148">Zobacz powyższą tabelę.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-148">See table above.</span></span>

2. <span data-ttu-id="0dd5c-149">Dla metod, aktywny <xref:System.Runtime.Loader.AssemblyLoadContext> ładuje zestaw. `Load-by-name`</span><span class="sxs-lookup"><span data-stu-id="0dd5c-149">For the `Load-by-name` methods, the active <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="0dd5c-150">W kolejności priorytetu według:</span><span class="sxs-lookup"><span data-stu-id="0dd5c-150">In priority order by:</span></span>
    * <span data-ttu-id="0dd5c-151">`cache-by-name`Sprawdzanie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-151">Checking its `cache-by-name`.</span></span>

    * <span data-ttu-id="0dd5c-152">Wywoływanie <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType> funkcji.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-152">Calling the <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType> function.</span></span>

    * <span data-ttu-id="0dd5c-153">Sprawdzanie pamięci podręcznej [](default-probing.md#managed-assembly-default-probing) wystąpieńiuruchamianiedomyślnejlogikisondowaniazestawu<xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> zarządzanego.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-153">Checking the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instances' cache and running [managed assembly default probing](default-probing.md#managed-assembly-default-probing) logic.</span></span>

    * <span data-ttu-id="0dd5c-154">Podnoszenie <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> poziomu zdarzenia dla aktywnego AssemblyLoadContext.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-154">Raising the <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> event for the active AssemblyLoadContext.</span></span>

    * <span data-ttu-id="0dd5c-155">Podnoszenie <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> poziomu zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-155">Raising the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>

3. <span data-ttu-id="0dd5c-156">W przypadku innych typów obciążeń `active` <xref:System.Runtime.Loader.AssemblyLoadContext> ładuje zestaw.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-156">For the other types of loads, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="0dd5c-157">W kolejności priorytetu według:</span><span class="sxs-lookup"><span data-stu-id="0dd5c-157">In priority order by:</span></span>
    * <span data-ttu-id="0dd5c-158">`cache-by-name`Sprawdzanie.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-158">Checking its `cache-by-name`.</span></span>

    * <span data-ttu-id="0dd5c-159">Ładowanie z określonej ścieżki lub pierwotnego obiektu zestawu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-159">Loading from the specified path or raw assembly object.</span></span>

4. <span data-ttu-id="0dd5c-160">W obu przypadkach, jeśli zestaw jest nowo załadowany, wówczas:</span><span class="sxs-lookup"><span data-stu-id="0dd5c-160">In either case, if an assembly is newly loaded, then:</span></span>
   - <span data-ttu-id="0dd5c-161"><xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType> Zdarzenie jest zgłaszane.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-161">The <xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType> event is raised.</span></span>
   - <span data-ttu-id="0dd5c-162">Odwołanie jest dodawane do <xref:System.Runtime.Loader.AssemblyLoadContext> `cache-by-name`wystąpienia zestawu.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-162">A reference is added to the assembly's <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>

5. <span data-ttu-id="0dd5c-163">Jeśli zestaw zostanie znaleziony, odwołanie zostanie dodane zgodnie z wymaganiami do `active` <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienia `cache-by-name`.</span><span class="sxs-lookup"><span data-stu-id="0dd5c-163">If the assembly is found, a reference is added as needed to the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>
