---
title: Opis AssemblyLoadContext — .NET Core
description: Kluczowe pojęcia, aby zrozumieć cel i zachowanie AssemblyLoadContext w .NET Core.
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 8a73a432bf8cc72cced77cf6c62a785b72032913
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/14/2020
ms.locfileid: "72291260"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="9f812-103">Opis System.Runtime.Loader.AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="9f812-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="9f812-104">Klasa <xref:System.Runtime.Loader.AssemblyLoadContext> jest unikatowa dla .NET Core.</span><span class="sxs-lookup"><span data-stu-id="9f812-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="9f812-105">W tym artykule <xref:System.Runtime.Loader.AssemblyLoadContext> próbuje uzupełnić dokumentację interfejsu API o informacje o pojęciach.</span><span class="sxs-lookup"><span data-stu-id="9f812-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="9f812-106">Ten artykuł jest odpowiedni dla deweloperów implementujących dynamiczne ładowanie, szczególnie deweloperzy dynamicznej struktury ładowania.</span><span class="sxs-lookup"><span data-stu-id="9f812-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="9f812-107">Co to jest AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="9f812-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="9f812-108">Każda aplikacja .NET Core <xref:System.Runtime.Loader.AssemblyLoadContext>niejawnie używa pliku .</span><span class="sxs-lookup"><span data-stu-id="9f812-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="9f812-109">Jest dostawcą czasu wykonywania do lokalizowania i ładowania zależności.</span><span class="sxs-lookup"><span data-stu-id="9f812-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="9f812-110">Za każdym razem, gdy <xref:System.Runtime.Loader.AssemblyLoadContext> zależność jest ładowany, wystąpienie jest wywoływana, aby go zlokalizować.</span><span class="sxs-lookup"><span data-stu-id="9f812-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="9f812-111">Zapewnia usługę lokalizowania, ładowania i buforowania zarządzanych zestawów i innych zależności.</span><span class="sxs-lookup"><span data-stu-id="9f812-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="9f812-112">Aby obsługiwać dynamiczne ładowanie kodu i zwalniania, tworzy izolowany kontekst do <xref:System.Runtime.Loader.AssemblyLoadContext> ładowania kodu i jego zależności w ich własnym wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="9f812-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="9f812-113">Kiedy potrzebujesz wielu wystąpień AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="9f812-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="9f812-114">Pojedyncze <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie jest ograniczone do ładowania <xref:System.Reflection.Assembly> dokładnie jednej wersji <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>na prostą nazwę zestawu.</span><span class="sxs-lookup"><span data-stu-id="9f812-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="9f812-115">To ograniczenie może stać się problemem podczas dynamicznego ładowania modułów kodu.</span><span class="sxs-lookup"><span data-stu-id="9f812-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="9f812-116">Każdy moduł jest niezależnie skompilowany i może <xref:System.Reflection.Assembly>zależeć od różnych wersji pliku .</span><span class="sxs-lookup"><span data-stu-id="9f812-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="9f812-117">Ten problem często występuje, gdy różne moduły zależą od różnych wersji powszechnie używanej biblioteki.</span><span class="sxs-lookup"><span data-stu-id="9f812-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="9f812-118">Aby obsługiwać dynamicznie ładowania <xref:System.Runtime.Loader.AssemblyLoadContext> kodu, interfejs API przewiduje <xref:System.Reflection.Assembly> ładowanie wersji powodujące konflikt w tej samej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9f812-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="9f812-119">Każde <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie zawiera unikatowy słownik mapowanie każdego <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> do określonego <xref:System.Reflection.Assembly> wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="9f812-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="9f812-120">Zapewnia również wygodny mechanizm grupowania zależności związanych z modułem kodu do późniejszego rozładowania.</span><span class="sxs-lookup"><span data-stu-id="9f812-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="9f812-121">Co jest specjalnego w AssemblyLoadContext.Default wystąpienie?</span><span class="sxs-lookup"><span data-stu-id="9f812-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="9f812-122">Wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> jest automatycznie wypełniane przez czas wykonywania podczas uruchamiania.</span><span class="sxs-lookup"><span data-stu-id="9f812-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="9f812-123">Używa [domyślnego sondowania,](default-probing.md) aby zlokalizować i znaleźć wszystkie zależności statyczne.</span><span class="sxs-lookup"><span data-stu-id="9f812-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="9f812-124">Rozwiązuje najbardziej typowe scenariusze ładowania zależności.</span><span class="sxs-lookup"><span data-stu-id="9f812-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="9f812-125">Jak AssemblyLoadContext obsługuje zależności dynamiczne?</span><span class="sxs-lookup"><span data-stu-id="9f812-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="9f812-126"><xref:System.Runtime.Loader.AssemblyLoadContext>ma różne zdarzenia i funkcje wirtualne, które mogą być zastąpione.</span><span class="sxs-lookup"><span data-stu-id="9f812-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="9f812-127">Wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> obsługuje tylko zastępowanie zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="9f812-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="9f812-128">Artykuły [Algorytm ładowania zestawu zarządzanego,](loading-managed.md) [algorytm ładowania zestawu satelitarnego](loading-resources.md)i [algorytm ładowania biblioteki niezarządzanej (natywnej)](loading-unmanaged.md) odnoszą się do wszystkich dostępnych zdarzeń i funkcji wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="9f812-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="9f812-129">Artykuły pokazują każde zdarzenie i względną pozycję funkcji w algorytmach ładowania.</span><span class="sxs-lookup"><span data-stu-id="9f812-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="9f812-130">Ten artykuł nie odtwarza tych informacji.</span><span class="sxs-lookup"><span data-stu-id="9f812-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="9f812-131">Niniejsza sekcja obejmuje ogólne zasady dotyczące istotnych zdarzeń i funkcji.</span><span class="sxs-lookup"><span data-stu-id="9f812-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="9f812-132">**Być powtarzalnym**.</span><span class="sxs-lookup"><span data-stu-id="9f812-132">**Be repeatable**.</span></span> <span data-ttu-id="9f812-133">Kwerenda dla określonej zależności zawsze musi spowodować taką samą odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="9f812-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="9f812-134">Należy zwrócić to samo załadowane wystąpienie zależności.</span><span class="sxs-lookup"><span data-stu-id="9f812-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="9f812-135">To wymaganie ma podstawowe znaczenie dla spójności pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="9f812-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="9f812-136">W szczególności w przypadku zestawów zarządzanych <xref:System.Reflection.Assembly> tworzymy pamięć podręczną.</span><span class="sxs-lookup"><span data-stu-id="9f812-136">For managed assemblies in particular, we're creating a <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="9f812-137">Klucz pamięci podręcznej jest <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>prostą nazwą zestawu.</span><span class="sxs-lookup"><span data-stu-id="9f812-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="9f812-138">**Zazwyczaj nie rzucać**.</span><span class="sxs-lookup"><span data-stu-id="9f812-138">**Typically don't throw**.</span></span>  <span data-ttu-id="9f812-139">Oczekuje się, że te `null` funkcje powrócić, a nie throw, gdy nie można znaleźć żądaną zależność.</span><span class="sxs-lookup"><span data-stu-id="9f812-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="9f812-140">Zgłaszanie przedwcześnie zakończy wyszukiwanie i będzie propagować wyjątek do obiektu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="9f812-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="9f812-141">Zgłaszanie powinno być ograniczone do nieoczekiwanych błędów, takich jak uszkodzony zestaw lub warunek braku pamięci.</span><span class="sxs-lookup"><span data-stu-id="9f812-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="9f812-142">**Unikać rekursji**.</span><span class="sxs-lookup"><span data-stu-id="9f812-142">**Avoid recursion**.</span></span> <span data-ttu-id="9f812-143">Należy pamiętać, że te funkcje i programy obsługi implementują reguły ładowania do lokalizowania zależności.</span><span class="sxs-lookup"><span data-stu-id="9f812-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="9f812-144">Implementacja nie powinna wywoływać interfejsów API, które wyzwalają rekursję.</span><span class="sxs-lookup"><span data-stu-id="9f812-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="9f812-145">Kod powinien zazwyczaj wywołać **AssemblyLoadContext** funkcji ładowania, które wymagają określonej ścieżki lub argument odwołania do pamięci.</span><span class="sxs-lookup"><span data-stu-id="9f812-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="9f812-146">**Załaduj do prawidłowego AssemblyLoadContext**.</span><span class="sxs-lookup"><span data-stu-id="9f812-146">**Load into the correct AssemblyLoadContext**.</span></span> <span data-ttu-id="9f812-147">Wybór, gdzie załadować zależności jest specyficzne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9f812-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="9f812-148">Wybór jest realizowany przez te zdarzenia i funkcje.</span><span class="sxs-lookup"><span data-stu-id="9f812-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="9f812-149">Gdy kod wywołuje **AssemblyLoadContext** funkcji obciążenia po ścieżce wywołać je w wystąpieniu, w którym chcesz załadowany kod.</span><span class="sxs-lookup"><span data-stu-id="9f812-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="9f812-150">Kiedyś powrót `null` i pozwalając <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> uchwyt obciążenia może być najprostszą opcją.</span><span class="sxs-lookup"><span data-stu-id="9f812-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="9f812-151">**Należy pamiętać o wyścigach wątków**.</span><span class="sxs-lookup"><span data-stu-id="9f812-151">**Be aware of thread races**.</span></span> <span data-ttu-id="9f812-152">Ładowanie może być wyzwalane przez wiele wątków.</span><span class="sxs-lookup"><span data-stu-id="9f812-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="9f812-153">AssemblyLoadContext obsługuje wyścigi wątków przez atomowe dodawanie zestawów do pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="9f812-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="9f812-154">Instancja przegranego wyścigu zostaje odrzucona.</span><span class="sxs-lookup"><span data-stu-id="9f812-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="9f812-155">W logice implementacji nie należy dodawać dodatkowe logiki, która nie obsługuje poprawnie wiele wątków.</span><span class="sxs-lookup"><span data-stu-id="9f812-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="9f812-156">Jak są izolowane zależności dynamiczne?</span><span class="sxs-lookup"><span data-stu-id="9f812-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="9f812-157">Każde <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie reprezentuje unikatowy zakres dla <xref:System.Reflection.Assembly> wystąpień i <xref:System.Type> definicji.</span><span class="sxs-lookup"><span data-stu-id="9f812-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="9f812-158">Nie ma binarnej izolacji między tymi zależnościami.</span><span class="sxs-lookup"><span data-stu-id="9f812-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="9f812-159">Są one izolowane tylko przez nie znalezienie siebie po imieniu.</span><span class="sxs-lookup"><span data-stu-id="9f812-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="9f812-160">W <xref:System.Runtime.Loader.AssemblyLoadContext>każdym z nich:</span><span class="sxs-lookup"><span data-stu-id="9f812-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="9f812-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>może odnosić <xref:System.Reflection.Assembly> się do innego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="9f812-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="9f812-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType>może zwrócić wystąpienie innego typu `name`dla tego samego typu .</span><span class="sxs-lookup"><span data-stu-id="9f812-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="9f812-163">W jaki sposób współużytkowane są zależności?</span><span class="sxs-lookup"><span data-stu-id="9f812-163">How are dependencies shared?</span></span>

<span data-ttu-id="9f812-164">Zależności można łatwo współużytkować między <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpieniami.</span><span class="sxs-lookup"><span data-stu-id="9f812-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="9f812-165">Model ogólny jest <xref:System.Runtime.Loader.AssemblyLoadContext> dla jednego, aby załadować zależność.</span><span class="sxs-lookup"><span data-stu-id="9f812-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="9f812-166">Inne współudziałzależności przy użyciu odwołania do załadowanego zestawu.</span><span class="sxs-lookup"><span data-stu-id="9f812-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="9f812-167">To udostępnianie jest wymagane zestawów w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="9f812-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="9f812-168">Zestawy te mogą być <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>ładowane tylko do pliku .</span><span class="sxs-lookup"><span data-stu-id="9f812-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="9f812-169">To samo jest wymagane dla `ASP.NET` `WPF`ram, `WinForms`takich jak , lub .</span><span class="sxs-lookup"><span data-stu-id="9f812-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="9f812-170">Zaleca się, że współużytkowane zależności <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>powinny być ładowane do .</span><span class="sxs-lookup"><span data-stu-id="9f812-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="9f812-171">To udostępnianie jest typowy wzór projektu.</span><span class="sxs-lookup"><span data-stu-id="9f812-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="9f812-172">Udostępnianie jest implementowane w kodowaniu wystąpienia niestandardowego. <xref:System.Runtime.Loader.AssemblyLoadContext></span><span class="sxs-lookup"><span data-stu-id="9f812-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="9f812-173"><xref:System.Runtime.Loader.AssemblyLoadContext>ma różne zdarzenia i funkcje wirtualne, które mogą być zastąpione.</span><span class="sxs-lookup"><span data-stu-id="9f812-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="9f812-174">Gdy którakolwiek z tych funkcji <xref:System.Reflection.Assembly> zwraca odwołanie do <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienia, <xref:System.Reflection.Assembly> który został załadowany w innym wystąpieniu, wystąpienie jest współużytkowane.</span><span class="sxs-lookup"><span data-stu-id="9f812-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="9f812-175">Standardowy algorytm ładowania odracza do <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> ładowania w celu uproszczenia wspólnego wzorca udostępniania.</span><span class="sxs-lookup"><span data-stu-id="9f812-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="9f812-176">Zobacz [Algorytm ładowania zestawu zarządzanego](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="9f812-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="9f812-177">Komplikacje</span><span class="sxs-lookup"><span data-stu-id="9f812-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="9f812-178">Problemy z konwersją typów</span><span class="sxs-lookup"><span data-stu-id="9f812-178">Type conversion issues</span></span>

<span data-ttu-id="9f812-179">Gdy <xref:System.Runtime.Loader.AssemblyLoadContext> dwa wystąpienia zawierają definicje `name`typów z tym samym , nie są one tego samego typu.</span><span class="sxs-lookup"><span data-stu-id="9f812-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="9f812-180">Są one tego samego typu, jeśli i <xref:System.Reflection.Assembly> tylko wtedy, gdy pochodzą z tego samego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="9f812-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="9f812-181">Aby skomplikować sprawy, komunikaty o wyjątkach dotyczące tych niedopasowanych typów mogą być mylące.</span><span class="sxs-lookup"><span data-stu-id="9f812-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="9f812-182">Typy są określane w komunikatach o wyjątkach przez ich proste nazwy typów.</span><span class="sxs-lookup"><span data-stu-id="9f812-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="9f812-183">Typowy komunikat o wyjątku w tym przypadku będzie w formie:</span><span class="sxs-lookup"><span data-stu-id="9f812-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="9f812-184">Obiekt typu "IsolatedType" nie może zostać przekonwertowany na typ "IsolatedType".</span><span class="sxs-lookup"><span data-stu-id="9f812-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="9f812-185">Problemy z konwersją typu debugowania</span><span class="sxs-lookup"><span data-stu-id="9f812-185">Debugging type conversion issues</span></span>

<span data-ttu-id="9f812-186">Biorąc pod uwagę parę niedopasowanych typów, ważne jest również, aby wiedzieć:</span><span class="sxs-lookup"><span data-stu-id="9f812-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="9f812-187">Każdy typ jest<xref:System.Type.Assembly?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="9f812-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="9f812-188">Każdy typ <xref:System.Runtime.Loader.AssemblyLoadContext>, które można uzyskać <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> za pomocą funkcji.</span><span class="sxs-lookup"><span data-stu-id="9f812-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="9f812-189">Biorąc pod `a` `b`uwagę dwa obiekty i , oceny następujących w debugerze będą pomocne:</span><span class="sxs-lookup"><span data-stu-id="9f812-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="9f812-190">Rozwiązywanie problemów z konwersją typów</span><span class="sxs-lookup"><span data-stu-id="9f812-190">Resolving type conversion issues</span></span>

<span data-ttu-id="9f812-191">Istnieją dwa wzorce projektowe do rozwiązywania tych problemów z konwersją typu.</span><span class="sxs-lookup"><span data-stu-id="9f812-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="9f812-192">Użyj typowych typów udostępnionych.</span><span class="sxs-lookup"><span data-stu-id="9f812-192">Use common shared types.</span></span> <span data-ttu-id="9f812-193">Ten typ udostępniony może być pierwotnym typem czasu wykonywania lub może obejmować utworzenie nowego typu udostępnionego w zestawie udostępnionym.</span><span class="sxs-lookup"><span data-stu-id="9f812-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="9f812-194">Często typ udostępniony jest [interfejsem](../../csharp/language-reference/keywords/interface.md) zdefiniowanym w zestawie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9f812-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="9f812-195">Zobacz też: [Jak współużytkowane są zależności?](#how-are-dependencies-shared).</span><span class="sxs-lookup"><span data-stu-id="9f812-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="9f812-196">Użyj technik organizowania do konwersji z jednego typu na inny.</span><span class="sxs-lookup"><span data-stu-id="9f812-196">Use marshaling techniques to convert from one type to another.</span></span>
