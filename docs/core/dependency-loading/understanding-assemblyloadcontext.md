---
title: Zrozumienie AssemblyLoadContext — .NET Core
description: Najważniejsze koncepcje dotyczące przeznaczenia i zachowania AssemblyLoadContext w programie .NET Core.
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 8a73a432bf8cc72cced77cf6c62a785b72032913
ms.sourcegitcommit: 9c3a4f2d3babca8919a1e490a159c1500ba7a844
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/12/2019
ms.locfileid: "72291260"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="b3d20-103">Informacje o system. Runtime. Loader. AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="b3d20-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="b3d20-104">Klasa <xref:System.Runtime.Loader.AssemblyLoadContext> jest unikatowa dla platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="b3d20-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="b3d20-105">Ten artykuł próbuje uzupełnić dokumentację interfejsu API <xref:System.Runtime.Loader.AssemblyLoadContext> z informacjami koncepcyjnymi.</span><span class="sxs-lookup"><span data-stu-id="b3d20-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="b3d20-106">Ten artykuł ma zastosowanie w przypadku deweloperów implementujących dynamiczne ładowanie, szczególnie dla deweloperów platformy ładującej dynamicznie.</span><span class="sxs-lookup"><span data-stu-id="b3d20-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="b3d20-107">Co to jest AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="b3d20-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="b3d20-108">Każda aplikacja .NET Core niejawnie używa <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="b3d20-109">Jest to dostawca środowiska uruchomieniowego służący do lokalizowania i ładowania zależności.</span><span class="sxs-lookup"><span data-stu-id="b3d20-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="b3d20-110">Za każdym razem, gdy zostanie załadowana zależność, wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext> jest wywoływane, aby je zlokalizować.</span><span class="sxs-lookup"><span data-stu-id="b3d20-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="b3d20-111">Zapewnia ona usługę lokalizowania, ładowania i buforowania zestawów zarządzanych i innych zależności.</span><span class="sxs-lookup"><span data-stu-id="b3d20-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="b3d20-112">Aby zapewnić obsługę dynamicznego ładowania i zwalniania kodu, tworzy on izolowany kontekst do ładowania kodu i jego zależności we własnym wystąpieniu <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="b3d20-113">Kiedy potrzebujesz wielu wystąpień AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="b3d20-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="b3d20-114">Pojedyncze wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext> jest ograniczone do załadowania dokładnie jednej wersji <xref:System.Reflection.Assembly> na prostą nazwę zestawu, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="b3d20-115">To ograniczenie może stać się problemem podczas dynamicznego ładowania modułów kodu.</span><span class="sxs-lookup"><span data-stu-id="b3d20-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="b3d20-116">Każdy moduł jest kompilowany niezależnie i może zależeć od różnych wersji <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="b3d20-117">Ten problem występuje często, gdy różne moduły zależą od różnych wersji często używanej biblioteki.</span><span class="sxs-lookup"><span data-stu-id="b3d20-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="b3d20-118">Aby zapewnić obsługę dynamicznego ładowania kodu, interfejs API <xref:System.Runtime.Loader.AssemblyLoadContext> umożliwia ładowanie wersji <xref:System.Reflection.Assembly> w tej samej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b3d20-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="b3d20-119">Każde wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext> zawiera unikatowe mapowanie słownika każdej <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> do określonego wystąpienia <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="b3d20-120">Zapewnia również wygodny mechanizm grupowania zależności związanych z modułem kodu w celu późniejszego zwolnienia.</span><span class="sxs-lookup"><span data-stu-id="b3d20-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="b3d20-121">Co to jest specjalne wystąpienie AssemblyLoadContext. default?</span><span class="sxs-lookup"><span data-stu-id="b3d20-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="b3d20-122">Wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> jest automatycznie wypełniane przez środowisko uruchomieniowe przy uruchamianiu.</span><span class="sxs-lookup"><span data-stu-id="b3d20-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="b3d20-123">Używa [domyślnej sondy](default-probing.md) do lokalizowania i znajdowania wszystkich zależności statycznych.</span><span class="sxs-lookup"><span data-stu-id="b3d20-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="b3d20-124">Rozwiązuje najczęstsze scenariusze ładowania zależności.</span><span class="sxs-lookup"><span data-stu-id="b3d20-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="b3d20-125">Jak usługa AssemblyLoadContext obsługuje zależności dynamiczne?</span><span class="sxs-lookup"><span data-stu-id="b3d20-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="b3d20-126"><xref:System.Runtime.Loader.AssemblyLoadContext> zawiera różne zdarzenia i funkcje wirtualne, które można przesłonić.</span><span class="sxs-lookup"><span data-stu-id="b3d20-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="b3d20-127">Wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> obsługuje tylko przesłanianie zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="b3d20-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="b3d20-128">Algorytmy ładowania [zestawów zarządzanego](loading-managed.md), [algorytm ładowania zestawu satelitarnego](loading-resources.md)i [niezarządzany (natywny) algorytm ładowania](loading-unmanaged.md) odnoszą się do wszystkich dostępnych zdarzeń i funkcji wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="b3d20-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="b3d20-129">W artykułach są wyświetlane poszczególne zdarzenia i względne pozycje funkcji w algorytmach ładowania.</span><span class="sxs-lookup"><span data-stu-id="b3d20-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="b3d20-130">Ten artykuł nie odtwarza tych informacji.</span><span class="sxs-lookup"><span data-stu-id="b3d20-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="b3d20-131">Ta sekcja obejmuje ogólne zasady dotyczące odpowiednich zdarzeń i funkcji.</span><span class="sxs-lookup"><span data-stu-id="b3d20-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="b3d20-132">**Można powtarzać**.</span><span class="sxs-lookup"><span data-stu-id="b3d20-132">**Be repeatable**.</span></span> <span data-ttu-id="b3d20-133">Zapytanie dla określonej zależności musi zawsze prowadzić do tej samej odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="b3d20-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="b3d20-134">Należy zwrócić to samo załadowane wystąpienie zależności.</span><span class="sxs-lookup"><span data-stu-id="b3d20-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="b3d20-135">To wymaganie ma podstawowe znaczenie dla spójności pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="b3d20-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="b3d20-136">W przypadku zestawów zarządzanych w szczególności tworzymy pamięć podręczną <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-136">For managed assemblies in particular, we're creating a <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="b3d20-137">Klucz pamięci podręcznej jest prostą nazwą zestawu, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="b3d20-138">**Zazwyczaj nie**zgłaszaj.</span><span class="sxs-lookup"><span data-stu-id="b3d20-138">**Typically don't throw**.</span></span>  <span data-ttu-id="b3d20-139">Oczekuje się, że te funkcje zwracają `null`, a nie throw, gdy nie można znaleźć żądanej zależności.</span><span class="sxs-lookup"><span data-stu-id="b3d20-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="b3d20-140">Przerzucanie spowoduje przedwcześnie zakończenie wyszukiwania i propagowanie wyjątku do obiektu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="b3d20-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="b3d20-141">Przerzucanie powinno być ograniczone do nieoczekiwanych błędów, takich jak uszkodzony zestaw lub stan braku pamięci.</span><span class="sxs-lookup"><span data-stu-id="b3d20-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="b3d20-142">**Unikaj rekursji**.</span><span class="sxs-lookup"><span data-stu-id="b3d20-142">**Avoid recursion**.</span></span> <span data-ttu-id="b3d20-143">Należy pamiętać, że te funkcje i programy obsługi implementują reguły ładowania dla lokalizowania zależności.</span><span class="sxs-lookup"><span data-stu-id="b3d20-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="b3d20-144">Implementacja nie powinna wywoływać interfejsów API wyzwalających rekursję.</span><span class="sxs-lookup"><span data-stu-id="b3d20-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="b3d20-145">Kod powinien zwykle wywoływać funkcje ładowania **AssemblyLoadContext** , które wymagają określonej ścieżki lub argumentu odwołania do pamięci.</span><span class="sxs-lookup"><span data-stu-id="b3d20-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="b3d20-146">**Załaduj do poprawnej AssemblyLoadContext**.</span><span class="sxs-lookup"><span data-stu-id="b3d20-146">**Load into the correct AssemblyLoadContext**.</span></span> <span data-ttu-id="b3d20-147">Wybór miejsca, w którym mają zostać załadowane zależności, to specyficzne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b3d20-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="b3d20-148">Wybór jest implementowany przez te zdarzenia i funkcje.</span><span class="sxs-lookup"><span data-stu-id="b3d20-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="b3d20-149">Gdy kod wywołuje funkcje ładowania po ścieżce **AssemblyLoadContext** , wywołuje je w wystąpieniu, w którym ma zostać załadowany kod.</span><span class="sxs-lookup"><span data-stu-id="b3d20-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="b3d20-150">Nie zwracają `null` i umożliwiają obsługę <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> może to być najprostsza opcja.</span><span class="sxs-lookup"><span data-stu-id="b3d20-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="b3d20-151">**Należy pamiętać o Races wątków**.</span><span class="sxs-lookup"><span data-stu-id="b3d20-151">**Be aware of thread races**.</span></span> <span data-ttu-id="b3d20-152">Ładowanie może być wyzwalane przez wiele wątków.</span><span class="sxs-lookup"><span data-stu-id="b3d20-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="b3d20-153">AssemblyLoadContext obsługuje wątki Races przez niepodzielne Dodawanie zestawów do swojej pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="b3d20-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="b3d20-154">Wystąpienie Loser wyścigu jest odrzucane.</span><span class="sxs-lookup"><span data-stu-id="b3d20-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="b3d20-155">W logice implementacji nie należy dodawać dodatkowej logiki, która nie obsługuje prawidłowo wielu wątków.</span><span class="sxs-lookup"><span data-stu-id="b3d20-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="b3d20-156">Jak są izolowane zależności dynamiczne?</span><span class="sxs-lookup"><span data-stu-id="b3d20-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="b3d20-157">Każde wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext> reprezentuje unikatowy zakres dla wystąpień <xref:System.Reflection.Assembly> i definicje <xref:System.Type>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="b3d20-158">Między tymi zależnościami nie istnieje izolacja binarna.</span><span class="sxs-lookup"><span data-stu-id="b3d20-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="b3d20-159">Są one izolowane tylko przez nieznalezienie siebie według nazwy.</span><span class="sxs-lookup"><span data-stu-id="b3d20-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="b3d20-160">W każdym <xref:System.Runtime.Loader.AssemblyLoadContext>:</span><span class="sxs-lookup"><span data-stu-id="b3d20-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="b3d20-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> może odwoływać się do innego wystąpienia <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="b3d20-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> może zwrócić wystąpienie innego typu dla tego samego typu `name`.</span><span class="sxs-lookup"><span data-stu-id="b3d20-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="b3d20-163">Jak są udostępniane zależności?</span><span class="sxs-lookup"><span data-stu-id="b3d20-163">How are dependencies shared?</span></span>

<span data-ttu-id="b3d20-164">Zależności można łatwo udostępniać między wystąpieniami <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="b3d20-165">Model ogólny jest przeznaczony dla jednego <xref:System.Runtime.Loader.AssemblyLoadContext>, aby załadować zależność.</span><span class="sxs-lookup"><span data-stu-id="b3d20-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="b3d20-166">Druga współużytkuje zależność przy użyciu odwołania do załadowanego zestawu.</span><span class="sxs-lookup"><span data-stu-id="b3d20-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="b3d20-167">To udostępnianie jest wymagane przez zestawy środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="b3d20-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="b3d20-168">Te zestawy można ładować tylko do <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="b3d20-169">Taka sama jest wymagana dla platform, takich jak `ASP.NET`, `WPF` lub `WinForms`.</span><span class="sxs-lookup"><span data-stu-id="b3d20-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="b3d20-170">Zaleca się, aby współużytkowane zależności zostały załadowane do <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="b3d20-171">To udostępnianie jest typowym wzorcem projektu.</span><span class="sxs-lookup"><span data-stu-id="b3d20-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="b3d20-172">Udostępnianie jest implementowane w kodowaniu wystąpienia niestandardowego <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="b3d20-173"><xref:System.Runtime.Loader.AssemblyLoadContext> zawiera różne zdarzenia i funkcje wirtualne, które można przesłonić.</span><span class="sxs-lookup"><span data-stu-id="b3d20-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="b3d20-174">Gdy którakolwiek z tych funkcji zwróci odwołanie do wystąpienia <xref:System.Reflection.Assembly>, które zostało załadowane w innym wystąpieniu <xref:System.Runtime.Loader.AssemblyLoadContext>, wystąpienie <xref:System.Reflection.Assembly> jest udostępniane.</span><span class="sxs-lookup"><span data-stu-id="b3d20-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="b3d20-175">Standardowy algorytm obciążenia to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> do załadowania, aby uprościć wspólny wzorzec udostępniania.</span><span class="sxs-lookup"><span data-stu-id="b3d20-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="b3d20-176">Zobacz [algorytm ładowania zestawu zarządzanego](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="b3d20-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="b3d20-177">Komplikacj</span><span class="sxs-lookup"><span data-stu-id="b3d20-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="b3d20-178">Błędy konwersji typów</span><span class="sxs-lookup"><span data-stu-id="b3d20-178">Type conversion issues</span></span>

<span data-ttu-id="b3d20-179">Gdy dwa wystąpienia <xref:System.Runtime.Loader.AssemblyLoadContext> zawierają definicje typu o tej samej `name`, nie są tego samego typu.</span><span class="sxs-lookup"><span data-stu-id="b3d20-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="b3d20-180">Są tego samego typu, jeśli i tylko wtedy, gdy pochodzą z tego samego wystąpienia <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="b3d20-181">W celu zaskomplikowania spraw komunikaty o wyjątkach dotyczące tych niezgodnych typów mogą być mylące.</span><span class="sxs-lookup"><span data-stu-id="b3d20-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="b3d20-182">Typy są określane w komunikatach o wyjątku według ich nazw typów prostych.</span><span class="sxs-lookup"><span data-stu-id="b3d20-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="b3d20-183">Typowy komunikat o wyjątku w tym przypadku powinien mieć postać:</span><span class="sxs-lookup"><span data-stu-id="b3d20-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="b3d20-184">Nie można przekonwertować obiektu typu "izolowany" na typ "izolowany".</span><span class="sxs-lookup"><span data-stu-id="b3d20-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="b3d20-185">Błędy konwersji typu debugowania</span><span class="sxs-lookup"><span data-stu-id="b3d20-185">Debugging type conversion issues</span></span>

<span data-ttu-id="b3d20-186">Uwzględniając parę niezgodnych typów, należy również znać:</span><span class="sxs-lookup"><span data-stu-id="b3d20-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="b3d20-187">@No__t każdego typu-0</span><span class="sxs-lookup"><span data-stu-id="b3d20-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="b3d20-188">Każdy typ <xref:System.Runtime.Loader.AssemblyLoadContext>, który można uzyskać za pośrednictwem funkcji <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b3d20-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="b3d20-189">Podajemy dwa obiekty `a` i `b`, które oceniają następujące elementy w debugerze:</span><span class="sxs-lookup"><span data-stu-id="b3d20-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="b3d20-190">Rozwiązywanie problemów z konwersją typów</span><span class="sxs-lookup"><span data-stu-id="b3d20-190">Resolving type conversion issues</span></span>

<span data-ttu-id="b3d20-191">Istnieją dwa wzorce projektowe umożliwiające rozwiązanie tych problemów z konwersją typów.</span><span class="sxs-lookup"><span data-stu-id="b3d20-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="b3d20-192">Używaj wspólnych typów udostępnionych.</span><span class="sxs-lookup"><span data-stu-id="b3d20-192">Use common shared types.</span></span> <span data-ttu-id="b3d20-193">Ten typ współużytkowany może być typem pierwotnego środowiska uruchomieniowego lub może polegać na utworzeniu nowego typu udostępnionego w zestawie udostępnionym.</span><span class="sxs-lookup"><span data-stu-id="b3d20-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="b3d20-194">Często udostępniony typ jest [interfejsem](../../csharp/language-reference/keywords/interface.md) zdefiniowanym w zestawie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b3d20-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="b3d20-195">Zobacz również: w [jaki sposób są udostępniane zależności?](#how-are-dependencies-shared)</span><span class="sxs-lookup"><span data-stu-id="b3d20-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="b3d20-196">Używaj technik kierujących do konwersji z jednego typu na drugi.</span><span class="sxs-lookup"><span data-stu-id="b3d20-196">Use marshaling techniques to convert from one type to another.</span></span>
