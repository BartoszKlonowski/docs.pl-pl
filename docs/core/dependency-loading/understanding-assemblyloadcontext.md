---
title: Opis ZestawuLoadContext - .NET Core
description: Kluczowe pojęcia, aby zrozumieć cel i zachowanie AssemblyLoadContext w .NET Core.
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 43fb0d792ddeb20b8a141af452a86dd50f37ba43
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/01/2020
ms.locfileid: "80523613"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="bf71a-103">Opis System.Runtime.Loader.AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="bf71a-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="bf71a-104">Klasa <xref:System.Runtime.Loader.AssemblyLoadContext> jest unikatowa dla .NET Core.</span><span class="sxs-lookup"><span data-stu-id="bf71a-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="bf71a-105">W tym artykule <xref:System.Runtime.Loader.AssemblyLoadContext> próbuje uzupełnić dokumentację interfejsu API z informacjami koncepcyjnymi.</span><span class="sxs-lookup"><span data-stu-id="bf71a-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="bf71a-106">Ten artykuł jest odpowiedni dla deweloperów implementujących ładowanie dynamiczne, szczególnie dynamicznych deweloperów platformy ładowania.</span><span class="sxs-lookup"><span data-stu-id="bf71a-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="bf71a-107">Co to jest AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="bf71a-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="bf71a-108">Każda aplikacja .NET Core niejawnie używa pliku <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="bf71a-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="bf71a-109">Jest dostawcą środowiska wykonawczego do lokalizowania i ładowania zależności.</span><span class="sxs-lookup"><span data-stu-id="bf71a-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="bf71a-110">Za każdym razem, gdy <xref:System.Runtime.Loader.AssemblyLoadContext> zależność jest ładowana, wystąpienie jest wywoływane, aby ją zlokalizować.</span><span class="sxs-lookup"><span data-stu-id="bf71a-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="bf71a-111">Zapewnia usługę lokalizowania, ładowania i buforowania zarządzanych zestawów i innych zależności.</span><span class="sxs-lookup"><span data-stu-id="bf71a-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="bf71a-112">Do obsługi dynamicznego ładowania kodu i zwalniania, tworzy izolowany kontekst <xref:System.Runtime.Loader.AssemblyLoadContext> do ładowania kodu i jego zależności w ich własnym wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="bf71a-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="bf71a-113">Kiedy potrzebujesz wielu wystąpień AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="bf71a-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="bf71a-114">Pojedyncze <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie jest ograniczone do ładowania <xref:System.Reflection.Assembly> dokładnie jednej <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>wersji nazwy zestawu prostego.</span><span class="sxs-lookup"><span data-stu-id="bf71a-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="bf71a-115">To ograniczenie może stać się problemem podczas dynamicznego ładowania modułów kodu.</span><span class="sxs-lookup"><span data-stu-id="bf71a-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="bf71a-116">Każdy moduł jest kompilowany niezależnie i może <xref:System.Reflection.Assembly>zależeć od różnych wersji .</span><span class="sxs-lookup"><span data-stu-id="bf71a-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="bf71a-117">Ten problem występuje często, gdy różne moduły zależą od różnych wersji powszechnie używanej biblioteki.</span><span class="sxs-lookup"><span data-stu-id="bf71a-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="bf71a-118">Aby obsługiwać dynamicznie <xref:System.Runtime.Loader.AssemblyLoadContext> ładowania kodu, interfejs API <xref:System.Reflection.Assembly> zapewnia ładowanie sprzecznych wersji w tej samej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bf71a-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="bf71a-119">Każde <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie zawiera unikatowy <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> słownik <xref:System.Reflection.Assembly> mapowanie każdego do określonego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="bf71a-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="bf71a-120">Zapewnia również wygodny mechanizm grupowania zależności związanych z modułem kodu do późniejszego zwalniania.</span><span class="sxs-lookup"><span data-stu-id="bf71a-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="bf71a-121">Co jest specjalnego w przypadku wystąpienia AssemblyLoadContext.Default?</span><span class="sxs-lookup"><span data-stu-id="bf71a-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="bf71a-122">Wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> jest automatycznie wypełniane przez środowisko wykonawcze podczas uruchamiania.</span><span class="sxs-lookup"><span data-stu-id="bf71a-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="bf71a-123">Używa [domyślnego sondowania,](default-probing.md) aby zlokalizować i znaleźć wszystkie zależności statyczne.</span><span class="sxs-lookup"><span data-stu-id="bf71a-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="bf71a-124">Rozwiązuje najbardziej typowe scenariusze ładowania zależności.</span><span class="sxs-lookup"><span data-stu-id="bf71a-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="bf71a-125">W jaki sposób AssemblyLoadContext obsługuje zależności dynamiczne?</span><span class="sxs-lookup"><span data-stu-id="bf71a-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="bf71a-126"><xref:System.Runtime.Loader.AssemblyLoadContext>ma różne zdarzenia i funkcje wirtualne, które mogą być zastąpione.</span><span class="sxs-lookup"><span data-stu-id="bf71a-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="bf71a-127">Wystąpienie <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> obsługuje tylko zastępowanie zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="bf71a-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="bf71a-128">Artykuły [Algorytm ładowania zestawu zarządzanego,](loading-managed.md) [Algorytm ładowania zestawu satelitarnego](loading-resources.md)i [Algorytm ładowania biblioteki niezarządzanej (natywnej)](loading-unmanaged.md) odnoszą się do wszystkich dostępnych zdarzeń i funkcji wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="bf71a-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="bf71a-129">Artykuły pokazują względną pozycję każdego zdarzenia i funkcji w algorytmach ładowania.</span><span class="sxs-lookup"><span data-stu-id="bf71a-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="bf71a-130">Ten artykuł nie powiela tych informacji.</span><span class="sxs-lookup"><span data-stu-id="bf71a-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="bf71a-131">Niniejsza sekcja obejmuje ogólne zasady dotyczące odpowiednich zdarzeń i funkcji.</span><span class="sxs-lookup"><span data-stu-id="bf71a-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="bf71a-132">**Być powtarzalne**.</span><span class="sxs-lookup"><span data-stu-id="bf71a-132">**Be repeatable**.</span></span> <span data-ttu-id="bf71a-133">Kwerenda dla określonej zależności musi zawsze spowodować taką samą odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="bf71a-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="bf71a-134">To samo załadowane wystąpienie zależności musi zostać zwrócone.</span><span class="sxs-lookup"><span data-stu-id="bf71a-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="bf71a-135">To wymaganie ma podstawowe znaczenie dla spójności pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="bf71a-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="bf71a-136">W szczególności dla zestawów zarządzanych tworzymy pamięć podręczną. <xref:System.Reflection.Assembly></span><span class="sxs-lookup"><span data-stu-id="bf71a-136">For managed assemblies in particular, we're creating a <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="bf71a-137">Klucz pamięci podręcznej jest <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>prostą nazwą zestawu, .</span><span class="sxs-lookup"><span data-stu-id="bf71a-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="bf71a-138">**Zazwyczaj nie rzucać**.</span><span class="sxs-lookup"><span data-stu-id="bf71a-138">**Typically don't throw**.</span></span>  <span data-ttu-id="bf71a-139">Oczekuje się, że te `null` funkcje zwracają, a nie zgłaszać, gdy nie można znaleźć żądanej zależności.</span><span class="sxs-lookup"><span data-stu-id="bf71a-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="bf71a-140">Zgłaszanie przedwcześnie zakończy wyszukiwanie i będzie propagować wyjątek od wywołującego.</span><span class="sxs-lookup"><span data-stu-id="bf71a-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="bf71a-141">Zgłaszanie powinno być ograniczone do nieoczekiwanych błędów, takich jak uszkodzony zestaw lub stan braku pamięci.</span><span class="sxs-lookup"><span data-stu-id="bf71a-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="bf71a-142">**Unikać rekursji**.</span><span class="sxs-lookup"><span data-stu-id="bf71a-142">**Avoid recursion**.</span></span> <span data-ttu-id="bf71a-143">Należy pamiętać, że te funkcje i programy obsługi implementują reguły ładowania do lokalizowania zależności.</span><span class="sxs-lookup"><span data-stu-id="bf71a-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="bf71a-144">Implementacja nie powinna wywoływać interfejsów API, które wyzwalają rekursję.</span><span class="sxs-lookup"><span data-stu-id="bf71a-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="bf71a-145">Kod powinien zazwyczaj wywoływać **AssemblyLoadContext** funkcji ładowania, które wymagają określonej ścieżki lub argumentu odwołania do pamięci.</span><span class="sxs-lookup"><span data-stu-id="bf71a-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="bf71a-146">**Załaduj do właściwego zestawuLoadContext**.</span><span class="sxs-lookup"><span data-stu-id="bf71a-146">**Load into the correct AssemblyLoadContext**.</span></span> <span data-ttu-id="bf71a-147">Wybór miejsca ładowania zależności jest specyficzne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bf71a-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="bf71a-148">Wybór jest realizowany przez te zdarzenia i funkcje.</span><span class="sxs-lookup"><span data-stu-id="bf71a-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="bf71a-149">Gdy kod wywołuje **AssemblyLoadContext** load-by-path funkcje wywołać je w wystąpieniu, w którym chcesz załadowany kod.</span><span class="sxs-lookup"><span data-stu-id="bf71a-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="bf71a-150">Kiedyś powrót `null` i <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> umożliwienie uchwytowi obciążenia może być najprostszą opcją.</span><span class="sxs-lookup"><span data-stu-id="bf71a-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="bf71a-151">**Należy pamiętać o wyścigach wątków**.</span><span class="sxs-lookup"><span data-stu-id="bf71a-151">**Be aware of thread races**.</span></span> <span data-ttu-id="bf71a-152">Ładowanie może być wyzwalane przez wiele wątków.</span><span class="sxs-lookup"><span data-stu-id="bf71a-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="bf71a-153">AssemblyLoadContext obsługuje wyścigi wątków przez atomowe dodawanie zestawów do jego pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="bf71a-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="bf71a-154">Wystąpienie przegranego wyścigu zostaje odrzucone.</span><span class="sxs-lookup"><span data-stu-id="bf71a-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="bf71a-155">W logice implementacji nie należy dodawać dodatkowej logiki, która nie obsługuje poprawnie wielu wątków.</span><span class="sxs-lookup"><span data-stu-id="bf71a-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="bf71a-156">Jak są izolowane zależności dynamiczne?</span><span class="sxs-lookup"><span data-stu-id="bf71a-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="bf71a-157">Każde <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienie reprezentuje <xref:System.Reflection.Assembly> unikatowy <xref:System.Type> zakres dla wystąpień i definicji.</span><span class="sxs-lookup"><span data-stu-id="bf71a-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="bf71a-158">Nie ma izolacji binarnej między tymi zależnościami.</span><span class="sxs-lookup"><span data-stu-id="bf71a-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="bf71a-159">Są one tylko odizolowane, nie znajdując siebie po imieniu.</span><span class="sxs-lookup"><span data-stu-id="bf71a-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="bf71a-160">W <xref:System.Runtime.Loader.AssemblyLoadContext>każdym z nich:</span><span class="sxs-lookup"><span data-stu-id="bf71a-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="bf71a-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>może odnosić <xref:System.Reflection.Assembly> się do innego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="bf71a-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="bf71a-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType>może zwrócić wystąpienie innego typu `name`dla tego samego typu .</span><span class="sxs-lookup"><span data-stu-id="bf71a-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="bf71a-163">Jak współużytkują zależności?</span><span class="sxs-lookup"><span data-stu-id="bf71a-163">How are dependencies shared?</span></span>

<span data-ttu-id="bf71a-164">Zależności mogą być łatwo <xref:System.Runtime.Loader.AssemblyLoadContext> współużytkowane między wystąpieniami.</span><span class="sxs-lookup"><span data-stu-id="bf71a-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="bf71a-165">Ogólny model jest <xref:System.Runtime.Loader.AssemblyLoadContext> dla jednego, aby załadować zależność.</span><span class="sxs-lookup"><span data-stu-id="bf71a-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="bf71a-166">Inne udziały zależności przy użyciu odwołania do załadowanego zestawu.</span><span class="sxs-lookup"><span data-stu-id="bf71a-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="bf71a-167">Ten udostępnianie jest wymagane z zestawów środowiska wykonawczego.</span><span class="sxs-lookup"><span data-stu-id="bf71a-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="bf71a-168">Te zestawy można załadować <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>tylko do pliku .</span><span class="sxs-lookup"><span data-stu-id="bf71a-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="bf71a-169">To samo jest wymagane dla `ASP.NET` `WPF`ram, `WinForms`takich jak , lub .</span><span class="sxs-lookup"><span data-stu-id="bf71a-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="bf71a-170">Zaleca się załadowanie współdzielonych zależności <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>do .</span><span class="sxs-lookup"><span data-stu-id="bf71a-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="bf71a-171">Ten udział jest wspólny wzorzec projektowania.</span><span class="sxs-lookup"><span data-stu-id="bf71a-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="bf71a-172">Udostępnianie jest implementowane w kodowaniu <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienia niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="bf71a-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="bf71a-173"><xref:System.Runtime.Loader.AssemblyLoadContext>ma różne zdarzenia i funkcje wirtualne, które mogą być zastąpione.</span><span class="sxs-lookup"><span data-stu-id="bf71a-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="bf71a-174">Gdy którakolwiek z tych funkcji <xref:System.Reflection.Assembly> zwraca odwołanie do <xref:System.Runtime.Loader.AssemblyLoadContext> wystąpienia, <xref:System.Reflection.Assembly> które zostało załadowane w innym wystąpieniu, wystąpienie jest współużytkowane.</span><span class="sxs-lookup"><span data-stu-id="bf71a-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="bf71a-175">Standardowy algorytm obciążenia <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> odracza się do ładowania, aby uprościć wspólny wzorzec udostępniania.</span><span class="sxs-lookup"><span data-stu-id="bf71a-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="bf71a-176">Zobacz [Algorytm ładowania zestawu zarządzanego](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="bf71a-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="bf71a-177">Komplikacje</span><span class="sxs-lookup"><span data-stu-id="bf71a-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="bf71a-178">Problemy z konwersją typów</span><span class="sxs-lookup"><span data-stu-id="bf71a-178">Type conversion issues</span></span>

<span data-ttu-id="bf71a-179">Gdy <xref:System.Runtime.Loader.AssemblyLoadContext> dwa wystąpienia zawierają definicje `name`typów o tej samej, nie są tego samego typu.</span><span class="sxs-lookup"><span data-stu-id="bf71a-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="bf71a-180">Są tego samego typu, jeśli i tylko <xref:System.Reflection.Assembly> wtedy, gdy pochodzą z tego samego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="bf71a-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="bf71a-181">Aby skomplikować sprawy, komunikaty o wyjątkach dotyczące tych niezgodnych typów mogą być mylące.</span><span class="sxs-lookup"><span data-stu-id="bf71a-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="bf71a-182">Typy są określane w komunikatach wyjątków przez ich nazwy typów prostych.</span><span class="sxs-lookup"><span data-stu-id="bf71a-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="bf71a-183">Typowy komunikat wyjątek w tym przypadku będzie formularza:</span><span class="sxs-lookup"><span data-stu-id="bf71a-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="bf71a-184">Obiekt typu "IsolatedType" nie może być konwertowany na typ "IsolatedType".</span><span class="sxs-lookup"><span data-stu-id="bf71a-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="bf71a-185">Problemy z konwersją typu debugowania</span><span class="sxs-lookup"><span data-stu-id="bf71a-185">Debugging type conversion issues</span></span>

<span data-ttu-id="bf71a-186">Biorąc pod uwagę parę niedopasowanych typów, ważne jest, aby również wiedzieć:</span><span class="sxs-lookup"><span data-stu-id="bf71a-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="bf71a-187">Każdy typ<xref:System.Type.Assembly?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="bf71a-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="bf71a-188">Każdy <xref:System.Runtime.Loader.AssemblyLoadContext>typ, który można uzyskać <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> za pomocą funkcji.</span><span class="sxs-lookup"><span data-stu-id="bf71a-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="bf71a-189">Biorąc pod `a` `b`uwagę dwa obiekty i , oceny następujące w debugera będzie pomocne:</span><span class="sxs-lookup"><span data-stu-id="bf71a-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="bf71a-190">Rozwiązywanie problemów z konwersją typów</span><span class="sxs-lookup"><span data-stu-id="bf71a-190">Resolving type conversion issues</span></span>

<span data-ttu-id="bf71a-191">Istnieją dwa wzorce projektowe do rozwiązywania tych problemów konwersji typu.</span><span class="sxs-lookup"><span data-stu-id="bf71a-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="bf71a-192">Użyj typowych typów udostępnionych.</span><span class="sxs-lookup"><span data-stu-id="bf71a-192">Use common shared types.</span></span> <span data-ttu-id="bf71a-193">Ten typ udostępniony może być typem pierwotnego środowiska uruchomieniowego lub może obejmować tworzenie nowego typu udostępnionego w zestawie udostępnionym.</span><span class="sxs-lookup"><span data-stu-id="bf71a-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="bf71a-194">Często typ udostępniony jest [interfejs](../../csharp/language-reference/keywords/interface.md) zdefiniowany w zestawie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bf71a-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="bf71a-195">Zobacz też: [Jak współdzielone są zależności?](#how-are-dependencies-shared).</span><span class="sxs-lookup"><span data-stu-id="bf71a-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="bf71a-196">Użyj technik organizowania do konwersji z jednego typu do drugiego.</span><span class="sxs-lookup"><span data-stu-id="bf71a-196">Use marshaling techniques to convert from one type to another.</span></span>
