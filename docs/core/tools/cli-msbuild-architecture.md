---
title: Architektura narzędzi wiersza polecenia .NET Core
description: Dowiedz się więcej o warstwach narzędziowych .NET Core i o tym, co zmieniło się w najnowszych wersjach.
ms.date: 03/06/2017
ms.openlocfilehash: e1a9fe59225c17d54f6e7213d2b3c3fa70ee58e0
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/23/2020
ms.locfileid: "82102882"
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="f73e0-103">Omówienie zmian na wysokim poziomie w narzędziach .NET Core</span><span class="sxs-lookup"><span data-stu-id="f73e0-103">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="f73e0-104">W tym dokumencie opisano zmiany związane z przejściem z *project.json* do MSBuild i systemu projektu *csproj* z informacjami na temat zmian w nakładaniu warstw narzędzi .NET Core i implementacji poleceń interfejsu wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="f73e0-104">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="f73e0-105">Zmiany te wystąpiły wraz z wydaniem .NET Core SDK 1.0 i Visual Studio 2017 w dniu 7 marca 2017 r. (zobacz [anons),](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)ale zostały początkowo zaimplementowane wraz z wydaniem programu .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="f73e0-105">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="f73e0-106">Odejście od project.json</span><span class="sxs-lookup"><span data-stu-id="f73e0-106">Moving away from project.json</span></span>

<span data-ttu-id="f73e0-107">Największą zmianą w narzędziu dla .NET Core jest z pewnością [odejście od project.json do csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) jako systemu projektu.</span><span class="sxs-lookup"><span data-stu-id="f73e0-107">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="f73e0-108">Najnowsze wersje narzędzi wiersza polecenia nie obsługują plików *project.json.*</span><span class="sxs-lookup"><span data-stu-id="f73e0-108">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="f73e0-109">Oznacza to, że nie można używać do tworzenia, uruchamiania lub publikowania aplikacji i bibliotek opartych na project.json.</span><span class="sxs-lookup"><span data-stu-id="f73e0-109">That means that it cannot be used to build, run, or publish project.json based applications and libraries.</span></span> <span data-ttu-id="f73e0-110">Aby użyć tej wersji narzędzi, należy przeprowadzić migrację istniejących projektów lub rozpocząć nowe.</span><span class="sxs-lookup"><span data-stu-id="f73e0-110">To use this version of the tools, migrate your existing projects or start new ones.</span></span>

<span data-ttu-id="f73e0-111">W ramach tego ruchu, niestandardowy silnik kompilacji, który został opracowany do tworzenia project.json projektów został zastąpiony dojrzałym i w pełni zdolny silnik kompilacji o nazwie [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="f73e0-111">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="f73e0-112">MSBuild jest dobrze znanym aparatem w społeczności .NET.</span><span class="sxs-lookup"><span data-stu-id="f73e0-112">MSBuild is a well-known engine in the .NET community.</span></span> <span data-ttu-id="f73e0-113">Jest to kluczowa technologia od czasu pierwszego wydania platformy.</span><span class="sxs-lookup"><span data-stu-id="f73e0-113">It has been a key technology since the platform's first release.</span></span> <span data-ttu-id="f73e0-114">Ponieważ musi tworzyć aplikacje .NET Core, MSBuild został przeniesiony do platformy .NET Core i może być używany na dowolnej platformie, na którą działa program .NET Core.</span><span class="sxs-lookup"><span data-stu-id="f73e0-114">Because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="f73e0-115">Jedną z głównych obietnic .NET Core jest stos rozwoju między platformami i upewniliśmy się, że ten ruch nie złamie tej obietnicy.</span><span class="sxs-lookup"><span data-stu-id="f73e0-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!TIP]
> <span data-ttu-id="f73e0-116">Jeśli jesteś nowy w MSBuild i chcesz dowiedzieć się więcej na ten temat, można rozpocząć od przeczytania [msbuild pojęcia](/visualstudio/msbuild/msbuild-concepts) artykułu.</span><span class="sxs-lookup"><span data-stu-id="f73e0-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span>

## <a name="the-tooling-layers"></a><span data-ttu-id="f73e0-117">Warstwy narzędziowe</span><span class="sxs-lookup"><span data-stu-id="f73e0-117">The tooling layers</span></span>

<span data-ttu-id="f73e0-118">Wraz ze zmianą w silniku kompilacji i odejściem od istniejącego systemu projektów, oczywiście pojawiają się pewne pytania.</span><span class="sxs-lookup"><span data-stu-id="f73e0-118">With the change in build engine and the move away from the existing project system, some questions naturally follow.</span></span> <span data-ttu-id="f73e0-119">Czy któraś z tych zmian zmienia ogólne "warstwowanie" ekosystemu narzędzi .NET Core?</span><span class="sxs-lookup"><span data-stu-id="f73e0-119">Do any of these changes change the overall "layering" of the .NET Core tooling ecosystem?</span></span> <span data-ttu-id="f73e0-120">Czy są nowe bity i komponenty?</span><span class="sxs-lookup"><span data-stu-id="f73e0-120">Are there new bits and components?</span></span>

<span data-ttu-id="f73e0-121">Zacznijmy od szybkiego odświeżania warstw w podglądzie 2, jak pokazano na poniższym rysunku:</span><span class="sxs-lookup"><span data-stu-id="f73e0-121">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Podgląd 2 narzędzi architektury wysokiego poziomu](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="f73e0-123">Nakładanie warstw narzędzi w wersji Preview 2 jest proste.</span><span class="sxs-lookup"><span data-stu-id="f73e0-123">The layering of the tools in Preview 2 is straightforward.</span></span> <span data-ttu-id="f73e0-124">Na dole podstawą jest .NET Core CLI.</span><span class="sxs-lookup"><span data-stu-id="f73e0-124">At the bottom, the foundation is the .NET Core CLI.</span></span> <span data-ttu-id="f73e0-125">Wszystkie inne narzędzia wyższego poziomu, takie jak Visual Studio lub Visual Studio Code, zależą i polegają na wierszu polecenia do tworzenia projektów, przywracania zależności i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="f73e0-125">All other, higher-level tools, such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies, and so on.</span></span> <span data-ttu-id="f73e0-126">Na przykład jeśli visual studio chciał wykonać operację przywracania, to wywołanie `dotnet restore` polecenia w wierszu polecenia.</span><span class="sxs-lookup"><span data-stu-id="f73e0-126">For example, if Visual Studio wanted to perform a restore operation, it would call into the `dotnet restore` command in the CLI.</span></span>

<span data-ttu-id="f73e0-127">Wraz z przejściem do nowego systemu projektu zmienia się poprzedni diagram:</span><span class="sxs-lookup"><span data-stu-id="f73e0-127">With the move to the new project system, the previous diagram changes:</span></span>

![Architektura wysokiego poziomu .NET Core SDK 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="f73e0-129">Główną różnicą jest to, że CLI nie jest już warstwą fundamentalną; ta rola jest teraz wypełniona przez "składnik udostępnionego SDK".</span><span class="sxs-lookup"><span data-stu-id="f73e0-129">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="f73e0-130">Ten składnik zestawu SDK udostępnionego jest zestaw obiektów docelowych i skojarzonych zadań, które są odpowiedzialne za kompilacji kodu, publikowania go, pakowania pakietów NuGet i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="f73e0-130">This shared SDK component is a set of targets and associated tasks that are responsible for compiling code, publishing it, packing NuGet packages, and so on.</span></span> <span data-ttu-id="f73e0-131">.NET Core SDK jest open-source i jest dostępny na GitHub na [repozytorium SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="f73e0-131">The .NET Core SDK is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span>

> [!NOTE]
> <span data-ttu-id="f73e0-132">"Target" to termin MSBuild, który wskazuje nazwaną operację, którą może wywołać msbuild.</span><span class="sxs-lookup"><span data-stu-id="f73e0-132">A "target" is an MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="f73e0-133">Zwykle jest w połączeniu z jednym lub więcej zadań, które wykonują niektóre logiki, które ma zrobić.</span><span class="sxs-lookup"><span data-stu-id="f73e0-133">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="f73e0-134">MSBuild obsługuje wiele gotowych `Copy` celów, takich jak lub `Execute`; umożliwia również użytkownikom pisanie własnych zadań przy użyciu kodu zarządzanego i definiowanie obiektów docelowych do wykonywania tych zadań.</span><span class="sxs-lookup"><span data-stu-id="f73e0-134">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="f73e0-135">Aby uzyskać więcej informacji, zobacz [Zadania MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="f73e0-135">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span>

<span data-ttu-id="f73e0-136">Wszystkie zestawy narzędzi zużywają teraz składnik zestawu SDK udostępnionego i jego obiekty docelowe, w tym interfejsu wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="f73e0-136">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="f73e0-137">Na przykład visual studio 2019 nie `dotnet restore` wywołanie polecenia, aby przywrócić zależności dla projektów .NET Core.</span><span class="sxs-lookup"><span data-stu-id="f73e0-137">For example, Visual Studio 2019 doesn't call into the `dotnet restore` command to restore dependencies for .NET Core projects.</span></span> <span data-ttu-id="f73e0-138">Zamiast tego używa bezpośrednio obiektu docelowego "Przywróć".</span><span class="sxs-lookup"><span data-stu-id="f73e0-138">Instead, it uses the "Restore" target directly.</span></span> <span data-ttu-id="f73e0-139">Ponieważ są to obiekty docelowe MSBuild, można również użyć nieprzetworzonego MSBuild do ich wykonania za pomocą polecenia [dotnet msbuild.](dotnet-msbuild.md)</span><span class="sxs-lookup"><span data-stu-id="f73e0-139">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span>

### <a name="cli-commands"></a><span data-ttu-id="f73e0-140">Polecenia interfejsu wiersza polecenia</span><span class="sxs-lookup"><span data-stu-id="f73e0-140">CLI commands</span></span>

<span data-ttu-id="f73e0-141">Składnik udostępnionego zestawie SDK oznacza, że większość istniejących poleceń interfejsu wiersza polecenia została ponownie zaimplementowana jako zadania i obiekty docelowe MSBuild.</span><span class="sxs-lookup"><span data-stu-id="f73e0-141">The shared SDK component means that the majority of existing CLI commands have been reimplemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="f73e0-142">Co to oznacza dla poleceń interfejsu wiersza polecenia i użycia zestawu narzędzi?</span><span class="sxs-lookup"><span data-stu-id="f73e0-142">What does this mean for the CLI commands and your usage of the toolset?</span></span>

<span data-ttu-id="f73e0-143">Z punktu widzenia użycia nie zmienia to sposobu korzystania z interfejsu wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="f73e0-143">From a usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="f73e0-144">Interfejs wiersza polecenia nadal ma podstawowe polecenia, które istniały w wersji .NET Core 1.0 Preview 2:</span><span class="sxs-lookup"><span data-stu-id="f73e0-144">The CLI still has the core commands that existed in the .NET Core 1.0 Preview 2 release:</span></span>

- `new`
- `restore`
- `run`
- `build`
- `publish`
- `test`
- `pack`

<span data-ttu-id="f73e0-145">Te polecenia nadal robią to, czego oczekujesz od nich (nowy projekt, zbuduj go, opublikuj, spakowaj i tak dalej).</span><span class="sxs-lookup"><span data-stu-id="f73e0-145">These commands still do what you expect them to do (new up a project, build it, publish it, pack it, and so on).</span></span> <span data-ttu-id="f73e0-146">Możesz zapoznać się z ekranem pomocy `dotnet <command> --help`polecenia (za pomocą) lub dokumentacją na tej stronie, aby zapoznać się z ich zachowaniem.</span><span class="sxs-lookup"><span data-stu-id="f73e0-146">You can consult either the command's help screen (using `dotnet <command> --help`) or documentation on this site to get familiar with their behavior.</span></span>

<span data-ttu-id="f73e0-147">Z punktu widzenia wykonania polecenia interfejsu wiersza polecenia przyjmują swoje parametry i konstruują wywołanie "nieprzetworzonego" MSBuild, który ustawia potrzebne właściwości i uruchamia żądany obiekt docelowy.</span><span class="sxs-lookup"><span data-stu-id="f73e0-147">From an execution perspective, the CLI commands take their parameters and construct a call to "raw" MSBuild that sets the needed properties and runs the desired target.</span></span> <span data-ttu-id="f73e0-148">Aby lepiej to zilustrować, należy wziąć pod uwagę następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="f73e0-148">To better illustrate this, consider the following command:</span></span>

   ```dotnetcli
   dotnet publish -o pub -c Release
   ```

<span data-ttu-id="f73e0-149">To polecenie publikuje aplikację `pub` w folderze przy użyciu konfiguracji "Zwolnij".</span><span class="sxs-lookup"><span data-stu-id="f73e0-149">This command publishes an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="f73e0-150">Wewnętrznie to polecenie zostanie przetłumaczone na następujące wywołanie MSBuild:</span><span class="sxs-lookup"><span data-stu-id="f73e0-150">Internally, this command gets translated into the following MSBuild invocation:</span></span>

   ```dotnetcli
   dotnet msbuild -t:Publish -p:OutputPath=pub -p:Configuration=Release
   ```

<span data-ttu-id="f73e0-151">Godnymi uwagi wyjątkami `new` od `run` tej reguły są polecenia i polecenia.</span><span class="sxs-lookup"><span data-stu-id="f73e0-151">Notable exceptions to this rule are the `new` and `run` commands.</span></span> <span data-ttu-id="f73e0-152">Nie zostały one zaimplementowane jako obiekty docelowe MSBuild.</span><span class="sxs-lookup"><span data-stu-id="f73e0-152">They have not been implemented as MSBuild targets.</span></span>

### <a name="implicit-restore"></a><span data-ttu-id="f73e0-153">Niejawne przywracanie</span><span class="sxs-lookup"><span data-stu-id="f73e0-153">Implicit restore</span></span>

[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
