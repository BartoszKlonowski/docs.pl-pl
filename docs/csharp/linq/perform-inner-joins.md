---
title: "Wykonanie sprzężeń wewnętrznych"
description: "Jak wykonanie sprzężeń wewnętrznych."
keywords: .NET, .NET core, C#
author: BillWagner
manager: wpickett
ms.author: wiwagn
ms.date: 12/1/2016
ms.topic: article
ms.prod: .net
ms.technology: devlang-csharp
ms.assetid: 45bceed6-f549-4114-a9b1-b44feb497742
ms.openlocfilehash: fdf75c0b7195742bdce70566ebb3880bb0565f31
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/21/2017
---
# <a name="perform-inner-joins"></a><span data-ttu-id="1e95b-104">Wykonanie sprzężeń wewnętrznych</span><span class="sxs-lookup"><span data-stu-id="1e95b-104">Perform inner joins</span></span>

<span data-ttu-id="1e95b-105">W warunkach relacyjnej bazy danych *sprzężenia wewnętrznego* tworzy zestaw wyników, w którym każdy element pierwsza kolekcja pojawia się jeden raz dla każdego pasującego elementu w kolekcji drugiego.</span><span class="sxs-lookup"><span data-stu-id="1e95b-105">In relational database terms, an *inner join* produces a result set in which each element of the first collection appears one time for every matching element in the second collection.</span></span> <span data-ttu-id="1e95b-106">Jeśli element pierwsza kolekcja nie ma żadnych zgodnych elementów, nie jest widoczna w zestawie wyników.</span><span class="sxs-lookup"><span data-stu-id="1e95b-106">If an element in the first collection has no matching elements, it does not appear in the result set.</span></span> <span data-ttu-id="1e95b-107"><xref:System.Linq.Enumerable.Join%2A> Metodę, która jest wywoływana przez `join` klauzuli w języku C#, wykonuje sprzężenie wewnętrzne.</span><span class="sxs-lookup"><span data-stu-id="1e95b-107">The <xref:System.Linq.Enumerable.Join%2A> method, which is called by the `join` clause in C#, implements an inner join.</span></span>  
  
 <span data-ttu-id="1e95b-108">W tym temacie pokazano, jak wykonać cztery odmiany sprzężenia wewnętrznego:</span><span class="sxs-lookup"><span data-stu-id="1e95b-108">This topic shows you how to perform four variations of an inner join:</span></span>  
  
-   <span data-ttu-id="1e95b-109">Proste sprzężenie wewnętrzne są powiązane elementy z dwóch źródeł danych na podstawie prostego klucza.</span><span class="sxs-lookup"><span data-stu-id="1e95b-109">A simple inner join that correlates elements from two data sources based on a simple key.</span></span>  
  
-   <span data-ttu-id="1e95b-110">Sprzężenie wewnętrzne, które są powiązane elementy z dwóch źródeł danych na podstawie *złożonego* klucza.</span><span class="sxs-lookup"><span data-stu-id="1e95b-110">An inner join that correlates elements from two data sources based on a *composite* key.</span></span> <span data-ttu-id="1e95b-111">Klucz złożony, który jest klucz, który składa się z więcej niż jedną wartość, umożliwia korelowanie elementy na podstawie więcej niż jednej właściwości.</span><span class="sxs-lookup"><span data-stu-id="1e95b-111">A composite key, which is a key that consists of more than one value, enables you to correlate elements based on more than one property.</span></span>  
  
-   <span data-ttu-id="1e95b-112">A *wielu sprzężenia* które sprzężenia kolejnych operacji są dołączane do siebie.</span><span class="sxs-lookup"><span data-stu-id="1e95b-112">A *multiple join* in which successive join operations are appended to each other.</span></span>  
  
-   <span data-ttu-id="1e95b-113">Sprzężenie wewnętrzne jest implementowane za pomocą sprzężenia grupy.</span><span class="sxs-lookup"><span data-stu-id="1e95b-113">An inner join that is implemented by using a group join.</span></span>  
  
## <a name="example"></a><span data-ttu-id="1e95b-114">Przykład</span><span class="sxs-lookup"><span data-stu-id="1e95b-114">Example</span></span>  
  
## <a name="simple-key-join-example"></a><span data-ttu-id="1e95b-115">Prosty przykład klucza</span><span class="sxs-lookup"><span data-stu-id="1e95b-115">Simple key join example</span></span>  
 <span data-ttu-id="1e95b-116">Poniższy przykład tworzy dwie kolekcje, które zawierają obiekty dwa typy zdefiniowane przez użytkownika, `Person` i `Pet`.</span><span class="sxs-lookup"><span data-stu-id="1e95b-116">The following example creates two collections that contain objects of two user-defined types, `Person` and `Pet`.</span></span> <span data-ttu-id="1e95b-117">Zapytanie używa `join` klauzuli w języku C#, aby dopasować `Person` obiekty z `Pet` obiekty, których `Owner` jest to, że `Person`.</span><span class="sxs-lookup"><span data-stu-id="1e95b-117">The query uses the `join` clause in C# to match `Person` objects with `Pet` objects whose `Owner` is that `Person`.</span></span> <span data-ttu-id="1e95b-118">`select` Klauzuli w języku C# definiuje wygląd obiektach wynikowych.</span><span class="sxs-lookup"><span data-stu-id="1e95b-118">The `select` clause in C# defines how the resulting objects will look.</span></span> <span data-ttu-id="1e95b-119">W tym przykładzie obiekty wynikowe są typy anonimowe, które składają się z imieniem właściciela i zwierzaka.</span><span class="sxs-lookup"><span data-stu-id="1e95b-119">In this example the resulting objects are anonymous types that consist of the owner's first name and the pet's name.</span></span>  
  
 [!code-csharp[CsLINQProgJoining#1](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_1.cs)]  
  
 <span data-ttu-id="1e95b-120">Należy pamiętać, że `Person` którego `LastName` jest "Huff" nie ma zestawu wyników, ponieważ istnieje nie `Pet` obiektu, który ma `Pet.Owner` równą `Person`.</span><span class="sxs-lookup"><span data-stu-id="1e95b-120">Note that the `Person` object whose `LastName` is "Huff" does not appear in the result set because there is no `Pet` object that has `Pet.Owner` equal to that `Person`.</span></span>  
  
## <a name="example"></a><span data-ttu-id="1e95b-121">Przykład</span><span class="sxs-lookup"><span data-stu-id="1e95b-121">Example</span></span>  
  
## <a name="composite-key-join-example"></a><span data-ttu-id="1e95b-122">Przykład sprzężenia klucza złożonego</span><span class="sxs-lookup"><span data-stu-id="1e95b-122">Composite key join example</span></span>  
 <span data-ttu-id="1e95b-123">Zamiast korelowanie elementy oparte na tylko jedną właściwość, możesz użyć klucza złożonego do porównywania elementów na podstawie wielu właściwości.</span><span class="sxs-lookup"><span data-stu-id="1e95b-123">Instead of correlating elements based on just one property, you can use a composite key to compare elements based on multiple properties.</span></span> <span data-ttu-id="1e95b-124">Aby to zrobić, należy określić funkcja selektora kluczy dla każdej kolekcji zwrócić typu anonimowego, która składa się z właściwości, które chcesz porównać.</span><span class="sxs-lookup"><span data-stu-id="1e95b-124">To do this, specify the key selector function for each collection to return an anonymous type that consists of the properties you want to compare.</span></span> <span data-ttu-id="1e95b-125">Jeśli etykieta właściwości, w obrębie typu anonimowego każdego klucza muszą mieć taką samą etykietę.</span><span class="sxs-lookup"><span data-stu-id="1e95b-125">If you label the properties, they must have the same label in each key's anonymous type.</span></span> <span data-ttu-id="1e95b-126">Właściwości musi również występować w tej samej kolejności.</span><span class="sxs-lookup"><span data-stu-id="1e95b-126">The properties must also appear in the same order.</span></span>  
  
 <span data-ttu-id="1e95b-127">W poniższym przykładzie użyto listę `Employee` obiektów oraz listę `Student` określają pracowników, którzy są również studentów obiekty.</span><span class="sxs-lookup"><span data-stu-id="1e95b-127">The following example uses a list of `Employee` objects and a list of `Student` objects to determine which employees are also students.</span></span> <span data-ttu-id="1e95b-128">Oba typy mają `FirstName` i `LastName` właściwości typu <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="1e95b-128">Both of these types have a `FirstName` and a `LastName` property of type <xref:System.String>.</span></span> <span data-ttu-id="1e95b-129">Funkcje, które tworzenia kluczy sprzężenia od każdej listy elementów zwracają typu anonimowego, która składa się z `FirstName` i `LastName` właściwości każdego elementu.</span><span class="sxs-lookup"><span data-stu-id="1e95b-129">The functions that create the join keys from each list's elements return an anonymous type that consists of the `FirstName` and `LastName` properties of each element.</span></span> <span data-ttu-id="1e95b-130">Operacji tworzenia sprzężenia porównuje te klucze złożone równości i zwraca pary obiektów z każdej listy, jeśli zarówno imię i nazwisko są takie same.</span><span class="sxs-lookup"><span data-stu-id="1e95b-130">The join operation compares these composite keys for equality and returns pairs of objects from each list where both the first name and the last name match.</span></span>  
  
 [!code-csharp[CsLINQProgJoining#2](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_2.cs)]  
  
## <a name="example"></a><span data-ttu-id="1e95b-131">Przykład</span><span class="sxs-lookup"><span data-stu-id="1e95b-131">Example</span></span>  
  
## <a name="multiple-join-example"></a><span data-ttu-id="1e95b-132">Przykład wielu</span><span class="sxs-lookup"><span data-stu-id="1e95b-132">Multiple join example</span></span>  
 <span data-ttu-id="1e95b-133">Dowolna liczba operacji łączenia można dołączać do siebie do wykonywania wielu sprzężenia.</span><span class="sxs-lookup"><span data-stu-id="1e95b-133">Any number of join operations can be appended to each other to perform a multiple join.</span></span> <span data-ttu-id="1e95b-134">Każdy `join` klauzuli w języku C# skorelowany określonego źródła danych z wynikami poprzedniej sprzężenia.</span><span class="sxs-lookup"><span data-stu-id="1e95b-134">Each `join` clause in C# correlates a specified data source with the results of the previous join.</span></span>  
  
 <span data-ttu-id="1e95b-135">Poniższy przykład tworzy trzech zbiorów: Lista `Person` obiektów, listę `Cat` obiektów oraz listę `Dog` obiektów.</span><span class="sxs-lookup"><span data-stu-id="1e95b-135">The following example creates three collections: a list of `Person` objects, a list of `Cat` objects, and a list of `Dog` objects.</span></span>  
  
 <span data-ttu-id="1e95b-136">Pierwszy `join` osób i kotów na podstawie klauzuli w języku C# zgodne `Person` dopasowywanie obiektu `Cat.Owner`.</span><span class="sxs-lookup"><span data-stu-id="1e95b-136">The first `join` clause in C# matches people and cats based on a `Person` object matching `Cat.Owner`.</span></span> <span data-ttu-id="1e95b-137">Zwraca sekwencję typy anonimowe, które zawierają `Person` obiektu i `Cat.Name`.</span><span class="sxs-lookup"><span data-stu-id="1e95b-137">It returns a sequence of anonymous types that contain the `Person` object and `Cat.Name`.</span></span>  
  
 <span data-ttu-id="1e95b-138">Drugi `join` klauzuli w języku C# są powiązane typy anonimowe zwrócony przez pierwsze sprzężenie z `Dog` obiektów w podanej listy skalary, oparte na klucz złożony, który składa się z `Owner` właściwość typu `Person`, a pierwszy litera nazwy zwierzęcia.</span><span class="sxs-lookup"><span data-stu-id="1e95b-138">The second `join` clause in C# correlates the anonymous types returned by the first join with `Dog` objects in the supplied list of dogs, based on a composite key that consists of the `Owner` property of type `Person`, and the first letter of the animal's name.</span></span> <span data-ttu-id="1e95b-139">Zwraca sekwencję typy anonimowe, które zawierają `Cat.Name` i `Dog.Name` z każdej pary dopasowania właściwości.</span><span class="sxs-lookup"><span data-stu-id="1e95b-139">It returns a sequence of anonymous types that contain the `Cat.Name` and `Dog.Name` properties from each matching pair.</span></span> <span data-ttu-id="1e95b-140">Ponieważ jest to sprzężenie wewnętrzne, zwracane są tylko te obiekty z pierwszego źródła danych, które mają odpowiednika w drugiej źródła danych.</span><span class="sxs-lookup"><span data-stu-id="1e95b-140">Because this is an inner join, only those objects from the first data source that have a match in the second data source are returned.</span></span>  
  
 [!code-csharp[CsLINQProgJoining#3](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_3.cs)]  
  
## <a name="example"></a><span data-ttu-id="1e95b-141">Przykład</span><span class="sxs-lookup"><span data-stu-id="1e95b-141">Example</span></span>  
  
## <a name="inner-join-by-using-grouped-join-example"></a><span data-ttu-id="1e95b-142">Sprzężenie wewnętrzne przy użyciu grupowanych przykład</span><span class="sxs-lookup"><span data-stu-id="1e95b-142">Inner join by using grouped join example</span></span>  
 <span data-ttu-id="1e95b-143">Poniższy przykład przedstawia sposobu wdrażania sprzężenie wewnętrzne za pomocą funkcji łączenia grupy.</span><span class="sxs-lookup"><span data-stu-id="1e95b-143">The following example shows you how to implement an inner join by using a group join.</span></span>  
  
 <span data-ttu-id="1e95b-144">W `query1`, listę `Person` obiektów jest przyłączony do grupy na liście `Pet` obiektów na podstawie `Person` dopasowania `Pet.Owner` właściwości.</span><span class="sxs-lookup"><span data-stu-id="1e95b-144">In `query1`, the list of `Person` objects is group-joined to the list of `Pet` objects based on the `Person` matching the `Pet.Owner` property.</span></span> <span data-ttu-id="1e95b-145">Dołącz do grupy tworzy kolekcję grup pośrednich, gdy każda grupa składa się z `Person` obiekt i sekwencji zgodnych `Pet` obiektów.</span><span class="sxs-lookup"><span data-stu-id="1e95b-145">The group join creates a collection of intermediate groups, where each group consists of a `Person` object and a sequence of matching `Pet` objects.</span></span>  
  
 <span data-ttu-id="1e95b-146">Dodając drugiej `from` klauzuli zapytanie, ta sekwencja sekwencji jest łączyć (lub jako spłaszczone) w jedną sekwencję dłużej.</span><span class="sxs-lookup"><span data-stu-id="1e95b-146">By adding a second `from` clause to the query, this sequence of sequences is combined (or flattened) into one longer sequence.</span></span> <span data-ttu-id="1e95b-147">Typ elementu końcowego sekwencji jest określany przez `select` klauzuli.</span><span class="sxs-lookup"><span data-stu-id="1e95b-147">The type of the elements of the final sequence is specified by the `select` clause.</span></span> <span data-ttu-id="1e95b-148">W tym przykładzie, że typ jest typu anonimowego, która składa się z `Person.FirstName` i `Pet.Name` właściwości dla każdej pary dopasowania.</span><span class="sxs-lookup"><span data-stu-id="1e95b-148">In this example, that type is an anonymous type that consists of the `Person.FirstName` and `Pet.Name` properties for each matching pair.</span></span>  
  
 <span data-ttu-id="1e95b-149">Wynik `query1` jest odpowiednikiem zestaw wyników, który może uzyskać za pomocą `join` klauzuli bez `into` klauzuli do wykonania sprzężenia wewnętrznego.</span><span class="sxs-lookup"><span data-stu-id="1e95b-149">The result of `query1` is equivalent to the result set that would have been obtained by using the `join` clause without the `into` clause to perform an inner join.</span></span> <span data-ttu-id="1e95b-150">`query2` Zmiennej pokazano to odpowiednik zapytanie.</span><span class="sxs-lookup"><span data-stu-id="1e95b-150">The `query2` variable demonstrates this equivalent query.</span></span>  
  
 [!code-csharp[CsLINQProgJoining#4](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_4.cs)]  
  
## <a name="see-also"></a><span data-ttu-id="1e95b-151">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="1e95b-151">See also</span></span>  
 <xref:System.Linq.Enumerable.Join%2A>  
 <xref:System.Linq.Enumerable.GroupJoin%2A>  
 [<span data-ttu-id="1e95b-152">Wykonanie sprzężeń grupowanych</span><span class="sxs-lookup"><span data-stu-id="1e95b-152">Perform grouped joins</span></span>](perform-grouped-joins.md)  
 [<span data-ttu-id="1e95b-153">Wykonanie lewych sprzężeń zewnętrznych</span><span class="sxs-lookup"><span data-stu-id="1e95b-153">Perform left outer joins</span></span>](perform-left-outer-joins.md)  
 [<span data-ttu-id="1e95b-154">Typy anonimowe</span><span class="sxs-lookup"><span data-stu-id="1e95b-154">Anonymous types</span></span>](../programming-guide/classes-and-structs/anonymous-types.md)  
 
