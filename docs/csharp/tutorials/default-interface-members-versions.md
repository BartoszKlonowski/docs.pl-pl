---
title: Bezpiecznie aktualizować przy użyciu domyślnego interfejsu członków w interfejsachC#
description: Ta zaawansowana w tym samouczku przedstawiono sposób można bezpiecznie dodać nowe możliwości do istniejących definicji interfejsu bez przerywania wszystkich klas i struktur, które implementują ten interfejs.
ms.date: 05/06/2019
ms.custom: mvc
ms.openlocfilehash: 2daa40ead5902454c6d45390233e1491fe6d369b
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/19/2019
ms.locfileid: "65877915"
---
# <a name="tutorial-update-interfaces-with-default-interface-members-in-c-80"></a><span data-ttu-id="73964-103">Samouczek: Zaktualizuj interfejsów przy użyciu domyślnego interfejsu członków w C# 8.0</span><span class="sxs-lookup"><span data-stu-id="73964-103">Tutorial: Update interfaces with default interface members in C# 8.0</span></span>

<span data-ttu-id="73964-104">Począwszy od C# 8.0 w programie .NET Core 3.0, można zdefiniować implementację przy deklarowaniu składową interfejsu.</span><span class="sxs-lookup"><span data-stu-id="73964-104">Beginning with C# 8.0 on .NET Core 3.0, you can define an implementation when you declare a member of an interface.</span></span> <span data-ttu-id="73964-105">Najbardziej typowym scenariuszem jest bezpiecznie dodać elementy członkowskie do interfejsu już ogólnie dostępnych i używanych przez niezliczone klientów.</span><span class="sxs-lookup"><span data-stu-id="73964-105">The most common scenario is to safely add members to an interface already released and used by innumerable clients.</span></span>

<span data-ttu-id="73964-106">W tym samouczku dowiesz się, jak:</span><span class="sxs-lookup"><span data-stu-id="73964-106">In this tutorial, you'll learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="73964-107">Bezpiecznie Rozszerz interfejsów przez dodanie metod z implementacji.</span><span class="sxs-lookup"><span data-stu-id="73964-107">Extend interfaces safely by adding methods with implementations.</span></span>
> * <span data-ttu-id="73964-108">Tworzenie sparametryzowanych implementacji, aby umożliwić większą elastyczność.</span><span class="sxs-lookup"><span data-stu-id="73964-108">Create parameterized implementations to provide greater flexibility.</span></span>
> * <span data-ttu-id="73964-109">Włącz implementacji w celu zapewnienia bardziej szczegółowe implementacji w formie zastąpienia.</span><span class="sxs-lookup"><span data-stu-id="73964-109">Enable implementers to provide a more specific implementation in the form of an override.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="73964-110">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="73964-110">Prerequisites</span></span>

<span data-ttu-id="73964-111">Należy skonfigurować komputer do uruchamiania platformę .NET Core, w tym C# kompilatora 8.0 (wersja zapoznawcza).</span><span class="sxs-lookup"><span data-stu-id="73964-111">You’ll need to set up your machine to run .NET Core, including the C# 8.0 preview compiler.</span></span> <span data-ttu-id="73964-112">C# 8.0 kompilatora w wersji zapoznawczej jest dostępna, począwszy od [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019), lub r [.NET Core 3.0 (wersja zapoznawcza) zestawu SDK](https://dotnet.microsoft.com/download/dotnet-core/3.0).</span><span class="sxs-lookup"><span data-stu-id="73964-112">The C# 8.0 preview compiler is available starting with [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019), or the latest [.NET Core 3.0 preview SDK](https://dotnet.microsoft.com/download/dotnet-core/3.0).</span></span> <span data-ttu-id="73964-113">Domyślne elementy członkowskie z interfejsu są dostępne począwszy od programu .NET Core 3.0 w wersji zapoznawczej 4.</span><span class="sxs-lookup"><span data-stu-id="73964-113">Default interface members are available beginning with .NET Core 3.0 preview 4.</span></span>

## <a name="scenario-overview"></a><span data-ttu-id="73964-114">Omówienie scenariusza</span><span class="sxs-lookup"><span data-stu-id="73964-114">Scenario overview</span></span>

<span data-ttu-id="73964-115">Ten samouczek rozpoczyna się od wersji 1 bibliotekę klienta relacji.</span><span class="sxs-lookup"><span data-stu-id="73964-115">This tutorial starts with version 1 of a customer relationship library.</span></span> <span data-ttu-id="73964-116">Aplikacja startowa można uzyskać naszych [przykłady repozytorium w serwisie GitHub](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/starter/customer-relationship).</span><span class="sxs-lookup"><span data-stu-id="73964-116">You can get the starter application on our [samples repo on GitHub](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/starter/customer-relationship).</span></span> <span data-ttu-id="73964-117">Firmy, która wbudowana tę bibliotekę przeznaczone klienci z istniejącymi aplikacjami przyjęcie ich biblioteki.</span><span class="sxs-lookup"><span data-stu-id="73964-117">The company that built this library intended customers with existing applications to adopt their library.</span></span> <span data-ttu-id="73964-118">Definicje minimalny interfejs dla użytkowników w ich biblioteki, aby zaimplementować one udostępniane.</span><span class="sxs-lookup"><span data-stu-id="73964-118">They provided minimal interface definitions for users of their library to implement.</span></span> <span data-ttu-id="73964-119">Poniżej znajduje się definicja interfejsu dla klienta:</span><span class="sxs-lookup"><span data-stu-id="73964-119">Here's the interface definition for a customer:</span></span>

[!code-csharp[InitialCustomerInterface](~/samples/csharp/tutorials/default-interface-members-versions/starter/customer-relationship/ICustomer.cs?name=SnippetICustomerVersion1)]

<span data-ttu-id="73964-120">Drugi interfejs, który reprezentuje kolejność one zdefiniowane:</span><span class="sxs-lookup"><span data-stu-id="73964-120">They defined a second interface that represents an order:</span></span>

[!code-csharp[InitialOrderInterface](~/samples/csharp/tutorials/default-interface-members-versions/starter/customer-relationship/IOrder.cs?name=SnippetIorderVersion1)]

<span data-ttu-id="73964-121">Z tych interfejsów zespołu można utworzyć biblioteki dla swoich użytkowników tworzyć lepsze środowisko dla swoich klientów.</span><span class="sxs-lookup"><span data-stu-id="73964-121">From those interfaces, the team could build a library for their users to create a better experience for their customers.</span></span> <span data-ttu-id="73964-122">Ich celem było utworzyć relację bardziej istniejących klientów i poprawy relacji między nimi przy użyciu nowych klientów.</span><span class="sxs-lookup"><span data-stu-id="73964-122">Their goal was to create a deeper relationship with existing customers and improve their relationships with new customers.</span></span>

<span data-ttu-id="73964-123">Teraz nadszedł czas na uaktualnienie biblioteki dla następnej wersji.</span><span class="sxs-lookup"><span data-stu-id="73964-123">Now, it's time to upgrade the library for the next release.</span></span> <span data-ttu-id="73964-124">Jedna z pożądanych funkcji umożliwia rabat w wysokości lojalności dla użytkowników, którzy mają wiele zamówień.</span><span class="sxs-lookup"><span data-stu-id="73964-124">One of the requested features enables a loyalty discount for customers that have lots of orders.</span></span> <span data-ttu-id="73964-125">Ten nowy rabat lojalności stosowane zawsze, gdy klient tworzy zamówienie.</span><span class="sxs-lookup"><span data-stu-id="73964-125">This new loyalty discount gets applied whenever a customer makes an order.</span></span> <span data-ttu-id="73964-126">Określony rabat jest właściwością poszczególnych klientów.</span><span class="sxs-lookup"><span data-stu-id="73964-126">The specific discount is a property of each individual customer.</span></span> <span data-ttu-id="73964-127">Każda implementacja ICustomer można ustawić różne zasady dotyczące rabatowej lojalności.</span><span class="sxs-lookup"><span data-stu-id="73964-127">Each implementation of ICustomer can set different rules for the loyalty discount.</span></span> 

<span data-ttu-id="73964-128">Jest to najbardziej naturalny sposób, aby dodać tę funkcjonalność udoskonalenie `ICustomer` interfejs za pomocą metody do stosowania rabatów lojalnościowych.</span><span class="sxs-lookup"><span data-stu-id="73964-128">The most natural way to add this functionality is to enhance the `ICustomer` interface with a method to apply any loyalty discount.</span></span> <span data-ttu-id="73964-129">Tę sugestię w projekt przyczyny dotyczą między doświadczonych deweloperów: "Interfejsy są niezmienne po po udostępnieniu!</span><span class="sxs-lookup"><span data-stu-id="73964-129">This design suggestion caused concern among experienced developers: "Interfaces are immutable once they've been released!</span></span> <span data-ttu-id="73964-130">To jest istotną zmianę!"</span><span class="sxs-lookup"><span data-stu-id="73964-130">This is a breaking change!"</span></span> <span data-ttu-id="73964-131">C#dodaje 8.0 *domyślne implementacje interfejsu* dla uaktualnienie interfejsów.</span><span class="sxs-lookup"><span data-stu-id="73964-131">C# 8.0 adds *default interface implementations* for upgrading interfaces.</span></span> <span data-ttu-id="73964-132">Autorzy biblioteki można dodawać nowych członków do interfejsu i udostępnia domyślną implementację dla tych członków.</span><span class="sxs-lookup"><span data-stu-id="73964-132">The library authors can add new members to the interface and provide a default implementation for those members.</span></span>

<span data-ttu-id="73964-133">Implementacje interfejsu domyślne umożliwiają deweloperom uaktualnienie interfejsu, ograniczając wszelkie implementors przesłonić tę implementację.</span><span class="sxs-lookup"><span data-stu-id="73964-133">Default interface implementations enable developers to upgrade an interface while still enabling any implementors to override that implementation.</span></span> <span data-ttu-id="73964-134">Użytkownicy biblioteki może zaakceptować domyślną implementację zmian niepowodujących niezgodności.</span><span class="sxs-lookup"><span data-stu-id="73964-134">Users of the library can accept the default implementation as a non-breaking change.</span></span> <span data-ttu-id="73964-135">Jeśli ich reguły biznesowe są różne, można zastąpić.</span><span class="sxs-lookup"><span data-stu-id="73964-135">If their business rules are different, they can override.</span></span>

## <a name="upgrade-with-default-interface-members"></a><span data-ttu-id="73964-136">Uaktualnienie przy użyciu domyślnego składowych interfejsu</span><span class="sxs-lookup"><span data-stu-id="73964-136">Upgrade with default interface members</span></span>

<span data-ttu-id="73964-137">Zespół Zgadzam się na najbardziej prawdopodobne Domyślna implementacja: Rabat w wysokości lojalności klientów.</span><span class="sxs-lookup"><span data-stu-id="73964-137">The team agreed on the most likely default implementation: a loyalty discount for customers.</span></span>

<span data-ttu-id="73964-138">Uaktualnienia należy udostępniają funkcje, które można ustawić dwie właściwości: liczba zamówień potrzebne kwalifikował się do rabat i procent rabatu.</span><span class="sxs-lookup"><span data-stu-id="73964-138">The upgrade should provide the functionality to set two properties: the number of orders needed to be eligible for the discount, and the percentage of the discount.</span></span> <span data-ttu-id="73964-139">Dzięki temu scenariusz doskonałe dla składowych interfejsu domyślnego.</span><span class="sxs-lookup"><span data-stu-id="73964-139">This makes it a perfect scenario for default interface members.</span></span> <span data-ttu-id="73964-140">Możesz dodać metodę do interfejsu ICustomer i najprawdopodobniej implementacji.</span><span class="sxs-lookup"><span data-stu-id="73964-140">You can add a method to the ICustomer interface, and provide the most likely implementation.</span></span> <span data-ttu-id="73964-141">Wszystkich istniejących i wszelkich nowych implementacji można użyć w implementacji domyślnej, lub podaj swoje własne.</span><span class="sxs-lookup"><span data-stu-id="73964-141">All existing, and any new implementations can use the default implementation, or provide their own.</span></span>

<span data-ttu-id="73964-142">Najpierw dodaj nową metodę implementacji:</span><span class="sxs-lookup"><span data-stu-id="73964-142">First, add the new method to the implementation:</span></span>

[!code-csharp[InitialOrderInterface](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/ICustomer.cs?name=SnippetLoyaltyDiscountVersionOne)]

<span data-ttu-id="73964-143">Tworzenie biblioteki napisał pierwszy test, aby sprawdzić wdrożenia:</span><span class="sxs-lookup"><span data-stu-id="73964-143">The library author wrote a first test to check the implementation:</span></span>

[!code-csharp[TestDefaultImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/Program.cs?name=SnippetTestDefaultImplementation)]

<span data-ttu-id="73964-144">Zwróć uwagę, następujące części testu:</span><span class="sxs-lookup"><span data-stu-id="73964-144">Notice the following portion of the test:</span></span>

[!code-csharp[TestDefaultImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/Program.cs?name=SnippetHighlightCast)]

<span data-ttu-id="73964-145">Który rzutowanie z elementu `SampleCustomer` do `ICustomer` jest konieczne.</span><span class="sxs-lookup"><span data-stu-id="73964-145">That cast from `SampleCustomer` to `ICustomer` is necessary.</span></span> <span data-ttu-id="73964-146">`SampleCustomer` Klasy nie musi dostarczyć implementację `ComputeLoyaltyDiscount`; która jest dostarczona przez `ICustomer` interfejsu.</span><span class="sxs-lookup"><span data-stu-id="73964-146">The `SampleCustomer` class doesn't need to provide an implementation for `ComputeLoyaltyDiscount`; that's provided by the `ICustomer` interface.</span></span> <span data-ttu-id="73964-147">Jednak `SampleCustomer` klasa nie dziedziczy członków z jego interfejsów.</span><span class="sxs-lookup"><span data-stu-id="73964-147">However, the `SampleCustomer` class doesn't inherit members from its interfaces.</span></span> <span data-ttu-id="73964-148">Tej reguły nie zmienił.</span><span class="sxs-lookup"><span data-stu-id="73964-148">That rule hasn't changed.</span></span> <span data-ttu-id="73964-149">Aby można było wywołać dowolną metodę zadeklarowana i zaimplementowane w interfejsie, zmienna musi być typu interfejsu, `ICustomer` w tym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="73964-149">In order to call any method declared and implemented in the interface, the variable must be the type of the interface, `ICustomer` in this example.</span></span>

## <a name="provide-parameterization"></a><span data-ttu-id="73964-150">Podaj parametryzacji</span><span class="sxs-lookup"><span data-stu-id="73964-150">Provide parameterization</span></span>

<span data-ttu-id="73964-151">To dobry początek.</span><span class="sxs-lookup"><span data-stu-id="73964-151">That's a good start.</span></span> <span data-ttu-id="73964-152">Jednak w implementacji domyślnej jest zbyt restrykcyjne.</span><span class="sxs-lookup"><span data-stu-id="73964-152">But, the default implementation is too restrictive.</span></span> <span data-ttu-id="73964-153">Wielu klientów tego systemu mogą wybrać progi różnią się dla liczby zakupów, innej długości członkostwa lub inny procent rabatu.</span><span class="sxs-lookup"><span data-stu-id="73964-153">Many consumers of this system may choose different thresholds for number of purchases, a different length of membership, or a different percentage discount.</span></span> <span data-ttu-id="73964-154">Możesz podać lepsze środowisko uaktualnienia większej liczby klientów, dzięki czemu można ustawić te parametry.</span><span class="sxs-lookup"><span data-stu-id="73964-154">You can provide a better upgrade experience for more customers by providing a way to set those parameters.</span></span> <span data-ttu-id="73964-155">Dodajmy statyczna metoda ustawia tych trzech parametrów, kontrolowanie domyślną implementację:</span><span class="sxs-lookup"><span data-stu-id="73964-155">Let's add a static method that sets those three parameters controlling the default implementation:</span></span>

[!code-csharp[VersionTwoImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/ICustomer.cs?name=SnippetLoyaltyDiscountVersionTwo)]

<span data-ttu-id="73964-156">Istnieje wiele nowych możliwości języka przedstawione w tym fragmencie mały kod.</span><span class="sxs-lookup"><span data-stu-id="73964-156">There's many new language capabilities shown in that small code fragment.</span></span> <span data-ttu-id="73964-157">Interfejsy mogą teraz zawierać statyczne elementy członkowskie, w tym pól i metod.</span><span class="sxs-lookup"><span data-stu-id="73964-157">Interfaces can now include static members, including fields and methods.</span></span> <span data-ttu-id="73964-158">Modyfikatory dostępu różnych również są włączone.</span><span class="sxs-lookup"><span data-stu-id="73964-158">Different access modifiers are also enabled.</span></span> <span data-ttu-id="73964-159">Dodatkowe pola są prywatne, nowa metoda jest publiczny.</span><span class="sxs-lookup"><span data-stu-id="73964-159">The additional fields are private, the new method is public.</span></span> <span data-ttu-id="73964-160">Dowolny modyfikatorów są dozwolone w składowych interfejsu.</span><span class="sxs-lookup"><span data-stu-id="73964-160">Any of the modifiers are allowed on interface members.</span></span>

<span data-ttu-id="73964-161">Aplikacje, które używają ogólny wzór dotyczących przeprowadzania obliczeń rabatu lojalności, ale różnych parametrów, trzeba podać implementacja niestandardowa; ustawiają argumenty za pośrednictwem metody statycznej.</span><span class="sxs-lookup"><span data-stu-id="73964-161">Applications that use the general formula for computing the loyalty discount, but different parameters, don't need to provide a custom implementation; they can set the arguments through a static method.</span></span> <span data-ttu-id="73964-162">Na przykład poniższy kod ustawia "Ocena klienta", który nagradza każdego klienta z więcej niż jeden miesiąc członkostwa:</span><span class="sxs-lookup"><span data-stu-id="73964-162">For example, the following code sets a "customer appreciation" that rewards any customer with more than one month's membership:</span></span>

[!code-csharp[SetLoyaltyThresholds](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/Program.cs?name=SnippetSetLoyaltyThresholds)]

## <a name="extend-the-default-implementation"></a><span data-ttu-id="73964-163">Rozszerzanie Domyślna implementacja</span><span class="sxs-lookup"><span data-stu-id="73964-163">Extend the default implementation</span></span>

<span data-ttu-id="73964-164">Kod, które zostały dodane do tej pory udostępnia wygodne implementacji dla tych scenariuszy, w której użytkownicy będą chcieli coś, np. Domyślna implementacja lub w celu udostępnienia niepowiązanych zbiór reguł.</span><span class="sxs-lookup"><span data-stu-id="73964-164">The code you've added so far has provided a convenient implementation for those scenarios where users want something like the default implementation, or to provide an unrelated set of rules.</span></span> <span data-ttu-id="73964-165">Dla funkcji powoduje końcowego umożliwia refaktoryzować kod nieco umożliwia scenariusze, w którym użytkownicy mogą chcieć tworzyć na domyślną implementację.</span><span class="sxs-lookup"><span data-stu-id="73964-165">For a final feature, let's refactor the code a bit to enable scenarios where users may want to build on the default implementation.</span></span> 

<span data-ttu-id="73964-166">Należy wziąć pod uwagę startowy, który chce przyciągnięcia nowych klientów.</span><span class="sxs-lookup"><span data-stu-id="73964-166">Consider a startup that wants to attract new customers.</span></span> <span data-ttu-id="73964-167">Oferują one 50% zniżki kolejność pierwszego nowego klienta.</span><span class="sxs-lookup"><span data-stu-id="73964-167">They offer a 50% discount off a new customer's first order.</span></span> <span data-ttu-id="73964-168">W przeciwnym razie istniejący klienci uzyskać rabat na wersję standard.</span><span class="sxs-lookup"><span data-stu-id="73964-168">Otherwise, existing customers get the standard discount.</span></span> <span data-ttu-id="73964-169">Tworzenie biblioteki musi przenieść domyślną implementację do `protected static` metody, który każdy klasy implementującej interfejs ten można ponownie użyć kodu w ich realizacji.</span><span class="sxs-lookup"><span data-stu-id="73964-169">The library author needs to move the default implementation into a `protected static` method so that any class implementing this interface can reuse the code in their implementation.</span></span> <span data-ttu-id="73964-170">Domyślna implementacja elementu członkowskiego interfejsu wywołuje ten udostępnionej metody:</span><span class="sxs-lookup"><span data-stu-id="73964-170">The default implementation of the interface member calls this shared method as well:</span></span>

[!code-csharp[VersionTwoImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/ICustomer.cs?name=SnippetFinalVersion)]

<span data-ttu-id="73964-171">W implementacji klasy, która implementuje ten interfejs zastępowania można wywołać metodę pomocnika statycznych i rozszerzyć tej logiki, aby zapewnić "nowego klienta" rabat w wysokości:</span><span class="sxs-lookup"><span data-stu-id="73964-171">In an implementation of a class that implements this interface, the override can call the static helper method, and extend that logic to provide the "new customer" discount:</span></span>

[!code-csharp[VersionTwoImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/SampleCustomer.cs?name=SnippetOverrideAndExtend)]

<span data-ttu-id="73964-172">Widać cały kod zakończenia w naszym [przykłady repozytorium w serwisie GitHub] (aplikacja startowa można uzyskać naszych [przykłady repozytorium w serwisie GitHub](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/finished/customer-relationship).</span><span class="sxs-lookup"><span data-stu-id="73964-172">You can see the entire finished code in our [samples repo on GitHub](You can get the starter application on our [samples repo on GitHub](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/finished/customer-relationship).</span></span>

<span data-ttu-id="73964-173">Te nowe funkcje oznacza, że interfejsy mogą być aktualizowane bezpiecznie po uzasadnione Domyślna implementacja dla tych nowych członków.</span><span class="sxs-lookup"><span data-stu-id="73964-173">These new features mean that interfaces can be updated safely when there's a reasonable default implementation for those new members.</span></span> <span data-ttu-id="73964-174">Dokładnie projektu interfejsach, express pojedynczego funkcjonalności pojęcia, które może być implementowana przez wiele klas.</span><span class="sxs-lookup"><span data-stu-id="73964-174">Carefully design interfaces to express single functional ideas that can be implemented by multiple classes.</span></span> <span data-ttu-id="73964-175">Ułatwia do uaktualnienia te definicje interfejsu, po odnalezieniu nowych wymagań dla tego samego idea funkcjonalności.</span><span class="sxs-lookup"><span data-stu-id="73964-175">That makes it easier to upgrade those interface definitions when new requirements are discovered for that same functional idea.</span></span>
