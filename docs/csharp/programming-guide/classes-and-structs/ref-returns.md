---
title: "Wartości zwracane ref i ref zmienne lokalne (Przewodnik C#)"
description: "Dowiedz się, jak zdefiniować i użyć zwracane ref i wartości lokalnej ref"
author: rpetrusha
ms.author: ronpet
ms.date: 05/30/2017
ms.topic: article
ms.prod: .net
ms.technology: devlang-csharp
ms.devlang: csharp
ms.assetid: 18cf7a4b-29f0-4b14-85b8-80af754aabd8
ms.openlocfilehash: 1d8fb092b578602b5d4f791a3fd14f47dfae1ba6
ms.sourcegitcommit: 7e99f66ef09d2903e22c789c67ff5a10aa953b2f
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/18/2017
---
# <a name="ref-returns-and-ref-locals"></a><span data-ttu-id="5ec1f-103">Zwraca ref i zmienne lokalne ref</span><span class="sxs-lookup"><span data-stu-id="5ec1f-103">Ref returns and ref locals</span></span>

<span data-ttu-id="5ec1f-104">Począwszy od C# 7, C# obsługuje zwracanych wartości odwołanie (ref zwraca).</span><span class="sxs-lookup"><span data-stu-id="5ec1f-104">Starting with C# 7, C# supports reference return values (ref returns).</span></span> <span data-ttu-id="5ec1f-105">Odwołanie zwracać wartość umożliwia metodę przywrócić odwołania do obiektu, a nie wartość, obiekt wywołujący.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-105">A reference return value allows a method to return a reference to an object, rather than a value, back to a caller.</span></span> <span data-ttu-id="5ec1f-106">Obiekt wywołujący możliwość Traktuj zwrócony obiekt zwrócony tak, jakby zwrócono według wartości lub według odwołania.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-106">The caller can then choose to treat the returned object returned as if it were returned by value or by reference.</span></span> <span data-ttu-id="5ec1f-107">Wartość zwracana przez odwołanie, czy element wywołujący obsługuje jako odwołanie, a nie wartość jest zmienna lokalna ref.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-107">A value returned by reference that the caller handles as a reference rather than a value is a ref local.</span></span>

## <a name="what-is-a-reference-return-value"></a><span data-ttu-id="5ec1f-108">Co to jest wartością zwracaną odwołania?</span><span class="sxs-lookup"><span data-stu-id="5ec1f-108">What is a reference return value?</span></span>

<span data-ttu-id="5ec1f-109">Deweloperzy większość zapoznali się z przekazywaniem argumentu metody wywołane *przez odwołanie*.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-109">Most developers are familiar with passing an argument to a called method *by reference*.</span></span> <span data-ttu-id="5ec1f-110">Argument wywołaną metodę się, że lista zawiera wartości przekazywane przez odwołanie, a wszelkie zmiany wprowadzone do jego wartości przez metodę o nazwie są zwracane do obiektu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-110">A called method's argument list includes a value passed by reference, and any changes made to its value by the called method are returned to the caller.</span></span> <span data-ttu-id="5ec1f-111">A *odwołania do wartości zwracanej* odwrotny:</span><span class="sxs-lookup"><span data-stu-id="5ec1f-111">A *reference return value* is the opposite:</span></span>

- <span data-ttu-id="5ec1f-112">Wywołana metoda zwracanej wartości, zamiast argument przekazany do niej, to odwołanie.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-112">The called method's return value, rather than an argument passed to it, is a reference.</span></span>

- <span data-ttu-id="5ec1f-113">Obiekt wywołujący, zamiast wywołaną metodę można zmodyfikować wartość zwrócona przez metodę.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-113">The caller, rather than the called method, can modify the value returned by the method.</span></span>

- <span data-ttu-id="5ec1f-114">Zamiast zmiany do argumentu, które zostaną odzwierciedlone w stan obiektu na element wywołujący zmiany w wartości zwracanej przez metodę przez obiekt wywołujący zostaną odzwierciedlone w stan obiektu, którego metoda została wywołana.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-114">Instead of modifications to the argument that are reflected in state of the object on the caller, modifications to the method's return value by the caller are reflected in the state of the object whose method was called.</span></span>

<span data-ttu-id="5ec1f-115">Odwołanie zwracane wartości można utworzyć mniejszych kodu, a także zezwala na udostępnianie tylko poszczególnych elementów danych, takich jak elementu tablicy interesujące do obiektu wywołującego obiektu.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-115">Reference return values can produce more compact code, as well as allow an object to expose only the individual data items, such as an array element, that are of interest to the caller.</span></span> <span data-ttu-id="5ec1f-116">Zmniejsza to prawdopodobieństwo wywołującego przypadkowo zmodyfikuje stan obiektu.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-116">This reduces the likelihood that the caller will inadvertently modify the object's state.</span></span>

<span data-ttu-id="5ec1f-117">Istnieją pewne ograniczenia na wartość, która może zwracać metoda jako wartości zwracane odwołanie.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-117">There are some restrictions on the value that a method can return as a reference return value.</span></span> <span data-ttu-id="5ec1f-118">Należą do nich następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="5ec1f-118">These include:</span></span>

- <span data-ttu-id="5ec1f-119">Wartość zwrotna nie może być `void`.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-119">The return value cannot be `void`.</span></span> <span data-ttu-id="5ec1f-120">Podjęto próbę zdefiniowania metody z `void` wartości zwracanej odwołanie generuje błąd kompilatora CS1547, "W tym kontekście nie można użyć słowa kluczowego"void"."</span><span class="sxs-lookup"><span data-stu-id="5ec1f-120">Attempting to define a method with a `void` reference return value generates compiler error CS1547, "Keyword 'void' cannot be used in this context."</span></span>
 
- <span data-ttu-id="5ec1f-121">Wartość zwrotna nie może być zmienną lokalną w metodzie, która zwraca musi mieć zakres, w którym znajduje się poza metodę, która zwraca go.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-121">The return value cannot be a local variable in the method that returns it; it must have a scope that is outside the method that returns it.</span></span> <span data-ttu-id="5ec1f-122">Można instancji lub pola statycznego w klasie lub może być argument przekazany do metody.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-122">It can be an instance or static field of a class, or it can be an argument passed to the method.</span></span> <span data-ttu-id="5ec1f-123">Próby zwracać zmiennej lokalnej generuje błąd kompilatora CS8168, "nie może zwracać lokalnego"obj"przez odwołanie, ponieważ nie jest zmienna lokalna ref."</span><span class="sxs-lookup"><span data-stu-id="5ec1f-123">Attempting to return a local variable generates compiler error CS8168, "Cannot return local 'obj' by reference because it is not a ref local."</span></span>

- <span data-ttu-id="5ec1f-124">Wartość zwrotna nie może być `null`.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-124">The return value cannot be a `null`.</span></span> <span data-ttu-id="5ec1f-125">Podjęto próbę zwracać `null` generuje błąd kompilatora CS8156 "nie można użyć wyrażenia w tym kontekście, ponieważ nie mogą być zwrócone przez odwołanie."</span><span class="sxs-lookup"><span data-stu-id="5ec1f-125">Attempting to return `null` generates compiler error CS8156, "An expression cannot be used in this context because it may not be returned by reference."</span></span>

   <span data-ttu-id="5ec1f-126">Jeśli metodę o ref zwracany musi zwracać wartość null, albo może zwracać wartości null (bez wystąpień) dla typu odwołania lub [typ dopuszczający wartość null](../nullable-types/index.md) dla typu wartości.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-126">If a method with a ref return needs to return a null value, you can either return a null (uninstantiated) value for a reference type or a [nullable type](../nullable-types/index.md) for a value type.</span></span>
 
- <span data-ttu-id="5ec1f-127">Wartość zwrotna nie może być stałą, elementu członkowskiego wyliczenia lub właściwości `class` lub `struct`.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-127">The return value cannot be a constant, an enumeration member, or a property of a `class` or `struct`.</span></span> <span data-ttu-id="5ec1f-128">Próba zwrócić te generuje błąd kompilatora CS8156 "nie można użyć wyrażenia w tym kontekście, ponieważ nie mogą być zwrócone przez odwołanie."</span><span class="sxs-lookup"><span data-stu-id="5ec1f-128">Attempting to return these generates compiler error CS8156, "An expression cannot be used in this context because it may not be returned by reference."</span></span>

<span data-ttu-id="5ec1f-129">Ponadto ponieważ może zwracać metodę asynchroniczną, zanim zakończy wykonywanie, gdy jego wartość zwracana jest nadal nieznany, odwołanie zwracane wartości są niedozwolone w metodach asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-129">In addition, because an asynchronous method may return before it has finished execution, while its return value is still unknown, reference return values are not allowed on async methods.</span></span>
 
## <a name="defining-a-ref-return-value"></a><span data-ttu-id="5ec1f-130">Definiowanie wartości zwracanej ref</span><span class="sxs-lookup"><span data-stu-id="5ec1f-130">Defining a ref return value</span></span>

<span data-ttu-id="5ec1f-131">Zdefiniuj ref wartości zwracanej przez dodanie [ref](../../language-reference/keywords/ref.md) — słowo kluczowe na zwracany typ sygnatury metody.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-131">You define a ref return value by adding the [ref](../../language-reference/keywords/ref.md) keyword to the return type of the method signature.</span></span> <span data-ttu-id="5ec1f-132">Na przykład następująca sygnatura wskazuje, że `GetContactInformation` właściwość zwraca odwołanie do `Person` obiektu do obiektu wywołującego:</span><span class="sxs-lookup"><span data-stu-id="5ec1f-132">For example, the following signature indicates that the `GetContactInformation` property returns a reference to a `Person` object to the caller:</span></span>

```csharp
public ref Person GetContactInformation(string fname, string lname);
```

<span data-ttu-id="5ec1f-133">Ponadto nazwa obiektu zwracaną przez każdy [zwracać](../../language-reference/keywords/return.md) instrukcji w treści metody musi być poprzedzona [ref](../../language-reference/keywords/ref.md) — słowo kluczowe.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-133">In addition, the name of the object returned by each [return](../../language-reference/keywords/return.md) statement in the method body must be preceded by the [ref](../../language-reference/keywords/ref.md) keyword.</span></span> <span data-ttu-id="5ec1f-134">Na przykład następująca `return` zwraca instrukcji `Person` obiektu o nazwie `p` przez odwołanie:</span><span class="sxs-lookup"><span data-stu-id="5ec1f-134">For example, the following `return` statement returns a `Person` object named `p` by reference:</span></span>

```csharp
return ref p;
```

## <a name="consuming-a-ref-return-value"></a><span data-ttu-id="5ec1f-135">Korzystanie z wartością zwracaną ref</span><span class="sxs-lookup"><span data-stu-id="5ec1f-135">Consuming a ref return value</span></span>

<span data-ttu-id="5ec1f-136">Obiekt wywołujący może obsłużyć ref wartości zwracanej w jeden z dwóch sposobów:</span><span class="sxs-lookup"><span data-stu-id="5ec1f-136">A caller can handle a ref return value in either of two ways:</span></span>

- <span data-ttu-id="5ec1f-137">Jako wartość zwykłej zwrócony przez wartości z metody.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-137">As an ordinary value returned by value from a method.</span></span> <span data-ttu-id="5ec1f-138">Obiekt wywołujący można zignorować, że zwracana wartość jest wartością zwracaną odwołania.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-138">The caller can choose to ignore that the return value is a reference return value.</span></span> <span data-ttu-id="5ec1f-139">W takim przypadku wszelkie zmiany wprowadzone do wartości zwróconej przez wywołanie metody nie są odzwierciedlane w stanie nazwie typu.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-139">In this case, any changes made to the value returned by the method call are not reflected in the state of the called type.</span></span> <span data-ttu-id="5ec1f-140">Zwrócona wartość jest typem wartości, wszelkie zmiany wprowadzone do wartości zwróconej przez wywołanie metody nie są odzwierciedlane w stanie nazwie typu.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-140">If the returned value is a value type, any changes made to the value returned by the method call are not reflected in the state of the called type.</span></span>

- <span data-ttu-id="5ec1f-141">Wartość zwracana jako odwołanie.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-141">As a reference return value.</span></span> <span data-ttu-id="5ec1f-142">Obiekt wywołujący musi definiować zmiennej, do której przypisany jest zwracana wartość odwołanie jako [lokalnej typu ref](#ref-local), a wartość zwrócona przez wywołanie metody wszelkie zmiany zostaną odzwierciedlone w stanie typu o nazwie.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-142">The caller must define the variable to which the reference return value is assigned as a [ref local](#ref-local), and any changes to the value returned by the method call are reflected in the state of the called type.</span></span> 

## <a name="ref-locals"></a><span data-ttu-id="5ec1f-143">Zmienne lokalne REF</span><span class="sxs-lookup"><span data-stu-id="5ec1f-143">Ref locals</span></span>

<span data-ttu-id="5ec1f-144">Do obsługi wartość zwracaną odwołanie jako odwołanie, wywołujący musi deklarować wartość *lokalnej typu ref* za pomocą `ref` — słowo kluczowe.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-144">To handle the reference return value as a reference, the caller must declare the value to be a *ref local* by using the `ref` keyword.</span></span> <span data-ttu-id="5ec1f-145">Na przykład, jeśli wartość zwracana przez `Person.GetContactInfomation` metody ma być używane jako odwołanie, a nie wartość, wywołanie metody ma postać:</span><span class="sxs-lookup"><span data-stu-id="5ec1f-145">For example, if the value returned by the `Person.GetContactInfomation` method is to be consumed as a reference rather than a value, the method call appears as:</span></span>

```csharp
ref Person p = ref contacts.GetContactInformation("Brandie", "Best");
```

<span data-ttu-id="5ec1f-146">Należy pamiętać, że `ref` słowo kluczowe jest używane zarówno przed deklaracji zmiennej lokalnej *i* przed wywołaniem metody.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-146">Note that the `ref` keyword is used both before the local variable declaration *and* before the method call.</span></span> <span data-ttu-id="5ec1f-147">Błąd zawiera zarówno `ref` słów kluczowych w deklaracji zmiennej i przypisania powoduje błąd kompilatora CS8172, "nie można zainicjować zmiennej dostępnej przez odwołanie o wartości."</span><span class="sxs-lookup"><span data-stu-id="5ec1f-147">Failure to include both `ref` keywords in the variable declaration and assignment results in compiler error CS8172, "Cannot initialize a by-reference variable with a value."</span></span> 
 
<span data-ttu-id="5ec1f-148">Kolejne zmiany do `Person` odzwierciedlone w obiekcie zwracanym przez metodę `contacts` obiektu.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-148">Subsequent changes to the `Person` object returned by the method are reflected in the `contacts` object.</span></span>

<span data-ttu-id="5ec1f-149">Jeśli `p` nie jest zdefiniowany jako zmienna lokalna ref przy użyciu `ref` — słowo kluczowe, wszelkie zmiany wprowadzone do `p` przez obiekt wywołujący nie są uwzględniane w `contacts` obiektu.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-149">If `p` is not defined as a ref local by using the `ref` keyword, any changes made to `p` by the caller are not reflected in the `contacts` object.</span></span>
 
## <a name="ref-returns-and-ref-locals-an-example"></a><span data-ttu-id="5ec1f-150">Zwraca ref i zmienne lokalne ref: przykład</span><span class="sxs-lookup"><span data-stu-id="5ec1f-150">Ref returns and ref locals: an example</span></span>

<span data-ttu-id="5ec1f-151">W poniższym przykładzie zdefiniowano `NumberStore` klasy, która przechowuje tablicę wartości będące liczbami całkowitymi.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-151">The following example defines a `NumberStore` class that stores an array of integer values.</span></span> <span data-ttu-id="5ec1f-152">`FindNumber` Metoda zwraca wartość przez odwołanie pierwsza liczba, która jest większa lub równa liczbie przekazanego jako argument.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-152">The `FindNumber` method returns by reference the first number that is greater than or equal to the number passed as an argument.</span></span> <span data-ttu-id="5ec1f-153">Jeśli żadna liczba jest większa niż lub równy argumentowi, metoda zwraca numer indeksu 0.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-153">If no number is greater than or equal to the argument, the method returns the number in index 0.</span></span> 

[!code-csharp[ref-returns](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#1)]

<span data-ttu-id="5ec1f-154">Następujące przykładowe wywołania `NumberStore.FindNumber` metoda pobierania pierwsza wartość, która jest większa niż lub równa 16.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-154">The following example calls the `NumberStore.FindNumber` method to retrieve the first value that is greater than or equal to 16.</span></span> <span data-ttu-id="5ec1f-155">Obiekt wywołujący następnie podwaja wartość zwrócona przez metodę.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-155">The caller then doubles the value returned by the method.</span></span> <span data-ttu-id="5ec1f-156">Jak dane wyjściowe w przykładzie pokazano, ta zmiana ta jest uwzględniana w wartości elementów tablicy `NumberStore` wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-156">As the output from the example shows, this change is reflected in the value of the array elements of the `NumberStore` instance.</span></span>

[!code-csharp[ref-returns](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#2)]

<span data-ttu-id="5ec1f-157">Takie działanie bez obsługi zwracanych wartości odwołania, zwykle odbywa się zwracając indeks elementu tablicy wraz z jego wartość.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-157">Without support for reference return values, such an operation is usually performed by returning the index of the array element along with its value.</span></span> <span data-ttu-id="5ec1f-158">Obiekt wywołujący następnie można użyć tego indeksu można zmodyfikować wartości w wywołaniu metody oddzielne.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-158">The caller can then use this index to modify the value in a separate method call.</span></span> <span data-ttu-id="5ec1f-159">Jednak wywołującego można również zmodyfikować indeks dostępu i możliwie zmodyfikować inne wartości w tablicy.</span><span class="sxs-lookup"><span data-stu-id="5ec1f-159">However, the caller can also modify the index to access and possibly modify other array values.</span></span>  
 
## <a name="see-also"></a><span data-ttu-id="5ec1f-160">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="5ec1f-160">See also</span></span>

[<span data-ttu-id="5ec1f-161">REF — słowo kluczowe</span><span class="sxs-lookup"><span data-stu-id="5ec1f-161">ref keyword</span></span>](../../language-reference/keywords/ref.md)
