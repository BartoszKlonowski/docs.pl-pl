---
title: 'Wskazówki: Tworzenie obiektów dynamicznych i posługiwanie się nimi (C# i Visual Basic)'
ms.date: 07/20/2015
dev_langs:
- csharp
- vb
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
ms.openlocfilehash: 8134a7c7c1f2c4e6432dd19889faf796a9284553
ms.sourcegitcommit: fd8d4587cc26e53f0e27e230d6e27d828ef4306b
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/16/2018
ms.locfileid: "49347971"
---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="c9eaf-102">Wskazówki: Tworzenie obiektów dynamicznych i posługiwanie się nimi (C# i Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="c9eaf-102">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>

<span data-ttu-id="c9eaf-103">Obiekty dynamiczne udostępnianie składowych, takich jak właściwości i metody w czasie wykonywania, zamiast w w czasie kompilacji.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-103">Dynamic objects expose members such as properties and methods at run time, instead of in at compile time.</span></span> <span data-ttu-id="c9eaf-104">Dzięki temu można utworzyć obiekty przeznaczone do pracy ze strukturami, które nie są zgodne, typu statycznego lub w formacie.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-104">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="c9eaf-105">Na przykład można użyć obiekt dynamiczny do odwołania HTML Document Object Model (DOM), który może zawierać dowolną kombinację prawidłowe elementów kodu znaczników HTML i atrybutów.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-105">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="c9eaf-106">Ponieważ każdy dokument HTML jest unikatowy, elementy członkowskie dla określonego dokumentu HTML są określane w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-106">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="c9eaf-107">Częstą metodą można odwoływać się do atrybutu elementu HTML jest przekazanie nazwę atrybutu, aby `GetProperty` metoda elementu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-107">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="c9eaf-108">Odwołania do `id` atrybutu elementu HTML `<div id="Div1">`, należy najpierw uzyskać odwołanie do `<div>` elementu, a następnie użyj `divElement.GetProperty("id")`.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-108">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="c9eaf-109">Jeśli używasz obiekt dynamiczny, można się odwołać `id` atrybutu jako `divElement.id`.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-109">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>  
  
 <span data-ttu-id="c9eaf-110">Obiekty dynamiczne również zapewniają wygodny dostęp do dynamicznego języków, takich jak IronPython i IronRuby.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-110">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="c9eaf-111">Obiekt dynamiczny służy do odwoływania się do dynamicznego skryptu, który jest interpretowany w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-111">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>  
  
 <span data-ttu-id="c9eaf-112">Obiekt dynamiczny odwoływać się za pomocą późnego wiązania.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-112">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="c9eaf-113">W języku C#, określ typ obiektu z późnym wiązaniem jako `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-113">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="c9eaf-114">W języku Visual Basic określić typ obiektu z późnym wiązaniem jako `Object`.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-114">In Visual Basic, you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="c9eaf-115">Aby uzyskać więcej informacji, zobacz [dynamiczne](../../../csharp/language-reference/keywords/dynamic.md) i [wczesnego a późne wiązanie](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="c9eaf-115">For more information, see [dynamic](../../../csharp/language-reference/keywords/dynamic.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>  
  
 <span data-ttu-id="c9eaf-116">Możesz tworzyć niestandardowe obiekty dynamiczne przy użyciu klas w <xref:System.Dynamic?displayProperty=nameWithType> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-116">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="c9eaf-117">Na przykład można utworzyć <xref:System.Dynamic.ExpandoObject> i określić elementy członkowskie tego obiektu w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-117">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="c9eaf-118">Można również utworzyć swój własny typ, który dziedziczy <xref:System.Dynamic.DynamicObject> klasy.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-118">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="c9eaf-119">Następnie można zastąpić elementów członkowskich <xref:System.Dynamic.DynamicObject> klasy, które umożliwiają korzystanie z funkcji dynamicznych w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-119">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>  
  
 <span data-ttu-id="c9eaf-120">W tym instruktażu wykonasz następujące zadania:</span><span class="sxs-lookup"><span data-stu-id="c9eaf-120">In this walkthrough you will perform the following tasks:</span></span>  
  
-   <span data-ttu-id="c9eaf-121">Utwórz niestandardowy obiekt, który dynamicznie udostępnia zawartość pliku tekstowego jako właściwości obiektu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-121">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>  
  
-   <span data-ttu-id="c9eaf-122">Utwórz projekt, który używa `IronPython` biblioteki.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-122">Create a project that uses an `IronPython` library.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="c9eaf-123">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="c9eaf-123">Prerequisites</span></span>  
<span data-ttu-id="c9eaf-124">Potrzebujesz [IronPython](http://ironpython.net/) dla platformy .NET w celu przeprowadzenia tego instruktażu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-124">You need [IronPython](http://ironpython.net/) for .NET to complete this walkthrough.</span></span> <span data-ttu-id="c9eaf-125">Przejdź do ich [strony pobierania](http://ironpython.net/download/) uzyskanie najnowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-125">Go to their [Download page](http://ironpython.net/download/) to obtain the latest version.</span></span>
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="c9eaf-126">Tworzenie niestandardowych obiektów dynamicznych</span><span class="sxs-lookup"><span data-stu-id="c9eaf-126">Creating a Custom Dynamic Object</span></span>

<span data-ttu-id="c9eaf-127">Pierwszy projekt, który zostanie utworzony w tym przewodniku definiuje niestandardowy obiekt dynamiczny, który wyszukuje zawartość pliku tekstowego.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-127">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="c9eaf-128">Tekst do wyszukania jest określony przez nazwę właściwości dynamicznych.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-128">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="c9eaf-129">Na przykład, jeśli wywołanie kodu Określa `dynamicFile.Sample`, klasa dynamiczne zwraca ogólnego listę ciągów zawierającą wszystkie wiersze z pliku, które zaczynają się od "Przykładowy".</span><span class="sxs-lookup"><span data-stu-id="c9eaf-129">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="c9eaf-130">Wyszukiwanie jest rozróżniana wielkość liter.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-130">The search is case-insensitive.</span></span> <span data-ttu-id="c9eaf-131">Klasa dynamiczna obsługuje również dwa argumenty opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-131">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="c9eaf-132">Pierwszy argument jest wartość wyliczenia opcji wyszukiwania, określający klasy dynamicznej powinno poszukać dopasowań na początku wiersza, koniec wiersza i w dowolnym miejscu w wierszu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-132">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="c9eaf-133">Drugi argument określa, czy klasy dynamicznej należy przyciąć spacje początkowe i końcowe z każdej linii przed wyszukiwaniem.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-133">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="c9eaf-134">Na przykład, jeśli wywołanie kodu Określa `dynamicFile.Sample(StringSearchOption.Contains)`, klasa dynamiczna wyszukuje "Przykładowy" dowolne miejsce w wierszu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-134">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="c9eaf-135">Jeśli wywołanie kodu Określa `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, klasa dynamiczna wyszukuje "Przykładowy" na początku każdego wiersza i nie powoduje usunięcia spacji wiodących i końcowych.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-135">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="c9eaf-136">Domyślne zachowanie klasy dynamicznych jest można wyszukiwać dopasowania na początku każdego wiersza i Usuń spacje początkowe i końcowe.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-136">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>  
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="c9eaf-137">Do tworzenia niestandardowych klas dynamicznych</span><span class="sxs-lookup"><span data-stu-id="c9eaf-137">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="c9eaf-138">Uruchom program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-138">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="c9eaf-139">Na **pliku** menu wskaż **New** a następnie kliknij przycisk **projektu**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-139">On the **File** menu, point to **New** and then click **Project**.</span></span>  
  
3.  <span data-ttu-id="c9eaf-140">W **nowy projekt** dialogowym **typów projektów** okienka, upewnij się, że **Windows** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-140">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="c9eaf-141">Wybierz **aplikację Konsolową** w **szablony** okienka.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-141">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="c9eaf-142">W **nazwa** wpisz `DynamicSample`, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-142">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="c9eaf-143">Nowy projekt zostanie utworzony.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-143">The new project is created.</span></span>  
  
4.  <span data-ttu-id="c9eaf-144">Kliknij prawym przyciskiem myszy projekt DynamicSample, a następnie wskaż **Dodaj**, a następnie kliknij przycisk **klasy**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-144">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="c9eaf-145">W **nazwa** wpisz `ReadOnlyFile`, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-145">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="c9eaf-146">Nowy plik zostanie dodany, który zawiera klasę ReadOnlyFile.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-146">A new file is added that contains the ReadOnlyFile class.</span></span>  
  
5.  <span data-ttu-id="c9eaf-147">W górnej części pliku ReadOnlyFile.cs lub ReadOnlyFile.vb, Dodaj następujący kod umożliwiający zaimportowanie <xref:System.IO?displayProperty=nameWithType> i <xref:System.Dynamic?displayProperty=nameWithType> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-147">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces.</span></span>  

    [!code-csharp[VbDynamicWalkthrough#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#1)]
    [!code-vb[VbDynamicWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#1)]  

6.  <span data-ttu-id="c9eaf-148">Niestandardowy obiekt dynamiczny używa wyliczeniem, aby określić kryteria wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-148">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="c9eaf-149">Przed instrukcją klasy Dodaj następującą definicję typu wyliczeniowego.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-149">Before the class statement, add the following enum definition.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#2)]
    [!code-vb[VbDynamicWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#2)]
  
7.  <span data-ttu-id="c9eaf-150">Aktualizuj class — instrukcja w celu odziedziczenia `DynamicObject` klasy, jak pokazano w poniższym przykładzie kodu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-150">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#3)]
    [!code-vb[VbDynamicWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#3)]

8.  <span data-ttu-id="c9eaf-151">Dodaj następujący kod do `ReadOnlyFile` klasy, aby zdefiniować pole prywatne dla ścieżki pliku i Konstruktor dla `ReadOnlyFile` klasy.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-151">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#4)]
    [!code-vb[VbDynamicWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#4)]
  
9. <span data-ttu-id="c9eaf-152">Dodaj następujący kod `GetPropertyValue` metody `ReadOnlyFile` klasy.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-152">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="c9eaf-153">`GetPropertyValue` Metoda przyjmuje jako dane wejściowe, kryteriów wyszukiwania i zwraca wiersze z pliku tekstowego plików spełniających i kryteria wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-153">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="c9eaf-154">Dynamiczne metod dostarczonych przez `ReadOnlyFile` klasy wywołania `GetPropertyValue` metoda pobierania ich odpowiednich wyników.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-154">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#5)]
    [!code-vb[VbDynamicWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#5)]  
  
10. <span data-ttu-id="c9eaf-155">Po `GetPropertyValue` metody, Dodaj następujący kod, aby zastąpić <xref:System.Dynamic.DynamicObject.TryGetMember%2A> metody <xref:System.Dynamic.DynamicObject> klasy.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-155">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="c9eaf-156"><xref:System.Dynamic.DynamicObject.TryGetMember%2A> Metoda jest wywoływana, gdy członek klasy dynamicznej zostanie zażądany nie podano argumentów.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-156">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="c9eaf-157">`binder` Argument zawiera informacje o przywoływanego elementu członkowskiego, a `result` argument odwołuje się do wyniku zwrócony dla określonego elementu członkowskiego.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-157">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="c9eaf-158"><xref:System.Dynamic.DynamicObject.TryGetMember%2A> Metoda zwraca wartość logiczną, która zwraca `true` Jeśli wymagany element istnieje; w przeciwnym razie zwraca `false`.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-158">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#6](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#6)]
    [!code-vb[VbDynamicWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#6)]
  
11. <span data-ttu-id="c9eaf-159">Po `TryGetMember` metody, Dodaj następujący kod, aby zastąpić <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> metody <xref:System.Dynamic.DynamicObject> klasy.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-159">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="c9eaf-160"><xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> Metoda jest wywoływana, gdy zażądano składową klasy dynamicznej z argumentami.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-160">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="c9eaf-161">`binder` Argument zawiera informacje o przywoływanego elementu członkowskiego, a `result` argument odwołuje się do wyniku zwrócony dla określonego elementu członkowskiego.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-161">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="c9eaf-162">`args` Argument zawiera tablicę argumentów, które są przekazywane do elementu członkowskiego.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-162">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="c9eaf-163"><xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> Metoda zwraca wartość logiczną, która zwraca `true` Jeśli wymagany element istnieje; w przeciwnym razie zwraca `false`.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-163">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    <span data-ttu-id="c9eaf-164">Niestandardową wersję `TryInvokeMember` metoda oczekuje pierwszy argument jako wartość z zakresu od `StringSearchOption` wyliczenia, które są zdefiniowane w poprzednim kroku.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-164">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="c9eaf-165">`TryInvokeMember` Metoda oczekuje, że drugi argument typu wartość logiczna.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-165">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="c9eaf-166">Jeśli jeden lub oba argumenty mają prawidłowe wartości, są przekazywane do `GetPropertyValue` metody do pobierania wyników.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-166">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#7)]
    [!code-vb[VbDynamicWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#7)]
  
12. <span data-ttu-id="c9eaf-167">Zapisz i zamknij plik.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-167">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="c9eaf-168">Aby utworzyć przykładowy plik tekstowy</span><span class="sxs-lookup"><span data-stu-id="c9eaf-168">To create a sample text file</span></span>  
  
1.  <span data-ttu-id="c9eaf-169">Kliknij prawym przyciskiem myszy projekt DynamicSample, a następnie wskaż **Dodaj**, a następnie kliknij przycisk **nowy element**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-169">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="c9eaf-170">W **zainstalowane szablony** okienku wybierz **ogólne**, a następnie wybierz pozycję **plik tekstowy** szablonu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-170">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="c9eaf-171">Pozostaw domyślną nazwę TextFile1.txt w **nazwa** , a następnie kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-171">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="c9eaf-172">Nowy plik tekstowy zostanie dodany do projektu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-172">A new text file is added to the project.</span></span>  
  
2.  <span data-ttu-id="c9eaf-173">Skopiuj poniższy tekst do pliku TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-173">Copy the following text to the TextFile1.txt file.</span></span>  
  
    ```  
    List of customers and suppliers  
  
    Supplier: Lucerne Publishing (https://www.lucernepublishing.com/)  
    Customer: Preston, Chris  
    Customer: Hines, Patrick  
    Customer: Cameron, Maria  
    Supplier: Graphic Design Institute (https://www.graphicdesigninstitute.com/)   
    Supplier: Fabrikam, Inc. (https://www.fabrikam.com/)   
    Customer: Seubert, Roxanne  
    Supplier: Proseware, Inc. (http://www.proseware.com/)   
    Customer: Adolphi, Stephan  
    Customer: Koch, Paul  
    ```  
  
3.  <span data-ttu-id="c9eaf-174">Zapisz i zamknij plik.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-174">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="c9eaf-175">Do tworzenia przykładowej aplikacji, która używa niestandardowych obiekt dynamiczny</span><span class="sxs-lookup"><span data-stu-id="c9eaf-175">To create a sample application that uses the custom dynamic object</span></span>  
  
1.  <span data-ttu-id="c9eaf-176">W **Eksploratora rozwiązań**, kliknij dwukrotnie plik Module1.vb, jeśli używasz języka Visual Basic lub pliku Program.cs Jeśli używasz Visual C#.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-176">In **Solution Explorer**, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#.</span></span>  
  
2.  <span data-ttu-id="c9eaf-177">Dodaj następujący kod do procedurę Main, aby utworzyć wystąpienie `ReadOnlyFile` klasy dla pliku TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-177">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="c9eaf-178">Kod używa późne powiązania w celu wywołania dynamicznych elementów członkowskich i pobieranie wierszy tekstu, zawierających ciąg "Klient".</span><span class="sxs-lookup"><span data-stu-id="c9eaf-178">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/program.cs#8)]
     [!code-vb[VbDynamicWalkthrough#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/module1.vb#8)]
  
3.  <span data-ttu-id="c9eaf-179">Zapisz plik, a następnie naciśnij klawisz CTRL + F5, aby skompilować i uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-179">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="c9eaf-180">Podczas wywoływania biblioteki języka dynamicznego</span><span class="sxs-lookup"><span data-stu-id="c9eaf-180">Calling a Dynamic Language Library</span></span>  

<span data-ttu-id="c9eaf-181">Podczas następnego projektu, który zostanie utworzony w tym przewodniku uzyskuje dostęp do biblioteki, która jest napisany w języku dynamiczne Ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-181">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span>
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="c9eaf-182">Do tworzenia niestandardowych klas dynamicznych</span><span class="sxs-lookup"><span data-stu-id="c9eaf-182">To create a custom dynamic class</span></span>
  
1.  <span data-ttu-id="c9eaf-183">W programie Visual Studio na **pliku** menu wskaż **New** a następnie kliknij przycisk **projektu**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-183">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="c9eaf-184">W **nowy projekt** dialogowym **typów projektów** okienka, upewnij się, że **Windows** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-184">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="c9eaf-185">Wybierz **aplikację Konsolową** w **szablony** okienka.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-185">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="c9eaf-186">W **nazwa** wpisz `DynamicIronPythonSample`, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-186">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="c9eaf-187">Nowy projekt zostanie utworzony.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-187">The new project is created.</span></span>  
  
3.  <span data-ttu-id="c9eaf-188">Jeśli używasz języka Visual Basic, kliknij prawym przyciskiem myszy projekt DynamicIronPythonSample, a następnie kliknij przycisk **właściwości**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-188">If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="c9eaf-189">Kliknij przycisk **odwołania** kartę. Kliknij przycisk **Dodaj** przycisku.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-189">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="c9eaf-190">Jeśli używasz języka Visual C# w **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy **odwołania** folder, a następnie kliknij przycisk **Dodaj odwołanie**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-190">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>  
  
4.  <span data-ttu-id="c9eaf-191">Na **Przeglądaj** karcie, przejdź do folderu, w którym są zainstalowane biblioteki Ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-191">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="c9eaf-192">Na przykład C:\Program Files\IronPython 2.6 dla platformy .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-192">For example, C:\Program Files\IronPython 2.6 for .NET 4.0.</span></span> <span data-ttu-id="c9eaf-193">Wybierz **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, i **Microsoft.Dynamic.dll** biblioteki .</span><span class="sxs-lookup"><span data-stu-id="c9eaf-193">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="c9eaf-194">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-194">Click **OK**.</span></span>  
  
5.  <span data-ttu-id="c9eaf-195">Jeśli używasz języka Visual Basic, należy edytować plik Module1.vb.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-195">If you are using Visual Basic, edit the Module1.vb file.</span></span> <span data-ttu-id="c9eaf-196">Jeśli używasz Visual C#, przeprowadź edycję pliku Program.cs.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-196">If you are using Visual C#, edit the Program.cs file.</span></span>  
  
6.  <span data-ttu-id="c9eaf-197">W górnej części pliku Dodaj następujący kod umożliwiający zaimportowanie `Microsoft.Scripting.Hosting` i `IronPython.Hosting` przestrzenie nazw z bibliotek Ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-197">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>  
  
    [!code-csharp[VbDynamicWalkthroughIronPython#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#1)]
    [!code-vb[VbDynamicWalkthroughIronPython#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#1)]
  
7.  <span data-ttu-id="c9eaf-198">W przypadku metody Main, Dodaj następujący kod, aby utworzyć nową `Microsoft.Scripting.Hosting.ScriptRuntime` obiektu do obsługi bibliotek Ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-198">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="c9eaf-199">`ScriptRuntime` Obiektu ładuje random.py modułu biblioteki Ironpythonu.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-199">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#2)]
     [!code-vb[VbDynamicWalkthroughIronPython#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#2)]
  
8.  <span data-ttu-id="c9eaf-200">Po kodzie, który można załadować modułu random.py Dodaj następujący kod, aby utworzyć tablicę wartości całkowitych.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-200">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="c9eaf-201">Tablica jest przekazywany do `shuffle` metoda moduł random.py, który losowo sortuje wartości w tablicy.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-201">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#3)]
     [!code-vb[VbDynamicWalkthroughIronPython#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#3)]
  
9. <span data-ttu-id="c9eaf-202">Zapisz plik, a następnie naciśnij klawisz CTRL + F5, aby skompilować i uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="c9eaf-202">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c9eaf-203">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="c9eaf-203">See Also</span></span>

- <xref:System.Dynamic?displayProperty=nameWithType>  
- <xref:System.Dynamic.DynamicObject?displayProperty=nameWithType>  
- [<span data-ttu-id="c9eaf-204">Używanie typu dynamicznego</span><span class="sxs-lookup"><span data-stu-id="c9eaf-204">Using Type dynamic</span></span>](../../../csharp/programming-guide/types/using-type-dynamic.md)  
- [<span data-ttu-id="c9eaf-205">Wczesne i późne powiązania</span><span class="sxs-lookup"><span data-stu-id="c9eaf-205">Early and Late Binding</span></span>](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)  
- [<span data-ttu-id="c9eaf-206">dynamic</span><span class="sxs-lookup"><span data-stu-id="c9eaf-206">dynamic</span></span>](../../../csharp/language-reference/keywords/dynamic.md)  
- [<span data-ttu-id="c9eaf-207">Implementowanie dynamicznych interfejsów (PDF do pobrania w witrynie Microsoft TechNet.)</span><span class="sxs-lookup"><span data-stu-id="c9eaf-207">Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)</span></span>](https://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)
