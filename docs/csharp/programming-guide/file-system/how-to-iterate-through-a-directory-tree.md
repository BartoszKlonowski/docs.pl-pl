---
title: Jak wykonać iterację w drzewie katalogów — Przewodnik programowania w języku C#
description: Dowiedz się, jak wykonać iterację drzewa katalogów. Uzyskaj dostęp do każdego pliku w każdym zagnieżdżonym podkatalogu w określonym folderze głównym.
ms.date: 07/20/2015
helpviewer_keywords:
- iterating through folders [C#]
- file iteration [C#]
ms.assetid: c4be4a75-6b1b-46a7-9d38-bab353091ed7
ms.openlocfilehash: 9d927e8517ddbdb1c5a9a8aa8ca3c321bf7e8d9c
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/24/2020
ms.locfileid: "91178544"
---
# <a name="how-to-iterate-through-a-directory-tree-c-programming-guide"></a><span data-ttu-id="e05fe-104">Jak wykonać iterację w drzewie katalogów (Przewodnik programowania w języku C#)</span><span class="sxs-lookup"><span data-stu-id="e05fe-104">How to iterate through a directory tree (C# Programming Guide)</span></span>

<span data-ttu-id="e05fe-105">Fraza "Iterowanie drzewa katalogów" oznacza, że uzyskuje dostęp do każdego pliku w każdym zagnieżdżonym podkatalogu w określonym folderze głównym, na dowolną głębokość.</span><span class="sxs-lookup"><span data-stu-id="e05fe-105">The phrase "iterate a directory tree" means to access each file in each nested subdirectory under a specified root folder, to any depth.</span></span> <span data-ttu-id="e05fe-106">Nie trzeba otwierać każdego pliku.</span><span class="sxs-lookup"><span data-stu-id="e05fe-106">You do not necessarily have to open each file.</span></span> <span data-ttu-id="e05fe-107">Można po prostu pobrać nazwę pliku lub podkatalogu jako lub `string` można pobrać dodatkowe informacje w postaci <xref:System.IO.FileInfo?displayProperty=nameWithType> <xref:System.IO.DirectoryInfo?displayProperty=nameWithType> obiektu lub.</span><span class="sxs-lookup"><span data-stu-id="e05fe-107">You can just retrieve the name of the file or subdirectory as a `string`, or you can retrieve additional information in the form of a <xref:System.IO.FileInfo?displayProperty=nameWithType> or <xref:System.IO.DirectoryInfo?displayProperty=nameWithType> object.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="e05fe-108">W systemie Windows terminy "katalog" i "folder" są używane zamiennie.</span><span class="sxs-lookup"><span data-stu-id="e05fe-108">In Windows, the terms "directory" and "folder" are used interchangeably.</span></span> <span data-ttu-id="e05fe-109">Większość dokumentacji i tekstu interfejsu użytkownika używa terminu "folder", ale biblioteki klas .NET używają terminu "Directory".</span><span class="sxs-lookup"><span data-stu-id="e05fe-109">Most documentation and user interface text uses the term "folder," but .NET class libraries use the term "directory."</span></span>  
  
 <span data-ttu-id="e05fe-110">W najprostszym przypadku, w którym wiadomo, że masz uprawnienia dostępu do wszystkich katalogów w określonym katalogu głównym, możesz użyć `System.IO.SearchOption.AllDirectories` flagi.</span><span class="sxs-lookup"><span data-stu-id="e05fe-110">In the simplest case, in which you know for certain that you have access permissions for all directories under a specified root, you can use the `System.IO.SearchOption.AllDirectories` flag.</span></span> <span data-ttu-id="e05fe-111">Ta flaga zwraca wszystkie zagnieżdżone podkatalogi zgodne z określonym wzorcem.</span><span class="sxs-lookup"><span data-stu-id="e05fe-111">This flag returns all the nested subdirectories that match the specified pattern.</span></span> <span data-ttu-id="e05fe-112">Poniższy przykład pokazuje, jak używać tej flagi.</span><span class="sxs-lookup"><span data-stu-id="e05fe-112">The following example shows how to use this flag.</span></span>  
  
```csharp  
root.GetDirectories("*.*", System.IO.SearchOption.AllDirectories);  
```  
  
 <span data-ttu-id="e05fe-113">Przyczyną tej metody jest to, że jeśli którykolwiek z podkatalogów w ramach określonego elementu głównego <xref:System.IO.DirectoryNotFoundException> <xref:System.UnauthorizedAccessException> wykaże lub, cała Metoda zakończy się niepowodzeniem i nie zwróci żadnych katalogów.</span><span class="sxs-lookup"><span data-stu-id="e05fe-113">The weakness in this approach is that if any one of the subdirectories under the specified root causes a <xref:System.IO.DirectoryNotFoundException> or <xref:System.UnauthorizedAccessException>, the whole method fails and returns no directories.</span></span> <span data-ttu-id="e05fe-114">Ta sama wartość jest prawdziwa w przypadku używania <xref:System.IO.DirectoryInfo.GetFiles%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="e05fe-114">The same is true when you use the <xref:System.IO.DirectoryInfo.GetFiles%2A> method.</span></span> <span data-ttu-id="e05fe-115">Jeśli musisz obsługiwać te wyjątki w określonych podfolderach, musisz ręcznie przeprowadzić drzewo katalogów, jak pokazano w poniższych przykładach.</span><span class="sxs-lookup"><span data-stu-id="e05fe-115">If you have to handle these exceptions on specific subfolders, you must manually walk the directory tree, as shown in the following examples.</span></span>  
  
 <span data-ttu-id="e05fe-116">W przypadku ręcznego przeszukiwania drzewa katalogów można najpierw obsłużyć podkatalogi (*Przechodzenie*przedrzędne) lub pliki pierwsze (*Przechodzenie po kolejności*).</span><span class="sxs-lookup"><span data-stu-id="e05fe-116">When you manually walk a directory tree, you can handle the subdirectories first (*pre-order traversal*), or the files first (*post-order traversal*).</span></span> <span data-ttu-id="e05fe-117">W przypadku przeprowadzania przechodzenia przed kolejnością należy przeszukać całe drzewo w bieżącym folderze przed przeprowadzeniem iteracji w plikach, które znajdują się bezpośrednio w tym folderze.</span><span class="sxs-lookup"><span data-stu-id="e05fe-117">If you perform a pre-order traversal, you walk the whole tree under the current folder before iterating through the files that are directly in that folder itself.</span></span> <span data-ttu-id="e05fe-118">Przykłady w dalszej części tego dokumentu wykonują przechodzenie po kolejności, ale można je łatwo modyfikować, aby wykonać przechodzenie w kolejności wstępnej.</span><span class="sxs-lookup"><span data-stu-id="e05fe-118">The examples later in this document perform post-order traversal, but you can easily modify them to perform pre-order traversal.</span></span>  
  
 <span data-ttu-id="e05fe-119">Inną opcją jest użycie rekursji lub przechodzenie oparte na stosie.</span><span class="sxs-lookup"><span data-stu-id="e05fe-119">Another option is whether to use recursion or a stack-based traversal.</span></span> <span data-ttu-id="e05fe-120">W przykładach w dalszej części tego dokumentu przedstawiono oba podejścia.</span><span class="sxs-lookup"><span data-stu-id="e05fe-120">The examples later in this document show both approaches.</span></span>  
  
 <span data-ttu-id="e05fe-121">Jeśli trzeba wykonać różne operacje na plikach i folderach, można modularyzacji te przykłady przez refaktoryzację operacji do oddzielnych funkcji, które można wywołać za pomocą pojedynczego delegata.</span><span class="sxs-lookup"><span data-stu-id="e05fe-121">If you have to perform a variety of operations on files and folders, you can modularize these examples by refactoring the operation into separate functions that you can invoke by using a single delegate.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="e05fe-122">Systemy plików NTFS mogą zawierać *punkty ponownej analizy* w postaci *punktów połączenia*, *linków symbolicznych*i *twardych linków*.</span><span class="sxs-lookup"><span data-stu-id="e05fe-122">NTFS file systems can contain *reparse points* in the form of *junction points*, *symbolic links*, and *hard links*.</span></span> <span data-ttu-id="e05fe-123">Metody .NET, takie jak <xref:System.IO.DirectoryInfo.GetFiles%2A> i, <xref:System.IO.DirectoryInfo.GetDirectories%2A> nie zwracają żadnych podkatalogów w punkcie ponownej analizy.</span><span class="sxs-lookup"><span data-stu-id="e05fe-123">.NET methods such as <xref:System.IO.DirectoryInfo.GetFiles%2A> and <xref:System.IO.DirectoryInfo.GetDirectories%2A> will not return any subdirectories under a reparse point.</span></span> <span data-ttu-id="e05fe-124">To zachowanie chroni przed ryzykiem wprowadzenia do pętli nieskończonej, gdy dwa punkty ponownej analizy odnoszą się do siebie.</span><span class="sxs-lookup"><span data-stu-id="e05fe-124">This behavior guards against the risk of entering into an infinite loop when two reparse points refer to each other.</span></span> <span data-ttu-id="e05fe-125">Ogólnie rzecz biorąc, należy zachować szczególną ostrożność podczas postępowania z punktami ponownej analizy, aby upewnić się, że nie można przypadkowo modyfikować ani usuwać plików.</span><span class="sxs-lookup"><span data-stu-id="e05fe-125">In general, you should use extreme caution when you deal with reparse points to ensure that you do not unintentionally modify or delete files.</span></span> <span data-ttu-id="e05fe-126">Jeśli potrzebujesz precyzyjnej kontroli nad punktami ponownej analizy, użyj wywołania platformy lub kodu natywnego, aby bezpośrednio wywołać odpowiednie metody systemu plików Win32.</span><span class="sxs-lookup"><span data-stu-id="e05fe-126">If you require precise control over reparse points, use platform invoke or native code to call the appropriate Win32 file system methods directly.</span></span>  
  
## <a name="example"></a><span data-ttu-id="e05fe-127">Przykład</span><span class="sxs-lookup"><span data-stu-id="e05fe-127">Example</span></span>  

 <span data-ttu-id="e05fe-128">Poniższy przykład pokazuje, jak przeprowadzić drzewo katalogów za pomocą rekursji.</span><span class="sxs-lookup"><span data-stu-id="e05fe-128">The following example shows how to walk a directory tree by using recursion.</span></span> <span data-ttu-id="e05fe-129">Podejście cykliczne to elegancki, ale może powodować wyjątek przepełnienia stosu, jeśli drzewo katalogów jest duże i głęboko zagnieżdżone.</span><span class="sxs-lookup"><span data-stu-id="e05fe-129">The recursive approach is elegant but has the potential to cause a stack overflow exception if the directory tree is large and deeply nested.</span></span>  
  
 <span data-ttu-id="e05fe-130">Określone wyjątki, które są obsługiwane, oraz określone akcje wykonywane na każdym pliku lub folderze są dostępne jako tylko przykłady.</span><span class="sxs-lookup"><span data-stu-id="e05fe-130">The particular exceptions that are handled, and the particular actions that are performed on each file or folder, are provided as examples only.</span></span> <span data-ttu-id="e05fe-131">Należy zmodyfikować ten kod w celu spełnienia określonych wymagań.</span><span class="sxs-lookup"><span data-stu-id="e05fe-131">You should modify this code to meet your specific requirements.</span></span> <span data-ttu-id="e05fe-132">Aby uzyskać więcej informacji, zobacz komentarze w kodzie.</span><span class="sxs-lookup"><span data-stu-id="e05fe-132">See the comments in the code for more information.</span></span>  
  
 [!code-csharp[csFilesandFolders#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csFilesAndFolders/CS/FileIteration.cs#1)]  
  
## <a name="example"></a><span data-ttu-id="e05fe-133">Przykład</span><span class="sxs-lookup"><span data-stu-id="e05fe-133">Example</span></span>  

 <span data-ttu-id="e05fe-134">Poniższy przykład pokazuje, jak wykonać iterację plików i folderów w drzewie katalogów bez użycia rekursji.</span><span class="sxs-lookup"><span data-stu-id="e05fe-134">The following example shows how to iterate through files and folders in a directory tree without using recursion.</span></span> <span data-ttu-id="e05fe-135">W tej metodzie <xref:System.Collections.Generic.Stack%601> jest używany typ kolekcji generycznej, który jest ostatnim wyjściem ze stosu (LIFO).</span><span class="sxs-lookup"><span data-stu-id="e05fe-135">This technique uses the generic <xref:System.Collections.Generic.Stack%601> collection type, which is a last in first out (LIFO) stack.</span></span>  
  
 <span data-ttu-id="e05fe-136">Określone wyjątki, które są obsługiwane, oraz określone akcje wykonywane na każdym pliku lub folderze są dostępne jako tylko przykłady.</span><span class="sxs-lookup"><span data-stu-id="e05fe-136">The particular exceptions that are handled, and the particular actions that are performed on each file or folder, are provided as examples only.</span></span> <span data-ttu-id="e05fe-137">Należy zmodyfikować ten kod w celu spełnienia określonych wymagań.</span><span class="sxs-lookup"><span data-stu-id="e05fe-137">You should modify this code to meet your specific requirements.</span></span> <span data-ttu-id="e05fe-138">Aby uzyskać więcej informacji, zobacz komentarze w kodzie.</span><span class="sxs-lookup"><span data-stu-id="e05fe-138">See the comments in the code for more information.</span></span>  
  
 [!code-csharp[csFilesandFolders#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csFilesAndFolders/CS/FileIteration.cs#2)]  
  
 <span data-ttu-id="e05fe-139">Przetestowanie każdego folderu jest zwykle zbyt czasochłonne, aby określić, czy aplikacja ma uprawnienia do otwierania go.</span><span class="sxs-lookup"><span data-stu-id="e05fe-139">It is generally too time-consuming to test every folder to determine whether your application has permission to open it.</span></span> <span data-ttu-id="e05fe-140">W związku z tym, przykładowy kod po prostu umieszcza tę część operacji w `try/catch` bloku.</span><span class="sxs-lookup"><span data-stu-id="e05fe-140">Therefore, the code example just encloses that part of the operation in a `try/catch` block.</span></span> <span data-ttu-id="e05fe-141">Możesz zmodyfikować `catch` blok tak, aby po odmowie dostępu do folderu próbować podnieść uprawnienia, a następnie uzyskać do niego dostęp.</span><span class="sxs-lookup"><span data-stu-id="e05fe-141">You can modify the `catch` block so that when you are denied access to a folder, you try to elevate your permissions and then access it again.</span></span> <span data-ttu-id="e05fe-142">Jako reguła, należy jedynie przechwytywać te wyjątki, które można obsłużyć bez opuszczania aplikacji w nieznanym stanie.</span><span class="sxs-lookup"><span data-stu-id="e05fe-142">As a rule, only catch those exceptions that you can handle without leaving your application in an unknown state.</span></span>  
  
 <span data-ttu-id="e05fe-143">Jeśli zawartość drzewa katalogów ma być przechowywana w pamięci lub na dysku, najlepszym rozwiązaniem jest przechowywanie tylko <xref:System.IO.FileSystemInfo.FullName%2A> właściwości (typu `string` ) dla każdego pliku.</span><span class="sxs-lookup"><span data-stu-id="e05fe-143">If you must store the contents of a directory tree, either in memory or on disk, the best option is to store only the <xref:System.IO.FileSystemInfo.FullName%2A> property (of type `string`) for each file.</span></span> <span data-ttu-id="e05fe-144">Następnie można użyć tego ciągu do utworzenia nowego <xref:System.IO.FileInfo> lub <xref:System.IO.DirectoryInfo> obiektu w razie potrzeby lub otworzyć dowolny plik, który wymaga dodatkowego przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="e05fe-144">You can then use this string to create a new <xref:System.IO.FileInfo> or <xref:System.IO.DirectoryInfo> object as necessary, or open any file that requires additional processing.</span></span>  
  
## <a name="robust-programming"></a><span data-ttu-id="e05fe-145">Niezawodne programowanie</span><span class="sxs-lookup"><span data-stu-id="e05fe-145">Robust Programming</span></span>  

 <span data-ttu-id="e05fe-146">Niezawodny kod iteracji pliku musi uwzględniać wiele złożoności systemu plików.</span><span class="sxs-lookup"><span data-stu-id="e05fe-146">Robust file iteration code must take into account many complexities of the file system.</span></span> <span data-ttu-id="e05fe-147">Aby uzyskać więcej informacji o systemie plików systemu Windows, zobacz [NTFS — Omówienie](/windows-server/storage/file-server/ntfs-overview).</span><span class="sxs-lookup"><span data-stu-id="e05fe-147">For more information on the Windows file system, see [NTFS overview](/windows-server/storage/file-server/ntfs-overview).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e05fe-148">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="e05fe-148">See also</span></span>

- <xref:System.IO>
- [<span data-ttu-id="e05fe-149">LINQ i katalogi plików</span><span class="sxs-lookup"><span data-stu-id="e05fe-149">LINQ and File Directories</span></span>](../concepts/linq/linq-and-file-directories.md)
- [<span data-ttu-id="e05fe-150">System plików i rejestr (Przewodnik programowania w języku C#)</span><span class="sxs-lookup"><span data-stu-id="e05fe-150">File System and the Registry (C# Programming Guide)</span></span>](./index.md)
