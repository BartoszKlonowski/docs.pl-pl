---
title: Asynchroniczne typy zwracane (C#)
description: Dowiedz się więcej na temat typów zwracanych, które metody asynchroniczne mogą znajdować się w języku C# z przykładami kodu dla każdego typu i dodatkowych zasobów.
ms.date: 08/19/2020
ms.assetid: ddb2539c-c898-48c1-ad92-245e4a996df8
ms.openlocfilehash: 71e560ed8ee0cae14da396e5ea2f3ab29611ebab
ms.sourcegitcommit: 9c45035b781caebc63ec8ecf912dc83fb6723b1f
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/25/2020
ms.locfileid: "88811499"
---
# <a name="async-return-types-c"></a><span data-ttu-id="a5e62-103">Asynchroniczne typy zwracane (C#)</span><span class="sxs-lookup"><span data-stu-id="a5e62-103">Async return types (C#)</span></span>

<span data-ttu-id="a5e62-104">Metody asynchroniczne mogą mieć następujące typy zwracane:</span><span class="sxs-lookup"><span data-stu-id="a5e62-104">Async methods can have the following return types:</span></span>

- <span data-ttu-id="a5e62-105"><xref:System.Threading.Tasks.Task>dla metody asynchronicznej, która wykonuje operację, ale nie zwraca żadnej wartości.</span><span class="sxs-lookup"><span data-stu-id="a5e62-105"><xref:System.Threading.Tasks.Task>, for an async method that performs an operation but returns no value.</span></span>
- <span data-ttu-id="a5e62-106"><xref:System.Threading.Tasks.Task%601>dla metody asynchronicznej, która zwraca wartość.</span><span class="sxs-lookup"><span data-stu-id="a5e62-106"><xref:System.Threading.Tasks.Task%601>, for an async method that returns a value.</span></span>
- <span data-ttu-id="a5e62-107">`void`dla programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="a5e62-107">`void`, for an event handler.</span></span>
- <span data-ttu-id="a5e62-108">Począwszy od języka C# 7,0, dowolnego typu, który ma dostępną `GetAwaiter` metodę.</span><span class="sxs-lookup"><span data-stu-id="a5e62-108">Starting with C# 7.0, any type that has an accessible `GetAwaiter` method.</span></span> <span data-ttu-id="a5e62-109">Obiekt zwrócony przez `GetAwaiter` metodę musi implementować <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> interfejs.</span><span class="sxs-lookup"><span data-stu-id="a5e62-109">The object returned by the `GetAwaiter` method must implement the <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> interface.</span></span>
- <span data-ttu-id="a5e62-110">Począwszy od języka C# 8,0, <xref:System.Collections.Generic.IAsyncEnumerable%601> dla metody asynchronicznej zwracającej *strumień asynchroniczny*.</span><span class="sxs-lookup"><span data-stu-id="a5e62-110">Starting with C# 8.0, <xref:System.Collections.Generic.IAsyncEnumerable%601>, for an async method that returns an *async stream*.</span></span>

<span data-ttu-id="a5e62-111">Aby uzyskać więcej informacji na temat metod asynchronicznych, zobacz [programowanie asynchroniczne z Async i Await (C#)](./index.md).</span><span class="sxs-lookup"><span data-stu-id="a5e62-111">For more information about async methods, see [Asynchronous programming with async and await (C#)](./index.md).</span></span>

<span data-ttu-id="a5e62-112">Istnieje także kilka innych typów, które są specyficzne dla obciążeń systemu Windows:</span><span class="sxs-lookup"><span data-stu-id="a5e62-112">Several other types also exist that are specific to Windows workloads:</span></span>

- <span data-ttu-id="a5e62-113"><xref:System.Windows.Threading.DispatcherOperation>w przypadku operacji asynchronicznych ograniczonych do systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="a5e62-113"><xref:System.Windows.Threading.DispatcherOperation>, for async operations limited to Windows.</span></span>
- <span data-ttu-id="a5e62-114"><xref:Windows.Foundation.IAsyncAction>w przypadku akcji asynchronicznych w platformy UWP, które nie zwracają wartości.</span><span class="sxs-lookup"><span data-stu-id="a5e62-114"><xref:Windows.Foundation.IAsyncAction>, for async actions in UWP that do not return a value.</span></span>
- <span data-ttu-id="a5e62-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>w przypadku akcji asynchronicznych w platformy UWP, które zgłaszają postęp, ale nie zwracają wartości.</span><span class="sxs-lookup"><span data-stu-id="a5e62-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, for async actions in UWP that report progress but do not return a value.</span></span>
- <span data-ttu-id="a5e62-116"><xref:Windows.Foundation.IAsyncOperation%601>dla operacji asynchronicznych w platformy UWP, które zwracają wartość.</span><span class="sxs-lookup"><span data-stu-id="a5e62-116"><xref:Windows.Foundation.IAsyncOperation%601>, for async operations in UWP that return a value.</span></span>
- <span data-ttu-id="a5e62-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>w przypadku operacji asynchronicznych w platformy UWP, które raportują postęp i zwracają wartość.</span><span class="sxs-lookup"><span data-stu-id="a5e62-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, for async operations in UWP that report progress and return a value.</span></span>

## <a name="task-return-type"></a><span data-ttu-id="a5e62-118">Typ zwracany zadania</span><span class="sxs-lookup"><span data-stu-id="a5e62-118">Task return type</span></span>

<span data-ttu-id="a5e62-119">Metody asynchroniczne, które nie zawierają `return` instrukcji lub zawierające `return` instrukcję, która nie zwraca operandu, zwykle mają typ zwracany <xref:System.Threading.Tasks.Task> .</span><span class="sxs-lookup"><span data-stu-id="a5e62-119">Async methods that don't contain a `return` statement or that contain a `return` statement that doesn't return an operand usually have a return type of <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="a5e62-120">Takie metody zwracają, `void` Jeśli są uruchamiane synchronicznie.</span><span class="sxs-lookup"><span data-stu-id="a5e62-120">Such methods return `void` if they run synchronously.</span></span> <span data-ttu-id="a5e62-121">Jeśli używasz <xref:System.Threading.Tasks.Task> typu zwracanego dla metody asynchronicznej, Metoda wywołująca może użyć operatora, `await` Aby zawiesić zakończenie obiektu wywołującego do momentu zakończenia wywołanej metody asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="a5e62-121">If you use a <xref:System.Threading.Tasks.Task> return type for an async method, a calling method can use an `await` operator to suspend the caller's completion until the called async method has finished.</span></span>

<span data-ttu-id="a5e62-122">W poniższym przykładzie `WaitAndApologizeAsync` Metoda nie zawiera `return` instrukcji, dlatego metoda zwraca <xref:System.Threading.Tasks.Task> obiekt.</span><span class="sxs-lookup"><span data-stu-id="a5e62-122">In the following example, the `WaitAndApologizeAsync` method doesn't contain a `return` statement, so the method returns a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="a5e62-123">Zwracanie elementu `Task` umożliwia `WaitAndApologizeAsync` oczekiwanie.</span><span class="sxs-lookup"><span data-stu-id="a5e62-123">Returning a `Task` enables `WaitAndApologizeAsync` to be awaited.</span></span> <span data-ttu-id="a5e62-124"><xref:System.Threading.Tasks.Task>Typ nie zawiera właściwości, `Result` ponieważ nie ma wartości zwracanej.</span><span class="sxs-lookup"><span data-stu-id="a5e62-124">The <xref:System.Threading.Tasks.Task> type doesn't include a `Result` property because it has no return value.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2.cs" id="TaskReturn":::

<span data-ttu-id="a5e62-125">`WaitAndApologizeAsync` oczekuje się przy użyciu instrukcji Await zamiast wyrażenia await, podobnie jak instrukcja wywołująca synchronicznej metody zwracającej wartość void.</span><span class="sxs-lookup"><span data-stu-id="a5e62-125">`WaitAndApologizeAsync` is awaited by using an await statement instead of an await expression, similar to the calling statement for a synchronous void-returning method.</span></span> <span data-ttu-id="a5e62-126">W tym przypadku aplikacja operatora await nie tworzy wartości.</span><span class="sxs-lookup"><span data-stu-id="a5e62-126">The application of an await operator in this case doesn't produce a value.</span></span> <span data-ttu-id="a5e62-127">Aby wyjaśnić warunki i wyrażenie, zapoznaj się z poniższą tabelą:</span><span class="sxs-lookup"><span data-stu-id="a5e62-127">To clarify the terms statement and expression, refer to the table below:</span></span>

| <span data-ttu-id="a5e62-128">Rodzaj oczekiwania</span><span class="sxs-lookup"><span data-stu-id="a5e62-128">Await kind</span></span> | <span data-ttu-id="a5e62-129">Przykład</span><span class="sxs-lookup"><span data-stu-id="a5e62-129">Example</span></span>                                      | <span data-ttu-id="a5e62-130">Typ</span><span class="sxs-lookup"><span data-stu-id="a5e62-130">Type</span></span>                                   |
|------------|----------------------------------------------|----------------------------------------|
| <span data-ttu-id="a5e62-131">Instrukcja</span><span class="sxs-lookup"><span data-stu-id="a5e62-131">Statement</span></span>  | `await SomeTaskMethodAsync()`                | <xref:System.Threading.Tasks.Task>     |
| <span data-ttu-id="a5e62-132">Wyrażenie</span><span class="sxs-lookup"><span data-stu-id="a5e62-132">Expression</span></span> | `T result = await SomeTaskMethodAsync<T>();` | <xref:System.Threading.Tasks.Task%601> |

<span data-ttu-id="a5e62-133">Możesz oddzielić wywołanie `WaitAndApologizeAsync` od aplikacji operatora await, jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="a5e62-133">You can separate the call to `WaitAndApologizeAsync` from the application of an await operator, as the following code shows.</span></span> <span data-ttu-id="a5e62-134">Należy jednak pamiętać, że element `Task` nie ma `Result` właściwości i że żadna wartość nie jest generowana, gdy operator await jest stosowany do `Task` .</span><span class="sxs-lookup"><span data-stu-id="a5e62-134">However, remember that a `Task` doesn't have a `Result` property, and that no value is produced when an await operator is applied to a `Task`.</span></span>

<span data-ttu-id="a5e62-135">Poniższy kod oddziela wywoływanie `WaitAndApologizeAsync` metody od oczekiwania na zadanie, które zwraca metoda.</span><span class="sxs-lookup"><span data-stu-id="a5e62-135">The following code separates calling the `WaitAndApologizeAsync` method from awaiting the task that the method returns.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2a.cs" id="AwaitTask":::

## <a name="tasktresult-return-type"></a><span data-ttu-id="a5e62-136">\<TResult\>Typ zwracany zadania</span><span class="sxs-lookup"><span data-stu-id="a5e62-136">Task\<TResult\> return type</span></span>

<span data-ttu-id="a5e62-137"><xref:System.Threading.Tasks.Task%601>Zwracany typ jest używany dla metody asynchronicznej, która zawiera instrukcję [Return](../../../language-reference/keywords/return.md) , w której operand jest `TResult` .</span><span class="sxs-lookup"><span data-stu-id="a5e62-137">The <xref:System.Threading.Tasks.Task%601> return type is used for an async method that contains a [return](../../../language-reference/keywords/return.md) statement in which the operand is `TResult`.</span></span>

<span data-ttu-id="a5e62-138">W poniższym przykładzie `GetLeisureHoursAsync` Metoda zawiera `return` instrukcję, która zwraca liczbę całkowitą.</span><span class="sxs-lookup"><span data-stu-id="a5e62-138">In the following example, the `GetLeisureHoursAsync` method contains a `return` statement that returns an integer.</span></span> <span data-ttu-id="a5e62-139">W związku z tym Deklaracja metody musi określać zwracany typ `Task<int>` .</span><span class="sxs-lookup"><span data-stu-id="a5e62-139">Therefore, the method declaration must specify a return type of `Task<int>`.</span></span> <span data-ttu-id="a5e62-140"><xref:System.Threading.Tasks.Task.FromResult%2A>Metoda async jest symbolem zastępczym dla operacji, która zwraca <xref:System.DateTime.DayOfWeek> .</span><span class="sxs-lookup"><span data-stu-id="a5e62-140">The <xref:System.Threading.Tasks.Task.FromResult%2A> async method is a placeholder for an operation that returns a <xref:System.DateTime.DayOfWeek>.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1.cs" id="LeisureHours":::

<span data-ttu-id="a5e62-141">Gdy `GetLeisureHoursAsync` jest wywoływana z w wyrażeniu await w `ShowTodaysInfo` metodzie, wyrażenie await Pobiera wartość całkowitą (wartość `leisureHours` ), która jest przechowywana w zadaniu zwróconym przez `GetLeisureHours` metodę.</span><span class="sxs-lookup"><span data-stu-id="a5e62-141">When `GetLeisureHoursAsync` is called from within an await expression in the `ShowTodaysInfo` method, the await expression retrieves the integer value (the value of `leisureHours`) that's stored in the task returned by the `GetLeisureHours` method.</span></span> <span data-ttu-id="a5e62-142">Aby uzyskać więcej informacji na temat wyrażeń await, zobacz [await](../../../language-reference/operators/await.md).</span><span class="sxs-lookup"><span data-stu-id="a5e62-142">For more information about await expressions, see [await](../../../language-reference/operators/await.md).</span></span>

<span data-ttu-id="a5e62-143">Można lepiej zrozumieć, jak `await` Pobiera wynik z a `Task<T>` przez oddzielenie wywołania `GetLeisureHoursAsync` z aplikacji `await` , jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="a5e62-143">You can better understand how `await` retrieves the result from a `Task<T>` by separating the call to `GetLeisureHoursAsync` from the application of `await`, as the following code shows.</span></span> <span data-ttu-id="a5e62-144">Wywołanie metody `GetLeisureHoursAsync` , która nie jest bezpośrednio oczekiwane, zwraca `Task<int>` , jak oczekiwano od deklaracji metody.</span><span class="sxs-lookup"><span data-stu-id="a5e62-144">A call to method `GetLeisureHoursAsync` that isn't immediately awaited returns a `Task<int>`, as you would expect from the declaration of the method.</span></span> <span data-ttu-id="a5e62-145">Zadanie jest przypisane do `getLeisureHoursTask` zmiennej w przykładzie.</span><span class="sxs-lookup"><span data-stu-id="a5e62-145">The task is assigned to the `getLeisureHoursTask` variable in the example.</span></span> <span data-ttu-id="a5e62-146">Ponieważ `getLeisureHoursTask` jest <xref:System.Threading.Tasks.Task%601> , zawiera <xref:System.Threading.Tasks.Task%601.Result> Właściwość typu `TResult` .</span><span class="sxs-lookup"><span data-stu-id="a5e62-146">Because `getLeisureHoursTask` is a <xref:System.Threading.Tasks.Task%601>, it contains a <xref:System.Threading.Tasks.Task%601.Result> property of type `TResult`.</span></span> <span data-ttu-id="a5e62-147">W tym przypadku `TResult` reprezentuje typ Integer.</span><span class="sxs-lookup"><span data-stu-id="a5e62-147">In this case, `TResult` represents an integer type.</span></span> <span data-ttu-id="a5e62-148">Gdy `await` jest stosowany do `getLeisureHoursTask` , wyrażenie await oblicza zawartość <xref:System.Threading.Tasks.Task%601.Result%2A> właściwości `getLeisureHoursTask` .</span><span class="sxs-lookup"><span data-stu-id="a5e62-148">When `await` is applied to `getLeisureHoursTask`, the await expression evaluates to the contents of the <xref:System.Threading.Tasks.Task%601.Result%2A> property of `getLeisureHoursTask`.</span></span> <span data-ttu-id="a5e62-149">Wartość jest przypisana do `ret` zmiennej.</span><span class="sxs-lookup"><span data-stu-id="a5e62-149">The value is assigned to the `ret` variable.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="a5e62-150"><xref:System.Threading.Tasks.Task%601.Result%2A>Właściwość jest właściwością blokującą.</span><span class="sxs-lookup"><span data-stu-id="a5e62-150">The <xref:System.Threading.Tasks.Task%601.Result%2A> property is a blocking property.</span></span> <span data-ttu-id="a5e62-151">Jeśli spróbujesz uzyskać dostęp do niego przed ukończeniem zadania, wątek, który jest obecnie aktywny, jest blokowany do momentu zakończenia zadania, a wartość jest dostępna.</span><span class="sxs-lookup"><span data-stu-id="a5e62-151">If you try to access it before its task is finished, the thread that's currently active is blocked until the task completes and the value is available.</span></span> <span data-ttu-id="a5e62-152">W większości przypadków należy uzyskać dostęp do wartości przy użyciu `await` zamiast bezpośrednio uzyskać dostęp do właściwości.</span><span class="sxs-lookup"><span data-stu-id="a5e62-152">In most cases, you should access the value by using `await` instead of accessing the property directly.</span></span>
>
> <span data-ttu-id="a5e62-153">W poprzednim przykładzie pobrano wartość <xref:System.Threading.Tasks.Task%601.Result%2A> właściwości w celu zablokowania głównego wątku, tak aby `Main` Metoda mogła wydrukować `message` do konsoli programu przed zainstalowaniem aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a5e62-153">The previous example retrieved the value of the <xref:System.Threading.Tasks.Task%601.Result%2A> property to block the main thread so that the `Main` method could print the `message` to the console before the application ended.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1a.cs" id="StoreTask":::

## <a name="void-return-type"></a><span data-ttu-id="a5e62-154">Typ zwracany void</span><span class="sxs-lookup"><span data-stu-id="a5e62-154">Void return type</span></span>

<span data-ttu-id="a5e62-155">`void`Typ zwracany jest używany w asynchronicznych obsłudze zdarzeń, które wymagają `void` typu zwracanego.</span><span class="sxs-lookup"><span data-stu-id="a5e62-155">You use the `void` return type in asynchronous event handlers, which require a `void` return type.</span></span> <span data-ttu-id="a5e62-156">W przypadku metod innych niż programy obsługi zdarzeń, które nie zwracają wartości, należy zwrócić <xref:System.Threading.Tasks.Task> zamiast tego, ponieważ Metoda async, która zwraca `void` nie można oczekiwać.</span><span class="sxs-lookup"><span data-stu-id="a5e62-156">For methods other than event handlers that don't return a value, you should return a <xref:System.Threading.Tasks.Task> instead, because an async method that returns `void` can't be awaited.</span></span> <span data-ttu-id="a5e62-157">Każdy obiekt wywołujący taką metodę musi kontynuować działanie bez oczekiwania na zakończenie wywołanej metody asynchronicznej.</span><span class="sxs-lookup"><span data-stu-id="a5e62-157">Any caller of such a method must continue to completion without waiting for the called async method to finish.</span></span> <span data-ttu-id="a5e62-158">Obiekt wywołujący musi być niezależny od wszelkich wartości lub wyjątków generowanych przez metodę asynchroniczną.</span><span class="sxs-lookup"><span data-stu-id="a5e62-158">The caller must be independent of any values or exceptions that the async method generates.</span></span>

<span data-ttu-id="a5e62-159">Obiekt wywołujący metodę asynchroniczną zwracającą wartość void nie może przechwytywać wyjątków zgłoszonych z metody, a takie Nieobsłużone wyjątki mogą spowodować niepowodzenie działania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a5e62-159">The caller of a void-returning async method can't catch exceptions thrown from the method, and such unhandled exceptions are likely to cause your application to fail.</span></span> <span data-ttu-id="a5e62-160">Jeśli metoda zwracająca <xref:System.Threading.Tasks.Task> lub <xref:System.Threading.Tasks.Task%601> zgłasza wyjątek, wyjątek jest przechowywany w zwracanym zadaniu.</span><span class="sxs-lookup"><span data-stu-id="a5e62-160">If a method that returns a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> throws an exception, the exception is stored in the returned task.</span></span> <span data-ttu-id="a5e62-161">Wyjątek jest zgłaszany ponownie po oczekiwaniu na zadanie.</span><span class="sxs-lookup"><span data-stu-id="a5e62-161">The exception is rethrown when the task is awaited.</span></span> <span data-ttu-id="a5e62-162">W związku z tym upewnij się, że jakakolwiek Metoda asynchroniczna, która może generować wyjątek, ma typ zwracany <xref:System.Threading.Tasks.Task> lub <xref:System.Threading.Tasks.Task%601> i że wywołania metody są oczekiwane.</span><span class="sxs-lookup"><span data-stu-id="a5e62-162">Therefore, make sure that any async method that can produce an exception has a return type of <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> and that calls to the method are awaited.</span></span>

<span data-ttu-id="a5e62-163">Aby uzyskać więcej informacji o sposobie przechwytywania wyjątków w metodach asynchronicznych, zobacz sekcję [wyjątki w metodach asynchronicznych](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) artykułu [try-catch](../../../language-reference/keywords/try-catch.md) .</span><span class="sxs-lookup"><span data-stu-id="a5e62-163">For more information about how to catch exceptions in async methods, see the [Exceptions in async methods](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) section of the [try-catch](../../../language-reference/keywords/try-catch.md) article.</span></span>

<span data-ttu-id="a5e62-164">W poniższym przykładzie pokazano zachowanie programu obsługi zdarzeń asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="a5e62-164">The following example shows the behavior of an async event handler.</span></span> <span data-ttu-id="a5e62-165">W przykładowym kodzie, procedura obsługi zdarzeń asynchronicznych musi pozwolić, aby główny wątek był znany po zakończeniu.</span><span class="sxs-lookup"><span data-stu-id="a5e62-165">In the example code, an async event handler must let the main thread know when it finishes.</span></span> <span data-ttu-id="a5e62-166">Następnie wątek główny może poczekać na zakończenie obsługi zdarzeń asynchronicznych przed zamknięciem programu.</span><span class="sxs-lookup"><span data-stu-id="a5e62-166">Then the main thread can wait for an async event handler to complete before exiting the program.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns3.cs":::

## <a name="generalized-async-return-types-and-valuetasktresult"></a><span data-ttu-id="a5e62-167">Uogólnione asynchroniczne typy zwracane i ValueTask\<TResult\></span><span class="sxs-lookup"><span data-stu-id="a5e62-167">Generalized async return types and ValueTask\<TResult\></span></span>

<span data-ttu-id="a5e62-168">Począwszy od języka C# 7,0, Metoda asynchroniczna może zwracać dowolny typ, który ma dostępną `GetAwaiter` metodę.</span><span class="sxs-lookup"><span data-stu-id="a5e62-168">Starting with C# 7.0, an async method can return any type that has an accessible `GetAwaiter` method.</span></span>

<span data-ttu-id="a5e62-169">Ponieważ <xref:System.Threading.Tasks.Task> i <xref:System.Threading.Tasks.Task%601> są typami odwołań, alokacja pamięci w ścieżkach o krytycznym znaczeniu dla wydajności, szczególnie gdy przydziały występują w ścisłych pętlach, mogą mieć negatywny wpływ na wydajność.</span><span class="sxs-lookup"><span data-stu-id="a5e62-169">Because <xref:System.Threading.Tasks.Task> and <xref:System.Threading.Tasks.Task%601> are reference types, memory allocation in performance-critical paths, particularly when allocations occur in tight loops, can adversely affect performance.</span></span> <span data-ttu-id="a5e62-170">Obsługa uogólnionych typów zwracanych oznacza, że można zwrócić typ wartości lekkiej zamiast typu referencyjnego, aby uniknąć dodatkowych alokacji pamięci.</span><span class="sxs-lookup"><span data-stu-id="a5e62-170">Support for generalized return types means that you can return a lightweight value type instead of a reference type to avoid additional memory allocations.</span></span>

<span data-ttu-id="a5e62-171">Platforma .NET udostępnia <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> strukturę jako lekkie implementacje ogólnej wartości zwracanego zadania.</span><span class="sxs-lookup"><span data-stu-id="a5e62-171">.NET provides the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> structure as a lightweight implementation of a generalized task-returning value.</span></span> <span data-ttu-id="a5e62-172">Aby użyć tego <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> typu, należy dodać `System.Threading.Tasks.Extensions` pakiet NuGet do projektu.</span><span class="sxs-lookup"><span data-stu-id="a5e62-172">To use the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> type, you must add the `System.Threading.Tasks.Extensions` NuGet package to your project.</span></span> <span data-ttu-id="a5e62-173">Poniższy przykład używa struktury, <xref:System.Threading.Tasks.ValueTask%601> Aby pobrać wartość dwóch przerzutów z kością.</span><span class="sxs-lookup"><span data-stu-id="a5e62-173">The following example uses the <xref:System.Threading.Tasks.ValueTask%601> structure to retrieve the value of two dice rolls.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-valuetask.cs":::

## <a name="async-streams-with-iasyncenumerablet"></a><span data-ttu-id="a5e62-174">Strumienie asynchroniczne z IAsyncEnumerable\<T\></span><span class="sxs-lookup"><span data-stu-id="a5e62-174">Async streams with IAsyncEnumerable\<T\></span></span>

<span data-ttu-id="a5e62-175">Począwszy od języka C# 8,0, Metoda asynchroniczna może zwracać *strumień asynchroniczny*reprezentowany przez <xref:System.Collections.Generic.IAsyncEnumerable%601> .</span><span class="sxs-lookup"><span data-stu-id="a5e62-175">Starting with C# 8.0, an async method may return an *async stream*, represented by <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span></span> <span data-ttu-id="a5e62-176">Strumień asynchroniczny umożliwia Wyliczenie elementów odczytanych ze strumienia, gdy elementy są generowane w fragmentach z powtarzalnymi wywołaniami asynchronicznymi.</span><span class="sxs-lookup"><span data-stu-id="a5e62-176">An async stream provides a way to enumerate items read from a stream when elements are generated in chunks with repeated asynchronous calls.</span></span> <span data-ttu-id="a5e62-177">Poniższy przykład przedstawia metodę asynchroniczną generującą strumień asynchroniczny:</span><span class="sxs-lookup"><span data-stu-id="a5e62-177">The following example shows an async method that generates an async stream:</span></span>

:::code language="csharp" source="snippets/async-return-types/AsyncStreams.cs" id="GenerateAsyncStream":::

<span data-ttu-id="a5e62-178">Poprzedni przykład odczytuje wiersze z ciągu asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="a5e62-178">The preceding example reads lines from a string asynchronously.</span></span> <span data-ttu-id="a5e62-179">Po odczytaniu każdego wiersza kod wylicza każdy wyraz w ciągu.</span><span class="sxs-lookup"><span data-stu-id="a5e62-179">Once each line is read, the code enumerates each word in the string.</span></span> <span data-ttu-id="a5e62-180">Obiekty wywołujące spowodują Wyliczenie każdego wyrazu przy użyciu `await foreach` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="a5e62-180">Callers would enumerate each word using the `await foreach` statement.</span></span> <span data-ttu-id="a5e62-181">Metoda oczekuje, gdy musi asynchronicznie odczytać następny wiersz z ciągu źródłowego.</span><span class="sxs-lookup"><span data-stu-id="a5e62-181">The method awaits when it needs to asynchronously read the next line from the source string.</span></span>

## <a name="see-also"></a><span data-ttu-id="a5e62-182">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="a5e62-182">See also</span></span>

- <xref:System.Threading.Tasks.Task.FromResult%2A>
- [<span data-ttu-id="a5e62-183">Przetwarzaj zadania asynchroniczne po ich zakończeniu</span><span class="sxs-lookup"><span data-stu-id="a5e62-183">Process asynchronous tasks as they complete</span></span>](start-multiple-async-tasks-and-process-them-as-they-complete.md)
- [<span data-ttu-id="a5e62-184">Programowanie asynchroniczne z Async i Await (C#)</span><span class="sxs-lookup"><span data-stu-id="a5e62-184">Asynchronous programming with async and await (C#)</span></span>](index.md)
- [<span data-ttu-id="a5e62-185">async</span><span class="sxs-lookup"><span data-stu-id="a5e62-185">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="a5e62-186">await</span><span class="sxs-lookup"><span data-stu-id="a5e62-186">await</span></span>](../../../language-reference/operators/await.md)
