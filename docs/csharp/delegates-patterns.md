---
title: Wspólne wzorce dla delegatów
description: Zapoznaj się z typowymi wzorcami dotyczącymi używania delegatów w kodzie, aby uniknąć silnego sprzężenia między składnikami.
ms.date: 06/20/2016
ms.assetid: 0ff8fdfd-6a11-4327-b061-0f2526f35b43
ms.openlocfilehash: 174ae4129464c9d2e787048793cec764121ca4aa
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/03/2019
ms.locfileid: "73454082"
---
# <a name="common-patterns-for-delegates"></a><span data-ttu-id="a0b02-103">Wspólne wzorce dla delegatów</span><span class="sxs-lookup"><span data-stu-id="a0b02-103">Common Patterns for Delegates</span></span>

[<span data-ttu-id="a0b02-104">Ubiegł</span><span class="sxs-lookup"><span data-stu-id="a0b02-104">Previous</span></span>](delegates-strongly-typed.md)

<span data-ttu-id="a0b02-105">Delegaty zapewniają mechanizm, który umożliwia projekty oprogramowania, które obejmują minimalny sprzężenie między składnikami.</span><span class="sxs-lookup"><span data-stu-id="a0b02-105">Delegates provide a mechanism that enables software designs involving minimal coupling between components.</span></span>

<span data-ttu-id="a0b02-106">Jednym z doskonały przykładu dla tego rodzaju projektu jest LINQ.</span><span class="sxs-lookup"><span data-stu-id="a0b02-106">One excellent example for this kind of design is LINQ.</span></span> <span data-ttu-id="a0b02-107">Wzorzec wyrażenia zapytania LINQ opiera się na delegatach dla wszystkich swoich funkcji.</span><span class="sxs-lookup"><span data-stu-id="a0b02-107">The LINQ Query Expression Pattern relies on delegates for all of its features.</span></span> <span data-ttu-id="a0b02-108">Rozważmy ten prosty przykład:</span><span class="sxs-lookup"><span data-stu-id="a0b02-108">Consider this simple example:</span></span>

```csharp
var smallNumbers = numbers.Where(n => n < 10);
```

<span data-ttu-id="a0b02-109">To filtruje sekwencję liczb tylko do wartości mniejszej niż wartość 10.</span><span class="sxs-lookup"><span data-stu-id="a0b02-109">This filters the sequence of numbers to only those less than the value 10.</span></span>
<span data-ttu-id="a0b02-110">Metoda `Where` używa delegata, który określa, które elementy sekwencji przechodzą filtr.</span><span class="sxs-lookup"><span data-stu-id="a0b02-110">The `Where` method uses a delegate that determines which elements of a sequence pass the filter.</span></span> <span data-ttu-id="a0b02-111">Podczas tworzenia zapytania LINQ należy podać implementację delegata w tym konkretnym celu.</span><span class="sxs-lookup"><span data-stu-id="a0b02-111">When you create a LINQ query, you supply the implementation of the delegate for this specific purpose.</span></span>

<span data-ttu-id="a0b02-112">Prototyp dla metody WHERE:</span><span class="sxs-lookup"><span data-stu-id="a0b02-112">The prototype for the Where method is:</span></span>

```csharp
public static IEnumerable<TSource> Where<TSource> (this IEnumerable<TSource> source, Func<TSource, bool> predicate);
```

<span data-ttu-id="a0b02-113">Ten przykład powtarza się ze wszystkimi metodami, które są częścią LINQ.</span><span class="sxs-lookup"><span data-stu-id="a0b02-113">This example is repeated with all the methods that are part of LINQ.</span></span> <span data-ttu-id="a0b02-114">Wszyscy korzystają z delegatów dla kodu, który zarządza konkretną kwerendą.</span><span class="sxs-lookup"><span data-stu-id="a0b02-114">They all rely on delegates for the code that manages the specific query.</span></span> <span data-ttu-id="a0b02-115">Ten Wzorzec projektowy interfejsu API jest bardzo wydajny, aby poznać i zrozumieć.</span><span class="sxs-lookup"><span data-stu-id="a0b02-115">This API design pattern is a very powerful one to learn and understand.</span></span>

<span data-ttu-id="a0b02-116">W tym prostym przykładzie przedstawiono sposób, w jaki Delegaty potrzebują bardzo mało sprzężenia między składnikami.</span><span class="sxs-lookup"><span data-stu-id="a0b02-116">This simple example illustrates how delegates require very little coupling between components.</span></span> <span data-ttu-id="a0b02-117">Nie musisz tworzyć klasy, która pochodzi od określonej klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="a0b02-117">You don't need to create a class that derives from a particular base class.</span></span> <span data-ttu-id="a0b02-118">Nie trzeba implementować określonego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="a0b02-118">You don't need to implement a specific interface.</span></span>
<span data-ttu-id="a0b02-119">Jedynym wymaganiem jest zapewnienie implementacji jednej metody, która jest podstawowa dla danego zadania.</span><span class="sxs-lookup"><span data-stu-id="a0b02-119">The only requirement is to provide the implementation of one method that is fundamental to the task at hand.</span></span>

## <a name="building-your-own-components-with-delegates"></a><span data-ttu-id="a0b02-120">Tworzenie własnych składników za pomocą delegatów</span><span class="sxs-lookup"><span data-stu-id="a0b02-120">Building Your Own Components with Delegates</span></span>

<span data-ttu-id="a0b02-121">Zacznijmy od tego przykładu, tworząc składnik przy użyciu projektu, który jest zależny od delegatów.</span><span class="sxs-lookup"><span data-stu-id="a0b02-121">Let's build on that example by creating a component using a design that relies on delegates.</span></span>

<span data-ttu-id="a0b02-122">Zdefiniujmy składnik, który może być używany na potrzeby komunikatów dzienników w dużym systemie.</span><span class="sxs-lookup"><span data-stu-id="a0b02-122">Let's define a component that could be used for log messages in a large system.</span></span> <span data-ttu-id="a0b02-123">Składniki biblioteki mogą być używane w wielu różnych środowiskach na wielu różnych platformach.</span><span class="sxs-lookup"><span data-stu-id="a0b02-123">The library components could be used in many different environments, on multiple different platforms.</span></span> <span data-ttu-id="a0b02-124">Składnik zarządzający dziennikami zawiera wiele typowych funkcji.</span><span class="sxs-lookup"><span data-stu-id="a0b02-124">There are a lot of common features in the component that manages the logs.</span></span> <span data-ttu-id="a0b02-125">Konieczne będzie zaakceptowanie komunikatów z dowolnego składnika w systemie.</span><span class="sxs-lookup"><span data-stu-id="a0b02-125">It will need to accept messages from any component in the system.</span></span> <span data-ttu-id="a0b02-126">Te komunikaty będą mieć różne priorytety, którymi może zarządzać składnik podstawowy.</span><span class="sxs-lookup"><span data-stu-id="a0b02-126">Those messages will have different priorities, which the core component can manage.</span></span> <span data-ttu-id="a0b02-127">Komunikaty powinny mieć sygnatury czasowe w końcowej zarchiwizowanej postaci.</span><span class="sxs-lookup"><span data-stu-id="a0b02-127">The messages should have timestamps in their final archived form.</span></span> <span data-ttu-id="a0b02-128">W przypadku bardziej zaawansowanych scenariuszy można filtrować komunikaty według składnika źródłowego.</span><span class="sxs-lookup"><span data-stu-id="a0b02-128">For more advanced scenarios, you could filter messages by the source component.</span></span>

<span data-ttu-id="a0b02-129">Istnieje jeden aspekt funkcji, która często zmienia się: gdzie są zapisywane wiadomości.</span><span class="sxs-lookup"><span data-stu-id="a0b02-129">There is one aspect of the feature that will change often: where messages are written.</span></span> <span data-ttu-id="a0b02-130">W niektórych środowiskach mogą one być zapisywane w konsoli błędów.</span><span class="sxs-lookup"><span data-stu-id="a0b02-130">In some environments, they may be written to the error console.</span></span> <span data-ttu-id="a0b02-131">W innych, plik.</span><span class="sxs-lookup"><span data-stu-id="a0b02-131">In others, a file.</span></span> <span data-ttu-id="a0b02-132">Inne możliwości obejmują Magazyn bazy danych, dzienniki zdarzeń systemu operacyjnego lub inne magazyny dokumentów.</span><span class="sxs-lookup"><span data-stu-id="a0b02-132">Other possibilities include database storage, OS event logs, or other document storage.</span></span>

<span data-ttu-id="a0b02-133">Istnieją także kombinacje danych wyjściowych, które mogą być używane w różnych scenariuszach.</span><span class="sxs-lookup"><span data-stu-id="a0b02-133">There are also combinations of output that might be used in different scenarios.</span></span> <span data-ttu-id="a0b02-134">Możesz chcieć pisać komunikaty do konsoli programu i do pliku.</span><span class="sxs-lookup"><span data-stu-id="a0b02-134">You may want to write messages to the console and to a file.</span></span>

<span data-ttu-id="a0b02-135">Projekt oparty na delegatach zapewnia dużą elastyczność i ułatwia obsługę mechanizmów magazynu, które mogą zostać dodane w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="a0b02-135">A design based on delegates will provide a great deal of flexibility, and make it easy to support storage mechanisms that may be added in the future.</span></span>

<span data-ttu-id="a0b02-136">W ramach tego projektu podstawowy składnik dziennika może być niewirtualną, nawet klasą zapieczętowana.</span><span class="sxs-lookup"><span data-stu-id="a0b02-136">Under this design, the primary log component can be a non-virtual, even sealed class.</span></span> <span data-ttu-id="a0b02-137">Można podłączyć dowolnego zestawu delegatów, aby zapisywać komunikaty na innym nośniku magazynu.</span><span class="sxs-lookup"><span data-stu-id="a0b02-137">You can plug in any set of delegates to write the messages to different storage media.</span></span> <span data-ttu-id="a0b02-138">Wbudowana obsługa delegatów multiemisji ułatwia obsługę scenariuszy, w których komunikaty muszą być zapisywane w wielu lokalizacjach (pliku i konsoli).</span><span class="sxs-lookup"><span data-stu-id="a0b02-138">The built in support for multicast delegates makes it easy to support scenarios where messages must be written to multiple locations (a file, and a console).</span></span>

## <a name="a-first-implementation"></a><span data-ttu-id="a0b02-139">Pierwsza implementacja</span><span class="sxs-lookup"><span data-stu-id="a0b02-139">A First Implementation</span></span>

<span data-ttu-id="a0b02-140">Zacznijmy od początku: początkowa implementacja przyjmie nowe komunikaty i zapisze je przy użyciu dowolnego dołączonego delegata.</span><span class="sxs-lookup"><span data-stu-id="a0b02-140">Let's start small: the initial implementation will accept new messages, and write them using any attached delegate.</span></span> <span data-ttu-id="a0b02-141">Możesz rozpocząć od jednego delegata, który zapisuje komunikaty w konsoli programu.</span><span class="sxs-lookup"><span data-stu-id="a0b02-141">You can start with one delegate that writes messages to the console.</span></span>

[!code-csharp[LoggerImplementation](../../samples/csharp/delegates-and-events/Logger.cs#FirstImplementation "A first Logger implementation.")]

<span data-ttu-id="a0b02-142">Powyższa Klasa statyczna jest najprostszą czynnością, którą można obsłużyć.</span><span class="sxs-lookup"><span data-stu-id="a0b02-142">The static class above is the simplest thing that can work.</span></span> <span data-ttu-id="a0b02-143">Musimy napisać pojedynczą implementację metody, która zapisuje komunikaty w konsoli:</span><span class="sxs-lookup"><span data-stu-id="a0b02-143">We need to write the single implementation for the method that writes messages to the console:</span></span> 

[!code-csharp[LogToConsole](../../samples/csharp/delegates-and-events/LoggingMethods.cs#LogToConsole "A Console logger.")]

<span data-ttu-id="a0b02-144">Na koniec należy podłączyć delegata, dołączając go do delegata WriteMessage zadeklarowanego w rejestratorze:</span><span class="sxs-lookup"><span data-stu-id="a0b02-144">Finally, you need to hook up the delegate by attaching it to the WriteMessage delegate declared in the logger:</span></span>

[!code-csharp[ConnectDelegate](../../samples/csharp/delegates-and-events/Program.cs#ConnectDelegate "Connect to the delegate")]

## <a name="practices"></a><span data-ttu-id="a0b02-145">Procedur</span><span class="sxs-lookup"><span data-stu-id="a0b02-145">Practices</span></span>

<span data-ttu-id="a0b02-146">Nasz przykład jest dość prosty, ale nadal pokazuje niektóre z ważnych wytycznych dotyczących projektów obejmujących delegatów.</span><span class="sxs-lookup"><span data-stu-id="a0b02-146">Our sample so far is fairly simple, but it still demonstrates some of the important guidelines for designs involving delegates.</span></span>

<span data-ttu-id="a0b02-147">Użycie typów delegatów zdefiniowanych w podstawowym środowisku ułatwia użytkownikom pracę z delegatami.</span><span class="sxs-lookup"><span data-stu-id="a0b02-147">Using the delegate types defined in the Core Framework makes it easier for users to work with the delegates.</span></span> <span data-ttu-id="a0b02-148">Nie musisz definiować nowych typów, a deweloperzy korzystający z biblioteki nie muszą uczyć się nowych, wyspecjalizowanych typów delegatów.</span><span class="sxs-lookup"><span data-stu-id="a0b02-148">You don't need to define new types, and developers using your library do not need to learn new, specialized delegate types.</span></span>

<span data-ttu-id="a0b02-149">Używane interfejsy są minimalne i elastyczne, jak to możliwe: Aby utworzyć nowy Rejestrator danych wyjściowych, należy utworzyć jedną metodę.</span><span class="sxs-lookup"><span data-stu-id="a0b02-149">The interfaces used are as minimal and as flexible as possible: To create a new output logger, you must create one method.</span></span> <span data-ttu-id="a0b02-150">Ta metoda może być metodą statyczną lub metodą wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="a0b02-150">That method may be a static method, or an instance method.</span></span> <span data-ttu-id="a0b02-151">Może mieć dowolny dostęp.</span><span class="sxs-lookup"><span data-stu-id="a0b02-151">It may have any access.</span></span>

## <a name="formatting-output"></a><span data-ttu-id="a0b02-152">Formatowanie danych wyjściowych</span><span class="sxs-lookup"><span data-stu-id="a0b02-152">Formatting Output</span></span>

<span data-ttu-id="a0b02-153">Przypuśćmy, że ta pierwsza wersja jest nieco bardziej niezawodna, a następnie rozpocznie tworzenie innych mechanizmów rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="a0b02-153">Let's make this first version a bit more robust, and then start creating other logging mechanisms.</span></span>

<span data-ttu-id="a0b02-154">Następnie Dodajmy kilka argumentów do metody `LogMessage()`, aby Klasa log tworzyła bardziej uporządkowane komunikaty:</span><span class="sxs-lookup"><span data-stu-id="a0b02-154">Next, let's add a few arguments to the `LogMessage()` method so that your log class creates more structured messages:</span></span>

[!code-csharp[Severity](../../samples/csharp/delegates-and-events/Logger.cs#Severity "Define severities")]
[!code-csharp[NextLogger](../../samples/csharp/delegates-and-events/Logger.cs#LoggerTwo "Refine the Logger")]

<span data-ttu-id="a0b02-155">Następnie Użyjmy tego argumentu `Severity`, aby odfiltrować komunikaty wysyłane do danych wyjściowych dziennika.</span><span class="sxs-lookup"><span data-stu-id="a0b02-155">Next, let's make use of that `Severity` argument to filter the messages that are sent to the log's output.</span></span> 

[!code-csharp[FinalLogger](../../samples/csharp/delegates-and-events/Logger.cs#LoggerFinal "Finish the Logger")]

## <a name="practices"></a><span data-ttu-id="a0b02-156">Procedur</span><span class="sxs-lookup"><span data-stu-id="a0b02-156">Practices</span></span>

<span data-ttu-id="a0b02-157">Dodano nowe funkcje do infrastruktury rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="a0b02-157">You've added new features to the logging infrastructure.</span></span> <span data-ttu-id="a0b02-158">Ze względu na to, że składnik rejestratora jest bardzo luźno połączony z jakimkolwiek mechanizmem wyjścia, nowe funkcje mogą być dodawane bez wpływu na żaden kod implementujący delegata rejestratora.</span><span class="sxs-lookup"><span data-stu-id="a0b02-158">Because the logger component is very loosely coupled to any output mechanism, these new features can be added with no impact on any of the code implementing the logger delegate.</span></span>

<span data-ttu-id="a0b02-159">Podczas kompilowania tego procesu zobaczysz więcej przykładów, jak ten luźny sprzężenie zapewnia większą elastyczność aktualizowania części lokacji bez wprowadzania zmian w innych lokalizacjach.</span><span class="sxs-lookup"><span data-stu-id="a0b02-159">As you keep building this, you'll see more examples of how this loose coupling enables greater flexibility in updating parts of the site without any changes to other locations.</span></span> <span data-ttu-id="a0b02-160">W rzeczywistości klasy wyjściowe rejestratora mogą znajdować się w innym zestawie, a nawet nie muszą być odbudowane.</span><span class="sxs-lookup"><span data-stu-id="a0b02-160">In fact, in a larger application, the logger output classes might be in a different assembly, and not even need to be rebuilt.</span></span>

## <a name="building-a-second-output-engine"></a><span data-ttu-id="a0b02-161">Kompilowanie drugiego aparatu wyjściowego</span><span class="sxs-lookup"><span data-stu-id="a0b02-161">Building a Second Output Engine</span></span>

<span data-ttu-id="a0b02-162">Składnik dziennika jest również dobrze.</span><span class="sxs-lookup"><span data-stu-id="a0b02-162">The Log component is coming along well.</span></span> <span data-ttu-id="a0b02-163">Dodajmy do jednego aparatu wyjściowego, który zapisuje komunikaty do pliku.</span><span class="sxs-lookup"><span data-stu-id="a0b02-163">Let's add one more output engine that logs messages to a file.</span></span> <span data-ttu-id="a0b02-164">Będzie to nieco bardziej przeprowadzony aparat wyjściowy.</span><span class="sxs-lookup"><span data-stu-id="a0b02-164">This will be a slightly more involved output engine.</span></span> <span data-ttu-id="a0b02-165">Będzie to Klasa, która hermetyzuje operacje na plikach i gwarantuje, że plik jest zawsze zamykany po każdym zapisie.</span><span class="sxs-lookup"><span data-stu-id="a0b02-165">It will be a class that encapsulates the file operations, and ensures that the file is always closed after each write.</span></span> <span data-ttu-id="a0b02-166">Gwarantuje to, że wszystkie dane zostaną opróżnione na dysk po wygenerowaniu poszczególnych komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a0b02-166">That ensures that all the data is flushed to disk after each message is generated.</span></span>

<span data-ttu-id="a0b02-167">Oto ten Rejestrator oparty na plikach:</span><span class="sxs-lookup"><span data-stu-id="a0b02-167">Here is that file based logger:</span></span>

[!code-csharp[FileLogger](../../samples/csharp/delegates-and-events/FileLogger.cs#FileLogger "Log to files")]

<span data-ttu-id="a0b02-168">Po utworzeniu tej klasy można utworzyć jej wystąpienie i dołączyć jej metodę LogMessage do składnika rejestratora:</span><span class="sxs-lookup"><span data-stu-id="a0b02-168">Once you've created this class, you can instantiate it and it attaches its LogMessage method to the Logger component:</span></span>

[!code-csharp[FileLogger](../../samples/csharp/delegates-and-events/Program.cs#FileLogger "Log to files")]

<span data-ttu-id="a0b02-169">Te dwa nie wykluczają się wzajemnie.</span><span class="sxs-lookup"><span data-stu-id="a0b02-169">These two are not mutually exclusive.</span></span> <span data-ttu-id="a0b02-170">Można dołączyć zarówno metody rejestrowania, jak i generować komunikaty do konsoli programu i pliku:</span><span class="sxs-lookup"><span data-stu-id="a0b02-170">You could attach both log methods and generate messages to the console and a file:</span></span>

```csharp
var fileOutput = new FileLogger("log.txt");
Logger.WriteMessage += LoggingMethods.LogToConsole; // LoggingMethods is the static class we utilized earlier
```

<span data-ttu-id="a0b02-171">Później, nawet w tej samej aplikacji, można usunąć jednego z delegatów bez żadnych innych problemów do systemu:</span><span class="sxs-lookup"><span data-stu-id="a0b02-171">Later, even in the same application, you can remove one of the delegates without any other issues to the system:</span></span>

```csharp
Logger.WriteMessage -= LoggingMethods.LogToConsole;
```

## <a name="practices"></a><span data-ttu-id="a0b02-172">Procedur</span><span class="sxs-lookup"><span data-stu-id="a0b02-172">Practices</span></span>

<span data-ttu-id="a0b02-173">Teraz została dodana druga procedura obsługi danych wyjściowych dla podsystemu rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="a0b02-173">Now, you've added a second output handler for the logging sub-system.</span></span>
<span data-ttu-id="a0b02-174">Wymaga to nieco większej infrastruktury, aby prawidłowo obsługiwać system plików.</span><span class="sxs-lookup"><span data-stu-id="a0b02-174">This one needs a bit more infrastructure to correctly support the file system.</span></span> <span data-ttu-id="a0b02-175">Delegat jest metodą wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="a0b02-175">The delegate is an instance method.</span></span> <span data-ttu-id="a0b02-176">Jest to również Metoda prywatna.</span><span class="sxs-lookup"><span data-stu-id="a0b02-176">It's also a private method.</span></span>
<span data-ttu-id="a0b02-177">Nie ma potrzeby większego ułatwienia dostępu, ponieważ infrastruktura delegatów może połączyć delegatów.</span><span class="sxs-lookup"><span data-stu-id="a0b02-177">There's no need for greater accessibility because the delegate infrastructure can connect the delegates.</span></span>

<span data-ttu-id="a0b02-178">W drugim, projekt oparty na delegatach umożliwia wiele metod wyjściowych bez żadnego dodatkowego kodu.</span><span class="sxs-lookup"><span data-stu-id="a0b02-178">Second, the delegate-based design enables multiple output methods without any extra code.</span></span> <span data-ttu-id="a0b02-179">Nie trzeba tworzyć żadnej dodatkowej infrastruktury do obsługi wielu metod wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="a0b02-179">You don't need to build any additional infrastructure to support multiple output methods.</span></span> <span data-ttu-id="a0b02-180">Po prostu stają się one kolejną metodą na liście wywołań.</span><span class="sxs-lookup"><span data-stu-id="a0b02-180">They simply become another method on the invocation list.</span></span>

<span data-ttu-id="a0b02-181">Zwróć szczególną uwagę na kod w metodzie wyjściowej rejestrowania plików.</span><span class="sxs-lookup"><span data-stu-id="a0b02-181">Pay special attention to the code in the file logging output method.</span></span> <span data-ttu-id="a0b02-182">Jest on kodowany, aby upewnić się, że nie generuje żadnych wyjątków.</span><span class="sxs-lookup"><span data-stu-id="a0b02-182">It is coded to ensure that it does not throw any exceptions.</span></span> <span data-ttu-id="a0b02-183">Chociaż nie zawsze jest to konieczne, jest to często dobre rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="a0b02-183">While this isn't always strictly necessary, it's often a good practice.</span></span> <span data-ttu-id="a0b02-184">Jeśli jedna z metod delegatów zgłasza wyjątek, pozostałe Delegaty, które znajdują się w wywołaniu nie będą wywoływane.</span><span class="sxs-lookup"><span data-stu-id="a0b02-184">If either of the delegate methods throws an exception, the remaining delegates that are on the invocation won't be invoked.</span></span>

<span data-ttu-id="a0b02-185">W ostatniej notatce Rejestrator plików musi zarządzać swoimi zasobami, otwierając i zamykając plik w każdym komunikacie dziennika.</span><span class="sxs-lookup"><span data-stu-id="a0b02-185">As a last note, the file logger must manage its resources by opening and closing the file on each log message.</span></span> <span data-ttu-id="a0b02-186">Po zakończeniu pracy można pozostawić plik otwarty i zaimplementować interfejs IDisposable, aby zamknąć plik.</span><span class="sxs-lookup"><span data-stu-id="a0b02-186">You could choose to keep the file open and implement IDisposable to close the file when you are completed.</span></span>
<span data-ttu-id="a0b02-187">Każda metoda ma swoje zalety i wady.</span><span class="sxs-lookup"><span data-stu-id="a0b02-187">Either method has its advantages and disadvantages.</span></span> <span data-ttu-id="a0b02-188">Oba te elementy tworzą bit więcej sprzęgania między klasami.</span><span class="sxs-lookup"><span data-stu-id="a0b02-188">Both do create a bit more coupling between the classes.</span></span>

<span data-ttu-id="a0b02-189">Żaden kod w klasie rejestratorów nie musi zostać zaktualizowany w celu obsługi jednego z tych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="a0b02-189">None of the code in the Logger class would need to be updated in order to support either scenario.</span></span>

## <a name="handling-null-delegates"></a><span data-ttu-id="a0b02-190">Obsługa delegatów o wartości null</span><span class="sxs-lookup"><span data-stu-id="a0b02-190">Handling Null Delegates</span></span>

<span data-ttu-id="a0b02-191">Na koniec zaktualizujmy metodę LogMessage, tak aby była niezawodna dla tych przypadków, gdy nie wybrano żadnego mechanizmu wyjściowego.</span><span class="sxs-lookup"><span data-stu-id="a0b02-191">Finally, let's update the LogMessage method so that it is robust for those cases when no output mechanism is selected.</span></span> <span data-ttu-id="a0b02-192">Bieżąca implementacja zgłosi `NullReferenceException`, gdy delegat `WriteMessage` nie ma dołączonej listy wywołań.</span><span class="sxs-lookup"><span data-stu-id="a0b02-192">The current implementation will throw a `NullReferenceException` when the `WriteMessage` delegate does not have an invocation list attached.</span></span>
<span data-ttu-id="a0b02-193">Możesz preferować projekt, który jest dyskretnie kontynuowany, gdy nie dołączono żadnych metod.</span><span class="sxs-lookup"><span data-stu-id="a0b02-193">You may prefer a design that silently continues when no methods have been attached.</span></span> <span data-ttu-id="a0b02-194">Jest to proste użycie operatora warunkowego null, połączonego z metodą `Delegate.Invoke()`:</span><span class="sxs-lookup"><span data-stu-id="a0b02-194">This is easy using the null conditional operator, combined with the `Delegate.Invoke()` method:</span></span>

```csharp
public static void LogMessage(string msg)
{
    WriteMessage?.Invoke(msg);
}
```

<span data-ttu-id="a0b02-195">Dwuobwodowy operator warunkowy o wartości null (`?.`), gdy lewy argument operacji (`WriteMessage` w tym przypadku) ma wartość null, co oznacza, że nie podjęto próby zarejestrowania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="a0b02-195">The null conditional operator (`?.`) short-circuits when the left operand (`WriteMessage` in this case) is null, which means no attempt is made to log a message.</span></span>

<span data-ttu-id="a0b02-196">Nie znajdziesz metody `Invoke()` wymienionej w dokumentacji `System.Delegate` lub `System.MulticastDelegate`.</span><span class="sxs-lookup"><span data-stu-id="a0b02-196">You won't find the `Invoke()` method listed in the documentation for `System.Delegate` or `System.MulticastDelegate`.</span></span> <span data-ttu-id="a0b02-197">Kompilator generuje metodę `Invoke` bezpiecznego typu dla dowolnego zadeklarowanego typu delegata.</span><span class="sxs-lookup"><span data-stu-id="a0b02-197">The compiler generates a type safe `Invoke` method for any delegate type declared.</span></span> <span data-ttu-id="a0b02-198">W tym przykładzie oznacza to, że `Invoke` przyjmuje jeden argument `string` i ma zwracany typ void.</span><span class="sxs-lookup"><span data-stu-id="a0b02-198">In this example, that means `Invoke` takes a single `string` argument, and has a void return type.</span></span>

## <a name="summary-of-practices"></a><span data-ttu-id="a0b02-199">Podsumowanie praktyk</span><span class="sxs-lookup"><span data-stu-id="a0b02-199">Summary of Practices</span></span>

<span data-ttu-id="a0b02-200">Pojawiły się początek składnika dziennika, który można rozszerzyć za pomocą innych autorów i innych funkcji.</span><span class="sxs-lookup"><span data-stu-id="a0b02-200">You've seen the beginnings of a log component that could be expanded with other writers, and other features.</span></span> <span data-ttu-id="a0b02-201">Korzystając z delegatów w projekcie, te różne składniki są bardzo luźno sprzężone.</span><span class="sxs-lookup"><span data-stu-id="a0b02-201">By using delegates in the design these different components are very loosely coupled.</span></span> <span data-ttu-id="a0b02-202">Zapewnia to kilka korzyści.</span><span class="sxs-lookup"><span data-stu-id="a0b02-202">This provides several advantages.</span></span> <span data-ttu-id="a0b02-203">Łatwo jest utworzyć nowe mechanizmy wyjściowe i dołączyć je do systemu.</span><span class="sxs-lookup"><span data-stu-id="a0b02-203">It's very easy to create new output mechanisms and attach them to the system.</span></span> <span data-ttu-id="a0b02-204">Te inne mechanizmy potrzebują tylko jednej metody: metoda, która zapisuje komunikat dziennika.</span><span class="sxs-lookup"><span data-stu-id="a0b02-204">These other mechanisms only need one method: the method that writes the log message.</span></span> <span data-ttu-id="a0b02-205">Jest to projekt, który jest bardzo odporny po dodaniu nowych funkcji.</span><span class="sxs-lookup"><span data-stu-id="a0b02-205">It's a design that is very resilient when new features are added.</span></span> <span data-ttu-id="a0b02-206">Kontrakt wymagany dla każdego składnika zapisywania programu to implementacja jednej metody.</span><span class="sxs-lookup"><span data-stu-id="a0b02-206">The contract required for any writer is to implement one method.</span></span> <span data-ttu-id="a0b02-207">Ta metoda może być metodą statyczną lub wystąpieniem.</span><span class="sxs-lookup"><span data-stu-id="a0b02-207">That method could be a static or instance method.</span></span> <span data-ttu-id="a0b02-208">Może to być publiczne, prywatne lub inny dostęp prawny.</span><span class="sxs-lookup"><span data-stu-id="a0b02-208">It could be public, private, or any other legal access.</span></span>

<span data-ttu-id="a0b02-209">Klasa rejestratora może wprowadzać dowolną liczbę ulepszeń lub zmian bez wprowadzania istotnych zmian.</span><span class="sxs-lookup"><span data-stu-id="a0b02-209">The Logger class can make any number of enhancements or changes without introducing breaking changes.</span></span> <span data-ttu-id="a0b02-210">Podobnie jak w przypadku każdej klasy, nie można zmodyfikować publicznego interfejsu API bez ryzyka naruszenia zmian.</span><span class="sxs-lookup"><span data-stu-id="a0b02-210">Like any class, you cannot modify the public API without the risk of breaking changes.</span></span> <span data-ttu-id="a0b02-211">Jednak ponieważ sprzężenie między rejestratorem a wszystkimi aparatami wyjściowymi odbywa się tylko za pomocą delegata, nie są wykorzystywane żadne inne typy (takie jak interfejsy lub klasy bazowe).</span><span class="sxs-lookup"><span data-stu-id="a0b02-211">But, because the coupling between the logger and any output engines is only through the delegate, no other types (like interfaces or base classes) are involved.</span></span> <span data-ttu-id="a0b02-212">Sprzęganie jest tak małe, jak to możliwe.</span><span class="sxs-lookup"><span data-stu-id="a0b02-212">The coupling is as small as possible.</span></span>

[<span data-ttu-id="a0b02-213">Next</span><span class="sxs-lookup"><span data-stu-id="a0b02-213">Next</span></span>](events-overview.md)
