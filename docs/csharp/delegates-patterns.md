---
title: Wspólne wzorce dla delegatów
description: Poznaj typowe wzorce do używania delegatów w kodzie w celu uniknięcia silne sprzężenia między składnikami.
ms.date: 06/20/2016
ms.assetid: 0ff8fdfd-6a11-4327-b061-0f2526f35b43
ms.openlocfilehash: ea0e0b7af361b76c4b46b0a180e07b44c1fa07e1
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/18/2019
ms.locfileid: "59095701"
---
# <a name="common-patterns-for-delegates"></a><span data-ttu-id="aa68a-103">Wspólne wzorce dla delegatów</span><span class="sxs-lookup"><span data-stu-id="aa68a-103">Common Patterns for Delegates</span></span>

[<span data-ttu-id="aa68a-104">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="aa68a-104">Previous</span></span>](delegates-strongly-typed.md)

<span data-ttu-id="aa68a-105">Delegaty zapewniają mechanizm, który umożliwia projekty oprogramowania obejmujące minimalny sprzężenia między składnikami.</span><span class="sxs-lookup"><span data-stu-id="aa68a-105">Delegates provide a mechanism that enables software designs involving minimal coupling between components.</span></span>

<span data-ttu-id="aa68a-106">Przykładem doskonałe dla tego rodzaju projektu jest LINQ.</span><span class="sxs-lookup"><span data-stu-id="aa68a-106">One excellent example for this kind of design is LINQ.</span></span> <span data-ttu-id="aa68a-107">Wzorzec wyrażenia zapytań LINQ, zależy od delegatów dla wszystkich funkcji.</span><span class="sxs-lookup"><span data-stu-id="aa68a-107">The LINQ Query Expression Pattern relies on delegates for all of its features.</span></span> <span data-ttu-id="aa68a-108">Należy wziąć pod uwagę ten prosty przykład:</span><span class="sxs-lookup"><span data-stu-id="aa68a-108">Consider this simple example:</span></span>

```csharp
var smallNumbers = numbers.Where(n => n < 10);
```

<span data-ttu-id="aa68a-109">Filtruje numery tylko te mniejsza niż wartość 10.</span><span class="sxs-lookup"><span data-stu-id="aa68a-109">This filters the sequence of numbers to only those less than the value 10.</span></span>
<span data-ttu-id="aa68a-110">`Where` Metoda używa delegata, która określa, które elementy sekwencji przekazać filtru.</span><span class="sxs-lookup"><span data-stu-id="aa68a-110">The `Where` method uses a delegate that determines which elements of a sequence pass the filter.</span></span> <span data-ttu-id="aa68a-111">Podczas tworzenia zapytania LINQ podajesz implementację delegata do tego określonego celu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-111">When you create a LINQ query, you supply the implementation of the delegate for this specific purpose.</span></span>

<span data-ttu-id="aa68a-112">Prototyp w którym metoda jest:</span><span class="sxs-lookup"><span data-stu-id="aa68a-112">The prototype for the Where method is:</span></span>

```csharp
public static IEnumerable<TSource> Where<TSource> (this IEnumerable<TSource> source, Func<TSource, bool> predicate);
```

<span data-ttu-id="aa68a-113">W tym przykładzie jest powtarzany za pomocą metod, które są częścią LINQ.</span><span class="sxs-lookup"><span data-stu-id="aa68a-113">This example is repeated with all the methods that are part of LINQ.</span></span> <span data-ttu-id="aa68a-114">Wszystkie korzystają z delegatów dla kodu, który zarządza użytego zapytania.</span><span class="sxs-lookup"><span data-stu-id="aa68a-114">They all rely on delegates for the code that manages the specific query.</span></span> <span data-ttu-id="aa68a-115">Ten wzorzec projektowania interfejsu API jest bardzo zaawansowane i zrozumieć.</span><span class="sxs-lookup"><span data-stu-id="aa68a-115">This API design pattern is a very powerful one to learn and understand.</span></span>

<span data-ttu-id="aa68a-116">Ten prosty przykład ilustruje, jak delegatów wymaga bardzo mało sprzężenia między składnikami.</span><span class="sxs-lookup"><span data-stu-id="aa68a-116">This simple example illustrates how delegates require very little coupling between components.</span></span> <span data-ttu-id="aa68a-117">Nie trzeba utworzyć klasę, która pochodzi od konkretnej klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="aa68a-117">You don't need to create a class that derives from a particular base class.</span></span> <span data-ttu-id="aa68a-118">Nie ma potrzeby implementowania określonego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-118">You don't need to implement a specific interface.</span></span>
<span data-ttu-id="aa68a-119">Jedynym wymaganiem jest zapewnienie stosowania jedną metodę, która ma podstawowe znaczenie dla wykonywanego zadania.</span><span class="sxs-lookup"><span data-stu-id="aa68a-119">The only requirement is to provide the implementation of one method that is fundamental to the task at hand.</span></span>

## <a name="building-your-own-components-with-delegates"></a><span data-ttu-id="aa68a-120">Tworzenie składników przy użyciu delegatów</span><span class="sxs-lookup"><span data-stu-id="aa68a-120">Building Your Own Components with Delegates</span></span>

<span data-ttu-id="aa68a-121">Utworzymy w tym przykładzie, tworząc składnika za pomocą projektu, który opiera się na delegatów.</span><span class="sxs-lookup"><span data-stu-id="aa68a-121">Let's build on that example by creating a component using a design that relies on delegates.</span></span>

<span data-ttu-id="aa68a-122">Czynnością jest zdefiniowanie składnika, która mogłaby być używana dla dziennika komunikatów w dużym systemie.</span><span class="sxs-lookup"><span data-stu-id="aa68a-122">Let's define a component that could be used for log messages in a large system.</span></span> <span data-ttu-id="aa68a-123">Składniki biblioteki można używać w wielu różnych środowiskach, na wielu różnych platformach.</span><span class="sxs-lookup"><span data-stu-id="aa68a-123">The library components could be used in many different environments, on multiple different platforms.</span></span> <span data-ttu-id="aa68a-124">Istnieje wiele typowych funkcji w składniku, który zarządza dzienniki.</span><span class="sxs-lookup"><span data-stu-id="aa68a-124">There are a lot of common features in the component that manages the logs.</span></span> <span data-ttu-id="aa68a-125">Trzeba będzie ją akceptować komunikaty z dowolnego składnika w systemie.</span><span class="sxs-lookup"><span data-stu-id="aa68a-125">It will need to accept messages from any component in the system.</span></span> <span data-ttu-id="aa68a-126">Te komunikaty mają różne priorytety, których składnik core można zarządzać.</span><span class="sxs-lookup"><span data-stu-id="aa68a-126">Those messages will have different priorities, which the core component can manage.</span></span> <span data-ttu-id="aa68a-127">Komunikatów mają sygnatury czasowe w ostatecznej postaci zarchiwizowane.</span><span class="sxs-lookup"><span data-stu-id="aa68a-127">The messages should have timestamps in their final archived form.</span></span> <span data-ttu-id="aa68a-128">Dla bardziej zaawansowanych scenariuszy można filtrować wiadomości przez składnik źródłowy.</span><span class="sxs-lookup"><span data-stu-id="aa68a-128">For more advanced scenarios, you could filter messages by the source component.</span></span>

<span data-ttu-id="aa68a-129">Istnieje jeden z aspektów funkcji, która zmieni się często: gdy komunikaty są zapisywane.</span><span class="sxs-lookup"><span data-stu-id="aa68a-129">There is one aspect of the feature that will change often: where messages are written.</span></span> <span data-ttu-id="aa68a-130">W niektórych środowiskach może zostać wyświetlony w konsoli błędu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-130">In some environments, they may be written to the error console.</span></span> <span data-ttu-id="aa68a-131">W innych, plik.</span><span class="sxs-lookup"><span data-stu-id="aa68a-131">In others, a file.</span></span> <span data-ttu-id="aa68a-132">Inne możliwości obejmują Magazyn bazy danych, dzienników zdarzeń systemu operacyjnego lub innych przechowywania dokumentów.</span><span class="sxs-lookup"><span data-stu-id="aa68a-132">Other possibilities include database storage, OS event logs, or other document storage.</span></span>

<span data-ttu-id="aa68a-133">Dostępne są także kombinacji danych wyjściowych, które mogą być używane w różnych scenariuszach.</span><span class="sxs-lookup"><span data-stu-id="aa68a-133">There are also combinations of output that might be used in different scenarios.</span></span> <span data-ttu-id="aa68a-134">Możesz chcieć zapisywania komunikatów w konsoli oraz w pliku.</span><span class="sxs-lookup"><span data-stu-id="aa68a-134">You may want to write messages to the console and to a file.</span></span>

<span data-ttu-id="aa68a-135">Projektowanie oparte na delegatach zapewniają dużą elastyczność i ułatwić obsługę magazynu mechanizmów, które mogą zostać dodane w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="aa68a-135">A design based on delegates will provide a great deal of flexibility, and make it easy to support storage mechanisms that may be added in the future.</span></span>

<span data-ttu-id="aa68a-136">W tym projekcie dziennika podstawowego składnika może być niewirtualną, nawet zapieczętowanych klas.</span><span class="sxs-lookup"><span data-stu-id="aa68a-136">Under this design, the primary log component can be a non-virtual, even sealed class.</span></span> <span data-ttu-id="aa68a-137">Można dodać dowolny zbiór delegatów do zapisywania komunikatów do innego magazynu multimediów.</span><span class="sxs-lookup"><span data-stu-id="aa68a-137">You can plug in any set of delegates to write the messages to different storage media.</span></span> <span data-ttu-id="aa68a-138">Obsługa wbudowane obiekty delegowane multiemisji można łatwo obsługiwane scenariusze, w której wiadomości musi być napisana w wielu lokalizacjach (plik i konsoli).</span><span class="sxs-lookup"><span data-stu-id="aa68a-138">The built in support for multicast delegates makes it easy to support scenarios where messages must be written to multiple locations (a file, and a console).</span></span>

## <a name="a-first-implementation"></a><span data-ttu-id="aa68a-139">Pierwszy implementacji</span><span class="sxs-lookup"><span data-stu-id="aa68a-139">A First Implementation</span></span>

<span data-ttu-id="aa68a-140">Zacznijmy od małych: wstępne wdrożenie będzie akceptować nowe wiadomości i zapisać je przy użyciu dowolnego dołączonego delegata.</span><span class="sxs-lookup"><span data-stu-id="aa68a-140">Let's start small: the initial implementation will accept new messages, and write them using any attached delegate.</span></span> <span data-ttu-id="aa68a-141">Można uruchomić za pomocą jednego delegata, która wypisuje komunikaty na konsoli.</span><span class="sxs-lookup"><span data-stu-id="aa68a-141">You can start with one delegate that writes messages to the console.</span></span>

[!code-csharp[LoggerImplementation](../../samples/csharp/delegates-and-events/Logger.cs#FirstImplementation "A first Logger implementation.")]

<span data-ttu-id="aa68a-142">Klasa statyczna powyżej jest najprostszym rzecz, którą można pracować.</span><span class="sxs-lookup"><span data-stu-id="aa68a-142">The static class above is the simplest thing that can work.</span></span> <span data-ttu-id="aa68a-143">Potrzebujemy do zapisania pojedynczej implementacji metody, która wypisuje komunikaty na konsoli:</span><span class="sxs-lookup"><span data-stu-id="aa68a-143">We need to write the single implementation for the method that writes messages to the console:</span></span> 

[!code-csharp[LogToConsole](../../samples/csharp/delegates-and-events/Program.cs#LogToConsole "A Console logger.")]

<span data-ttu-id="aa68a-144">Na koniec należy Podłączanie delegata, dołączając ją do WriteMessage delegatów zadeklarowanych w rejestratora:</span><span class="sxs-lookup"><span data-stu-id="aa68a-144">Finally, you need to hook up the delegate by attaching it to the WriteMessage delegate declared in the logger:</span></span>

[!code-csharp[ConnectDelegate](../../samples/csharp/delegates-and-events/Program.cs#ConnectDelegate "Connect to the delegate")]

## <a name="practices"></a><span data-ttu-id="aa68a-145">Rozwiązania</span><span class="sxs-lookup"><span data-stu-id="aa68a-145">Practices</span></span>

<span data-ttu-id="aa68a-146">Do tej pory naszego przykładu jest dość prosta, ale nadal pokazuje niektóre ważne wskazówki dotyczące projektów obejmujących delegatów.</span><span class="sxs-lookup"><span data-stu-id="aa68a-146">Our sample so far is fairly simple, but it still demonstrates some of the important guidelines for designs involving delegates.</span></span>

<span data-ttu-id="aa68a-147">Przy użyciu typy delegatów, określone w ramach Core ułatwia użytkownikom pracę z delegatów.</span><span class="sxs-lookup"><span data-stu-id="aa68a-147">Using the delegate types defined in the Core Framework makes it easier for users to work with the delegates.</span></span> <span data-ttu-id="aa68a-148">Nie trzeba definiować nowe typy i nie trzeba Dowiedz się, typy delegatów nowe, wyspecjalizowany deweloperzy korzystający z biblioteki.</span><span class="sxs-lookup"><span data-stu-id="aa68a-148">You don't need to define new types, and developers using your library do not need to learn new, specialized delegate types.</span></span>

<span data-ttu-id="aa68a-149">Interfejsy używane są możliwie i jak najbardziej elastyczny: Aby utworzyć nowego rejestratora danych wyjściowych, należy utworzyć jedną z metod.</span><span class="sxs-lookup"><span data-stu-id="aa68a-149">The interfaces used are as minimal and as flexible as possible: To create a new output logger, you must create one method.</span></span> <span data-ttu-id="aa68a-150">Ta metoda może być metodą statyczną lub metodą wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="aa68a-150">That method may be a static method, or an instance method.</span></span> <span data-ttu-id="aa68a-151">Może mieć dostęp do wszystkich.</span><span class="sxs-lookup"><span data-stu-id="aa68a-151">It may have any access.</span></span>

## <a name="formatting-output"></a><span data-ttu-id="aa68a-152">Formatowanie danych wyjściowych</span><span class="sxs-lookup"><span data-stu-id="aa68a-152">Formatting Output</span></span>

<span data-ttu-id="aa68a-153">Upewnijmy się pierwszej wersji bitowych bardziej niezawodne i ponownie uruchomić tworzenie innych mechanizmów rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="aa68a-153">Let's make this first version a bit more robust, and then start creating other logging mechanisms.</span></span>

<span data-ttu-id="aa68a-154">Następnie Dodajmy kilka argumentów `LogMessage()` metody, aby klasa dziennika tworzy więcej wiadomości ze strukturą:</span><span class="sxs-lookup"><span data-stu-id="aa68a-154">Next, let's add a few arguments to the `LogMessage()` method so that your log class creates more structured messages:</span></span>

[!code-csharp[Severity](../../samples/csharp/delegates-and-events/Logger.cs#Severity "Define severities")]
[!code-csharp[NextLogger](../../samples/csharp/delegates-and-events/Logger.cs#LoggerTwo "Refine the Logger")]

<span data-ttu-id="aa68a-155">Następnie upewnijmy się, użyj tego `Severity` argument do filtrowania wiadomości, które są wysyłane do dziennika danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="aa68a-155">Next, let's make use of that `Severity` argument to filter the messages that are sent to the log's output.</span></span> 

[!code-csharp[FinalLogger](../../samples/csharp/delegates-and-events/Logger.cs#LoggerFinal "Finish the Logger")]

## <a name="practices"></a><span data-ttu-id="aa68a-156">Rozwiązania</span><span class="sxs-lookup"><span data-stu-id="aa68a-156">Practices</span></span>

<span data-ttu-id="aa68a-157">Nowe funkcje dodano do infrastruktury rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="aa68a-157">You've added new features to the logging infrastructure.</span></span> <span data-ttu-id="aa68a-158">Ponieważ składnika modułu logującego się bardzo luźno mechanizmu żadnych danych wyjściowych, można dodać te nowe funkcje bez wpływu na dowolny kod Implementowanie delegata rejestratora.</span><span class="sxs-lookup"><span data-stu-id="aa68a-158">Because the logger component is very loosely coupled to any output mechanism, these new features can be added with no impact on any of the code implementing the logger delegate.</span></span>

<span data-ttu-id="aa68a-159">Jak zachować możesz tworzyć, zobaczysz więcej przykładów jak tym luźne powiązanie umożliwia większą elastyczność w aktualizację części witryny bez konieczności wprowadzania zmian do innych lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="aa68a-159">As you keep building this, you'll see more examples of how this loose coupling enables greater flexibility in updating parts of the site without any changes to other locations.</span></span> <span data-ttu-id="aa68a-160">W rzeczywistości w większej aplikacji klasy wyjściowe rejestratora może znajdować się w innym zestawie, a nawet konieczne jest ponowne skompilowanie.</span><span class="sxs-lookup"><span data-stu-id="aa68a-160">In fact, in a larger application, the logger output classes might be in a different assembly, and not even need to be rebuilt.</span></span>

## <a name="building-a-second-output-engine"></a><span data-ttu-id="aa68a-161">Tworzenie drugiej aparatu danych wyjściowych</span><span class="sxs-lookup"><span data-stu-id="aa68a-161">Building a Second Output Engine</span></span>

<span data-ttu-id="aa68a-162">Składnik Log pochodzi wzdłuż dobrze.</span><span class="sxs-lookup"><span data-stu-id="aa68a-162">The Log component is coming along well.</span></span> <span data-ttu-id="aa68a-163">Dodajmy jeden więcej aparat danych wyjściowych, który rejestruje komunikaty w pliku.</span><span class="sxs-lookup"><span data-stu-id="aa68a-163">Let's add one more output engine that logs messages to a file.</span></span> <span data-ttu-id="aa68a-164">Są to wymaga nieco więcej wysiłku aparatu danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="aa68a-164">This will be a slightly more involved output engine.</span></span> <span data-ttu-id="aa68a-165">Będzie ona klasę, która hermetyzuje operacji na plikach i gwarantuje, że plik jest zawsze zamknięte po każdym zapisie.</span><span class="sxs-lookup"><span data-stu-id="aa68a-165">It will be a class that encapsulates the file operations, and ensures that the file is always closed after each write.</span></span> <span data-ttu-id="aa68a-166">Który zapewnia, że wszystkie dane jest opróżniany do dysku po każdy komunikat jest generowany.</span><span class="sxs-lookup"><span data-stu-id="aa68a-166">That ensures that all the data is flushed to disk after each message is generated.</span></span>

<span data-ttu-id="aa68a-167">Oto rejestratora tego pliku:</span><span class="sxs-lookup"><span data-stu-id="aa68a-167">Here is that file based logger:</span></span>

[!code-csharp[FileLogger](../../samples/csharp/delegates-and-events/FileLogger.cs#FileLogger "Log to files")]

<span data-ttu-id="aa68a-168">Po utworzeniu tej klasy tworzenia jego instancji i jego logmessage — metoda dołącza do składnika modułu logującego:</span><span class="sxs-lookup"><span data-stu-id="aa68a-168">Once you've created this class, you can instantiate it and it attaches its LogMessage method to the Logger component:</span></span>

[!code-csharp[FileLogger](../../samples/csharp/delegates-and-events/Program.cs#FileLogger "Log to files")]

<span data-ttu-id="aa68a-169">Te dwa nie wykluczają się wzajemnie.</span><span class="sxs-lookup"><span data-stu-id="aa68a-169">These two are not mutually exclusive.</span></span> <span data-ttu-id="aa68a-170">Można dołączyć obu metod dziennika i generowanie wiadomości do konsoli i plik:</span><span class="sxs-lookup"><span data-stu-id="aa68a-170">You could attach both log methods and generate messages to the console and a file:</span></span>

```csharp
var fileOutput = new FileLogger("log.txt");
Logger.WriteMessage += LogToConsole;
```

<span data-ttu-id="aa68a-171">Później nawet w tej samej aplikacji, możesz usunąć jeden z obiektów delegowanych, bez żadnych innych problemów w systemie:</span><span class="sxs-lookup"><span data-stu-id="aa68a-171">Later, even in the same application, you can remove one of the delegates without any other issues to the system:</span></span>

```csharp
Logger.WriteMessage -= LogToConsole;
```

## <a name="practices"></a><span data-ttu-id="aa68a-172">Rozwiązania</span><span class="sxs-lookup"><span data-stu-id="aa68a-172">Practices</span></span>

<span data-ttu-id="aa68a-173">Teraz dodaniu drugiego danych wyjściowych procedury obsługi na potrzeby rejestrowania podsystemu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-173">Now, you've added a second output handler for the logging sub-system.</span></span>
<span data-ttu-id="aa68a-174">Ten zestaw wymaga nieco więcej infrastruktury do poprawnie obsługiwać system plików.</span><span class="sxs-lookup"><span data-stu-id="aa68a-174">This one needs a bit more infrastructure to correctly support the file system.</span></span> <span data-ttu-id="aa68a-175">Delegat jest metodą wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="aa68a-175">The delegate is an instance method.</span></span> <span data-ttu-id="aa68a-176">Jest również metody prywatnej.</span><span class="sxs-lookup"><span data-stu-id="aa68a-176">It's also a private method.</span></span>
<span data-ttu-id="aa68a-177">Nie ma potrzeby lepsze ułatwienia dostępu, ponieważ infrastruktury delegata można połączyć delegatów.</span><span class="sxs-lookup"><span data-stu-id="aa68a-177">There's no need for greater accessibility because the delegate infrastructure can connect the delegates.</span></span>

<span data-ttu-id="aa68a-178">Po drugie projektowanie oparte na delegatach umożliwia wielu metod wyjścia metod bez konieczności wprowadzania dodatkowego kodu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-178">Second, the delegate-based design enables multiple output methods without any extra code.</span></span> <span data-ttu-id="aa68a-179">Nie trzeba tworzyć jakiejkolwiek dodatkowej infrastruktury do obsługi wielu metod wyjścia.</span><span class="sxs-lookup"><span data-stu-id="aa68a-179">You don't need to build any additional infrastructure to support multiple output methods.</span></span> <span data-ttu-id="aa68a-180">Po prostu stają się one innej metody na liście wywołania.</span><span class="sxs-lookup"><span data-stu-id="aa68a-180">They simply become another method on the invocation list.</span></span>

<span data-ttu-id="aa68a-181">Należy zwrócić szczególną uwagę na kod w pliku rejestrowania metoda danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="aa68a-181">Pay special attention to the code in the file logging output method.</span></span> <span data-ttu-id="aa68a-182">Jest on kodowane, aby upewnić się, że nie generuje żadnych wyjątków.</span><span class="sxs-lookup"><span data-stu-id="aa68a-182">It is coded to ensure that it does not throw any exceptions.</span></span> <span data-ttu-id="aa68a-183">Chociaż nie jest to niezbędne, jest często dobrym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="aa68a-183">While this isn't always strictly necessary, it's often a good practice.</span></span> <span data-ttu-id="aa68a-184">Jeśli jednej z metod delegata zgłasza wyjątek, nie można wywołać pozostałych obiektów delegowanych, które znajdują się na wywołanie.</span><span class="sxs-lookup"><span data-stu-id="aa68a-184">If either of the delegate methods throws an exception, the remaining delegates that are on the invocation won't be invoked.</span></span>

<span data-ttu-id="aa68a-185">Jako ostatni notatki rejestratora plików muszą zarządzać jego zasobów otwierający i zamykający go na wszystkich komunikatach dziennika.</span><span class="sxs-lookup"><span data-stu-id="aa68a-185">As a last note, the file logger must manage its resources by opening and closing the file on each log message.</span></span> <span data-ttu-id="aa68a-186">Można pozostawić otwarty plik i zaimplementuj interfejs IDisposable, aby zamknąć go po zakończeniu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-186">You could choose to keep the file open and implement IDisposable to close the file when you are completed.</span></span>
<span data-ttu-id="aa68a-187">Każda metoda ma swoje zalety i wady.</span><span class="sxs-lookup"><span data-stu-id="aa68a-187">Either method has its advantages and disadvantages.</span></span> <span data-ttu-id="aa68a-188">Obie umożliwiają tworzenie bardziej sprzężenia między klasami.</span><span class="sxs-lookup"><span data-stu-id="aa68a-188">Both do create a bit more coupling between the classes.</span></span>

<span data-ttu-id="aa68a-189">Brak kodu w klasie rejestratora musi zostać zaktualizowane w celu obsługi dowolnego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="aa68a-189">None of the code in the Logger class would need to be updated in order to support either scenario.</span></span>

## <a name="handling-null-delegates"></a><span data-ttu-id="aa68a-190">Obsługa wartości Null delegatów</span><span class="sxs-lookup"><span data-stu-id="aa68a-190">Handling Null Delegates</span></span>

<span data-ttu-id="aa68a-191">Na koniec spróbujmy aktualizacji logmessage — metoda, aby był niezawodny dla tych przypadków, gdy żaden mechanizm danych wyjściowych jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="aa68a-191">Finally, let's update the LogMessage method so that it is robust for those cases when no output mechanism is selected.</span></span> <span data-ttu-id="aa68a-192">Bieżąca implementacja spowoduje zgłoszenie `NullReferenceException` podczas `WriteMessage` delegat nie ma listę wywołań, który jest dołączony.</span><span class="sxs-lookup"><span data-stu-id="aa68a-192">The current implementation will throw a `NullReferenceException` when the `WriteMessage` delegate does not have an invocation list attached.</span></span>
<span data-ttu-id="aa68a-193">Możesz projekt, który dyskretnie kontynuowana po dołączono żadnych metod.</span><span class="sxs-lookup"><span data-stu-id="aa68a-193">You may prefer a design that silently continues when no methods have been attached.</span></span> <span data-ttu-id="aa68a-194">Jest to łatwe za pomocą operatora warunkowego wartości null, w połączeniu z `Delegate.Invoke()` metody:</span><span class="sxs-lookup"><span data-stu-id="aa68a-194">This is easy using the null conditional operator, combined with the `Delegate.Invoke()` method:</span></span>

```csharp
public static void LogMessage(string msg)
{
    WriteMessage?.Invoke(msg);
}
```

<span data-ttu-id="aa68a-195">Operator warunkowy o wartości null (`?.`) short-circuits, kiedy Lewy argument operacji (`WriteMessage` w tym przypadku) ma wartość null, oznacza to, aby zarejestrować komunikat jest podejmowana próba.</span><span class="sxs-lookup"><span data-stu-id="aa68a-195">The null conditional operator (`?.`) short-circuits when the left operand (`WriteMessage` in this case) is null, which means no attempt is made to log a message.</span></span>

<span data-ttu-id="aa68a-196">Nie odnajdzie `Invoke()` metody wymienione w dokumentacji dotyczącej `System.Delegate` lub `System.MulticastDelegate`.</span><span class="sxs-lookup"><span data-stu-id="aa68a-196">You won't find the `Invoke()` method listed in the documentation for `System.Delegate` or `System.MulticastDelegate`.</span></span> <span data-ttu-id="aa68a-197">Kompilator generuje bezpieczny `Invoke` metody dla każdego delegować deklaracji typu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-197">The compiler generates a type safe `Invoke` method for any delegate type declared.</span></span> <span data-ttu-id="aa68a-198">W tym przykładzie, oznacza to, `Invoke` przyjmuje jeden `string` argument, a ma zwracać typ void.</span><span class="sxs-lookup"><span data-stu-id="aa68a-198">In this example, that means `Invoke` takes a single `string` argument, and has a void return type.</span></span>

## <a name="summary-of-practices"></a><span data-ttu-id="aa68a-199">Podsumowanie rozwiązań</span><span class="sxs-lookup"><span data-stu-id="aa68a-199">Summary of Practices</span></span>

<span data-ttu-id="aa68a-200">Po zapoznaniu początku składnik dziennika, który może zostać rozszerzona przy użyciu innych składników zapisywania i innych funkcji.</span><span class="sxs-lookup"><span data-stu-id="aa68a-200">You've seen the beginnings of a log component that could be expanded with other writers, and other features.</span></span> <span data-ttu-id="aa68a-201">Przy użyciu delegatów w projekcie te składniki są bardzo luźno powiązane.</span><span class="sxs-lookup"><span data-stu-id="aa68a-201">By using delegates in the design these different components are very loosely coupled.</span></span> <span data-ttu-id="aa68a-202">Dzięki temu można ze sobą pewne korzyści.</span><span class="sxs-lookup"><span data-stu-id="aa68a-202">This provides several advantages.</span></span> <span data-ttu-id="aa68a-203">Jest bardzo proste utworzyć nowe mechanizmy danych wyjściowych i dołącz je do systemu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-203">It's very easy to create new output mechanisms and attach them to the system.</span></span> <span data-ttu-id="aa68a-204">Te inne mechanizmy wymagane jest tylko jedna metoda: metoda, która zapisuje komunikat w dzienniku.</span><span class="sxs-lookup"><span data-stu-id="aa68a-204">These other mechanisms only need one method: the method that writes the log message.</span></span> <span data-ttu-id="aa68a-205">Jest to projekt, który jest bardzo odporne na błędy, gdy zostaną dodane nowe funkcje.</span><span class="sxs-lookup"><span data-stu-id="aa68a-205">It's a design that is very resilient when new features are added.</span></span> <span data-ttu-id="aa68a-206">Kontrakt wymagane dla dowolnego edytora jest zaimplementować jedną z metod.</span><span class="sxs-lookup"><span data-stu-id="aa68a-206">The contract required for any writer is to implement one method.</span></span> <span data-ttu-id="aa68a-207">Tej metody może być statyczną lub metodę wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="aa68a-207">That method could be a static or instance method.</span></span> <span data-ttu-id="aa68a-208">Można prywatnej, publicznej lub innym prawne dostępu.</span><span class="sxs-lookup"><span data-stu-id="aa68a-208">It could be public, private, or any other legal access.</span></span>

<span data-ttu-id="aa68a-209">Klasa rejestratora wprowadzać dowolną liczbę ulepszenia lub zmiany bez wprowadzania istotnych zmian.</span><span class="sxs-lookup"><span data-stu-id="aa68a-209">The Logger class can make any number of enhancements or changes without introducing breaking changes.</span></span> <span data-ttu-id="aa68a-210">Podobnie jak dowolnej klasy nie można zmodyfikować publiczny interfejs API bez ryzyka istotne zmiany.</span><span class="sxs-lookup"><span data-stu-id="aa68a-210">Like any class, you cannot modify the public API without the risk of breaking changes.</span></span> <span data-ttu-id="aa68a-211">Jednak ponieważ sprzężenie między rejestratora i aparaty żadnych danych wyjściowych jest wyłącznie za pośrednictwem delegata, żadne inne typy (takich jak interfejsy lub klas bazowych) są zaangażowane.</span><span class="sxs-lookup"><span data-stu-id="aa68a-211">But, because the coupling between the logger and any output engines is only through the delegate, no other types (like interfaces or base classes) are involved.</span></span> <span data-ttu-id="aa68a-212">Sprzężenia jest tak małej, jak to możliwe.</span><span class="sxs-lookup"><span data-stu-id="aa68a-212">The coupling is as small as possible.</span></span>

[<span data-ttu-id="aa68a-213">Next</span><span class="sxs-lookup"><span data-stu-id="aa68a-213">Next</span></span>](events-overview.md)
