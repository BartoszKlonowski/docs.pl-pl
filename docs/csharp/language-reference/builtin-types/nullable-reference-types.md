---
title: Typy odwołań z dopuszczalną wartością null — odwołanie do języka C#
description: Dowiedz się więcej o typach odwołań do wartości null w języku C# i o tym, jak z nich korzystać
ms.date: 04/06/2020
ms.openlocfilehash: cbc7397ac76b43b79a4168f4c61fe2c631b4a46b
ms.sourcegitcommit: 2b3b2d684259463ddfc76ad680e5e09fdc1984d2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/08/2020
ms.locfileid: "80888317"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="8cd42-103">Typy odwołań z dopuszczalną wartości null (odwołanie do języka C#)</span><span class="sxs-lookup"><span data-stu-id="8cd42-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="8cd42-104">W tym artykule opisano typy odwołań z dopuszczalną wartością null.</span><span class="sxs-lookup"><span data-stu-id="8cd42-104">This article covers nullable reference types.</span></span> <span data-ttu-id="8cd42-105">Można również zadeklarować [typy wartości nullable](nullable-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="8cd42-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="8cd42-106">Nullowe typy odwołań są dostępne począwszy od języka C# 8.0, w kodzie, który zdecydował się na *kontekst świadomości nullable*.</span><span class="sxs-lookup"><span data-stu-id="8cd42-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="8cd42-107">Typy odwołań null, ostrzeżenia analizy statycznej null i [operator wyrozumiały o wartości null](../operators/null-forgiving.md) są opcjonalnymi funkcjami języka.</span><span class="sxs-lookup"><span data-stu-id="8cd42-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="8cd42-108">Wszystkie są domyślnie wyłączone.</span><span class="sxs-lookup"><span data-stu-id="8cd42-108">All are turned off by default.</span></span> <span data-ttu-id="8cd42-109">*Kontekst z dopuszczalny do wartości null* jest kontrolowany na poziomie projektu przy użyciu ustawień kompilacji lub w kodzie przy użyciu pragmas.</span><span class="sxs-lookup"><span data-stu-id="8cd42-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="8cd42-110">W kontekście świadomości możliwej do unieważnienia:</span><span class="sxs-lookup"><span data-stu-id="8cd42-110">In a nullable aware context:</span></span>

- <span data-ttu-id="8cd42-111">Zmienna typu `T` odwołania musi być zainicjowana z wartością null i nigdy nie `null`może być przypisana do wartości, która może być .</span><span class="sxs-lookup"><span data-stu-id="8cd42-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="8cd42-112">`T?` Zmienna typu odwołania może być `null` inicjowana lub przypisana, `null`ale `null` musi być sprawdzona przed odwołując się.</span><span class="sxs-lookup"><span data-stu-id="8cd42-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="8cd42-113">Zmienna `m` typu `T?` jest uważana za niekwaśną po zastosowaniu `m!`operatora wyrozumiałości zerowej, jak w .</span><span class="sxs-lookup"><span data-stu-id="8cd42-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="8cd42-114">Rozróżnienia między typem `T` odwołania nienastępnego do `T?` wartości null i typu odwołania nullable są wymuszane przez interpretację kompilatora poprzednich reguł.</span><span class="sxs-lookup"><span data-stu-id="8cd42-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="8cd42-115">Zmienna typu `T` i zmienna `T?` typu są reprezentowane przez ten sam typ .NET.</span><span class="sxs-lookup"><span data-stu-id="8cd42-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="8cd42-116">Poniższy przykład deklaruje ciąg nienastępny do wartości null i ciąg dopuszczalny do wartości null, a następnie używa operatora zuprzejący się zerem, aby przypisać wartość do ciągu nienastępnego do wartości null:</span><span class="sxs-lookup"><span data-stu-id="8cd42-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="8cd42-117">Zmienne `notNull` i `nullable` są reprezentowane <xref:System.String> przez typ.</span><span class="sxs-lookup"><span data-stu-id="8cd42-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="8cd42-118">Ponieważ typy nienastępne i nullowe są przechowywane jako ten sam typ, istnieje kilka lokalizacji, w których użycie typu odwołania z możliwością null jest niedozwolone.</span><span class="sxs-lookup"><span data-stu-id="8cd42-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="8cd42-119">Ogólnie rzecz biorąc typu odwołania nullable nie może służyć jako klasy podstawowej lub zaimplementowanego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="8cd42-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="8cd42-120">Typ odwołania z wartością null nie może być używany w żadnym wyrażeniu testowania obiektów lub typów.</span><span class="sxs-lookup"><span data-stu-id="8cd42-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="8cd42-121">Typ odwołania z wartością null nie może być typem wyrażenia dostępu elementu członkowskiego.</span><span class="sxs-lookup"><span data-stu-id="8cd42-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="8cd42-122">Poniższe przykłady przedstawiają następujące konstrukcje:</span><span class="sxs-lookup"><span data-stu-id="8cd42-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="8cd42-123">Nullable odwołania i analizy statycznej</span><span class="sxs-lookup"><span data-stu-id="8cd42-123">Nullable references and static analysis</span></span>

<span data-ttu-id="8cd42-124">Przykłady w poprzedniej sekcji ilustrują charakter nullable typów odwołań.</span><span class="sxs-lookup"><span data-stu-id="8cd42-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="8cd42-125">Typy odwołań nullable nie są nowe typy klas, ale raczej adnotacje na istniejących typów odwołań.</span><span class="sxs-lookup"><span data-stu-id="8cd42-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="8cd42-126">Kompilator używa tych adnotacji, aby ułatwić znajdowanie potencjalnych błędów odwołania null w kodzie.</span><span class="sxs-lookup"><span data-stu-id="8cd42-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="8cd42-127">Nie ma różnicy w czasie wykonywania między typem odwołania nienastępnym wartością null a typem odwołania, którego można anulować.</span><span class="sxs-lookup"><span data-stu-id="8cd42-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="8cd42-128">Kompilator nie dodaje żadnych sprawdzania środowiska uruchomieniowego dla typów odwołań niepodjętych wartości null.</span><span class="sxs-lookup"><span data-stu-id="8cd42-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="8cd42-129">Korzyści są w analizie w czasie kompilacji.</span><span class="sxs-lookup"><span data-stu-id="8cd42-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="8cd42-130">Kompilator generuje ostrzeżenia, które ułatwiają znajdowanie i naprawianie potencjalnych błędów null w kodzie.</span><span class="sxs-lookup"><span data-stu-id="8cd42-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="8cd42-131">Deklarujesz swój zamiar, a kompilator ostrzega, gdy kod narusza tę intencję.</span><span class="sxs-lookup"><span data-stu-id="8cd42-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="8cd42-132">W kontekście włączonym nullable kompilator wykonuje analizę statyczną na zmiennych dowolnego typu odwołania, zarówno nullable i non-nullable.</span><span class="sxs-lookup"><span data-stu-id="8cd42-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="8cd42-133">Kompilator śledzi stan null każdej zmiennej referencyjnej jako *nie null* lub *może null*.</span><span class="sxs-lookup"><span data-stu-id="8cd42-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="8cd42-134">Domyślny stan odwołania, którego nie można unieważnić, nie jest *zerowy.*</span><span class="sxs-lookup"><span data-stu-id="8cd42-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="8cd42-135">Domyślny stan odwołania do nullable jest *może null*.</span><span class="sxs-lookup"><span data-stu-id="8cd42-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="8cd42-136">Typy odwołań nienastępualnych powinny być zawsze bezpieczne do wyłudania, ponieważ ich stan zerowy nie jest *zerowy.*</span><span class="sxs-lookup"><span data-stu-id="8cd42-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="8cd42-137">Aby wymusić tę regułę, kompilator wydaje ostrzeżenia, jeśli typ odwołania nie można anulować nie jest inicjowany do wartości innej niż null.</span><span class="sxs-lookup"><span data-stu-id="8cd42-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="8cd42-138">Zmienne lokalne muszą być przypisane w miejscu, w którym są zadeklarowane.</span><span class="sxs-lookup"><span data-stu-id="8cd42-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="8cd42-139">Każdy konstruktor musi przypisać każde pole, w jego treści, o nazwie konstruktora lub przy użyciu inicjatora pola.</span><span class="sxs-lookup"><span data-stu-id="8cd42-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="8cd42-140">Kompilator wydaje ostrzeżenia, jeśli odwołanie niepodjętalne jest przypisane do odwołania, którego stan jest *może null*.</span><span class="sxs-lookup"><span data-stu-id="8cd42-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="8cd42-141">Jednak ponieważ odwołanie nie można null nie jest *null,* nie ostrzeżenia są wydawane, gdy te zmienne są odwołują się.</span><span class="sxs-lookup"><span data-stu-id="8cd42-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="8cd42-142">Typy odwołań do wartości null `null`mogą być inicjowane lub przypisane do .</span><span class="sxs-lookup"><span data-stu-id="8cd42-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="8cd42-143">W związku z tym analiza statyczna musi ustalić, że zmienna nie jest *null* przed jej wyłuskiwane.</span><span class="sxs-lookup"><span data-stu-id="8cd42-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="8cd42-144">Jeśli odwołanie nullable jest określana *jako może być null*, nie można przypisać do zmiennej odwołania niepodjęwalne.</span><span class="sxs-lookup"><span data-stu-id="8cd42-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="8cd42-145">W poniższej klasie przedstawiono przykłady tych ostrzeżeń:</span><span class="sxs-lookup"><span data-stu-id="8cd42-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="8cd42-146">Poniższy fragment kodu pokazuje, gdzie kompilator emituje ostrzeżenia podczas korzystania z tej klasy:</span><span class="sxs-lookup"><span data-stu-id="8cd42-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="8cd42-147">W poprzednich przykładach pokazano analizy statycznej kompilatora w celu określenia stanu null zmiennych referencyjnych.</span><span class="sxs-lookup"><span data-stu-id="8cd42-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="8cd42-148">Kompilator stosuje reguły języka dla kontroli null i przypisań do informowania o swojej analizie.</span><span class="sxs-lookup"><span data-stu-id="8cd42-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="8cd42-149">Kompilator nie może tworzyć założeń dotyczących semantyki metod lub właściwości.</span><span class="sxs-lookup"><span data-stu-id="8cd42-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="8cd42-150">Jeśli wywołasz metody, które wykonują kontrole null, kompilator nie może wiedzieć, te metody wpływają na stan null zmiennej.</span><span class="sxs-lookup"><span data-stu-id="8cd42-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="8cd42-151">Istnieje wiele atrybutów, które można dodać do interfejsów API, aby poinformować kompilator o semantyki argumentów i zwracać wartości.</span><span class="sxs-lookup"><span data-stu-id="8cd42-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="8cd42-152">Te atrybuty zostały zastosowane do wielu typowych interfejsów API w bibliotekach .NET Core.</span><span class="sxs-lookup"><span data-stu-id="8cd42-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="8cd42-153">Na przykład <xref:System.String.IsNullOrEmpty%2A> został zaktualizowany, a kompilator poprawnie interpretuje tę metodę jako sprawdzenie wartości null.</span><span class="sxs-lookup"><span data-stu-id="8cd42-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="8cd42-154">Aby uzyskać więcej informacji na temat atrybutów, które mają zastosowanie do analizy statycznej stanu null, zobacz artykuł o [atrybutach nullable](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="8cd42-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../../nullable-attributes.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="8cd42-155">Ustawianie kontekstu możliwego do przełowienia</span><span class="sxs-lookup"><span data-stu-id="8cd42-155">Setting the nullable context</span></span>

<span data-ttu-id="8cd42-156">Istnieją dwa sposoby kontrolowania kontekstu możliwego do anulowania.</span><span class="sxs-lookup"><span data-stu-id="8cd42-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="8cd42-157">Na poziomie projektu można dodać `<Nullable>enable</Nullable>` ustawienie projektu.</span><span class="sxs-lookup"><span data-stu-id="8cd42-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="8cd42-158">W jednym pliku źródłowym języka C# można dodać `#nullable enable` pragma, aby włączyć kontekst nullable.</span><span class="sxs-lookup"><span data-stu-id="8cd42-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="8cd42-159">Zobacz artykuł dotyczący [ustawiania strategii możliwej do anulowania](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="8cd42-159">See the article on [setting a nullable strategy](../../nullable-attributes.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="8cd42-160">specyfikacja języka C#</span><span class="sxs-lookup"><span data-stu-id="8cd42-160">C# language specification</span></span>

<span data-ttu-id="8cd42-161">Aby uzyskać więcej informacji, zobacz następujące propozycje [specyfikacji języka języka C#:](~/_csharplang/spec/introduction.md)</span><span class="sxs-lookup"><span data-stu-id="8cd42-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="8cd42-162">Typy referencyjne dopuszczające wartość null</span><span class="sxs-lookup"><span data-stu-id="8cd42-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="8cd42-163">Specyfikacja typów odwołań z nieważność</span><span class="sxs-lookup"><span data-stu-id="8cd42-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="8cd42-164">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="8cd42-164">See also</span></span>

- [<span data-ttu-id="8cd42-165">Dokumentacja języka C#</span><span class="sxs-lookup"><span data-stu-id="8cd42-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="8cd42-166">Typy wartości dopuszczające wartość null</span><span class="sxs-lookup"><span data-stu-id="8cd42-166">Nullable value types</span></span>](nullable-value-types.md)
