---
title: Typy odwołań do wartości null — odwołanie w C#
description: Dowiedz się więcej o typach referencyjnych języka C# do dopuszczających wartość null
ms.date: 04/06/2020
ms.openlocfilehash: 274a613a8381a2b7718c9025f51aadb2eb32af36
ms.sourcegitcommit: 870bc4b4087510f6fba3c7b1c0d391f02bcc1f3e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/23/2020
ms.locfileid: "92471866"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="b46fc-103">Typy odwołań dopuszczających wartość null (odwołanie w C#)</span><span class="sxs-lookup"><span data-stu-id="b46fc-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="b46fc-104">Ten artykuł dotyczy typów referencyjnych dopuszczających wartość null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-104">This article covers nullable reference types.</span></span> <span data-ttu-id="b46fc-105">Można również zadeklarować [wartości null dla typów](nullable-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="b46fc-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="b46fc-106">Typy odwołań dopuszczających wartość null są dostępne począwszy od języka C# 8,0, w kodzie, który został wybrał w *kontekście obsługującym wartość null*.</span><span class="sxs-lookup"><span data-stu-id="b46fc-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="b46fc-107">Typy odwołań dopuszczających wartość null, ostrzeżenia analityczne o wartości null i [Operatory null-łagodniejszej](../operators/null-forgiving.md) są opcjonalnymi funkcjami języka.</span><span class="sxs-lookup"><span data-stu-id="b46fc-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="b46fc-108">Wszystkie są domyślnie wyłączone.</span><span class="sxs-lookup"><span data-stu-id="b46fc-108">All are turned off by default.</span></span> <span data-ttu-id="b46fc-109">*Kontekst dopuszczający wartość null* jest kontrolowany na poziomie projektu przy użyciu ustawień kompilacji lub kodu przy użyciu pragm.</span><span class="sxs-lookup"><span data-stu-id="b46fc-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="b46fc-110">W kontekście dopuszczającym wartość null:</span><span class="sxs-lookup"><span data-stu-id="b46fc-110">In a nullable aware context:</span></span>

- <span data-ttu-id="b46fc-111">Zmienna typu referencyjnego `T` musi zostać zainicjowana przy użyciu wartości innej niż null i nigdy nie może zostać przypisana wartość, która może być `null` .</span><span class="sxs-lookup"><span data-stu-id="b46fc-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="b46fc-112">Zmienna typu referencyjnego `T?` może zostać zainicjowana z `null` lub przypisana `null` , ale jest wymagana do sprawdzenia `null` przed cofnięciem odwołania.</span><span class="sxs-lookup"><span data-stu-id="b46fc-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="b46fc-113">Zmienna `m` typu `T?` jest traktowana jako inna niż null w przypadku zastosowania operatora null-łagodniejszej, jak w `m!` .</span><span class="sxs-lookup"><span data-stu-id="b46fc-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="b46fc-114">Różnice między typem referencyjnym niedopuszczający wartości null `T` a typem referencyjnym dopuszczającym wartość null `T?` są wymuszane przez interpretację przez kompilator powyższych reguł.</span><span class="sxs-lookup"><span data-stu-id="b46fc-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="b46fc-115">Zmienna typu `T` i zmienna typu `T?` są reprezentowane przez ten sam typ .NET.</span><span class="sxs-lookup"><span data-stu-id="b46fc-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="b46fc-116">Poniższy przykład deklaruje ciąg niedopuszczający wartości null i ciąg dopuszczający wartość null, a następnie używa operatora null-łagodniejszej do przypisywania wartości do ciągu niedopuszczający wartości null:</span><span class="sxs-lookup"><span data-stu-id="b46fc-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="b46fc-117">Zmienne `notNull` i `nullable` są reprezentowane przez <xref:System.String> Typ.</span><span class="sxs-lookup"><span data-stu-id="b46fc-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="b46fc-118">Ponieważ typy niedopuszczające wartości null i dopuszczające wartość null są przechowywane jako ten sam typ, istnieje kilka lokalizacji, w których użycie typu odwołania do wartości null jest niedozwolone.</span><span class="sxs-lookup"><span data-stu-id="b46fc-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="b46fc-119">Ogólnie rzecz biorąc typ referencyjny dopuszczający wartość null nie może być używany jako klasa bazowa ani zaimplementowany interfejs.</span><span class="sxs-lookup"><span data-stu-id="b46fc-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="b46fc-120">Nie można użyć typu referencyjnego dopuszczającego wartość null w żadnym wyrażeniu do tworzenia obiektów lub testowania typu.</span><span class="sxs-lookup"><span data-stu-id="b46fc-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="b46fc-121">Typ referencyjny dopuszczający wartość null nie może być typem wyrażenia dostępu do składowej.</span><span class="sxs-lookup"><span data-stu-id="b46fc-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="b46fc-122">Następujące przykłady przedstawiają te konstrukcje:</span><span class="sxs-lookup"><span data-stu-id="b46fc-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="b46fc-123">Odwołania do wartości null i analizy statycznej</span><span class="sxs-lookup"><span data-stu-id="b46fc-123">Nullable references and static analysis</span></span>

<span data-ttu-id="b46fc-124">Przykłady w poprzedniej sekcji ilustrują charakter typów referencyjnych dopuszczających wartość null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="b46fc-125">Typy referencyjne dopuszczające wartość null nie są nowymi typami klas, ale zamiast adnotacji dla istniejących typów odwołań.</span><span class="sxs-lookup"><span data-stu-id="b46fc-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="b46fc-126">Kompilator używa tych adnotacji, aby znaleźć potencjalne błędy odwołania o wartości null w kodzie.</span><span class="sxs-lookup"><span data-stu-id="b46fc-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="b46fc-127">Nie istnieje różnica czasu wykonywania między typem referencyjnym niedopuszczanym do wartości null i typem referencyjnym dopuszczającym wartość null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="b46fc-128">Kompilator nie dodaje żadnego sprawdzenia dla typów referencyjnych, które nie dopuszcza wartości null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="b46fc-129">Korzyści są w analizie w czasie kompilacji.</span><span class="sxs-lookup"><span data-stu-id="b46fc-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="b46fc-130">Kompilator generuje ostrzeżenia, które ułatwiają znajdowanie i naprawianie potencjalnych błędów o wartości null w kodzie.</span><span class="sxs-lookup"><span data-stu-id="b46fc-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="b46fc-131">Zadeklarujesz swój cel, a kompilator ostrzega o tym, gdy kod narusza ten cel.</span><span class="sxs-lookup"><span data-stu-id="b46fc-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="b46fc-132">W kontekście obsługującym wartość null kompilator wykonuje statyczną analizę dla zmiennych dowolnego typu referencyjnego, zarówno wartości null, jak i niedopuszczających wartości null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="b46fc-133">Kompilator śledzi stan wartości null dla każdej zmiennej odwołania jako *nie null* lub *może mieć wartość null*.</span><span class="sxs-lookup"><span data-stu-id="b46fc-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="b46fc-134">Domyślny stan odwołania niedopuszczający wartości null jest *inny niż null*.</span><span class="sxs-lookup"><span data-stu-id="b46fc-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="b46fc-135">Domyślny stan odwołania do wartości null *może mieć wartość null*.</span><span class="sxs-lookup"><span data-stu-id="b46fc-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="b46fc-136">Typy odwołań niedopuszczających wartości null powinny zawsze być bezpieczne, aby można było usunąć odwołanie, ponieważ ich stan zerowy *nie ma wartości null*.</span><span class="sxs-lookup"><span data-stu-id="b46fc-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="b46fc-137">Aby wymusić tę regułę, kompilator wystawia ostrzeżenia, jeśli typ referencyjny niedopuszczający wartości null nie został zainicjowany do wartości innej niż null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="b46fc-138">Zmienne lokalne muszą być przypisane, gdy są one zadeklarowane.</span><span class="sxs-lookup"><span data-stu-id="b46fc-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="b46fc-139">Każdy Konstruktor musi przypisywać każde pole, w jego treści, Konstruktor wywoływany lub przy użyciu inicjatora pola.</span><span class="sxs-lookup"><span data-stu-id="b46fc-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="b46fc-140">Kompilator wystawia ostrzeżenia, jeśli odwołanie niedopuszczające wartości null jest przypisane do odwołania, którego stan *może mieć wartość null*.</span><span class="sxs-lookup"><span data-stu-id="b46fc-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="b46fc-141">Jednak ze względu na to, że odwołanie niedopuszczające wartości null *nie ma wartości null*, nie są wyświetlane żadne ostrzeżenia, gdy te zmienne zostały cofnięte.</span><span class="sxs-lookup"><span data-stu-id="b46fc-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="b46fc-142">Typy odwołań dopuszczających wartość null mogą być zainicjowane lub przypisane do `null` .</span><span class="sxs-lookup"><span data-stu-id="b46fc-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="b46fc-143">Dlatego analiza statyczna musi określać, że zmienna *nie ma wartości null* , zanim zostanie wykorzystana.</span><span class="sxs-lookup"><span data-stu-id="b46fc-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="b46fc-144">Jeśli odwołanie dopuszczające wartość null jest określone jako mające *wartość null*, nie można go przypisać do zmiennej odwołania, która nie dopuszcza wartości null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="b46fc-145">W poniższej klasie przedstawiono przykłady tych ostrzeżeń:</span><span class="sxs-lookup"><span data-stu-id="b46fc-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="b46fc-146">Poniższy fragment kodu pokazuje, gdzie kompilator emituje ostrzeżenia podczas korzystania z tej klasy:</span><span class="sxs-lookup"><span data-stu-id="b46fc-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="b46fc-147">Powyższe przykłady przedstawiają analizę statyczną kompilatora w celu określenia stanu null zmiennych odwołania.</span><span class="sxs-lookup"><span data-stu-id="b46fc-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="b46fc-148">Kompilator stosuje reguły języka do sprawdzania wartości null i przypisań, aby poinformować o analizie.</span><span class="sxs-lookup"><span data-stu-id="b46fc-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="b46fc-149">Kompilator nie może wykonać założeń dotyczących semantyki metod lub właściwości.</span><span class="sxs-lookup"><span data-stu-id="b46fc-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="b46fc-150">Jeśli wywołasz metody, które wykonują sprawdzenia wartości null, kompilator nie może znać tych metod wpływ na stan null zmiennej.</span><span class="sxs-lookup"><span data-stu-id="b46fc-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="b46fc-151">Istnieje wiele atrybutów, które można dodać do interfejsów API, aby poinformować kompilator o semantyki argumentów i zwracanych wartości.</span><span class="sxs-lookup"><span data-stu-id="b46fc-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="b46fc-152">Te atrybuty zostały zastosowane do wielu popularnych interfejsów API w bibliotekach programu .NET Core.</span><span class="sxs-lookup"><span data-stu-id="b46fc-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="b46fc-153">Na przykład program <xref:System.String.IsNullOrEmpty%2A> został zaktualizowany, a kompilator prawidłowo interpretuje tę metodę jako sprawdzenie wartości null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="b46fc-154">Aby uzyskać więcej informacji o atrybutach, które mają zastosowanie do statycznej analizy stanu o wartości null, zobacz artykuł dotyczący [atrybutów dopuszczających wartość null](../attributes/nullable-analysis.md).</span><span class="sxs-lookup"><span data-stu-id="b46fc-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../attributes/nullable-analysis.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="b46fc-155">Ustawianie kontekstu dopuszczającego wartość null</span><span class="sxs-lookup"><span data-stu-id="b46fc-155">Setting the nullable context</span></span>

<span data-ttu-id="b46fc-156">Istnieją dwa sposoby sterowania kontekstem dopuszczania wartości null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="b46fc-157">Na poziomie projektu można dodać `<Nullable>enable</Nullable>` ustawienie projektu.</span><span class="sxs-lookup"><span data-stu-id="b46fc-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="b46fc-158">W jednym pliku źródłowym języka C# można dodać `#nullable enable` pragmę, aby włączyć kontekst dopuszczający wartość null.</span><span class="sxs-lookup"><span data-stu-id="b46fc-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="b46fc-159">Zapoznaj się z artykułem dotyczącym [ustawiania strategii dopuszczania wartości null](../../nullable-migration-strategies.md).</span><span class="sxs-lookup"><span data-stu-id="b46fc-159">See the article on [setting a nullable strategy](../../nullable-migration-strategies.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="b46fc-160">specyfikacja języka C#</span><span class="sxs-lookup"><span data-stu-id="b46fc-160">C# language specification</span></span>

<span data-ttu-id="b46fc-161">Aby uzyskać więcej informacji, zobacz następujące propozycje dotyczące [specyfikacji języka C#](~/_csharplang/spec/introduction.md):</span><span class="sxs-lookup"><span data-stu-id="b46fc-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="b46fc-162">Typy referencyjne dopuszczające wartość null</span><span class="sxs-lookup"><span data-stu-id="b46fc-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="b46fc-163">Specyfikacja typu referencyjnego dopuszczająca wartość null</span><span class="sxs-lookup"><span data-stu-id="b46fc-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="b46fc-164">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="b46fc-164">See also</span></span>

- [<span data-ttu-id="b46fc-165">Dokumentacja języka C#</span><span class="sxs-lookup"><span data-stu-id="b46fc-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="b46fc-166">Typy wartości null</span><span class="sxs-lookup"><span data-stu-id="b46fc-166">Nullable value types</span></span>](nullable-value-types.md)
