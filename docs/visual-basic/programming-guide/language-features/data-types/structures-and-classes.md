---
title: Struktury i klasy (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures [Visual Basic]
- classes [Visual Basic]
- structures [Visual Basic], compared to classes
- structures [Visual Basic], structure variables
- structure variables [Visual Basic]
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
ms.openlocfilehash: 3635729705520518d4c950f8a79da7d1249285bf
ms.sourcegitcommit: bce0586f0cccaae6d6cbd625d5a7b824d1d3de4b
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/02/2019
ms.locfileid: "58841618"
---
# <a name="structures-and-classes-visual-basic"></a><span data-ttu-id="f7a8b-102">Struktury i klasy (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f7a8b-102">Structures and Classes (Visual Basic)</span></span>
<span data-ttu-id="f7a8b-103">Visual Basic ujednolica składnia struktury i klasy z wynikiem, że obie te jednostki obsługuje większość tych samych funkcji.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-103">Visual Basic unifies the syntax for structures and classes, with the result that both entities support most of the same features.</span></span> <span data-ttu-id="f7a8b-104">Istnieją również istotne różnice między strukturami i klasami.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-104">However, there are also important differences between structures and classes.</span></span>  
  
 <span data-ttu-id="f7a8b-105">Klasy ma tę zaletę, są typami odwołań — przekazywanie odwołania jest bardziej wydajne niż przekazanie zmiennej struktury, ze swoimi danymi.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-105">Classes have the advantage of being reference types — passing a reference is more efficient than passing a structure variable with all its data.</span></span> <span data-ttu-id="f7a8b-106">Z drugiej strony struktury nie wymagają alokacji pamięci na stosie globalnego.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-106">On the other hand, structures do not require allocation of memory on the global heap.</span></span>  
  
 <span data-ttu-id="f7a8b-107">Ponieważ użytkownik nie może dziedziczyć ze struktury, struktur należy używać tylko w przypadku obiektów, które nie muszą być rozszerzony.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-107">Because you cannot inherit from a structure, structures should be used only for objects that do not need to be extended.</span></span> <span data-ttu-id="f7a8b-108">Użyj struktury, gdy obiekt, który chcesz utworzyć ma rozmiar wystąpienia małe i wziąć pod uwagę charakterystyki wydajności klas i struktur.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-108">Use structures when the object you wish to create has a small instance size, and take into account the performance characteristics of classes versus structures.</span></span>  
  
## <a name="similarities"></a><span data-ttu-id="f7a8b-109">Podobieństwa</span><span class="sxs-lookup"><span data-stu-id="f7a8b-109">Similarities</span></span>  
 <span data-ttu-id="f7a8b-110">Klasy i struktury są podobne pod następującymi względami:</span><span class="sxs-lookup"><span data-stu-id="f7a8b-110">Structures and classes are similar in the following respects:</span></span>  
  
-   <span data-ttu-id="f7a8b-111">Oba są *kontenera* typów, co oznacza, że zawierają one innych typów jako elementy członkowskie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-111">Both are *container* types, meaning that they contain other types as members.</span></span>  
  
-   <span data-ttu-id="f7a8b-112">Mają elementów członkowskich, które mogą zawierać konstruktorów, metod, właściwości, pola, stałe, wyliczenia, zdarzenia i procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-112">Both have members, which can include constructors, methods, properties, fields, constants, enumerations, events, and event handlers.</span></span> <span data-ttu-id="f7a8b-113">Jednak nie należy mylić te elementy członkowskie z deklarowanym *elementy* struktury.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-113">However, do not confuse these members with the declared *elements* of a structure.</span></span>  
  
-   <span data-ttu-id="f7a8b-114">Oba elementy Członkowskie mogą mieć zindywidualizowanych poziomy dostępu.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-114">Members of both can have individualized access levels.</span></span> <span data-ttu-id="f7a8b-115">Na przykład, można zadeklarować jednego członka `Public` i innym `Private`.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-115">For example, one member can be declared `Public` and another `Private`.</span></span>  
  
-   <span data-ttu-id="f7a8b-116">Jednocześnie można implementować interfejsy.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-116">Both can implement interfaces.</span></span>  
  
-   <span data-ttu-id="f7a8b-117">Jednocześnie można udostępnionego konstruktorów, z lub bez parametrów.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-117">Both can have shared constructors, with or without parameters.</span></span>  
  
-   <span data-ttu-id="f7a8b-118">Jednocześnie można uwidocznić *właściwość domyślna*pod warunkiem, że właściwość przyjmuje co najmniej jeden parametr.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-118">Both can expose a *default property*, provided that property takes at least one parameter.</span></span>  
  
-   <span data-ttu-id="f7a8b-119">Jednocześnie można zadeklarować i wywoływanie zdarzeń, a jednocześnie można zadeklarować delegatów.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-119">Both can declare and raise events, and both can declare delegates.</span></span>  
  
## <a name="differences"></a><span data-ttu-id="f7a8b-120">Różnice</span><span class="sxs-lookup"><span data-stu-id="f7a8b-120">Differences</span></span>  
 <span data-ttu-id="f7a8b-121">Struktury i klasy różnią się następujące dane:</span><span class="sxs-lookup"><span data-stu-id="f7a8b-121">Structures and classes differ in the following particulars:</span></span>  
  
-   <span data-ttu-id="f7a8b-122">Struktury są *typy wartości*; klasy są *typy odwołań*.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-122">Structures are *value types*; classes are *reference types*.</span></span> <span data-ttu-id="f7a8b-123">Zmienną typu struktury zawiera struktura danych, zamiast zawierająca odwołanie do danych jako typ klasy jest.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-123">A variable of a structure type contains the structure's data, rather than containing a reference to the data as a class type does.</span></span>  
  
-   <span data-ttu-id="f7a8b-124">Alokacja stosu; korzystają struktury klasy użyj alokacji sterty.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-124">Structures use stack allocation; classes use heap allocation.</span></span>  
  
-   <span data-ttu-id="f7a8b-125">Wszystkie elementy struktury są `Public` domyślnie klasy zmienne i stałe są `Private` domyślnie, podczas gdy inne elementy członkowskie klasy są `Public` domyślnie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-125">All structure elements are `Public` by default; class variables and constants are `Private` by default, while other class members are `Public` by default.</span></span> <span data-ttu-id="f7a8b-126">To zachowanie dla składowych klasy zapewnia zgodność z systemem Visual Basic 6.0, domyślnie zostanie ustawiona.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-126">This behavior for class members provides compatibility with the Visual Basic 6.0 system of defaults.</span></span>  
  
-   <span data-ttu-id="f7a8b-127">Struktura musi mieć co najmniej jeden nieudostępnionych noncustom zmiennej lub nieudostępnionych, element zdarzeń; Klasa może być całkowicie pusty.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-127">A structure must have at least one nonshared variable or nonshared, noncustom event element; a class can be completely empty.</span></span>  
  
-   <span data-ttu-id="f7a8b-128">Elementy struktury nie może być zadeklarowana jako `Protected`; można składowych klasy.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-128">Structure elements cannot be declared as `Protected`; class members can.</span></span>  
  
-   <span data-ttu-id="f7a8b-129">Procedura struktury można obsługiwać zdarzenia, tylko wtedy, gdy jest [Shared](../../../../visual-basic/language-reference/modifiers/shared.md) `Sub` procedury i tylko przez klasy [AddHandler — instrukcja](../../../../visual-basic/language-reference/statements/addhandler-statement.md); każda procedura klasy można obsługiwać zdarzenia, za pomocą obu [ Obsługuje](../../../../visual-basic/language-reference/statements/handles-clause.md) — słowo kluczowe lub `AddHandler` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-129">A structure procedure can handle events only if it is a [Shared](../../../../visual-basic/language-reference/modifiers/shared.md)`Sub` procedure, and only by means of the [AddHandler Statement](../../../../visual-basic/language-reference/statements/addhandler-statement.md); any class procedure can handle events, using either the [Handles](../../../../visual-basic/language-reference/statements/handles-clause.md) keyword or the `AddHandler` statement.</span></span> <span data-ttu-id="f7a8b-130">Aby uzyskać więcej informacji, zobacz [zdarzenia](../../../../visual-basic/programming-guide/language-features/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="f7a8b-130">For more information, see [Events](../../../../visual-basic/programming-guide/language-features/events/index.md).</span></span>  
  
-   <span data-ttu-id="f7a8b-131">Struktura deklaracje zmiennych nie można określić inicjatorów lub początkowe rozmiary tablic; deklaracje zmiennych klasy mogą.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-131">Structure variable declarations cannot specify initializers or initial sizes for arrays; class variable declarations can.</span></span>  
  
-   <span data-ttu-id="f7a8b-132">Struktury niejawnie dziedziczą z <xref:System.ValueType?displayProperty=nameWithType> klasy i nie może dziedziczyć z innego typu; klasy mogą dziedziczyć z klasy lub klas w innych niż <xref:System.ValueType?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-132">Structures implicitly inherit from the <xref:System.ValueType?displayProperty=nameWithType> class and cannot inherit from any other type; classes can inherit from any class or classes other than <xref:System.ValueType?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="f7a8b-133">Konstrukcje nie są dziedziczone; klasy są.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-133">Structures are not inheritable; classes are.</span></span>  
  
-   <span data-ttu-id="f7a8b-134">Struktury nigdy nie kończą, dzięki czemu środowisko uruchomieniowe języka wspólnego (CLR) nigdy nie wywołuje <xref:System.Object.Finalize%2A> metody na dowolną strukturę; klas są kończone przez moduł odśmiecania pamięci (GC), która wywołuje <xref:System.Object.Finalize%2A> klasy po wykryciu, że istnieją nie aktywne odwołania pozostałe.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-134">Structures are never terminated, so the common language runtime (CLR) never calls the <xref:System.Object.Finalize%2A> method on any structure; classes are terminated by the garbage collector (GC), which calls <xref:System.Object.Finalize%2A> on a class when it detects there are no active references remaining.</span></span>  
  
-   <span data-ttu-id="f7a8b-135">Struktura nie wymaga konstruktora; jest klasą.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-135">A structure does not require a constructor; a class does.</span></span>  
  
-   <span data-ttu-id="f7a8b-136">Struktury mogą mieć konstruktorów nieudostępnionych tylko wtedy, gdy przyjmują parametrów; klasy mogą mieć je z lub bez parametrów.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-136">Structures can have nonshared constructors only if they take parameters; classes can have them with or without parameters.</span></span>  
  
 <span data-ttu-id="f7a8b-137">Co struktura ma niejawne publicznego konstruktora bez parametrów.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-137">Every structure has an implicit public constructor without parameters.</span></span> <span data-ttu-id="f7a8b-138">Ten konstruktor inicjuje wszystkie struktury elementów danych do wartości domyślnych.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-138">This constructor initializes all the structure's data elements to their default values.</span></span> <span data-ttu-id="f7a8b-139">Nie można przedefiniować to zachowanie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-139">You cannot redefine this behavior.</span></span>  
  
## <a name="instances-and-variables"></a><span data-ttu-id="f7a8b-140">Wystąpienia i zmienne</span><span class="sxs-lookup"><span data-stu-id="f7a8b-140">Instances and Variables</span></span>  
 <span data-ttu-id="f7a8b-141">Ponieważ struktury są typami wartości, każdej zmiennej struktury jest trwałe związane z wystąpienia poszczególnych struktury.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-141">Because structures are value types, each structure variable is permanently bound to an individual structure instance.</span></span> <span data-ttu-id="f7a8b-142">Ale klasy są typami odwołań, a zmienna obiektu może odwoływać się do różnych wystąpień klas w różnym czasie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-142">But classes are reference types, and an object variable can refer to various class instances at different times.</span></span> <span data-ttu-id="f7a8b-143">Wykonywania tego rozróżnienia ma wpływ na użycie struktur i klas w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="f7a8b-143">This distinction affects your usage of structures and classes in the following ways:</span></span>  
  
-   <span data-ttu-id="f7a8b-144">**Inicjowanie.**</span><span class="sxs-lookup"><span data-stu-id="f7a8b-144">**Initialization.**</span></span> <span data-ttu-id="f7a8b-145">Zmiennej struktury, obejmuje inicjowanie elementów przy użyciu struktury konstruktora bez parametrów.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-145">A structure variable implicitly includes an initialization of the elements using the structure's parameterless constructor.</span></span> <span data-ttu-id="f7a8b-146">W związku z tym `Dim s As struct1` jest odpowiednikiem `Dim s As struct1 = New struct1()`.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-146">Therefore, `Dim s As struct1` is equivalent to `Dim s As struct1 = New struct1()`.</span></span>  
  
-   <span data-ttu-id="f7a8b-147">**Przypisywanie zmiennych.**</span><span class="sxs-lookup"><span data-stu-id="f7a8b-147">**Assigning Variables.**</span></span> <span data-ttu-id="f7a8b-148">Podczas przypisywania jednej zmiennej struktury do innego lub przekazać wystąpienia struktury do argumentu procedury bieżące wartości zmiennych elementy są kopiowane do nowej struktury.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-148">When you assign one structure variable to another, or pass a structure instance to a procedure argument, the current values of all the variable elements are copied to the new structure.</span></span> <span data-ttu-id="f7a8b-149">Przypisz jednej zmiennej obiektu do innego lub przekazywanie zmienną obiektu do procedury, wskaźnik odwołania są kopiowane.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-149">When you assign one object variable to another, or pass an object variable to a procedure, only the reference pointer is copied.</span></span>  
  
-   <span data-ttu-id="f7a8b-150">**Przypisywanie Nothing.**</span><span class="sxs-lookup"><span data-stu-id="f7a8b-150">**Assigning Nothing.**</span></span> <span data-ttu-id="f7a8b-151">Można przypisać wartość [nic](../../../../visual-basic/language-reference/nothing.md) do struktury zmienną, ale wystąpienie jest nadal skojarzony ze zmienną.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-151">You can assign the value [Nothing](../../../../visual-basic/language-reference/nothing.md) to a structure variable, but the instance continues to be associated with the variable.</span></span> <span data-ttu-id="f7a8b-152">Nadal możesz wywołać jego metody i dostęp do jego elementów danych, mimo że zmiennej elementy są ponownie inicjowane przez przypisanie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-152">You can still call its methods and access its data elements, although variable elements are reinitialized by the assignment.</span></span>  
  
     <span data-ttu-id="f7a8b-153">Natomiast jeśli zostanie ustawiona zmienna obiektu `Nothing`, Usuń skojarzenie jej z dowolnego wystąpienia klasy i nie masz dostępu do żadnych elementów członkowskich za pośrednictwem zmiennej do momentu przypisania inne wystąpienie do niego.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-153">In contrast, if you set an object variable to `Nothing`, you dissociate it from any class instance, and you cannot access any members through the variable until you assign another instance to it.</span></span>  
  
-   <span data-ttu-id="f7a8b-154">**Wiele wystąpień.**</span><span class="sxs-lookup"><span data-stu-id="f7a8b-154">**Multiple Instances.**</span></span> <span data-ttu-id="f7a8b-155">Zmienna obiektu może mieć inną klasę wystąpień przypisane do niego w różnym czasie, a kilku zmiennych obiektu może odwoływać się do tego samego wystąpienia klasy, w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-155">An object variable can have different class instances assigned to it at different times, and several object variables can refer to the same class instance at the same time.</span></span> <span data-ttu-id="f7a8b-156">Zmiany wprowadzone do wartości elementów członkowskich klasy wpływa na tych członków, gdy dostępne za pośrednictwem innej zmiennej wskazujące do tego samego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-156">Changes you make to the values of class members affect those members when accessed through another variable pointing to the same instance.</span></span>  
  
     <span data-ttu-id="f7a8b-157">Jednak elementy struktury są izolowane w ramach ich własnych wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-157">Structure elements, however, are isolated within their own instance.</span></span> <span data-ttu-id="f7a8b-158">Zmiany wartości nie są uwzględniane w żadnych innych zmiennych struktury, nawet w przypadku innych wystąpień tego samego `Structure` deklaracji.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-158">Changes to their values are not reflected in any other structure variables, even in other instances of the same `Structure` declaration.</span></span>  
  
-   <span data-ttu-id="f7a8b-159">**Równości.**</span><span class="sxs-lookup"><span data-stu-id="f7a8b-159">**Equality.**</span></span> <span data-ttu-id="f7a8b-160">Sprawdzaniem równości dwóch struktur, muszą być wykonywane z testem element po elemencie.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-160">Equality testing of two structures must be performed with an element-by-element test.</span></span> <span data-ttu-id="f7a8b-161">Można porównać dwie zmienne do obiektu za pomocą <xref:System.Object.Equals%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-161">Two object variables can be compared using the <xref:System.Object.Equals%2A> method.</span></span> <span data-ttu-id="f7a8b-162"><xref:System.Object.Equals%2A> Wskazuje, czy dwie zmienne punktu w tym samym wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="f7a8b-162"><xref:System.Object.Equals%2A> indicates whether the two variables point to the same instance.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7a8b-163">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="f7a8b-163">See also</span></span>

- [<span data-ttu-id="f7a8b-164">Typy danych</span><span class="sxs-lookup"><span data-stu-id="f7a8b-164">Data Types</span></span>](../../../../visual-basic/programming-guide/language-features/data-types/index.md)
- [<span data-ttu-id="f7a8b-165">Złożone typy danych</span><span class="sxs-lookup"><span data-stu-id="f7a8b-165">Composite Data Types</span></span>](../../../../visual-basic/programming-guide/language-features/data-types/composite-data-types.md)
- [<span data-ttu-id="f7a8b-166">Typy wartości i odwołań</span><span class="sxs-lookup"><span data-stu-id="f7a8b-166">Value Types and Reference Types</span></span>](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)
- [<span data-ttu-id="f7a8b-167">Struktury</span><span class="sxs-lookup"><span data-stu-id="f7a8b-167">Structures</span></span>](../../../../visual-basic/programming-guide/language-features/data-types/structures.md)
- [<span data-ttu-id="f7a8b-168">Rozwiązywanie problemów związanych z typami danych</span><span class="sxs-lookup"><span data-stu-id="f7a8b-168">Troubleshooting Data Types</span></span>](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)
- [<span data-ttu-id="f7a8b-169">Struktury oraz inne elementy programowania</span><span class="sxs-lookup"><span data-stu-id="f7a8b-169">Structures and Other Programming Elements</span></span>](../../../../visual-basic/programming-guide/language-features/data-types/structures-and-other-programming-elements.md)
- [<span data-ttu-id="f7a8b-170">Obiekty i klasy</span><span class="sxs-lookup"><span data-stu-id="f7a8b-170">Objects and Classes</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/index.md)
