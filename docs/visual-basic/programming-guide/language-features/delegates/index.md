---
title: Delegaci
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [Visual Basic]
- Visual Basic code, delegates
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
ms.openlocfilehash: 1f161248fa04f8fab0e5335413e69ca565732f71
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/04/2020
ms.locfileid: "84410685"
---
# <a name="delegates-visual-basic"></a><span data-ttu-id="1ff87-102">Delegaty (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ff87-102">Delegates (Visual Basic)</span></span>

<span data-ttu-id="1ff87-103">Delegaty są obiektami odwołującymi się do metod.</span><span class="sxs-lookup"><span data-stu-id="1ff87-103">Delegates are objects that refer to methods.</span></span> <span data-ttu-id="1ff87-104">Są czasami opisywane jako *wskaźniki funkcji bezpiecznych dla typu* , ponieważ są podobne do wskaźników funkcji używanych w innych językach programowania.</span><span class="sxs-lookup"><span data-stu-id="1ff87-104">They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages.</span></span> <span data-ttu-id="1ff87-105">Ale w przeciwieństwie do wskaźników funkcji, Visual Basic delegatów jest typem referencyjnym opartym na klasie <xref:System.Delegate?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="1ff87-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span></span> <span data-ttu-id="1ff87-106">Delegaty mogą odwoływać się do obu metod wspólnych — metod, które mogą być wywoływane bez określonego wystąpienia klasy — oraz metod wystąpień.</span><span class="sxs-lookup"><span data-stu-id="1ff87-106">Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.</span></span>

## <a name="delegates-and-events"></a><span data-ttu-id="1ff87-107">Delegaci i zdarzenia</span><span class="sxs-lookup"><span data-stu-id="1ff87-107">Delegates and Events</span></span>

<span data-ttu-id="1ff87-108">Delegaty są przydatne w sytuacjach, gdy potrzebujesz pośrednika między procedurą wywołującą a wywoływaną procedurą.</span><span class="sxs-lookup"><span data-stu-id="1ff87-108">Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.</span></span> <span data-ttu-id="1ff87-109">Na przykład możesz chcieć, aby obiekt, który zgłasza zdarzenia, aby mógł wywołać inne procedury obsługi zdarzeń w różnych warunkach.</span><span class="sxs-lookup"><span data-stu-id="1ff87-109">For example, you might want an object that raises events to be able to call different event handlers under different circumstances.</span></span> <span data-ttu-id="1ff87-110">Niestety, obiekt wywołujący zdarzenia nie może wiedzieć przed czasem, w którym program obsługi zdarzeń obsługuje określone zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="1ff87-110">Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.</span></span> <span data-ttu-id="1ff87-111">Visual Basic umożliwia dynamiczne kojarzenie programów obsługi zdarzeń ze zdarzeniami przez utworzenie delegata przy użyciu `AddHandler` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="1ff87-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span></span> <span data-ttu-id="1ff87-112">W czasie wykonywania delegat przekazuje wywołania do odpowiedniego programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="1ff87-112">At run time, the delegate forwards calls to the appropriate event handler.</span></span>

<span data-ttu-id="1ff87-113">Chociaż można tworzyć własnych delegatów, w większości przypadków Visual Basic tworzy delegata i bierze pod uwagę szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="1ff87-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span></span> <span data-ttu-id="1ff87-114">Na przykład `Event` instrukcja niejawnie definiuje klasę delegata o nazwie `<EventName>EventHandler` jako klasę zagnieżdżoną klasy zawierającej `Event` instrukcję i z tą samą sygnaturą co zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="1ff87-114">For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event.</span></span> <span data-ttu-id="1ff87-115">`AddressOf`Instrukcja niejawnie tworzy wystąpienie delegata, który odwołuje się do określonej procedury.</span><span class="sxs-lookup"><span data-stu-id="1ff87-115">The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure.</span></span> <span data-ttu-id="1ff87-116">Poniższe dwa wiersze kodu są równoważne.</span><span class="sxs-lookup"><span data-stu-id="1ff87-116">The following two lines of code are equivalent.</span></span> <span data-ttu-id="1ff87-117">W pierwszym wierszu zobaczysz jawne utworzenie wystąpienia `EventHandler` , z odwołaniem do metody `Button1_Click` wysyłanej jako argument.</span><span class="sxs-lookup"><span data-stu-id="1ff87-117">In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument.</span></span> <span data-ttu-id="1ff87-118">Drugi wiersz jest bardziej wygodnym sposobem wykonania tego samego zadania.</span><span class="sxs-lookup"><span data-stu-id="1ff87-118">The second line is a more convenient way to do the same thing.</span></span>

[!code-vb[VbVbalrDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#6)]

<span data-ttu-id="1ff87-119">Można użyć skróconej metody tworzenia delegatów gdziekolwiek kompilator może określić typ delegata według kontekstu.</span><span class="sxs-lookup"><span data-stu-id="1ff87-119">You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.</span></span>

## <a name="declaring-events-that-use-an-existing-delegate-type"></a><span data-ttu-id="1ff87-120">Deklarowanie zdarzeń wykorzystujących istniejący typ delegata</span><span class="sxs-lookup"><span data-stu-id="1ff87-120">Declaring Events that Use an Existing Delegate Type</span></span>

<span data-ttu-id="1ff87-121">W niektórych sytuacjach może zaistnieć potrzeba zadeklarować zdarzenie, aby użyć istniejącego typu delegata jako jego podstawowego delegata.</span><span class="sxs-lookup"><span data-stu-id="1ff87-121">In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.</span></span> <span data-ttu-id="1ff87-122">Poniższa składnia ilustruje, jak:</span><span class="sxs-lookup"><span data-stu-id="1ff87-122">The following syntax demonstrates how:</span></span>

[!code-vb[VbVbalrDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#7)]

<span data-ttu-id="1ff87-123">Jest to przydatne, gdy chcesz skierować wiele zdarzeń do tej samej procedury obsługi.</span><span class="sxs-lookup"><span data-stu-id="1ff87-123">This is useful when you want to route multiple events to the same handler.</span></span>

## <a name="delegate-variables-and-parameters"></a><span data-ttu-id="1ff87-124">Delegowanie zmiennych i parametrów</span><span class="sxs-lookup"><span data-stu-id="1ff87-124">Delegate Variables and Parameters</span></span>

<span data-ttu-id="1ff87-125">Delegatów można używać do innych zadań niezwiązanych z zdarzeniami, takich jak bezpłatne wątki lub procedury, które muszą wywołać różne wersje funkcji w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="1ff87-125">You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.</span></span>

<span data-ttu-id="1ff87-126">Załóżmy na przykład, że masz aplikację z klasyfikacją AD, która zawiera pole listy z nazwami samochodów.</span><span class="sxs-lookup"><span data-stu-id="1ff87-126">For example, suppose you have a classified-ad application that includes a list box with the names of cars.</span></span> <span data-ttu-id="1ff87-127">Reklamy są sortowane według tytułu, co jest zwykle markami samochodu.</span><span class="sxs-lookup"><span data-stu-id="1ff87-127">The ads are sorted by title, which is normally the make of the car.</span></span> <span data-ttu-id="1ff87-128">Problem, który może wystąpić, gdy niektóre samochody obejmują rok samochodu przed markami.</span><span class="sxs-lookup"><span data-stu-id="1ff87-128">A problem you may face occurs when some cars include the year of the car before the make.</span></span> <span data-ttu-id="1ff87-129">Problem polega na tym, że Wbudowana funkcja sortowania pola listy sortuje tylko według kodów znaków; najpierw umieszcza wszystkie reklamy zaczynające się od dat, a następnie reklamy, rozpoczynając od marki.</span><span class="sxs-lookup"><span data-stu-id="1ff87-129">The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.</span></span>

<span data-ttu-id="1ff87-130">Aby rozwiązać ten problem, można utworzyć procedurę sortowania w klasie, która korzysta z standardowego sortowania alfabetycznego w większości pól listy, ale jest możliwe przełączenie w czasie wykonywania do niestandardowej procedury sortowania dla reklam samochodowych.</span><span class="sxs-lookup"><span data-stu-id="1ff87-130">To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.</span></span> <span data-ttu-id="1ff87-131">W tym celu należy przekazać niestandardową procedurę sortowania do klasy sortowania w czasie wykonywania za pomocą delegatów.</span><span class="sxs-lookup"><span data-stu-id="1ff87-131">To do this, you pass the custom sort procedure to the sort class at run time, using delegates.</span></span>

## <a name="addressof-and-lambda-expressions"></a><span data-ttu-id="1ff87-132">Wyrażenia AddressOf i lambda</span><span class="sxs-lookup"><span data-stu-id="1ff87-132">AddressOf and Lambda Expressions</span></span>

<span data-ttu-id="1ff87-133">Każda Klasa delegatów definiuje konstruktora, który przekazał specyfikację metody obiektu.</span><span class="sxs-lookup"><span data-stu-id="1ff87-133">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="1ff87-134">Argument konstruktora delegata musi być odwołaniem do metody lub wyrażeniem lambda.</span><span class="sxs-lookup"><span data-stu-id="1ff87-134">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>

<span data-ttu-id="1ff87-135">Aby określić odwołanie do metody, należy użyć następującej składni:</span><span class="sxs-lookup"><span data-stu-id="1ff87-135">To specify a reference to a method, use the following syntax:</span></span>

<span data-ttu-id="1ff87-136">`AddressOf` [`expression`.]`methodName`</span><span class="sxs-lookup"><span data-stu-id="1ff87-136">`AddressOf` [`expression`.]`methodName`</span></span>

<span data-ttu-id="1ff87-137">Typ czasu kompilacji `expression` musi być nazwą klasy lub interfejsem zawierającym metodę o określonej nazwie, której sygnatura pasuje do sygnatury klasy delegata.</span><span class="sxs-lookup"><span data-stu-id="1ff87-137">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="1ff87-138">`methodName`Może to być Metoda wspólna lub metoda wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="1ff87-138">The `methodName` can be either a shared method or an instance method.</span></span> <span data-ttu-id="1ff87-139">`methodName`Nie jest opcjonalna, nawet jeśli utworzysz delegata dla metody domyślnej klasy.</span><span class="sxs-lookup"><span data-stu-id="1ff87-139">The `methodName` is not optional, even if you create a delegate for the default method of the class.</span></span>

<span data-ttu-id="1ff87-140">Aby określić wyrażenie lambda, należy użyć następującej składni:</span><span class="sxs-lookup"><span data-stu-id="1ff87-140">To specify a lambda expression, use the following syntax:</span></span>

<span data-ttu-id="1ff87-141">`Function`([ `parm` AS `type` , `parm2` AS, `type2` ...])`expression`</span><span class="sxs-lookup"><span data-stu-id="1ff87-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>

<span data-ttu-id="1ff87-142">W poniższym przykładzie pokazano zarówno `AddressOf` wyrażenie, jak i wyrażenia lambda używane do określenia odwołania dla delegata.</span><span class="sxs-lookup"><span data-stu-id="1ff87-142">The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.</span></span>

[!code-vb[VbVbalrDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class2.vb#15)]

<span data-ttu-id="1ff87-143">Sygnatura funkcji musi być zgodna z typem delegata.</span><span class="sxs-lookup"><span data-stu-id="1ff87-143">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="1ff87-144">Aby uzyskać więcej informacji na temat wyrażeń lambda, zobacz [lambda Expressions](../procedures/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="1ff87-144">For more information about lambda expressions, see [Lambda Expressions](../procedures/lambda-expressions.md).</span></span> <span data-ttu-id="1ff87-145">Aby uzyskać więcej przykładów wyrażenia lambda i `AddressOf` przypisań do delegatów, zobacz [Swobodna konwersja delegata](relaxed-delegate-conversion.md).</span><span class="sxs-lookup"><span data-stu-id="1ff87-145">For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](relaxed-delegate-conversion.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1ff87-146">Tematy pokrewne</span><span class="sxs-lookup"><span data-stu-id="1ff87-146">Related Topics</span></span>

|<span data-ttu-id="1ff87-147">Tytuł</span><span class="sxs-lookup"><span data-stu-id="1ff87-147">Title</span></span>|<span data-ttu-id="1ff87-148">Opis</span><span class="sxs-lookup"><span data-stu-id="1ff87-148">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="1ff87-149">Instrukcje: wywoływanie metody delegata</span><span class="sxs-lookup"><span data-stu-id="1ff87-149">How to: Invoke a Delegate Method</span></span>](how-to-invoke-a-delegate-method.md)|<span data-ttu-id="1ff87-150">Zawiera przykład, który pokazuje, jak skojarzyć metodę z delegatem, a następnie wywołać tę metodę za pomocą delegata.</span><span class="sxs-lookup"><span data-stu-id="1ff87-150">Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</span></span>|
|[<span data-ttu-id="1ff87-151">Porady: przekazywanie procedur do innej procedury w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="1ff87-151">How to: Pass Procedures to Another Procedure in Visual Basic</span></span>](how-to-pass-procedures-to-another-procedure.md)|<span data-ttu-id="1ff87-152">Pokazuje, jak używać delegatów do przekazywania jednej procedury do innej procedury.</span><span class="sxs-lookup"><span data-stu-id="1ff87-152">Demonstrates how to use delegates to pass one procedure to another procedure.</span></span>|
|[<span data-ttu-id="1ff87-153">Swobodna konwersja delegatów</span><span class="sxs-lookup"><span data-stu-id="1ff87-153">Relaxed Delegate Conversion</span></span>](relaxed-delegate-conversion.md)|<span data-ttu-id="1ff87-154">Opisuje, w jaki sposób można przypisać funkcje sub i Functions do delegatów lub programów obsługi nawet wtedy, gdy ich podpisy nie są identyczne.</span><span class="sxs-lookup"><span data-stu-id="1ff87-154">Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</span></span>|
|[<span data-ttu-id="1ff87-155">Zdarzenia</span><span class="sxs-lookup"><span data-stu-id="1ff87-155">Events</span></span>](../events/index.md)|<span data-ttu-id="1ff87-156">Zawiera omówienie zdarzeń w Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="1ff87-156">Provides an overview of events in Visual Basic.</span></span>|
