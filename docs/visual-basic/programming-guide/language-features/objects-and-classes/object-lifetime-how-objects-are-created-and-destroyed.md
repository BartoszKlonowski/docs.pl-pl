---
title: 'Okres istnienia obiektów: w jaki sposób obiekty są tworzone i niszczone (Visual Basic)'
ms.date: 07/20/2015
f1_keywords:
- vb.Constructor
helpviewer_keywords:
- destructors, object lifetime
- Sub Finalize destructor
- objects [Visual Basic], destroying
- lifetime [Visual Basic], objects
- Sub New constructor, object lifetime
- Finalize method [Visual Basic], object lifetime
- objects [Visual Basic], creating
- Class_Terminate
- Dispose method [Visual Basic], object lifetime
- Class_Initialize
- object creation [Visual Basic], object lifetime
- parameterized constructors
- objects [Visual Basic], lifetime
- objects [Visual Basic], garbage collection
- constructors [Visual Basic], object lifetime
- Sub Dispose destructor
- garbage collection [Visual Basic], Visual Basic
ms.assetid: f1ee8458-b156-44e0-9a8a-5dd171648cd8
ms.openlocfilehash: 441fe91c8c884e59c6399d57e7e55bf6591cb1bb
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
---
# <a name="object-lifetime-how-objects-are-created-and-destroyed-visual-basic"></a><span data-ttu-id="c39ab-102">Okres istnienia obiektów: w jaki sposób obiekty są tworzone i niszczone (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="c39ab-102">Object Lifetime: How Objects Are Created and Destroyed (Visual Basic)</span></span>
<span data-ttu-id="c39ab-103">Wystąpienie klasy, obiektu, jest tworzona przy użyciu `New` — słowo kluczowe.</span><span class="sxs-lookup"><span data-stu-id="c39ab-103">An instance of a class, an object, is created by using the `New` keyword.</span></span> <span data-ttu-id="c39ab-104">Inicjowanie zadania często muszą być wykonywane na nowe obiekty zanim zostaną użyte.</span><span class="sxs-lookup"><span data-stu-id="c39ab-104">Initialization tasks often must be performed on new objects before they are used.</span></span> <span data-ttu-id="c39ab-105">Typowe zadania inicjowania obejmują otwieranie plików, łączenie z bazami danych i odczytywania wartości kluczy rejestru.</span><span class="sxs-lookup"><span data-stu-id="c39ab-105">Common initialization tasks include opening files, connecting to databases, and reading values of registry keys.</span></span> <span data-ttu-id="c39ab-106">Visual Basic steruje inicjowania nowych obiektów za pomocą procedur o nazwie *konstruktorów* (specjalne metody umożliwiające kontrolę nad inicjowania).</span><span class="sxs-lookup"><span data-stu-id="c39ab-106">Visual Basic controls the initialization of new objects using procedures called *constructors* (special methods that allow control over initialization).</span></span>  
  
 <span data-ttu-id="c39ab-107">Obiekt zwolnionego zakres jest wydane przez środowisko uruchomieniowe języka wspólnego (CLR).</span><span class="sxs-lookup"><span data-stu-id="c39ab-107">After an object leaves scope, it is released by the common language runtime (CLR).</span></span> <span data-ttu-id="c39ab-108">Visual Basic steruje zwolnienia zasobów systemowych przy użyciu procedury o nazwie *destruktory*.</span><span class="sxs-lookup"><span data-stu-id="c39ab-108">Visual Basic controls the release of system resources using procedures called *destructors*.</span></span> <span data-ttu-id="c39ab-109">Razem konstruktory i destruktory obsługuje tworzenie bibliotek klas niezawodny i przewidywalne.</span><span class="sxs-lookup"><span data-stu-id="c39ab-109">Together, constructors and destructors support the creation of robust and predictable class libraries.</span></span>  
  
## <a name="using-constructors-and-destructors"></a><span data-ttu-id="c39ab-110">Przy użyciu konstruktory i destruktory</span><span class="sxs-lookup"><span data-stu-id="c39ab-110">Using Constructors and Destructors</span></span>  
 <span data-ttu-id="c39ab-111">Konstruktory i destruktory kontrolować tworzenie i likwidacja obiektów.</span><span class="sxs-lookup"><span data-stu-id="c39ab-111">Constructors and destructors control the creation and destruction of objects.</span></span> <span data-ttu-id="c39ab-112">`Sub New` i `Sub Finalize` procedury w Visual Basic, zainicjować i zniszcz obiektów; zastępują one `Class_Initialize` i `Class_Terminate` metody używane w Visual Basic 6.0 i starszych wersji.</span><span class="sxs-lookup"><span data-stu-id="c39ab-112">The `Sub New` and `Sub Finalize` procedures in Visual Basic initialize and destroy objects; they replace the `Class_Initialize` and `Class_Terminate` methods used in Visual Basic 6.0 and earlier versions.</span></span>  
  
### <a name="sub-new"></a><span data-ttu-id="c39ab-113">Nowe podrzędne</span><span class="sxs-lookup"><span data-stu-id="c39ab-113">Sub New</span></span>  
 <span data-ttu-id="c39ab-114">`Sub New` Konstruktora można uruchomić tylko raz, podczas tworzenia klasy.</span><span class="sxs-lookup"><span data-stu-id="c39ab-114">The `Sub New` constructor can run only once when a class is created.</span></span> <span data-ttu-id="c39ab-115">Nie można wywołać w jawnie w dowolnym miejscu innym niż w pierwszym wierszu kodu innego konstruktora z tej samej klasy lub z klasy pochodnej.</span><span class="sxs-lookup"><span data-stu-id="c39ab-115">It cannot be called explicitly anywhere other than in the first line of code of another constructor from either the same class or from a derived class.</span></span> <span data-ttu-id="c39ab-116">Ponadto kod w `Sub New` metoda zawsze jest uruchamiana przed innymi kod w klasie.</span><span class="sxs-lookup"><span data-stu-id="c39ab-116">Furthermore, the code in the `Sub New` method always runs before any other code in a class.</span></span> [!INCLUDE[vbprvblong](~/includes/vbprvblong-md.md)]<span data-ttu-id="c39ab-117"> i nowszych wersjach niejawnie Utwórz `Sub New` konstruktora w czasie wykonywania, jeśli nie zostanie jawnie zdefiniowana `Sub New` procedury dla klasy.</span><span class="sxs-lookup"><span data-stu-id="c39ab-117"> and later versions implicitly create a `Sub New` constructor at run time if you do not explicitly define a `Sub New` procedure for a class.</span></span>  
  
 <span data-ttu-id="c39ab-118">Aby utworzyć konstruktor dla klasy, Utwórz procedurę o nazwie `Sub New` w dowolnym miejscu definicji klasy.</span><span class="sxs-lookup"><span data-stu-id="c39ab-118">To create a constructor for a class, create a procedure named `Sub New` anywhere in the class definition.</span></span> <span data-ttu-id="c39ab-119">Aby utworzyć sparametryzowanym konstruktorze, określ nazwy i dane typy argumentów `Sub New` tylko należy określić argumenty dla innej procedury, zgodnie z poniższym kodem:</span><span class="sxs-lookup"><span data-stu-id="c39ab-119">To create a parameterized constructor, specify the names and data types of arguments to `Sub New` just as you would specify arguments for any other procedure, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrOOP#42](../../../../visual-basic/misc/codesnippet/VisualBasic/object-lifetime-how-objects-are-created-and-destroyed_1.vb)]  
  
 <span data-ttu-id="c39ab-120">Konstruktory są często przeciążone zgodnie z poniższym kodem:</span><span class="sxs-lookup"><span data-stu-id="c39ab-120">Constructors are frequently overloaded, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrOOP#116](../../../../visual-basic/misc/codesnippet/VisualBasic/object-lifetime-how-objects-are-created-and-destroyed_2.vb)]  
  
 <span data-ttu-id="c39ab-121">Po zdefiniowaniu klasy pochodnej z innej klasy pierwszy wiersz konstruktora musi być wywołanie konstruktora klasy podstawowej, chyba że klasę podstawową był dostępny konstruktor, który nie przyjmuje żadnych parametrów.</span><span class="sxs-lookup"><span data-stu-id="c39ab-121">When you define a class derived from another class, the first line of a constructor must be a call to the constructor of the base class, unless the base class has an accessible constructor that takes no parameters.</span></span> <span data-ttu-id="c39ab-122">Byłoby wywołania do klasy podstawowej, zawierający powyżej konstruktora, na przykład `MyBase.New(s)`.</span><span class="sxs-lookup"><span data-stu-id="c39ab-122">A call to the base class that contains the above constructor, for example, would be `MyBase.New(s)`.</span></span> <span data-ttu-id="c39ab-123">W przeciwnym razie `MyBase.New` jest opcjonalny, i wywołuje go niejawnie środowiska uruchomieniowego języka Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="c39ab-123">Otherwise, `MyBase.New` is optional, and the Visual Basic runtime calls it implicitly.</span></span>  
  
 <span data-ttu-id="c39ab-124">Po napisaniu kod, aby wywołać konstruktora obiektu nadrzędnego, można dodać dowolny kod inicjujący dodatkowe do `Sub New` procedury.</span><span class="sxs-lookup"><span data-stu-id="c39ab-124">After you write the code to call the parent object's constructor, you can add any additional initialization code to the `Sub New` procedure.</span></span> <span data-ttu-id="c39ab-125">`Sub New` mogą akceptować argumenty wywołanego jako sparametryzowanym konstruktorze.</span><span class="sxs-lookup"><span data-stu-id="c39ab-125">`Sub New` can accept arguments when called as a parameterized constructor.</span></span> <span data-ttu-id="c39ab-126">Te parametry są przekazywane z procedury wywoływania konstruktora, na przykład `Dim AnObject As New ThisClass(X)`.</span><span class="sxs-lookup"><span data-stu-id="c39ab-126">These parameters are passed from the procedure calling the constructor, for example, `Dim AnObject As New ThisClass(X)`.</span></span>  
  
### <a name="sub-finalize"></a><span data-ttu-id="c39ab-127">Sub Finalize</span><span class="sxs-lookup"><span data-stu-id="c39ab-127">Sub Finalize</span></span>  
 <span data-ttu-id="c39ab-128">Przed wydaniem obiektów, automatycznie wywołuje CLR `Finalize` metody dla obiektów, które definiują `Sub Finalize` procedury.</span><span class="sxs-lookup"><span data-stu-id="c39ab-128">Before releasing objects, the CLR automatically calls the `Finalize` method for objects that define a `Sub Finalize` procedure.</span></span> <span data-ttu-id="c39ab-129">`Finalize` Metody może zawierać kod, który można wykonać tylko przed obiektu, takie jak kod zamykanie plików i zapisywanie informacji o stanie.</span><span class="sxs-lookup"><span data-stu-id="c39ab-129">The `Finalize` method can contain code that needs to execute just before an object is destroyed, such as code for closing files and saving state information.</span></span> <span data-ttu-id="c39ab-130">Jest zmniejszenie wydajności nieznaczne wykonywania `Sub Finalize`, więc należy zdefiniować `Sub Finalize` metody tylko wtedy, gdy trzeba jawnie wersji obiektów.</span><span class="sxs-lookup"><span data-stu-id="c39ab-130">There is a slight performance penalty for executing `Sub Finalize`, so you should define a `Sub Finalize` method only when you need to release objects explicitly.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c39ab-131">Moduł garbage collector środowiska CLR nie i nie może usuwa *niezarządzane obiekty*, obiekty, które system operacyjny jest wykonywana bezpośrednio, poza środowiskiem CLR.</span><span class="sxs-lookup"><span data-stu-id="c39ab-131">The garbage collector in the CLR does not (and cannot) dispose of *unmanaged objects*, objects that the operating system executes directly, outside the CLR environment.</span></span> <span data-ttu-id="c39ab-132">Jest to spowodowane różnych niezarządzane obiekty musi zostać usunięty z na różne sposoby.</span><span class="sxs-lookup"><span data-stu-id="c39ab-132">This is because different unmanaged objects must be disposed of in different ways.</span></span> <span data-ttu-id="c39ab-133">Informacje nie są bezpośrednio związane z niezarządzanego obiektu; musi zostać znaleziony w dokumentacji dla obiekt.</span><span class="sxs-lookup"><span data-stu-id="c39ab-133">That information is not directly associated with the unmanaged object; it must be found in the documentation for the object.</span></span> <span data-ttu-id="c39ab-134">Klasa, która używa niezarządzane obiekty musi dysponować je w jego `Finalize` metody.</span><span class="sxs-lookup"><span data-stu-id="c39ab-134">A class that uses unmanaged objects must dispose of them in its `Finalize` method.</span></span>  
  
 <span data-ttu-id="c39ab-135">`Finalize` Destruktora jest metoda chroniona, który można wywołać tylko z należy do klasy lub klas pochodnych.</span><span class="sxs-lookup"><span data-stu-id="c39ab-135">The `Finalize` destructor is a protected method that can be called only from the class it belongs to, or from derived classes.</span></span> <span data-ttu-id="c39ab-136">Wywołania systemowe `Finalize` automatycznie gdy obiekt zostanie zniszczony, dlatego nie należy bezpośrednio wywoływać `Finalize` z poza klasy pochodnej `Finalize` implementacji.</span><span class="sxs-lookup"><span data-stu-id="c39ab-136">The system calls `Finalize` automatically when an object is destroyed, so you should not explicitly call `Finalize` from outside of a derived class's `Finalize` implementation.</span></span>  
  
 <span data-ttu-id="c39ab-137">W odróżnieniu od `Class_Terminate`, który wykonuje się, gdy obiekt jest ustawiony na wartość nothing, jest zwykle opóźnienia między po obiektu utraci zakresu i gdy wywołuje Visual Basic `Finalize` destruktora.</span><span class="sxs-lookup"><span data-stu-id="c39ab-137">Unlike `Class_Terminate`, which executes as soon as an object is set to nothing, there is usually a delay between when an object loses scope and when Visual Basic calls the `Finalize` destructor.</span></span> [!INCLUDE[vbprvblong](~/includes/vbprvblong-md.md)]<span data-ttu-id="c39ab-138"> i nowszych wersjach umożliwiają drugi rodzaj destruktor, <xref:System.IDisposable.Dispose%2A>, której można jawnie wywołać w dowolnej chwili, aby natychmiast zwolnić zasoby.</span><span class="sxs-lookup"><span data-stu-id="c39ab-138"> and later versions allow for a second kind of destructor, <xref:System.IDisposable.Dispose%2A>, which can be explicitly called at any time to immediately release resources.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c39ab-139">A `Finalize` destruktor nie powinien zgłosić wyjątkami, ponieważ nie mogą być obsługiwane przez aplikację i może spowodować zamknięcie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c39ab-139">A `Finalize` destructor should not throw exceptions, because they cannot be handled by the application and can cause the application to terminate.</span></span>  
  
### <a name="how-new-and-finalize-methods-work-in-a-class-hierarchy"></a><span data-ttu-id="c39ab-140">Jak nowy i zakończenia pracy metod w hierarchii klas</span><span class="sxs-lookup"><span data-stu-id="c39ab-140">How New and Finalize Methods Work in a Class Hierarchy</span></span>  
 <span data-ttu-id="c39ab-141">Zawsze, gdy tworzone jest wystąpienie klasy, środowisko uruchomieniowe języka wspólnego (CLR) próbuje wykonać procedurę o nazwie `New`, jeśli istnieje w tym obiekcie.</span><span class="sxs-lookup"><span data-stu-id="c39ab-141">Whenever an instance of a class is created, the common language runtime (CLR) attempts to execute a procedure named `New`, if it exists in that object.</span></span> <span data-ttu-id="c39ab-142">`New` rodzaj procedury o nazwie `constructor` używany zainicjować nowe obiekty przed wykonaniem innego kodu w obiekcie.</span><span class="sxs-lookup"><span data-stu-id="c39ab-142">`New` is a type of procedure called a `constructor` that is used to initialize new objects before any other code in an object executes.</span></span> <span data-ttu-id="c39ab-143">A `New` Konstruktor może służyć do otwierania plików, połączenie z bazami danych zainicjować zmienne i zajmie się inne zadania, które trzeba wykonać te czynności przed użyciem obiektu.</span><span class="sxs-lookup"><span data-stu-id="c39ab-143">A `New` constructor can be used to open files, connect to databases, initialize variables, and take care of any other tasks that need to be done before an object can be used.</span></span>  
  
 <span data-ttu-id="c39ab-144">Gdy tworzone jest wystąpienie klasy pochodnej, `Sub New` konstruktora klasy podstawowej wykonuje najpierw następuje konstruktorów w klasach pochodnych.</span><span class="sxs-lookup"><span data-stu-id="c39ab-144">When an instance of a derived class is created, the `Sub New` constructor of the base class executes first, followed by constructors in derived classes.</span></span> <span data-ttu-id="c39ab-145">Zdarza się to pierwszy wiersz kodu w `Sub New` Konstruktor używa składni `MyBase.New()`można wywołać konstruktora klasy bezpośrednio nad sama w hierarchii klasy.</span><span class="sxs-lookup"><span data-stu-id="c39ab-145">This happens because the first line of code in a `Sub New` constructor uses the syntax `MyBase.New()`to call the constructor of the class immediately above itself in the class hierarchy.</span></span> <span data-ttu-id="c39ab-146">`Sub New` Konstruktor jest następnie wywoływana dla każdej klasy w hierarchii klasy do konstruktora dla klasy podstawowej zostanie osiągnięty.</span><span class="sxs-lookup"><span data-stu-id="c39ab-146">The `Sub New` constructor is then called for each class in the class hierarchy until the constructor for the base class is reached.</span></span> <span data-ttu-id="c39ab-147">W tym momencie kodu w Konstruktorze dla klasy podstawowej wykonuje, następuje kod w każdym konstruktora dla wszystkich klas pochodnych i ostatnio wykonywany jest kod w najdalszych pochodnych klas.</span><span class="sxs-lookup"><span data-stu-id="c39ab-147">At that point, the code in the constructor for the base class executes, followed by the code in each constructor in all derived classes and the code in the most derived classes is executed last.</span></span>  
  
 <span data-ttu-id="c39ab-148">![Konstruktory i dziedziczenie](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance.gif "vaConstructorsInheritance")</span><span class="sxs-lookup"><span data-stu-id="c39ab-148">![Constructors and Inheritance](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance.gif "vaConstructorsInheritance")</span></span>  
  
 <span data-ttu-id="c39ab-149">Gdy obiekt nie jest już potrzebne, wywołuje CLR <xref:System.Object.Finalize%2A> metody dla tego obiektu przed zwalnianie pamięci.</span><span class="sxs-lookup"><span data-stu-id="c39ab-149">When an object is no longer needed, the CLR calls the <xref:System.Object.Finalize%2A> method for that object before freeing its memory.</span></span> <span data-ttu-id="c39ab-150"><xref:System.Object.Finalize%2A> Wywoływana jest metoda `destructor` ponieważ wykonuje zadania oczyszczania, takie jak zapisywanie informacji o stanie, zamykanie plików i połączenia z bazami danych i innych zadań, które muszą być wykonane przed zwolnieniem obiektu.</span><span class="sxs-lookup"><span data-stu-id="c39ab-150">The <xref:System.Object.Finalize%2A> method is called a `destructor` because it performs cleanup tasks, such as saving state information, closing files and connections to databases, and other tasks that must be done before releasing the object.</span></span>  
  
 <span data-ttu-id="c39ab-151">![Dziedziczenie konstruktorów 2](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance_2.gif "vaConstructorsInheritance_2")</span><span class="sxs-lookup"><span data-stu-id="c39ab-151">![Constructors Inheritance2](../../../../visual-basic/programming-guide/language-features/objects-and-classes/media/vaconstructorsinheritance_2.gif "vaConstructorsInheritance_2")</span></span>  
  
## <a name="idisposable-interface"></a><span data-ttu-id="c39ab-152">Interfejs IDisposable</span><span class="sxs-lookup"><span data-stu-id="c39ab-152">IDisposable Interface</span></span>  
 <span data-ttu-id="c39ab-153">Wystąpienia klas kontrolować często zasobów nie są zarządzane przez środowisko CLR, takie jak uchwyty okien i połączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="c39ab-153">Class instances often control resources not managed by the CLR, such as Windows handles and database connections.</span></span> <span data-ttu-id="c39ab-154">Te zasoby muszą być usuwane w `Finalize` metody klasy, dzięki czemu będzie można zwolnić, gdy obiekt zostanie zniszczony przez moduł garbage collector.</span><span class="sxs-lookup"><span data-stu-id="c39ab-154">These resources must be disposed of in the `Finalize` method of the class, so that they will be released when the object is destroyed by the garbage collector.</span></span> <span data-ttu-id="c39ab-155">Jednak moduł garbage collector niszczy obiektów tylko wtedy, gdy środowisko CLR wymaga więcej pamięci.</span><span class="sxs-lookup"><span data-stu-id="c39ab-155">However, the garbage collector destroys objects only when the CLR requires more free memory.</span></span> <span data-ttu-id="c39ab-156">Oznacza to, że zasoby nie można zwolnić dopiero, gdy obiekt wykracza poza zakres.</span><span class="sxs-lookup"><span data-stu-id="c39ab-156">This means that the resources may not be released until long after the object goes out of scope.</span></span>  
  
 <span data-ttu-id="c39ab-157">Uzupełnienie wyrzucanie elementów bezużytecznych, klas zapewniają mechanizm aktywnie zarządzać zasobami systemu, jeśli wdrażają <xref:System.IDisposable> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="c39ab-157">To supplement garbage collection, your classes can provide a mechanism to actively manage system resources if they implement the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="c39ab-158"><xref:System.IDisposable> zawiera jedną metodę <xref:System.IDisposable.Dispose%2A>, których klienci powinny wywoływać przy kończyły się przy użyciu obiektu.</span><span class="sxs-lookup"><span data-stu-id="c39ab-158"><xref:System.IDisposable> has one method, <xref:System.IDisposable.Dispose%2A>, which clients should call when they finish using an object.</span></span> <span data-ttu-id="c39ab-159">Można użyć <xref:System.IDisposable.Dispose%2A> metody natychmiast zwolnić zasoby i wykonywać zadania, takie jak zamykanie plików i połączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="c39ab-159">You can use the <xref:System.IDisposable.Dispose%2A> method to immediately release resources and perform tasks such as closing files and database connections.</span></span> <span data-ttu-id="c39ab-160">W odróżnieniu od `Finalize` destruktor, <xref:System.IDisposable.Dispose%2A> metoda nie jest wywoływana automatycznie.</span><span class="sxs-lookup"><span data-stu-id="c39ab-160">Unlike the `Finalize` destructor, the <xref:System.IDisposable.Dispose%2A> method is not called automatically.</span></span> <span data-ttu-id="c39ab-161">Klienci klasy musi jawnie wywołać <xref:System.IDisposable.Dispose%2A> Jeśli chcesz natychmiast zwolnić zasoby.</span><span class="sxs-lookup"><span data-stu-id="c39ab-161">Clients of a class must explicitly call <xref:System.IDisposable.Dispose%2A> when you want to immediately release resources.</span></span>  
  
### <a name="implementing-idisposable"></a><span data-ttu-id="c39ab-162">Implementacja interfejsu IDisposable</span><span class="sxs-lookup"><span data-stu-id="c39ab-162">Implementing IDisposable</span></span>  
 <span data-ttu-id="c39ab-163">Klasa, która implementuje <xref:System.IDisposable> interfejsu powinny zawierać tych fragmentów kodu:</span><span class="sxs-lookup"><span data-stu-id="c39ab-163">A class that implements the <xref:System.IDisposable> interface should include these sections of code:</span></span>  
  
-   <span data-ttu-id="c39ab-164">Pole w celu śledzenia czy obiekt został usunięty:</span><span class="sxs-lookup"><span data-stu-id="c39ab-164">A field for keeping track of whether the object has been disposed:</span></span>  
  
    ```  
    Protected disposed As Boolean = False  
    ```  
  
-   <span data-ttu-id="c39ab-165">Przeciążenie <xref:System.IDisposable.Dispose%2A> który zwalnia zasoby tej klasy.</span><span class="sxs-lookup"><span data-stu-id="c39ab-165">An overload of the <xref:System.IDisposable.Dispose%2A> that frees the class's resources.</span></span> <span data-ttu-id="c39ab-166">Ta metoda powinna być wywoływana <xref:System.IDisposable.Dispose%2A> i `Finalize` metody klasy podstawowej:</span><span class="sxs-lookup"><span data-stu-id="c39ab-166">This method should be called by the <xref:System.IDisposable.Dispose%2A> and `Finalize` methods of the base class:</span></span>  
  
    ```  
    Protected Overridable Sub Dispose(ByVal disposing As Boolean)  
        If Not Me.disposed Then  
            If disposing Then  
                ' Insert code to free managed resources.  
            End If  
            ' Insert code to free unmanaged resources.  
        End If  
        Me.disposed = True  
    End Sub  
    ```  
  
-   <span data-ttu-id="c39ab-167">Implementacja interfejsu <xref:System.IDisposable.Dispose%2A> zawierający następujący kod:</span><span class="sxs-lookup"><span data-stu-id="c39ab-167">An implementation of <xref:System.IDisposable.Dispose%2A> that contains only the following code:</span></span>  
  
    ```  
    Public Sub Dispose() Implements IDisposable.Dispose  
        Dispose(True)  
        GC.SuppressFinalize(Me)  
    End Sub  
    ```  
  
-   <span data-ttu-id="c39ab-168">Zastępowanie `Finalize` metodę, która zawiera następujący kod:</span><span class="sxs-lookup"><span data-stu-id="c39ab-168">An override of the `Finalize` method that contains only the following code:</span></span>  
  
    ```  
    Protected Overrides Sub Finalize()  
        Dispose(False)  
        MyBase.Finalize()  
    End Sub  
    ```  
  
### <a name="deriving-from-a-class-that-implements-idisposable"></a><span data-ttu-id="c39ab-169">Wyprowadzanie z klasy, która implementuje interfejs IDisposable</span><span class="sxs-lookup"><span data-stu-id="c39ab-169">Deriving from a Class that Implements IDisposable</span></span>  
 <span data-ttu-id="c39ab-170">Klasa, która pochodzi z klasy podstawowej, która implementuje <xref:System.IDisposable> interfejsu nie należy do przesłonięcia żadnej z metod bazowych, chyba że używa dodatkowe zasoby, które muszą zostać usunięte.</span><span class="sxs-lookup"><span data-stu-id="c39ab-170">A class that derives from a base class that implements the <xref:System.IDisposable> interface does not need to override any of the base methods unless it uses additional resources that need to be disposed.</span></span> <span data-ttu-id="c39ab-171">W takiej sytuacji klasy pochodne powinny przesłaniać klasy podstawowej `Dispose(disposing)` metodę dispose klasy pochodnej zasobów.</span><span class="sxs-lookup"><span data-stu-id="c39ab-171">In that situation, the derived class should override the base class's `Dispose(disposing)` method to dispose of the derived class's resources.</span></span> <span data-ttu-id="c39ab-172">To zastąpienie musi wywołać klasy podstawowej `Dispose(disposing)` metody.</span><span class="sxs-lookup"><span data-stu-id="c39ab-172">This override must call the base class's `Dispose(disposing)` method.</span></span>  
  
```  
Protected Overrides Sub Dispose(ByVal disposing As Boolean)  
    If Not Me.disposed Then  
        If disposing Then  
            ' Insert code to free managed resources.  
        End If  
        ' Insert code to free unmanaged resources.  
    End If  
    MyBase.Dispose(disposing)  
End Sub  
```  
  
 <span data-ttu-id="c39ab-173">Klasa pochodna nie powinien przesłonić klasy podstawowej <xref:System.IDisposable.Dispose%2A> i `Finalize` metody.</span><span class="sxs-lookup"><span data-stu-id="c39ab-173">A derived class should not override the base class's <xref:System.IDisposable.Dispose%2A> and `Finalize` methods.</span></span> <span data-ttu-id="c39ab-174">Jeśli te metody są wywoływane z wystąpienia klasy pochodnej, implementacji klasy podstawowej z tych metod wywołania zastąpienie klasy pochodnej z `Dispose(disposing)` metody.</span><span class="sxs-lookup"><span data-stu-id="c39ab-174">When those methods are called from an instance of the derived class, the base class's implementation of those methods call the derived class's override of the `Dispose(disposing)` method.</span></span>  
  
## <a name="garbage-collection-and-the-finalize-destructor"></a><span data-ttu-id="c39ab-175">Wyrzucanie elementów bezużytecznych i zakończenia — destruktor</span><span class="sxs-lookup"><span data-stu-id="c39ab-175">Garbage Collection and the Finalize Destructor</span></span>  
 <span data-ttu-id="c39ab-176">[!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] Używa *odwołanie śledzenia wyrzucanie elementów bezużytecznych* systemu, aby okresowo zwolnić zasoby nieużywane.</span><span class="sxs-lookup"><span data-stu-id="c39ab-176">The [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] uses the *reference-tracing garbage collection* system to periodically release unused resources.</span></span> <span data-ttu-id="c39ab-177">Visual Basic 6.0 i starszych wersji użyć innego systemu o nazwie *liczenie odwołań w* do zarządzania zasobami.</span><span class="sxs-lookup"><span data-stu-id="c39ab-177">Visual Basic 6.0 and earlier versions used a different system called *reference counting* to manage resources.</span></span> <span data-ttu-id="c39ab-178">Mimo że obu systemów automatycznie wykonywać tę samą funkcję, istnieje kilka istotnych różnic.</span><span class="sxs-lookup"><span data-stu-id="c39ab-178">Although both systems perform the same function automatically, there are a few important differences.</span></span>  
  
 <span data-ttu-id="c39ab-179">Środowisko CLR niszczy obiektów okresowo, gdy system sprawdza, czy takie obiekty nie są już potrzebne.</span><span class="sxs-lookup"><span data-stu-id="c39ab-179">The CLR periodically destroys objects when the system determines that such objects are no longer needed.</span></span> <span data-ttu-id="c39ab-180">Obiekty są zwalniane szybciej, gdy zasoby systemowe są w przeciwnym razie Podaj krótki, a rzadziej.</span><span class="sxs-lookup"><span data-stu-id="c39ab-180">Objects are released more quickly when system resources are in short supply, and less frequently otherwise.</span></span> <span data-ttu-id="c39ab-181">Opóźnienie między po obiektu utraci zakresu i kiedy CLR zwolnieniem oznacza, że w przeciwieństwie do obiektów w Visual Basic 6.0 i starszych wersji, nie można określić dokładnie gdy obiekt zostanie zniszczona.</span><span class="sxs-lookup"><span data-stu-id="c39ab-181">The delay between when an object loses scope and when the CLR releases it means that, unlike with objects in Visual Basic 6.0 and earlier versions, you cannot determine exactly when the object will be destroyed.</span></span> <span data-ttu-id="c39ab-182">W takiej sytuacji obiekty są określane jako ma *deterministyczna istnienia*.</span><span class="sxs-lookup"><span data-stu-id="c39ab-182">In such a situation, objects are said to have *non-deterministic lifetime*.</span></span> <span data-ttu-id="c39ab-183">W większości przypadków deterministyczna istnienia nie zmienia sposobu pisania aplikacji, tak długo, jak należy pamiętać, że `Finalize` destruktor nie może od razu wykonany, gdy obiekt utraci zakresu.</span><span class="sxs-lookup"><span data-stu-id="c39ab-183">In most cases, non-deterministic lifetime does not change how you write applications, as long as you remember that the `Finalize` destructor may not immediately execute when an object loses scope.</span></span>  
  
 <span data-ttu-id="c39ab-184">Inna różnica między systemami wyrzucanie elementów bezużytecznych wymaga stosowania `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="c39ab-184">Another difference between the garbage-collection systems involves the use of `Nothing`.</span></span> <span data-ttu-id="c39ab-185">Aby skorzystać z zliczanie w Visual Basic 6.0 i starszych wersjach, czasami przypisane programistów `Nothing` do obiektu zmienne do zwolnienia odwołania tych zmiennych przechowywanych.</span><span class="sxs-lookup"><span data-stu-id="c39ab-185">To take advantage of reference counting in Visual Basic 6.0 and earlier versions, programmers sometimes assigned `Nothing` to object variables to release the references those variables held.</span></span> <span data-ttu-id="c39ab-186">Jeśli zmienna przechowywać ostatnie odwołanie do obiektu, obiektu zasoby zostały wydane od razu.</span><span class="sxs-lookup"><span data-stu-id="c39ab-186">If the variable held the last reference to the object, the object's resources were released immediately.</span></span> <span data-ttu-id="c39ab-187">W nowszych wersjach programu Visual Basic może być przypadki, w których jest wciąż obsługiwane w tej procedurze wykonywania go nigdy nie powoduje, że przywoływanego obiektu natychmiast zwolnienia zasobów.</span><span class="sxs-lookup"><span data-stu-id="c39ab-187">In later versions of Visual Basic, while there may be cases in which this procedure is still valuable, performing it never causes the referenced object to release its resources immediately.</span></span> <span data-ttu-id="c39ab-188">Aby zwolnić zasoby natychmiast, użyj obiektu <xref:System.IDisposable.Dispose%2A> metody, jeśli jest dostępna.</span><span class="sxs-lookup"><span data-stu-id="c39ab-188">To release resources immediately, use the object's <xref:System.IDisposable.Dispose%2A> method, if available.</span></span> <span data-ttu-id="c39ab-189">Tylko wtedy można ustawić zmiennej `Nothing` przypadku długo względnym w stosunku do modułu zbierającego elementy bezużyteczne czasie wykryć obiekty oddzielone jego okres istnienia.</span><span class="sxs-lookup"><span data-stu-id="c39ab-189">The only time you should set a variable to `Nothing` is when its lifetime is long relative to the time the garbage collector takes to detect orphaned objects.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c39ab-190">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="c39ab-190">See Also</span></span>  
 <xref:System.IDisposable.Dispose%2A>  
 [<span data-ttu-id="c39ab-191">Inicjowanie i kończenie działania składników</span><span class="sxs-lookup"><span data-stu-id="c39ab-191">Initialization and Termination of Components</span></span>](http://msdn.microsoft.com/library/58444076-a9d2-4c91-b3f6-0e180dc0695d)  
 [<span data-ttu-id="c39ab-192">Operator New</span><span class="sxs-lookup"><span data-stu-id="c39ab-192">New Operator</span></span>](../../../../visual-basic/language-reference/operators/new-operator.md)  
 [<span data-ttu-id="c39ab-193">Oczyszczanie zasobów niezarządzanych</span><span class="sxs-lookup"><span data-stu-id="c39ab-193">Cleaning Up Unmanaged Resources</span></span>](../../../../standard/garbage-collection/unmanaged.md)  
 [<span data-ttu-id="c39ab-194">Nothing</span><span class="sxs-lookup"><span data-stu-id="c39ab-194">Nothing</span></span>](../../../../visual-basic/language-reference/nothing.md)
