---
title: Wartości zwracane REF (Visual Basic)
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: d0600f7d9030324160343e800c37e0f5e68bff61
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/18/2019
ms.locfileid: "59133981"
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="76479-102">Obsługa wartości zwracane odwołanie (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="76479-102">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="76479-103">Począwszy od C# 7.0, C# obsługuje język *odwoływać się do wartości zwracane*.</span><span class="sxs-lookup"><span data-stu-id="76479-103">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="76479-104">Jednym ze sposobów, aby zrozumieć wartości zwracane odwołanie jest możliwość ich przeciwieństwo argumenty, które są przekazywane przez odwołanie do metody.</span><span class="sxs-lookup"><span data-stu-id="76479-104">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="76479-105">Po zmodyfikowaniu argument przekazywany przez odwołanie, zmiany są odzwierciedlane w wartości zmiennej na obiekcie wywołującym.</span><span class="sxs-lookup"><span data-stu-id="76479-105">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="76479-106">Modyfikacje wprowadzone do odwołania wartość zwracana przez obiekt wywołujący metodę zawiera wartość zwracaną odwołanie do elementu wywołującego, są odzwierciedlane w danych o nazwie metody.</span><span class="sxs-lookup"><span data-stu-id="76479-106">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="76479-107">Visual Basic nie zezwala na umożliwia tworzenie metod z odwołaniem do wartości zwracane, ale go zezwala na używanie wartości zwracane odwołanie.</span><span class="sxs-lookup"><span data-stu-id="76479-107">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="76479-108">Innymi słowy można wywołać metody zawierającej określenie zwracanej wartości odniesienia i modyfikować tej wartości zwracanej, a zmiany na wartość zwracaną odwołania są uwzględniane w danych o nazwie metody.</span><span class="sxs-lookup"><span data-stu-id="76479-108">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="76479-109">Modyfikowanie bezpośrednio zwracana wartość ref</span><span class="sxs-lookup"><span data-stu-id="76479-109">Modifying the ref return value directly</span></span>

<span data-ttu-id="76479-110">Dla metod, które zawsze powiedzie się i nie mają `ByRef` parametry, zwracana wartość odniesienia można zmodyfikować bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="76479-110">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="76479-111">W tym celu przypisywania nową wartość do wyrażenia, które zwraca wartość zwracaną odwołania.</span><span class="sxs-lookup"><span data-stu-id="76479-111">You do this by assigning the new value to the expressions that returns the reference return value.</span></span> 

<span data-ttu-id="76479-112">Następujące C# przykładzie zdefiniowano `NumericValue.IncrementValue` metodę, która zwiększa wartość będącą liczbą wewnętrzny i zwraca go jako odwołanie zwracają wartość.</span><span class="sxs-lookup"><span data-stu-id="76479-112">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span> 

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="76479-113">Odwołanie zwracana wartość jest następnie modyfikowana przez obiekt wywołujący w poniższym przykładzie w języku Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="76479-113">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="76479-114">Należy pamiętać, że wiersz z `NumericValue.IncrementValue` wywołanie metody nie przypisuje wartość do metody.</span><span class="sxs-lookup"><span data-stu-id="76479-114">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="76479-115">Zamiast tego przypisuje wartość do wartości zwracane odwołanie zwracany przez metodę.</span><span class="sxs-lookup"><span data-stu-id="76479-115">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="76479-116">Za pomocą innej metody pomocnika</span><span class="sxs-lookup"><span data-stu-id="76479-116">Using a helper method</span></span>

<span data-ttu-id="76479-117">W innych przypadkach modyfikując wartość zwracaną odwołanie do wywołania metody bezpośrednio może nie zawsze jest pożądane.</span><span class="sxs-lookup"><span data-stu-id="76479-117">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="76479-118">Na przykład metoda wyszukiwania, które zwraca ciąg może nie zawsze znaleźć dopasowania.</span><span class="sxs-lookup"><span data-stu-id="76479-118">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="76479-119">W takim przypadku chcesz zmodyfikować zwracanej wartości odniesienia, tylko w przypadku, jeśli wyszukiwanie zakończy się pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="76479-119">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="76479-120">Następujące C# przykład ilustruje ten scenariusz.</span><span class="sxs-lookup"><span data-stu-id="76479-120">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="76479-121">Definiuje on `Sentence` klasy w C# obejmuje `FindNext` metodę, która umożliwia znalezienie następnego wyrazu w zdaniu, zaczynającą się podanym podciągiem.</span><span class="sxs-lookup"><span data-stu-id="76479-121">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="76479-122">Ten ciąg jest zwracany jako wartość zwracana przez odwołanie, a `Boolean` zmiennej przekazywany przez odwołanie do metody wskazuje, czy wyszukiwanie zakończyło się pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="76479-122">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="76479-123">Dokumentacja zwracana wartość wskazuje, czy wywołujący można nie tylko do odczytu zwrócona wartość; on również zmodyfikować go, a tej zmiany jest widoczny w danych znajdujących się wewnętrznie w `Sentence` klasy.</span><span class="sxs-lookup"><span data-stu-id="76479-123">The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="76479-124">Bezpośrednie modyfikowanie odwołanie zwracana wartość w tym przypadku nie są wiarygodne, ponieważ wywołania metody które może się nie powieść znaleźć dopasowania i powrócić pierwszy wyraz w zdaniu.</span><span class="sxs-lookup"><span data-stu-id="76479-124">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="76479-125">W takim przypadku obiekt wywołujący przypadkowo zmodyfikuje pierwszy wyraz zdania.</span><span class="sxs-lookup"><span data-stu-id="76479-125">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="76479-126">Można to zapobiegać przez obiekt wywołujący, zwracając `null` (lub `Nothing` w języku Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="76479-126">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="76479-127">Ale w takim przypadku próby zmodyfikowania ciągu, którego wartością jest `Nothing` zgłasza <xref:System.NullReferenceException>.</span><span class="sxs-lookup"><span data-stu-id="76479-127">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="76479-128">Jeśli również można zapobiegać przez obiekt wywołujący, zwracając <xref:System.String.Empty?displayProperty=nameWithType>, ale wymaga to, że obiekt wywołujący definiowania zmiennej ciągu, którego wartością jest <xref:System.String.Empty?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="76479-128">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="76479-129">Gdy obiekt wywołujący może zmodyfikować te parametry, modyfikacji, sama służy nie, ponieważ modyfikacji ciągu nie ma relacji wyrazy w zdaniu przechowywane przez `Sentence` klasy.</span><span class="sxs-lookup"><span data-stu-id="76479-129">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="76479-130">Najlepszym sposobem obsługi tego scenariusza jest przekazać odwołanie wartość zwracaną przez odwołanie do metody pomocnika.</span><span class="sxs-lookup"><span data-stu-id="76479-130">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="76479-131">Metoda pomocnika zawiera następnie logika do określenia, czy wywołanie metody powiodło się, a jeśli go tak, aby zmodyfikować odwołania zwracają wartość.</span><span class="sxs-lookup"><span data-stu-id="76479-131">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="76479-132">W poniższym przykładzie przedstawiono potencjalne zastosowanie.</span><span class="sxs-lookup"><span data-stu-id="76479-132">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="76479-133">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="76479-133">See also</span></span>

- [<span data-ttu-id="76479-134">Przekazywanie argumentów według wartości i według odwołania</span><span class="sxs-lookup"><span data-stu-id="76479-134">Passing arguments by value and by reference</span></span>](passing-arguments-by-value-and-by-reference.md)
- [<span data-ttu-id="76479-135">Procedury w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="76479-135">Procedures in Visual Basic</span></span>](index.md)
