---
title: Inicjatory kolekcji (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.CollectionInitializer
helpviewer_keywords:
- collection initializers [Visual Basic]
ms.assetid: a9290329-77b0-4fdf-ae75-8fc17287f469
ms.openlocfilehash: 538efc11e477a4e90b7bca286da4ed56105d7ecb
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/23/2019
ms.locfileid: "61906831"
---
# <a name="collection-initializers-visual-basic"></a><span data-ttu-id="35518-102">Inicjatory kolekcji (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="35518-102">Collection Initializers (Visual Basic)</span></span>

<span data-ttu-id="35518-103">*Inicjatory kolekcji* zapewniają skróconą składnię, która umożliwia tworzenie kolekcji i wypełnianie jej początkowy zestaw wartości.</span><span class="sxs-lookup"><span data-stu-id="35518-103">*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values.</span></span> <span data-ttu-id="35518-104">Inicjatory kolekcji są przydatne, gdy tworzysz kolekcję z zestawu znane wartości, na przykład listę opcji menu lub kategorii, początkowy zestaw wartości liczbowych, statycznej listy ciągów, takich jak dzień lub miesiąc nazwy lub lokalizacje geograficzne, takich jak Lista stanów, który służy do sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="35518-104">Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.</span></span>

<span data-ttu-id="35518-105">Aby uzyskać więcej informacji na temat kolekcji, zobacz [kolekcje](../../../../visual-basic/programming-guide/concepts/collections.md).</span><span class="sxs-lookup"><span data-stu-id="35518-105">For more information about collections, see [Collections](../../../../visual-basic/programming-guide/concepts/collections.md).</span></span>

<span data-ttu-id="35518-106">Można zidentyfikować za pomocą inicjatora kolekcji `From` — słowo kluczowe następuje nawiasy klamrowe (`{}`).</span><span class="sxs-lookup"><span data-stu-id="35518-106">You identify a collection initializer by using the `From` keyword followed by braces (`{}`).</span></span> <span data-ttu-id="35518-107">Jest to podobne do składni literału tablicy, opisaną w [tablic](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="35518-107">This is similar to the array literal syntax that is described in [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span> <span data-ttu-id="35518-108">W poniższych przykładach pokazano różne sposoby tworzenia kolekcji za pomocą inicjatory kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-108">The following examples show various ways to use collection initializers to create collections.</span></span>

[!code-vb[VbVbalrCollectionInitializers#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#1)]

> [!NOTE]
> <span data-ttu-id="35518-109">C# zawiera również inicjatory kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-109">C# also provides collection initializers.</span></span> <span data-ttu-id="35518-110">Inicjatory kolekcji języka C# zapewnia taką samą funkcjonalność jak inicjatory kolekcji języka Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="35518-110">C# collection initializers provide the same functionality as Visual Basic collection initializers.</span></span> <span data-ttu-id="35518-111">Aby uzyskać więcej informacji na temat inicjatory kolekcji języka C#, zobacz [inicjatory obiektów i kolekcji](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span><span class="sxs-lookup"><span data-stu-id="35518-111">For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span></span>

## <a name="syntax"></a><span data-ttu-id="35518-112">Składnia</span><span class="sxs-lookup"><span data-stu-id="35518-112">Syntax</span></span>

<span data-ttu-id="35518-113">Inicjator kolekcji zawiera listę wartości rozdzielonych przecinkami, które są ujęte w nawiasy klamrowe (`{}`), poprzedzającą `From` — słowo kluczowe, jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="35518-113">A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#2)]

<span data-ttu-id="35518-114">Podczas tworzenia kolekcji, takie jak <xref:System.Collections.Generic.List%601> lub <xref:System.Collections.Generic.Dictionary%602>, należy podać typ kolekcji przed inicjatora kolekcji, jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="35518-114">When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#13)]

> [!NOTE]
> <span data-ttu-id="35518-115">Nie można łączyć zarówno inicjatora kolekcji i inicjatora obiektów, aby zainicjować tego samego obiektu kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-115">You cannot combine both a collection initializer and an object initializer to initialize the same collection object.</span></span> <span data-ttu-id="35518-116">Inicjatory obiektów umożliwia inicjowanie obiektów w inicjatorze kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-116">You can use object initializers to initialize objects in a collection initializer.</span></span>

## <a name="creating-a-collection-by-using-a-collection-initializer"></a><span data-ttu-id="35518-117">Tworzenie kolekcji przy użyciu inicjatora kolekcji</span><span class="sxs-lookup"><span data-stu-id="35518-117">Creating a Collection by Using a Collection Initializer</span></span>

<span data-ttu-id="35518-118">Podczas tworzenia kolekcji za pomocą inicjatora kolekcji każdej wartości, które jest dostarczone w inicjatorze kolekcji jest przekazywany do odpowiedniej `Add` metody kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-118">When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection.</span></span> <span data-ttu-id="35518-119">Na przykład, jeśli tworzysz <xref:System.Collections.Generic.List%601> za pomocą inicjatora kolekcji, każda wartość ciągu w inicjatora kolekcji jest przekazywany do <xref:System.Collections.Generic.List%601.Add%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="35518-119">For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method.</span></span> <span data-ttu-id="35518-120">Jeśli chcesz utworzyć kolekcję przy użyciu inicjatora kolekcji, określony typ musi być prawidłową kolekcję typów.</span><span class="sxs-lookup"><span data-stu-id="35518-120">If you want to create a collection by using a collection initializer, the specified type must be valid collection type.</span></span> <span data-ttu-id="35518-121">Typy kolekcji prawidłowe przykłady klas, które implementują <xref:System.Collections.Generic.IEnumerable%601> interfejs lub dziedziczyć <xref:System.Collections.CollectionBase> klasy.</span><span class="sxs-lookup"><span data-stu-id="35518-121">Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class.</span></span> <span data-ttu-id="35518-122">Określony typ musi również ujawnić `Add` metodę, która spełnia następujące kryteria.</span><span class="sxs-lookup"><span data-stu-id="35518-122">The specified type must also expose an `Add` method that meets the following criteria.</span></span>

- <span data-ttu-id="35518-123">`Add` Metody muszą być dostępne z zakresu, w którym jest wywoływana inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-123">The `Add` method must be available from the scope in which the collection initializer is being called.</span></span> <span data-ttu-id="35518-124">`Add` Metoda nie ma być publiczne, jeśli używasz inicjatora kolekcji w przypadku których można uzyskać dostępu do metod niepublicznych kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-124">The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.</span></span>

- <span data-ttu-id="35518-125">`Add` Metoda musi być składową wystąpienia lub `Shared` elementów członkowskich klasy kolekcji lub metodą rozszerzenia.</span><span class="sxs-lookup"><span data-stu-id="35518-125">The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method.</span></span>

- <span data-ttu-id="35518-126">`Add` Metody musi istnieć który można dopasować, na podstawie reguł rozdzielczość przeciążenia, na typy, które są dostarczane w inicjatorze kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-126">An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.</span></span>

 <span data-ttu-id="35518-127">Na przykład, poniższy kod pokazuje, jak utworzyć `List(Of Customer)` kolekcji przy użyciu inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-127">For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer.</span></span> <span data-ttu-id="35518-128">Gdy kod jest uruchamiany, każdy `Customer` obiekt jest przekazywany do `Add(Customer)` metoda listy ogólnej.</span><span class="sxs-lookup"><span data-stu-id="35518-128">When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list.</span></span>

[!code-vb[VbVbalrCollectionInitializers#9](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#9)]

<span data-ttu-id="35518-129">Poniższy przykład kodu pokazuje równoważny kod, który nie korzysta z inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-129">The following code example shows equivalent code that does not use a collection initializer.</span></span>

[!code-vb[VbVbalrCollectionInitializers#10](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#10)]

<span data-ttu-id="35518-130">Jeśli kolekcja zawiera `Add` metodę, która ma następujące parametry, które odpowiadają Konstruktor `Customer` obiektu, można zagnieżdżać wartości parametrów `Add` metodę w ramach inicjatory kolekcji, zgodnie z opisem w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-130">If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section.</span></span> <span data-ttu-id="35518-131">Jeśli kolekcja nie ma takich `Add` metody, możesz utworzyć je jako metodę rozszerzenia.</span><span class="sxs-lookup"><span data-stu-id="35518-131">If the collection does not have such an `Add` method, you can create one as an extension method.</span></span> <span data-ttu-id="35518-132">Aby uzyskać przykład sposobu tworzenia `Add` metodę jako metodę rozszerzenia dla kolekcji, zobacz [jak: Utwórz Dodawanie metody rozszerzania wykorzystywanej przez inicjator kolekcji](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="35518-132">For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span></span> <span data-ttu-id="35518-133">Na przykład sposobu tworzenia niestandardowej kolekcji, która może służyć za pomocą inicjatora kolekcji zobacz [jak: Tworzenie kolekcji wykorzystywanej przez inicjator kolekcji](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="35518-133">For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span></span>

## <a name="nesting-collection-initializers"></a><span data-ttu-id="35518-134">Zagnieżdżanie inicjatory kolekcji</span><span class="sxs-lookup"><span data-stu-id="35518-134">Nesting Collection Initializers</span></span>

<span data-ttu-id="35518-135">Można zagnieżdżać wartości w ramach inicjatora kolekcji, aby zidentyfikować określonego przeciążenia `Add` metody dla kolekcji, która jest tworzona.</span><span class="sxs-lookup"><span data-stu-id="35518-135">You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created.</span></span> <span data-ttu-id="35518-136">Wartość przekazywana do `Add` metody musi być rozdzielane przecinkami i ujęte w nawiasy klamrowe (`{}`), tak samo, jak w inicjatorze tablicy literału lub kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-136">The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer.</span></span>

<span data-ttu-id="35518-137">Po utworzeniu kolekcji przy użyciu zagnieżdżonych wartości każdy element na liście wartości zagnieżdżonej jest przekazywany jako argument do `Add` metodę, która pasuje do typów elementów.</span><span class="sxs-lookup"><span data-stu-id="35518-137">When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types.</span></span> <span data-ttu-id="35518-138">Na przykład, poniższy kod tworzy <xref:System.Collections.Generic.Dictionary%602> w którym klucze są typu `Integer` i wartości są typu `String`.</span><span class="sxs-lookup"><span data-stu-id="35518-138">For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`.</span></span> <span data-ttu-id="35518-139">Każdy z listy zagnieżdżone wartości jest dopasowywany do <xref:System.Collections.Generic.Dictionary%602.Add%2A> metodę `Dictionary`.</span><span class="sxs-lookup"><span data-stu-id="35518-139">Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`.</span></span>

[!code-vb[VbVbalrCollectionInitializers#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#5)]

<span data-ttu-id="35518-140">W poprzednim przykładzie kodu jest równoważny z następującym kodem.</span><span class="sxs-lookup"><span data-stu-id="35518-140">The previous code example is equivalent to the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#6)]

<span data-ttu-id="35518-141">Tylko wartości zagnieżdżonej listy z pierwszy poziom zagnieżdżenia są wysyłane do `Add` metody dla typu kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-141">Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type.</span></span> <span data-ttu-id="35518-142">Bardziej poziomów zagnieżdżenia, są traktowane jako literały tablicowe i list wartości zagnieżdżone nie są dopasowywane do `Add` metody żadnych kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-142">Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="35518-143">Tematy pokrewne</span><span class="sxs-lookup"><span data-stu-id="35518-143">Related Topics</span></span>

|<span data-ttu-id="35518-144">Tytuł</span><span class="sxs-lookup"><span data-stu-id="35518-144">Title</span></span>|<span data-ttu-id="35518-145">Opis</span><span class="sxs-lookup"><span data-stu-id="35518-145">Description</span></span>|
|---|---|
|[<span data-ttu-id="35518-146">Instrukcje: Utwórz Dodawanie metody rozszerzania wykorzystywanej przez inicjator kolekcji</span><span class="sxs-lookup"><span data-stu-id="35518-146">How to: Create an Add Extension Method Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)|<span data-ttu-id="35518-147">Pokazuje, jak utworzyć metodę rozszerzenia o nazwie `Add` można wypełnić kolekcję z wartościami z inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="35518-147">Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer.</span></span>|
|[<span data-ttu-id="35518-148">Instrukcje: Tworzenie kolekcji wykorzystywanej przez inicjator kolekcji</span><span class="sxs-lookup"><span data-stu-id="35518-148">How to: Create a Collection Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)|<span data-ttu-id="35518-149">Pokazuje, jak włączyć użycie inicjatora kolekcji, w tym `Add` metody w klasie kolekcji, która implementuje `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="35518-149">Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`.</span></span>|

## <a name="see-also"></a><span data-ttu-id="35518-150">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="35518-150">See also</span></span>

- [<span data-ttu-id="35518-151">Kolekcje</span><span class="sxs-lookup"><span data-stu-id="35518-151">Collections</span></span>](../../../../visual-basic/programming-guide/concepts/collections.md)
- [<span data-ttu-id="35518-152">Tablice</span><span class="sxs-lookup"><span data-stu-id="35518-152">Arrays</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/index.md)
- [<span data-ttu-id="35518-153">Inicjatory obiektów: Typy nazwane i anonimowe</span><span class="sxs-lookup"><span data-stu-id="35518-153">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="35518-154">New, operator</span><span class="sxs-lookup"><span data-stu-id="35518-154">New Operator</span></span>](../../../../visual-basic/language-reference/operators/new-operator.md)
- [<span data-ttu-id="35518-155">Właściwości zaimplementowane automatycznie</span><span class="sxs-lookup"><span data-stu-id="35518-155">Auto-Implemented Properties</span></span>](../../../../visual-basic/programming-guide/language-features/procedures/auto-implemented-properties.md)
- [<span data-ttu-id="35518-156">Instrukcje: Inicjowanie zmiennej tablicy w języku Visual Basic</span><span class="sxs-lookup"><span data-stu-id="35518-156">How to: Initialize an Array Variable in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)
- [<span data-ttu-id="35518-157">Wnioskowanie o typie lokalnym</span><span class="sxs-lookup"><span data-stu-id="35518-157">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)
- [<span data-ttu-id="35518-158">Typy anonimowe</span><span class="sxs-lookup"><span data-stu-id="35518-158">Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)
- [<span data-ttu-id="35518-159">Wprowadzenie do LINQ w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="35518-159">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)
- [<span data-ttu-id="35518-160">Instrukcje: Tworzenie listy elementów</span><span class="sxs-lookup"><span data-stu-id="35518-160">How to: Create a List of Items</span></span>](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)
