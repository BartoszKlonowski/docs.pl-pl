---
title: Inicjatory kolekcji
ms.date: 07/20/2015
f1_keywords:
- vb.CollectionInitializer
helpviewer_keywords:
- collection initializers [Visual Basic]
ms.assetid: a9290329-77b0-4fdf-ae75-8fc17287f469
ms.openlocfilehash: 1d2d5adc7266faaa1636e568d6433429761eeaab
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/04/2020
ms.locfileid: "84414546"
---
# <a name="collection-initializers-visual-basic"></a><span data-ttu-id="5fb8b-102">Inicjatory kolekcji (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5fb8b-102">Collection Initializers (Visual Basic)</span></span>

<span data-ttu-id="5fb8b-103">*Inicjatory kolekcji* zapewniają skróconą składnię, która umożliwia utworzenie kolekcji i wypełnienie jej początkowym zestawem wartości.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-103">*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values.</span></span> <span data-ttu-id="5fb8b-104">Inicjatory kolekcji są przydatne podczas tworzenia kolekcji na podstawie zestawu znanych wartości, na przykład listy opcji menu lub kategorii, początkowego zestawu wartości liczbowych, statycznej listy ciągów, takich jak nazwy dni lub miesięcy, lub lokalizacji geograficznych, takich jak lista stanów, która jest używana na potrzeby walidacji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-104">Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.</span></span>

<span data-ttu-id="5fb8b-105">Aby uzyskać więcej informacji na temat kolekcji, zobacz [kolekcje](../../concepts/collections.md).</span><span class="sxs-lookup"><span data-stu-id="5fb8b-105">For more information about collections, see [Collections](../../concepts/collections.md).</span></span>

<span data-ttu-id="5fb8b-106">Inicjator kolekcji można zidentyfikować za pomocą `From` słowa kluczowego, po którym następuje nawiasy klamrowe ( `{}` ).</span><span class="sxs-lookup"><span data-stu-id="5fb8b-106">You identify a collection initializer by using the `From` keyword followed by braces (`{}`).</span></span> <span data-ttu-id="5fb8b-107">Jest to podobne do składni literału tablicowego, która jest opisana w [tablicach](../arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="5fb8b-107">This is similar to the array literal syntax that is described in [Arrays](../arrays/index.md).</span></span> <span data-ttu-id="5fb8b-108">W poniższych przykładach przedstawiono różne sposoby używania inicjatorów kolekcji do tworzenia kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-108">The following examples show various ways to use collection initializers to create collections.</span></span>

[!code-vb[VbVbalrCollectionInitializers#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#1)]

> [!NOTE]
> <span data-ttu-id="5fb8b-109">Język C# zawiera również Inicjatory kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-109">C# also provides collection initializers.</span></span> <span data-ttu-id="5fb8b-110">Inicjatory kolekcji języka C# zapewniają te same funkcje co Visual Basic inicjatorów kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-110">C# collection initializers provide the same functionality as Visual Basic collection initializers.</span></span> <span data-ttu-id="5fb8b-111">Aby uzyskać więcej informacji na temat inicjatorów kolekcji C#, zobacz [Inicjatory obiektów i kolekcji](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span><span class="sxs-lookup"><span data-stu-id="5fb8b-111">For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span></span>

## <a name="syntax"></a><span data-ttu-id="5fb8b-112">Składnia</span><span class="sxs-lookup"><span data-stu-id="5fb8b-112">Syntax</span></span>

<span data-ttu-id="5fb8b-113">Inicjator kolekcji składa się z listy wartości rozdzielonych przecinkami, które są ujęte w nawiasy klamrowe ( `{}` ) poprzedzone `From` słowem kluczowym, jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-113">A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#2)]

<span data-ttu-id="5fb8b-114">Podczas tworzenia kolekcji, takiej jak <xref:System.Collections.Generic.List%601> lub <xref:System.Collections.Generic.Dictionary%602> , należy podać typ kolekcji przed inicjatorem kolekcji, jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-114">When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#13)]

> [!NOTE]
> <span data-ttu-id="5fb8b-115">Nie można połączyć inicjatora kolekcji i inicjatora obiektów w celu zainicjowania tego samego obiektu kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-115">You cannot combine both a collection initializer and an object initializer to initialize the same collection object.</span></span> <span data-ttu-id="5fb8b-116">Inicjatorów obiektów można użyć do zainicjowania obiektów w inicjatorze kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-116">You can use object initializers to initialize objects in a collection initializer.</span></span>

## <a name="creating-a-collection-by-using-a-collection-initializer"></a><span data-ttu-id="5fb8b-117">Tworzenie kolekcji przy użyciu inicjatora kolekcji</span><span class="sxs-lookup"><span data-stu-id="5fb8b-117">Creating a Collection by Using a Collection Initializer</span></span>

<span data-ttu-id="5fb8b-118">Podczas tworzenia kolekcji przy użyciu inicjatora kolekcji każda wartość podana w inicjatorze kolekcji jest przekazywana do odpowiedniej `Add` metody kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-118">When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection.</span></span> <span data-ttu-id="5fb8b-119">Na przykład, jeśli tworzysz <xref:System.Collections.Generic.List%601> przy użyciu inicjatora kolekcji, każda wartość ciągu w inicjatorze kolekcji jest przenoszona do <xref:System.Collections.Generic.List%601.Add%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-119">For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method.</span></span> <span data-ttu-id="5fb8b-120">Jeśli chcesz utworzyć kolekcję przy użyciu inicjatora kolekcji, określony typ musi być prawidłowym typem kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-120">If you want to create a collection by using a collection initializer, the specified type must be valid collection type.</span></span> <span data-ttu-id="5fb8b-121">Przykłady prawidłowych typów kolekcji obejmują klasy implementujące <xref:System.Collections.Generic.IEnumerable%601> interfejs lub dziedziczenia <xref:System.Collections.CollectionBase> klasy.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-121">Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class.</span></span> <span data-ttu-id="5fb8b-122">Określony typ musi również uwidaczniać `Add` metodę, która spełnia następujące kryteria.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-122">The specified type must also expose an `Add` method that meets the following criteria.</span></span>

- <span data-ttu-id="5fb8b-123">`Add`Metoda musi być dostępna z zakresu, w którym jest wywoływany inicjator kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-123">The `Add` method must be available from the scope in which the collection initializer is being called.</span></span> <span data-ttu-id="5fb8b-124">`Add`Metoda nie musi być publiczna, jeśli używasz inicjatora kolekcji w scenariuszu, w którym można uzyskać dostęp do niepublicznych metod kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-124">The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.</span></span>

- <span data-ttu-id="5fb8b-125">`Add`Metoda musi być elementem członkowskim wystąpienia lub `Shared` członkiem klasy kolekcji lub metodą rozszerzenia.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-125">The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method.</span></span>

- <span data-ttu-id="5fb8b-126">`Add`Musi istnieć Metoda, która może być dopasowana na podstawie reguł rozdzielczości przeciążenia, do typów, które są podane w inicjatorze kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-126">An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.</span></span>

 <span data-ttu-id="5fb8b-127">Poniższy przykład kodu pokazuje, jak utworzyć `List(Of Customer)` kolekcję przy użyciu inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-127">For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer.</span></span> <span data-ttu-id="5fb8b-128">Gdy kod jest uruchamiany, każdy `Customer` obiekt jest przesyłany do `Add(Customer)` metody listy ogólnej.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-128">When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list.</span></span>

[!code-vb[VbVbalrCollectionInitializers#9](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#9)]

<span data-ttu-id="5fb8b-129">Poniższy przykład kodu pokazuje równoważny kod, który nie używa inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-129">The following code example shows equivalent code that does not use a collection initializer.</span></span>

[!code-vb[VbVbalrCollectionInitializers#10](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#10)]

<span data-ttu-id="5fb8b-130">Jeśli kolekcja ma `Add` metodę, która ma parametry, które pasują do konstruktora `Customer` obiektu, można zagnieżdżać wartości parametrów dla `Add` metody w inicjatorach kolekcji, jak to opisano w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-130">If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section.</span></span> <span data-ttu-id="5fb8b-131">Jeśli kolekcja nie ma takiej `Add` metody, można ją utworzyć jako metodę rozszerzenia.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-131">If the collection does not have such an `Add` method, you can create one as an extension method.</span></span> <span data-ttu-id="5fb8b-132">Aby zapoznać się z przykładem sposobu tworzenia `Add` metody jako metody rozszerzenia dla kolekcji, zobacz [How to: Create a Add Extension Method, używany przez inicjator kolekcji](how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="5fb8b-132">For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span></span> <span data-ttu-id="5fb8b-133">Aby zapoznać się z przykładem tworzenia kolekcji niestandardowej, która może być używana z inicjatorem kolekcji, zobacz [How to: Create a Collection używany przez inicjator kolekcji](how-to-create-a-collection-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="5fb8b-133">For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](how-to-create-a-collection-used-by-a-collection-initializer.md).</span></span>

## <a name="nesting-collection-initializers"></a><span data-ttu-id="5fb8b-134">Zagnieżdżanie inicjatorów kolekcji</span><span class="sxs-lookup"><span data-stu-id="5fb8b-134">Nesting Collection Initializers</span></span>

<span data-ttu-id="5fb8b-135">Można zagnieżdżać wartości w inicjatorze kolekcji, aby identyfikować określone Przeciążenie `Add` metody dla tworzonej kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-135">You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created.</span></span> <span data-ttu-id="5fb8b-136">Wartości przesyłane do `Add` metody muszą być oddzielone przecinkami i ujęte w nawiasy klamrowe ( `{}` ), tak jak w przypadku literału tablicy lub inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-136">The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer.</span></span>

<span data-ttu-id="5fb8b-137">Podczas tworzenia kolekcji przy użyciu wartości zagnieżdżonych każdy element zagnieżdżonej listy wartości jest przenoszona jako argument do `Add` metody, która pasuje do typów elementów.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-137">When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types.</span></span> <span data-ttu-id="5fb8b-138">Poniższy przykład kodu tworzy na przykład, <xref:System.Collections.Generic.Dictionary%602> w którym klucze są typu `Integer` , a wartości są typu `String` .</span><span class="sxs-lookup"><span data-stu-id="5fb8b-138">For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`.</span></span> <span data-ttu-id="5fb8b-139">Każda z zagnieżdżonych list wartości jest dopasowywana do <xref:System.Collections.Generic.Dictionary%602.Add%2A> metody dla `Dictionary` .</span><span class="sxs-lookup"><span data-stu-id="5fb8b-139">Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`.</span></span>

[!code-vb[VbVbalrCollectionInitializers#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#5)]

<span data-ttu-id="5fb8b-140">Poprzedni przykład kodu jest równoważny do poniższego kodu.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-140">The previous code example is equivalent to the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#6)]

<span data-ttu-id="5fb8b-141">Tylko zagnieżdżone listy wartości z pierwszego poziomu zagnieżdżania są wysyłane do `Add` metody dla typu kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-141">Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type.</span></span> <span data-ttu-id="5fb8b-142">Dokładniejsze poziomy zagnieżdżania są traktowane jako literały tablicowe, a zagnieżdżone listy wartości nie są dopasowywane do `Add` metody żadnej kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-142">Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5fb8b-143">Tematy pokrewne</span><span class="sxs-lookup"><span data-stu-id="5fb8b-143">Related Topics</span></span>

|<span data-ttu-id="5fb8b-144">Tytuł</span><span class="sxs-lookup"><span data-stu-id="5fb8b-144">Title</span></span>|<span data-ttu-id="5fb8b-145">Opis</span><span class="sxs-lookup"><span data-stu-id="5fb8b-145">Description</span></span>|
|---|---|
|[<span data-ttu-id="5fb8b-146">Instrukcje: tworzenie i dodawanie metody rozszerzenia używanej przez inicjator kolekcji</span><span class="sxs-lookup"><span data-stu-id="5fb8b-146">How to: Create an Add Extension Method Used by a Collection Initializer</span></span>](how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)|<span data-ttu-id="5fb8b-147">Pokazuje, jak utworzyć metodę rozszerzenia o nazwie `Add` , która może być używana do wypełniania kolekcji wartościami z inicjatora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5fb8b-147">Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer.</span></span>|
|[<span data-ttu-id="5fb8b-148">Instrukcje: tworzenie kolekcji używanej przez inicjator kolekcji</span><span class="sxs-lookup"><span data-stu-id="5fb8b-148">How to: Create a Collection Used by a Collection Initializer</span></span>](how-to-create-a-collection-used-by-a-collection-initializer.md)|<span data-ttu-id="5fb8b-149">Pokazuje, jak włączyć użycie inicjatora kolekcji, dołączając `Add` metodę w klasie kolekcji implementującej `IEnumerable` .</span><span class="sxs-lookup"><span data-stu-id="5fb8b-149">Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`.</span></span>|

## <a name="see-also"></a><span data-ttu-id="5fb8b-150">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="5fb8b-150">See also</span></span>

- [<span data-ttu-id="5fb8b-151">Kolekcje</span><span class="sxs-lookup"><span data-stu-id="5fb8b-151">Collections</span></span>](../../concepts/collections.md)
- [<span data-ttu-id="5fb8b-152">Tablice</span><span class="sxs-lookup"><span data-stu-id="5fb8b-152">Arrays</span></span>](../arrays/index.md)
- [<span data-ttu-id="5fb8b-153">Inicjatory obiektów: typy nazwane i anonimowe</span><span class="sxs-lookup"><span data-stu-id="5fb8b-153">Object Initializers: Named and Anonymous Types</span></span>](../objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="5fb8b-154">Operator new</span><span class="sxs-lookup"><span data-stu-id="5fb8b-154">New Operator</span></span>](../../../language-reference/operators/new-operator.md)
- [<span data-ttu-id="5fb8b-155">Właściwości zaimplementowane automatycznie</span><span class="sxs-lookup"><span data-stu-id="5fb8b-155">Auto-Implemented Properties</span></span>](../procedures/auto-implemented-properties.md)
- [<span data-ttu-id="5fb8b-156">Porady: inicjowanie zmiennej tablicy w języku Visual Basic</span><span class="sxs-lookup"><span data-stu-id="5fb8b-156">How to: Initialize an Array Variable in Visual Basic</span></span>](../arrays/how-to-initialize-an-array-variable.md)
- [<span data-ttu-id="5fb8b-157">Wnioskowanie o typie lokalnym</span><span class="sxs-lookup"><span data-stu-id="5fb8b-157">Local Type Inference</span></span>](../variables/local-type-inference.md)
- [<span data-ttu-id="5fb8b-158">Typy anonimowe</span><span class="sxs-lookup"><span data-stu-id="5fb8b-158">Anonymous Types</span></span>](../objects-and-classes/anonymous-types.md)
- [<span data-ttu-id="5fb8b-159">Wprowadzenie do LINQ w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="5fb8b-159">Introduction to LINQ in Visual Basic</span></span>](../linq/introduction-to-linq.md)
- [<span data-ttu-id="5fb8b-160">Instrukcje: tworzenie listy elementów</span><span class="sxs-lookup"><span data-stu-id="5fb8b-160">How to: Create a List of Items</span></span>](../../concepts/linq/how-to-create-a-list-of-items.md)
