---
title: Pisanie pierwszego zapytania LINQ (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- queries [LINQ in Visual Basic], writing
- LINQ queries [Visual Basic]
- LINQ [Visual Basic], writing queries
ms.assetid: 4affb732-3e9b-4479-aa31-1f9bd8183cbe
ms.openlocfilehash: f426aac5358837563081d2bf9783f6d4fe04d853
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
---
# <a name="writing-your-first-linq-query-visual-basic"></a><span data-ttu-id="f992e-102">Pisanie pierwszego zapytania LINQ (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f992e-102">Writing Your First LINQ Query (Visual Basic)</span></span>
<span data-ttu-id="f992e-103">A *zapytania* jest wyrażenie, które pobiera dane ze źródła danych.</span><span class="sxs-lookup"><span data-stu-id="f992e-103">A *query* is an expression that retrieves data from a data source.</span></span> <span data-ttu-id="f992e-104">Zapytania są wyrażane w języku dedykowanych zapytania.</span><span class="sxs-lookup"><span data-stu-id="f992e-104">Queries are expressed in a dedicated query language.</span></span> <span data-ttu-id="f992e-105">Wraz z upływem czasu w różnych językach opracowano dla różnych typów źródeł danych, na przykład SQL relacyjnych baz danych i XQuery dla formatu XML.</span><span class="sxs-lookup"><span data-stu-id="f992e-105">Over time, different languages have been developed for different types of data sources, for example, SQL for relational databases and XQuery for XML.</span></span> <span data-ttu-id="f992e-106">Dzięki temu niezbędne dla deweloperów aplikacji dowiedzieć się nowy język kwerendy dla każdego typu źródła danych lub format danych, która jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="f992e-106">This makes it necessary for the application developer to learn a new query language for each type of data source or data format that is supported.</span></span>  
  
 [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]<span data-ttu-id="f992e-107"> upraszcza sytuację, oferując spójny model do pracy z danymi w różnych rodzajów źródeł danych i formaty.</span><span class="sxs-lookup"><span data-stu-id="f992e-107"> simplifies the situation by offering a consistent model for working with data across various kinds of data sources and formats.</span></span> <span data-ttu-id="f992e-108">W [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania, zawsze korzystasz z obiektów.</span><span class="sxs-lookup"><span data-stu-id="f992e-108">In a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query, you are always working with objects.</span></span> <span data-ttu-id="f992e-109">Użyj tego samego kodowania wzorców podstawowych zapytań, przekształcania danych w dokumentach XML, baz danych SQL, danych ADO.NET i jednostek, kolekcji .NET Framework i wszelkie inne źródła lub format, dla którego [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] dostawca jest niedostępny.</span><span class="sxs-lookup"><span data-stu-id="f992e-109">You use the same basic coding patterns to query and transform data in XML documents, SQL databases, ADO.NET datasets and entities, .NET Framework collections, and any other source or format for which a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider is available.</span></span> <span data-ttu-id="f992e-110">W tym dokumencie opisano trzy etapy tworzenia i stosowania basic [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania.</span><span class="sxs-lookup"><span data-stu-id="f992e-110">This document describes the three phases of the creation and use of basic [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries.</span></span>  
  
## <a name="three-stages-of-a-query-operation"></a><span data-ttu-id="f992e-111">Trzy etapy operacji zapytania</span><span class="sxs-lookup"><span data-stu-id="f992e-111">Three Stages of a Query Operation</span></span>  
 [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]<span data-ttu-id="f992e-112"> Operacje kwerend obejmują trzy czynności:</span><span class="sxs-lookup"><span data-stu-id="f992e-112"> query operations consist of three actions:</span></span>  
  
1.  <span data-ttu-id="f992e-113">Uzyskaj źródła danych lub źródła.</span><span class="sxs-lookup"><span data-stu-id="f992e-113">Obtain the data source or sources.</span></span>  
  
2.  <span data-ttu-id="f992e-114">Utwórz zapytanie.</span><span class="sxs-lookup"><span data-stu-id="f992e-114">Create the query.</span></span>  
  
3.  <span data-ttu-id="f992e-115">Wykonanie kwerendy.</span><span class="sxs-lookup"><span data-stu-id="f992e-115">Execute the query.</span></span>  
  
 <span data-ttu-id="f992e-116">W [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], wykonanie zapytania różni się od utworzenia zapytania.</span><span class="sxs-lookup"><span data-stu-id="f992e-116">In [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], the execution of a query is distinct from the creation of the query.</span></span> <span data-ttu-id="f992e-117">Nie pobrać żadnych danych przez utworzenie kwerendy.</span><span class="sxs-lookup"><span data-stu-id="f992e-117">You do not retrieve any data just by creating a query.</span></span> <span data-ttu-id="f992e-118">Ten punkt jest omówiona bardziej szczegółowo w dalszej części tego tematu.</span><span class="sxs-lookup"><span data-stu-id="f992e-118">This point is discussed in more detail later in this topic.</span></span>  
  
 <span data-ttu-id="f992e-119">Poniższy przykład przedstawia trzy części operacji zapytania.</span><span class="sxs-lookup"><span data-stu-id="f992e-119">The following example illustrates the three parts of a query operation.</span></span> <span data-ttu-id="f992e-120">W przykładzie użyto tablicy liczb całkowitych jako źródło danych wygodny dla celów demonstracyjnych.</span><span class="sxs-lookup"><span data-stu-id="f992e-120">The example uses an array of integers as a convenient data source for demonstration purposes.</span></span> <span data-ttu-id="f992e-121">Jednak te same pojęcia dotyczą również innych źródeł danych.</span><span class="sxs-lookup"><span data-stu-id="f992e-121">However, the same concepts also apply to other data sources.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f992e-122">Na [strona kompilowania, Projektant projektu (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic), upewnij się, że **Option infer** ustawiono **na**.</span><span class="sxs-lookup"><span data-stu-id="f992e-122">On the [Compile Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic), ensure that **Option infer** is set to **On**.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#1](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_1.vb)]  
  
 <span data-ttu-id="f992e-123">Dane wyjściowe:</span><span class="sxs-lookup"><span data-stu-id="f992e-123">Output:</span></span>  
  
 `0 2 4 6`  
  
## <a name="the-data-source"></a><span data-ttu-id="f992e-124">Źródło danych</span><span class="sxs-lookup"><span data-stu-id="f992e-124">The Data Source</span></span>  
 <span data-ttu-id="f992e-125">Ponieważ źródło danych w poprzednim przykładzie jest tablicą, niejawnie obsługuje ogólnego <xref:System.Collections.Generic.IEnumerable%601> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="f992e-125">Because the data source in the previous example is an array, it implicitly supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface.</span></span> <span data-ttu-id="f992e-126">Jest to z faktu, że pozwala na użycie tablicy jako źródło danych dla [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania.</span><span class="sxs-lookup"><span data-stu-id="f992e-126">It is this fact that enables you to use an array as a data source for a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query.</span></span> <span data-ttu-id="f992e-127">Typy obsługujące <xref:System.Collections.Generic.IEnumerable%601> lub interfejsu pochodnego, takich jak ogólnego <xref:System.Linq.IQueryable%601> są nazywane *typy zapytań*.</span><span class="sxs-lookup"><span data-stu-id="f992e-127">Types that support <xref:System.Collections.Generic.IEnumerable%601> or a derived interface such as the generic <xref:System.Linq.IQueryable%601> are called *queryable types*.</span></span>  
  
 <span data-ttu-id="f992e-128">W ustawieniu typu niejawnie kolejność tablicy nie musi podawać modyfikacji i szczególnego traktowania jako [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] źródła danych.</span><span class="sxs-lookup"><span data-stu-id="f992e-128">As an implicitly queryable type, the array requires no modification or special treatment to serve as a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] data source.</span></span> <span data-ttu-id="f992e-129">To samo dotyczy dowolnego typu kolekcji, która obsługuje <xref:System.Collections.Generic.IEnumerable%601>, łącznie z ogólnego <xref:System.Collections.Generic.List%601>, <xref:System.Collections.Generic.Dictionary%602>i inne klasy w bibliotece klas programu .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f992e-129">The same is true for any collection type that supports <xref:System.Collections.Generic.IEnumerable%601>, including the generic <xref:System.Collections.Generic.List%601>, <xref:System.Collections.Generic.Dictionary%602>, and other classes in the .NET Framework class library.</span></span>  
  
 <span data-ttu-id="f992e-130">Jeśli źródło danych nie obsługuje już <xref:System.Collections.Generic.IEnumerable%601>, [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] dostawcy jest wymagane w celu wdrożenia funkcji *standardowych operatorów zapytań* dla tego źródła danych.</span><span class="sxs-lookup"><span data-stu-id="f992e-130">If the source data does not already implement <xref:System.Collections.Generic.IEnumerable%601>, a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider is needed to implement the functionality of the *standard query operators* for that data source.</span></span> <span data-ttu-id="f992e-131">Na przykład [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] obsługuje ładowania dokumentu XML do kolejność pracy <xref:System.Xml.Linq.XElement> typ, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="f992e-131">For example, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] handles the work of loading an XML document into a queryable <xref:System.Xml.Linq.XElement> type, as shown in the following example.</span></span> <span data-ttu-id="f992e-132">Aby uzyskać więcej informacji dotyczących standardowych operatorów zapytań, zobacz [standardowe operatory zapytań — omówienie (Visual Basic)](standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f992e-132">For more information about standard query operators, see [Standard Query Operators Overview (Visual Basic)](standard-query-operators-overview.md).</span></span>  
  
 [!code-vb[VbLINQFirstQuery#2](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_2.vb)]  
  
 <span data-ttu-id="f992e-133">Z [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], należy najpierw utworzyć obiektów relacyjnych mapowanie w czasie projektowania, ręcznie lub za pomocą [składnika LINQ to SQL narzędzia w programie Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2) w programie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f992e-133">With [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], you first create an object-relational mapping at design time, either manually or by using the [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2) in Visual Studio.</span></span> <span data-ttu-id="f992e-134">Pisanie zapytań względem obiektów oraz w czasie wykonywania [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] obsługuje komunikację z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="f992e-134">You write your queries against the objects, and at run-time [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] handles the communication with the database.</span></span> <span data-ttu-id="f992e-135">W poniższym przykładzie `customers` reprezentuje określonej tabeli w bazie danych i <xref:System.Data.Linq.Table%601> ogólny obsługuje <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="f992e-135">In the following example, `customers` represents a specific table in the database, and <xref:System.Data.Linq.Table%601> supports generic <xref:System.Linq.IQueryable%601>.</span></span>  
  
```vb  
' Create a data source from a SQL table.  
Dim db As New DataContext("C:\Northwind\Northwnd.mdf")  
Dim customers As Table(Of Customer) = db.GetTable(Of Customer)  
```  
  
 <span data-ttu-id="f992e-136">Aby uzyskać więcej informacji o sposobie tworzenia określonych typów źródeł danych, zobacz dokumentację dla różnych [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] dostawców.</span><span class="sxs-lookup"><span data-stu-id="f992e-136">For more information about how to create specific types of data sources, see the documentation for the various [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] providers.</span></span> <span data-ttu-id="f992e-137">(Aby uzyskać listę tych dostawców, zobacz [LINQ (zapytania język Language-Integrated)](http://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d).) Podstawowe reguły jest prosty: [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] źródło danych jest dowolny obiekt, który obsługuje ogólnego <xref:System.Collections.Generic.IEnumerable%601> interfejsu lub interfejsu, który dziedziczy z niego.</span><span class="sxs-lookup"><span data-stu-id="f992e-137">(For a list of these providers, see [LINQ (Language-Integrated Query)](http://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d).) The basic rule is simple: a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] data source is any object that supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface, or an interface that inherits from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f992e-138">Typy, takich jak <xref:System.Collections.ArrayList> inny niż ogólny, który obsługuje <xref:System.Collections.IEnumerable> interfejs może również służyć jako [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] źródeł danych.</span><span class="sxs-lookup"><span data-stu-id="f992e-138">Types such as <xref:System.Collections.ArrayList> that support the non-generic <xref:System.Collections.IEnumerable> interface can also be used as [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] data sources.</span></span> <span data-ttu-id="f992e-139">Na przykład, który używa <xref:System.Collections.ArrayList>, zobacz [porady: zapytanie w ArrayList za pomocą LINQ (Visual Basic)](how-to-query-an-arraylist-with-linq.md).</span><span class="sxs-lookup"><span data-stu-id="f992e-139">For an example that uses an <xref:System.Collections.ArrayList>, see [How to: Query an ArrayList with LINQ (Visual Basic)](how-to-query-an-arraylist-with-linq.md).</span></span>  
  
## <a name="the-query"></a><span data-ttu-id="f992e-140">Zapytanie</span><span class="sxs-lookup"><span data-stu-id="f992e-140">The Query</span></span>  
 <span data-ttu-id="f992e-141">W zapytaniu należy określić informacji, które mają zostać pobrane ze źródła danych lub źródła.</span><span class="sxs-lookup"><span data-stu-id="f992e-141">In the query, you specify what information you want to retrieve from the data source or sources.</span></span> <span data-ttu-id="f992e-142">Istnieje również możliwość określania, jak te informacje powinny być sortowane, pogrupowane lub strukturę przed zwróceniem jest.</span><span class="sxs-lookup"><span data-stu-id="f992e-142">You also have the option of specifying how that information should be sorted, grouped, or structured before it is returned.</span></span> <span data-ttu-id="f992e-143">Aby włączyć tworzenie zapytań, Visual Basic ma włączyć nowej składni zapytania do języka.</span><span class="sxs-lookup"><span data-stu-id="f992e-143">To enable query creation, Visual Basic has incorporated new query syntax into the language.</span></span>  
  
 <span data-ttu-id="f992e-144">Po wykonaniu, zapytanie w poniższym przykładzie zwraca wszystkie liczby parzyste z tablicy całkowitą `numbers`.</span><span class="sxs-lookup"><span data-stu-id="f992e-144">When it is executed, the query in the following example returns all the even numbers from an integer array, `numbers`.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#1](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_1.vb)]  
  
 <span data-ttu-id="f992e-145">Wyrażenia zapytania zawiera trzy klauzule: `From`, `Where`, i `Select`.</span><span class="sxs-lookup"><span data-stu-id="f992e-145">The query expression contains three clauses: `From`, `Where`, and `Select`.</span></span> <span data-ttu-id="f992e-146">Omówione w określonych funkcji i celów poszczególnych klauzuli wyrażenia zapytania [podstawowe operacje zapytań (Visual Basic)](basic-query-operations.md).</span><span class="sxs-lookup"><span data-stu-id="f992e-146">The specific function and purpose of each query expression clause is discussed in [Basic Query Operations (Visual Basic)](basic-query-operations.md).</span></span> <span data-ttu-id="f992e-147">Aby uzyskać więcej informacji, zobacz [zapytania](../../../../visual-basic/language-reference/queries/queries.md).</span><span class="sxs-lookup"><span data-stu-id="f992e-147">For more information, see [Queries](../../../../visual-basic/language-reference/queries/queries.md).</span></span> <span data-ttu-id="f992e-148">Należy pamiętać, że w [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], definicji zapytania często jest przechowywana w zmiennej i wykonać później.</span><span class="sxs-lookup"><span data-stu-id="f992e-148">Note that in [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], a query definition often is stored in a variable and executed later.</span></span> <span data-ttu-id="f992e-149">Zapytanie zmiennych, takich jak `evensQuery` w poprzednim przykładzie, musi być typem zapytań.</span><span class="sxs-lookup"><span data-stu-id="f992e-149">The query variable, such as `evensQuery` in the previous example, must be a queryable type.</span></span> <span data-ttu-id="f992e-150">Typ `evensQuery` jest `IEnumerable(Of Integer)`, przypisane przez kompilator przy użyciu wnioskowanie o typie lokalnym.</span><span class="sxs-lookup"><span data-stu-id="f992e-150">The type of `evensQuery` is `IEnumerable(Of Integer)`, assigned by the compiler using local type inference.</span></span>  
  
 <span data-ttu-id="f992e-151">Należy pamiętać, że samej zmiennej zapytanie Brak działania i zwraca żadnych danych.</span><span class="sxs-lookup"><span data-stu-id="f992e-151">It is important to remember that the query variable itself takes no action and returns no data.</span></span> <span data-ttu-id="f992e-152">Definicja zapytania jest przechowywana tylko.</span><span class="sxs-lookup"><span data-stu-id="f992e-152">It only stores the query definition.</span></span> <span data-ttu-id="f992e-153">W poprzednim przykładzie jest `For Each` pętli wykonujący zapytanie.</span><span class="sxs-lookup"><span data-stu-id="f992e-153">In the previous example, it is the `For Each` loop that executes the query.</span></span>  
  
## <a name="query-execution"></a><span data-ttu-id="f992e-154">Wykonywanie zapytania</span><span class="sxs-lookup"><span data-stu-id="f992e-154">Query Execution</span></span>  
 <span data-ttu-id="f992e-155">Wykonywanie zapytania jest oddzielony od tworzenia zapytania.</span><span class="sxs-lookup"><span data-stu-id="f992e-155">Query execution is separate from query creation.</span></span> <span data-ttu-id="f992e-156">Tworzenie zapytań definiuje kwerendy, ale wykonanie jest wyzwalane przez inny mechanizm.</span><span class="sxs-lookup"><span data-stu-id="f992e-156">Query creation defines the query, but execution is triggered by a different mechanism.</span></span> <span data-ttu-id="f992e-157">Można było wykonać zapytanie, jak jest zdefiniowany (*natychmiastowego wykonania*), lub definicji mogą być przechowywane i można było wykonać zapytanie później (*odroczonego wykonania*).</span><span class="sxs-lookup"><span data-stu-id="f992e-157">A query can be executed as soon as it is defined (*immediate execution*), or the definition can be stored and the query can be executed later (*deferred execution*).</span></span>  
  
### <a name="deferred-execution"></a><span data-ttu-id="f992e-158">Wykonanie odroczone</span><span class="sxs-lookup"><span data-stu-id="f992e-158">Deferred Execution</span></span>  
 <span data-ttu-id="f992e-159">Typowe [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania opisany w poprzednim przykładzie, w którym `evensQuery` jest zdefiniowany.</span><span class="sxs-lookup"><span data-stu-id="f992e-159">A typical [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query resembles the one in the previous example, in which `evensQuery` is defined.</span></span> <span data-ttu-id="f992e-160">Tworzy zapytanie, ale nie wykonuje on natychmiast.</span><span class="sxs-lookup"><span data-stu-id="f992e-160">It creates the query but does not execute it immediately.</span></span> <span data-ttu-id="f992e-161">Zamiast tego definicja zapytania jest przechowywana w zmiennej zapytania `evensQuery`.</span><span class="sxs-lookup"><span data-stu-id="f992e-161">Instead, the query definition is stored in the query variable `evensQuery`.</span></span> <span data-ttu-id="f992e-162">Wykonanie kwerendy później, zwykle za pomocą `For Each` pętli, która zwraca sekwencję wartości lub przez zastosowanie operatora zapytania standardowe, takie jak `Count` lub `Max`.</span><span class="sxs-lookup"><span data-stu-id="f992e-162">You execute the query later, typically by using a `For Each` loop, which returns a sequence of values, or by applying a standard query operator, such as `Count` or `Max`.</span></span> <span data-ttu-id="f992e-163">Ten proces jest nazywany *odroczonego wykonania*.</span><span class="sxs-lookup"><span data-stu-id="f992e-163">This process is referred to as *deferred execution*.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#7](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_3.vb)]  
  
 <span data-ttu-id="f992e-164">Sekwencji wartości dostępu pobrane dane przy użyciu zmiennej iteracji w `For Each` pętli (`number` w poprzednim przykładzie).</span><span class="sxs-lookup"><span data-stu-id="f992e-164">For a sequence of values, you access the retrieved data by using the iteration variable in the `For Each` loop (`number` in the previous example).</span></span> <span data-ttu-id="f992e-165">Ponieważ zmienną zapytania `evensQuery`, posiada definicji zapytania, zamiast wyniki zapytania można wykonać zapytania tyle razy, ile przy użyciu zmiennej zapytania więcej niż jeden raz.</span><span class="sxs-lookup"><span data-stu-id="f992e-165">Because the query variable, `evensQuery`, holds the query definition rather than the query results, you can execute a query as often as you want by using the query variable more than one time.</span></span> <span data-ttu-id="f992e-166">Na przykład może być bazy danych w aplikacji, która jest aktualizowana stale w innej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f992e-166">For example, you might have a database in your application that is being updated continually by a separate application.</span></span> <span data-ttu-id="f992e-167">Po utworzeniu kwerendę, która pobiera dane z bazy danych, można użyć `For Each` pętli do wykonania zapytania, pobieranie najnowszych danych zawsze.</span><span class="sxs-lookup"><span data-stu-id="f992e-167">After you have created a query that retrieves data from that database, you can use a `For Each` loop to execute the query repeatedly, retrieving the most recent data every time.</span></span>  
  
 <span data-ttu-id="f992e-168">W poniższym przykładzie pokazano sposób odroczonego wykonania działania.</span><span class="sxs-lookup"><span data-stu-id="f992e-168">The following example demonstrates how deferred execution works.</span></span> <span data-ttu-id="f992e-169">Po `evensQuery2` został zdefiniowany i jest wykonywane z `For Each` pętli, jak w poprzednich przykładach, niektóre elementy w źródle danych `numbers` są zmieniane.</span><span class="sxs-lookup"><span data-stu-id="f992e-169">After `evensQuery2` is defined and executed with a `For Each` loop, as in the previous examples, some elements in the data source `numbers` are changed.</span></span> <span data-ttu-id="f992e-170">Następnie drugiej `For Each` pętli działa `evensQuery2` ponownie.</span><span class="sxs-lookup"><span data-stu-id="f992e-170">Then a second `For Each` loop runs `evensQuery2` again.</span></span> <span data-ttu-id="f992e-171">Wyniki są różne po raz drugi, ponieważ `For Each` pętla jest wykonywana zapytanie ponownie, używając nowej wartości w `numbers`.</span><span class="sxs-lookup"><span data-stu-id="f992e-171">The results are different the second time, because the `For Each` loop executes the query again, using the new values in `numbers`.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#3](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_4.vb)]  
  
 <span data-ttu-id="f992e-172">Dane wyjściowe:</span><span class="sxs-lookup"><span data-stu-id="f992e-172">Output:</span></span>  
  
 `Evens in original array:`  
  
 `0  2  4  6`  
  
 `Evens in changed array:`  
  
 `0  10  2  22  8`  
  
### <a name="immediate-execution"></a><span data-ttu-id="f992e-173">Natychmiastowe wykonanie</span><span class="sxs-lookup"><span data-stu-id="f992e-173">Immediate Execution</span></span>  
 <span data-ttu-id="f992e-174">Odroczone podczas wykonywania zapytań definicja zapytania jest przechowywana w zmiennej zapytanie później.</span><span class="sxs-lookup"><span data-stu-id="f992e-174">In deferred execution of queries, the query definition is stored in a query variable for later execution.</span></span> <span data-ttu-id="f992e-175">Podczas wykonywania bezpośredniego zapytanie jest wykonywane w czasie jego definicji.</span><span class="sxs-lookup"><span data-stu-id="f992e-175">In immediate execution, the query is executed at the time of its definition.</span></span> <span data-ttu-id="f992e-176">Wykonanie jest wyzwalane po zastosowaniu metody, która wymaga dostępu do poszczególnych elementów w wyniku zapytania.</span><span class="sxs-lookup"><span data-stu-id="f992e-176">Execution is triggered when you apply a method that requires access to individual elements of the query result.</span></span> <span data-ttu-id="f992e-177">Często natychmiastowego wykonania wymusza przy użyciu jednej z standardowych operatorów zapytań zwracających jednej wartości.</span><span class="sxs-lookup"><span data-stu-id="f992e-177">Immediate execution often is forced by using one of the standard query operators that return single values.</span></span> <span data-ttu-id="f992e-178">Przykłady `Count`, `Max`, `Average`, i `First`.</span><span class="sxs-lookup"><span data-stu-id="f992e-178">Examples are `Count`, `Max`, `Average`, and `First`.</span></span> <span data-ttu-id="f992e-179">Te standardowe operatory zapytań wykonać zapytanie, jak są one stosowane w celu obliczania i zwracają wynik singleton.</span><span class="sxs-lookup"><span data-stu-id="f992e-179">These standard query operators execute the query as soon as they are applied in order to calculate and return a singleton result.</span></span> <span data-ttu-id="f992e-180">Aby uzyskać więcej informacji o standardowych operatorów zapytań zwracających wartości jeden, zobacz [operacje agregacji](aggregation-operations.md), [operacje na elementach](element-operations.md), i [Operacje kwantyfikatora](quantifier-operations.md).</span><span class="sxs-lookup"><span data-stu-id="f992e-180">For more information about standard query operators that return single values, see [Aggregation Operations](aggregation-operations.md), [Element Operations](element-operations.md), and [Quantifier Operations](quantifier-operations.md).</span></span>  
  
 <span data-ttu-id="f992e-181">Następujące zapytanie zwraca liczbę liczby parzyste w tablicy liczb całkowitych.</span><span class="sxs-lookup"><span data-stu-id="f992e-181">The following query returns a count of the even numbers in an array of integers.</span></span> <span data-ttu-id="f992e-182">Definicja zapytania nie zostanie zapisana, i `numEvens` jest prostą `Integer`.</span><span class="sxs-lookup"><span data-stu-id="f992e-182">The query definition is not saved, and `numEvens` is a simple `Integer`.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#4](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_5.vb)]  
  
 <span data-ttu-id="f992e-183">Taki sam efekt można osiągnąć za pomocą `Aggregate` metody.</span><span class="sxs-lookup"><span data-stu-id="f992e-183">You can achieve the same result by using the `Aggregate` method.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#5](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_6.vb)]  
  
 <span data-ttu-id="f992e-184">Możesz też wymusić wykonanie kwerendy, wywołując `ToList` lub `ToArray` metoda zapytania (natychmiastowa) lub zmienną zapytania (odroczona), jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="f992e-184">You can also force execution of a query by calling the `ToList` or `ToArray` method on a query (immediate) or query variable (deferred), as shown in the following code.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#6](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_7.vb)]  
  
 <span data-ttu-id="f992e-185">W poprzednich przykładach `evensQuery3` jest zapytaniem zmiennej, ale `evensList` jest listą i `evensArray` jest tablicą.</span><span class="sxs-lookup"><span data-stu-id="f992e-185">In the previous examples, `evensQuery3` is a query variable, but `evensList` is a list and `evensArray` is an array.</span></span>  
  
 <span data-ttu-id="f992e-186">Przy użyciu `ToList` lub `ToArray` Aby wymusić natychmiastowe wykonanie jest szczególnie przydatne w scenariuszach, w których chcesz natychmiast wykonać zapytania i pamięci podręcznej wyniki w obiekcie jednej kolekcji.</span><span class="sxs-lookup"><span data-stu-id="f992e-186">Using `ToList` or `ToArray` to force immediate execution is especially useful in scenarios in which you want to execute the query immediately and cache the results in a single collection object.</span></span> <span data-ttu-id="f992e-187">Aby uzyskać więcej informacji na temat tych metod, zobacz [konwertowanie typów danych](converting-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="f992e-187">For more information about these methods, see [Converting Data Types](converting-data-types.md).</span></span>  
  
 <span data-ttu-id="f992e-188">Może również spowodować kwerendzie wykonywanej przy użyciu `IEnumerable` metody, takie jak <xref:Microsoft.VisualBasic.Collection.System%23Collections%23IEnumerable%23GetEnumerator%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="f992e-188">You can also cause a query to be executed by using an `IEnumerable` method such as the <xref:Microsoft.VisualBasic.Collection.System%23Collections%23IEnumerable%23GetEnumerator%2A> method.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f992e-189">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="f992e-189">See Also</span></span>  
 [<span data-ttu-id="f992e-190">Wprowadzenie do korzystania z LINQ w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="f992e-190">Getting Started with LINQ in Visual Basic</span></span>](getting-started-with-linq.md)  
 [<span data-ttu-id="f992e-191">Wnioskowanie o typie lokalnym</span><span class="sxs-lookup"><span data-stu-id="f992e-191">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)  
 [<span data-ttu-id="f992e-192">Operatory standardowe zapytań — omówienie (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f992e-192">Standard Query Operators Overview (Visual Basic)</span></span>](standard-query-operators-overview.md)  
 [<span data-ttu-id="f992e-193">Wprowadzenie do LINQ w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="f992e-193">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)  
 [<span data-ttu-id="f992e-194">LINQ</span><span class="sxs-lookup"><span data-stu-id="f992e-194">LINQ</span></span>](../../../../visual-basic/programming-guide/language-features/linq/index.md)  
 [<span data-ttu-id="f992e-195">Zapytania</span><span class="sxs-lookup"><span data-stu-id="f992e-195">Queries</span></span>](../../../../visual-basic/language-reference/queries/queries.md)
