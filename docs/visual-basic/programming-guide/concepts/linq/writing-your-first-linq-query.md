---
title: Pisanie pierwszego zapytania LINQ (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- queries [LINQ in Visual Basic], writing
- LINQ queries [Visual Basic]
- LINQ [Visual Basic], writing queries
ms.assetid: 4affb732-3e9b-4479-aa31-1f9bd8183cbe
ms.openlocfilehash: 83a1b7629672c6a74fd29ce698a6b8e6e152b1da
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/01/2018
ms.locfileid: "43387637"
---
# <a name="writing-your-first-linq-query-visual-basic"></a><span data-ttu-id="f1791-102">Pisanie pierwszego zapytania LINQ (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f1791-102">Writing Your First LINQ Query (Visual Basic)</span></span>
<span data-ttu-id="f1791-103">A *zapytania* jest wyrażeniem, które pobiera dane ze źródła danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-103">A *query* is an expression that retrieves data from a data source.</span></span> <span data-ttu-id="f1791-104">Zapytania są wyrażone w język kwerendy dedykowanych.</span><span class="sxs-lookup"><span data-stu-id="f1791-104">Queries are expressed in a dedicated query language.</span></span> <span data-ttu-id="f1791-105">Wraz z upływem czasu różnych języków zostały opracowane dla różnych typów źródeł danych, na przykład SQL dla relacyjnych baz danych i XQuery dla XML.</span><span class="sxs-lookup"><span data-stu-id="f1791-105">Over time, different languages have been developed for different types of data sources, for example, SQL for relational databases and XQuery for XML.</span></span> <span data-ttu-id="f1791-106">Dzięki temu niezbędne dla deweloperów aplikacji dowiedzieć się nowego języka zapytań dla każdego typu źródła danych lub formatu danych, która jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="f1791-106">This makes it necessary for the application developer to learn a new query language for each type of data source or data format that is supported.</span></span>  
  
 [!INCLUDE[vbteclinqext](~/includes/vbteclinqext-md.md)]<span data-ttu-id="f1791-107"> upraszcza tę sytuację oferując spójny model do pracy z danymi w różnych rodzajach formatów i źródeł danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-107"> simplifies the situation by offering a consistent model for working with data across various kinds of data sources and formats.</span></span> <span data-ttu-id="f1791-108">W [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania, zawsze pracujesz z obiektami.</span><span class="sxs-lookup"><span data-stu-id="f1791-108">In a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query, you are always working with objects.</span></span> <span data-ttu-id="f1791-109">Używasz tych samych podstawowych schematów kodowania do wykonywania zapytań i przekształcania danych w dokumentach XML, baz danych SQL, zestawami danych ADO.NET i jednostek, kolekcjami .NET Framework i inne źródła lub format, dla którego [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] dostawca jest niedostępny.</span><span class="sxs-lookup"><span data-stu-id="f1791-109">You use the same basic coding patterns to query and transform data in XML documents, SQL databases, ADO.NET datasets and entities, .NET Framework collections, and any other source or format for which a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider is available.</span></span> <span data-ttu-id="f1791-110">W tym dokumencie opisano trzy etapy tworzenia i używania basic [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania.</span><span class="sxs-lookup"><span data-stu-id="f1791-110">This document describes the three phases of the creation and use of basic [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries.</span></span>  
  
## <a name="three-stages-of-a-query-operation"></a><span data-ttu-id="f1791-111">Trzy etapy operacji zapytania</span><span class="sxs-lookup"><span data-stu-id="f1791-111">Three Stages of a Query Operation</span></span>  
 [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]<span data-ttu-id="f1791-112"> operacje zapytań obejmują trzy czynności:</span><span class="sxs-lookup"><span data-stu-id="f1791-112"> query operations consist of three actions:</span></span>  
  
1.  <span data-ttu-id="f1791-113">Uzyskaj lub źródeł danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-113">Obtain the data source or sources.</span></span>  
  
2.  <span data-ttu-id="f1791-114">Utwórz zapytanie.</span><span class="sxs-lookup"><span data-stu-id="f1791-114">Create the query.</span></span>  
  
3.  <span data-ttu-id="f1791-115">Wykonaj zapytanie.</span><span class="sxs-lookup"><span data-stu-id="f1791-115">Execute the query.</span></span>  
  
 <span data-ttu-id="f1791-116">W [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], wykonywanie kwerendy różni się od tworzenia kwerendy.</span><span class="sxs-lookup"><span data-stu-id="f1791-116">In [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], the execution of a query is distinct from the creation of the query.</span></span> <span data-ttu-id="f1791-117">Nie pobrać żadnych danych, po prostu tworząc zapytanie.</span><span class="sxs-lookup"><span data-stu-id="f1791-117">You do not retrieve any data just by creating a query.</span></span> <span data-ttu-id="f1791-118">Ten punkt jest omówiona bardziej szczegółowo w dalszej części tego tematu.</span><span class="sxs-lookup"><span data-stu-id="f1791-118">This point is discussed in more detail later in this topic.</span></span>  
  
 <span data-ttu-id="f1791-119">Poniższy przykład ilustruje te trzy części operacji zapytania.</span><span class="sxs-lookup"><span data-stu-id="f1791-119">The following example illustrates the three parts of a query operation.</span></span> <span data-ttu-id="f1791-120">W przykładzie użyto tablicy liczb całkowitych jako źródła danych w dogodnym dla celów demonstracyjnych.</span><span class="sxs-lookup"><span data-stu-id="f1791-120">The example uses an array of integers as a convenient data source for demonstration purposes.</span></span> <span data-ttu-id="f1791-121">Jednak te same pojęcia mają zastosowanie również do innych źródeł danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-121">However, the same concepts also apply to other data sources.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f1791-122">Na [strona kompilowania, Projektant projektu (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic), upewnij się, że **Option infer** ustawiono **na**.</span><span class="sxs-lookup"><span data-stu-id="f1791-122">On the [Compile Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/compile-page-project-designer-visual-basic), ensure that **Option infer** is set to **On**.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#1](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_1.vb)]  
  
 <span data-ttu-id="f1791-123">Dane wyjściowe:</span><span class="sxs-lookup"><span data-stu-id="f1791-123">Output:</span></span>  
  
 `0 2 4 6`  
  
## <a name="the-data-source"></a><span data-ttu-id="f1791-124">Źródło danych</span><span class="sxs-lookup"><span data-stu-id="f1791-124">The Data Source</span></span>  
 <span data-ttu-id="f1791-125">Ponieważ źródło danych w poprzednim przykładzie jest tablicą, niejawnie obsługuje ogólny <xref:System.Collections.Generic.IEnumerable%601> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="f1791-125">Because the data source in the previous example is an array, it implicitly supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface.</span></span> <span data-ttu-id="f1791-126">Jest to fakt, że pozwala na użycie tablicy jako źródło danych dla [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania.</span><span class="sxs-lookup"><span data-stu-id="f1791-126">It is this fact that enables you to use an array as a data source for a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query.</span></span> <span data-ttu-id="f1791-127">Typy obsługujące <xref:System.Collections.Generic.IEnumerable%601> lub interfejs pochodny, takie jak typowa <xref:System.Linq.IQueryable%601> są nazywane *typami odpytywalnymi*.</span><span class="sxs-lookup"><span data-stu-id="f1791-127">Types that support <xref:System.Collections.Generic.IEnumerable%601> or a derived interface such as the generic <xref:System.Linq.IQueryable%601> are called *queryable types*.</span></span>  
  
 <span data-ttu-id="f1791-128">Jako typ odpytywalny niejawnie tablicy nie wymaga modyfikacji ani specjalnego traktowania, aby pełnić rolę [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] źródła danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-128">As an implicitly queryable type, the array requires no modification or special treatment to serve as a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] data source.</span></span> <span data-ttu-id="f1791-129">To samo dotyczy dowolnego typu kolekcji, która obsługuje <xref:System.Collections.Generic.IEnumerable%601>, łącznie z ogólnego <xref:System.Collections.Generic.List%601>, <xref:System.Collections.Generic.Dictionary%602>i innych klas w bibliotece klas programu .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f1791-129">The same is true for any collection type that supports <xref:System.Collections.Generic.IEnumerable%601>, including the generic <xref:System.Collections.Generic.List%601>, <xref:System.Collections.Generic.Dictionary%602>, and other classes in the .NET Framework class library.</span></span>  
  
 <span data-ttu-id="f1791-130">Jeśli źródło danych nie obsługuje już <xref:System.Collections.Generic.IEnumerable%601>, [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] dostawcy jest potrzebne do zaimplementowania funkcji *standardowych operatorów zapytań* dla tego źródła danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-130">If the source data does not already implement <xref:System.Collections.Generic.IEnumerable%601>, a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] provider is needed to implement the functionality of the *standard query operators* for that data source.</span></span> <span data-ttu-id="f1791-131">Na przykład [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] obsługuje pracę podczas ładowania dokumentu XML do odpytywalnego <xref:System.Xml.Linq.XElement> typ, jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="f1791-131">For example, [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)] handles the work of loading an XML document into a queryable <xref:System.Xml.Linq.XElement> type, as shown in the following example.</span></span> <span data-ttu-id="f1791-132">Aby uzyskać więcej informacji na temat standardowych operatorów zapytań, zobacz [standardowe operatory zapytań — Przegląd (Visual Basic)](standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f1791-132">For more information about standard query operators, see [Standard Query Operators Overview (Visual Basic)](standard-query-operators-overview.md).</span></span>  
  
 [!code-vb[VbLINQFirstQuery#2](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_2.vb)]  
  
 <span data-ttu-id="f1791-133">Za pomocą [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], należy najpierw utworzyć obiektowo relacyjny mapowanie w czasie projektowania, ręcznie lub za pomocą [LINQ to SQL Tools w programie Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2) w programie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f1791-133">With [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], you first create an object-relational mapping at design time, either manually or by using the [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2) in Visual Studio.</span></span> <span data-ttu-id="f1791-134">Piszesz zapytania dotyczące obiektów, a także w czasie wykonywania [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] obsługuje komunikację z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-134">You write your queries against the objects, and at run-time [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] handles the communication with the database.</span></span> <span data-ttu-id="f1791-135">W poniższym przykładzie `customers` reprezentuje określoną tabelę w bazie danych i <xref:System.Data.Linq.Table%601> obsługuje ogólny <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="f1791-135">In the following example, `customers` represents a specific table in the database, and <xref:System.Data.Linq.Table%601> supports generic <xref:System.Linq.IQueryable%601>.</span></span>  
  
```vb  
' Create a data source from a SQL table.  
Dim db As New DataContext("C:\Northwind\Northwnd.mdf")  
Dim customers As Table(Of Customer) = db.GetTable(Of Customer)  
```  
  
 <span data-ttu-id="f1791-136">Aby uzyskać więcej informacji na temat sposobu tworzenia określonych typów źródeł danych, zobacz dokumentację dla różnych [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] dostawców.</span><span class="sxs-lookup"><span data-stu-id="f1791-136">For more information about how to create specific types of data sources, see the documentation for the various [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] providers.</span></span> <span data-ttu-id="f1791-137">(Aby uzyskać listę tych dostawców, zobacz [LINQ (Language-Integrated Query)](https://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d).) Podstawowa zasada jest proste: [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] źródło danych jest dowolny obiekt obsługujący ogólny <xref:System.Collections.Generic.IEnumerable%601> interfejsu lub interfejs, który dziedziczy z niego.</span><span class="sxs-lookup"><span data-stu-id="f1791-137">(For a list of these providers, see [LINQ (Language-Integrated Query)](https://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d).) The basic rule is simple: a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] data source is any object that supports the generic <xref:System.Collections.Generic.IEnumerable%601> interface, or an interface that inherits from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f1791-138">Typy takie jak <xref:System.Collections.ArrayList> który obsługuje niepodstawowy <xref:System.Collections.IEnumerable> interfejs może również służyć jako [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] źródeł danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-138">Types such as <xref:System.Collections.ArrayList> that support the non-generic <xref:System.Collections.IEnumerable> interface can also be used as [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] data sources.</span></span> <span data-ttu-id="f1791-139">Aby uzyskać przykład, który używa <xref:System.Collections.ArrayList>, zobacz [porady: zapytanie w ArrayList za pomocą LINQ (Visual Basic)](how-to-query-an-arraylist-with-linq.md).</span><span class="sxs-lookup"><span data-stu-id="f1791-139">For an example that uses an <xref:System.Collections.ArrayList>, see [How to: Query an ArrayList with LINQ (Visual Basic)](how-to-query-an-arraylist-with-linq.md).</span></span>  
  
## <a name="the-query"></a><span data-ttu-id="f1791-140">Zapytanie</span><span class="sxs-lookup"><span data-stu-id="f1791-140">The Query</span></span>  
 <span data-ttu-id="f1791-141">Należy określić w zapytaniu, informacji, które mają zostać pobrane ze źródła danych lub źródła.</span><span class="sxs-lookup"><span data-stu-id="f1791-141">In the query, you specify what information you want to retrieve from the data source or sources.</span></span> <span data-ttu-id="f1791-142">Istnieje również możliwość wybrania, jak te informacje powinny być sortowane, pogrupowane lub ze strukturą przed zwróceniem.</span><span class="sxs-lookup"><span data-stu-id="f1791-142">You also have the option of specifying how that information should be sorted, grouped, or structured before it is returned.</span></span> <span data-ttu-id="f1791-143">Aby włączyć tworzenie kwerendy, Visual Basic ma włączyć nową składnię zapytań do języka.</span><span class="sxs-lookup"><span data-stu-id="f1791-143">To enable query creation, Visual Basic has incorporated new query syntax into the language.</span></span>  
  
 <span data-ttu-id="f1791-144">Gdy jest wykonywany w poniższym przykładzie zwraca wszystkie liczby parzyste z tablicę liczb całkowitych `numbers`.</span><span class="sxs-lookup"><span data-stu-id="f1791-144">When it is executed, the query in the following example returns all the even numbers from an integer array, `numbers`.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#1](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_1.vb)]  
  
 <span data-ttu-id="f1791-145">Wyrażenie zapytania zawiera trzy klauzule: `From`, `Where`, i `Select`.</span><span class="sxs-lookup"><span data-stu-id="f1791-145">The query expression contains three clauses: `From`, `Where`, and `Select`.</span></span> <span data-ttu-id="f1791-146">Określoną funkcję i cel każdej klauzuli wyrażenie zapytania, które zostało omówione w [podstawowe operacje zapytań (Visual Basic)](basic-query-operations.md).</span><span class="sxs-lookup"><span data-stu-id="f1791-146">The specific function and purpose of each query expression clause is discussed in [Basic Query Operations (Visual Basic)](basic-query-operations.md).</span></span> <span data-ttu-id="f1791-147">Aby uzyskać więcej informacji, zobacz [zapytania](../../../../visual-basic/language-reference/queries/index.md).</span><span class="sxs-lookup"><span data-stu-id="f1791-147">For more information, see [Queries](../../../../visual-basic/language-reference/queries/index.md).</span></span> <span data-ttu-id="f1791-148">Należy pamiętać, że w [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], definicja kwerendy często są przechowywane w zmiennej i wykonane później.</span><span class="sxs-lookup"><span data-stu-id="f1791-148">Note that in [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], a query definition often is stored in a variable and executed later.</span></span> <span data-ttu-id="f1791-149">Zapytanie zmiennych, takich jak `evensQuery` w poprzednim przykładzie, musi być typem odpytywalnym.</span><span class="sxs-lookup"><span data-stu-id="f1791-149">The query variable, such as `evensQuery` in the previous example, must be a queryable type.</span></span> <span data-ttu-id="f1791-150">Typ `evensQuery` jest `IEnumerable(Of Integer)`, przypisanego przez kompilator przy użyciu wnioskowanie o typie lokalnym.</span><span class="sxs-lookup"><span data-stu-id="f1791-150">The type of `evensQuery` is `IEnumerable(Of Integer)`, assigned by the compiler using local type inference.</span></span>  
  
 <span data-ttu-id="f1791-151">Należy pamiętać, że sama zmienna zapytania nie podejmuje żadnych działań i nie zwraca żadnych danych.</span><span class="sxs-lookup"><span data-stu-id="f1791-151">It is important to remember that the query variable itself takes no action and returns no data.</span></span> <span data-ttu-id="f1791-152">Przechowuje tylko definicja zapytania.</span><span class="sxs-lookup"><span data-stu-id="f1791-152">It only stores the query definition.</span></span> <span data-ttu-id="f1791-153">W poprzednim przykładzie, jest `For Each` pętli, która wykonuje zapytanie.</span><span class="sxs-lookup"><span data-stu-id="f1791-153">In the previous example, it is the `For Each` loop that executes the query.</span></span>  
  
## <a name="query-execution"></a><span data-ttu-id="f1791-154">Wykonywanie zapytania</span><span class="sxs-lookup"><span data-stu-id="f1791-154">Query Execution</span></span>  
 <span data-ttu-id="f1791-155">Wykonywanie kwerendy różni się od tworzenia kwerendy.</span><span class="sxs-lookup"><span data-stu-id="f1791-155">Query execution is separate from query creation.</span></span> <span data-ttu-id="f1791-156">Tworzenie kwerendy definiuje zapytanie, ale wykonanie jest wyzwalane przez innego mechanizmu.</span><span class="sxs-lookup"><span data-stu-id="f1791-156">Query creation defines the query, but execution is triggered by a different mechanism.</span></span> <span data-ttu-id="f1791-157">Zapytania mogą być wykonywane natychmiast po tym, jak to zdefiniowano (*natychmiastowe wykonanie*), lub definicji mogą być przechowywane i zapytania, które może być wykonane później (*wykonanie odroczone*).</span><span class="sxs-lookup"><span data-stu-id="f1791-157">A query can be executed as soon as it is defined (*immediate execution*), or the definition can be stored and the query can be executed later (*deferred execution*).</span></span>  
  
### <a name="deferred-execution"></a><span data-ttu-id="f1791-158">Wykonanie odroczone</span><span class="sxs-lookup"><span data-stu-id="f1791-158">Deferred Execution</span></span>  
 <span data-ttu-id="f1791-159">Typowa [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] zapytania podobne do pokazanego na poprzednim przykładzie, w którym `evensQuery` jest zdefiniowana.</span><span class="sxs-lookup"><span data-stu-id="f1791-159">A typical [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query resembles the one in the previous example, in which `evensQuery` is defined.</span></span> <span data-ttu-id="f1791-160">Tworzy zapytanie, ale nie jest wykonywane go natychmiast.</span><span class="sxs-lookup"><span data-stu-id="f1791-160">It creates the query but does not execute it immediately.</span></span> <span data-ttu-id="f1791-161">Zamiast tego, definicja kwerendy jest przechowywana w zmiennej zapytania `evensQuery`.</span><span class="sxs-lookup"><span data-stu-id="f1791-161">Instead, the query definition is stored in the query variable `evensQuery`.</span></span> <span data-ttu-id="f1791-162">Wykonaj zapytanie później, zwykle za pomocą `For Each` pętli, która zwraca sekwencję wartości lub stosując operator standardowego zapytania, takie jak `Count` lub `Max`.</span><span class="sxs-lookup"><span data-stu-id="f1791-162">You execute the query later, typically by using a `For Each` loop, which returns a sequence of values, or by applying a standard query operator, such as `Count` or `Max`.</span></span> <span data-ttu-id="f1791-163">Ten proces jest nazywany *wykonanie odroczone*.</span><span class="sxs-lookup"><span data-stu-id="f1791-163">This process is referred to as *deferred execution*.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#7](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_3.vb)]  
  
 <span data-ttu-id="f1791-164">Dla sekwencji wartości, uzyskujesz dostęp do tych danych przy użycie zmiennej iteracyjnej w `For Each` pętli (`number` w poprzednim przykładzie).</span><span class="sxs-lookup"><span data-stu-id="f1791-164">For a sequence of values, you access the retrieved data by using the iteration variable in the `For Each` loop (`number` in the previous example).</span></span> <span data-ttu-id="f1791-165">Ponieważ zmienna zapytania `evensQuery`, przechowuje definicji zapytania, a nie wyniki zapytania może wykonywać kwerendę tak często, jak za pomocą zmiennej zapytania więcej niż jeden raz.</span><span class="sxs-lookup"><span data-stu-id="f1791-165">Because the query variable, `evensQuery`, holds the query definition rather than the query results, you can execute a query as often as you want by using the query variable more than one time.</span></span> <span data-ttu-id="f1791-166">Na przykład Niewykluczone, że bazy danych w aplikacji, który jest stale aktualizowana przez oddzielną aplikację.</span><span class="sxs-lookup"><span data-stu-id="f1791-166">For example, you might have a database in your application that is being updated continually by a separate application.</span></span> <span data-ttu-id="f1791-167">Po utworzeniu zapytania, które pobierają dane z tej bazy danych, można użyć `For Each` pętli do wykonania zapytania wielokrotnie, pobieranie najnowszych danych z każdym razem, gdy.</span><span class="sxs-lookup"><span data-stu-id="f1791-167">After you have created a query that retrieves data from that database, you can use a `For Each` loop to execute the query repeatedly, retrieving the most recent data every time.</span></span>  
  
 <span data-ttu-id="f1791-168">Poniższy przykład pokazuje, jak odroczonego wykonania działania.</span><span class="sxs-lookup"><span data-stu-id="f1791-168">The following example demonstrates how deferred execution works.</span></span> <span data-ttu-id="f1791-169">Po `evensQuery2` został zdefiniowany i jest wykonywany z `For Each` pętli, jak w poprzednich przykładach, niektóre elementy w źródle danych `numbers` są zmieniane.</span><span class="sxs-lookup"><span data-stu-id="f1791-169">After `evensQuery2` is defined and executed with a `For Each` loop, as in the previous examples, some elements in the data source `numbers` are changed.</span></span> <span data-ttu-id="f1791-170">Następnie sekundy `For Each` pętli przebiegów `evensQuery2` ponownie.</span><span class="sxs-lookup"><span data-stu-id="f1791-170">Then a second `For Each` loop runs `evensQuery2` again.</span></span> <span data-ttu-id="f1791-171">Wyniki różnią się po raz drugi, ponieważ `For Each` pętla jest wykonywana zapytanie ponownie, używając nowych wartości w `numbers`.</span><span class="sxs-lookup"><span data-stu-id="f1791-171">The results are different the second time, because the `For Each` loop executes the query again, using the new values in `numbers`.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#3](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_4.vb)]  
  
 <span data-ttu-id="f1791-172">Dane wyjściowe:</span><span class="sxs-lookup"><span data-stu-id="f1791-172">Output:</span></span>  
  
 `Evens in original array:`  
  
 `0  2  4  6`  
  
 `Evens in changed array:`  
  
 `0  10  2  22  8`  
  
### <a name="immediate-execution"></a><span data-ttu-id="f1791-173">Natychmiastowe wykonanie</span><span class="sxs-lookup"><span data-stu-id="f1791-173">Immediate Execution</span></span>  
 <span data-ttu-id="f1791-174">W odroczonego wykonania zapytania definicja kwerendy jest przechowywana w zmiennej zapytania do późniejszego wykonania.</span><span class="sxs-lookup"><span data-stu-id="f1791-174">In deferred execution of queries, the query definition is stored in a query variable for later execution.</span></span> <span data-ttu-id="f1791-175">Natychmiastowe wykonanie zapytanie jest wykonywane w czasie jego definicji.</span><span class="sxs-lookup"><span data-stu-id="f1791-175">In immediate execution, the query is executed at the time of its definition.</span></span> <span data-ttu-id="f1791-176">Wykonanie jest wyzwalane, gdy stosujesz metodę, która wymaga dostępu do indywidualnych elementów wyniku zapytania.</span><span class="sxs-lookup"><span data-stu-id="f1791-176">Execution is triggered when you apply a method that requires access to individual elements of the query result.</span></span> <span data-ttu-id="f1791-177">Natychmiastowe wykonanie często jest wymuszone za pomocą jednego z standardowych operatorów zapytań, które zwracają wartości pojedynczej.</span><span class="sxs-lookup"><span data-stu-id="f1791-177">Immediate execution often is forced by using one of the standard query operators that return single values.</span></span> <span data-ttu-id="f1791-178">Należą do nich `Count`, `Max`, `Average`, i `First`.</span><span class="sxs-lookup"><span data-stu-id="f1791-178">Examples are `Count`, `Max`, `Average`, and `First`.</span></span> <span data-ttu-id="f1791-179">Te standardowe operatory zapytań wykonaj zapytanie, jak są one stosowane w celu wykonywania obliczeń i zwracania pojedynczy rezultat.</span><span class="sxs-lookup"><span data-stu-id="f1791-179">These standard query operators execute the query as soon as they are applied in order to calculate and return a singleton result.</span></span> <span data-ttu-id="f1791-180">Aby uzyskać więcej informacji na temat standardowych operatorów zapytań, które zwracają wartości pojedynczej zobacz [operacje agregacji](aggregation-operations.md), [operacje na elementach](element-operations.md), i [Operacje kwantyfikatora](quantifier-operations.md).</span><span class="sxs-lookup"><span data-stu-id="f1791-180">For more information about standard query operators that return single values, see [Aggregation Operations](aggregation-operations.md), [Element Operations](element-operations.md), and [Quantifier Operations](quantifier-operations.md).</span></span>  
  
 <span data-ttu-id="f1791-181">Następujące zapytanie zwraca liczbę liczb parzystych w tablicy liczb całkowitych.</span><span class="sxs-lookup"><span data-stu-id="f1791-181">The following query returns a count of the even numbers in an array of integers.</span></span> <span data-ttu-id="f1791-182">Definicja zapytania nie jest zapisywane, a `numEvens` to prosta `Integer`.</span><span class="sxs-lookup"><span data-stu-id="f1791-182">The query definition is not saved, and `numEvens` is a simple `Integer`.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#4](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_5.vb)]  
  
 <span data-ttu-id="f1791-183">Ten sam efekt można osiągnąć za pomocą `Aggregate` metody.</span><span class="sxs-lookup"><span data-stu-id="f1791-183">You can achieve the same result by using the `Aggregate` method.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#5](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_6.vb)]  
  
 <span data-ttu-id="f1791-184">Możesz też wymusić wykonanie zapytania, wywołując `ToList` lub `ToArray` metody zapytania (natychmiastowa) lub zmienna zapytania (odroczona), jak pokazano w poniższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="f1791-184">You can also force execution of a query by calling the `ToList` or `ToArray` method on a query (immediate) or query variable (deferred), as shown in the following code.</span></span>  
  
 [!code-vb[VbLINQFirstQuery#6](../../../../visual-basic/programming-guide/concepts/linq/codesnippet/VisualBasic/writing-your-first-linq-query_7.vb)]  
  
 <span data-ttu-id="f1791-185">W poprzednich przykładach `evensQuery3` jest zapytaniem zmiennej, ale `evensList` się listę i `evensArray` jest tablicą.</span><span class="sxs-lookup"><span data-stu-id="f1791-185">In the previous examples, `evensQuery3` is a query variable, but `evensList` is a list and `evensArray` is an array.</span></span>  
  
 <span data-ttu-id="f1791-186">Za pomocą `ToList` lub `ToArray` Aby wymusić natychmiastowe wykonanie jest szczególnie przydatne w scenariuszach, w których chcesz przeprowadzić zapytanie natychmiastowo i wyniki w jednym obiekcie kolekcji w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f1791-186">Using `ToList` or `ToArray` to force immediate execution is especially useful in scenarios in which you want to execute the query immediately and cache the results in a single collection object.</span></span> <span data-ttu-id="f1791-187">Aby uzyskać więcej informacji o tych metodach, zobacz [konwertowanie typów danych](converting-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="f1791-187">For more information about these methods, see [Converting Data Types](converting-data-types.md).</span></span>  
  
 <span data-ttu-id="f1791-188">Kwerenda do wykonania przy użyciu także może powodować `IEnumerable` metody takie jak <xref:Microsoft.VisualBasic.Collection.System%23Collections%23IEnumerable%23GetEnumerator%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="f1791-188">You can also cause a query to be executed by using an `IEnumerable` method such as the <xref:Microsoft.VisualBasic.Collection.System%23Collections%23IEnumerable%23GetEnumerator%2A> method.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1791-189">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="f1791-189">See Also</span></span>  
 [<span data-ttu-id="f1791-190">Wprowadzenie do LINQ w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="f1791-190">Getting Started with LINQ in Visual Basic</span></span>](getting-started-with-linq.md)  
 [<span data-ttu-id="f1791-191">Wnioskowanie o typie lokalnym</span><span class="sxs-lookup"><span data-stu-id="f1791-191">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)  
 [<span data-ttu-id="f1791-192">Omówienie operatorów standardowej kwerendy (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f1791-192">Standard Query Operators Overview (Visual Basic)</span></span>](standard-query-operators-overview.md)  
 [<span data-ttu-id="f1791-193">Wprowadzenie do LINQ w Visual Basic</span><span class="sxs-lookup"><span data-stu-id="f1791-193">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)  
 [<span data-ttu-id="f1791-194">LINQ</span><span class="sxs-lookup"><span data-stu-id="f1791-194">LINQ</span></span>](../../../../visual-basic/programming-guide/language-features/linq/index.md)  
 [<span data-ttu-id="f1791-195">Zapytania</span><span class="sxs-lookup"><span data-stu-id="f1791-195">Queries</span></span>](../../../../visual-basic/language-reference/queries/index.md)
