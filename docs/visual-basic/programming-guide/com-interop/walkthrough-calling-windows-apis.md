---
title: 'Wskazówki: wywoływanie Windows API (Visual Basic)'
ms.date: 07/20/2015
helpviewer_keywords:
- DLLs, calling
- Windows API, walkthroughs
- platform invoke, walkthroughs
- API calls [Visual Basic], walkthroughs [Visual Basic]
- Windows API, calling
- walkthroughs [Visual Basic], API calls
- DllImport attribute, calling Windows API
- Declare statement [Visual Basic], declaring DLL functions
ms.assetid: 9280ca96-7a93-47a3-8d01-6d01be0657cb
ms.openlocfilehash: bb98d842bfe65bdf637a789fc9a8319a70cb2bc8
ms.sourcegitcommit: 869b5832b667915ac4a5dd8c86b1109ed26b6c08
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/28/2018
ms.locfileid: "39332863"
---
# <a name="walkthrough-calling-windows-apis-visual-basic"></a><span data-ttu-id="c7f84-102">Wskazówki: wywoływanie Windows API (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="c7f84-102">Walkthrough: Calling Windows APIs (Visual Basic)</span></span>
<span data-ttu-id="c7f84-103">Interfejsy API Windows są bibliotek dołączanych dynamicznie (dll), które są częścią systemu operacyjnego Windows.</span><span class="sxs-lookup"><span data-stu-id="c7f84-103">Windows APIs are dynamic-link libraries (DLLs) that are part of the Windows operating system.</span></span> <span data-ttu-id="c7f84-104">Użyj ich do wykonywania zadań, gdy jest trudne do pisania procedur równoważne własne.</span><span class="sxs-lookup"><span data-stu-id="c7f84-104">You use them to perform tasks when it is difficult to write equivalent procedures of your own.</span></span> <span data-ttu-id="c7f84-105">Na przykład Windows zapewnia funkcję o nazwie `FlashWindowEx` gwarantowaną na pasku tytułu aplikacji alternatywne między poszczególnymi jasny i ciemny.</span><span class="sxs-lookup"><span data-stu-id="c7f84-105">For example, Windows provides a function named `FlashWindowEx` that lets you make the title bar for an application alternate between light and dark shades.</span></span>  
  
 <span data-ttu-id="c7f84-106">Zaletą korzystania z Windows API w kodzie jest, aby mogli oszczędzać czas projektowania, ponieważ zawierają one wielu przydatnych funkcji, które zostały już napisane i długiego czasu oczekiwania ma być używany.</span><span class="sxs-lookup"><span data-stu-id="c7f84-106">The advantage of using Windows APIs in your code is that they can save development time because they contain dozens of useful functions that are already written and waiting to be used.</span></span> <span data-ttu-id="c7f84-107">Wadą jest to, że interfejsy API Windows może być trudne do pracy z i unforgiving, gdy coś pójdzie źle.</span><span class="sxs-lookup"><span data-stu-id="c7f84-107">The disadvantage is that Windows APIs can be difficult to work with and unforgiving when things go wrong.</span></span>  
  
 <span data-ttu-id="c7f84-108">Interfejsy API Windows reprezentują kategorii specjalnej współdziałania.</span><span class="sxs-lookup"><span data-stu-id="c7f84-108">Windows APIs represent a special category of interoperability.</span></span> <span data-ttu-id="c7f84-109">Interfejsy API Windows korzysta z kodu zarządzanego, nie mają wbudowanej wpisz biblioteki i używać typów danych, które są inne niż te używane w programie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c7f84-109">Windows APIs do not use managed code, do not have built-in type libraries, and use data types that are different than those used with Visual Studio.</span></span> <span data-ttu-id="c7f84-110">Ze względu na następujące różnice a ponieważ interfejsy API Windows nie są obiektami COM, współpracy z interfejsami API Windows i [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] odbywa się przy użyciu platformy wywołać, lub jako PInvoke.</span><span class="sxs-lookup"><span data-stu-id="c7f84-110">Because of these differences, and because Windows APIs are not COM objects, interoperability with Windows APIs and the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] is performed using platform invoke, or PInvoke.</span></span> <span data-ttu-id="c7f84-111">Wywołanie platformy jest usługą, które umożliwia zarządzanemu kodowi do wywołania funkcji niezarządzanych zaimplementowane w bibliotekach DLL.</span><span class="sxs-lookup"><span data-stu-id="c7f84-111">Platform invoke is a service that enables managed code to call unmanaged functions implemented in DLLs.</span></span> <span data-ttu-id="c7f84-112">Aby uzyskać więcej informacji, zobacz [wykorzystywanie niezarządzanych funkcji DLL](../../../framework/interop/consuming-unmanaged-dll-functions.md).</span><span class="sxs-lookup"><span data-stu-id="c7f84-112">For more information, see [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md).</span></span> <span data-ttu-id="c7f84-113">Możesz używać PInvoke w języku Visual Basic, przy użyciu `Declare` instrukcji lub stosowanie `DllImport` atrybut pusty procedury.</span><span class="sxs-lookup"><span data-stu-id="c7f84-113">You can use PInvoke in Visual Basic by using either the `Declare` statement or applying the `DllImport` attribute to an empty procedure.</span></span>  
  
 <span data-ttu-id="c7f84-114">Wywołania interfejsu API Windows ważnym elementem programowania w przeszłości Visual Basic zostały, ale rzadko są niezbędne przy użyciu programu Visual Basic .NET.</span><span class="sxs-lookup"><span data-stu-id="c7f84-114">Windows API calls were an important part of Visual Basic programming in the past, but are seldom necessary with Visual Basic .NET.</span></span> <span data-ttu-id="c7f84-115">W miarę możliwości, skorzystaj z kodu zarządzanego z [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] do wykonywania zadań, a nie wywołań interfejsu API Windows.</span><span class="sxs-lookup"><span data-stu-id="c7f84-115">Whenever possible, you should use managed code from the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] to perform tasks, instead of Windows API calls.</span></span> <span data-ttu-id="c7f84-116">Ten przewodnik zawiera informacje dotyczące tych sytuacji, w której przy użyciu interfejsów API Windows jest to konieczne.</span><span class="sxs-lookup"><span data-stu-id="c7f84-116">This walkthrough provides information for those situations in which using Windows APIs is necessary.</span></span>  
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="api-calls-using-declare"></a><span data-ttu-id="c7f84-117">Zadeklaruj przy użyciu interfejsu API</span><span class="sxs-lookup"><span data-stu-id="c7f84-117">API Calls Using Declare</span></span>  
 <span data-ttu-id="c7f84-118">Najczęstszym sposobem wywoływania interfejsów API Windows polega na użyciu `Declare` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="c7f84-118">The most common way to call Windows APIs is by using the `Declare` statement.</span></span>  
  
#### <a name="to-declare-a-dll-procedure"></a><span data-ttu-id="c7f84-119">Aby zadeklarować procedury biblioteki DLL</span><span class="sxs-lookup"><span data-stu-id="c7f84-119">To declare a DLL procedure</span></span>  
  
1.  <span data-ttu-id="c7f84-120">Określić nazwę funkcji, której chcesz się połączyć, oraz jego argumentów, typy argumentów i zwracać wartości, a także nazwę i lokalizację biblioteki DLL, która go zawiera.</span><span class="sxs-lookup"><span data-stu-id="c7f84-120">Determine the name of the function you want to call, plus its arguments, argument types, and return value, as well as the name and location of the DLL that contains it.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="c7f84-121">Aby uzyskać pełne informacje o interfejsach API Windows zobacz dokumentację zestawu SDK systemu Win32 w interfejsie API Windows SDK platformy.</span><span class="sxs-lookup"><span data-stu-id="c7f84-121">For complete information about the Windows APIs, see the Win32 SDK documentation in the Platform SDK Windows API.</span></span> <span data-ttu-id="c7f84-122">Aby uzyskać więcej informacji na temat stałe, które używają interfejsów API Windows Sprawdź pliki nagłówkowe, takie jak Windows.h dołączone do zestawu SDK platformy.</span><span class="sxs-lookup"><span data-stu-id="c7f84-122">For more information about the constants that Windows APIs use, examine the header files such as Windows.h included with the Platform SDK.</span></span>  
  
2.  <span data-ttu-id="c7f84-123">Otwórz nowy projekt aplikacji Windows, klikając **New** na **pliku** menu, a następnie klikając polecenie **projektu**.</span><span class="sxs-lookup"><span data-stu-id="c7f84-123">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="c7f84-124">**Nowy projekt** pojawi się okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="c7f84-124">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="c7f84-125">Wybierz **aplikacji Windows** z listy szablonów projektu języka Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="c7f84-125">Select **Windows Application** from the list of Visual Basic project templates.</span></span> <span data-ttu-id="c7f84-126">Zostanie wyświetlony nowy projekt.</span><span class="sxs-lookup"><span data-stu-id="c7f84-126">The new project is displayed.</span></span>  
  
4.  <span data-ttu-id="c7f84-127">Dodaj następujący kod `Declare` funkcję na klasę lub moduł, w której chcesz użyć biblioteki DLL:</span><span class="sxs-lookup"><span data-stu-id="c7f84-127">Add the following `Declare` function either to the class or module in which you want to use the DLL:</span></span>  
  
     [!code-vb[VbVbalrInterop#9](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_1.vb)]  
  
### <a name="parts-of-the-declare-statement"></a><span data-ttu-id="c7f84-128">Części Declare — instrukcja</span><span class="sxs-lookup"><span data-stu-id="c7f84-128">Parts of the Declare Statement</span></span>  
 <span data-ttu-id="c7f84-129">`Declare` Wyciąg zawiera następujące elementy.</span><span class="sxs-lookup"><span data-stu-id="c7f84-129">The `Declare` statement includes the following elements.</span></span>  
  
#### <a name="auto-modifier"></a><span data-ttu-id="c7f84-130">Modyfikator Auto</span><span class="sxs-lookup"><span data-stu-id="c7f84-130">Auto modifier</span></span>  
 <span data-ttu-id="c7f84-131">`Auto` Modyfikator powoduje, że środowisko uruchomieniowe do konwersji ciągu na podstawie nazwy metody, zgodnie z typowych reguł środowiska uruchomieniowego języka (lub nazwę aliasu, jeśli określono).</span><span class="sxs-lookup"><span data-stu-id="c7f84-131">The `Auto` modifier instructs the runtime to convert the string based on the method name according to common language runtime rules (or alias name if specified).</span></span>  
  
#### <a name="lib-and-alias-keywords"></a><span data-ttu-id="c7f84-132">Słowa kluczowe lib i Alias.</span><span class="sxs-lookup"><span data-stu-id="c7f84-132">Lib and Alias keywords</span></span>  
 <span data-ttu-id="c7f84-133">Następujące nazwy `Function` — słowo kluczowe nazywa się program używa do importowanych funkcji dostępu.</span><span class="sxs-lookup"><span data-stu-id="c7f84-133">The name following the `Function` keyword is the name your program uses to access the imported function.</span></span> <span data-ttu-id="c7f84-134">Może być taka sama jak rzeczywistą nazwą funkcji, którą wywołujesz, albo można użyć dowolnej nazwy prawidłowe procedury i następnie stosują `Alias` — słowo kluczowe, aby określić rzeczywistą nazwą funkcji, którą wywołujesz.</span><span class="sxs-lookup"><span data-stu-id="c7f84-134">It can be the same as the real name of the function you are calling, or you can use any valid procedure name and then employ the `Alias` keyword to specify the real name of the function you are calling.</span></span>  
  
 <span data-ttu-id="c7f84-135">Określ `Lib` — słowo kluczowe, a następnie nazwę i lokalizację biblioteki DLL, która zawiera funkcję, którą wywołujesz.</span><span class="sxs-lookup"><span data-stu-id="c7f84-135">Specify the `Lib` keyword, followed by the name and location of the DLL that contains the function you are calling.</span></span> <span data-ttu-id="c7f84-136">Nie ma potrzeby określ ścieżkę do plików znajdujących się w katalogach systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="c7f84-136">You do not need to specify the path for files located in the Windows system directories.</span></span>  
  
 <span data-ttu-id="c7f84-137">Użyj `Alias` — słowo kluczowe, jeśli nazwa funkcji wywołanie nie jest prawidłową nazwą procedury języka Visual Basic lub powoduje konflikt z nazwą innych elementów w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c7f84-137">Use the `Alias` keyword if the name of the function you are calling is not a valid Visual Basic procedure name, or conflicts with the name of other items in your application.</span></span> <span data-ttu-id="c7f84-138">`Alias` Wskazuje wartość true, nazwę wywoływanej funkcji.</span><span class="sxs-lookup"><span data-stu-id="c7f84-138">`Alias` indicates the true name of the function being called.</span></span>  
  
#### <a name="argument-and-data-type-declarations"></a><span data-ttu-id="c7f84-139">Argument i deklaracji typów danych</span><span class="sxs-lookup"><span data-stu-id="c7f84-139">Argument and Data Type Declarations</span></span>  
 <span data-ttu-id="c7f84-140">Zadeklaruj argumentów i ich typy danych.</span><span class="sxs-lookup"><span data-stu-id="c7f84-140">Declare the arguments and their data types.</span></span> <span data-ttu-id="c7f84-141">Ta część może stanowić wyzwanie, ponieważ typy danych, które używa Windows nie są zgodne typy danych Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c7f84-141">This part can be challenging because the data types that Windows uses do not correspond to Visual Studio data types.</span></span> <span data-ttu-id="c7f84-142">Visual Basic jest dużo pracy dla Ciebie konwertując argumenty kompatybilne typy danych, w procesie zwanym *marshaling*.</span><span class="sxs-lookup"><span data-stu-id="c7f84-142">Visual Basic does a lot of the work for you by converting arguments to compatible data types, a process called *marshaling*.</span></span> <span data-ttu-id="c7f84-143">Można jawnie kontrolować, jak argumenty są przekazywane przy użyciu <xref:System.Runtime.InteropServices.MarshalAsAttribute> atrybutowi określonemu w <xref:System.Runtime.InteropServices> przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="c7f84-143">You can explicitly control how arguments are marshaled by using the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute defined in the <xref:System.Runtime.InteropServices> namespace.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c7f84-144">Poprzednie wersje języka Visual Basic można deklarować parametrów `As Any`, co oznacza danych wszelkich danych typu można użyć.</span><span class="sxs-lookup"><span data-stu-id="c7f84-144">Previous versions of Visual Basic allowed you to declare parameters `As Any`, meaning that data of any data type could be used.</span></span> <span data-ttu-id="c7f84-145">Visual Basic wymaga użycia określonego typu danych dla wszystkich `Declare` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="c7f84-145">Visual Basic requires that you use a specific data type for all `Declare` statements.</span></span>  
  
#### <a name="windows-api-constants"></a><span data-ttu-id="c7f84-146">Stałe Windows API</span><span class="sxs-lookup"><span data-stu-id="c7f84-146">Windows API Constants</span></span>  
 <span data-ttu-id="c7f84-147">Niektóre argumenty są kombinacje stałe.</span><span class="sxs-lookup"><span data-stu-id="c7f84-147">Some arguments are combinations of constants.</span></span> <span data-ttu-id="c7f84-148">Na przykład `MessageBox` przedstawione w niniejszym instruktażu interfejs API akceptuje argument liczby całkowitej o nazwie `Typ` sterującą, jak zostanie wyświetlone okno komunikatu.</span><span class="sxs-lookup"><span data-stu-id="c7f84-148">For example, the `MessageBox` API shown in this walkthrough accepts an integer argument called `Typ` that controls how the message box is displayed.</span></span> <span data-ttu-id="c7f84-149">Można określić wartość liczbową te stałe, sprawdzając `#define` instrukcje w pliku WinUser.h.</span><span class="sxs-lookup"><span data-stu-id="c7f84-149">You can determine the numeric value of these constants by examining the `#define` statements in the file WinUser.h.</span></span> <span data-ttu-id="c7f84-150">Wartości numeryczne są wyświetlane w formacie szesnastkowym, ogólnie, więc możesz je dodać i Konwertuj na wartość dziesiętną przy użyciu kalkulatora.</span><span class="sxs-lookup"><span data-stu-id="c7f84-150">The numeric values are generally shown in hexadecimal, so you may want to use a calculator to add them and convert to decimal.</span></span> <span data-ttu-id="c7f84-151">Na przykład, jeśli chcesz połączyć stałe dla stylu wykrzyknika `MB_ICONEXCLAMATION` 0x00000030 i tak/bez stylu `MB_YESNO` 0x00000004, można dodać liczb i uzyskanie wyniku 0x00000034 lub 52 dziesiętną.</span><span class="sxs-lookup"><span data-stu-id="c7f84-151">For example, if you want to combine the constants for the exclamation style `MB_ICONEXCLAMATION` 0x00000030 and the Yes/No style `MB_YESNO` 0x00000004, you can add the numbers and get a result of 0x00000034, or 52 decimal.</span></span> <span data-ttu-id="c7f84-152">Chociaż można używać wyniku dziesiętna bezpośrednio, zaleca się deklarować te wartości jako stałe w aplikacji, a także połączyć je przy użyciu `Or` operatora.</span><span class="sxs-lookup"><span data-stu-id="c7f84-152">Although you can use the decimal result directly, it is better to declare these values as constants in your application and combine them using the `Or` operator.</span></span>  
  
###### <a name="to-declare-constants-for-windows-api-calls"></a><span data-ttu-id="c7f84-153">Aby zadeklarować stałe dla wywołań interfejsu API Windows</span><span class="sxs-lookup"><span data-stu-id="c7f84-153">To declare constants for Windows API calls</span></span>  
  
1.  <span data-ttu-id="c7f84-154">Zajrzyj do dokumentacji dla funkcji Windows, którą wywołujesz.</span><span class="sxs-lookup"><span data-stu-id="c7f84-154">Consult the documentation for the Windows function you are calling.</span></span> <span data-ttu-id="c7f84-155">Określ nazwę stałe, które są używane i nazwę pliku .h, zawierająca wartości liczbowe dla tych stałych.</span><span class="sxs-lookup"><span data-stu-id="c7f84-155">Determine the name of the constants it uses and the name of the .h file that contains the numeric values for these constants.</span></span>  
  
2.  <span data-ttu-id="c7f84-156">Użyj edytora tekstu, takiego jak Notatnik, aby wyświetlić zawartość pliku nagłówka (.h) i Znajdź wartości skojarzone z stałe, którego używasz.</span><span class="sxs-lookup"><span data-stu-id="c7f84-156">Use a text editor, such as Notepad, to view the contents of the header (.h) file, and find the values associated with the constants you are using.</span></span> <span data-ttu-id="c7f84-157">Na przykład `MessageBox` interfejsu API używa stałej `MB_ICONQUESTION` do wyświetlenia znaku zapytania w oknie komunikatu.</span><span class="sxs-lookup"><span data-stu-id="c7f84-157">For example, the `MessageBox` API uses the constant `MB_ICONQUESTION` to show a question mark in the message box.</span></span> <span data-ttu-id="c7f84-158">Definicja `MB_ICONQUESTION` jest WinUser.h i wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="c7f84-158">The definition for `MB_ICONQUESTION` is in WinUser.h and appears as follows:</span></span>  
  
     `#define MB_ICONQUESTION             0x00000020L`  
  
3.  <span data-ttu-id="c7f84-159">Dodaj odpowiednik `Const` instrukcji do klasy lub modułu, aby udostępnić te stałe do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c7f84-159">Add equivalent `Const` statements to your class or module to make these constants available to your application.</span></span> <span data-ttu-id="c7f84-160">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="c7f84-160">For example:</span></span>  
  
     [!code-vb[VbVbalrInterop#11](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_2.vb)]  
  
###### <a name="to-call-the-dll-procedure"></a><span data-ttu-id="c7f84-161">Aby wywołać procedurę biblioteki DLL</span><span class="sxs-lookup"><span data-stu-id="c7f84-161">To call the DLL procedure</span></span>  
  
1.  <span data-ttu-id="c7f84-162">Dodaj przycisk o nazwie `Button1` do uruchamiania formularza do projektu, a następnie go dwukrotnie, aby wyświetlić jej kod.</span><span class="sxs-lookup"><span data-stu-id="c7f84-162">Add a button named `Button1` to the startup form for your project, and then double-click it to view its code.</span></span> <span data-ttu-id="c7f84-163">Program obsługi zdarzeń dla przycisku zostanie wyświetlona.</span><span class="sxs-lookup"><span data-stu-id="c7f84-163">The event handler for the button is displayed.</span></span>  
  
2.  <span data-ttu-id="c7f84-164">Dodaj kod, aby `Click` programu obsługi zdarzeń dla przycisku został dodany, aby wywołać procedurę i podaj odpowiednie argumenty:</span><span class="sxs-lookup"><span data-stu-id="c7f84-164">Add code to the `Click` event handler for the button you added, to call the procedure and provide the appropriate arguments:</span></span>  
  
     [!code-vb[VbVbalrInterop#12](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_3.vb)]  
  
3.  <span data-ttu-id="c7f84-165">Uruchom projekt, naciskając klawisz F5.</span><span class="sxs-lookup"><span data-stu-id="c7f84-165">Run the project by pressing F5.</span></span> <span data-ttu-id="c7f84-166">Zostanie wyświetlone okno komunikatu, zarówno **tak** i **nie** przyciski odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="c7f84-166">The message box is displayed with both **Yes** and **No** response buttons.</span></span> <span data-ttu-id="c7f84-167">Kliknij jeden.</span><span class="sxs-lookup"><span data-stu-id="c7f84-167">Click either one.</span></span>  
  
#### <a name="data-marshaling"></a><span data-ttu-id="c7f84-168">Marshaling danych</span><span class="sxs-lookup"><span data-stu-id="c7f84-168">Data Marshaling</span></span>  
 <span data-ttu-id="c7f84-169">Visual Basic automatycznie konwertuje typów danych parametrów i wartości zwracane dla wywołań interfejsu API Windows, ale można użyć `MarshalAs` atrybutu, aby jawnie określić typy niezarządzanych danych, których oczekuje interfejs API.</span><span class="sxs-lookup"><span data-stu-id="c7f84-169">Visual Basic automatically converts the data types of parameters and return values for Windows API calls, but you can use the `MarshalAs` attribute to explicitly specify unmanaged data types that an API expects.</span></span> <span data-ttu-id="c7f84-170">Aby uzyskać więcej informacji na temat marshaling międzyoperacyjny zobacz [Marshaling międzyoperacyjności](../../../framework/interop/interop-marshaling.md).</span><span class="sxs-lookup"><span data-stu-id="c7f84-170">For more information about interop marshaling, see [Interop Marshaling](../../../framework/interop/interop-marshaling.md).</span></span>  
  
###### <a name="to-use-declare-and-marshalas-in-an-api-call"></a><span data-ttu-id="c7f84-171">Aby użyć Declare i MarshalAs w wywołaniu interfejsu API</span><span class="sxs-lookup"><span data-stu-id="c7f84-171">To use Declare and MarshalAs in an API call</span></span>  
  
1.  <span data-ttu-id="c7f84-172">Określ nazwę funkcji, którą chcesz wywołać oraz jej argumenty typów danych i zwracają wartość.</span><span class="sxs-lookup"><span data-stu-id="c7f84-172">Determine the name of the function you want to call, plus its arguments, data types, and return value.</span></span>  
  
2.  <span data-ttu-id="c7f84-173">Aby uprościć dostęp do `MarshalAs` atrybutu, należy dodać `Imports` instrukcji na górze kod klasę lub moduł, tak jak w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="c7f84-173">To simplify access to the `MarshalAs` attribute, add an `Imports` statement to the top of the code for the class or module, as in the following example:</span></span>  
  
     [!code-vb[VbVbalrInterop#13](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]  
  
3.  <span data-ttu-id="c7f84-174">Dodaj prototypu funkcji dla importowanych funkcji w klasie lub modułu, a zastosowanie `MarshalAs` atrybutu do parametrów lub wartości zwracanej.</span><span class="sxs-lookup"><span data-stu-id="c7f84-174">Add a function prototype for the imported function to the class or module you are using, and apply the `MarshalAs` attribute to the parameters or return value.</span></span> <span data-ttu-id="c7f84-175">W poniższym przykładzie wywołanie interfejsu API, która oczekuje typu `void*` jest organizowana jako `AsAny`:</span><span class="sxs-lookup"><span data-stu-id="c7f84-175">In the following example, an API call that expects the type `void*` is marshaled as `AsAny`:</span></span>  
  
     [!code-vb[VbVbalrInterop#14](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_5.vb)]  
  
## <a name="api-calls-using-dllimport"></a><span data-ttu-id="c7f84-176">Wywołania interfejsu API przy użyciu elementu DllImport</span><span class="sxs-lookup"><span data-stu-id="c7f84-176">API Calls Using DllImport</span></span>  
 <span data-ttu-id="c7f84-177">`DllImport` Atrybut zawiera druga metoda do wywołania funkcji w bibliotekach DLL bez biblioteki typów.</span><span class="sxs-lookup"><span data-stu-id="c7f84-177">The `DllImport` attribute provides a second way to call functions in DLLs without type libraries.</span></span> <span data-ttu-id="c7f84-178">`DllImport` jest w przybliżeniu za pomocą `Declare` instrukcji, ale zapewnia większą kontrolę nad jak funkcje są wywoływane.</span><span class="sxs-lookup"><span data-stu-id="c7f84-178">`DllImport` is roughly equivalent to using a `Declare` statement but provides more control over how functions are called.</span></span>  
  
 <span data-ttu-id="c7f84-179">Możesz użyć `DllImport` z większości API Windows wywołuje tak długo, jak wywołanie odnosi się do udostępnionego (nazywane czasem *statyczne*) metody.</span><span class="sxs-lookup"><span data-stu-id="c7f84-179">You can use `DllImport` with most Windows API calls as long as the call refers to a shared (sometimes called *static*) method.</span></span> <span data-ttu-id="c7f84-180">Nie można używać metod, które wymagają wystąpienia klasy.</span><span class="sxs-lookup"><span data-stu-id="c7f84-180">You cannot use methods that require an instance of a class.</span></span> <span data-ttu-id="c7f84-181">W odróżnieniu od `Declare` instrukcji `DllImport` nie mogą używać wywołania `MarshalAs` atrybutu.</span><span class="sxs-lookup"><span data-stu-id="c7f84-181">Unlike `Declare` statements, `DllImport` calls cannot use the `MarshalAs` attribute.</span></span>  
  
#### <a name="to-call-a-windows-api-using-the-dllimport-attribute"></a><span data-ttu-id="c7f84-182">Aby wywołać interfejs API Windows za pomocą atrybutu DllImport</span><span class="sxs-lookup"><span data-stu-id="c7f84-182">To call a Windows API using the DllImport attribute</span></span>  
  
1.  <span data-ttu-id="c7f84-183">Otwórz nowy projekt aplikacji Windows, klikając **New** na **pliku** menu, a następnie klikając polecenie **projektu**.</span><span class="sxs-lookup"><span data-stu-id="c7f84-183">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="c7f84-184">**Nowy projekt** pojawi się okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="c7f84-184">The **New Project** dialog box appears.</span></span>  
  
2.  <span data-ttu-id="c7f84-185">Wybierz **aplikacji Windows** z listy szablonów projektu języka Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="c7f84-185">Select **Windows Application** from the list of Visual Basic project templates.</span></span> <span data-ttu-id="c7f84-186">Zostanie wyświetlony nowy projekt.</span><span class="sxs-lookup"><span data-stu-id="c7f84-186">The new project is displayed.</span></span>  
  
3.  <span data-ttu-id="c7f84-187">Dodaj przycisk o nazwie `Button2` do formy uruchamiania.</span><span class="sxs-lookup"><span data-stu-id="c7f84-187">Add a button named `Button2` to the startup form.</span></span>  
  
4.  <span data-ttu-id="c7f84-188">Kliknij dwukrotnie `Button2` otwarcie widoku kodu formularza.</span><span class="sxs-lookup"><span data-stu-id="c7f84-188">Double-click `Button2` to open the code view for the form.</span></span>  
  
5.  <span data-ttu-id="c7f84-189">Aby uprościć dostęp do `DllImport`, Dodaj `Imports` instrukcji na górze kod startowy klasy formularza:</span><span class="sxs-lookup"><span data-stu-id="c7f84-189">To simplify access to `DllImport`, add an `Imports` statement to the top of the code for the startup form class:</span></span>  
  
     [!code-vb[VbVbalrInterop#13](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]  
  
6.  <span data-ttu-id="c7f84-190">Deklarowanie funkcji empty poprzedniego `End Class` instrukcji formularza i nazwy funkcji `MoveFile`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-190">Declare an empty function preceding the `End Class` statement for the form, and name the function `MoveFile`.</span></span>  
  
7.  <span data-ttu-id="c7f84-191">Zastosuj `Public` i `Shared` Modyfikatory do deklaracji funkcji i ustawianie parametrów `MoveFile` na podstawie argumentów korzysta z funkcji Windows API:</span><span class="sxs-lookup"><span data-stu-id="c7f84-191">Apply the `Public` and `Shared` modifiers to the function declaration and set parameters for `MoveFile` based on the arguments the Windows API function uses:</span></span>  
  
     [!code-vb[VbVbalrInterop#16](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_6.vb)]  
  
     <span data-ttu-id="c7f84-192">Funkcja może mieć dowolną nazwę procedury prawidłowe; `DllImport` atrybut określa nazwę w bibliotece DLL.</span><span class="sxs-lookup"><span data-stu-id="c7f84-192">Your function can have any valid procedure name; the `DllImport` attribute specifies the name in the DLL.</span></span> <span data-ttu-id="c7f84-193">Umożliwia on również obsługę współdziałanie marshaling dla parametrów i wartości zwracane, więc możesz wybrać typy danych Visual Studio, które są podobne do danych typy używa interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="c7f84-193">It also handles interoperability marshaling for the parameters and return values, so you can choose Visual Studio data types that are similar to the data types the API uses.</span></span>  
  
8.  <span data-ttu-id="c7f84-194">Zastosuj `DllImport` atrybutu do funkcji empty.</span><span class="sxs-lookup"><span data-stu-id="c7f84-194">Apply the `DllImport` attribute to the empty function.</span></span> <span data-ttu-id="c7f84-195">Pierwszy parametr jest nazwę i lokalizację pliku DLL zawierającego funkcję, którą wywołujesz.</span><span class="sxs-lookup"><span data-stu-id="c7f84-195">The first parameter is the name and location of the DLL containing the function you are calling.</span></span> <span data-ttu-id="c7f84-196">Nie ma potrzeby określ ścieżkę do plików znajdujących się w katalogach systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="c7f84-196">You do not need to specify the path for files located in the Windows system directories.</span></span> <span data-ttu-id="c7f84-197">Drugi parametr jest nazwany argument, który określa nazwę funkcji w interfejsie API Windows.</span><span class="sxs-lookup"><span data-stu-id="c7f84-197">The second parameter is a named argument that specifies the name of the function in the Windows API.</span></span> <span data-ttu-id="c7f84-198">W tym przykładzie `DllImport` atrybut wymusza wywołania `MoveFile` były przekazywane do `MoveFileW` w KERNEL32. BIBLIOTEKI DLL.</span><span class="sxs-lookup"><span data-stu-id="c7f84-198">In this example, the `DllImport` attribute forces calls to `MoveFile` to be forwarded to `MoveFileW` in KERNEL32.DLL.</span></span> <span data-ttu-id="c7f84-199">`MoveFileW` Metoda służy do kopiowania pliku ze ścieżki `src` do ścieżki `dst`.</span><span class="sxs-lookup"><span data-stu-id="c7f84-199">The `MoveFileW` method copies a file from the path `src` to the path `dst`.</span></span>  
  
     [!code-vb[VbVbalrInterop#17](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_7.vb)]  
  
9. <span data-ttu-id="c7f84-200">Dodaj kod, aby `Button2_Click` program obsługi zdarzeń w wywołaniu funkcji:</span><span class="sxs-lookup"><span data-stu-id="c7f84-200">Add code to the `Button2_Click` event handler to call the function:</span></span>  
  
     [!code-vb[VbVbalrInterop#18](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_8.vb)]  
  
10. <span data-ttu-id="c7f84-201">Utwórz plik o nazwie jako i umieść go w katalogu C:\Tmp na dysku twardym.</span><span class="sxs-lookup"><span data-stu-id="c7f84-201">Create a file named Test.txt and place it in the C:\Tmp directory on your hard drive.</span></span> <span data-ttu-id="c7f84-202">Utwórz katalog Tmp, jeśli to konieczne.</span><span class="sxs-lookup"><span data-stu-id="c7f84-202">Create the Tmp directory if necessary.</span></span>  
  
11. <span data-ttu-id="c7f84-203">Naciśnij klawisz F5, aby uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="c7f84-203">Press F5 to start the application.</span></span> <span data-ttu-id="c7f84-204">Zostanie wyświetlony formularz główny.</span><span class="sxs-lookup"><span data-stu-id="c7f84-204">The main form appears.</span></span>  
  
12. <span data-ttu-id="c7f84-205">Kliknij przycisk **Button2**.</span><span class="sxs-lookup"><span data-stu-id="c7f84-205">Click **Button2**.</span></span> <span data-ttu-id="c7f84-206">Jeśli można przenieść pliku, jest wyświetlany komunikat "plik przeniesiono pomyślnie".</span><span class="sxs-lookup"><span data-stu-id="c7f84-206">The message "The file was moved successfully" is displayed if the file can be moved.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c7f84-207">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="c7f84-207">See Also</span></span>  
 <xref:System.Runtime.InteropServices.DllImportAttribute>  
 <xref:System.Runtime.InteropServices.MarshalAsAttribute>  
 [<span data-ttu-id="c7f84-208">Declare, instrukcja</span><span class="sxs-lookup"><span data-stu-id="c7f84-208">Declare Statement</span></span>](../../../visual-basic/language-reference/statements/declare-statement.md)  
 [<span data-ttu-id="c7f84-209">Auto</span><span class="sxs-lookup"><span data-stu-id="c7f84-209">Auto</span></span>](../../../visual-basic/language-reference/modifiers/auto.md)  
 [<span data-ttu-id="c7f84-210">Alias</span><span class="sxs-lookup"><span data-stu-id="c7f84-210">Alias</span></span>](../../../visual-basic/language-reference/statements/alias-clause.md)  
 [<span data-ttu-id="c7f84-211">Usługa międzyoperacyjna modelu COM</span><span class="sxs-lookup"><span data-stu-id="c7f84-211">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)  
 [<span data-ttu-id="c7f84-212">Tworzenie prototypów w kodzie zarządzanym</span><span class="sxs-lookup"><span data-stu-id="c7f84-212">Creating Prototypes in Managed Code</span></span>](../../../framework/interop/creating-prototypes-in-managed-code.md)  
 [<span data-ttu-id="c7f84-213">Marshaling delegata jako metoda wywołania zwrotnego</span><span class="sxs-lookup"><span data-stu-id="c7f84-213">Marshaling a Delegate as a Callback Method</span></span>](../../../framework/interop/marshaling-a-delegate-as-a-callback-method.md)
