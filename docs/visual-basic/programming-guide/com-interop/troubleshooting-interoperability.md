---
title: Rozwiązywanie problemów związanych z współdziałaniem (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability [Visual Basic]
- interoperability, troubleshooting
- COM interop [Visual Basic], troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
ms.openlocfilehash: 5b92eaf56e337b8a8128bb3a0706ecdb76177c0e
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 09/02/2018
ms.locfileid: "43472010"
---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="0e10d-102">Rozwiązywanie problemów związanych z współdziałaniem (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="0e10d-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="0e10d-103">Gdy współdziałania między COM i kodu zarządzanego z [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], może wystąpić co najmniej jeden z następujących typowych problemów.</span><span class="sxs-lookup"><span data-stu-id="0e10d-103">When you interoperate between COM and the managed code of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], you may encounter one or more of the following common issues.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor1"></a> <span data-ttu-id="0e10d-104">Marshaling międzyoperacyjny</span><span class="sxs-lookup"><span data-stu-id="0e10d-104">Interop Marshaling</span></span>  
 <span data-ttu-id="0e10d-105">Czasami może być używanie typów danych, które nie są częścią [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e10d-105">At times, you may have to use data types that are not part of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="0e10d-106">Zestawy międzyoperacyjne obsługiwać większość pracy dla obiektów COM, ale może być konieczne kontrolować typów danych, które są używane, gdy zarządzane obiekty są widoczne dla modelu COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="0e10d-107">Na przykład, należy określić struktur w bibliotekach klas `BStr` niezarządzany typ na ciągi wysyłana do obiektów COM, utworzone przez program Visual Basic 6.0 i starszych wersji.</span><span class="sxs-lookup"><span data-stu-id="0e10d-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="0e10d-108">W takich przypadkach można użyć <xref:System.Runtime.InteropServices.MarshalAsAttribute> atrybutu, aby spowodować, że typy zarządzane ujawnianie jako typy niezarządzanych.</span><span class="sxs-lookup"><span data-stu-id="0e10d-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor2"></a> <span data-ttu-id="0e10d-109">Eksportowanie ciągi o stałej długości do kodu niezarządzanego</span><span class="sxs-lookup"><span data-stu-id="0e10d-109">Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="0e10d-110">W Visual Basic 6.0 i starszych wersjach ciągi są eksportowane do obiektów COM jako sekwencje bajtów bez znaku null zakończenie.</span><span class="sxs-lookup"><span data-stu-id="0e10d-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="0e10d-111">Zgodność z innymi językami Visual Basic .NET zawiera znak zakończenia, podczas eksportowania ciągów.</span><span class="sxs-lookup"><span data-stu-id="0e10d-111">For compatibility with other languages, Visual Basic .NET includes a termination character when exporting strings.</span></span> <span data-ttu-id="0e10d-112">Najlepszym sposobem rozwiązania ta niezgodność nie jest eksportowane ciągów, które nie mają znak zakończenia jako tablice tego `Byte` lub `Char`.</span><span class="sxs-lookup"><span data-stu-id="0e10d-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor3"></a> <span data-ttu-id="0e10d-113">Eksportowanie hierarchii dziedziczenia</span><span class="sxs-lookup"><span data-stu-id="0e10d-113">Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="0e10d-114">Zarządzane klasy, która hierarchii, spłaszczenie się ujawniane jako obiekty COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="0e10d-115">Na przykład jeśli zdefiniować klasę bazową z elementem członkowskim, a następnie dziedziczyć klasy podstawowej w klasie pochodnej, która jest widoczna jako obiekt COM, klientów, którzy używają klasy pochodnej w obiekcie COM nie będzie używać dziedziczone elementy członkowskie.</span><span class="sxs-lookup"><span data-stu-id="0e10d-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="0e10d-116">Składowych klasy bazowej są dostępne z obiektami COM tylko jako wystąpienia klasy bazowej, a następnie tylko wtedy, gdy klasa bazowa jest tworzona jako obiekt COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="0e10d-117">Przeciążone metody</span><span class="sxs-lookup"><span data-stu-id="0e10d-117">Overloaded Methods</span></span>  
 <span data-ttu-id="0e10d-118">Chociaż przeciążonych metod można tworzyć za pomocą Visual Basic, nie są obsługiwane przez model COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-118">Although you can create overloaded methods with Visual Basic, they are not supported by COM.</span></span> <span data-ttu-id="0e10d-119">Ujawniane klasę, która zawiera przeciążonych metod jako obiekt COM nowe nazwy metody są generowane dla przeciążonych metod.</span><span class="sxs-lookup"><span data-stu-id="0e10d-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="0e10d-120">Rozważmy na przykład klasa, która ma dwa przeciążenia metody `Synch` metody.</span><span class="sxs-lookup"><span data-stu-id="0e10d-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="0e10d-121">Gdy klasa jest udostępniana jako obiekt COM, nowe nazwy wygenerowana metoda może być `Synch` i `Synch_2`.</span><span class="sxs-lookup"><span data-stu-id="0e10d-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="0e10d-122">Zmiana nazwy może spowodować dwa problemy w konsumentach napisanych obiektu COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1.  <span data-ttu-id="0e10d-123">Klienci mogą nie oczekuje nazwy wygenerowanej metody.</span><span class="sxs-lookup"><span data-stu-id="0e10d-123">Clients might not expect the generated method names.</span></span>  
  
2.  <span data-ttu-id="0e10d-124">Nazwy wygenerowanej metody w klasie widoczne jako obiekt COM można zmienić, gdy nowe przeciążenia są dodawane do klasy lub jej klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="0e10d-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="0e10d-125">Może to spowodować problemy z wersjonowaniem.</span><span class="sxs-lookup"><span data-stu-id="0e10d-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="0e10d-126">Aby rozwiązać problemy z obu, nadaj każdej metodzie unikatową nazwę, a nie za pomocą przeciążenia, podczas tworzenia obiektów, które będą dostępne jako obiekty COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor4"></a> <span data-ttu-id="0e10d-127">Korzystanie z obiektów COM, przy użyciu zestawów międzyoperacyjnych</span><span class="sxs-lookup"><span data-stu-id="0e10d-127">Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="0e10d-128">Możesz użyć usług międzyoperacyjnych prawie tak, jakby były zamiany kodu zarządzanego dla obiektów COM, które reprezentują.</span><span class="sxs-lookup"><span data-stu-id="0e10d-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="0e10d-129">Jednakże ponieważ są one otoki, a nie rzeczywiste obiektów COM, istnieją pewne różnice między przy użyciu zestawów międzyoperacyjnych i standardowe zestawy.</span><span class="sxs-lookup"><span data-stu-id="0e10d-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="0e10d-130">Te obszary różnicy to narażenie klas i typów danych parametrów i zwracanych wartości.</span><span class="sxs-lookup"><span data-stu-id="0e10d-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor5"></a> <span data-ttu-id="0e10d-131">Klasy widoczne jako dotyczą obu interfejsów i klasy</span><span class="sxs-lookup"><span data-stu-id="0e10d-131">Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="0e10d-132">W odróżnieniu od klas w standardowe zestawy klasy COM są widoczne w zestawach międzyoperacyjnych jako interfejs i klasę, która reprezentuje klasę modelu COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="0e10d-133">Nazwa interfejsu jest taka sama jak w przypadku klasy COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="0e10d-134">Nazwa klasy międzyoperacyjny jest taka sama, jak w przypadku oryginalnej klasy COM, ale wyrazem "Class" jest dołączona.</span><span class="sxs-lookup"><span data-stu-id="0e10d-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="0e10d-135">Na przykład załóżmy, że masz projekt za pomocą odwołania do zestawu międzyoperacyjnego dla obiektu COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="0e10d-136">Jeśli klasa COM nosi nazwę `MyComClass`, funkcja IntelliSense i przeglądarki obiektów pokazać interfejs o nazwie `MyComClass` i klasę o nazwie `MyComClassClass`.</span><span class="sxs-lookup"><span data-stu-id="0e10d-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor6"></a> <span data-ttu-id="0e10d-137">Tworzenie wystąpienia klasy .NET Framework</span><span class="sxs-lookup"><span data-stu-id="0e10d-137">Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="0e10d-138">Ogólnie rzecz biorąc, Utwórz wystąpienie [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] przy użyciu `New` instrukcję, określając nazwę klasy.</span><span class="sxs-lookup"><span data-stu-id="0e10d-138">Generally, you create an instance of a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] class using the `New` statement with a class name.</span></span> <span data-ttu-id="0e10d-139">Klasa COM, reprezentowane przez zestaw międzyoperacyjny jest jeden przypadek, w którym można użyć `New` instrukcji przy użyciu interfejsu.</span><span class="sxs-lookup"><span data-stu-id="0e10d-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="0e10d-140">Jeśli nie używasz klasy COM za pomocą `Inherits` instrukcji, tak samo jak klasy, można użyć interfejsu.</span><span class="sxs-lookup"><span data-stu-id="0e10d-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="0e10d-141">Poniższy kod przedstawia sposób tworzenia `Command` obiektu w projekcie, który zawiera odwołanie do obiektu ActiveX firmy Microsoft danych 2.8 obiektów biblioteki modelu COM:</span><span class="sxs-lookup"><span data-stu-id="0e10d-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 [!code-vb[VbVbalrInterop#20](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]  
  
 <span data-ttu-id="0e10d-142">Jednak jeśli używasz klasy modelu COM jako podstawy dla klasy pochodnej, należy użyć międzyoperacyjny klasę, która reprezentuje klasę modelu COM, zgodnie z poniższym kodem:</span><span class="sxs-lookup"><span data-stu-id="0e10d-142">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrInterop#21](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]  
  
> [!NOTE]
>  <span data-ttu-id="0e10d-143">Zestawy międzyoperacyjne niejawnie implementować interfejsy, które reprezentują klasy COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-143">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="0e10d-144">Nie należy próbować użyć `Implements` spowoduje instrukcję, aby zaimplementować te interfejsy lub komunikat o błędzie.</span><span class="sxs-lookup"><span data-stu-id="0e10d-144">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor7"></a> <span data-ttu-id="0e10d-145">Typy danych dla parametrów i zwracanych wartości</span><span class="sxs-lookup"><span data-stu-id="0e10d-145">Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="0e10d-146">W odróżnieniu od członków standardowe zestawy zestaw międzyoperacyjny członkowie mogą mieć typów danych, które różnią się od tych używanych w oryginalnej deklaracji obiektu.</span><span class="sxs-lookup"><span data-stu-id="0e10d-146">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="0e10d-147">Mimo że zestawy międzyoperacyjne niejawnie przekonwertować typy modelu COM zgodnych typów środowiska wykonawczego języka wspólnego, należy zwrócić uwagę na typy danych, które są używane przez obie strony, aby zapobiec wystąpieniu błędów środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="0e10d-147">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="0e10d-148">Na przykład w przypadku obiektów COM, utworzone w języku Visual Basic 6.0 i starsze wersje, wartości typu `Integer` założono [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] równoważny typ `Short`.</span><span class="sxs-lookup"><span data-stu-id="0e10d-148">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] equivalent type, `Short`.</span></span> <span data-ttu-id="0e10d-149">Zalecane jest, użyj przeglądarki obiektów do zbadania właściwości elementów członkowskich zaimportowane przed ich użyciem.</span><span class="sxs-lookup"><span data-stu-id="0e10d-149">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor8"></a> <span data-ttu-id="0e10d-150">Moduł metod na poziomie modelu COM</span><span class="sxs-lookup"><span data-stu-id="0e10d-150">Module level COM methods</span></span>  
 <span data-ttu-id="0e10d-151">Większość obiektów COM są używane przez utworzenie wystąpienia klasy modelu COM za pomocą `New` — słowo kluczowe, a następnie wywoływania metod obiektu.</span><span class="sxs-lookup"><span data-stu-id="0e10d-151">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="0e10d-152">Jedynym wyjątkiem od tej reguły pociąga za sobą obiektów COM, które zawierają `AppObj` lub `GlobalMultiUse` klasy COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-152">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="0e10d-153">Takich klas przypominają modułu poziomu metod w klasach Visual Basic .NET.</span><span class="sxs-lookup"><span data-stu-id="0e10d-153">Such classes resemble module level methods in Visual Basic .NET classes.</span></span> <span data-ttu-id="0e10d-154">Visual Basic 6.0 i starsze wersje niejawnie tworzy wystąpienia takich obiektów, należy wywołać metody ich po raz pierwszy.</span><span class="sxs-lookup"><span data-stu-id="0e10d-154">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="0e10d-155">Na przykład w języku Visual Basic 6.0 można dodać odwołanie do biblioteki obiektów Microsoft DAO 3.6 i wywołanie `DBEngine` metody bez tworzenia wystąpienia:</span><span class="sxs-lookup"><span data-stu-id="0e10d-155">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```vb  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 <span data-ttu-id="0e10d-156">Visual Basic .NET wymaga zawsze tworzenia wystąpień obiektów COM przed użyciem ich metod.</span><span class="sxs-lookup"><span data-stu-id="0e10d-156">Visual Basic .NET requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="0e10d-157">Aby korzystać z tych metod w języku Visual Basic, Zadeklaruj zmienną odpowiednią klasę i użyj słowa kluczowego new, aby przypisać obiekt do zmiennej obiektu.</span><span class="sxs-lookup"><span data-stu-id="0e10d-157">To use these methods in Visual Basic, declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="0e10d-158">`Shared` — Słowo kluczowe może służyć, jeśli chcesz upewnić się, że tylko jedno wystąpienie tej klasy jest tworzona.</span><span class="sxs-lookup"><span data-stu-id="0e10d-158">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 [!code-vb[VbVbalrInterop#23](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor9"></a> <span data-ttu-id="0e10d-159">Nieobsługiwane błędy w obsłudze zdarzeń</span><span class="sxs-lookup"><span data-stu-id="0e10d-159">Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="0e10d-160">Jednym z typowych problemów międzyoperacyjny polega na błędy w procedurze obsługi zdarzeń, obsługujące zdarzenia generowane przez obiekty COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-160">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="0e10d-161">Takie błędy są ignorowane, chyba że specjalnie sprawdzania błędów przy użyciu `On Error` lub `Try...Catch...Finally` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="0e10d-161">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="0e10d-162">Na przykład poniższy przykład pochodzi z projektu języka Visual Basic .NET, który zawiera odwołanie do obiektu ActiveX firmy Microsoft danych 2.8 obiektów biblioteki modelu COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-162">For example, the following example is from a Visual Basic .NET project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 [!code-vb[VbVbalrInterop#24](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]  
  
 <span data-ttu-id="0e10d-163">W tym przykładzie zgłasza błąd, zgodnie z oczekiwaniami.</span><span class="sxs-lookup"><span data-stu-id="0e10d-163">This example raises an error as expected.</span></span> <span data-ttu-id="0e10d-164">Jednak jeśli zostanie podjęta w tym samym przykładzie bez `Try...Catch...Finally` bloku, błąd jest ignorowany, jak w przypadku korzystania `OnError Resume Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="0e10d-164">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="0e10d-165">Bez obsługi błędów, dzielenie przez zero dyskretnie kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="0e10d-165">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="0e10d-166">Ponieważ takie błędy nigdy nie zgłaszać błędy nieobsługiwany wyjątek, jest ważne, że używasz pewnego rodzaju obsługi wyjątków w procedury obsługi zdarzeń, które obsługują zdarzenia z obiektami COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-166">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="0e10d-167">Informacje o błędach międzyoperacyjnego modelu COM</span><span class="sxs-lookup"><span data-stu-id="0e10d-167">Understanding COM interop errors</span></span>  
 <span data-ttu-id="0e10d-168">Bez obsługi błędów wywołań międzyoperacyjnych często generować błędy, które zapewniają trochę informacji.</span><span class="sxs-lookup"><span data-stu-id="0e10d-168">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="0e10d-169">Możliwe, używaj ze strukturą obsługę błędów do Podaj więcej informacji na temat problemów, kiedy się pojawią.</span><span class="sxs-lookup"><span data-stu-id="0e10d-169">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="0e10d-170">Może to być szczególnie przydatne podczas debugowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0e10d-170">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="0e10d-171">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="0e10d-171">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#25](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]  
  
 <span data-ttu-id="0e10d-172">Informacje, takie jak opis błędu HRESULT i źródłem błędów COM można znaleźć, sprawdzając zawartość obiektu wyjątku.</span><span class="sxs-lookup"><span data-stu-id="0e10d-172">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor10"></a> <span data-ttu-id="0e10d-173">Problemy z kontrolki ActiveX</span><span class="sxs-lookup"><span data-stu-id="0e10d-173">ActiveX Control Issues</span></span>  
 <span data-ttu-id="0e10d-174">Większość kontrolki ActiveX, współpracujących z Visual Basic 6.0 pracować w Visual Basic .NET, które bez problemów.</span><span class="sxs-lookup"><span data-stu-id="0e10d-174">Most ActiveX controls that work with Visual Basic 6.0 work with Visual Basic .NET without trouble.</span></span> <span data-ttu-id="0e10d-175">Główne wyjątki są kontrole kontenerów lub formanty, które będzie zawierać inne kontrolki.</span><span class="sxs-lookup"><span data-stu-id="0e10d-175">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="0e10d-176">Kilka przykładów starsze formantów, które nie będą działać poprawnie z programem Visual Studio są następujące:</span><span class="sxs-lookup"><span data-stu-id="0e10d-176">Some examples of older controls that do not work correctly with Visual Studio are as follows:</span></span>  
  
-   <span data-ttu-id="0e10d-177">Formant programu Microsoft Forms 2.0 ramki</span><span class="sxs-lookup"><span data-stu-id="0e10d-177">Microsoft Forms 2.0 Frame control</span></span>  
  
-   <span data-ttu-id="0e10d-178">Góra-dół kontrolki, znany także jako kontrolki pokrętła</span><span class="sxs-lookup"><span data-stu-id="0e10d-178">Up-Down control, also known as the spin control</span></span>  
  
-   <span data-ttu-id="0e10d-179">Kontrolka karty Sheridan</span><span class="sxs-lookup"><span data-stu-id="0e10d-179">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="0e10d-180">Istnieją tylko kilka obejścia nieobsługiwany występują problemy z kontrolki ActiveX.</span><span class="sxs-lookup"><span data-stu-id="0e10d-180">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="0e10d-181">Można przeprowadzić migrację istniejących kontrolek do programu Visual Studio, jeśli jesteś właścicielem oryginalnego kodu źródłowego.</span><span class="sxs-lookup"><span data-stu-id="0e10d-181">You can migrate existing controls to Visual Studio if you own the original source code.</span></span> <span data-ttu-id="0e10d-182">W przeciwnym razie możesz skontaktować się z dostawcami oprogramowania dla aktualizacji. NET zgodnej wersji formantów, aby zastąpić nieobsługiwane formanty ActiveX.</span><span class="sxs-lookup"><span data-stu-id="0e10d-182">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor11"></a> <span data-ttu-id="0e10d-183">Przekazywanie tylko do odczytu właściwości formantów ByRef</span><span class="sxs-lookup"><span data-stu-id="0e10d-183">Passing ReadOnly Properties of Controls ByRef</span></span>  
 <span data-ttu-id="0e10d-184">Jeśli przekazujesz Visual Basic .NET czasami zgłasza błędy COM, takie jak "Błąd 0x800A017F CTL_E_SETNOTSUPPORTED" `ReadOnly` właściwości niektóre starsze formanty ActiveX jako `ByRef` parametry do innych procedur.</span><span class="sxs-lookup"><span data-stu-id="0e10d-184">Visual Basic .NET sometimes raises COM errors such as, "Error 0x800A017F CTL_E_SETNOTSUPPORTED", when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="0e10d-185">Podobnie w przypadku wywołania procedur z Visual Basic 6.0 nie zgłaszaj błąd, a parametry są traktowane tak, jakby przekazywane przez wartość.</span><span class="sxs-lookup"><span data-stu-id="0e10d-185">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="0e10d-186">Komunikat o błędzie Visual Basic .NET wskazuje na to, czy chcesz zmienić właściwość, która nie ma właściwości `Set` procedury.</span><span class="sxs-lookup"><span data-stu-id="0e10d-186">The Visual Basic .NET error message indicates that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="0e10d-187">Jeśli masz dostęp do procedury wywoływana, możesz uniknąć tego błędu, za pomocą `ByVal` — słowo kluczowe do deklarowania parametry, które akceptują `ReadOnly` właściwości.</span><span class="sxs-lookup"><span data-stu-id="0e10d-187">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="0e10d-188">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="0e10d-188">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#26](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]  
  
 <span data-ttu-id="0e10d-189">Jeśli nie masz dostępu do kodu źródłowego dla procedury wywoływana, możesz wymusić właściwości, które mają być przekazane przez wartość, dodając dodatkowy zestaw nawiasów wokół procedury wywołującej.</span><span class="sxs-lookup"><span data-stu-id="0e10d-189">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="0e10d-190">Na przykład w projekcie, który zawiera odwołanie do obiektu ActiveX firmy Microsoft danych 2.8 obiektów biblioteki modelu COM, należy użyć:</span><span class="sxs-lookup"><span data-stu-id="0e10d-190">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 [!code-vb[VbVbalrInterop#27](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor12"></a> <span data-ttu-id="0e10d-191">Wdrażanie zestawów, które uwidaczniają międzyoperacyjności</span><span class="sxs-lookup"><span data-stu-id="0e10d-191">Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="0e10d-192">Wdrażanie zestawów, które uwidaczniają interfejsów COM przedstawiono niektóre wyzwania.</span><span class="sxs-lookup"><span data-stu-id="0e10d-192">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="0e10d-193">Na przykład potencjalny problem występuje, gdy aplikacje oddzielne odwoływać się do tego samego zestawu COM.</span><span class="sxs-lookup"><span data-stu-id="0e10d-193">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="0e10d-194">Ta sytuacja jest typowa, gdy nowa wersja zestawu jest zainstalowany i starą wersję zestawu nadal jest używany przez inną aplikację.</span><span class="sxs-lookup"><span data-stu-id="0e10d-194">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="0e10d-195">Po odinstalowaniu zestawu, który udostępnia bibliotekę DLL, użytkownik może przypadkowo był dostępny dla innych zestawów.</span><span class="sxs-lookup"><span data-stu-id="0e10d-195">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="0e10d-196">Aby uniknąć tego problemu, możesz zainstalować współużytkowanych zestawów do globalnej pamięci podręcznej zestawów (GAC) i użyj MergeModule dla składnika.</span><span class="sxs-lookup"><span data-stu-id="0e10d-196">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="0e10d-197">Jeśli aplikacja nie można zainstalować w GAC, powinien być zainstalowany na CommonFilesFolder w podkatalogu specyficzny dla wersji.</span><span class="sxs-lookup"><span data-stu-id="0e10d-197">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="0e10d-198">Zestawy, które nie są współdzielone powinny się znajdować obok siebie w katalogu z aplikacji wywołującej.</span><span class="sxs-lookup"><span data-stu-id="0e10d-198">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0e10d-199">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="0e10d-199">See Also</span></span>  
 <xref:System.Runtime.InteropServices.MarshalAsAttribute>  
 [<span data-ttu-id="0e10d-200">Usługa międzyoperacyjna modelu COM</span><span class="sxs-lookup"><span data-stu-id="0e10d-200">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)  
 [<span data-ttu-id="0e10d-201">Tlbimp.exe (importer biblioteki typów)</span><span class="sxs-lookup"><span data-stu-id="0e10d-201">Tlbimp.exe (Type Library Importer)</span></span>](../../../framework/tools/tlbimp-exe-type-library-importer.md)  
 [<span data-ttu-id="0e10d-202">Tlbexp.exe (eksporter biblioteki typów)</span><span class="sxs-lookup"><span data-stu-id="0e10d-202">Tlbexp.exe (Type Library Exporter)</span></span>](https://msdn.microsoft.com/library/a487d61b-d166-467b-a7ca-d8b52fbff42d)  
 [<span data-ttu-id="0e10d-203">Przewodnik: wdrażanie dziedziczenia z obiektami COM</span><span class="sxs-lookup"><span data-stu-id="0e10d-203">Walkthrough: Implementing Inheritance with COM Objects</span></span>](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)  
 [<span data-ttu-id="0e10d-204">Inherits, instrukcja</span><span class="sxs-lookup"><span data-stu-id="0e10d-204">Inherits Statement</span></span>](../../../visual-basic/language-reference/statements/inherits-statement.md)  
 [<span data-ttu-id="0e10d-205">Global Assembly Cache</span><span class="sxs-lookup"><span data-stu-id="0e10d-205">Global Assembly Cache</span></span>](../../../framework/app-domains/gac.md)
