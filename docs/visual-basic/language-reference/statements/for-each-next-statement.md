---
title: For Each...Next — Instrukcja (Visual Basic)
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology:
- devlang-visual-basic
ms.topic: article
f1_keywords:
- vb.ForEach
- vb.ForEachNext
- vb.Each
- ForEachNext
helpviewer_keywords:
- infinite loops
- Next statement [Visual Basic], For Each...Next
- endless loops
- loop structures [Visual Basic], For Each...Next
- loops, endless
- Each keyword [Visual Basic]
- instructions, repeating
- For Each statement [Visual Basic]
- collections, instruction repetition
- loops, infinite
- For Each...Next statements
- For keyword [Visual Basic], For Each...Next statements
- Exit statement [Visual Basic], For Each...Next statements
- iteration
ms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2
caps.latest.revision: 56
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: b1593d279d4338ebadca803fe757a201cbcd654b
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/26/2018
---
# <a name="for-eachnext-statement-visual-basic"></a><span data-ttu-id="210a7-102">For Each...Next — Instrukcja (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="210a7-102">For Each...Next Statement (Visual Basic)</span></span>
<span data-ttu-id="210a7-103">Powtarza grupę instrukcji dla każdego elementu w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-103">Repeats a group of statements for each element in a collection.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="210a7-104">Składnia</span><span class="sxs-lookup"><span data-stu-id="210a7-104">Syntax</span></span>  
  
```  
For Each element [ As datatype ] In group  
    [ statements ]  
    [ Continue For ]  
    [ statements ]  
    [ Exit For ]  
    [ statements ]  
Next [ element ]  
```  
  
## <a name="parts"></a><span data-ttu-id="210a7-105">Części</span><span class="sxs-lookup"><span data-stu-id="210a7-105">Parts</span></span>  
  
|<span data-ttu-id="210a7-106">Termin</span><span class="sxs-lookup"><span data-stu-id="210a7-106">Term</span></span>|<span data-ttu-id="210a7-107">Definicja</span><span class="sxs-lookup"><span data-stu-id="210a7-107">Definition</span></span>|  
|---|---|  
|`element`|<span data-ttu-id="210a7-108">Wymagane w `For Each` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-108">Required in the `For Each` statement.</span></span> <span data-ttu-id="210a7-109">Opcjonalnie w `Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-109">Optional in the `Next` statement.</span></span> <span data-ttu-id="210a7-110">Zmienna.</span><span class="sxs-lookup"><span data-stu-id="210a7-110">Variable.</span></span> <span data-ttu-id="210a7-111">Używany do iterowania po elementach kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-111">Used to iterate through the elements of the collection.</span></span>|  
|`datatype`|<span data-ttu-id="210a7-112">Jeśli wymagane `element` nie jest już zadeklarowany.</span><span class="sxs-lookup"><span data-stu-id="210a7-112">Required if `element` isn't already declared.</span></span> <span data-ttu-id="210a7-113">Typ danych `element`.</span><span class="sxs-lookup"><span data-stu-id="210a7-113">Data type of `element`.</span></span>|  
|`group`|<span data-ttu-id="210a7-114">Wymagana.</span><span class="sxs-lookup"><span data-stu-id="210a7-114">Required.</span></span> <span data-ttu-id="210a7-115">Zmienna z typem jest typ kolekcji lub obiektu.</span><span class="sxs-lookup"><span data-stu-id="210a7-115">A variable with a type that's a collection type or Object.</span></span> <span data-ttu-id="210a7-116">Odwołuje się do kolekcji, w którym `statements` mają być powtarzany.</span><span class="sxs-lookup"><span data-stu-id="210a7-116">Refers to the collection over which the `statements` are to be repeated.</span></span>|  
|`statements`|<span data-ttu-id="210a7-117">Opcjonalna.</span><span class="sxs-lookup"><span data-stu-id="210a7-117">Optional.</span></span> <span data-ttu-id="210a7-118">Co najmniej jeden instrukcji między `For Each` i `Next` uruchomionymi na każdym z elementów `group`.</span><span class="sxs-lookup"><span data-stu-id="210a7-118">One or more statements between `For Each` and `Next` that run on each item in `group`.</span></span>|  
|`Continue For`|<span data-ttu-id="210a7-119">Opcjonalna.</span><span class="sxs-lookup"><span data-stu-id="210a7-119">Optional.</span></span> <span data-ttu-id="210a7-120">Przekazuje sterowanie do początku `For Each` pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-120">Transfers control to the start of the `For Each` loop.</span></span>|  
|`Exit For`|<span data-ttu-id="210a7-121">Opcjonalna.</span><span class="sxs-lookup"><span data-stu-id="210a7-121">Optional.</span></span> <span data-ttu-id="210a7-122">Przekazuje sterowanie poza `For Each` pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-122">Transfers control out of the `For Each` loop.</span></span>|  
|`Next`|<span data-ttu-id="210a7-123">Wymagana.</span><span class="sxs-lookup"><span data-stu-id="210a7-123">Required.</span></span> <span data-ttu-id="210a7-124">Kończy definicję `For Each` pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-124">Terminates the definition of the `For Each` loop.</span></span>|  
  
## <a name="simple-example"></a><span data-ttu-id="210a7-125">Prosty przykład</span><span class="sxs-lookup"><span data-stu-id="210a7-125">Simple Example</span></span>  
 <span data-ttu-id="210a7-126">Użyj `For Each`... `Next` pętli, gdy ma zostać powtórzony zestaw instrukcji dla każdego elementu w kolekcji lub tablicy.</span><span class="sxs-lookup"><span data-stu-id="210a7-126">Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="210a7-127">A [dla... Następna instrukcja](../../../visual-basic/language-reference/statements/for-next-statement.md) działa również podczas skojarzyć każdej iteracji pętli z zmienna sterująca i określania wartości początkowe i końcowe dla tej zmiennej.</span><span class="sxs-lookup"><span data-stu-id="210a7-127">A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.</span></span> <span data-ttu-id="210a7-128">Jednak gdy mamy do czynienia z kolekcją, pojęcie wartości początkowej i końcowej nie jest zrozumiały i użytkownik nie musi wiedzieć, ile elementów ma kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-128">However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.</span></span> <span data-ttu-id="210a7-129">W przypadku tego rodzaju `For Each`... `Next` pętli jest często lepszym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="210a7-129">In this kind of case, a `For Each`...`Next` loop is often a better choice.</span></span>  
  
 <span data-ttu-id="210a7-130">W poniższym przykładzie `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="210a7-130">In the following example, the `For Each`…`Next`</span></span> <span data-ttu-id="210a7-131">Instrukcja iterację wszystkie elementy kolekcji List.</span><span class="sxs-lookup"><span data-stu-id="210a7-131">statement iterates through all the elements of a List collection.</span></span>  
  
 [!code-vb[VbVbalrStatements#121](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_1.vb)]  
  
 <span data-ttu-id="210a7-132">Aby uzyskać więcej przykładów, zobacz [kolekcje](../../../standard/collections/index.md) i [tablice](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="210a7-132">For more examples, see [Collections](../../../standard/collections/index.md) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span>  
  
## <a name="nested-loops"></a><span data-ttu-id="210a7-133">Pętle zagnieżdżone</span><span class="sxs-lookup"><span data-stu-id="210a7-133">Nested Loops</span></span>  
 <span data-ttu-id="210a7-134">Można zagnieżdżać `For Each` pętle, ustawiając dla pętli w innym.</span><span class="sxs-lookup"><span data-stu-id="210a7-134">You can nest `For Each` loops by putting one loop within another.</span></span>  
  
 <span data-ttu-id="210a7-135">W poniższym przykładzie pokazano zagnieżdżonych `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="210a7-135">The following example demonstrates nested `For Each`…`Next`</span></span> <span data-ttu-id="210a7-136">struktury.</span><span class="sxs-lookup"><span data-stu-id="210a7-136">structures.</span></span>  
  
 [!code-vb[VbVbalrStatements#122](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_2.vb)]  
  
 <span data-ttu-id="210a7-137">Podczas zagnieżdżania pętle, każdej pętli musi mieć unikatową `element` zmiennej.</span><span class="sxs-lookup"><span data-stu-id="210a7-137">When you nest loops, each loop must have a unique `element` variable.</span></span>  
  
 <span data-ttu-id="210a7-138">Można zagnieżdżać w różnych rodzajów struktury sterujące wewnątrz innych.</span><span class="sxs-lookup"><span data-stu-id="210a7-138">You can also nest different kinds of control structures within each other.</span></span> <span data-ttu-id="210a7-139">Aby uzyskać więcej informacji, zobacz [zagnieżdżone struktury sterujące](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span><span class="sxs-lookup"><span data-stu-id="210a7-139">For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span></span>  
  
## <a name="exit-for-and-continue-for"></a><span data-ttu-id="210a7-140">Zakończ dla i Kontynuuj dla</span><span class="sxs-lookup"><span data-stu-id="210a7-140">Exit For and Continue For</span></span>  
 <span data-ttu-id="210a7-141">[Zakończyć dla](../../../visual-basic/language-reference/statements/exit-statement.md) instrukcja powoduje wykonanie zakończyć `For`...`Next`</span><span class="sxs-lookup"><span data-stu-id="210a7-141">The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next`</span></span> <span data-ttu-id="210a7-142">pętli i transfer kontroli do instrukcji następującej `Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-142">loop and transfers control to the statement that follows the `Next` statement.</span></span>  
  
 <span data-ttu-id="210a7-143">`Continue For` Instrukcji sterowania natychmiast przenosi do następnej iteracji pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-143">The `Continue For` statement transfers control immediately to the next iteration of the loop.</span></span> <span data-ttu-id="210a7-144">Aby uzyskać więcej informacji, zobacz [kontynuować instrukcji](../../../visual-basic/language-reference/statements/continue-statement.md).</span><span class="sxs-lookup"><span data-stu-id="210a7-144">For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md).</span></span>  
  
 <span data-ttu-id="210a7-145">Poniższy przykład przedstawia użycie `Continue For` i `Exit For` instrukcje.</span><span class="sxs-lookup"><span data-stu-id="210a7-145">The following example shows how to use the `Continue For` and `Exit For` statements.</span></span>  
  
 [!code-vb[VbVbalrStatements#123](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_3.vb)]  
  
 <span data-ttu-id="210a7-146">Można wprowadzić dowolną liczbę `Exit For` instrukcje w `For Each` pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-146">You can put any number of `Exit For` statements in a `For Each` loop.</span></span> <span data-ttu-id="210a7-147">Gdy jest używany w zagnieżdżonych `For Each` pętle, `Exit For` powoduje wykonanie zakończyć najbardziej kontroli pętli i przesyłania dalej wyższy poziom zagnieżdżenia.</span><span class="sxs-lookup"><span data-stu-id="210a7-147">When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.</span></span>  
  
 <span data-ttu-id="210a7-148">`Exit For` często używane po dokonaniu oceny spełnienia określonego warunku, na przykład w `If`... `Then`... `Else` struktury.</span><span class="sxs-lookup"><span data-stu-id="210a7-148">`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure.</span></span> <span data-ttu-id="210a7-149">Możesz chcieć użyć `Exit For` następujące warunki:</span><span class="sxs-lookup"><span data-stu-id="210a7-149">You might want to use `Exit For` for the following conditions:</span></span>  
  
-   <span data-ttu-id="210a7-150">Kontynuowanie wykonania iteracji jest niepotrzebne lub niemożliwe.</span><span class="sxs-lookup"><span data-stu-id="210a7-150">Continuing to iterate is unnecessary or impossible.</span></span> <span data-ttu-id="210a7-151">Może to być spowodowane Błędna wartość lub zakończenia żądania.</span><span class="sxs-lookup"><span data-stu-id="210a7-151">This might be caused by an erroneous value or a termination request.</span></span>  
  
-   <span data-ttu-id="210a7-152">Wystąpił wyjątek w `Try`... `Catch`... `Finally`. Można na przykład `Exit For` na końcu `Finally` bloku.</span><span class="sxs-lookup"><span data-stu-id="210a7-152">An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.</span></span>  
  
-   <span data-ttu-id="210a7-153">Miejsca nieskończonej pętli, czyli pętli, które można uruchomić dużych lub nawet nieskończoną liczbę razy.</span><span class="sxs-lookup"><span data-stu-id="210a7-153">There an endless loop, which is a loop that could run a large or even infinite number of times.</span></span> <span data-ttu-id="210a7-154">W przypadku wykrycia takim stanie, można użyć `Exit For` wyjścia z pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-154">If you detect such a condition, you can use `Exit For` to escape the loop.</span></span> <span data-ttu-id="210a7-155">Aby uzyskać więcej informacji, zobacz [czy... Pętla instrukcji](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span><span class="sxs-lookup"><span data-stu-id="210a7-155">For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span></span>  
  
## <a name="iterators"></a><span data-ttu-id="210a7-156">Iteratory</span><span class="sxs-lookup"><span data-stu-id="210a7-156">Iterators</span></span>  
 <span data-ttu-id="210a7-157">Możesz użyć *iterator* nawiązał niestandardowych iteracji w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-157">You use an *iterator* to perform a custom iteration over a collection.</span></span> <span data-ttu-id="210a7-158">Iterator może być funkcją lub `Get` dostępu.</span><span class="sxs-lookup"><span data-stu-id="210a7-158">An iterator can be a function or a `Get` accessor.</span></span> <span data-ttu-id="210a7-159">Używa `Yield` instrukcji, aby zwracany był każdy element kolekcji jednym naraz.</span><span class="sxs-lookup"><span data-stu-id="210a7-159">It uses a `Yield` statement to return each element of the collection one at a time.</span></span>  
  
 <span data-ttu-id="210a7-160">Należy wywołać przy użyciu iteratora `For Each...Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-160">You call an iterator by using a `For Each...Next` statement.</span></span> <span data-ttu-id="210a7-161">Każdej iteracji `For Each` pętli wywołuje iteratora.</span><span class="sxs-lookup"><span data-stu-id="210a7-161">Each iteration of the `For Each` loop calls the iterator.</span></span> <span data-ttu-id="210a7-162">Gdy `Yield` osiągnie iteracyjne, wyrażenia w instrukcji `Yield` instrukcji jest zwracany, i są przechowywane w bieżącej lokalizacji w kodzie.</span><span class="sxs-lookup"><span data-stu-id="210a7-162">When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained.</span></span> <span data-ttu-id="210a7-163">Wykonanie jest ponownie z tej lokalizacji iteratora jest wywoływana przy następnym uruchomieniu.</span><span class="sxs-lookup"><span data-stu-id="210a7-163">Execution is restarted from that location the next time that the iterator is called.</span></span>  
  
 <span data-ttu-id="210a7-164">W poniższym przykładzie użyto funkcji iteracyjnej.</span><span class="sxs-lookup"><span data-stu-id="210a7-164">The following example uses an iterator function.</span></span> <span data-ttu-id="210a7-165">Funkcja iteratora ma `Yield` instrukcji, która znajduje się wewnątrz [dla... Następny](../../../visual-basic/language-reference/statements/for-next-statement.md) pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-165">The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop.</span></span> <span data-ttu-id="210a7-166">W `ListEvenNumbers` metoda, każdej iteracji `For Each` treść instrukcji tworzy wywołanie funkcji iteracyjnej, który przechodzi do następnego `Yield` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-166">In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.</span></span>  
  
 [!code-vb[VbVbalrStatements#127](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_4.vb)]  
  
 <span data-ttu-id="210a7-167">Aby uzyskać więcej informacji, zobacz [Iteratory](../../programming-guide/concepts/iterators.md), [instrukcji Yield](../../../visual-basic/language-reference/statements/yield-statement.md), i [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span><span class="sxs-lookup"><span data-stu-id="210a7-167">For more information, see [Iterators](../../programming-guide/concepts/iterators.md), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span></span>  
  
## <a name="technical-implementation"></a><span data-ttu-id="210a7-168">Realizacja techniczna</span><span class="sxs-lookup"><span data-stu-id="210a7-168">Technical Implementation</span></span>  
 <span data-ttu-id="210a7-169">Gdy `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="210a7-169">When a `For Each`…`Next`</span></span> <span data-ttu-id="210a7-170">Uruchamia instrukcji, Visual Basic oblicza kolekcji tylko jeden raz, przed rozpoczęciem pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-170">statement runs, Visual Basic evaluates the collection only one time, before the loop starts.</span></span> <span data-ttu-id="210a7-171">W przypadku zmiany z bloku instrukcji `element` lub `group`, zmiany te nie wpływają na iteracji pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-171">If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.</span></span>  
  
 <span data-ttu-id="210a7-172">Gdy wszystkie elementy w kolekcji kolejno przypisane do `element`, `For Each` pętla zatrzymuje i kontrola przechodzi do instrukcji następującej `Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-172">When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span>  
  
 <span data-ttu-id="210a7-173">Jeśli `element` nie była zadeklarowana poza pętlę, należy ją zadeklarować w `For Each` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-173">If `element` hasn't been declared outside this loop, you must declare it in the `For Each` statement.</span></span> <span data-ttu-id="210a7-174">Można zadeklarować typu `element` jawnie przy użyciu `As` instrukcji lub użytkownik może polegać na wnioskowanie o typie można przypisać do typu.</span><span class="sxs-lookup"><span data-stu-id="210a7-174">You can declare the type of `element` explicitly by using an `As` statement, or you can rely on type inference to assign the type.</span></span> <span data-ttu-id="210a7-175">W obu przypadkach zakres `element` jest treści pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-175">In either case, the scope of `element` is the body of the loop.</span></span> <span data-ttu-id="210a7-176">Jednak nie można zadeklarować `element` zarówno poza i wewnątrz pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-176">However, you cannot declare `element` both outside and inside the loop.</span></span>  
  
 <span data-ttu-id="210a7-177">Opcjonalnie można określić `element` w `Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-177">You can optionally specify `element` in the `Next` statement.</span></span> <span data-ttu-id="210a7-178">Poprawia czytelność z programem, zwłaszcza, jeśli można zagnieżdżać `For Each` pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-178">This improves the readability of your program, especially if you have nested `For Each` loops.</span></span> <span data-ttu-id="210a7-179">Należy określić tę samą zmienną, która jest wyświetlana w polu `For Each` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-179">You must specify the same variable as the one that appears in the corresponding `For Each` statement.</span></span>  
  
 <span data-ttu-id="210a7-180">Należy unikać zmiana wartości `element` wewnątrz pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-180">You might want to avoid changing the value of `element` inside a loop.</span></span> <span data-ttu-id="210a7-181">W ten sposób można utrudnić do odczytywania i debugowanie kodu.</span><span class="sxs-lookup"><span data-stu-id="210a7-181">Doing this can make it more difficult to read and debug your code.</span></span> <span data-ttu-id="210a7-182">Zmiana wartości `group` nie ma wpływu na kolekcji lub jej elementy, które zostały uznane za najpierw wprowadzenie pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-182">Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.</span></span>  
  
 <span data-ttu-id="210a7-183">Gdy jest zagnieżdżanie pętli, jeśli `Next` instrukcji zewnętrzne poziom zagnieżdżenia napotkano przed `Next` wewnętrzny poziom kompilator sygnały wystąpił błąd.</span><span class="sxs-lookup"><span data-stu-id="210a7-183">When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error.</span></span> <span data-ttu-id="210a7-184">Jednak kompilator wykryć nakładających się błędu tylko w przypadku określenia `element` w każdym `Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-184">However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.</span></span>  
  
 <span data-ttu-id="210a7-185">Jeśli kod jest zależny od przechodzenie kolekcji w określonej kolejności `For Each`... `Next` pętli nie jest najlepszym rozwiązaniem, jeśli nie znasz właściwości obiektu modułu wyliczającego przedstawia kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-185">If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.</span></span> <span data-ttu-id="210a7-186">Kolejność przechodzenie nie jest określana przez Visual Basic, ale przez <xref:System.Collections.IEnumerator.MoveNext%2A> metody obiektu modułu wyliczającego.</span><span class="sxs-lookup"><span data-stu-id="210a7-186">The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object.</span></span> <span data-ttu-id="210a7-187">W związku z tym nie można przewidzieć który element w kolekcji jest to pierwszy w `element`, lub który dalej do zwrócenia po danego elementu.</span><span class="sxs-lookup"><span data-stu-id="210a7-187">Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element.</span></span> <span data-ttu-id="210a7-188">Wydajność będzie bardziej niezawodny wyników przy użyciu struktury różnych pętli, takie jak `For`... `Next` lub `Do`... `Loop`.</span><span class="sxs-lookup"><span data-stu-id="210a7-188">You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.</span></span>  
  
 <span data-ttu-id="210a7-189">Typ danych miary `element` musi być w taki sposób, że typ danych elementów `group` mogą być konwertowane do niego.</span><span class="sxs-lookup"><span data-stu-id="210a7-189">The data type of `element` must be such that the data type of the elements of `group` can be converted to it.</span></span>  
  
 <span data-ttu-id="210a7-190">Typ danych miary `group` musi być typem referencyjnym, odnoszący się do kolekcji lub tablicy, która jest wyliczalny.</span><span class="sxs-lookup"><span data-stu-id="210a7-190">The data type of `group` must be a reference type that refers to a collection or an array that's enumerable.</span></span> <span data-ttu-id="210a7-191">Oznacza to, że najczęściej `group` odwołuje się do obiektu, który implementuje <xref:System.Collections.IEnumerable> interfejsu `System.Collections` przestrzeni nazw lub <xref:System.Collections.Generic.IEnumerable%601> interfejsu `System.Collections.Generic` przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="210a7-191">Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace.</span></span> <span data-ttu-id="210a7-192">`System.Collections.IEnumerable` definiuje <xref:System.Collections.IEnumerable.GetEnumerator%2A> metody, która zwraca obiekt modułu wyliczającego dla kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-192">`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection.</span></span> <span data-ttu-id="210a7-193">Obiekt modułu wyliczającego implementuje `System.Collections.IEnumerator` interfejsu `System.Collections` przestrzeni nazw i udostępnia <xref:System.Collections.IEnumerator.Current%2A> właściwości i <xref:System.Collections.IEnumerator.Reset%2A> i <xref:System.Collections.IEnumerator.MoveNext%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="210a7-193">The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods.</span></span> <span data-ttu-id="210a7-194">Visual Basic wykorzystuje te przechodzenie kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-194">Visual Basic uses these to traverse the collection.</span></span>  
  
### <a name="narrowing-conversions"></a><span data-ttu-id="210a7-195">Zawężanie konwersji</span><span class="sxs-lookup"><span data-stu-id="210a7-195">Narrowing Conversions</span></span>  
 <span data-ttu-id="210a7-196">Gdy `Option Strict` ma ustawioną wartość `On`, konwersji zawężającej zazwyczaj powodują błędy kompilatora.</span><span class="sxs-lookup"><span data-stu-id="210a7-196">When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors.</span></span> <span data-ttu-id="210a7-197">W `For Each` instrukcji, jednak konwersje z elementów w `group` do `element` są oceniane i wykonywane w czasie wykonywania i błędy kompilatora spowodowane zawężanie konwersji są pomijane.</span><span class="sxs-lookup"><span data-stu-id="210a7-197">In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.</span></span>  
  
 <span data-ttu-id="210a7-198">W poniższym przykładzie, przypisywanie `m` jako początkowa wartość `n` nie podczas kompilowania `Option Strict` znajduje się na, ponieważ konwersja `Long` do `Integer` jest konwersji zawężającej.</span><span class="sxs-lookup"><span data-stu-id="210a7-198">In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion.</span></span> <span data-ttu-id="210a7-199">W `For Each` instrukcji, jednak żaden błąd kompilatora jest zgłaszane, mimo że przypisanie do `number` wymaga tego samego konwersji z `Long` do `Integer`.</span><span class="sxs-lookup"><span data-stu-id="210a7-199">In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`.</span></span> <span data-ttu-id="210a7-200">W `For Each` występuje błąd czasu wykonywania instrukcji, która zawiera dużą liczbę, gdy <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> jest stosowany do dużą liczbą.</span><span class="sxs-lookup"><span data-stu-id="210a7-200">In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.</span></span>  
  
 [!code-vb[VbVbalrStatements#89](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_5.vb)]  
  
### <a name="ienumerator-calls"></a><span data-ttu-id="210a7-201">Wywołania IEnumerator</span><span class="sxs-lookup"><span data-stu-id="210a7-201">IEnumerator Calls</span></span>  
 <span data-ttu-id="210a7-202">Podczas wykonywania `For Each`... `Next` rozpoczyna pętli, Visual Basic sprawdza, czy `group` odwołuje się do obiektu prawidłowej kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-202">When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object.</span></span> <span data-ttu-id="210a7-203">Jeśli nie, zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="210a7-203">If not, it throws an exception.</span></span> <span data-ttu-id="210a7-204">W przeciwnym razie wywołuje <xref:System.Collections.IEnumerator.MoveNext%2A> — metoda i <xref:System.Collections.IEnumerator.Current%2A> właściwości obiektu modułu wyliczającego do zwrócenia pierwszego elementu.</span><span class="sxs-lookup"><span data-stu-id="210a7-204">Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element.</span></span> <span data-ttu-id="210a7-205">Jeśli `MoveNext` oznacza brak nie następnym elementem, oznacza to, jeśli kolekcja jest pusta, `For Each` pętla zatrzymuje i kontrola przechodzi do instrukcji następującej `Next` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-205">If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span> <span data-ttu-id="210a7-206">W przeciwnym razie ustawia Visual Basic `element` do pierwszego elementu i uruchamia blok instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-206">Otherwise, Visual Basic sets `element` to the first element and runs the statement block.</span></span>  
  
 <span data-ttu-id="210a7-207">Po każdej aktualizacji Visual Basic napotka `Next` instrukcji, zwraca do `For Each` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-207">Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement.</span></span> <span data-ttu-id="210a7-208">Ponownie wywołuje `MoveNext` i `Current` do zwrócenia z następnym elementem i ponownie uruchamia blok lub zatrzymuje pętli w zależności od wyniku.</span><span class="sxs-lookup"><span data-stu-id="210a7-208">Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result.</span></span> <span data-ttu-id="210a7-209">Ten proces jest kontynuowany do momentu `MoveNext` wskazuje nie następny element lub `Exit For` napotkano instrukcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-209">This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.</span></span>  
  
 <span data-ttu-id="210a7-210">**Modyfikowanie kolekcji.**</span><span class="sxs-lookup"><span data-stu-id="210a7-210">**Modifying the Collection.**</span></span> <span data-ttu-id="210a7-211">Obiekt modułu wyliczającego zwrócony przez <xref:System.Collections.IEnumerable.GetEnumerator%2A> zwykle pozwala zmienić kolekcji przez dodawanie, usuwanie, zastępowanie lub zmianę kolejności elementów.</span><span class="sxs-lookup"><span data-stu-id="210a7-211">The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.</span></span> <span data-ttu-id="210a7-212">W przypadku zmiany kolekcji po zainicjowaniu `For Each`... `Next` pętli, obiekt modułu wyliczającego staje się nieprawidłowa i powoduje, że następnej próbie uzyskania dostępu do elementu <xref:System.InvalidOperationException> wyjątku.</span><span class="sxs-lookup"><span data-stu-id="210a7-212">If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="210a7-213">Jednak to blokowanie modyfikacji nie jest określany przez program Visual Basic, ale raczej przez implementację <xref:System.Collections.IEnumerable> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="210a7-213">However, this blocking of modification isn't determined by Visual Basic, but rather by the implementation of the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="210a7-214">Istnieje możliwość wykonania `IEnumerable` w sposób umożliwiający modyfikacji podczas iteracji.</span><span class="sxs-lookup"><span data-stu-id="210a7-214">It is possible to implement `IEnumerable` in a way that allows for modification during iteration.</span></span> <span data-ttu-id="210a7-215">Planując wykonywania takich dynamicznych zmian, upewnij się, że rozumiesz właściwości `IEnumerable` implementacji na poziomie kolekcji używasz.</span><span class="sxs-lookup"><span data-stu-id="210a7-215">If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.</span></span>  
  
 <span data-ttu-id="210a7-216">**Modyfikacja kolekcji elementów.**</span><span class="sxs-lookup"><span data-stu-id="210a7-216">**Modifying Collection Elements.**</span></span> <span data-ttu-id="210a7-217"><xref:System.Collections.IEnumerator.Current%2A> Obiektu modułu wyliczającego jest [tylko do odczytu](../../../visual-basic/language-reference/modifiers/readonly.md), i zwraca lokalną kopię każdego elementu w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-217">The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element.</span></span> <span data-ttu-id="210a7-218">Oznacza to, że nie można zmodyfikować ze sobą elementy w `For Each`... `Next` pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-218">This means that you cannot modify the elements themselves in a `For Each`...`Next` loop.</span></span> <span data-ttu-id="210a7-219">Wszelkie zmiany wprowadzone wpływa na kopii lokalnej z `Current` i nie zostanie wprowadzona do kolekcji źródłowej.</span><span class="sxs-lookup"><span data-stu-id="210a7-219">Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection.</span></span> <span data-ttu-id="210a7-220">Jednak jeśli element jest typem referencyjnym, można zmodyfikować elementów członkowskich wystąpienia, na którą wskazuje.</span><span class="sxs-lookup"><span data-stu-id="210a7-220">However, if an element is a reference type, you can modify the members of the instance to which it points.</span></span> <span data-ttu-id="210a7-221">Poniższy przykład modyfikuje `BackColor` z każdej `thisControl` elementu.</span><span class="sxs-lookup"><span data-stu-id="210a7-221">The following example modifies the `BackColor` member of each `thisControl` element.</span></span> <span data-ttu-id="210a7-222">Nie można jednak zmienić `thisControl` samej siebie.</span><span class="sxs-lookup"><span data-stu-id="210a7-222">You cannot, however, modify `thisControl` itself.</span></span>  
  
```vb  
Sub lightBlueBackground(ByVal thisForm As System.Windows.Forms.Form)  
    For Each thisControl As System.Windows.Forms.Control In thisForm.Controls  
        thisControl.BackColor = System.Drawing.Color.LightBlue  
    Next thisControl  
End Sub  
```  
  
 <span data-ttu-id="210a7-223">Można zmodyfikować w poprzednim przykładzie `BackColor` z każdej `thisControl` elementu, mimo że nie można go zmodyfikować `thisControl` samej siebie.</span><span class="sxs-lookup"><span data-stu-id="210a7-223">The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.</span></span>  
  
 <span data-ttu-id="210a7-224">**Przechodzenie przez tablic.**</span><span class="sxs-lookup"><span data-stu-id="210a7-224">**Traversing Arrays.**</span></span> <span data-ttu-id="210a7-225">Ponieważ <xref:System.Array> klasa implementuje <xref:System.Collections.IEnumerable> interfejsu, wszystkie tablice ujawnia <xref:System.Array.GetEnumerator%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="210a7-225">Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method.</span></span> <span data-ttu-id="210a7-226">Oznacza to, że można wykonać iterację tablicy o `For Each`... `Next` pętli.</span><span class="sxs-lookup"><span data-stu-id="210a7-226">This means that you can iterate through an array with a `For Each`...`Next` loop.</span></span> <span data-ttu-id="210a7-227">Można jednak tylko odczytać elementów tablicy.</span><span class="sxs-lookup"><span data-stu-id="210a7-227">However, you can only read the array elements.</span></span> <span data-ttu-id="210a7-228">Nie można ich zmienić.</span><span class="sxs-lookup"><span data-stu-id="210a7-228">You cannot change them.</span></span>  
  
## <a name="example"></a><span data-ttu-id="210a7-229">Przykład</span><span class="sxs-lookup"><span data-stu-id="210a7-229">Example</span></span>  
 <span data-ttu-id="210a7-230">Poniższy przykład zawiera listę wszystkich folderów w katalogu C:\ przy użyciu <xref:System.IO.DirectoryInfo> klasy.</span><span class="sxs-lookup"><span data-stu-id="210a7-230">The following example lists all the folders in the C:\ directory by using the <xref:System.IO.DirectoryInfo> class.</span></span>  
  
 [!code-vb[VbVbalrStatements#124](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_6.vb)]  
  
## <a name="example"></a><span data-ttu-id="210a7-231">Przykład</span><span class="sxs-lookup"><span data-stu-id="210a7-231">Example</span></span>  
 <span data-ttu-id="210a7-232">Poniższy przykład przedstawia procedurę sortowanie kolekcji.</span><span class="sxs-lookup"><span data-stu-id="210a7-232">The following example illustrates a procedure for sorting a collection.</span></span> <span data-ttu-id="210a7-233">Przykład sortuje wystąpienia `Car` klasy, które są przechowywane w <xref:System.Collections.Generic.List%601>.</span><span class="sxs-lookup"><span data-stu-id="210a7-233">The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>.</span></span> <span data-ttu-id="210a7-234">`Car` Klasa implementuje <xref:System.IComparable%601> interfejs, który wymaga, aby <xref:System.IComparable%601.CompareTo%2A> metoda zaimplementowana.</span><span class="sxs-lookup"><span data-stu-id="210a7-234">The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.</span></span>  
  
 <span data-ttu-id="210a7-235">Każde wywołanie <xref:System.IComparable%601.CompareTo%2A> metoda pozwala jednym porównanie, które jest używane do sortowania.</span><span class="sxs-lookup"><span data-stu-id="210a7-235">Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting.</span></span> <span data-ttu-id="210a7-236">Napisany przez użytkownika kod `CompareTo` metoda zwraca wartość dla każdego porównania bieżący obiekt z innym obiektem.</span><span class="sxs-lookup"><span data-stu-id="210a7-236">User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object.</span></span> <span data-ttu-id="210a7-237">Wartość zwracana jest mniejsza niż zero, jeśli bieżący obiekt jest mniejsza od drugiego obiektu, większa niż zero, jeśli bieżący obiekt jest większy niż drugi obiekt i zero czy są równe.</span><span class="sxs-lookup"><span data-stu-id="210a7-237">The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.</span></span> <span data-ttu-id="210a7-238">Dzięki temu można zdefiniować w kodzie kryteria większa niż poniżej, a równa.</span><span class="sxs-lookup"><span data-stu-id="210a7-238">This enables you to define in code the criteria for greater than, less than, and equal.</span></span>  
  
 <span data-ttu-id="210a7-239">W `ListCars` metody `cars.Sort()` instrukcji sortuje listę.</span><span class="sxs-lookup"><span data-stu-id="210a7-239">In the `ListCars` method, the `cars.Sort()` statement sorts the list.</span></span> <span data-ttu-id="210a7-240">To wywołanie <xref:System.Collections.Generic.List%601.Sort%2A> metody <xref:System.Collections.Generic.List%601> powoduje, że `CompareTo` wywoływanej automatycznie dla metody `Car` obiekty w `List`.</span><span class="sxs-lookup"><span data-stu-id="210a7-240">This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.</span></span>  
  
 [!code-vb[VbVbalrStatements#125](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_7.vb)]  
  
## <a name="see-also"></a><span data-ttu-id="210a7-241">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="210a7-241">See Also</span></span>  
 [<span data-ttu-id="210a7-242">Kolekcje</span><span class="sxs-lookup"><span data-stu-id="210a7-242">Collections</span></span>](../../../standard/collections/index.md)  
 [<span data-ttu-id="210a7-243">For...Next, instrukcja</span><span class="sxs-lookup"><span data-stu-id="210a7-243">For...Next Statement</span></span>](../../../visual-basic/language-reference/statements/for-next-statement.md)  
 [<span data-ttu-id="210a7-244">Struktury pętli</span><span class="sxs-lookup"><span data-stu-id="210a7-244">Loop Structures</span></span>](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)  
 [<span data-ttu-id="210a7-245">While...End While, instrukcja</span><span class="sxs-lookup"><span data-stu-id="210a7-245">While...End While Statement</span></span>](../../../visual-basic/language-reference/statements/while-end-while-statement.md)  
 [<span data-ttu-id="210a7-246">Do...Loop, instrukcja</span><span class="sxs-lookup"><span data-stu-id="210a7-246">Do...Loop Statement</span></span>](../../../visual-basic/language-reference/statements/do-loop-statement.md)  
 [<span data-ttu-id="210a7-247">Rozszerzanie i zwężanie konwersji</span><span class="sxs-lookup"><span data-stu-id="210a7-247">Widening and Narrowing Conversions</span></span>](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)  
 [<span data-ttu-id="210a7-248">Inicjatory obiektów: typy nazwane i anonimowe</span><span class="sxs-lookup"><span data-stu-id="210a7-248">Object Initializers: Named and Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="210a7-249">Inicjatory kolekcji</span><span class="sxs-lookup"><span data-stu-id="210a7-249">Collection Initializers</span></span>](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)  
 [<span data-ttu-id="210a7-250">Tablice</span><span class="sxs-lookup"><span data-stu-id="210a7-250">Arrays</span></span>](../../../visual-basic/programming-guide/language-features/arrays/index.md)
