---
title: Asynchroniczne przepływy pracy (F#)
description: Dowiedz się więcej o obsłudze w F# języka programowania dla wykonywania obliczeń w sposób asynchroniczny, którego wykonane bez blokowania wykonywania innych zadań.
ms.date: 05/16/2016
ms.openlocfilehash: 720996106d2b90392eacc75eb99147691ee83334
ms.sourcegitcommit: ccd8c36b0d74d99291d41aceb14cf98d74dc9d2b
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/10/2018
ms.locfileid: "53127748"
---
# <a name="asynchronous-workflows"></a><span data-ttu-id="a0412-103">Asynchroniczne przepływy pracy</span><span class="sxs-lookup"><span data-stu-id="a0412-103">Asynchronous Workflows</span></span>

> [!NOTE]
> <span data-ttu-id="a0412-104">Łącze odwołania API spowoduje przejście do MSDN.</span><span class="sxs-lookup"><span data-stu-id="a0412-104">The API reference link will take you to MSDN.</span></span>  <span data-ttu-id="a0412-105">Dokumentacja interfejsu API w witrynie docs.microsoft.com nie została ukończona.</span><span class="sxs-lookup"><span data-stu-id="a0412-105">The docs.microsoft.com API reference is not complete.</span></span>

<span data-ttu-id="a0412-106">W tym temacie opisano obsługę F# do wykonywania obliczeń asynchronicznie, bez blokowania wykonywania innych pracy.</span><span class="sxs-lookup"><span data-stu-id="a0412-106">This topic describes support in F# for performing computations asynchronously, that is, without blocking execution of other work.</span></span> <span data-ttu-id="a0412-107">Na przykład asynchronicznych obliczeń może służyć do pisania aplikacji, które mają interfejsów użytkownika, które ciągle reagować na użytkowników, jak aplikacja wykonuje inne prace.</span><span class="sxs-lookup"><span data-stu-id="a0412-107">For example, asynchronous computations can be used to write applications that have UIs that remain responsive to users as the application performs other work.</span></span>

## <a name="syntax"></a><span data-ttu-id="a0412-108">Składnia</span><span class="sxs-lookup"><span data-stu-id="a0412-108">Syntax</span></span>

```fsharp
async { expression }
```

## <a name="remarks"></a><span data-ttu-id="a0412-109">Uwagi</span><span class="sxs-lookup"><span data-stu-id="a0412-109">Remarks</span></span>

<span data-ttu-id="a0412-110">W poprzedniej składni obliczenia jest reprezentowane przez `expression` jest skonfigurowany do uruchamiane asynchronicznie, oznacza to, że nie blokuje bieżący wątek obliczeń, gdy wykonywane są operacje asynchroniczne uśpienia, operacji We/Wy i innych operacji asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="a0412-110">In the previous syntax, the computation represented by `expression` is set up to run asynchronously, that is, without blocking the current computation thread when asynchronous sleep operations, I/O, and other asynchronous operations are performed.</span></span> <span data-ttu-id="a0412-111">Asynchroniczne obliczenia często są uruchamiane w wątku w tle, gdy wykonywanie jest kontynuowane w bieżącym wątku.</span><span class="sxs-lookup"><span data-stu-id="a0412-111">Asynchronous computations are often started on a background thread while execution continues on the current thread.</span></span> <span data-ttu-id="a0412-112">Typ wyrażenia jest `Async<'T>`, gdzie `'T` jest typem zwracanym przez wyrażenie po `return` słowo kluczowe jest używane.</span><span class="sxs-lookup"><span data-stu-id="a0412-112">The type of the expression is `Async<'T>`, where `'T` is the type returned by the expression when the `return` keyword is used.</span></span> <span data-ttu-id="a0412-113">Kod w wyrażeniu jest nazywa się *asynchronicznego bloku*, lub *bloku async*.</span><span class="sxs-lookup"><span data-stu-id="a0412-113">The code in such an expression is referred to as an *asynchronous block*, or *async block*.</span></span>

<span data-ttu-id="a0412-114">Istnieją różne sposoby programowania asynchronicznego, a [ `Async` ](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7) klasa dostarcza metody, które obsługują kilka scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="a0412-114">There are a variety of ways of programming asynchronously, and the [`Async`](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7) class provides methods that support several scenarios.</span></span> <span data-ttu-id="a0412-115">Ogólne podejście jest utworzenie `Async` obiektów, które reprezentują obliczeń lub obliczeń, które mają być uruchamiane asynchronicznie, a następnie uruchom te obliczenia przy użyciu jednej z funkcji wyzwalania.</span><span class="sxs-lookup"><span data-stu-id="a0412-115">The general approach is to create `Async` objects that represent the computation or computations that you want to run asynchronously, and then start these computations by using one of the triggering functions.</span></span> <span data-ttu-id="a0412-116">Różne funkcje wyzwalająca zapewniają różne sposoby uruchomionych obliczeń asynchronicznych i, w którym używane jest zależna od tego, czy chcesz użyć, bieżący wątek, wątek w tle lub obiekt zadania .NET Framework i tego, czy istnieją kontynuacji Funkcje, które powinny być uruchamiane po zakończeniu obliczeń.</span><span class="sxs-lookup"><span data-stu-id="a0412-116">The various triggering functions provide different ways of running asynchronous computations, and which one you use depends on whether you want to use the current thread, a background thread, or a .NET Framework task object, and whether there are continuation functions that should run when the computation finishes.</span></span> <span data-ttu-id="a0412-117">Na przykład, aby rozpocząć asynchroniczne obliczenie w bieżącym wątku, można użyć [ `Async.StartImmediate` ](https://msdn.microsoft.com/library/2f71d1cc-187f-48cf-ac66-e7fda41c46e3).</span><span class="sxs-lookup"><span data-stu-id="a0412-117">For example, to start an asynchronous computation on the current thread, you can use [`Async.StartImmediate`](https://msdn.microsoft.com/library/2f71d1cc-187f-48cf-ac66-e7fda41c46e3).</span></span> <span data-ttu-id="a0412-118">Po uruchomieniu asynchronicznych obliczeń z wątku interfejsu użytkownika nie blokują pętlę głównego zdarzeń, która przetwarza akcje użytkownika, takie jak naciśnięcia klawiszy i myszy działanie, dzięki czemu aplikacja reaguje.</span><span class="sxs-lookup"><span data-stu-id="a0412-118">When you start an asynchronous computation from the UI thread, you do not block the main event loop that processes user actions such as keystrokes and mouse activity, so your application remains responsive.</span></span>

## <a name="asynchronous-binding-by-using-let"></a><span data-ttu-id="a0412-119">Asynchroniczne wiązanie przy użyciu let!</span><span class="sxs-lookup"><span data-stu-id="a0412-119">Asynchronous Binding by Using let!</span></span>

<span data-ttu-id="a0412-120">W asynchronicznego przepływu pracy niektóre wyrażenia i operacje są synchroniczne, a niektóre są dłuższe obliczeń, opracowane w celu zwrócenia wyniku asynchronicznego.</span><span class="sxs-lookup"><span data-stu-id="a0412-120">In an asynchronous workflow, some expressions and operations are synchronous, and some are longer computations that are designed to return a result asynchronously.</span></span> <span data-ttu-id="a0412-121">Gdy zostanie wywołana metoda asynchronicznie, zamiast zwykłej `let` powiązania, możesz użyć `let!`.</span><span class="sxs-lookup"><span data-stu-id="a0412-121">When you call a method asynchronously, instead of an ordinary `let` binding, you use `let!`.</span></span> <span data-ttu-id="a0412-122">Efekt `let!` jest umożliwienie wykonywania kontynuować na innych obliczeń lub wątków, ponieważ obliczenie jest wykonywane.</span><span class="sxs-lookup"><span data-stu-id="a0412-122">The effect of `let!` is to enable execution to continue on other computations or threads as the computation is being performed.</span></span> <span data-ttu-id="a0412-123">Po prawej stronie `let!` zwraca powiązania, pozostała część asynchronicznego przepływu pracy wznawia działanie.</span><span class="sxs-lookup"><span data-stu-id="a0412-123">After the right side of the `let!` binding returns, the rest of the asynchronous workflow resumes execution.</span></span>

<span data-ttu-id="a0412-124">Poniższy kod przedstawia różnicę między `let` i `let!`.</span><span class="sxs-lookup"><span data-stu-id="a0412-124">The following code shows the difference between `let` and `let!`.</span></span> <span data-ttu-id="a0412-125">Wiersz kodu, który używa `let` po prostu tworzy asynchroniczne obliczenie, jako obiekt, który można uruchomić później za pomocą, na przykład `Async.StartImmediate` lub [ `Async.RunSynchronously` ](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b).</span><span class="sxs-lookup"><span data-stu-id="a0412-125">The line of code that uses `let` just creates an asynchronous computation as an object that you can run later by using, for example, `Async.StartImmediate` or [`Async.RunSynchronously`](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b).</span></span> <span data-ttu-id="a0412-126">Wiersz kodu, który używa `let!` rozpoczyna obliczenia, a następnie wątek jest zawieszony, dopóki wynik nie będzie dostępna, w której punkt wykonywanie jest kontynuowane.</span><span class="sxs-lookup"><span data-stu-id="a0412-126">The line of code that uses `let!` starts the computation, and then the thread is suspended until the result is available, at which point execution continues.</span></span>

```fsharp
// let just stores the result as an asynchronous operation.
let (result1 : Async<byte[]>) = stream.AsyncRead(bufferSize)
// let! completes the asynchronous operation and returns the data.
let! (result2 : byte[])  = stream.AsyncRead(bufferSize)
```

<span data-ttu-id="a0412-127">Oprócz `let!`, możesz użyć `use!` do wykonania asynchronicznej powiązania.</span><span class="sxs-lookup"><span data-stu-id="a0412-127">In addition to `let!`, you can use `use!` to perform asynchronous bindings.</span></span> <span data-ttu-id="a0412-128">Różnica między `let!` i `use!` jest taka sama jak różnica między `let` i `use`.</span><span class="sxs-lookup"><span data-stu-id="a0412-128">The difference between `let!` and `use!` is the same as the difference between `let` and `use`.</span></span> <span data-ttu-id="a0412-129">Aby uzyskać `use!`, obiekt jest usunięty na zakończenie bieżącego zakresu.</span><span class="sxs-lookup"><span data-stu-id="a0412-129">For `use!`, the object is disposed of at the close of the current scope.</span></span> <span data-ttu-id="a0412-130">Należy pamiętać, że w bieżącej wersji funkcji F# języka, `use!` nie zezwala na wartość, aby być inicjowane na wartość null, nawet jeśli `use` jest.</span><span class="sxs-lookup"><span data-stu-id="a0412-130">Note that in the current release of the F# language, `use!` does not allow a value to be initialized to null, even though `use` does.</span></span>

## <a name="asynchronous-primitives"></a><span data-ttu-id="a0412-131">Asynchroniczne w nim elementów podstawowych</span><span class="sxs-lookup"><span data-stu-id="a0412-131">Asynchronous Primitives</span></span>

<span data-ttu-id="a0412-132">Wywoływana jest metoda, która wykonuje jedno zadanie asynchroniczne i zwraca wynik *asynchronicznego podstawowego*, i są one przeznaczone specjalnie do użytku z `let!`.</span><span class="sxs-lookup"><span data-stu-id="a0412-132">A method that performs a single asynchronous task and returns the result is called an *asynchronous primitive*, and these are designed specifically for use with `let!`.</span></span> <span data-ttu-id="a0412-133">Kilka podstawowych asynchronicznych są zdefiniowane w F# podstawowej biblioteki.</span><span class="sxs-lookup"><span data-stu-id="a0412-133">Several asynchronous primitives are defined in the F# core library.</span></span> <span data-ttu-id="a0412-134">Dwie metody takie aplikacje sieci Web są zdefiniowane w module [ `Microsoft.FSharp.Control.WebExtensions` ](https://msdn.microsoft.com/library/95ef17bc-ee3f-44ba-8a11-c90fcf4cf003): [ `WebRequest.AsyncGetResponse` ](https://msdn.microsoft.com/library/09a60c31-e6e2-4b5c-ad23-92a86e50060c) i [ `WebClient.AsyncDownloadString` ](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a).</span><span class="sxs-lookup"><span data-stu-id="a0412-134">Two such methods for Web applications are defined in the module [`Microsoft.FSharp.Control.WebExtensions`](https://msdn.microsoft.com/library/95ef17bc-ee3f-44ba-8a11-c90fcf4cf003): [`WebRequest.AsyncGetResponse`](https://msdn.microsoft.com/library/09a60c31-e6e2-4b5c-ad23-92a86e50060c) and [`WebClient.AsyncDownloadString`](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a).</span></span> <span data-ttu-id="a0412-135">Oba elementy podstawowe pobrać dane ze strony sieci Web danego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="a0412-135">Both primitives download data from a Web page, given a URL.</span></span> <span data-ttu-id="a0412-136">`AsyncGetResponse` Tworzy `System.Net.WebResponse` obiektu, a `AsyncDownloadString` daje ciąg, który reprezentuje kod HTML dla strony sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a0412-136">`AsyncGetResponse` produces a `System.Net.WebResponse` object, and `AsyncDownloadString` produces a string that represents the HTML for a Web page.</span></span>

<span data-ttu-id="a0412-137">Kilka podstawowych dla asynchronicznych operacji We/Wy są objęte [ `Microsoft.FSharp.Control.CommonExtensions` ](https://msdn.microsoft.com/library/2edb67cb-6814-4a30-849f-b6dbdd042396) modułu.</span><span class="sxs-lookup"><span data-stu-id="a0412-137">Several primitives for asynchronous I/O operations are included in the [`Microsoft.FSharp.Control.CommonExtensions`](https://msdn.microsoft.com/library/2edb67cb-6814-4a30-849f-b6dbdd042396) module.</span></span> <span data-ttu-id="a0412-138">Te metody rozszerzenia `System.IO.Stream` klasy są [ `Stream.AsyncRead` ](https://msdn.microsoft.com/library/85698aaa-bdda-47e6-abed-3730f59fda5e) i [ `Stream.AsyncWrite` ](https://msdn.microsoft.com/library/1b0a2751-e42a-47e1-bd27-020224adc618).</span><span class="sxs-lookup"><span data-stu-id="a0412-138">These extension methods of the `System.IO.Stream` class are [`Stream.AsyncRead`](https://msdn.microsoft.com/library/85698aaa-bdda-47e6-abed-3730f59fda5e) and [`Stream.AsyncWrite`](https://msdn.microsoft.com/library/1b0a2751-e42a-47e1-bd27-020224adc618).</span></span>

<span data-ttu-id="a0412-139">Można także napisać własny podstawowych asynchronicznych, definiując funkcji, w których pełną treść jest ujęty w bloku async.</span><span class="sxs-lookup"><span data-stu-id="a0412-139">You can also write your own asynchronous primitives by defining a function whose complete body is enclosed in an async block.</span></span>

<span data-ttu-id="a0412-140">Używać metod asynchronicznych na platformie .NET Framework, które są przeznaczone dla innymi modelami asynchronicznymi z F# modelu programowania asynchronicznego, utworzyć funkcję, która zwraca F# `Async` obiektu.</span><span class="sxs-lookup"><span data-stu-id="a0412-140">To use asynchronous methods in the .NET Framework that are designed for other asynchronous models with the F# asynchronous programming model, you create a function that returns an F# `Async` object.</span></span> <span data-ttu-id="a0412-141">F# Biblioteka ma funkcje, które ułatwiają to zrobić.</span><span class="sxs-lookup"><span data-stu-id="a0412-141">The F# library has functions that make this easy to do.</span></span>

<span data-ttu-id="a0412-142">Przykładem przy użyciu asynchronicznych przepływów pracy jest uwzględniony w tym miejscu; istnieje wiele innych w dokumentacji metody [Async — klasa](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7).</span><span class="sxs-lookup"><span data-stu-id="a0412-142">One example of using asynchronous workflows is included here; there are many others in the documentation for the methods of the [Async class](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7).</span></span>

<span data-ttu-id="a0412-143">W tym przykładzie pokazano, jak używać Asynchroniczne przepływy pracy do wykonywania obliczeń równoległych.</span><span class="sxs-lookup"><span data-stu-id="a0412-143">This example shows how to use asynchronous workflows to perform computations in parallel.</span></span>

<span data-ttu-id="a0412-144">W poniższym przykładzie kodu funkcji `fetchAsync` pobiera tekst HTML zwracanego z żądania sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a0412-144">In the following code example, a function `fetchAsync` gets the HTML text returned from a Web request.</span></span> <span data-ttu-id="a0412-145">`fetchAsync` Funkcja zawiera asynchroniczne bloku kodu.</span><span class="sxs-lookup"><span data-stu-id="a0412-145">The `fetchAsync` function contains an asynchronous block of code.</span></span> <span data-ttu-id="a0412-146">Powiązanie nawiązaniem do wyniku asynchronicznego pierwotny, w tym przypadku [ `AsyncDownloadString` ](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a), let!</span><span class="sxs-lookup"><span data-stu-id="a0412-146">When a binding is made to the result of an asynchronous primitive, in this case [`AsyncDownloadString`](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a), let!</span></span> <span data-ttu-id="a0412-147">zamiast umożliwiają jest używana.</span><span class="sxs-lookup"><span data-stu-id="a0412-147">is used instead of let.</span></span>

<span data-ttu-id="a0412-148">W przypadku użycia funkcji [ `Async.RunSynchronously` ](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b) do wykonywania operacji asynchronicznej i czeka na wynik.</span><span class="sxs-lookup"><span data-stu-id="a0412-148">You use the function [`Async.RunSynchronously`](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b) to execute an asynchronous operation and wait for its result.</span></span> <span data-ttu-id="a0412-149">Na przykład można wykonać wiele operacji asynchronicznych w sposób równoległy, za pomocą [ `Async.Parallel` ](https://msdn.microsoft.com/library/aa9b0355-2d55-4858-b943-cbe428de9dc4) działać razem z `Async.RunSynchronously` funkcji.</span><span class="sxs-lookup"><span data-stu-id="a0412-149">As an example, you can execute multiple asynchronous operations in parallel by using the [`Async.Parallel`](https://msdn.microsoft.com/library/aa9b0355-2d55-4858-b943-cbe428de9dc4) function together with the `Async.RunSynchronously` function.</span></span> <span data-ttu-id="a0412-150">`Async.Parallel` Funkcja przyjmuje listę `Async` obiektów, konfiguruje kodu dla każdego `Async` obiektu zadania do uruchomienia równoległego i zwraca `Async` obiekt, który reprezentuje obliczeń równoległych.</span><span class="sxs-lookup"><span data-stu-id="a0412-150">The `Async.Parallel` function takes a list of the `Async` objects, sets up the code for each `Async` task object to run in parallel, and returns an `Async` object that represents the parallel computation.</span></span> <span data-ttu-id="a0412-151">Podobnie jak w przypadku jednej operacji, należy wywołać `Async.RunSynchronously` Aby uruchomić wykonywanie.</span><span class="sxs-lookup"><span data-stu-id="a0412-151">Just as for a single operation, you call `Async.RunSynchronously` to start the execution.</span></span>

<span data-ttu-id="a0412-152">`runAll` Funkcji uruchamia trzy Asynchroniczne przepływy pracy równolegle i czeka, aż wszystkie zakończył.</span><span class="sxs-lookup"><span data-stu-id="a0412-152">The `runAll` function launches three asynchronous workflows in parallel and waits until they have all completed.</span></span>

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet8003.fs)]

## <a name="see-also"></a><span data-ttu-id="a0412-153">Zobacz także</span><span class="sxs-lookup"><span data-stu-id="a0412-153">See also</span></span>

- [<span data-ttu-id="a0412-154">Dokumentacja języka F#</span><span class="sxs-lookup"><span data-stu-id="a0412-154">F# Language Reference</span></span>](index.md)
- [<span data-ttu-id="a0412-155">Wyrażenia obliczeń</span><span class="sxs-lookup"><span data-stu-id="a0412-155">Computation Expressions</span></span>](computation-expressions.md)
- [<span data-ttu-id="a0412-156">Control.Async — klasa</span><span class="sxs-lookup"><span data-stu-id="a0412-156">Control.Async Class</span></span>](https://msdn.microsoft.com/visualfsharpdocs/conceptual/control.async-class-%5bfsharp%5d)
