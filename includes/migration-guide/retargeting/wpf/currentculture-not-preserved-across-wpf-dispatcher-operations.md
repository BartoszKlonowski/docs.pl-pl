---
ms.openlocfilehash: bd656478a55856e676853e57f3e7386ea0aa0211
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/01/2020
ms.locfileid: "85614824"
---
### <a name="currentculture-is-not-preserved-across-wpf-dispatcher-operations"></a><span data-ttu-id="5a092-101">CurrentCulture nie jest zachowywana w operacjach dyspozytora WPF</span><span class="sxs-lookup"><span data-stu-id="5a092-101">CurrentCulture is not preserved across WPF Dispatcher operations</span></span>

#### <a name="details"></a><span data-ttu-id="5a092-102">Szczegóły</span><span class="sxs-lookup"><span data-stu-id="5a092-102">Details</span></span>

<span data-ttu-id="5a092-103">Począwszy od .NET Framework 4,6 zmiany <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> lub <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> wprowadzone w ramach elementu <xref:System.Windows.Threading.Dispatcher?displayProperty=fullName> zostaną utracone po zakończeniu operacji dyspozytora.</span><span class="sxs-lookup"><span data-stu-id="5a092-103">Beginning in the .NET Framework 4.6, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> made within a <xref:System.Windows.Threading.Dispatcher?displayProperty=fullName> will be lost at the end of that dispatcher operation.</span></span> <span data-ttu-id="5a092-104">Podobnie zmiany <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> lub <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> wprowadzone poza operacją dyspozytora mogą nie być odzwierciedlone podczas wykonywania tej operacji. Praktycznie mówiąc, oznacza to, <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> że <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> zmiany nie mogą przepływać między wywołaniami ZWROTNYMI interfejsu użytkownika WPF a innym kodem w aplikacji WPF. Jest to spowodowane zmianą w <xref:System.Threading.ExecutionContext?displayProperty=fullName> tej przyczynie <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> i w <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> kontekście wykonywania rozpoczynającą się od aplikacji przeznaczonych dla .NET Framework 4,6.</span><span class="sxs-lookup"><span data-stu-id="5a092-104">Similarly, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> made outside of a Dispatcher operation may not be reflected when that operation executes.Practically speaking, this means that <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> changes may not flow between WPF UI callbacks and other code in a WPF application.This is due to a change in <xref:System.Threading.ExecutionContext?displayProperty=fullName> that causes <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> to be stored in the execution context beginning with apps targeting the .NET Framework 4.6.</span></span> <span data-ttu-id="5a092-105">Operacje dyspozytora WPF przechowują kontekst wykonywania używany do rozpoczęcia operacji i przywracania poprzedniego kontekstu po zakończeniu operacji.</span><span class="sxs-lookup"><span data-stu-id="5a092-105">WPF dispatcher operations store the execution context used to begin the operation and restore the previous context when the operation is completed.</span></span> <span data-ttu-id="5a092-106">Ponieważ <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> i <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> są teraz częścią tego kontekstu, zmiany w nich w ramach operacji dyspozytora nie są utrwalane poza operacją.</span><span class="sxs-lookup"><span data-stu-id="5a092-106">Because <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> are now part of that context, changes to them within a dispatcher operation are not persisted outside of the operation.</span></span>

#### <a name="suggestion"></a><span data-ttu-id="5a092-107">Sugestia</span><span class="sxs-lookup"><span data-stu-id="5a092-107">Suggestion</span></span>

<span data-ttu-id="5a092-108">Aplikacje, których dotyczy ta zmiana, mogą obsłużyć tę zmianę, przechowując odpowiednie <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> lub <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> w polu i sprawdzając wszystkie jednostki operacji dyspozytora (w tym programy obsługi wywołania zwrotnego zdarzeń interfejsu użytkownika), które <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> są poprawne i <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> są ustawione.</span><span class="sxs-lookup"><span data-stu-id="5a092-108">Apps affected by this change may work around it by storing the desired <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> in a field and checking in all Dispatcher operation bodies (including UI event callback handlers) that the correct <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> are set.</span></span> <span data-ttu-id="5a092-109">Alternatywnie, ze względu na to, że zmiana kontekście wykonywaniaa podstawowa dla tej platformy WPF wpływa tylko na aplikacje przeznaczone dla .NET Framework 4,6 lub nowszej, ten przerwanie można uniknąć, przeznaczenie do .NET Framework 4.5.2. aplikacje, które są przeznaczone dla .NET Framework 4,6 lub nowszego, mogą także obejść ten krok, ustawiając następujący przełącznik zgodności:</span><span class="sxs-lookup"><span data-stu-id="5a092-109">Alternatively, because the ExecutionContext change underlying this WPF change only affects apps targeting the .NET Framework 4.6 or newer, this break can be avoided by targeting the .NET Framework 4.5.2.Apps that target .NET Framework 4.6 or later can also work around this by setting the following compatibility switch:</span></span>

<pre><code class="lang-csharp">AppContext.SetSwitch(&quot;Switch.System.Globalization.NoAsyncCurrentCulture&quot;, true);&#13;&#10;</code></pre>

<span data-ttu-id="5a092-110">Ten problem został rozwiązany przez WPF w .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="5a092-110">This issue has been fixed by WPF in .NET Framework 4.6.2.</span></span> <span data-ttu-id="5a092-111">Został również ustalony w programie .NET Frameworks 4,6, 4.6.1 do [KB 3139549](https://support.microsoft.com/kb/3139549).</span><span class="sxs-lookup"><span data-stu-id="5a092-111">It has also been fixed in .NET Frameworks 4.6, 4.6.1 through [KB 3139549](https://support.microsoft.com/kb/3139549).</span></span> <span data-ttu-id="5a092-112">Aplikacje ukierunkowane na .NET Framework 4,6 lub nowsze automatycznie otrzymają odpowiednie zachowanie w aplikacjach WPF — <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> / <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> ) byłyby zachowywane między operacjami dyspozytora.</span><span class="sxs-lookup"><span data-stu-id="5a092-112">Applications targeting .NET Framework 4.6 or later will automatically get the right behavior in WPF applications - <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName>/<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName>) would be preserved across Dispatcher operations.</span></span>

| <span data-ttu-id="5a092-113">Nazwa</span><span class="sxs-lookup"><span data-stu-id="5a092-113">Name</span></span>    | <span data-ttu-id="5a092-114">Wartość</span><span class="sxs-lookup"><span data-stu-id="5a092-114">Value</span></span>       |
|:--------|:------------|
| <span data-ttu-id="5a092-115">Zakres</span><span class="sxs-lookup"><span data-stu-id="5a092-115">Scope</span></span>   | <span data-ttu-id="5a092-116">Mały</span><span class="sxs-lookup"><span data-stu-id="5a092-116">Minor</span></span>       |
| <span data-ttu-id="5a092-117">Wersja</span><span class="sxs-lookup"><span data-stu-id="5a092-117">Version</span></span> | <span data-ttu-id="5a092-118">4.6</span><span class="sxs-lookup"><span data-stu-id="5a092-118">4.6</span></span>         |
| <span data-ttu-id="5a092-119">Typ</span><span class="sxs-lookup"><span data-stu-id="5a092-119">Type</span></span>    | <span data-ttu-id="5a092-120">Przekierowanie</span><span class="sxs-lookup"><span data-stu-id="5a092-120">Retargeting</span></span> |
